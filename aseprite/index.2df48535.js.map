{"mappings":"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","sources":["node_modules/@parcel/runtime-js/lib/helpers/bundle-manifest.js","node_modules/@parcel/runtime-js/lib/runtime-7978c58090a4099a.js","node_modules/@excaliburjs/plugin-aseprite/dist/webpack:/ex.Plugin.Aseprite/webpack/universalModuleDefinition","node_modules/@excaliburjs/plugin-aseprite/dist/webpack:/ex.Plugin.Aseprite/src/AsepriteRaw.ts","node_modules/@excaliburjs/plugin-aseprite/dist/webpack:/ex.Plugin.Aseprite/src/AsepriteResource.ts","node_modules/@excaliburjs/plugin-aseprite/dist/webpack:/ex.Plugin.Aseprite/src/AsepriteSpriteSheet.ts","node_modules/@excaliburjs/plugin-aseprite/dist/webpack:/ex.Plugin.Aseprite/src/index.ts","node_modules/@excaliburjs/plugin-aseprite/dist/webpack:/ex.Plugin.Aseprite/external umd {\"commonjs\":\"excalibur\",\"commonjs2\":\"excalibur\",\"amd\":\"excalibur\",\"root\":\"ex\"}","node_modules/@excaliburjs/plugin-aseprite/dist/webpack:/ex.Plugin.Aseprite/webpack/bootstrap","node_modules/@excaliburjs/plugin-aseprite/dist/webpack:/ex.Plugin.Aseprite/webpack/startup","node_modules/@parcel/runtime-js/lib/runtime-32af15e0d9254968.js","node_modules/@parcel/runtime-js/lib/runtime-fa51ee78a5230a7e.js","src/aseprite/main.ts"],"sourcesContent":["\"use strict\";\n\nvar mapping = {};\n\nfunction register(pairs) {\n  var keys = Object.keys(pairs);\n\n  for (var i = 0; i < keys.length; i++) {\n    mapping[keys[i]] = pairs[keys[i]];\n  }\n}\n\nfunction resolve(id) {\n  var resolved = mapping[id];\n\n  if (resolved == null) {\n    throw new Error('Could not resolve bundle with id ' + id);\n  }\n\n  return resolved;\n}\n\nmodule.exports.register = register;\nmodule.exports.resolve = resolve;","require('./helpers/bundle-manifest').register(JSON.parse(\"{\\\"7zpdG\\\":\\\"index.2df48535.js\\\",\\\"iM7HG\\\":\\\"beetle.956ebb15.json\\\",\\\"foYjp\\\":\\\"beetle.404bb2a9.png\\\",\\\"iUVDR\\\":\\\"index.b486eafc.js\\\"}\"));","(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"excalibur\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"excalibur\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"ex\"] = factory(require(\"excalibur\"));\n\telse\n\t\troot[\"ex\"] = root[\"ex\"] || {}, root[\"ex\"][\"Plugin\"] = root[\"ex\"][\"Plugin\"] || {}, root[\"ex\"][\"Plugin\"][\"Aseprite\"] = factory(root[\"ex\"]);\n})(self, (__WEBPACK_EXTERNAL_MODULE__205__) => {\nreturn ","export class AsepriteRaw {\r\n    frames!: {\r\n        [key: string]: { \r\n            frame: { x: number, y: number, w: number, h: number },\r\n            rotated: boolean,\r\n            trimmed: boolean,\r\n            spriteSourceSize: { x: number, y: number, w: number, h: number },\r\n            sourceSize: { w: number, h: number },\r\n            duration: number\r\n        }\r\n    }\r\n    meta!: {\r\n        image: string,\r\n        size: { w: number, h: number },\r\n        scale: number,\r\n        format: string,\r\n        layers: { name: string, opacity: number, blendMode: string }[],\r\n        frameTags: { name: string, from: number, to: number, direction: string}[],\r\n        slices: any[]\r\n    }\r\n}","import { ImageSource, Loadable, Logger, Resource, SpriteSheet } from 'excalibur';\r\nimport { AsepriteRaw } from './AsepriteRaw';\r\nimport { AsepriteSpriteSheet } from './AsepriteSpriteSheet';\r\n\r\n\r\nexport class AsepriteResource implements Loadable<AsepriteSpriteSheet> {\r\n    private _resource: Resource<AsepriteRaw>;\r\n    public data!: AsepriteSpriteSheet;\r\n    public rawAseprite!: AsepriteRaw;\r\n    public image!: ImageSource;\r\n\r\n    public convertPath: (originPath: string, relativePath: string) => string;\r\n    constructor(path: string, public bustCache = false) {\r\n        this._resource = new Resource(path, 'json', bustCache);\r\n        this.convertPath = (originPath: string, relativePath: string) => {\r\n            // Use absolute path if specified\r\n            if (relativePath.indexOf('/') === 0) {\r\n                return relativePath;\r\n            }\r\n\r\n            const originSplit = originPath.split('/');\r\n            const relativeSplit = relativePath.split('/');\r\n            // if origin path is a file, remove it so it's a directory\r\n            if (originSplit[originSplit.length - 1].includes('.')) {\r\n                originSplit.pop();\r\n            }\r\n            return originSplit.concat(relativeSplit).join('/');\r\n        }\r\n    }\r\n\r\n    public async load(): Promise<AsepriteSpriteSheet> {\r\n        const asepriteData = await this._resource.load();\r\n        const imagepath = this.convertPath(this._resource.path, asepriteData.meta.image);\r\n        const spriteSheetImage = new ImageSource(imagepath, this.bustCache);\r\n        await spriteSheetImage.load();\r\n        this.rawAseprite = asepriteData;\r\n        this.image = spriteSheetImage;\r\n        return this.data = new AsepriteSpriteSheet(asepriteData, spriteSheetImage);\r\n    }\r\n\r\n    public getSpriteSheet() {\r\n        if (this.isLoaded()) {\r\n            return this.data.getSpriteSheet();\r\n        } else {\r\n            Logger.getInstance().warn('AspriteResource must be loaded before .getSpriteSheet() is called');\r\n        }\r\n    }\r\n\r\n    public getAnimation(name: string) {\r\n        if (this.isLoaded()) {\r\n            return this.data.getAnimation(name);\r\n        } else {\r\n            Logger.getInstance().warn('AspriteResource must be loaded before .getAnimation() is called');\r\n        }\r\n    }\r\n\r\n\r\n    isLoaded(): boolean {\r\n        return !!this.data;\r\n    }\r\n}","import { Frame, ImageSource, range, Sprite, SpriteSheet, Animation, AnimationStrategy } from \"excalibur\";\r\nimport { AsepriteRaw } from \"./AsepriteRaw\";\r\n\r\n\r\nexport class AsepriteSpriteSheet {\r\n    private _spriteSheet: SpriteSheet;\r\n    private _animations = new Map<string, Animation>()\r\n    constructor(public asepriteRaw: AsepriteRaw, public image: ImageSource) {\r\n        for (let frameTag of asepriteRaw.meta.frameTags) {\r\n            let from = frameTag.from;\r\n            let to = frameTag.to;\r\n            let frameIndices = range(from, to);\r\n            let frames: Frame[] = Object.values(asepriteRaw.frames)\r\n            .filter((_, id) => {\r\n                return frameIndices.includes(id);\r\n            })\r\n            .map(frame => ({\r\n                duration: frame.duration,\r\n                graphic: new Sprite({\r\n                    image,\r\n                    sourceView: {\r\n                        x: frame.frame.x,\r\n                        y: frame.frame.y,\r\n                        width: frame.frame.w,\r\n                        height: frame.frame.h\r\n                    },\r\n                    destSize: {\r\n                        width: frame.frame.w,\r\n                        height: frame.frame.h\r\n                    }\r\n                })\r\n            }));\r\n            let strategy = AnimationStrategy.Loop;\r\n            switch(frameTag.direction) {\r\n                case \"pingpong\": {\r\n                    strategy = AnimationStrategy.PingPong\r\n                    break;\r\n                }\r\n                case \"reverse\": {\r\n                    frames.reverse();\r\n                    break;\r\n                }\r\n            }\r\n            this._animations.set(frameTag.name, new Animation({frames, strategy}));\r\n        }\r\n\r\n        const sprites: Sprite[] = [];\r\n        for (let sprite of Object.values(asepriteRaw.frames)) {\r\n            sprites.push(new Sprite({\r\n                image,\r\n                sourceView: {\r\n                    x: sprite.frame.x,\r\n                    y: sprite.frame.y,\r\n                    width: sprite.frame.w,\r\n                    height: sprite.frame.h\r\n                }\r\n            }));\r\n        }\r\n        this._spriteSheet = new SpriteSheet({\r\n            sprites,\r\n            rows: asepriteRaw.meta.size.h / sprites[0].height,\r\n            columns: asepriteRaw.meta.size.w / sprites[0].width\r\n        });\r\n    }\r\n\r\n    getSpriteSheet(): SpriteSheet {\r\n        return this._spriteSheet\r\n    }\r\n\r\n    getAnimation(name: string): Animation {\r\n        if (!this._animations.has(name)) {\r\n            throw new Error(`No animation exists with name ${name}, check your exported Aseprite file`);\r\n        }\r\n        return this._animations.get(name) as Animation;\r\n    }\r\n}","\r\nexport * from './AsepriteRaw';\r\nexport * from './AsepriteResource';\r\nexport * from './AsepriteSpriteSheet';","module.exports = __WEBPACK_EXTERNAL_MODULE__205__;","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// startup\n// Load entry module and return exports\n// This entry module is referenced by other modules so it can't be inlined\nvar __webpack_exports__ = __webpack_require__(607);\n","module.exports = new __parcel__URL__(\"../\" + require('./helpers/bundle-manifest').resolve(\"iM7HG\")).toString();","module.exports = new __parcel__URL__(\"../\" + require('./helpers/bundle-manifest').resolve(\"foYjp\")).toString();","import * as ex from 'excalibur';\nimport * as aseprite from '@excaliburjs/plugin-aseprite';\nimport beetlejson from './beetle.json';\nimport beetlepng from './beetle.png';\n\n// start-snippet{aseprite}\nconst game = new ex.Engine({\n    width: 600,\n    height: 400,\n    displayMode: ex.DisplayMode.FitScreen\n});\n\nconst asepriteSheet = new aseprite.AsepriteResource(beetlejson);\n// hack for parcel v2 asset paths\n// not needed in webpack\nasepriteSheet.convertPath = (originPath, relativePath) => {\n    // convertPath allows you to change how excalibur locates the resource\n    return beetlepng;\n}\n\nconst loader = new ex.Loader([asepriteSheet]);\ngame.start(loader).then(() => {\n    const actor = new ex.Actor({pos: game.screen.center });\n    actor.graphics.use(asepriteSheet.getAnimation('Loop') as ex.Animation)\n\n    game.currentScene.add(actor);\n});\n\n// end-snippet{aseprite}"],"names":["$18c11f3350a906ea$export$6503ec6e8aabbaf","$18c11f3350a906ea$export$f7ad0328861e2f03","$18c11f3350a906ea$var$mapping","pairs","keys","Object","i","length","id","resolved","Error","parcelRequire","register","JSON","parse","root","factory","self","__WEBPACK_EXTERNAL_MODULE__205__","t","AsepriteRaw","n1","i2","o1","t2","AsepriteResource","path","bustCache","this","_resource","Resource","convertPath","originPath","relativePath","indexOf","originSplit","split","relativeSplit","includes","pop","concat","join","load","asepriteData","imagepath","meta","image","spriteSheetImage","ImageSource","rawAseprite","data","AsepriteSpriteSheet","getSpriteSheet","isLoaded","Logger","getInstance","warn","getAnimation","name","r","i4","t5","asepriteRaw","_animations","Map","frameTag","frameTags","from","to","frameIndices","range","frames","values","filter","_","map","frame","duration","graphic","Sprite","sourceView","x","y","width","w","height","h","destSize","strategy","AnimationStrategy","Loop","direction","PingPong","reverse","set","Animation","sprites","sprite","push","_spriteSheet","SpriteSheet","rows","size","columns","has","get","n2","i5","t7","module","exports","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","__webpack_modules__","call","require","define","amd","ex","Plugin","Aseprite","$6bd24a379f1c9cdb$exports","URL","resolve","import","url","toString","$1c956181e2838df4$exports","$9c11e5ec57dcb02a$var$game","$3MXpL","Engine","displayMode","DisplayMode","FitScreen","$9c11e5ec57dcb02a$var$asepriteSheet","$ee52b050f43ab2a6$exports","$parcel$interopDefault","$9c11e5ec57dcb02a$var$loader","Loader","start","then","actor","Actor","pos","screen","center","graphics","use","currentScene","add"],"version":3,"file":"index.2df48535.js.map"}