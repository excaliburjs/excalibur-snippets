{"mappings":"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","sources":["node_modules/@parcel/runtime-js/lib/helpers/bundle-manifest.js","node_modules/@parcel/runtime-js/lib/runtime-c2ed29bdc4440962.js","node_modules/@excaliburjs/plugin-aseprite/dist/webpack:/ex.Plugin.Aseprite/webpack/universalModuleDefinition","node_modules/@excaliburjs/plugin-aseprite/dist/webpack:/ex.Plugin.Aseprite/src/AsepriteRaw.ts","node_modules/@excaliburjs/plugin-aseprite/dist/webpack:/ex.Plugin.Aseprite/src/AsepriteResource.ts","node_modules/@excaliburjs/plugin-aseprite/dist/webpack:/ex.Plugin.Aseprite/src/AsepriteSpriteSheet.ts","node_modules/@excaliburjs/plugin-aseprite/dist/webpack:/ex.Plugin.Aseprite/src/index.ts","node_modules/@excaliburjs/plugin-aseprite/dist/webpack:/ex.Plugin.Aseprite/external umd {\"commonjs\":\"excalibur\",\"commonjs2\":\"excalibur\",\"amd\":\"excalibur\",\"root\":\"ex\"}","node_modules/@excaliburjs/plugin-aseprite/dist/webpack:/ex.Plugin.Aseprite/webpack/bootstrap","node_modules/@excaliburjs/plugin-aseprite/dist/webpack:/ex.Plugin.Aseprite/webpack/startup","node_modules/@parcel/runtime-js/lib/helpers/bundle-url.js","node_modules/@parcel/runtime-js/lib/runtime-31f7d85cdd945d0d.js","node_modules/@parcel/runtime-js/lib/runtime-f7611b0ffdfff269.js","src/aseprite/main.ts"],"sourcesContent":["\"use strict\";\n\nvar mapping = {};\n\nfunction register(pairs) {\n  var keys = Object.keys(pairs);\n\n  for (var i = 0; i < keys.length; i++) {\n    mapping[keys[i]] = pairs[keys[i]];\n  }\n}\n\nfunction resolve(id) {\n  var resolved = mapping[id];\n\n  if (resolved == null) {\n    throw new Error('Could not resolve bundle with id ' + id);\n  }\n\n  return resolved;\n}\n\nmodule.exports.register = register;\nmodule.exports.resolve = resolve;","require('./helpers/bundle-manifest').register(JSON.parse(\"{\\\"a0hKM\\\":\\\"index.fa01ab94.js\\\",\\\"fTVXw\\\":\\\"beetle.956ebb15.json\\\",\\\"8JUwc\\\":\\\"beetle.404bb2a9.png\\\",\\\"cO1h0\\\":\\\"index.66fc245f.js\\\"}\"));","(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"excalibur\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"excalibur\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"ex\"] = factory(require(\"excalibur\"));\n\telse\n\t\troot[\"ex\"] = root[\"ex\"] || {}, root[\"ex\"][\"Plugin\"] = root[\"ex\"][\"Plugin\"] || {}, root[\"ex\"][\"Plugin\"][\"Aseprite\"] = factory(root[\"ex\"]);\n})(self, function(__WEBPACK_EXTERNAL_MODULE__205__) {\nreturn ","export class AsepriteRaw {\r\n    frames!: {\r\n        [key: string]: { \r\n            frame: { x: number, y: number, w: number, h: number },\r\n            rotated: boolean,\r\n            trimmed: boolean,\r\n            spriteSourceSize: { x: number, y: number, w: number, h: number },\r\n            sourceSize: { w: number, h: number },\r\n            duration: number\r\n        }\r\n    }\r\n    meta!: {\r\n        image: string,\r\n        size: { w: number, h: number },\r\n        scale: number,\r\n        format: string,\r\n        layers: { name: string, opacity: number, blendMode: string }[],\r\n        frameTags: { name: string, from: number, to: number, direction: string}[],\r\n        slices: any[]\r\n    }\r\n}","import { ImageSource, Loadable, Logger, Resource, SpriteSheet } from 'excalibur';\r\nimport { AsepriteRaw } from './AsepriteRaw';\r\nimport { AsepriteSpriteSheet } from './AsepriteSpriteSheet';\r\n\r\n\r\nexport class AsepriteResource implements Loadable<AsepriteSpriteSheet> {\r\n    private _resource: Resource<AsepriteRaw>;\r\n    public data!: AsepriteSpriteSheet;\r\n    public rawAseprite!: AsepriteRaw;\r\n    public image!: ImageSource;\r\n\r\n    public convertPath: (originPath: string, relativePath: string) => string;\r\n    constructor(path: string, public bustCache = false) {\r\n        this._resource = new Resource(path, 'json', bustCache);\r\n        this.convertPath = (originPath: string, relativePath: string) => {\r\n            // Use absolute path if specified\r\n            if (relativePath.indexOf('/') === 0) {\r\n                return relativePath;\r\n            }\r\n\r\n            const originSplit = originPath.split('/');\r\n            const relativeSplit = relativePath.split('/');\r\n            // if origin path is a file, remove it so it's a directory\r\n            if (originSplit[originSplit.length - 1].includes('.')) {\r\n                originSplit.pop();\r\n            }\r\n            return originSplit.concat(relativeSplit).join('/');\r\n        }\r\n    }\r\n\r\n\r\n\r\n    public async load(): Promise<AsepriteSpriteSheet> {\r\n        const asepriteData = await this._resource.load();\r\n        const imagepath = this.convertPath(this._resource.path, asepriteData.meta.image);\r\n        const spriteSheetImage = new ImageSource(imagepath, this.bustCache);\r\n        await spriteSheetImage.load();\r\n        this.rawAseprite = asepriteData;\r\n        this.image = spriteSheetImage;\r\n        return this.data = new AsepriteSpriteSheet(asepriteData, spriteSheetImage);\r\n    }\r\n\r\n    public getSpriteSheet() {\r\n        if (this.isLoaded()) {\r\n            return this.data.getSpriteSheet();\r\n        } else {\r\n            Logger.getInstance().warn('AspriteResource must be loaded before .getSpriteSheet() is called');\r\n        }\r\n    }\r\n\r\n    public getAnimation(name: string) {\r\n        if (this.isLoaded()) {\r\n            return this.data.getAnimation(name);\r\n        } else {\r\n            Logger.getInstance().warn('AspriteResource must be loaded before .getAnimation() is called');\r\n        }\r\n    }\r\n\r\n\r\n    isLoaded(): boolean {\r\n        return !!this.data;\r\n    }\r\n}","import { Frame, ImageSource, range, Sprite, SpriteSheet, Animation, AnimationStrategy } from \"excalibur\";\r\nimport { AsepriteRaw } from \"./AsepriteRaw\";\r\n\r\n\r\nexport class AsepriteSpriteSheet {\r\n    private _spriteSheet: SpriteSheet;\r\n    private _animations = new Map<string, Animation>()\r\n    constructor(public asepriteRaw: AsepriteRaw, public image: ImageSource) {\r\n        for (let frameTag of asepriteRaw.meta.frameTags) {\r\n            let from = frameTag.from;\r\n            let to = frameTag.to;\r\n            let frameIndices = range(from, to);\r\n            let frames: Frame[] = Object.values(asepriteRaw.frames)\r\n            .filter((_, id) => {\r\n                return frameIndices.includes(id);\r\n            })\r\n            .map(frame => ({\r\n                duration: frame.duration,\r\n                graphic: new Sprite({\r\n                    image,\r\n                    sourceView: {\r\n                        x: frame.frame.x,\r\n                        y: frame.frame.y,\r\n                        width: frame.frame.w,\r\n                        height: frame.frame.h\r\n                    },\r\n                    destSize: {\r\n                        width: frame.frame.w,\r\n                        height: frame.frame.h\r\n                    }\r\n                })\r\n            }));\r\n            let strategy = AnimationStrategy.Loop;\r\n            switch(frameTag.direction) {\r\n                case \"pingpong\": {\r\n                    strategy = AnimationStrategy.PingPong\r\n                    break;\r\n                }\r\n                case \"reverse\": {\r\n                    frames.reverse();\r\n                    break;\r\n                }\r\n            }\r\n            this._animations.set(frameTag.name, new Animation({frames, strategy}));\r\n        }\r\n\r\n        const sprites: Sprite[] = [];\r\n        for (let sprite of Object.values(asepriteRaw.frames)) {\r\n            sprites.push(new Sprite({\r\n                image,\r\n                sourceView: {\r\n                    x: sprite.frame.x,\r\n                    y: sprite.frame.y,\r\n                    width: sprite.frame.w,\r\n                    height: sprite.frame.h\r\n                }\r\n            }));\r\n        }\r\n        this._spriteSheet = new SpriteSheet({\r\n            sprites,\r\n            rows: asepriteRaw.meta.size.h / sprites[0].height,\r\n            columns: asepriteRaw.meta.size.w / sprites[0].width\r\n        });\r\n    }\r\n\r\n    getSpriteSheet(): SpriteSheet {\r\n        return this._spriteSheet\r\n    }\r\n\r\n    getAnimation(name: string): Animation {\r\n        if (!this._animations.has(name)) {\r\n            throw new Error(`No animation exists with name ${name}, check your exported Aseprite file`);\r\n        }\r\n        return this._animations.get(name) as Animation;\r\n    }\r\n}","\r\nexport * from './AsepriteRaw';\r\nexport * from './AsepriteResource';\r\nexport * from './AsepriteSpriteSheet';","module.exports = __WEBPACK_EXTERNAL_MODULE__205__;","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// startup\n// Load entry module and return exports\n// This entry module is referenced by other modules so it can't be inlined\nvar __webpack_exports__ = __webpack_require__(607);\n","\"use strict\";\n\nvar bundleURL = {};\n\nfunction getBundleURLCached(id) {\n  var value = bundleURL[id];\n\n  if (!value) {\n    value = getBundleURL();\n    bundleURL[id] = value;\n  }\n\n  return value;\n}\n\nfunction getBundleURL() {\n  try {\n    throw new Error();\n  } catch (err) {\n    var matches = ('' + err.stack).match(/(https?|file|ftp):\\/\\/[^)\\n]+/g);\n\n    if (matches) {\n      // The first two stack frames will be this function and getBundleURLCached.\n      // Use the 3rd one, which will be a runtime in the original bundle.\n      return getBaseURL(matches[2]);\n    }\n  }\n\n  return '/';\n}\n\nfunction getBaseURL(url) {\n  return ('' + url).replace(/^((?:https?|file|ftp):\\/\\/.+)\\/[^/]+$/, '$1') + '/';\n} // TODO: Replace uses with `new URL(url).origin` when ie11 is no longer supported.\n\n\nfunction getOrigin(url) {\n  var matches = ('' + url).match(/(https?|file|ftp):\\/\\/[^/]+/);\n\n  if (!matches) {\n    throw new Error('Origin not found');\n  }\n\n  return matches[0];\n}\n\nexports.getBundleURL = getBundleURLCached;\nexports.getBaseURL = getBaseURL;\nexports.getOrigin = getOrigin;","module.exports = require('./helpers/bundle-url').getBundleURL('a0hKM') + \"../\" + require('./helpers/bundle-manifest').resolve(\"fTVXw\");","module.exports = require('./helpers/bundle-url').getBundleURL('a0hKM') + \"../\" + require('./helpers/bundle-manifest').resolve(\"8JUwc\");","import * as ex from 'excalibur';\nimport * as aseprite from '@excaliburjs/plugin-aseprite';\nimport beetlejson from './beetle.json';\nimport beetlepng from './beetle.png';\n\n// start-snippet{aseprite}\nconst game = new ex.Engine({\n    width: 600,\n    height: 400,\n    displayMode: ex.DisplayMode.FitScreen\n});\n\nconst asepriteSheet = new aseprite.AsepriteResource(beetlejson);\n// hack for parcel v2 asset paths\n// not needed in webpack\nasepriteSheet.convertPath = (originPath, relativePath) => {\n    // convertPath allows you to change how excalibur locates the resource\n    return beetlepng;\n}\n\nconst loader = new ex.Loader([asepriteSheet]);\ngame.start(loader).then(() => {\n    const actor = new ex.Actor({pos: game.screen.center });\n    actor.graphics.use(asepriteSheet.getAnimation('Loop') as ex.Animation)\n\n    game.currentScene.add(actor);\n});\n\n// end-snippet{aseprite}"],"names":["$8b4d1930797b255e$export$6503ec6e8aabbaf","$8b4d1930797b255e$export$f7ad0328861e2f03","$8b4d1930797b255e$var$mapping","pairs","keys","Object","i","length","id","resolved","Error","parcelRequire","register","JSON","parse","root","factory","self","__WEBPACK_EXTERNAL_MODULE__205__","t","AsepriteRaw","n","o","AsepriteResource","path","bustCache","this","_resource","Resource","convertPath","originPath","relativePath","indexOf","originSplit","split","relativeSplit","includes","pop","concat","join","load","asepriteData","imagepath","meta","image","spriteSheetImage","ImageSource","rawAseprite","data","AsepriteSpriteSheet","getSpriteSheet","isLoaded","Logger","getInstance","warn","getAnimation","name","r","asepriteRaw","_animations","Map","frameTag","frameTags","from","to","frameIndices","range","frames","values","filter","_","map","frame","duration","graphic","Sprite","sourceView","x","y","width","w","height","h","destSize","strategy","AnimationStrategy","Loop","direction","PingPong","reverse","set","Animation","sprites","sprite","push","_spriteSheet","SpriteSheet","rows","size","columns","has","get","module","exports","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","__webpack_modules__","call","require","define","amd","ex","Plugin","Aseprite","$f29cd6c67ea13581$export$bdfd709ae4826697","$f29cd6c67ea13581$var$bundleURL","$f29cd6c67ea13581$var$getBaseURL","url","replace","value","err","matches","stack","match","$f29cd6c67ea13581$var$getBundleURL","$00b67a0328c20f65$exports","getBundleURL","resolve","$0a1e0a039433c99c$exports","$b812770f2b149ea9$var$game","$jLJwM","Engine","displayMode","DisplayMode","FitScreen","$b812770f2b149ea9$var$asepriteSheet","$9e755c237648c020$exports","$parcel$interopDefault","$b812770f2b149ea9$var$loader","Loader","start","then","actor","Actor","pos","screen","center","graphics","use","currentScene","add"],"version":3,"file":"index.fa01ab94.js.map"}