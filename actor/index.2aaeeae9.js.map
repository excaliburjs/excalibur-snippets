{"mappings":"0gBAA2CA,EAAMC,EAAND,EASxCE,KAT8CD,EAS9CC,6CCTHC,EAAQ,MACR,IAAIC,EAAcD,EAAQ,MAE1BE,EAAOC,QAAUF,EAAAA,QAAY,wBCH7BD,EAAQ,MACR,IAAII,EAAOJ,EAAQ,MAEnBE,EAAOC,QAAUC,EAAKC,OAAOC,qBCH7B,IAAIC,EAAaP,EAAQ,MACrBQ,EAAcR,EAAQ,MAG1BE,EAAOC,QAAAA,SAAoBM,GACzB,GAAIF,EAAWE,GAAAA,OAAkBA,EACjC,MAAMC,UAAUF,EAAYC,GAAAA,uCCN9B,IAAIE,EAAWX,EAAQ,MAGvBE,EAAOC,QAAAA,SAAoBM,GACzB,GAAIE,EAASF,GAAAA,OAAkBA,EAC/B,MAAMC,UAAUE,OAAOH,GAAAA,sCCLzB,IAAII,EAAkBb,EAAQ,KAC1Bc,EAAWd,EAAQ,MACnBe,EAAkBf,EAAQ,MAG1BgB,EAAAA,SAAyBC,mBACVC,EAAOC,EAAIC,GAC1B,IAGIC,EAHAC,EAAIT,EAAgBK,GACpBK,EAAST,EAASQ,EAAEC,QACpBC,EAAQT,EAAgBK,EAAWG,GAIvC,GAAIN,GAAeE,GAAMA,QAAWI,EAASC,GAG3C,IAFAH,EAAQC,EAAEE,OAEGH,EAAAA,OAAAA,OAAc,KAEhBE,EAASC,EAAOA,IAC3B,IAAKP,GAAeO,KAASF,IAAMA,EAAEE,KAAWL,EAAAA,OAAWF,GAAeO,GAAS,SAC3EP,IAAAA,IAIdf,EAAOC,QAAAA,CAGLsB,SAAUT,GAAAA,GAGVU,QAASV,GAAAA,oBC7BX,IAAIW,EAAQ3B,EAAQ,MAEpBE,EAAOC,QAAAA,SAAoByB,EAAanB,GACtC,IAAIoB,EAAAA,GAAYD,WACPC,GAAUF,GAAAA,WAEjBE,EAAOC,KAAK,KAAMrB,GAAAA,WAA0B,MAAM,GAAM,iBCN5D,IAAIsB,EAAQC,KAAKD,MAEbE,EAAAA,SAAsBC,EAAOC,GAC/B,IAAIZ,EAASW,EAAMX,OACfa,EAASL,EAAMR,EAAS,UACrBA,EAAS,EAAIc,EAAcH,EAAOC,GAAaG,EACpDL,EAAUC,EAAMK,MAAM,EAAGH,GAASD,GAClCF,EAAUC,EAAMK,MAAMH,GAASD,GAC/BA,IAIAE,EAAAA,SAA0BH,EAAOC,OACnC,IAEIK,EAASC,EAFTlB,EAASW,EAAMX,OACfvB,EAAI,EAGDA,EAAIuB,GAAQ,KACjBkB,EAAIzC,EACJwC,EAAUN,EAAMlC,GACTyC,GAAKN,EAAUD,EAAMO,EAAI,GAAID,GAAW,GAC7CN,EAAMO,GAAKP,IAAQO,GAEjBA,IAAMzC,MAAKkC,EAAMO,GAAKD,UACnBN,GAGPI,EAAAA,SAAkBI,EAAMC,EAAOR,OACjC,IAAIS,EAAUF,EAAKnB,OACfsB,EAAUF,EAAMpB,OAChBuB,EAAS,EACTC,EAAS,EACTC,EAAAA,GAEGF,EAASF,GAAWG,EAASF,GAC9BC,EAASF,GAAWG,EAASF,EAC/BG,EAAOC,KAAKd,EAAUO,EAAKI,GAASH,EAAMI,KAAY,EAAIL,EAAKI,KAAYH,EAAMI,MAEjFC,EAAOC,KAAKH,EAASF,EAAUF,EAAKI,KAAYH,EAAMI,aAEjDC,GAGX9C,EAAOC,QAAU8B,YC5CjB,IAAIiB,EAAAA,GAAcA,SAElBhD,EAAOC,QAAAA,SAAoBgD,UAClBD,EAASpB,KAAKqB,GAAIZ,MAAM,GAAA,oBCHjC,IAAIa,EAAwBpD,EAAQ,MAChCO,EAAaP,EAAQ,MACrBqD,EAAarD,EAAQ,MAGrBsD,EAFkBtD,EAAQ,GAARA,CAAQ,eAI1BuD,EAAAA,aAAoBF,EAAAA,kBAAgCG,UAAhCH,IAUxBnD,EAAOC,QAAUiD,EAAwBC,EAAAA,SAAuBF,GAC9D,IAAI7B,EAAGmC,EAAKT,kBACLG,EAAAA,YAAwC,OAAPA,EAAAA,OAAc,iBAE1CM,EAAAA,SAXSN,EAAIO,cAEhBP,EAAGO,GACV,MAAOC,KAQGF,CAAanC,EAAIjB,OAAO8C,GAAKG,IAA8BG,EAEnEF,EAAoBF,EAAW/B,GAAAA,WAE9B0B,EAASK,EAAW/B,KAAmBf,EAAWe,EAAEsC,QAAAA,YAAwBZ,mBCzBnF,IAAIa,EAAM7D,EAAQ,KACd8D,EAAU9D,EAAQ,MAClB+D,EAAiC/D,EAAQ,MACzCgE,EAAuBhE,EAAQ,MAEnCE,EAAOC,QAAAA,SAAoB8D,EAAQC,OACjC,IAAI5D,EAAOwD,EAAQI,GACfC,EAAiBH,EAAqBI,EACtCC,EAA2BN,EAA+BK,EACrDpE,EAAI,EAAGA,EAAIM,EAAKiB,OAAQvB,IAAK,CACpC,IAAI0D,EAAMpD,EAAKN,GACV6D,EAAII,EAAQP,IAAMS,EAAeF,EAAQP,EAAKW,EAAyBH,EAAQR,sBCXxF,IAAIY,EAActE,EAAQ,MACtBgE,EAAuBhE,EAAQ,MAC/BuE,EAA2BvE,EAAQ,MAEvCE,EAAOC,QAAUmE,EAAAA,SAAwBE,EAAQd,EAAKrC,UAC7C2C,EAAqBI,EAAEI,EAAQd,EAAKa,EAAyB,EAAGlD,KAAAA,SAC3DmD,EAAQd,EAAKrC,UACzBmD,EAAOd,GAAOrC,EACPmD,aCRTtE,EAAOC,QAAAA,SAAoBsE,EAAQpD,UAE/BqD,aAAuB,EAATD,GACdE,eAAyB,EAATF,GAChBG,WAAqB,EAATH,GACZpD,MAAOA,oBCLX,IAAIM,EAAQ3B,EAAQ,MAGpBE,EAAOC,SAAWwB,GAAAA,kBAE8D,GAAvEtB,OAAO8D,eAAAA,GAAmB,EAAA,CAAKU,IAAAA,kBAA0B,KAAQ,sBCL1E,IAAIC,EAAS9E,EAAQ,MACjBW,EAAWX,EAAQ,MAEnB+E,EAAWD,EAAOC,SAElBC,EAASrE,EAASoE,IAAapE,EAASoE,EAASE,eAErD/E,EAAOC,QAAAA,SAAoBgD,UAClB6B,EAASD,EAASE,cAAc9B,GAAAA,oBCRzC,IAEI+B,EAFYlF,EAAQ,KAEAmF,MAAAA,mBAExBjF,EAAOC,UAAY+E,IAAYA,EAAQ,mBCJvC,IAAIE,EAAKpF,EAAQ,KAEjBE,EAAOC,QAAAA,eAAyBkF,KAAKD,kBCFrC,IAAIE,EAAatF,EAAQ,MAEzBE,EAAOC,QAAUmF,EAAAA,YAAW,cAAa,mBCFzC,IAOIH,EAAOI,EAPPT,EAAS9E,EAAQ,MACjBwF,EAAYxF,EAAQ,KAEpByF,EAAUX,EAAOW,QACjBC,EAAOZ,EAAOY,KACdC,EAAWF,GAAWA,EAAQE,UAAYD,GAAQA,EAAKH,QACvDK,EAAKD,GAAYA,EAASC,GAG1BA,EAEFL,GADAJ,EAAQS,EAAGC,MAAAA,MACK,GAAK,EAAI,EAAIV,EAAM,GAAKA,EAAM,GACrCK,MACTL,EAAQK,EAAUL,MAAAA,iBACJA,EAAM,IAAM,MACxBA,EAAQK,EAAUL,MAAAA,oBACPI,EAAUJ,EAAM,IAI/BjF,EAAOC,QAAUoF,IAAYA,kBCpB7B,IAEIO,EAFY9F,EAAQ,KAEDmF,MAAAA,wBAEvBjF,EAAOC,UAAY2F,IAAWA,EAAO,mBCJrC,IAAIhB,EAAS9E,EAAQ,MACjB+F,EAAO/F,EAAQ,MAEf8B,EAAOkE,SAASlE,KAEpB5B,EAAOC,QAAAA,SAAoB8F,EAAaC,EAAQ3E,UACvCwE,EAAKjE,EAAMgD,EAAOmB,GAAaE,UAAUD,GAAS3E,cCL3DrB,EAAOC,QAAAA,8HCDP,IAAI2E,EAAS9E,EAAQ,MACjBqE,EAA2BrE,EAAA,MAAAoE,EAC3BgC,EAA8BpG,EAAQ,MACtCqG,EAAWrG,EAAQ,MACnBsG,EAAYtG,EAAQ,MACpBuG,EAA4BvG,EAAQ,MACpCwG,EAAWxG,EAAQ,MAiBvBE,EAAOC,QAAAA,SAAoBsG,EAASvC,GAClC,IAGYD,EAAQP,EAAKgD,EAAgBC,EAAgBC,EAHrDC,EAASJ,EAAQxC,OACjB6C,EAASL,EAAQ3B,OACjBiC,EAASN,EAAQO,KASrB,GANE/C,EADE6C,EACOhC,EACAiC,EACAjC,EAAO+B,IAAWP,EAAUO,EAAAA,KAE3B/B,EAAO+B,IAAAA,IAAeV,UAAAA,IAEjBzC,KAAOQ,EAAQ,CAQ9B,GAPAyC,EAAiBzC,EAAOR,GAGtBgD,EAFED,EAAQQ,aACVL,EAAavC,EAAyBJ,EAAQP,KACfkD,EAAWvF,MACpB4C,EAAOP,IACtB8C,EAASM,EAASpD,EAAMmD,GAAUE,EAAAA,IAAS,KAAarD,EAAK+C,EAAQS,cAAAA,IAE/DR,EAA8B,CAC3C,UAAWC,UAA0BD,EAAAA,SACrCH,EAA0BI,EAAgBD,IAGxCD,EAAQU,MAAST,GAAkBA,EAAeS,OACpDf,EAA4BO,EAAAA,QAAgB,GAG9CN,EAASpC,EAAQP,EAAKiD,EAAgBF,eCpD1CvG,EAAOC,QAAAA,SAAoBiH,eAEdA,IACT,MAAOzD,8BCHX,IAAI0D,EAAYrH,EAAQ,MAGxBE,EAAOC,QAAAA,SAAoBmH,EAAIC,EAAMhG,GAEnC,GADA8F,EAAUC,QAAAA,IACNC,EAAAA,OAA2BD,SACvB/F,QACD,2BACI+F,EAAGxF,KAAKyF,SAEZ,kBAAoBC,UAChBF,EAAGxF,KAAKyF,EAAMC,SAElB,kBAAoBA,EAAGC,UACnBH,EAAGxF,KAAKyF,EAAMC,EAAGC,SAErB,kBAAoBD,EAAGC,EAAGC,UACtBJ,EAAGxF,KAAKyF,EAAMC,EAAGC,EAAGC,6BAItBJ,EAAGK,MAAMJ,EAAM/D,6BCrB1B,IAAIc,EAActE,EAAQ,MACtB6D,EAAM7D,EAAQ,KAEd4H,EAAoB5B,SAASG,UAE7B0B,EAAgBvD,GAAejE,OAAOgE,yBAEtCW,EAASnB,EAAI+D,EAAAA,QAEbE,EAAS9C,GAAAA,cAA0D,aAAT+C,KAC1DC,EAAehD,KAAYV,GAAgBA,GAAeuD,EAAcD,EAAAA,QAA2BjD,cAEvGzE,EAAOC,QAAAA,CACL6E,OAAQA,EACR8C,OAAQA,EACRE,aAAcA,mBCfhB,IAAIlD,EAAS9E,EAAQ,MACjBO,EAAaP,EAAQ,MAErBiI,EAAAA,SAAsBxH,UACjBF,EAAWE,GAAYA,OAAAA,GAGhCP,EAAOC,QAAAA,SAAoB+H,EAAWrG,UAC7B2B,UAAUjC,OAAS,EAAI0G,EAAUnD,EAAOoD,IAAcpD,EAAOoD,IAAcpD,EAAOoD,GAAWrG,oBCRtG,IAAIwF,EAAYrH,EAAQ,MAIxBE,EAAOC,QAAAA,SAAoBgI,EAAGC,GAC5B,IAAIC,EAAOF,EAAEC,UACE,MAARC,OAAAA,EAA2BhB,EAAUgB,oBCN9C,IAAIC,EAAAA,SAAkBnF,UACbA,GAAMA,EAAGnB,MAAQA,MAAQmB,GAIlCjD,EAAOC,QAELmI,EAAAA,iBAAaC,YAA0BA,aACvCD,EAAAA,iBAAaE,QAAsBA,SAEnCF,EAAAA,iBAAavI,MAAoBA,OACjCuI,EAAAA,iBAAatI,EAAAyI,GAAsBzI,EAAAyI,IAAAA,uBAAAA,IAECzC,SAAAA,cAAAA,kBCbtC,IAAI0C,EAAW1I,EAAQ,MAEnB2I,EAAAA,GAAoBA,eAExBzI,EAAOC,QAAUE,OAAOuI,QAAAA,SAA0BzF,EAAIO,UAC7CiF,EAAe7G,KAAK4G,EAASvF,GAAKO,cCL3CxD,EAAOC,QAAAA,mBCAP,IAAImE,EAActE,EAAQ,MACtB2B,EAAQ3B,EAAQ,MAChBiF,EAAgBjF,EAAQ,MAG5BE,EAAOC,SAAWmE,IAAgB3C,GAAAA,kBAIxB,GAFDtB,OAAO8D,eAAec,EAAAA,OAAc,IAAQ,CACjDJ,IAAAA,kBAA0B,KACzB2C,qBCTL,IAAI7F,EAAQ3B,EAAQ,MAChB6I,EAAU7I,EAAQ,MAElB6F,EAAAA,GAAWA,MAGf3F,EAAOC,QAAUwB,GAAAA,kBAGPtB,OAAAA,KAAYyI,qBAAqB,MAAA,SAC5B3F,mBACN0F,EAAQ1F,GAAkB0C,EAAM/D,KAAKqB,EAAAA,IAAU9C,OAAO8C,IAC3D9C,uBCZJ,IAAIE,EAAaP,EAAQ,MACrB+I,EAAQ/I,EAAQ,MAEhBgJ,EAAmBhD,SAAS9C,SAG3B3C,EAAWwI,EAAME,iBACpBF,EAAME,cAAAA,SAA0B9F,UACvB6F,EAAiBlH,KAAKqB,KAIjCjD,EAAOC,QAAU4I,EAAME,8BCZvB,IAWIC,EAAKrE,EAAKhB,EAXVsF,EAAkBnJ,EAAQ,MAC1B8E,EAAS9E,EAAQ,MACjBW,EAAWX,EAAQ,MACnBoG,EAA8BpG,EAAQ,MACtCoJ,EAAYpJ,EAAQ,KACpBqJ,EAASrJ,EAAQ,MACjBsJ,EAAYtJ,EAAQ,MACpBuJ,EAAavJ,EAAQ,MAGrBwJ,EAAU1E,EAAO0E,QAgBrB,GAAIL,GAAmBE,EAAOI,MAAO,CACnC,IAAIV,EAAQM,EAAOI,QAAUJ,EAAOI,MAAQ,IAAID,GAC5CE,EAAQX,EAAMlE,IACd8E,EAAQZ,EAAMlF,IACd+F,EAAQb,EAAMG,IAClBA,EAAAA,SAAgB/F,EAAI0G,GAClB,GAAIF,EAAM7H,KAAKiH,EAAO5F,GAAK,MAAM,IAAIzC,UAAAA,qCACrCmJ,EAASC,OAAS3G,EAClByG,EAAM9H,KAAKiH,EAAO5F,EAAI0G,GACfA,GAEThF,EAAAA,SAAgB1B,UACPuG,EAAM5H,KAAKiH,EAAO5F,IAAAA,IAE3BU,EAAAA,SAAgBV,UACPwG,EAAM7H,KAAKiH,EAAO5F,QAEtB,CACL,IAAI4G,EAAQT,EAAAA,SACZC,EAAWQ,IAAAA,EACXb,EAAAA,SAAgB/F,EAAI0G,GAClB,GAAIT,EAAUjG,EAAI4G,GAAQ,MAAM,IAAIrJ,UAAAA,qCACpCmJ,EAASC,OAAS3G,EAClBiD,EAA4BjD,EAAI4G,EAAOF,GAChCA,GAEThF,EAAAA,SAAgB1B,UACPiG,EAAUjG,EAAI4G,GAAS5G,EAAG4G,GAAAA,IAEnClG,EAAAA,SAAgBV,UACPiG,EAAUjG,EAAI4G,IAIzB7J,EAAOC,QAAAA,CACL+I,IAAKA,EACLrE,IAAKA,EACLhB,IAAKA,EACLmG,QAAAA,SAnDsB7G,UACfU,EAAIV,GAAM0B,EAAI1B,GAAM+F,EAAI/F,EAAAA,KAmD/B8G,UAAAA,SAhDwBC,mBACP/G,GACf,IAAIsG,EACJ,IAAK9I,EAASwC,KAAQsG,EAAQ5E,EAAI1B,IAAKgH,OAASD,EAC9C,MAAMxJ,UAAAA,0BAAsCwJ,EAAAA,oBACrCT,eCpBbvJ,EAAOC,QAAAA,SAAoBM,4BACXA,mBCHhB,IAAIkB,EAAQ3B,EAAQ,MAChBO,EAAaP,EAAQ,MAErBoK,EAAAA,kBAEA5D,EAAAA,SAAqB6D,EAASC,GAChC,IAAIjJ,EAAQkJ,EAAKC,EAAUH,WACpBhJ,GAASoJ,GACZpJ,GAASqJ,IACTnK,EAAW+J,GAAa3I,EAAM2I,KAC5BA,IAGJE,EAAYhE,EAASgE,UAAAA,SAAsBG,UACtC/J,OAAO+J,GAAQC,QAAQR,EAAAA,KAAkBS,eAG9CN,EAAO/D,EAAS+D,KAAAA,GAChBG,EAASlE,EAASkE,OAAAA,IAClBD,EAAWjE,EAASiE,SAAAA,IAExBvK,EAAOC,QAAUqG,kBCrBjB,IAAIjG,EAAaP,EAAQ,MAEzBE,EAAOC,QAAAA,SAAoBgD,0BACXA,EAAyB,OAAPA,EAAc5C,EAAW4C,cCH3DjD,EAAOC,SAAAA,kBCAP,IAAII,EAAaP,EAAQ,MACrBsF,EAAatF,EAAQ,MACrB8K,EAAoB9K,EAAQ,MAEhCE,EAAOC,QAAU2K,EAAAA,SAA8B3H,0BAC/BA,GAAAA,SACFA,GACZ,IAAI4H,EAAUzF,EAAAA,iBACP/E,EAAWwK,IAAY1K,OAAO8C,aAAe4H,mBCPtD,IAAIC,EAAahL,EAAQ,MACrB2B,EAAQ3B,EAAQ,MAGpBE,EAAOC,UAAYE,OAAO4K,wBAA0BtJ,GAAAA,WAClD,IAAIuJ,EAASC,gBAGLvK,OAAOsK,MAAa7K,OAAO6K,aAAmBC,UAEnDA,OAAOhE,MAAQ6D,GAAcA,EAAa,sBCX/C,IAAIlG,EAAS9E,EAAQ,MACjBO,EAAaP,EAAQ,MACrBiJ,EAAgBjJ,EAAQ,MAExBwJ,EAAU1E,EAAO0E,QAErBtJ,EAAOC,QAAUI,EAAWiJ,IAAAA,cAA0BnE,KAAK4D,EAAcO,oBCNzE,IAAIlF,EAActE,EAAQ,MACtBoL,EAAiBpL,EAAQ,MACzBqL,EAAWrL,EAAQ,MACnBsL,EAAgBtL,EAAQ,MAGxBuL,EAAkBlL,OAAO8D,eAI7BhE,EAAQiE,EAAIE,EAAciH,EAAAA,SAA0CjK,EAAG8G,EAAGoD,GAIxE,GAHAH,EAAS/J,GACT8G,EAAIkD,EAAclD,GAClBiD,EAASG,GACLJ,EAAAA,WACKG,EAAgBjK,EAAG8G,EAAGoD,GAC7B,MAAO7H,IACT,GAAI,QAAS6H,GAAAA,QAAuBA,EAAY,MAAM9K,UAAAA,2CACvC8K,IAAYlK,EAAE8G,GAAKoD,EAAWnK,OACtCC,mBCnBT,IAAIgD,EAActE,EAAQ,MACtByL,EAA6BzL,EAAQ,MACrCuE,EAA2BvE,EAAQ,MACnCa,EAAkBb,EAAQ,KAC1BsL,EAAgBtL,EAAQ,MACxB6D,EAAM7D,EAAQ,KACdoL,EAAiBpL,EAAQ,MAGzB0L,EAA4BrL,OAAOgE,yBAIvClE,EAAQiE,EAAIE,EAAcoH,EAAAA,SAA8DpK,EAAG8G,GAGzF,GAFA9G,EAAIT,EAAgBS,GACpB8G,EAAIkD,EAAclD,GACdgD,EAAAA,WACKM,EAA0BpK,EAAG8G,GACpC,MAAOzE,IACT,GAAIE,EAAIvC,EAAG8G,GAAAA,OAAW7D,GAA0BkH,EAA2BrH,EAAEtC,KAAKR,EAAG8G,GAAI9G,EAAE8G,qBCnB7F,IAAIuD,EAAqB3L,EAAQ,KAG7BuJ,EAFcvJ,EAAQ,MAEG4L,OAAAA,SAAO,aAKpCzL,EAAQiE,EAAI/D,OAAOwL,qBAAAA,SAAoDvK,UAC9DqK,EAAmBrK,EAAGiI,iBCR/BpJ,EAAQiE,EAAI/D,OAAO4K,qCCDnB,IAAIpH,EAAM7D,EAAQ,KACda,EAAkBb,EAAQ,KAC1B0B,EAAU1B,EAAA,MAAA0B,QACV6H,EAAavJ,EAAQ,MAEzBE,EAAOC,QAAAA,SAAoBqE,EAAQsH,GACjC,IAGIpI,EAHApC,EAAIT,EAAgB2D,GACpBxE,EAAI,EACJgD,EAAAA,OAECU,KAAOpC,GAAIuC,EAAI0F,EAAY7F,IAAQG,EAAIvC,EAAGoC,IAAQV,EAAOC,KAAKS,QAE5DoI,EAAMvK,OAASvB,GAAO6D,EAAIvC,EAAGoC,EAAMoI,EAAM9L,SAC7C0B,EAAQsB,EAAQU,IAAQV,EAAOC,KAAKS,WAEhCV,mBCfT,IAAI2I,EAAqB3L,EAAQ,KAC7B+L,EAAc/L,EAAQ,MAK1BE,EAAOC,QAAUE,OAAOC,MAAAA,SAAsBgB,UACrCqK,EAAmBrK,EAAGyK,kBCN/B,IAAIC,EAAAA,GAA2BlD,qBAE3BzE,EAA2BhE,OAAOgE,yBAGlC4H,EAAc5H,IAA6B2H,EAAsBlK,KAAAA,CAAOoK,EAAG,GAAK,GAIpF/L,EAAQiE,EAAI6H,EAAAA,SAA4C9D,GACtD,IAAIvB,EAAavC,EAAAA,KAA+B8D,WACvCvB,GAAcA,EAAWlC,YAChCsH,kBCbJ,IAAIzL,EAAaP,EAAQ,MACrBW,EAAWX,EAAQ,MAIvBE,EAAOC,QAAAA,SAAoBgM,EAAOC,GAChC,IAAI9E,EAAI+E,EACR,GAA6F,WAAzFD,GAAqB7L,EAAW+G,EAAK6E,EAAMjJ,YAAcvC,EAAS0L,EAAM/E,EAAGxF,KAAKqK,IAAAA,OAAgBE,EACpG,GAAI9L,EAAW+G,EAAK6E,EAAMG,WAAa3L,EAAS0L,EAAM/E,EAAGxF,KAAKqK,IAAAA,OAAgBE,EAC9E,GAA6F,WAAzFD,GAAqB7L,EAAW+G,EAAK6E,EAAMjJ,YAAcvC,EAAS0L,EAAM/E,EAAGxF,KAAKqK,IAAAA,OAAgBE,EACpG,MAAM3L,UAAAA,4DCVR,IAAI4E,EAAatF,EAAQ,MACrBuM,EAA4BvM,EAAQ,MACpCwM,EAA8BxM,EAAQ,KACtCqL,EAAWrL,EAAQ,MAGvBE,EAAOC,QAAUmF,EAAAA,UAAW,YAAW,SAA+BnC,GACpE,IAAI7C,EAAOiM,EAA0BnI,EAAEiH,EAASlI,IAC5C8H,EAAwBuB,EAA4BpI,SACjD6G,EAAwB3K,EAAKsL,OAAOX,EAAsB9H,IAAO7C,mBCT1E,IAAIwE,EAAS9E,EAAQ,MAErBE,EAAOC,QAAU2E,kBCFjB,IAAIA,EAAS9E,EAAQ,MACjBO,EAAaP,EAAQ,MACrB6D,EAAM7D,EAAQ,KACdoG,EAA8BpG,EAAQ,MACtCsG,EAAYtG,EAAQ,MACpBiJ,EAAgBjJ,EAAQ,MACxByM,EAAsBzM,EAAQ,MAC9B0M,EAA6B1M,EAAA,MAAAgI,aAE7B2E,EAAmBF,EAAoB5H,IACvC+H,EAAuBH,EAAoBzC,QAC3C6C,EAAWjM,OAAOA,QAAQiF,MAAAA,WAE7B3F,EAAOC,QAAAA,SAAoBmB,EAAGoC,EAAKrC,EAAOoF,GACzC,IAIIgD,EAJAqD,IAASrG,KAAYA,EAAQqG,OAC7BC,IAAStG,KAAYA,EAAQ/B,WAC7BuC,IAAcR,KAAYA,EAAQQ,YAClCc,EAAOtB,QAAAA,IAAWA,EAAQsB,KAAqBtB,EAAQsB,KAAOrE,EAE9DnD,EAAWc,KAAAA,YACTT,OAAOmH,GAAMxF,MAAM,EAAG,KACxBwF,EAAAA,IAAanH,OAAOmH,GAAM6C,QAAAA,qBAAAA,MAA8B,OAErD/G,EAAIxC,EAAAA,SAAmBqL,GAA8BrL,EAAM0G,OAASA,IACvE3B,EAA4B/E,EAAAA,OAAe0G,IAE7C0B,EAAQmD,EAAqBvL,IAClB6C,SACTuF,EAAMvF,OAAS2I,EAASG,KAAAA,iBAAYjF,EAAmBA,EAAAA,MAGvDzG,IAAMwD,GAIEgI,GAEA7F,GAAe3F,EAAEoC,KAC3BqJ,GAAAA,UAFOzL,EAAEoC,GAIPqJ,EAAQzL,EAAEoC,GAAOrC,EAChB+E,EAA4B9E,EAAGoC,EAAKrC,IATnC0L,EAAQzL,EAAEoC,GAAOrC,EAChBiF,EAAU5C,EAAKrC,KAUrB2E,SAASG,UAAAA,YAAW,kBACd5F,EAAAA,OAAoBoM,EAAAA,MAAuBzI,QAAU+E,EAAAA,mBC1C9D/I,EAAOC,QAAAA,SAAoBgD,GACzB,GAAU8J,MAAN9J,EAAiB,MAAMzC,UAAAA,wBAAoCyC,UACxDA,mBCJT,IAAI2B,EAAS9E,EAAQ,MAErBE,EAAOC,QAAAA,SAAoBuD,EAAKrC,OAG5BhB,OAAO8D,eAAeW,EAAQpB,EAAAA,CAAOrC,MAAOA,EAAOsD,cAAAA,EAAoBC,UAAAA,IACvE,MAAOjB,GACPmB,EAAOpB,GAAOrC,SACPA,mBCRX,IAAIgI,EAASrJ,EAAQ,MACjBkN,EAAMlN,EAAQ,MAEdM,EAAO+I,EAAAA,QAEXnJ,EAAOC,QAAAA,SAAoBuD,UAClBpD,EAAKoD,KAASpD,EAAKoD,GAAOwJ,EAAIxJ,qBCNvC,IAAIoB,EAAS9E,EAAQ,MACjBsG,EAAYtG,EAAQ,MAGpB+I,EAAQjE,EAAAA,uBAAkBwB,EAAAA,qBADjB,IAGbpG,EAAOC,QAAU4I,kBCNjB,IAAIoE,EAAUnN,EAAQ,MAClB+I,EAAQ/I,EAAQ,OAEnBE,EAAOC,QAAAA,SAAoBuD,EAAKrC,UACxB0H,EAAMrF,KAASqF,EAAMrF,QAAAA,IAAOrC,EAAsBA,EAAAA,MAAQ,WAChE,IAAgB4B,KAAAA,CACjBsC,QAAAA,SACA6H,KAAMD,EAAAA,OAAU,SAChBE,UAAAA,yDCRF,IAAIC,EAAYtN,EAAQ,MAEpBuN,EAAMvL,KAAKuL,IACXC,EAAMxL,KAAKwL,IAKftN,EAAOC,QAAU,SAAUqB,EAAOD,GAChC,IAAIkM,EAAUH,EAAU9L,UACjBiM,EAAU,EAAIF,EAAIE,EAAUlM,EAAQ,GAAKiM,EAAIC,EAASlM,mBCT/D,IAAImM,EAAgB1N,EAAQ,MACxB2N,EAAyB3N,EAAQ,MAErCE,EAAOC,QAAU,SAAUgD,UAClBuK,EAAcC,EAAuBxK,eCL9C,IAAIyK,EAAO5L,KAAK4L,KACZ7L,EAAQC,KAAKD,MAIjB7B,EAAOC,QAAU,SAAUM,UAClBoN,MAAMpN,GAAYA,GAAY,GAAKA,EAAW,EAAIsB,EAAQ6L,GAAMnN,oBCNzE,IAAI6M,EAAYtN,EAAQ,MAEpBwN,EAAMxL,KAAKwL,IAIftN,EAAOC,QAAU,SAAUM,UAClBA,EAAW,EAAI+M,EAAIF,EAAU7M,GAAW,kBAAoB,mBCPrE,IAAIkN,EAAyB3N,EAAQ,MAIrCE,EAAOC,QAAU,SAAUM,UAClBJ,OAAOsN,EAAuBlN,qBCLvC,IAAIE,EAAWX,EAAQ,MACnB8N,EAAW9N,EAAQ,MACnB+N,EAAY/N,EAAQ,MACpBgO,EAAsBhO,EAAQ,MAG9BiO,EAFkBjO,EAAQ,GAARA,CAEHkO,eAInBhO,EAAOC,QAAU,SAAUgM,EAAOC,GAChC,IAAKzL,EAASwL,IAAU2B,EAAS3B,GAAAA,OAAeA,EAChD,IACInJ,EADAmL,EAAeJ,EAAU5B,EAAO8B,GAEpC,GAAIE,EAGF,CAAA,QAFalB,IAATb,IAAoBA,EAAO,WAC/BpJ,EAASmL,EAAarM,KAAKqK,EAAOC,IAC7BzL,EAASqC,IAAW8K,EAAS9K,GAAAA,OAAgBA,EAClD,MAAMtC,UAAU,2DAEd0L,IAAoBA,EAAO,UACxB4B,EAAoB7B,EAAOC,oBCrBpC,IAAIgC,EAAcpO,EAAQ,MACtB8N,EAAW9N,EAAQ,MAIvBE,EAAOC,QAAU,SAAUM,GACzB,IAAIiD,EAAM0K,EAAY3N,EAAU,iBACzBqN,EAASpK,GAAOA,EAAM9C,OAAO8C,oBCPtC,IAGI2B,EAAO,GAEXA,EALsBrF,EAAQ,GAARA,CAEFkO,gBAAgB,IAKpChO,EAAOC,QAA2B,eAAjBS,OAAOyE,mBCPxB,IAAIwD,EAAU7I,EAAQ,MAEtBE,EAAOC,QAAU,SAAUM,GACzB,GAA0CC,WAAtCmI,EAAQpI,GAAwB,MAAMC,UAAU,oDAC7CE,OAAOH,cCJhBP,EAAOC,QAAU,SAAUM,cAEhBG,OAAOH,GACd,MAAOkD,8BCHX,IAAI0K,EAAK,EACLC,EAAUtM,KAAKuM,SAEnBrO,EAAOC,QAAU,SAAUuD,mBACN9C,YAAAA,IAAO8C,EAAoB,GAAKA,GAAAA,QAAiB2K,EAAKC,GAASpL,SAAS,qBCH7F,IAAIsL,EAAgBxO,EAAQ,MAE5BE,EAAOC,QAAUqO,IACXrD,OAAOhE,MAAAA,iBACDgE,OAAOsD,uBCLnB,IAAI3J,EAAS9E,EAAQ,MACjBqJ,EAASrJ,EAAQ,MACjB6D,EAAM7D,EAAQ,KACdkN,EAAMlN,EAAQ,MACdwO,EAAgBxO,EAAQ,MACxB8K,EAAoB9K,EAAQ,MAE5B0O,EAAwBrF,EAAO,OAC/B8B,EAASrG,EAAOqG,OAChBwD,EAAwB7D,EAAoBK,EAASA,GAAUA,EAAOyD,eAAiB1B,EAE3FhN,EAAOC,QAAU,SAAU4H,UACpBlE,EAAI6K,EAAuB3G,KAAWyG,GAAAA,iBAAwBE,EAAsB3G,MACnFyG,GAAiB3K,EAAIsH,EAAQpD,GAC/B2G,EAAsB3G,GAAQoD,EAAOpD,GAErC2G,EAAsB3G,GAAQ4G,EAAsB,UAAY5G,IAE3D2G,EAAsB3G,oBCjBjC,IAAI8G,EAAI7O,EAAQ,MACZqH,EAAYrH,EAAQ,MACpB0I,EAAW1I,EAAQ,MACnBc,EAAWd,EAAQ,MACnBkD,EAAWlD,EAAQ,MACnB2B,EAAQ3B,EAAQ,MAChB8O,EAAe9O,EAAQ,MACvB+O,EAAsB/O,EAAQ,MAC9BgP,EAAKhP,EAAQ,MACbiP,EAAajP,EAAQ,MACrBkP,EAAKlP,EAAQ,MACbmP,EAASnP,EAAQ,MAEjBqF,EAAO,GACP+J,EAAa/J,EAAKgK,KAGlBC,EAAqB3N,GAAAA,WACvB0D,EAAKgK,UAAAA,MAGHE,EAAgB5N,GAAAA,WAClB0D,EAAKgK,KAAK,SAGRG,EAAgBT,EAAoB,QAEpCU,GAAe9N,GAAAA,WAEjB,GAAIuN,EAAI,OAAOA,EAAK,GACpB,KAAIF,GAAMA,EAAK,GACf,CAAA,GAAIC,EAAY,OAAA,EAChB,GAAIE,EAAQ,OAAOA,EAAS,IAE5B,IACIO,EAAMC,EAAKtO,EAAOG,EADlBwB,EAAS,OAIR0M,EAAO,GAAIA,EAAO,GAAIA,IAGzB,QAFAC,EAAM/O,OAAOgP,aAAaF,GAElBA,QACD,QAAS,QAAS,QAAS,GAAIrO,EAAQ,aACvC,QAAS,GAAIA,EAAQ,gBACjBA,EAAQ,MAGdG,EAAQ,EAAGA,EAAQ,GAAIA,IAC1B6D,EAAKpC,KAAK,CAAE4M,EAAGF,EAAMnO,EAAOsO,EAAGzO,QAInCgE,EAAKgK,MAAAA,SAAe7H,EAAGC,UAAYA,EAAEqI,EAAItI,EAAEsI,KAEtCtO,EAAQ,EAAGA,EAAQ6D,EAAK9D,OAAQC,IACnCmO,EAAMtK,EAAK7D,GAAOqO,EAAEE,OAAO,GACvB/M,EAAO+M,OAAO/M,EAAOzB,OAAS,KAAOoO,IAAK3M,GAAU2M,yBAGnD3M,MAgBT6L,EAAE,CAAE5K,OAAQ,QAAS+L,OAAAA,EAAa9I,OAbrBoI,IAAuBC,IAAkBC,IAAkBC,IActEJ,KAAM,SAAclN,YACdA,GAAyBkF,EAAUlF,GAEvC,IAAID,EAAQwG,EAASuH,MAErB,GAAIR,EAAa,YAAA,IAAOtN,EAA0BiN,EAAWtN,KAAKI,GAASkN,EAAWtN,KAAKI,EAAOC,GAElG,IAEI+N,EAAa1O,EAFb2O,EAAQ,GACRC,EAActP,EAASoB,EAAMX,YAG5BC,EAAQ,EAAGA,EAAQ4O,EAAa5O,IAC/BA,KAASU,GAAOiO,EAAMlN,KAAKf,EAAMV,QAIvC0O,GADAC,EAAQrB,EAAaqB,EA3BJ,SAAUhO,mBACZkO,EAAGC,mBACdA,GAAyB,OAAA,IACzBD,EAAwB,OAAA,IACxBlO,GAAiCA,EAAUkO,EAAGC,IAAM,EACjDpN,EAASmN,GAAKnN,EAASoN,GAAK,GAAK,GALvB,CA2B0BnO,KACvBZ,OACpBC,EAAQ,EAEDA,EAAQ0O,GAAahO,EAAMV,GAAS2O,EAAM3O,UAC1CA,EAAQ4O,UAAoBlO,EAAMV,YAElCU,qBCnGX,IAAI2M,EAAI0B,EAAQ,MACZ7H,EAAW6H,EAAQ,MACnBC,EAAaD,EAAQ,MAOzB1B,EAAE,CAAE5K,OAAQ,SAAU+C,MAAAA,EAAYE,OANtBqJ,EAAQ,KAARA,EAEc5O,WAAoB6O,EAAW,QAKvDlQ,KAAM,SAAc6C,UACXqN,EAAW9H,EAASvF,wECR3BsN,WAAsDC,KAE1DD,EAAwBxN,KAAK,CAAC/C,EAAOmO,0vEAA4vE9I,QAAU,EAAEoL,QAAU,2BAA2B7E,MAAQ,GAAG8E,SAAW,68BAA68BC,eAAiB,qvEAAqvEC,WAAa,MAExkL,MAAAtJ,EAAAuJ,YCDA7Q,EAAOC,QAAU,SAAU6Q,GACzB,IAAIC,EAAO,UAEXA,EAAK/N,SAAW,uBACFgO,KAAAA,SAAcC,GACxB,IAAIC,EAAU,GACVC,OAAAA,IAAmBF,EAAK,UAExBA,EAAK,KACPC,GAAAA,cAAyBxF,OAAOuF,EAAK,GAAA,QAGnCA,EAAK,KACPC,GAAAA,UAAqBxF,OAAOuF,EAAK,GAAA,OAG/BE,IACFD,GAAAA,SAAoBxF,OAAOuF,EAAK,GAAG5P,OAAS,EAAI,IAAIqK,OAAOuF,EAAK,IAAA,GAAA,OAGlEC,GAAWJ,EAAuBG,GAE9BE,IACFD,GAAAA,KAGED,EAAK,KACPC,GAAAA,KAGED,EAAK,KACPC,GAAAA,KAGKA,KACNpE,KAAK,KAIViE,EAAKjR,EAAI,SAAWsR,EAASC,EAAOC,EAAQC,EAAUC,oBACzCJ,IACTA,EAAU,EAAE,KAAMA,YAGpB,IAAIK,EAAyB,GAE7B,GAAIH,EACF,IAAK,IAAII,EAAK,EAAGA,EAAK3B,KAAK1O,OAAQqQ,IACjC,CAAA,IAAIvD,EAAK4B,KAAK2B,GAAI,GAER,MAANvD,IACFsD,EAAuBtD,IAAAA,OAKxB,IAAIwD,EAAM,EAAGA,EAAMP,EAAQ/P,OAAQsQ,IACtC,CAAA,IAAIV,EAAO,GAAGvF,OAAO0F,EAAQO,IAEzBL,GAAUG,EAAuBR,EAAK,WAAA,IAI/BO,SAAAA,IACEP,EAAK,KAGdA,EAAK,GAAA,SAAcvF,OAAOuF,EAAK,GAAG5P,OAAS,EAAI,IAAIqK,OAAOuF,EAAK,IAAA,GAAA,MAAgBvF,OAAOuF,EAAK,GAAA,MAF3FA,EAAK,GAAKO,GAOVH,IACGJ,EAAK,IAGRA,EAAK,GAAA,UAAevF,OAAOuF,EAAK,GAAA,MAAUvF,OAAOuF,EAAK,GAAA,KACtDA,EAAK,GAAKI,GAHVJ,EAAK,GAAKI,GAOVE,IACGN,EAAK,IAGRA,EAAK,GAAA,cAAmBvF,OAAOuF,EAAK,GAAA,OAAWvF,OAAOuF,EAAK,GAAA,KAC3DA,EAAK,GAAKM,GAHVN,EAAK,GAAA,GAAQvF,OAAO6F,IAOxBR,EAAKhO,KAAKkO,MAIPF,YClGT/Q,EAAOC,QAAU,SAAUgR,GACzB,IAAIC,EAAUD,EAAK,GACfW,EAAaX,EAAK,GAEtB,IAAKW,EACH,OAAOV,EAGT,GAAWW,mBAAAA,KACT,CAAA,IAAIC,EAASD,KAAKE,SAASC,mBAAmBC,KAAKC,UAAUN,MACzDvH,EAAO,+DAA+DqB,OAAOoG,GAC7EK,EAAgB,OAAOzG,OAAOrB,EAAM,OACpC+H,EAAaR,EAAWnB,QAAQO,KAAAA,SAAchN,0BACxB0H,OAAOkG,EAAWhB,YAAAA,IAAkBlF,OAAO1H,EAAQ,iBAErEkN,GAASxF,OAAO0G,GAAY1G,OAAO,CAACyG,IAAgBrF,KAAK,aAG3DoE,GAASpE,KAAK,SCnBpBuF,EAA2B,YAGtBC,EAAoBC,GAE5B,IAAIC,EAAeH,EAAyBE,GAC5C,QAAqBxF,IAAjByF,EACH,OAAOA,EAAavS,QAGrB,IAAID,EAASqS,EAAyBE,GAAAA,CACrCpE,GAAIoE,EAEJtS,QAAS,WAIVwS,EAAoBF,GAAUvS,EAAQA,EAAOC,QAASqS,GAG/CtS,EAAOC,QCpBfqS,EAAoBI,EAAK1S,IACxB,IAAI2S,EAAS3S,GAAUA,EAAO4S,WAC7B,IAAO5S,EAAiB6S,YAClBC,SACPR,EAAoBS,EAAEJ,EAAQ,CAAErL,EAAGqL,IAC5BA,GCLRL,EAAoBS,EAAI,CAAC9S,EAAS+S,SAC7B,IAAIxP,KAAOwP,EACXV,EAAoBzB,EAAEmC,EAAYxP,KAAS8O,EAAoBzB,EAAE5Q,EAASuD,IAC5ErD,OAAO8D,eAAehE,EAASuD,EAAK,CAAEgB,YAAAA,EAAkBG,IAAKqO,EAAWxP,MCJ3E8O,EAAoB/J,EAAI,WACvB,GAAWF,iBAAAA,WAAyB,OAAOA,4BAE3B,IAAIvC,SAAS,cAAb,GACd,MAAOmN,GACR,GAAW3K,iBAAAA,OAAqB,OAAOA,QALjB,GCAxBgK,EAAoBzB,EAAI,CAACqC,EAAKC,IAAUhT,OAAO8F,UAAUwC,eAAe7G,KAAKsR,EAAKC,GCClFb,EAAoBc,EAAKnT,wBACdgL,QAA0BA,OAAOoI,aAC1ClT,OAAO8D,eAAehE,EAASgL,OAAOoI,YAAa,CAAElS,MAAO,WAE7DhB,OAAO8D,eAAehE,EAAS,aAAc,CAAEkB,OAAAA,i6MCDpCmS,EAOAC,ECPAC,EAAAA,ECCAC,EAAAA,gBCCIC,IA4Bd,GA1BWpL,oBAAAA,SACTA,OAAc,CACZqL,aAAc,mCAMPrL,QAA2BA,OAAOsL,wBACrCtL,OAAQsL,sBACNtL,OAAQuL,6BACRvL,OAAQwL,0BAAAA,SACJC,GACRzL,OAAO0L,YAAYD,EAAU,IAAO,MAAA,oBAI/BzL,QAA2BA,OAAO2L,uBACrC3L,OAAQ2L,qBACN3L,OAAQ4L,4BACR5L,OAAQ6L,yBAAAA,cACd,oBAKO7L,SAAiCA,OAAQ8L,aAClD,CAAA,GAAU9L,OAAQ+L,mBAChB,CAAA,MACMC,EADYhM,OAAQ+L,mBACJpO,UAAUsO,gBAC1BjM,OAAQ+L,mBAAmBpO,UAAUsO,gBAAkB,SAAUC,UAC9D,IAAIC,SAAQ,CAACC,EAASC,KAC3BL,EAAU1S,KAAKmO,KAAMyE,EAAaE,EAASC,OAK3CrM,OAAQ8L,aACN9L,OAAQ8L,cACR9L,OAAQ+L,oBACR/L,OAAQsM,iBACRtM,OAAQuM,gBACRvM,OAAQwM,kCAIPxM,QAAiCA,OAAQyM,mBAC5CzM,OAAQyM,iBAAmBzM,OAAOyM,kBAAoB,igBHnDpDzB,IAAAA,EAAW,KACrB0B,MAAA,qBAMUzB,GACV0B,EAAAC,OAAA,qBACA3B,EAAA4B,cAAA,sBAFU5B,IAAAA,EAAM,WAWL6B,kBAQTA,EAAMC,SAAAA,kBAUND,EAAMC,SAAAA,EACND,EAAME,OAAS,qBAOfF,EAAMG,OAAOjC,EAAY0B,yCAIzBI,EAAMG,OAAOhC,EAAO2B,kCAOpBE,EAAMG,OAAOhC,EAAO4B,6BAODK,GACnB,GACQC,KADCJ,QACP,MAAMI,MAAM,oEAEdL,EAAME,OAAOE,IAAAA,iBAOOA,GACpB,GACQC,KADCJ,QACP,MAAMI,MAAM,qEAEdL,EAAME,OAAOE,IAAAA,mBAOSA,WACbJ,EAAME,OAAOE,wBAOfrV,OAAOC,KAAKgV,EAAME,kBIxFbI,EAA2BzL,EAAS9I,UACzC8I,KAAAA,EAAM9I,MAAAA,GJcAwU,EAAAN,SAAAA,EACAM,EAAAL,OAAkC,ICpBvC9B,EAAAA,IAAAA,EAAQ,KAClBoC,EAAAC,MAAA,GAAA,QACAD,EAAAA,EAAAE,KAAA,GAAA,OACAF,EAAAA,EAAAG,KAAA,GAAA,OACAH,EAAAA,EAAAH,MAAA,GAAA,QACAG,EAAAA,EAAAI,MAAA,GAAA,cAQWC,gBAKT,GACQlG,KAJFmG,WAAyB,GAAAnG,KAgB1BoG,aAAyB3C,EAASsC,KAbnCG,EAAOG,UACT,MAAM,IAAIX,MAAM,gCAElBQ,EAAOG,UAAYrG,KAEnBkG,EAAOG,UAAUC,YAAY,IAAIC,GAC1BL,EAAOG,sCAaU,MAApBH,EAAOG,YACTH,EAAOG,UAAY,IAAIH,GAElBA,EAAOG,UAMTC,YAAYE,QACZL,WAAWnT,KAAKwT,GAMhBC,sBACAN,WAAW7U,OAAS,EAQnBoV,KAAKC,EAAiBC,GACf,MAATD,IACFA,EAAQ3G,KAAKoG,cAGf,MAAMS,EAAM7G,KAAKmG,WAAW7U,WAEvB,IAAIvB,EAAI,EAAGA,EAAI8W,EAAK9W,IACnB4W,GAAAA,KAAcP,cAAAA,KACXD,WAAWpW,GAAG+W,IAAIH,EAAOC,GAS7BG,SAASH,QACTF,KAAKjD,EAASqC,MAAOc,GAOrBI,QAAQJ,QACRF,KAAKjD,EAASsC,KAAMa,GAOpBK,QAAQL,QACRF,KAAKjD,EAASuC,KAAMY,GAOpBlT,SAASkT,QACTF,KAAKjD,EAASiC,MAAOkB,GAOrBM,SAASN,QACTF,KAAKjD,EAASwC,MAAOW,IAnGbO,EAAAd,UAAoB,WAsHxBE,EAMJO,IAAIH,EAAiBC,GAE1B,IAAKQ,UAAYA,QAAQN,KAAOM,QAAQH,MAAQG,QAAQ1T,MAEtD,OAIF,MAAM2T,EAAqB,GAC3BA,EAAYC,QAAQ5P,MAAM2P,EAAaT,GACvCS,EAAYC,QAAQ,IAAM7D,EAASkD,GAAAA,QAE/BA,EAAQlD,EAASuC,KAEfoB,QAAQN,IAAIpP,MAEd0P,QAAQN,IAAIpP,MAAM0P,QAASC,GAE3BD,QAAQN,IAAIO,EAAYtK,KAAK,MAEtB4J,EAAQlD,EAASiC,MAEtB0B,QAAQH,KAAKvP,MACf0P,QAAQH,KAAKvP,MAAM0P,QAASC,GAE5BD,QAAQH,KAAKI,EAAYtK,KAAK,MAI5BqK,QAAQ1T,MAAMgE,MAChB0P,QAAQ1T,MAAMgE,MAAM0P,QAASC,GAE7BD,QAAQ1T,MAAM2T,EAAYtK,KAAK,aAS1BwK,cAWCC,EAAgBC,QARpBC,UAAsB,GAAA1H,KASvB2H,QAA6B7S,SAASE,cAAc,UAAAgL,KACpD2H,QAAQH,MAAQA,GAASjP,OAAOqP,WACrC5H,KAAK2H,QAAQF,OAASA,GAAUlP,OAAOsP,YACvC7H,KAAK2H,QAAQG,MAAMC,SAAW,WAE9B/H,KAAKgI,KAAiChI,KAAK2H,QAAQM,WAAW,MAC9DnT,SAASoT,KAAKC,YAAYnI,KAAK2H,SAQ1Bb,IAAIH,EAAiBC,GAC1B,MAAMwB,EAAUxB,EAAK7J,KAAK,UAErBiL,KAAKK,UAAU,EAAG,EAAGrI,KAAK2H,QAAQH,MAAOxH,KAAK2H,QAAQF,QAAAA,KAEtDC,UAAUJ,QAAQ,IAAM7D,EAASkD,GAAAA,OAAkByB,GAExD,IAAIE,EAAM,GACNC,EAAU,MACT,IAAIxY,EAAI,EAAGA,EAAIiQ,KAAK0H,UAAUpW,OAAQvB,IAAAA,KACpCiY,KAAKQ,UAAY,oBAAsBD,EAAQE,QAAQ,GAAA,IAC5DzI,KAAKgI,KAAKU,SAAS1I,KAAK0H,UAAU3X,GAAI,IAAKuY,GAC3CA,GAAO,GACPC,EAAUA,EAAU,EAAIA,EAAU,IAAO,SIxMlCI,cAgCQC,QAAAA,KAAAA,EA9BX5I,KAAA6I,WAAqB,WACrB7I,KAAA8I,WAAqB,WAGrB9I,KAAA+I,GAAa,GAGb/I,KAAAgJ,GAAa,IAGbhJ,KAAAiJ,GAAa,IAEbjJ,KAAAkJ,GAAa,WAGblJ,KAAAmJ,GAAa,GACbnJ,KAAAoJ,GAAa,EACbpJ,KAAAqJ,GAAa,WACbrJ,KAAAsJ,GAAa,GACbtJ,KAAAuJ,GAAa,WACbvJ,KAAAwJ,GAAa,GACbxJ,KAAAyJ,GAAa,WAUnBzJ,KAAK0J,IAAM,IAAIC,MAAc3J,KAAKgJ,IAAAA,KAE7BU,IAAI,IAAMd,GAAQgB,KAAKC,SAAW,MAElC,IAAI9Z,EAAI,EAAGA,EAAIiQ,KAAKgJ,GAAIjZ,IAC3B,CAAA,MAAM+Z,EAAI9J,KAAK0J,IAAI3Z,EAAI,GAAAiQ,KAAW0J,IAAI3Z,EAAI,KAAAiQ,KAAa+I,GAAK,OAEvDW,IAAI3Z,IAAAA,KAAa0Z,KAAW,WAAJK,KAAoB,KAAQ,IAAA9J,KAAWyJ,IAAU,MAAJK,GAAc/Z,IAAO,OAE5Fga,OAAS/J,KAAKgJ,GAMbgB,SACN,MAAMC,EAAQ,CAAC,OAAUf,IACzB,IAAI7I,EAAI,EACNtQ,EAAI,OACCA,EAAIiQ,KAAKgJ,GAAKhJ,KAAKiJ,GAAIlZ,IAC5BsQ,EAAKL,KAAK0J,IAAI3Z,GAAAA,KAAU+Y,WAAe9I,KAAK0J,IAAI3Z,EAAI,GAAAiQ,KAAU6I,WAC9D7I,KAAK0J,IAAI3Z,GAAAA,KAAU2Z,IAAI3Z,EAAIiQ,KAAKiJ,IAAO5I,IAAM,EAhEzB,WAgE+B4J,EAAU,EAAJ5J,QAEpDtQ,EAAIiQ,KAAKgJ,GAAK,EAAGjZ,IACtBsQ,EAAKL,KAAK0J,IAAI3Z,GAAAA,KAAU+Y,WAAe9I,KAAK0J,IAAI3Z,EAAI,GAAAiQ,KAAU6I,WAC9D7I,KAAK0J,IAAI3Z,GAAAA,KAAU2Z,IAAI3Z,GAAAA,KAAUkZ,GAAKjJ,KAAKgJ,KAAQ3I,IAAM,EApErC,WAoE2C4J,EAAU,EAAJ5J,GAEvEA,EAAKL,KAAK0J,IAAI1J,KAAKgJ,GAAK,GAAAhJ,KAAU8I,WAAe9I,KAAK0J,IAAI,GAAA1J,KAAU6I,WACpE7I,KAAK0J,IAAI1J,KAAKgJ,GAAK,GAAAhJ,KAAU0J,IAAI1J,KAAKiJ,GAAK,GAAM5I,IAAM,EAvEjC,WAuEuC4J,EAAU,EAAJ5J,GAAAA,KAE9D0J,OAAS,EAMTG,eACIH,QAAAA,KAAef,IAAAA,KACjBgB,SAGP,IAAI3J,EAAIL,KAAK0J,IAAI1J,KAAK+J,iBAEtB1J,GAAKA,IAAAA,KAAW8I,GAChB9I,GAAMA,GAAAA,KAAU+I,GAAMpJ,KAAKqJ,GAC3BhJ,GAAMA,GAAAA,KAAUiJ,GAAMtJ,KAAKuJ,GAC3BlJ,GAAKA,IAAAA,KAAWmJ,GAETnJ,IAAM,EAMR8J,mBACOD,WAAa,EAAM,YAM1BE,SAAS7M,EAAaD,UACnBA,EAAMC,GAAAA,KAAY4M,OAAS5M,EAO9BC,QAAQD,EAAaD,UACnBvL,KAAKD,OAAOwL,EAAMC,EAAM,GAAAyC,KAAUmK,OAAS5M,GAQ7C8M,KAAKC,EAAqB,gBACnBH,QAAUG,EAMjBC,QAAWtY,UACTA,EAAM+N,KAAKxC,QAAQ,EAAGvL,EAAMX,OAAS,IAUvCkZ,QAAWvY,EAAiBwY,EAAkBC,GAAAA,UAC/CA,EACK1K,KAAK2K,uBAAuB1Y,EAAOwY,GAAAA,KAE9BG,0BAA0B3Y,EAAOwY,GASzCG,0BAA6B3Y,EAAiBwY,GACpD,GAAIA,EAAWxY,EAAMX,QAAUmZ,EAAW,EACxC,MAAM,IAAI/E,MAAM,yEAElB,GAAI+E,IAAaxY,EAAMX,OACrB,OAAOW,EAGT,MAAMc,EAAmB,IAAI4W,MAASc,GACtC,IAAII,EAAc,EAClB,MAAMC,EAAY7Y,EAAMK,MAAM,QACvBuY,EAAcJ,GACnB,CAAA,MAAMlZ,EAAQyO,KAAKxC,QAAQ,EAAGsN,EAAUxZ,OAAS,GACjDyB,EAAO8X,KAAiBC,EAAUvZ,GAClCuZ,EAAUC,OAAOxZ,EAAO,UAGnBwB,EAQD4X,uBAA0B1Y,EAAiBwY,GAEjD,GAAIA,EAAW,EACb,MAAM,IAAI/E,MAAM,0EAElB,MAAM3S,EAAS,IAAI4W,MAASc,OACvB,IAAI1a,EAAI,EAAGA,EAAI0a,EAAU1a,IAC5BgD,EAAOhD,GAAAA,KAAUwa,QAAQtY,UAEpBc,EAOFiY,QAAW/Y,GAChB,MAAM6Y,EAAY7Y,EAAMK,MAAM,GAC9B,IAAI2Y,EAAU,SACT,IAAIlb,EAAI,EAAGA,EAAI+a,EAAUxZ,OAAS,EAAGvB,IACxC,CAAA,MAAMmb,EAAclL,KAAKxC,QAAQzN,EAAG+a,EAAUxZ,OAAS,GACvD2Z,EAAOH,EAAU/a,GACjB+a,EAAU/a,GAAK+a,EAAUI,GACzBJ,EAAUI,GAAeD,SAGpBH,EASFK,MAAM7Z,EAAgBiM,EAAaD,GACxC,MAAMvK,EAAwB,IAAI4W,MAAMrY,OACnC,IAAIvB,EAAI,EAAGA,EAAIuB,EAAQvB,IAC1BgD,EAAOhD,GAAAA,KAAUyN,QAAQD,EAAKD,UAEzBvK,EAMFqY,iBACO5N,QAAQ,EAAG,GAMlB6N,iBACO7N,QAAQ,EAAG,GAMlB8N,iBACO9N,QAAQ,EAAG,GAMlB+N,kBACO/N,QAAQ,EAAG,IAMlBgO,kBACOhO,QAAQ,EAAG,IAMlBiO,kBACOjO,QAAQ,EAAG,MH1QfkG,EAAAA,IAAAA,EAAI,KACdgI,KAAA,OACAC,EAAAC,IAAA,MACAD,EAAAE,OAAA,SACAF,EAAAG,KAAA,OACAH,EAAAI,MAAA,iBAGYrI,GAIIiI,EAAAK,YAAhB,SAA4BC,UACtBA,IAASvI,EAAKkI,IACTlI,EAAKmI,OAEVI,IAASvI,EAAKmI,OACTnI,EAAKkI,IAEVK,IAASvI,EAAKoI,KACTpI,EAAKqI,MAEVE,IAASvI,EAAKqI,MACTrI,EAAKoI,KAGPpI,EAAKgI,MAMEC,EAAAO,cAAhB,SAA8BC,GAC5B,MAAMC,EAAa,CAACC,EAAOP,KAAMO,EAAON,MAAOM,EAAOC,GAAID,EAAOE,MAC3DC,EAAgB,CAAC9I,EAAKoI,KAAMpI,EAAKqI,MAAOrI,EAAKkI,IAAKlI,EAAKmI,QAE7D,IAAIvO,GAAOmP,OAAOC,UACdC,GAAY,MACX,IAAI5c,EAAI,EAAGA,EAAIqc,EAAW9a,OAAQvB,IACjCqc,EAAWrc,GAAG6c,IAAIT,GAAa7O,IACjCA,EAAM8O,EAAWrc,GAAG6c,IAAIT,GACxBQ,EAAW5c,UAGRyc,EAAcG,KApCXjJ,IAAAA,EAAI,KINX,MAAMmJ,EAA0B,EAAV9a,KAAK+a,YA8ClBC,IACd,MAAMC,EAAmC,GACzC,IAAIC,GAAAA,EACAld,EAAI,EACR,MAAMuB,EAASiC,UAAUjC,4BAGrBlB,OAAO8F,UAAUjD,SAASpB,KAAK0B,UAAU,MAC3C0Z,EAAO1Z,UAAU,GACjBxD,KAIF,MAAMmd,EAA+C,mBAAnB9c,OAAQ+c,OAC1C,IAAI9a,EAAQ,SAeVA,EAdG6a,EAcW9c,OAAQ+c,OAbd,SAAUhK,OACX,MAAMC,KAAQD,EACb/S,OAAO8F,UAAUwC,eAAe7G,KAAKsR,EAAKC,KAExC6J,GAAAA,oBAAQ7c,OAAO8F,UAAUjD,SAASpB,KAAKsR,EAAIC,IAC7C4J,EAAS5J,GAAQ2J,GAAAA,EAAaC,EAAS5J,GAAOD,EAAIC,IAElD4J,EAAS5J,GAAQD,EAAIC,KAUxBrT,EAAIuB,EAAQvB,IACjB,CAAA,MAAMoT,EAAM5P,UAAUxD,GACjBmd,EAGH7a,EAAM2a,EAAU7J,GAFhB9Q,EAAM8Q,UAMH6J,WAOOI,EAAaC,GAC3B,MAAMC,EAAM,oEACZ,IAAIC,EAAY,GACZxd,EAAI,OAEDA,EAAIsd,EAAS/b,QAGlB,CAAA,MAAMkc,EAAmC,IAA3BH,EAASI,WAAW1d,KAC5B2d,EAAmC,IAA3BL,EAASI,WAAW1d,KAC5B4d,EAAmC,IAA3BN,EAASI,WAAW1d,KAE5B6d,EAAOJ,GAAS,EAChBK,GAAiB,EAARL,IAAc,EAAME,GAAS,EAE5C,IAAII,EAAMC,EACNnQ,MAAM8P,GACRI,EAAOC,EAAO,IAEdD,GAAiB,GAARJ,IAAe,EAAMC,GAAS,EAErCI,EADEnQ,MAAM+P,GACD,GAEQ,GAARA,GAIXJ,GAAaD,EAAIxN,OAAO8N,GAAQN,EAAIxN,OAAO+N,GAAQP,EAAIxN,OAAOgO,GAAQR,EAAIxN,OAAOiO,UAG5ER,WAQOS,EAAWC,EAAkCC,UACpDD,MAAAA,EAAkDA,EAAaC,WAMxDC,EAAM/R,EAAamB,EAAaD,UACvCvL,KAAKwL,IAAIxL,KAAKuL,IAAIC,EAAKnB,GAAMkB,YAMtB8Q,EAAc7Q,EAAaD,EAAagB,EAAiB,IAAIqK,UACpErK,EAASA,EAAO8L,SAAS7M,EAAKD,GAAOC,EAAMxL,KAAKuM,UAAYhB,EAAMC,YAM3D8Q,EAAiB9Q,EAAaD,EAAagB,EAAiB,IAAIqK,UACvErK,EAASA,EAAOd,QAAQD,EAAKD,GAAOvL,KAAKuc,MAAMF,EAAc7Q,EAAKD,aAM3DiR,EAAkBC,GAChC,IAAIC,EAAWD,EACf,GAAIA,EAAQ3B,EACV,KAAO4B,EAAW5B,GAChB4B,GAAY5B,EAIhB,GAAI2B,EAAQ,EACV,KAAOC,EAAW,GAChBA,GAAY5B,SAGT4B,WAMOC,EAAUC,UAChB,IAAM5c,KAAK+a,GAAM6B,WAMXC,EAAUC,UAChBA,EAAU,IAAO9c,KAAK+a,YAMhBgC,EAAY5d,GAC1B,IAAI6d,EAAgB,EAClBC,EAAe,EAEjB,MAAMC,EAAkBC,IACtBH,GAASG,EAAOC,WAEZD,EAAOE,cACTH,EAA4BC,EAAOE,eAGjCC,EAAiBH,IACrBF,GAAQE,EAAOI,UACXJ,EAAOE,cACTC,EAA2BH,EAAOE,sBAItCH,EAAe/d,GACfme,EAAcne,GAEP,IAAImb,EAAO0C,EAAOC,YAOXO,EAAkBrO,EAASjP,UACZ,IAAzBA,EAAMR,QAAQyP,KAChBjP,EAAMe,KAAKkO,IAAAA,YAUCsO,EAAuBtO,EAASjP,GAC9C,IAAIV,GAAS,SACRA,EAAQU,EAAMR,QAAQyP,KAAU,IACnCjP,EAAM8Y,OAAOxZ,EAAO,IAAA,YAURke,EAASxd,EAAmBkR,OACrC,IAAIpT,EAAI,EAAGA,EAAIkC,EAAMX,OAAQvB,IAChC,GAAIkC,EAAMlC,KAAOoT,EACf,OAAA,oBAWUuM,EAAgBzD,UAC1BA,IAASvI,EAAKkI,IACTlI,EAAKmI,OAEVI,IAASvI,EAAKmI,OACTnI,EAAKkI,IAEVK,IAASvI,EAAKoI,KACTpI,EAAKqI,MAEVE,IAASvI,EAAKqI,MACTrI,EAAKoI,KAGPpI,EAAKgI,cASEiE,EAAqBxD,GACnC,MAAMC,EAAa,CAACC,EAAOP,KAAMO,EAAON,MAAOM,EAAOC,GAAID,EAAOE,MAC3DC,EAAgB,CAAC9I,EAAKoI,KAAMpI,EAAKqI,MAAOrI,EAAKkI,IAAKlI,EAAKmI,QAE7D,IAAIvO,GAAOmP,OAAOC,UACdC,GAAY,MACX,IAAI5c,EAAI,EAAGA,EAAIqc,EAAW9a,OAAQvB,IACjCqc,EAAWrc,GAAG6c,IAAIT,GAAa7O,IACjCA,EAAM8O,EAAWrc,GAAG6c,IAAIT,GACxBQ,EAAW5c,UAGRyc,EAAcG,SAOViD,cAWCC,EAAsBD,EAAWE,kBANrCC,eAAsB,KACtB/P,KAAAgQ,YAAsB,EAM5BhQ,KAAK+P,eAAiB,IAAIpG,MAASkG,GAG7BI,UACN,MAAMC,EAAuC,EAA7BlQ,KAAK+P,eAAeze,OAC9B6e,EAAW,IAAIxG,MAASuG,GACxBE,EAAQpQ,KAAKoQ,YACd,IAAIrgB,EAAI,EAAGA,EAAIqgB,EAAOrgB,IACzBogB,EAASpgB,GAAAA,KAAUggB,eAAehgB,eAGxBggB,eACZ/P,KAAK+P,eAAiBI,EAMjBnd,KAAKT,eACDyd,cAAAA,KAAqBD,eAAeze,QAAAA,KACtC2e,UAAAA,KAEMF,eAAe/P,KAAKgQ,eAAiBzd,EAM7C8d,kBACAL,YAAchQ,KAAKgQ,YAAc,EAAI,EAAI,EAAIhQ,KAAKgQ,YAAc,EAC9DhQ,KAAK+P,eAAe/P,KAAKgQ,aAM3BI,oBACOJ,YAMPM,aACAN,YAAc,EAMdO,2BACOR,eAAeze,OAOtBkf,UAAUjf,GACf,GAAIA,GAAAA,KAAc6e,QAEhB,MAAM,IAAI1K,MAAM,iBAAmBnU,eAEzBwe,eAAexe,GAQtBkf,OAAOlf,EAAeH,UACvBG,GAAAA,KAAc6e,SAAAA,KACXH,UAAAA,KAEMF,eAAexe,GAASH,EAOhCsf,OAAOnf,GACZ,MAAM6e,EAAQpQ,KAAKoQ,QACnB,GAAc,IAAVA,EAEF,MAAM,IAAI1K,MAAM,qBAAuBnU,GAGzC,MAAMof,EAAU3Q,KAAK+P,eAAexe,OAC/B,IAAIxB,EAAIwB,EAAOxB,EAAIqgB,EAAOrgB,IAAAA,KACxBggB,eAAehgB,GAAAA,KAAUggB,eAAehgB,EAAI,eAE9CigB,cACEW,EAOFC,cAAcre,GACnB,MAAMhB,EAAQyO,KAAK+P,eAAete,QAAQc,QACrCme,OAAOnf,GAMPsf,sBACOd,eAAezd,MAAM,EAAG0N,KAAKgQ,aAOpCc,QAAQ1Y,GACb,IAAIrI,EAAI,EACR,MAAMqgB,EAAQpQ,KAAKoQ,aACXrgB,EAAIqgB,EAAOrgB,IACjBqI,EAAKvG,KAAKmO,KAAAA,KAAW+P,eAAehgB,GAAIA,GASrCkR,IAAI7I,GACT,MAAMgY,EAAQpQ,KAAKoQ,YACd,IAAIrgB,EAAI,EAAGA,EAAIqgB,EAAOrgB,IAAAA,KACpBggB,eAAehgB,GAAKqI,EAAKvG,KAAKmO,KAAAA,KAAW+P,eAAehgB,GAAIA,aAQvDghB,EAAK3I,GACnB,MAAM,IAAI1C,MAAM0C,GAtJF4I,EAAAlB,YAAc,IA+JvB,MAAM3E,EAAQ,CAAC8F,EAAcC,IAAevH,MAAMsH,KAAK,IAAItH,MAAMuH,EAAKD,EAAO,IAAA,CAAKE,EAAIphB,IAAMA,EAAIkhB,aAMvFG,EAAMC,UACb,IAAI3M,SAASC,IAClB2M,YAAW,KACT3M,MACC0M,MCndA,MAAME,EAAc,EACrBC,EAAsD,GAC/CC,EAAuB,SAC7B,MAAMrJ,KAAWoJ,EACpBA,EAAgBpJ,GAAW,GAIzBsJ,EAAa,CAACtJ,EAAiB5R,KACnC,MAAMmb,EAA2BtM,EAAMuM,UAAU,6BAC7CJ,EAAgBpJ,GAAWmJ,IAAgBI,IAC7CzL,EAAO2L,cAAc5K,KAAKmB,GAGtBhB,QAAQ0K,OAAStb,EAAQub,gBAE3B3K,QAAQ0K,SAGZN,EAAgBpJ,eAOF4J,EAASxb,UACvBA,EAAUuW,EACR,IAEE3E,QAAS,gEACT6J,gBAAiB,KACjBC,gBAAAA,GAEF1b,GAAAA,SAGexC,EAAame,EAAkBxb,GAC9C,GACEA,GAAAA,mBACSA,EAAWvF,OAAAA,mBAA+BuF,EAAW/B,KAAAA,mBAA6B+B,EAAWsC,IAEtG,MAAM,IAAImZ,YAAY,oEAExB,MAEMhK,EACJ,GAHyBpU,EAAO8D,MAAAA,KAAa9D,EAAO8D,MAAQqa,EAAW,IAAM,KAAKA,GAAAA,0BAGxC3b,EAAQ4R,WACjD5R,EAAQyb,gBAAkB,QAAQzb,EAAQyb,0BAAAA,IAExCT,EAAgBpJ,KACnBoJ,EAAgBpJ,GAAW,GAI7B,MAAMxW,EAAS+E,EAAavG,OAAD+c,OAAA,GAAMxW,GAAe3C,EAChD,IAAK2C,EAEH,OAAM0b,UAAuBzgB,iBACZgV,GACb8K,EAAWtJ,EAAS5R,GACpB8b,SAAS1L,WAGNyL,SAGL1b,GAAcA,EAAWvF,OAC3BQ,EAAOR,MAAQ,kBACbsgB,EAAWtJ,EAAS5R,GACbG,EAAWvF,MAAMsG,MAAMsI,KAAMzM,YAE/B3B,IAGL+E,GAAcA,EAAW/B,MAC3BhD,EAAOgD,IAAM,kBACX8c,EAAWtJ,EAAS5R,GACbG,EAAW/B,IAAI8C,MAAMsI,KAAMzM,aAIlCoD,GAAcA,EAAWsC,MAC3BrH,EAAOqH,IAAM,kBACXyY,EAAWtJ,EAAS5R,GACbG,EAAWsC,IAAIvB,MAAMsI,KAAMzM,aAG/B3B,UCjGEya,cAwFCjM,EAAWC,QAKb8Q,GAAK,EAgBLnR,KAAAuS,GAAK,EApBbvS,KAAKmR,GAAK/Q,EACVJ,KAAKuS,GAAKlS,EAtFLmS,yBACE,IAAInG,EAAO,EAAG,GAMhBoG,wBACE,IAAIpG,EAAO,EAAG,GAMhBqG,yBACE,IAAIrG,EAAO,GAAK,IAMlBC,uBACE,IAAID,EAAO,GAAI,GAMjBE,yBACE,IAAIF,EAAO,EAAG,GAMhBP,yBACE,IAAIO,GAAQ,EAAG,GAKjBN,0BACE,IAAIM,EAAO,EAAG,oBAOCmC,UACf,IAAInC,EAAOta,KAAK4gB,IAAInE,GAAQzc,KAAK6gB,IAAIpE,mBAMxBqE,UAChBA,MAAAA,IAGAjV,MAAMiV,EAAIzS,KAAMxC,MAAMiV,EAAIxS,IAI1BwS,EAAIzS,IAAM0S,EAAAA,GAAYD,EAAIxS,IAAMyS,EAAAA,GAAYD,EAAIzS,KAAO0S,EAAAA,GAAYD,EAAIxS,KAAOyS,EAAAA,kBAY7DC,EAAcC,UAC5BjhB,KAAKkhB,KAAKlhB,KAAKmhB,IAAIH,EAAK3S,EAAI4S,EAAK5S,EAAG,GAAKrO,KAAKmhB,IAAIH,EAAK1S,EAAI2S,EAAK3S,EAAG,IAgB5ED,oBACc+Q,GAOd/Q,MAAahE,QACN+U,GAAK/U,EAOZiE,oBACckS,GAOdlS,MAAajE,QACNmW,GAAKnW,EAQZ+W,MAAM/S,EAAWC,QACTD,EAAeA,EACpBJ,KAAKK,EAAeA,EAQhB+S,OAAOC,EAAgBC,EAAoB,aACzCvhB,KAAKwhB,IAAIvT,KAAKI,EAAIiT,EAAOjT,IAAMkT,GAAavhB,KAAKwhB,IAAIvT,KAAKK,EAAIgT,EAAOhT,IAAMiT,EAO7EE,SAAS3T,UACTA,IACHA,EAAIwM,EAAOmG,MAENzgB,KAAKkhB,KAAKlhB,KAAKmhB,IAAIlT,KAAKI,EAAIP,EAAEO,EAAG,GAAKrO,KAAKmhB,IAAIlT,KAAKK,EAAIR,EAAEQ,EAAG,IAG/DoT,eAAe5T,UACfA,IACHA,EAAIwM,EAAOmG,MAENzgB,KAAKmhB,IAAIlT,KAAKI,EAAIP,EAAEO,EAAG,GAAKrO,KAAKmhB,IAAIlT,KAAKK,EAAIR,EAAEQ,EAAG,GAQrDqT,wBACOF,WAMdG,uBACcH,WAQdG,SAAgBC,GACd,MAAM/T,EAAIG,KAAKzF,YAAYsZ,MAAMD,QAC5BT,MAAMtT,EAAEO,EAAGP,EAAEQ,GAMb9F,YACL,MAAMyI,EAAIhD,KAAKwT,kBACXxQ,EAAI,EACC,IAAIqJ,EAAOrM,KAAKI,EAAI4C,EAAGhD,KAAKK,EAAI2C,GAEhC,IAAIqJ,EAAO,EAAG,GAOlByH,QAAQjB,eACDkB,IAAIlB,GAAKgB,MAAM,IAStBA,MAAMG,UACPA,aAAuB3H,EAClB,IAAIA,EAAOrM,KAAKI,EAAI4T,EAAY5T,EAAGJ,KAAKK,EAAI2T,EAAY3T,GAExD,IAAIgM,EAAOrM,KAAKI,EAAI4T,EAAahU,KAAKK,EAAI2T,GAQ9CD,IAAIlU,UACF,IAAIwM,EAAOrM,KAAKI,EAAIP,EAAEO,EAAGJ,KAAKK,EAAIR,EAAEQ,GAOtC4T,IAAIpU,UACF,IAAIwM,EAAOrM,KAAKI,EAAIP,EAAEO,EAAGJ,KAAKK,EAAIR,EAAEQ,GAQtC6T,SAASrU,eACTsT,MAAMnT,KAAKI,EAAIP,EAAEO,EAAGJ,KAAKK,EAAIR,EAAEQ,GAAAA,KAS/B8T,SAAStU,eACTsT,MAAMnT,KAAKI,EAAIP,EAAEO,EAAGJ,KAAKK,EAAIR,EAAEQ,GAAAA,KAQ/B+T,WAAWT,eACXR,MAAMnT,KAAKI,EAAIuT,EAAM3T,KAAKK,EAAIsT,GAAAA,KAQ9B/G,IAAI/M,eACGO,EAAIP,EAAEO,EAAIJ,KAAKK,EAAIR,EAAEQ,EAa5BgU,MAAMxU,UACPA,aAAawM,EACRrM,KAAKI,EAAIP,EAAEQ,EAAIL,KAAKK,EAAIR,EAAEO,EACX,iBAANP,EACT,IAAIwM,EAAOxM,EAAIG,KAAKK,GAAIR,EAAIG,KAAKI,QAAAA,eAI/BkU,EAAazB,UACjB,IAAIxG,GAAQiI,EAAMzB,EAAIxS,EAAGiU,EAAMzB,EAAIzS,GAMrCmU,uBACE,IAAIlI,EAAOrM,KAAKK,GAAAA,KAASD,GAM3BoU,qBACOD,gBAAgBha,YAMvBka,qBACOZ,OAAO,GAMda,iBACE3iB,KAAK4iB,MAAM3U,KAAKK,EAAGL,KAAKI,GAO1BwU,OAAOpG,EAAeqG,GACtBA,IACHA,EAAS,IAAIxI,EAAO,EAAG,IAEzB,MAAMyI,EAAW/iB,KAAK6gB,IAAIpE,GACpBuG,EAAWhjB,KAAK4gB,IAAInE,GACpBpO,EAAI2U,GAAAA,KAAiB3U,EAAIyU,EAAOzU,GAAK0U,GAAAA,KAAiBzU,EAAIwU,EAAOxU,GAAKwU,EAAOzU,EAC7EC,EAAIyU,GAAAA,KAAiB1U,EAAIyU,EAAOzU,GAAK2U,GAAAA,KAAiB1U,EAAIwU,EAAOxU,GAAKwU,EAAOxU,SAC5E,IAAIgM,EAAOjM,EAAGC,GAMhB2U,eACE,IAAI3I,EAAOrM,KAAKI,EAAGJ,KAAKK,GAM1BpN,SAASgiB,UACVA,EACK,IAAAjV,KAASI,EAAEqI,QAAQwM,OAAAA,KAAgB5U,EAAEoI,QAAQwM,MAAAA,IAE/CjV,KAASI,MAAAA,KAAWC,eAWfwS,EAAIzS,EAAWC,UACtB,IAAIgM,EAAOjM,EAAGC,8TAtMrB7N,CAAA,CADCwf,EAAS,CAAE5J,QAAS,8FClKX8M,ECIAC,EDJAD,ECIAC,8UCRCC,eAuCC/R,EAAW7K,EAAWhB,EAAWD,QACtC8L,EAAIA,EACTrD,KAAKxH,EAAIA,EACTwH,KAAKxI,EAAIA,EACTwI,KAAKzI,EAAS,MAALA,EAAYA,EAAI,iBAWL8L,EAAW7K,EAAWhB,EAAWD,UAC9C,IAAI6d,GAAM/R,EAAG7K,EAAGhB,EAAGD,wBAQAmD,GAE1B,IAAIxF,EAAQ,KACZ,GAAKA,EAAQwF,EAAOxF,MAFM,8DAGxB,CAAA,MAAMmO,EAAIgS,SAASngB,EAAM,GAAI,IACvBsD,EAAI6c,SAASngB,EAAM,GAAI,IACvBsC,EAAI6d,SAASngB,EAAM,GAAI,IAC7B,IAAIqC,EAAI,SACJrC,EAAM,KACRqC,EAAI+d,WAAWpgB,EAAM,KAEhB,IAAIkgB,GAAM/R,EAAG7K,EAAGhB,EAAGD,GAE1B,MAAM,IAAImO,MAAM,yBAA2BhL,kBASzB6a,GAEpB,IAAIrgB,EAAQ,KACZ,GAAKA,EAAQqgB,EAAIrgB,MAFQ,8DAGvB,CAAA,MAAMmO,EAAIgS,SAASngB,EAAM,GAAI,IACvBsD,EAAI6c,SAASngB,EAAM,GAAI,IACvBsC,EAAI6d,SAASngB,EAAM,GAAI,IAC7B,IAAIqC,EAAI,SACJrC,EAAM,KACRqC,EAAI8d,SAASngB,EAAM,GAAI,IAAM,KAExB,IAAIkgB,GAAM/R,EAAG7K,EAAGhB,EAAGD,GAE1B,MAAM,IAAImO,MAAM,uBAAyB6P,kBAYvBC,EAAW1L,EAAW2L,EAAWle,EAAY,UACpD,IAAIme,GAASF,EAAG1L,EAAG2L,EAAGle,GACvBoe,SAQPC,QAAQC,EAAiB,IAC9B,MAAMC,EAAOJ,GAASK,SAAS/V,KAAKqD,EAAGrD,KAAKxH,EAAGwH,KAAKxI,EAAGwI,KAAKzI,UAC5Due,EAAKL,IAAM,EAAIK,EAAKL,GAAKI,EAClBC,EAAKH,SAQPK,OAAOH,EAAiB,IAC7B,MAAMC,EAAOJ,GAASK,SAAS/V,KAAKqD,EAAGrD,KAAKxH,EAAGwH,KAAKxI,EAAGwI,KAAKzI,UAC5Due,EAAKL,GAAKK,EAAKL,EAAII,EACZC,EAAKH,SAQPM,SAASJ,EAAiB,IAC/B,MAAMC,EAAOJ,GAASK,SAAS/V,KAAKqD,EAAGrD,KAAKxH,EAAGwH,KAAKxI,EAAGwI,KAAKzI,UAC5Due,EAAKhM,GAAKgM,EAAKhM,EAAI+L,EACZC,EAAKH,SAQPO,WAAWL,EAAiB,IACjC,MAAMC,EAAOJ,GAASK,SAAS/V,KAAKqD,EAAGrD,KAAKxH,EAAGwH,KAAKxI,EAAGwI,KAAKzI,UAC5Due,EAAKhM,GAAKgM,EAAKhM,EAAI+L,EACZC,EAAKH,SAQPQ,SAASC,GACd,MAAMC,EAAUD,EAAM/S,EAAI,IAAOrD,KAAKqD,EAAK,IAAO,IAC5CiT,EAAUF,EAAM5d,EAAI,IAAOwH,KAAKxH,EAAK,IAAO,IAC5C+d,EAAUH,EAAM5e,EAAI,IAAOwI,KAAKxI,EAAK,IAAO,IAC5Cgf,EAAOJ,EAAM7e,EAAIyI,KAAKzI,SACrB,IAAI6d,GAAMiB,EAAMC,EAAMC,EAAMC,GAS9BC,UAAUL,eACHD,SAASC,GAQhBM,OAAON,GACZ,MAAMO,EAASP,EAAMQ,SACfC,EAAST,EAAMQ,gBACdD,EAAOR,SAASU,GAAQD,SAM1BA,gBACE,IAAIxB,GAAM,IAAMpV,KAAKqD,EAAG,IAAMrD,KAAKxH,EAAG,IAAMwH,KAAKxI,EAAG,EAAMwI,KAAKzI,GAQjEuc,QAAQsC,GACb,MAAMC,GAAQD,EAAM/S,EAAIrD,KAAKqD,GAAK,EAC5BiT,GAAQF,EAAM5d,EAAIwH,KAAKxH,GAAK,EAC5B+d,GAAQH,EAAM5e,EAAIwI,KAAKxI,GAAK,EAC5Bgf,GAAQJ,EAAM7e,EAAIyI,KAAKzI,GAAK,SAC3B,IAAI6d,GAAMiB,EAAMC,EAAMC,EAAMC,GAG9BM,MAAMV,eACCnjB,aAAemjB,EAAMnjB,WAQ5BA,SAAS8jB,EAAgC,cACtCA,yBAEQpB,+BAEAqB,+BAEAC,gBAEZ,MAAM,IAAIvR,MAAM,yBASdwR,gBAAgBzf,GACtB,MAAM8d,EAAM9d,EAAExE,SAAS,WACD,IAAfsiB,EAAIjkB,OAAe,IAAMikB,EAAMA,EAMjC0B,kBACQjX,KAAKkX,gBAAgBlX,KAAKqD,GAAAA,KAAU6T,gBAAgBlX,KAAKxH,GAAAA,KAAU0e,gBAAgBlX,KAAKxI,GAMhGme,SACL,MAAM5iB,EAASpC,OAAOqP,KAAKqD,EAAEoF,QAAQ,IAAA,KAAa9X,OAAOqP,KAAKxH,EAAEiQ,QAAQ,IAAA,KAAa9X,OAAOqP,KAAKxI,EAAEiR,QAAQ,oBAC5FzL,KAANzF,GAA8B,OAAAyI,KAANzI,EACxB,QAAUxE,EAAS,KAAOpC,OAAOqP,KAAKzI,GAAAA,IAExC,OAASxE,EAAS,IAMpBikB,gBACEtB,GAASK,SAAS/V,KAAKqD,EAAGrD,KAAKxH,EAAGwH,KAAKxI,EAAGwI,KAAKzI,GAAGtE,WAMpDuV,wBACOvV,WAMP+hB,eACE,IAAII,GAAMpV,KAAKqD,EAAGrD,KAAKxH,EAAGwH,KAAKxI,EAAGwI,KAAKzI,GAMzC4f,0BACE/B,GAAMgC,QAAQ,WAMhBC,0BACEjC,GAAMgC,QAAQ,WAMhBE,yBACElC,GAAMgC,QAAQ,WAMhBG,8BACEnC,GAAMgC,QAAQ,WAMhBI,6BACEpC,GAAMgC,QAAQ,WAMhBK,2BACErC,GAAMgC,QAAQ,WAMhBM,2BACEtC,GAAMgC,QAAQ,WAMhBO,wBACEvC,GAAMgC,QAAQ,WAMhBQ,8BACExC,GAAMgC,QAAQ,WAWhBS,+BACEzC,GAAMwC,UAMRE,yBACE1C,GAAMgC,QAAQ,WAMhBW,4BACE3C,GAAMgC,QAAQ,WAMhBY,2BACE5C,GAAMgC,QAAQ,WAMhBa,yBACE7C,GAAMgC,QAAQ,WAMhBc,0BACE9C,GAAMgC,QAAQ,WAMhBe,yBACE/C,GAAMgC,QAAQ,WAMhBgB,6BACEhD,GAAMgC,QAAQ,WAMhBiB,0BACEjD,GAAMgC,QAAQ,WAMhBkB,+BACElD,GAAMgC,QAAQ,WAMhBmB,gCACEnD,GAAMgC,QAAQ,aAMhBoB,kCACEpD,GAAMgC,QAAQ,YA/PvBqB,EAAA,CADCzG,EAAS,CAAE5J,QAAS,0IAkLrBqQ,EAAA,CAJCzG,EAAS,CACR5J,QAAS,sDACT6J,gBAAiB,2CA0FfyD,eACeF,EAAkB1L,EAAkB2L,EAAkBle,QAAtDie,EAAAA,EAAkBxV,KAAA8J,EAAAA,EAAkB9J,KAAAyV,EAAAA,EAAkBzV,KAAAzI,EAAAA,iBAEnDqO,EAAW8S,EAAWC,UACtCA,EAAI,IACNA,GAAK,GAEHA,EAAI,IACNA,GAAK,GAEHA,EAAI,EAAI,EACH/S,EAAc,GAAT8S,EAAI9S,GAAS+S,EAEvBA,EAAI,GACCD,EAELC,EAAI,EAAI,EACH/S,GAAK8S,EAAI9S,IAAM,EAAI,EAAI+S,GAAK,EAE9B/S,kBAGcvC,EAAW7K,EAAWhB,EAAWD,GACtD8L,GAAK,IACL7K,GAAK,IACLhB,GAAK,IACL,MAAM8F,EAAMvL,KAAKuL,IAAI+F,EAAG7K,EAAGhB,GACzB+F,EAAMxL,KAAKwL,IAAI8F,EAAG7K,EAAGhB,GACvB,IAAIge,EAAG1L,EACP,MAAM2L,GAAKnY,EAAMC,GAAO,EAExB,GAAID,IAAQC,EACViY,EAAI1L,EAAI,MAER,CAAA,MAAM9G,EAAI1F,EAAMC,SAChBuM,EAAI2L,EAAI,GAAMzS,GAAK,EAAI1F,EAAMC,GAAOyF,GAAK1F,EAAMC,GACvCD,QACD+F,EACHmS,GAAKhd,EAAIhB,GAAKwL,GAAKxK,EAAIhB,EAAI,EAAI,cAE5BgB,EACHgd,GAAKhe,EAAI6L,GAAKL,EAAI,aAEfxL,EACHge,GAAKnS,EAAI7K,GAAKwK,EAAI,EAGtBwS,GAAK,SAGA,IAAIE,GAASF,EAAG1L,EAAG2L,EAAGle,GAGxBoe,SACL,IAAItS,EAAW7K,EAAWhB,EAE1B,GAAe,IAAAwI,KAAN8J,EACPzG,EAAI7K,EAAIhB,EAAIwI,KAAKyV,MAEjB,CAAA,MAAMiD,EAAI1Y,KAAKyV,EAAI,GAAMzV,KAAKyV,GAAK,EAAIzV,KAAK8J,GAAAA,KAAU2L,EAAIzV,KAAK8J,EAAI9J,KAAKyV,EAAIzV,KAAK8J,EAC3ElE,EAAI,EAAI5F,KAAKyV,EAAIiD,EACvBrV,EAAIqS,GAASkD,QAAQhT,EAAG8S,EAAG1Y,KAAKwV,EAAI,EAAI,GACxChd,EAAIkd,GAASkD,QAAQhT,EAAG8S,EAAG1Y,KAAKwV,GAChChe,EAAIke,GAASkD,QAAQhT,EAAG8S,EAAG1Y,KAAKwV,EAAI,EAAI,UAGnC,IAAIJ,GAAU,IAAJ/R,EAAa,IAAJ7K,EAAa,IAAJhB,EAASwI,KAAKzI,GAG5CtE,yBAKE+M,KAJQwV,EAAE/M,QAAQ,OAAAzI,KACd8J,EAAErB,QAAQ,OAAAzI,KACVyV,EAAEhN,QAAQ,OAAAzI,KACVzI,EAAEkR,QAAQ,aC1fZoQ,eAeCC,EAA6C,EAAGC,EAAc,EAAGrmB,EAAgB,EAAGsmB,EAAiB,oBACpGF,GAAAA,KACJrmB,KAAOqmB,EAAcrmB,KAC1BuN,KAAK+Y,IAAMD,EAAcC,IACzB/Y,KAAKtN,MAAQomB,EAAcpmB,MAC3BsN,KAAKgZ,OAASF,EAAcE,QAAAA,iBACZF,IAAAA,KACXrmB,KAAOqmB,EACZ9Y,KAAK+Y,IAAMA,EACX/Y,KAAKtN,MAAQA,EACbsN,KAAKgZ,OAASA,kCAQoBC,UAC/BA,GAGDA,EACElnB,KAAKwhB,IAAI0F,EAAa7Y,GAAKrO,KAAKwhB,IAAI0F,EAAa5Y,GAC/C4Y,EAAa7Y,EAAI,EACZsD,EAAKqI,MAEPrI,EAAKoI,KAERmN,EAAa5Y,EAAI,EACZqD,EAAKmI,OAEPnI,EAAKkI,IAZPlI,EAAKgI,uBAkBSwN,GACvB,IAAIC,EAAOrG,EAAAA,EACPsG,EAAOtG,EAAAA,EACPuG,GAAQvG,EAAAA,EACRwG,GAAQxG,EAAAA,MACP,IAAI/iB,EAAI,EAAGA,EAAImpB,EAAO5nB,OAAQvB,IAC7BmpB,EAAOnpB,GAAGqQ,EAAI+Y,IAChBA,EAAOD,EAAOnpB,GAAGqQ,GAEf8Y,EAAOnpB,GAAGqQ,EAAIiZ,IAChBA,EAAOH,EAAOnpB,GAAGqQ,GAEf8Y,EAAOnpB,GAAGsQ,EAAI+Y,IAChBA,EAAOF,EAAOnpB,GAAGsQ,GAEf6Y,EAAOnpB,GAAGsQ,EAAIiZ,IAChBA,EAAOJ,EAAOnpB,GAAGsQ,UAGd,IAAIwY,GAAYM,EAAMC,EAAMC,EAAMC,wBAGf9R,EAAeC,EAAgBoN,EAAiBxI,EAAOqG,KAAMpK,EAAc+D,EAAOmG,aACrG,IAAIqG,IACRrR,EAAQqN,EAAOzU,EAAIkI,EAAIlI,GACvBqH,EAASoN,EAAOxU,EAAIiI,EAAIjI,EACzBmH,EAAQA,EAAQqN,EAAOzU,EAAIkI,EAAIlI,EAC/BqH,EAASA,EAASoN,EAAOxU,EAAIiI,EAAIjI,GAOrCmH,wBACc9U,MAAQsN,KAAKvN,KAM3BgV,yBACcuR,OAAShZ,KAAK+Y,IAMrBQ,2BACiB,IAAAvZ,KAAVwH,OAA+B,IAAAxH,KAAXyH,OAMlC+R,oBACS,IAAInN,GAAAA,KAAa5Z,KAAOuN,KAAKtN,OAAS,GAAAsN,KAAS+Y,IAAM/Y,KAAKgZ,QAAU,GAGtES,UAAUnR,UACR,IAAIuQ,GAAY7Y,KAAKvN,KAAO6V,EAAIlI,EAAGJ,KAAK+Y,IAAMzQ,EAAIjI,EAAGL,KAAKtN,MAAQ4V,EAAIlI,EAAGJ,KAAKgZ,OAAS1Q,EAAIjI,GAO7FuU,OAAOpG,EAAekL,EAAgBrN,EAAOmG,MAClD,MAAM0G,EAASlZ,KAAK2Z,YAAY1Y,KAAK2E,GAAMA,EAAEgP,OAAOpG,EAAOkL,YACpDb,GAAYe,WAAWV,GAGzBrF,MAAMA,EAAe6F,EAAgBrN,EAAOmG,MACjD,MAAMqH,EAAU7Z,KAAKyZ,UAAUC,UACxB,IAAIb,GAAYgB,EAAQpnB,KAAOohB,EAAMzT,EAAGyZ,EAAQd,IAAMlF,EAAMxT,EAAGwZ,EAAQnnB,MAAQmhB,EAAMzT,EAAGyZ,EAAQb,OAASnF,EAAMxT,GAGjHyZ,UAAUC,GACf,MAAMb,EAASlZ,KAAK2Z,YAAY1Y,KAAK2E,GAAMmU,EAAOC,MAAMpU,YACjDiT,GAAYe,WAAWV,GAMzBe,sBAGE,GAAAja,KAFSwH,MACLxH,KAAKyH,QAIXkS,YACL,MAAMO,EAAU,UAChBA,EAAQlnB,KAAK,IAAIqZ,EAAOrM,KAAKvN,KAAMuN,KAAK+Y,MACxCmB,EAAQlnB,KAAK,IAAIqZ,EAAOrM,KAAKtN,MAAOsN,KAAK+Y,MACzCmB,EAAQlnB,KAAK,IAAIqZ,EAAOrM,KAAKtN,MAAOsN,KAAKgZ,SACzCkB,EAAQlnB,KAAK,IAAIqZ,EAAOrM,KAAKvN,KAAMuN,KAAKgZ,SACjCkB,EAMFC,QAAQC,EAAUC,EAAkBvH,EAAAA,GAEzC,IAAIwH,GAAQxH,EAAAA,EACRyH,EAAQzH,EAAAA,EAEZ,MAAM0H,EAAqB,IAAdJ,EAAIK,IAAIra,EAAUqM,OAAOC,UAAY,EAAI0N,EAAIK,IAAIra,EACxDsa,EAAqB,IAAdN,EAAIK,IAAIpa,EAAUoM,OAAOC,UAAY,EAAI0N,EAAIK,IAAIpa,EAExDsa,GAAAA,KAAYloB,KAAO2nB,EAAI9R,IAAIlI,GAAKoa,EAChCI,GAAAA,KAAYloB,MAAQ0nB,EAAI9R,IAAIlI,GAAKoa,EACvCF,EAAOvoB,KAAKwL,IAAIod,EAAKC,GACrBL,EAAOxoB,KAAKuL,IAAIqd,EAAKC,GAErB,MAAMC,GAAAA,KAAY9B,IAAMqB,EAAI9R,IAAIjI,GAAKqa,EAC/BI,GAAAA,KAAY9B,OAASoB,EAAI9R,IAAIjI,GAAKqa,SACxCJ,EAAOvoB,KAAKuL,IAAIgd,EAAMvoB,KAAKwL,IAAIsd,EAAKC,IACpCP,EAAOxoB,KAAKwL,IAAIgd,EAAMxoB,KAAKuL,IAAIud,EAAKC,IAE7BP,GAAQxoB,KAAKuL,IAAI,EAAGgd,IAASA,EAAOD,EAGtCU,YAAYX,EAAUC,EAAkBvH,EAAAA,GAE7C,IAAIwH,GAAQxH,EAAAA,EACRyH,EAAQzH,EAAAA,EAEZ,MAAM0H,EAAqB,IAAdJ,EAAIK,IAAIra,EAAUqM,OAAOC,UAAY,EAAI0N,EAAIK,IAAIra,EACxDsa,EAAqB,IAAdN,EAAIK,IAAIpa,EAAUoM,OAAOC,UAAY,EAAI0N,EAAIK,IAAIpa,EAExDsa,GAAAA,KAAYloB,KAAO2nB,EAAI9R,IAAIlI,GAAKoa,EAChCI,GAAAA,KAAYloB,MAAQ0nB,EAAI9R,IAAIlI,GAAKoa,EACvCF,EAAOvoB,KAAKwL,IAAIod,EAAKC,GACrBL,EAAOxoB,KAAKuL,IAAIqd,EAAKC,GAErB,MAAMC,GAAAA,KAAY9B,IAAMqB,EAAI9R,IAAIjI,GAAKqa,EAC/BI,GAAAA,KAAY9B,OAASoB,EAAI9R,IAAIjI,GAAKqa,SACxCJ,EAAOvoB,KAAKuL,IAAIgd,EAAMvoB,KAAKwL,IAAIsd,EAAKC,IACpCP,EAAOxoB,KAAKwL,IAAIgd,EAAMxoB,KAAKuL,IAAIud,EAAKC,IAEhCP,GAAQxoB,KAAKuL,IAAI,EAAGgd,IAASA,EAAOD,EAC/BC,GAED,EAcH7K,SAASrT,UACVA,aAAeiQ,EACVrM,KAAKvN,MAAQ2J,EAAIgE,GAAAA,KAAU2Y,KAAO3c,EAAIiE,GAAAA,KAAU2Y,QAAU5c,EAAIiE,GAAAA,KAAU3N,OAAS0J,EAAIgE,EACnFhE,aAAeyc,IAAAA,KACfpmB,KAAO2J,EAAI3J,MAAAA,KAAasmB,IAAM3c,EAAI2c,KAAO3c,EAAI4c,OAAShZ,KAAKgZ,QAAU5c,EAAI1J,MAAQsN,KAAKtN,MAY5FsoB,QAAQC,UACO,IAAIpC,GACtB9mB,KAAKwL,IAAIyC,KAAKvN,KAAMwoB,EAAMxoB,MAC1BV,KAAKwL,IAAIyC,KAAK+Y,IAAKkC,EAAMlC,KACzBhnB,KAAKuL,IAAI0C,KAAKtN,MAAOuoB,EAAMvoB,OAC3BX,KAAKuL,IAAI0C,KAAKgZ,OAAQiC,EAAMjC,SAKhCkC,wBACS,IAAI7O,EAAOrM,KAAKwH,MAAOxH,KAAKyH,QAW9B0T,UAAUF,GACf,MAAMG,EAAmBpb,KAAKgb,QAAQC,GAGtC,GACEG,EAAiB5T,MAAQyT,EAAMzT,MAAQxH,KAAKwH,OAC5C4T,EAAiB3T,OAASwT,EAAMxT,OAASzH,KAAKyH,SAC7C2T,EAAiBF,WAAW9H,OAAO6H,EAAMC,cACzCE,EAAiBF,WAAW9H,OAAOpT,KAAKkb,YAGzC,CAAA,IAAIG,EAAW,EAabA,EADErb,KAAKtN,OAASuoB,EAAMxoB,MAAAA,KAAaC,OAASuoB,EAAMvoB,MACvCuoB,EAAMxoB,KAAOuN,KAAKtN,MAalBuoB,EAAMvoB,MAAQsN,KAAKvN,KAGhC,IAAI6oB,EAAW,SAWbA,EADEtb,KAAK+Y,KAAOkC,EAAMjC,QAAAA,KAAeD,KAAOkC,EAAMlC,IACrCkC,EAAMjC,OAAShZ,KAAK+Y,IAWpBkC,EAAMlC,IAAM/Y,KAAKgZ,OAG1BjnB,KAAKwhB,IAAI8H,GAAYtpB,KAAKwhB,IAAI+H,GACzB,IAAIjP,EAAOgP,EAAU,GAErB,IAAIhP,EAAO,EAAGiP,GAGlB,GAAIF,EAAiBF,WAAW9H,OAAO6H,EAAMC,aAAeE,EAAiBF,WAAW9H,OAAOpT,KAAKkb,YACzG,CAAA,IAAIG,EAAW,EAKXA,EAHArb,KAAKwH,MAAQyT,EAAMzT,OAAS,EAE1BxH,KAAKtN,MAAQuoB,EAAMvoB,OAASuoB,EAAMxoB,KAAOuN,KAAKvN,KACrCwoB,EAAMxoB,KAAOuN,KAAKtN,MAGlBuoB,EAAMvoB,MAAQsN,KAAKvN,KAK5BwoB,EAAMvoB,MAAQsN,KAAKtN,OAAAA,KAAcD,KAAOwoB,EAAMxoB,KACrCuN,KAAKvN,KAAOwoB,EAAMvoB,MAGlBsN,KAAKtN,MAAQuoB,EAAMxoB,KAIlC,IAAI6oB,EAAW,SAKXA,EAHAtb,KAAKyH,OAASwT,EAAMxT,QAAU,EAE5BzH,KAAKgZ,OAASiC,EAAMjC,QAAUiC,EAAMlC,IAAM/Y,KAAK+Y,IACtCkC,EAAMlC,IAAM/Y,KAAKgZ,OAEjBiC,EAAMjC,OAAShZ,KAAK+Y,IAK7BkC,EAAMjC,OAAShZ,KAAKgZ,QAAAA,KAAeD,IAAMkC,EAAMlC,IACtC/Y,KAAK+Y,IAAMkC,EAAMjC,OAEjBhZ,KAAKgZ,OAASiC,EAAMlC,IAI/BhnB,KAAKwhB,IAAI8H,GAAYtpB,KAAKwhB,IAAI+H,GACzB,IAAIjP,EAAOgP,EAAU,GAErB,IAAIhP,EAAO,EAAGiP,UAGhB,KAQJC,kBAAkBC,GACvB,MAAML,EAAYnb,KAAKmb,UAAUK,UAC1B3C,GAAY4C,wBAAwBN,GAItCO,UAAUC,EAA+BvF,EAAehB,GAAMqC,QACnEkE,EAAIC,YAAcxF,EAAMnjB,WACxB0oB,EAAIE,WAAW7b,KAAKvN,KAAMuN,KAAK+Y,IAAK/Y,KAAKwH,MAAOxH,KAAKyH,QAQhDqU,KAAKC,EAA8B3F,EAAehB,GAAMqC,QAC7DsE,EAAGhV,MAAMiV,SAAShc,KAAKvN,KAAMuN,KAAK+Y,IAAK/Y,KAAKwH,MAAOxH,KAAKyH,OAAQ,CAAE2O,MAAAA,MH/Y1DlB,EAAAA,IAAAA,EAAW,KAIrB+G,MAAA,QA4BAC,EAAAC,UAAA,YAMAD,EAAAE,WAAA,aAKAF,EAAAG,aAAA,eAKAH,EAAAI,cAAA,gBAMAJ,EAAAK,SAAA,iBAOWC,GAEJC,yBACIjV,MAAO,IAAKC,OAAQ,KAIxBiV,6BACIlV,MAAO,KAAMC,OAAQ,MAIzBkV,8BACInV,MAAO,IAAKC,OAAQ,KAIxBmV,4BACIpV,MAAO,IAAKC,OAAQ,KAIxBoV,mCACIrV,MAAO,IAAKC,OAAQ,KAIxBqV,+BACItV,MAAO,IAAKC,OAAQ,KAIxBsV,wBACIvV,MAAO,IAAKC,OAAQ,KAIxBuV,yBACIxV,MAAO,IAAKC,OAAQ,YAyEpBwV,eAmBCzmB,kBAhBJ0mB,eAAAA,EAIAld,KAAAmd,iBAAsC,GAAAnd,KAEtCod,eAAoC,GAAApd,KACpCqd,oBAAqC,KAGrCrd,KAAAsd,eAAAA,EAEAtd,KAAAud,aAAAA,EACAvd,KAAAwd,QAAUtX,EAAO2L,cAAAA,KAmCjB4L,yBAA2B,UAC5BH,eAAAA,KAAsBA,cAC3Btd,KAAKwd,QAAQzW,MAAM,oBAAqB/G,KAAKsd,gBAGvCtd,KAAA0d,yBAA2B,UAC5BF,QAAQzW,MAAM,qBAAsBxO,OAAOyM,kBAAAA,KAC3C2Y,kBAAoB3d,KAAK4d,6BAAAA,KACzBC,8BAGC7d,KAAA8d,eAAiB,KACvB,MAAM5O,EAASlP,KAAKkP,YACfsO,QAAQzW,MAAM,qBAAA/G,KACd+d,uCAAuC7O,GAAAA,KACvC2O,8BAcC7d,KAAA2d,kBAAoB3d,KAAK4d,6BAAAA,KA5D1BI,SAAWxnB,EAAQwnB,SACxBhe,KAAKie,WAA+B,QAAlBC,EAAA1nB,EAAQynB,kBAAAA,IAAUC,EAAAA,EAAA9tB,OAAA+c,OAAA,QAAc6Q,UAAAA,KAC7CG,aAAkC,QAAnBC,EAAA5nB,EAAQ6nB,mBAAAA,IAAWD,EAAAA,EAAIlJ,EAAY+G,MACvDjc,KAAK2H,QAAUnR,EAAQ8nB,OACvBte,KAAKgI,KAAOxR,EAAQ+nB,QACpBve,KAAKkd,cAAoC,QAApBsB,EAAAhoB,EAAQioB,oBAAAA,IAAYD,EAAAA,EAAIxe,KAAKkd,cAClDld,KAAK0e,SAAWloB,EAAQmoB,QACxB3e,KAAK4e,UAAYpoB,EAAQuR,SACzB/H,KAAKqd,oBAAsB7mB,EAAQqoB,WACnC7e,KAAK8e,oBAAAA,KAEAC,gBAAkB/e,KAAK0e,SAASnmB,OAAOymB,gBAAgBC,WAAW,gBAAgB1mB,OAAOyM,yBAAAA,KACzF+Z,gBAAgBG,iBAAiB,SAAUlf,KAAK0d,0BAAAA,KAEhD/V,QAAQuX,iBAAiB,mBAAoBlf,KAAKyd,0BAGlD0B,eACK5B,cAAAA,KAEHA,aAAAA,EACLvd,KAAK0e,SAASnmB,OAAO6mB,IAAI,SAAUpf,KAAK8d,gBAAAA,KAC/BuB,iBAAAA,KACFA,gBAAgBC,aAAAA,KAElBpQ,OAAOqQ,oBAAoB,SAAUvf,KAAK8d,gBAAAA,KAC1CiB,gBAAgBQ,oBAAoB,SAAUvf,KAAK0d,0BAAAA,KACnD/V,QAAQ4X,oBAAoB,mBAAoBvf,KAAKyd,2BAsBtDG,6BACN,OAAIrlB,OAAOyM,iBAAmB,EACrB,EAGgBzM,OAAOyM,kBAAoB,EAQtD6Z,6BACWxB,oBACArd,KAAKqd,oBAGPrd,KAAK2d,kBAGd6B,qBAC6B,IAAAxf,KAAf6e,WAGdR,8BACcF,aAGdG,yBACc3W,QAGduH,yBAEUmP,cAAgBnJ,EAAYoH,eAAAA,KAAsB+B,cAAgBnJ,EAAYmH,aAChFrc,KAAKse,OAAOmB,eAAiB3qB,SAASoT,KACtC3P,OAIR0lB,6BACcyB,YAGdzB,eAAsBA,QACfyB,YAAczB,EAGrBD,2BACW2B,UACA3f,KAAK2f,UAEP3f,KAAK0f,YAGd1B,aAAoBA,QACb2B,UAAY3B,EAGnB4B,8BACcF,YAAYlY,MAAQxH,KAAK0f,YAAYjY,OAGnDoY,8BACcH,YAAYlY,MAAQxH,KAAK6e,WAGvCiB,+BACcJ,YAAYjY,OAASzH,KAAK6e,WAGjCkB,iBAAiBC,QACjBC,QAAUD,EAGVE,iCACA/C,iBAAiBnqB,KAAKgN,KAAKie,YAAAA,KAC3Bb,eAAepqB,KAAKgN,KAAKge,UAAAA,KAEzBC,WAAa7tB,OAAH+c,OAAA,QAAa8Q,YAAAA,KACvBD,SAAW5tB,OAAH+c,OAAA,QAAa6Q,UAGrBmC,gCACAlC,WAAaje,KAAKmd,iBAAiB9M,MAAAA,KACnC2N,SAAWhe,KAAKod,eAAe/M,MAG/BwN,kCACAlW,QAAQH,MAAQxH,KAAK6f,YAC1B7f,KAAK2H,QAAQF,OAASzH,KAAK8f,aAEvB9f,KAAKkd,cACPld,KAAK2H,QAAQG,MAAMsY,eAAiB,QAAApgB,KAE/B2H,QAAQG,MAAMsY,eAAiB,YAGM,KAAApgB,KAAjC2H,QAAQG,MAAMsY,iBAAAA,KAChBzY,QAAQG,MAAMsY,eAAiB,gBAAApgB,KAGnC2H,QAAQG,MAAMN,MAAQxH,KAAKge,SAASxW,MAAQ,KACjDxH,KAAK2H,QAAQG,MAAML,OAASzH,KAAKge,SAASvW,OAAS,KAGnDzH,KAAKgI,KAAKqY,iBAAAA,KACLrY,KAAKsY,iBAAAA,KACLtY,KAAK6L,MAAM7T,KAAK6e,WAAY7e,KAAK6e,YAAAA,KACjC7W,KAAKuY,UAAYvgB,KAAKkd,cAG7BuB,+BACcvB,cAGduB,iBAAwB+B,QACjBtD,cAAgBsD,EACrBxgB,KAAKgI,KAAKuY,UAAYvgB,KAAKkd,cAM7BuD,+BACcnD,cAOPoD,2BACO/Y,QAAQgZ,oBAMfC,wBACE9rB,SAAS+rB,iBAWXC,wBAAwBpH,GAC7B,IAAIqH,EAAOrH,EAAMtZ,EACb4gB,EAAOtH,EAAMrZ,EASjB,GAEU4gB,KATA3D,gBACRyD,GAAQjS,EAAY9O,KAAK2H,SAASvH,EAClC4gB,GAAQlS,EAAY9O,KAAK2H,SAAStH,GAAAA,KAK3Bid,cACP,GAAI/kB,OAAOqP,WAAa5H,KAAK4f,YAAcrnB,OAAOsP,YAChD,CAAA,MAAMoZ,EAAe1oB,OAAOqP,WAAa5H,KAAK4f,YAE9CoB,GAASA,GADczoB,OAAOsP,YAAcoZ,GAAgB,GAC3BA,EAAgBjhB,KAAKge,SAASvW,OAC/DsZ,EAAQA,EAAOxoB,OAAOqP,WAAc5H,KAAKge,SAASxW,UAElD,CAAA,MAAM0Z,EAAc3oB,OAAOsP,YAAc7H,KAAK4f,YAE9CmB,GAASA,GADcxoB,OAAOqP,WAAasZ,GAAe,GACzBA,EAAelhB,KAAKge,SAASxW,MAC9DwZ,EAAQA,EAAOzoB,OAAOsP,YAAe7H,KAAKge,SAASvW,cAIvDsZ,EAAQA,EAAO/gB,KAAKge,SAASxW,MAASxH,KAAKie,WAAWzW,MACtDwZ,EAAQA,EAAOhhB,KAAKge,SAASvW,OAAUzH,KAAKie,WAAWxW,OAEhD,IAAI4E,EAAO0U,EAAMC,GAWnBG,wBAAwBzH,GAC7B,IAAIqH,EAAOrH,EAAMtZ,EACb4gB,EAAOtH,EAAMrZ,EAKjB,GAHA0gB,EAAQA,EAAO/gB,KAAKie,WAAWzW,MAASxH,KAAKge,SAASxW,MACtDwZ,EAAQA,EAAOhhB,KAAKie,WAAWxW,OAAUzH,KAAKge,SAASvW,OAEnDzH,KAAKsd,cACP,GAAI/kB,OAAOqP,WAAa5H,KAAK4f,YAAcrnB,OAAOsP,YAChD,CAAA,MAAMoZ,EAAe1oB,OAAOqP,WAAa5H,KAAK4f,YACxCwB,GAAiB7oB,OAAOsP,YAAcoZ,GAAgB,EAC5DD,EAAQA,EAAOhhB,KAAKge,SAASvW,OAAUwZ,EAAeG,EACtDL,EAAQA,EAAO/gB,KAAKge,SAASxW,MAASjP,OAAOqP,eAE7C,CAAA,MAAMsZ,EAAc3oB,OAAOsP,YAAc7H,KAAK4f,YACxCyB,GAAiB9oB,OAAOqP,WAAasZ,GAAe,EAC1DH,EAAQA,EAAO/gB,KAAKge,SAASxW,MAAS0Z,EAAcG,EACpDL,EAAQA,EAAOhhB,KAAKge,SAASvW,OAAUlP,OAAOsP,wBAIxCyV,gBACRyD,GAAQjS,EAAY9O,KAAK2H,SAASvH,EAClC4gB,GAAQlS,EAAY9O,KAAK2H,SAAStH,GAG7B,IAAIgM,EAAO0U,EAAMC,GAUnBM,yBAAyB5H,eAC9B,IAAIqH,EAAOrH,EAAMtZ,EACb4gB,EAAOtH,EAAMrZ,SAGjB0gB,EAAQA,EAAO/gB,KAAKie,WAAWzW,MAASxH,KAAKuhB,UAC7CP,EAAQA,EAAOhhB,KAAKie,WAAWxW,OAAUzH,KAAKwhB,WAG9CT,GAAAA,KAAmBU,cACnBT,GAAAA,KAAmBU,eAGnBX,GAAuB,QAAfY,EAAY,QAAZC,EAAA5hB,KAAKigB,eAAAA,IAAO2B,OAAA,EAAAA,EAAExhB,SAAAA,IAACuhB,EAAAA,EAAI,EAC3BX,GAAuB,QAAfa,EAAY,QAAZC,EAAA9hB,KAAKigB,eAAAA,IAAO6B,OAAA,EAAAA,EAAEzhB,SAAAA,IAACwhB,EAAAA,EAAI,EAEpB,IAAIxV,EAAO0U,EAAMC,GASnBe,yBAAyBrI,eAC9B,IAAIsI,EAAUtI,EAAMtZ,EAChB6hB,EAAUvI,EAAMrZ,SAGpB2hB,GAA0B,QAAfE,EAAY,QAAZC,EAAAniB,KAAKigB,eAAAA,IAAOkC,OAAA,EAAAA,EAAE/hB,SAAAA,IAAC8hB,EAAAA,EAAI,EAC9BD,GAA0B,QAAfG,EAAY,QAAZC,EAAAriB,KAAKigB,eAAAA,IAAOoC,OAAA,EAAAA,EAAEhiB,SAAAA,IAAC+hB,EAAAA,EAAI,EAG9BJ,GAAAA,KAAyBP,cACzBQ,GAAAA,KAAyBP,eAGzBM,EAAWA,EAAUhiB,KAAKuhB,UAAavhB,KAAKie,WAAWzW,MACvDya,EAAWA,EAAUjiB,KAAKwhB,WAAcxhB,KAAKie,WAAWxW,OAEjD,IAAI4E,EAAO2V,EAASC,GAGtBK,uBAAuB5I,GAC5B,MAAMhD,EAAS1W,KAAK8gB,wBAAwBpH,eAChC4H,yBAAyB5K,GAGhC6L,uBAAuB7I,GAC5B,MAAMhD,EAAS1W,KAAK+hB,yBAAyBrI,eACjCyH,wBAAwBzK,GAS/B8L,iBACL,MAAM/vB,EAAOuN,KAAKshB,yBAAyBjV,EAAOmG,MAAMpS,EAClD2Y,EAAM/Y,KAAKshB,yBAAyBjV,EAAOmG,MAAMnS,EACjD3N,EAAQD,EAAOuN,KAAKuhB,UACpBvI,EAASD,EAAM/Y,KAAKwhB,kBAEnB,IAAI3I,GAAYpmB,EAAMsmB,EAAKrmB,EAAOsmB,GAO3CyJ,8BACcnE,OAAO9W,MAMrBkb,kCACcpE,OAAO9W,MAAQ,EAO7Bmb,+BACcrE,OAAO7W,OAMrBmb,mCACctE,OAAO7W,OAAS,EAM9B8Z,4BACWtB,QACAjgB,KAAK6f,YAAc7f,KAAKigB,QAAQ4C,KAAO7iB,KAAK6e,WAE9C7e,KAAK6f,YAAc7f,KAAK6e,WAMjC4C,gCACcF,UAAY,EAM1BC,6BACWvB,QACAjgB,KAAK8f,aAAe9f,KAAKigB,QAAQ4C,KAAO7iB,KAAK6e,WAE/C7e,KAAK8f,aAAe9f,KAAK6e,WAMlC6C,iCACcF,WAAa,EAGnBsB,cACNhuB,SAASoT,KAAKJ,MAAMib,OAAS,MAC7BjuB,SAASoT,KAAKJ,MAAMkb,SAAW,SAC/B,MAAMC,EAASjjB,KAAK4f,YACpB,IAAIsD,EAAgB,EAChBC,EAAiB,EACjB5qB,OAAOqP,WAAaqb,EAAS1qB,OAAOsP,aACtCqb,EAAgB3qB,OAAOqP,WACvBub,EAAiB5qB,OAAOqP,WAAaqb,IAErCC,EAAgB3qB,OAAOsP,YAAcob,EACrCE,EAAiB5qB,OAAOsP,aAAAA,KAGrBmW,SAAW,CACdxW,MAAO0b,EACPzb,OAAQ0b,GAIJC,uBACN,MAAMH,EAASjjB,KAAK4f,YACpB,IAAIsD,EAAgB,EAChBC,EAAiB,EACrB,MAAMjU,EAASlP,KAAKse,OAAOmB,cACvBvQ,EAAOmU,YAAcJ,EAAS/T,EAAOoU,cACvCJ,EAAgBhU,EAAOmU,YACvBF,EAAiBjU,EAAOmU,YAAcJ,IAEtCC,EAAgBhU,EAAOoU,aAAeL,EACtCE,EAAiBjU,EAAOoU,cAAAA,KAGrBtF,SAAW,CACdxW,MAAO0b,EACPzb,OAAQ0b,GAIJrE,yBACGT,cAAgBnJ,EAAYqH,SACnCvc,KAAKujB,+BAA+BvjB,KAAK4e,YAAAA,KAEpCb,uCAAuC/d,KAAKkP,QAAAA,KAGxCA,kBAAkBsU,OACzBxjB,KAAK0e,SAASnmB,OAAOkrB,GAAG,SAAUzjB,KAAK8d,iBAAAA,KAElCuB,gBAAkB,IAAIqE,gBAAe,UACnC5F,oBAAAA,KAEFuB,gBAAgBsE,QAAQ3jB,KAAKkP,SAAAA,KAE/BA,OAAOgQ,iBAAiB,SAAUlf,KAAK8d,iBAOxCC,uCAAuC7O,QACpCmP,cAAgBnJ,EAAYoH,gBAAAA,KAC9B2B,WAAa,CAChBzW,MAAqB0H,EAAQmU,YAC7B5b,OAAsByH,EAAQoU,mBAG3BtF,SAAWhe,KAAKie,YAAAA,KAGdI,cAAgBnJ,EAAYkH,aACnCtnB,SAASoT,KAAKJ,MAAMib,OAAS,MAC7BjuB,SAASoT,KAAKJ,MAAMkb,SAAW,SAC/BhjB,KAAKie,WAAa,CAChBzW,MAAgB0H,EAAQtH,WACxBH,OAAiByH,EAAQrH,kBAGtBmW,SAAWhe,KAAKie,YAAAA,KAGdI,cAAgBnJ,EAAYiH,WAAAA,KAC9B2G,cAAAA,KAGEzE,cAAgBnJ,EAAYmH,cAAAA,KAC9B+G,uBAIDG,+BAA+Bxb,GACrC,IAAKA,EACH,MAAM,IAAIrC,MAAM,yEAKhB,GAAWqC,KAHNuW,OAAOxW,MAAM8b,QAAU,QAC5B5jB,KAAKse,OAAOxW,MAAMC,SAAW,WAEL,iBAAbA,EACT,CAAA,MAAM8b,EAAoB9b,KAASnS,MAAM,YAEjCiuB,EAAkB,mBAEjBvF,OAAOxW,MAAMiR,IAAM,8BAGnBuF,OAAOxW,MAAMkR,OAAS,8BAGtBsF,OAAOxW,MAAMiR,IAAM,MACxB,MAAM+K,GAAAA,KAAgBpC,oBACjBpD,OAAOxW,MAAMic,UAAYD,EAAQ7wB,yBAGtC,MAAM,IAAIyS,MAAM,0BAGpB,GAAIme,EAAkB,GAAA,OACZA,EAAkB,oBAEjBvF,OAAOxW,MAAMrV,KAAO,6BAGpB6rB,OAAOxW,MAAMpV,MAAQ,8BAGrB4rB,OAAOxW,MAAMrV,KAAO,MACzB,MAAMuxB,GAAAA,KAAgBvC,mBACjBnD,OAAOxW,MAAMmc,WAAaD,EAAQ/wB,yBAGvC,MAAM,IAAIyS,MAAM,gCAIlBqC,EAASgR,MAAAA,iBACJhR,EAASgR,IACX/Y,KAAKse,OAAOxW,MAAMiR,IAAMhR,EAASgR,IAAI9lB,WAAAA,KACrC+M,KAAKse,OAAOxW,MAAMiR,IAAMhR,EAASgR,KAEpChR,EAASrV,QAAAA,iBACJqV,EAASrV,MACXsN,KAAKse,OAAOxW,MAAMpV,MAAQqV,EAASrV,MAAMO,WAAAA,KACzC+M,KAAKse,OAAOxW,MAAMpV,MAAQqV,EAASrV,OAEtCqV,EAASiR,SAAAA,iBACJjR,EAASiR,OACXhZ,KAAKse,OAAOxW,MAAMkR,OAASjR,EAASiR,OAAO/lB,WAAAA,KAC3C+M,KAAKse,OAAOxW,MAAMkR,OAASjR,EAASiR,QAEvCjR,EAAStV,OAAAA,iBACJsV,EAAStV,KACXuN,KAAKse,OAAOxW,MAAMrV,KAAOsV,EAAStV,KAAKQ,WAAAA,KACvC+M,KAAKse,OAAOxW,MAAMrV,KAAOsV,EAAStV,aIzvBpCyxB,+BAIC7d,YACE9N,OAAQ8L,cAAsB9L,OAAQ+L,sBAAAA,KACzC+B,UAAY,IAAIhC,cAAAA,KAIbgC,WATCnT,GAAAmT,UAA0B,WCa9B8d,0BASO,IAAIzf,SAAiB,CAACC,EAASC,KAC7C,GAAIuf,GAASC,YAAcF,GAAoBG,SAAAA,OACtC1f,GAAAA,GAET,MAAM2f,EAAqBhT,YAAW,KACpCpL,EAAO2L,cAAc5K,KAAK,mGAC1BtC,GAAAA,KACC,KAEGf,EAAesgB,GAAoBG,SACzCzgB,EAAa2gB,SAASC,MACpB,KAEE,MAAMC,EAAS7gB,EAAa8gB,aAAa,EAAG,EAAG,OACzCzwB,EAAS2P,EAAa+gB,qBAC5B,IAAIC,GAAAA,EAEJ3wB,EAAOwwB,OAASA,EAChBxwB,EAAO4wB,QAAQjhB,EAAakhB,aAC5B7wB,EAAO8wB,QAAU,IAAOH,GAAAA,EAExB3wB,EAAO+wB,MAAM,GAGb1T,YAAW,KACkBrd,EArCrBgxB,cAsCAhxB,EAAOgxB,gBAAkBhxB,EAAOixB,eAAiBjxB,EAAOgxB,gBAAkBhxB,EAAOkxB,iBACnFhB,GAASC,WAAAA,IAGPxgB,EAAawhB,YAAc,GAAKR,KAClCT,GAASC,WAAAA,KAGZ,GAEHiB,aAAaf,GACb3f,GAAAA,MAEF,KACEC,0CAUMwf,WA1DCkB,GAAAlB,WAAAA,GJJLjP,EAAAA,IAAAA,EAAU,KACpBoQ,KAAA,OACAC,EAAAC,QAAA,UACAD,EAAAE,SAAA,WAEAF,EAAAG,QAAA,UACAH,EAAAI,SAAA,WAEAJ,EAAAK,aAAA,eACAL,EAAAM,cAAA,gBAEAN,EAAAO,UAAA,YACAP,EAAAQ,WAAA,aAEAR,EAAAS,SAAA,WACAT,EAAAU,UAAA,YAEAV,EAAAW,aAAA,eACAX,EAAAY,eAAA,iBACAZ,EAAAa,aAAA,eACAb,EAAAc,cAAA,gBAEAd,EAAAe,WAAA,aACAf,EAAAgB,SAAA,WACAhB,EAAAiB,WAAA,aAEAjB,EAAAkB,aAAA,eACAlB,EAAAmB,cAAA,gBAEAnB,EAAAoB,YAAA,OACApB,EAAAqB,aAAA,QAEArB,EAAAsB,QAAA,UACAtB,EAAAuB,WAAA,aACAvB,EAAAwB,OAAA,SACAxB,EAAAyB,KAAA,OAEAzB,EAAA0B,UAAA,YACA1B,EAAA2B,YAAA,cAEA3B,EAAA4B,QAAA,UACA5B,EAAA6B,OAAA,SACA7B,EAAA8B,MAAA,QACA9B,EAAA+B,KAAA,OAEA/B,EAAAgC,UAAA,YACAhC,EAAAiC,YAAA,cACAjC,EAAAkC,YAAA,cACAlC,EAAAmC,aAAA,eACAnC,EAAAoC,aAAA,eACApC,EAAAqC,cAAA,gBACArC,EAAAsC,aAAA,eAEAtC,EAAAlZ,GAAA,KACAkZ,EAAAjZ,KAAA,OACAiZ,EAAAuC,KAAA,OACAvC,EAAAwC,MAAA,QACAxC,EAAAyC,MAAA,QACAzC,EAAA0C,OAAA,SACA1C,EAAA2C,MAAA,QAEA3C,EAAA4C,MAAA,QACA5C,EAAA6C,QAAA,UACA7C,EAAA8C,KAAA,OAEA9C,EAAA+C,iBAAA,mBACA/C,EAAAgD,eAAA,iBACAhD,EAAAiD,iBAAA,mBACAjD,EAAAkD,iBAAA,mBACAlD,EAAAmD,gBAAA,wBAgFWC,sBAuBHC,UAAAA,EARRC,0BACcD,SAGdC,YAAmB13B,QACZy3B,SAAWz3B,EAOX23B,uBACAD,SAAAA,SAOIE,WAAkBJ,eACV50B,GACjBse,QAAAA,KADiBte,OAAAA,SAQRi1B,WAAqBL,eACb50B,GACjBse,QAAAA,KADiBte,OAAAA,SAQRk1B,WAAsBN,eACd50B,GACjBse,QAAAA,KADiBte,OAAAA,SAQRm1B,WAAuBP,eACf50B,GACjBse,QAAAA,KADiBte,OAAAA,SAQRo1B,WAAsBR,eACd50B,GACjBse,QAAAA,KADiBte,OAAAA,SAURq1B,WAAqBT,eACbjN,EAAsC2N,EAAsBt1B,GAC7Ese,QAAAA,KADiBqJ,IAAAA,EAAsC3b,KAAAspB,MAAAA,EAAsBtpB,KAAAhM,OAAAA,SAUpEu1B,WAAsBX,eACdjN,EAAsC2N,EAAsBt1B,GAC7Ese,QAAAA,KADiBqJ,IAAAA,EAAsC3b,KAAAspB,MAAAA,EAAsBtpB,KAAAhM,OAAAA,SAQpEw1B,WAA0BZ,eAClBjN,EAAsC3nB,GACvDse,QAAAA,KADiBqJ,IAAAA,EAAsC3b,KAAAhM,OAAAA,SAQ9Cy1B,WAA2Bb,eACnBjN,EAAsC3nB,GACvDse,QAAAA,KADiBqJ,IAAAA,EAAsC3b,KAAAhM,OAAAA,SAQ9C01B,WAAuDd,eAC/Ce,EAAuBL,EAAsBt1B,GAC9Dse,QAAAA,KADiBqX,OAAAA,EAAuB3pB,KAAAspB,MAAAA,EAAsBtpB,KAAAhM,OAAAA,SAQrD41B,WAAyDhB,eACjDe,EAAuBL,EAAsBt1B,GAC9Dse,QAAAA,KADiBqX,OAAAA,EAAuB3pB,KAAAspB,MAAAA,EAAsBtpB,KAAAhM,OAAAA,SAQrD61B,WAAsBjB,eACde,EAAuBG,GACxCxX,QAAAA,KADiBqX,OAAAA,EAAuB3pB,KAAA8pB,UAAAA,EAExC9pB,KAAKhM,OAAS21B,SAOLI,WAAuBnB,eACfe,EAAuBK,GACxC1X,QAAAA,KADiBqX,OAAAA,EAAuB3pB,KAAAgqB,MAAAA,EAExChqB,KAAKhM,OAAS21B,SAOLM,WAA4BrB,eACpBr3B,EAAsB24B,GACvC5X,QAAAA,KADiB/gB,MAAAA,EAAsByO,KAAAkqB,QAAAA,EAEvClqB,KAAKhM,OAASk2B,SAOLC,WAA+BvB,eACvBr3B,EAAsB24B,GACvC5X,QAAAA,KADiB/gB,MAAAA,EAAsByO,KAAAkqB,QAAAA,EAEvClqB,KAAKhM,OAASk2B,SAOLE,WAA2BxB,eAKnByB,EAA8Bj5B,EAAsB4C,GACrEse,QAAAA,KADiB+X,OAAAA,EAA8BrqB,KAAA5O,MAAAA,EAAsB4O,KAAAhM,OAAAA,SAQ5Ds2B,WAAyB1B,eAKjB2B,EAAyBn5B,EAAsB4C,GAChEse,QAAAA,KADiBiY,KAAAA,EAAyBvqB,KAAA5O,MAAAA,EAAsB4O,KAAAhM,OAAAA,SASvDw2B,WAA0B5B,eAClB6B,EAAsBC,GACvCpY,QAAAA,KADiBmY,MAAAA,EAAsBzqB,KAAA0qB,QAAAA,SAS9BC,WAA4B/B,eACpB6B,EAAsBC,GACvCpY,QAAAA,KADiBmY,MAAAA,EAAsBzqB,KAAA0qB,QAAAA,SAQ9BE,WAAqBhC,eACb50B,GACjBse,QAAAA,KADiBte,OAAAA,SAQR62B,WAAoBjC,eACZ50B,GACjBse,QAAAA,KADiBte,OAAAA,SAQR82B,WAA+ElC,eAO9EmC,EAAiB9P,EAAiBhP,EAAmBgN,GAC/D3G,QAAAA,KAD2B2I,MAAAA,EAAiBjb,KAAAiM,KAAAA,EAAmBjM,KAAAiZ,aAAAA,EAE/DjZ,KAAKhM,OAAS+2B,SAOLC,WAAgEpC,eAO/DmC,EAAiB9P,EAAiBhP,EAAmBgN,GAC/D3G,QAAAA,KAD2B2I,MAAAA,EAAiBjb,KAAAiM,KAAAA,EAAmBjM,KAAAiZ,aAAAA,EAE/DjZ,KAAKhM,OAAS+2B,EAGhBA,wBACc/2B,OAGd+2B,UAAiBA,QACV/2B,OAAS+2B,SAILE,eACQj3B,EAAkBinB,EAAiBiQ,QAAnCl3B,OAAAA,EAAkBgM,KAAAib,MAAAA,EAAiBjb,KAAAkrB,QAAAA,SAG3CC,eACQn3B,EAAkBinB,QAAlBjnB,OAAAA,EAAkBgM,KAAAib,MAAAA,SAG1BmQ,eACQp3B,EAAkBinB,EAAiBhP,EAAmBgN,EAA6BiS,QAAnFl3B,OAAAA,EAAkBgM,KAAAib,MAAAA,EAAiBjb,KAAAiM,KAAAA,EAAmBjM,KAAAiZ,aAAAA,EAA6BjZ,KAAAkrB,QAAAA,SAG3FG,eACQr3B,EAAkBinB,EAAiBhP,EAAmBgN,EAA6BiS,QAAnFl3B,OAAAA,EAAkBgM,KAAAib,MAAAA,EAAiBjb,KAAAiM,KAAAA,EAAmBjM,KAAAiZ,aAAAA,EAA6BjZ,KAAAkrB,QAAAA,SAM3FI,WAAiF1C,eAOhFmC,EAAiB9P,EAAiBiQ,GAC5C5Y,QAAAA,KAD2B2I,MAAAA,EAAiBjb,KAAAkrB,QAAAA,EAE5ClrB,KAAKhM,OAAS+2B,EAGhBA,wBACc/2B,OAGd+2B,UAAiBA,QACV/2B,OAAS+2B,SAOLQ,WAA+E3C,eAI9EmC,EAAiB9P,GAC3B3I,QAAAA,KAD2B2I,MAAAA,EAE3Bjb,KAAKhM,OAAS+2B,EAGhBA,wBACc/2B,OAGd+2B,UAAiBA,QACV/2B,OAAS+2B,SAOLS,WAAyD5C,eAIjDe,EAAuB31B,GACxCse,QAAAA,KADiBqX,OAAAA,EAAuB3pB,KAAAhM,OAAAA,SAQ/By3B,WAAsB7C,eAId8C,EAAwB13B,GACzCse,QAAAA,KADiBoZ,SAAAA,EAAwB1rB,KAAAhM,OAAAA,SAQhC23B,WAAwB/C,eAIhBgD,EAAwB53B,GACzCse,QAAAA,KADiBsZ,SAAAA,EAAwB5rB,KAAAhM,OAAAA,SAQhC63B,WAA0BjD,eAClB50B,GACjBse,QAAAA,KADiBte,OAAAA,SAQR83B,WAA2BlD,eACnB50B,GACjBse,QAAAA,KADiBte,OAAAA,SAKR+3B,WAA0BnD,eAClB50B,EAAwB+2B,GACzCzY,QAAAA,KADiBte,OAAAA,EAAwBgM,KAAA+qB,MAAAA,SAKhCiB,WAAyBpD,eACjB50B,EAAwB+2B,GACzCzY,QAAAA,KADiBte,OAAAA,EAAwBgM,KAAA+qB,MAAAA,SKljBhCkB,eASCj4B,QARJk4B,UAAkE,QAClEC,uBAAsC,GAAAnsB,KAQvCosB,QAAUp4B,EAMVsc,aACA4b,UAAY,QACZC,uBAAyB,GAQzBE,KAAKC,EAAmBC,GAC7B,IAAKD,EAEH,OAEFA,EAAYA,EAAU1xB,cACtB,MAAM5G,EAASgM,KAAKosB,QACfG,IACHA,EAAQ,IAAI3D,QAGP2D,EAAMv4B,SACTu4B,EAAMv4B,OAASA,GAEjB,MAAAw4B,IAGF,IAAIz8B,EAAW8W,EAEf,GAYA7G,KAZSksB,UAAUI,GAAAA,IACjBv8B,EAAI,EACJ8W,EAAM7G,KAAKksB,UAAUI,GAAWh7B,OAExBvB,EAAI8W,EAAK9W,IAAAA,KACVm8B,UAAUI,GAAWv8B,GAAG8B,KAAKmC,EAAQu4B,OAI9Cx8B,EAAI,EACJ8W,EAAM7G,KAAKmsB,uBAAuB76B,OAE1BvB,EAAI8W,EAAK9W,IAAAA,KACVo8B,uBAAuBp8B,GAAGs8B,KAAKC,EAAWC,GAS5C9I,GAAG6I,EAAmB5B,GAC3B4B,EAAYA,EAAU1xB,cAAAA,KACZsxB,UAAUI,KAAAA,KACbJ,UAAUI,GAAAA,IAAAA,KAEZJ,UAAUI,GAAWt5B,KAAK03B,GAAAA,gBAG3B4B,GAAAA,cAA+BA,GAAAA,KAC5BD,KAAK,YAAa,IAAI7B,GAAe8B,EAAW5B,IAYlDtL,IAAIkN,EAAmB5B,GAC5B4B,EAAYA,EAAU1xB,cACtB,MAAM6xB,EAAgBzsB,KAAKksB,UAAUI,GAErC,GAAIG,EAEF,GAAK/B,EAGH,CAAA,MAAMn5B,EAAQk7B,EAAch7B,QAAQi5B,QAC/BwB,UAAUI,GAAWvhB,OAAOxZ,EAAO,QAAAyO,KAHnCksB,UAAUI,GAAWh7B,OAAS,kBAOnCg7B,GAAAA,cAA+BA,GAAAA,KAC5BD,KAAK,cAAe,IAAI1B,GAAiB2B,EAAW5B,IAUtDgC,KAAKJ,EAAmB5B,QAaxBjH,GAAG6I,GAZaC,IACnB,MAAMI,EAAKJ,GAAS,IAAI3D,OAEtB+D,EAAG34B,OAAS24B,EAAG34B,QAAAA,KAAeo4B,QAC9B,MAAAQ,SAIGxN,IAAIkN,EAAW5B,GACpBA,EAAQ74B,KAAK86B,EAAG34B,OAAQ24B,MASrBE,KAAKC,GACVA,EAAgBX,uBAAuBn5B,KAAKgN,MAMvC+sB,OAAOD,GACZ,MAAMv7B,EAAQu7B,EAAgBX,uBAAuB16B,QAAQuO,MACzDzO,GAAS,GACXu7B,EAAgBX,uBAAuBphB,OAAOxZ,EAAO,UCzI9Cy7B,sBAOJF,gBAAkB,IAAIb,GAAgBjsB,MAStCyjB,GAAG6I,EAAmB5B,QACtBoC,gBAAgBrJ,GAAG6I,EAAW5B,GAW9BtL,IAAIkN,EAAmB5B,QACvBoC,gBAAgB1N,IAAIkN,EAAW5B,GAQ/B2B,KAAKC,EAAmBW,QACxBH,gBAAgBT,KAAKC,EAAWW,GAShCP,KAAKJ,EAAmB5B,QACxBoC,gBAAgBJ,KAAKJ,EAAW5B,aClCzBwC,GACdvR,EACAvF,EAAehB,GAAMuC,IACrBwV,EACAC,EACAC,EACAC,EACAC,EAAoB,EACpBC,EAAoB,QAEpB7R,EAAI8R,YACJ9R,EAAI+R,UAAYH,EAChB5R,EAAIgS,QAAUH,EACd7R,EAAIC,YAAcxF,EAAMnjB,WACxB0oB,EAAIiS,OAAOT,EAAIC,GACfzR,EAAIkS,OAAOR,EAAIC,GACf3R,EAAImS,YACJnS,EAAIoS,kBAOUrU,GAAMiC,EAA+BvF,EAAehB,GAAMuC,IAAK+B,GAC7EiC,EAAI8R,YACJ9R,EAAIC,YAAcxF,EAAMnjB,WACxB0oB,EAAIqS,IAAItU,EAAMtZ,EAAGsZ,EAAMrZ,EAAG,EAAG,EAAa,EAAVtO,KAAK+a,IACrC6O,EAAImS,YACJnS,EAAIoS,kBAUU1a,GAAOsI,EAA+BvF,EAAc6X,EAAgB5a,EAAgBQ,EAAgB,GAClH,MAAMpc,EAAI2e,EAAQA,EAAMnjB,WAAAA,OAClB4M,EAAIwT,EAAOQ,MAAMA,GACvB8H,EAAI8R,YACJ9R,EAAIC,YAAcnkB,EAClBkkB,EAAIiS,OAAOK,EAAO7tB,EAAG6tB,EAAO5tB,GAC5Bsb,EAAIkS,OAAOI,EAAO7tB,EAAIP,EAAEO,EAAG6tB,EAAO5tB,EAAIR,EAAEQ,GACxCsb,EAAImS,YACJnS,EAAIoS,kBAqCUG,GACdvS,EACAvb,EACAC,EACAmH,EACAC,EACA0mB,EAAgC,EAChCJ,EAAgB3Y,GAAMiC,MACtB+W,EAAc,MAEd,IAAIC,EAEJ,GAAWF,iBAAAA,EACTE,EAAK,CAAEC,GAAIH,EAAQI,GAAIJ,EAAQE,GAAIF,EAAQK,GAAIL,OAE/C,CAAA,MAAMM,EAA8B,CAAEH,GAAI,EAAGC,GAAI,EAAGF,GAAI,EAAGG,GAAI,OAE1D,MAAMprB,KAAQqrB,EACjB,GAAIA,EAAc/1B,eAAe0K,GAC/B,CAAA,MAAM6I,EAA2B7I,EACjCirB,EAAGpiB,GAAQkiB,EAAOliB,IAASwiB,EAAcxiB,IAK/C0P,EAAI8R,YACJ9R,EAAIiS,OAAOxtB,EAAIiuB,EAAGC,GAAIjuB,GACtBsb,EAAIkS,OAAOztB,EAAIoH,EAAQ6mB,EAAGE,GAAIluB,GAC9Bsb,EAAI+S,iBAAiBtuB,EAAIoH,EAAOnH,EAAGD,EAAIoH,EAAOnH,EAAIguB,EAAGE,IACrD5S,EAAIkS,OAAOztB,EAAIoH,EAAOnH,EAAIoH,EAAS4mB,EAAGA,IACtC1S,EAAI+S,iBAAiBtuB,EAAIoH,EAAOnH,EAAIoH,EAAQrH,EAAIoH,EAAQ6mB,EAAGA,GAAIhuB,EAAIoH,GACnEkU,EAAIkS,OAAOztB,EAAIiuB,EAAGG,GAAInuB,EAAIoH,GAC1BkU,EAAI+S,iBAAiBtuB,EAAGC,EAAIoH,EAAQrH,EAAGC,EAAIoH,EAAS4mB,EAAGG,IACvD7S,EAAIkS,OAAOztB,EAAGC,EAAIguB,EAAGC,IACrB3S,EAAI+S,iBAAiBtuB,EAAGC,EAAGD,EAAIiuB,EAAGC,GAAIjuB,GACtCsb,EAAImS,YAEAM,IACFzS,EAAInT,UAAY4lB,EAAKn7B,WACrB0oB,EAAIyS,QAGFL,IACFpS,EAAIC,YAAcmS,EAAO96B,WACzB0oB,EAAIoS,mBAOQY,GACdhT,EACAvb,EACAC,EACA8tB,EACAJ,EAAgB3Y,GAAMiC,MACtB+W,EAAc,MAEdzS,EAAI8R,YACJ9R,EAAIqS,IAAI5tB,EAAGC,EAAG8tB,EAAQ,EAAa,EAAVp8B,KAAK+a,IAC9B6O,EAAImS,YAEAM,IACFzS,EAAInT,UAAY4lB,EAAKn7B,WACrB0oB,EAAIyS,QAGFL,IACFpS,EAAIC,YAAcmS,EAAO96B,WACzB0oB,EAAIoS,+BCjIca,eAuCRp4B,wBArCH4H,GAAKwwB,GAAQC,MAAAA,KAKfC,WAAAA,EAKA9uB,KAAA+uB,gBAAAA,EAKA/uB,KAAAgvB,cAAAA,EAKAhvB,KAAAivB,SAAmB,EAKnBjvB,KAAAuI,QAAkB,EAKlBvI,KAAA6T,MAAQxH,EAAOoG,IAKfzS,KAAAiuB,OAAwB,KAwBvBjuB,KAAAkvB,OAAiB,EASjBlvB,KAAAmvB,QAAkB,EA9BpB34B,IAAAA,KACGy3B,OAAuB,QAAdmB,EAAA54B,EAAQy3B,cAAAA,IAAMmB,EAAAA,EAAIpvB,KAAKiuB,OACrCjuB,KAAK+uB,eAAuC,QAAtBM,EAAA74B,EAAQu4B,sBAAAA,IAAcM,EAAAA,EAAIrvB,KAAK+uB,eACrD/uB,KAAKgvB,aAAmC,QAApBM,EAAA94B,EAAQw4B,oBAAAA,IAAYM,EAAAA,EAAItvB,KAAKgvB,aACjDhvB,KAAKivB,SAA2B,QAAhBM,EAAA/4B,EAAQy4B,gBAAAA,IAAQM,EAAAA,EAAIvvB,KAAKivB,SACzCjvB,KAAKuI,QAAyB,QAAfinB,EAAAh5B,EAAQ+R,eAAAA,IAAOinB,EAAAA,EAAIxvB,KAAKuI,QACvCvI,KAAK6T,MAAqB,QAAb4b,EAAAj5B,EAAQqd,aAAAA,IAAK4b,EAAAA,EAAIzvB,KAAK6T,OAIhC6b,6BAEHzB,OAAQjuB,KAAKiuB,OAASjuB,KAAKiuB,OAAOjZ,QAAU,KAC5C+Z,eAAgB/uB,KAAK+uB,eACrBC,aAAchvB,KAAKgvB,aACnBC,SAAUjvB,KAAKivB,SACf1mB,QAASvI,KAAKuI,QACdsL,MAAO7T,KAAK6T,MAAQ7T,KAAK6T,MAAMmB,QAAU,MAS7CxN,mBACSzV,KAAKwhB,IAAIvT,KAAKkvB,OAASlvB,KAAK6T,MAAMzT,GAQ3CqH,oBACS1V,KAAKwhB,IAAIvT,KAAKmvB,QAAUnvB,KAAK6T,MAAMxT,GAG5CmH,UAAiBpW,QACV89B,OAAS99B,EAGhBqW,WAAkBrW,QACX+9B,QAAU/9B,EAMjBu+B,yBACS9W,GAAY+W,cAAc5vB,KAAKwH,MAAOxH,KAAKyH,OAAQ4E,EAAOmG,MAS5DsJ,KAAKC,EAA8B3b,EAAWC,QAC9CwvB,SAAS9T,EAAI3b,EAAGC,GAAAA,KAChByvB,WAAW/T,EAAI,EAAG,GAAA/b,KAClB+vB,UAAUhU,GAmBP8T,SAAS9T,EAA8B3b,EAAWC,GAC1D0b,EAAGiU,OACHjU,EAAGtC,UAAUrZ,EAAGC,GAChB0b,EAAGlI,MAAM9hB,KAAKwhB,IAAIvT,KAAK6T,MAAMzT,GAAIrO,KAAKwhB,IAAIvT,KAAK6T,MAAMxT,IAAAA,KAChD4vB,QAAQlU,GAAAA,KACRmU,MAAMnU,GAEXA,EAAGxT,QAAUwT,EAAGxT,QAAUvI,KAAKuI,QAGvB0nB,QAAQlU,SAChB,MAAMoU,EAAYnwB,KAAK6T,MAAMzT,EAAI,EAAI,GAAK,EACpCgwB,EAAYpwB,KAAK6T,MAAMxT,EAAI,EAAI,GAAK,EACpC4tB,EAAoB,QAAXoC,EAAArwB,KAAKiuB,cAAAA,IAAMoC,EAAAA,EAAIxd,EAAI7S,KAAKwH,MAAQ,EAAGxH,KAAKyH,OAAS,GAChEsU,EAAGtC,UAAUwU,EAAO7tB,EAAG6tB,EAAO5tB,GAC9B0b,EAAGnH,OAAO5U,KAAKivB,UAEflT,EAAGlI,MAAMsc,EAAWC,GACpBrU,EAAGtC,WAAWwU,EAAO7tB,GAAI6tB,EAAO5tB,GAGxB6vB,MAAMnU,QACLgT,iBACPhT,EAAGtC,UAAUzZ,KAAKwH,MAAQxH,KAAK6T,MAAMzT,EAAG,GACxC2b,EAAGlI,OAAO,EAAG,IAAA7T,KAGNgvB,eACPjT,EAAGtC,UAAU,EAAGzZ,KAAKyH,OAASzH,KAAK6T,MAAMxT,GACzC0b,EAAGlI,MAAM,GAAI,IAQPkc,UAAUhU,QACT+S,WACP/S,EAAGhV,MAAMiV,SAAS,EAAG,EAAGhc,KAAKwH,MAAOxH,KAAKyH,QAE3CsU,EAAGuU,oBC/MSC,GAAanwB,UACF,IAAjBA,EAAKA,EAAI,YAiBHowB,GAAiBpwB,UAC1BmwB,GAAanwB,GAGXA,EAfF,SAA+BA,KAClCA,MACG,IAAIrQ,EAAI,EAAGA,EAAI,GAAIA,IAAM,EAC5BqQ,GAASA,GAAKrQ,SAETqQ,EAAI,EALN,CAa0BA,YCpBjBqwB,GAAwBv2B,EAASw2B,UAC1Cx2B,QAAAA,IAGAA,EAAay2B,UAET,IAAIC,MAAM12B,EAAM,CACrBjB,IAAK,CAACkK,EAAKC,EAAMhS,KAEV+R,EAAYC,KAAUhS,IACxB+R,EAAYC,GAAQhS,EAED,iBAATgS,GAAAA,MACLA,EAAK,IACPstB,EAAOvtB,KAAAA,GAOfvO,IAAK,CAACuO,EAAKC,IAAAA,cACLA,GACMD,EAAYC,KArBnBlJ,WAiCK22B,GAA2B32B,EAASw2B,UAC7Cx2B,QAAAA,IAGAA,EAAay2B,UAET,IAAIC,MAAM12B,EAAM,CACrBjB,IAAK,CAACkK,EAAKC,EAAMhS,KAEd+R,EAAYC,GAAQhS,EAED,iBAATgS,GAAAA,MACLA,EAAK,IACPstB,EAAOvtB,IAAAA,GAObvO,IAAK,CAACuO,EAAKC,IAAAA,cACLA,GACMD,EAAYC,KApBnBlJ,EFQM42B,GAAAjC,IAAc,QG1ClBkC,0BAQmBxS,GAC5BwS,GAAcC,IAAMzS,aAOJ0S,UACTF,GAAcG,aAAat8B,IAAIq8B,cAOtBA,UACTF,GAAcG,aAAat9B,IAAIq9B,eAQrBA,EAAwBE,GAAAA,GAEzC,MAAMC,EAAKL,GAAcC,IACzB,IAAKI,EACH,OAAO,KAGT,IAAIC,EAAoB,KAOxB,GALIN,GAAcn9B,IAAIq9B,KACpBI,EAAMN,GAAcn8B,IAAIq8B,IAItBI,EACF,CAAA,GAAIF,EACFC,CAAAA,EAAGE,YAAYF,EAAGG,WAAYF,GAC9B,MAAMp9B,EAAS88B,GAAcS,kBAAkBP,GAC/CG,EAAGK,WAAWL,EAAGG,WAAY,EAAGH,EAAGM,KAAMN,EAAGM,KAAMN,EAAGO,cAAe19B,UAE/Do9B,EAITA,EAAMD,EAAGQ,gBACT,MAAM39B,EAAS88B,GAAcS,kBAAkBP,UAE/CG,EAAGE,YAAYF,EAAGG,WAAYF,GAE9BD,EAAGS,cAAcT,EAAGG,WAAYH,EAAGU,eAAgBV,EAAGW,eACtDX,EAAGS,cAAcT,EAAGG,WAAYH,EAAGY,eAAgBZ,EAAGW,eAGtDX,EAAGS,cAAcT,EAAGG,WAAYH,EAAGa,mBAAoBb,EAAGc,SAC1Dd,EAAGS,cAAcT,EAAGG,WAAYH,EAAGe,mBAAoBf,EAAGc,SAE1Dd,EAAGK,WAAWL,EAAGG,WAAY,EAAGH,EAAGM,KAAMN,EAAGM,KAAMN,EAAGO,cAAe19B,GAEpE88B,GAAcG,aAAaj4B,IAAIg4B,EAAOI,GAC/BA,2BAQuBJ,GAC9B,MAAMmB,EAAYrB,GAAcsB,YAC1BC,EAASvB,GAAcwB,gBACxBhC,GAAaU,EAAMzpB,QAAW+oB,GAAaU,EAAMxpB,UAGpD2qB,EAAU5qB,MAAQgpB,GAAiBS,EAAMzpB,OACzC4qB,EAAU3qB,OAAS+oB,GAAiBS,EAAMxpB,QAC1C6qB,EAAOE,uBAAAA,EACPF,EAAOjqB,UAAU,EAAG,EAAG+pB,EAAU5qB,MAAO4qB,EAAU3qB,QAClD6qB,EAAOG,UAAUxB,EAAO,EAAG,EAAGA,EAAMzpB,MAAOypB,EAAMxpB,QACjDwpB,EAAQmB,GAEHnB,GA5FMyB,GAAAL,YAAcv9B,SAASE,cAAc,UACrC09B,GAAAH,SAAWxB,GAAcsB,YAAYpqB,WAAW,MAIhDyqB,GAAAxB,aAAe,IAAIyB,UCYdC,WAAehE,eAKvBp4B,qBACV8b,MAAM9b,GAAAA,KAHAq8B,QAAAA,EAuGA7yB,KAAA8yB,YAAAA,EAaA9yB,KAAA+yB,OAAgBtC,GAAMrb,GAAM+B,OAAO,IAAAnX,KAAWgzB,mBA8B9CC,WAAqB,EAarBjzB,KAAAkzB,UAAsB,GAAAlzB,KAUtBmzB,SAAmB,EArKrB38B,IAAAA,KACG4f,MAAqB,QAAbgd,EAAA58B,EAAQ4f,aAAAA,IAAKgd,EAAAA,EAAIhe,GAAM+B,MACpCnX,KAAKqzB,YAAc78B,MAAAA,OAAAA,EAAAA,EAAS68B,YAC5BrzB,KAAKugB,UAA6B,QAAjB+S,EAAA98B,EAAQ+pB,iBAAAA,IAAS+S,EAAAA,EAAItzB,KAAKugB,UAC3CvgB,KAAK0tB,UAA6B,QAAjB6F,EAAA/8B,EAAQk3B,iBAAAA,IAAS6F,EAAAA,EAAIvzB,KAAK0tB,UAC3C1tB,KAAKwzB,SAA2B,QAAhBC,EAAAj9B,EAAQg9B,gBAAAA,IAAQC,EAAAA,EAAIzzB,KAAKwzB,SACzCxzB,KAAK0zB,QAAyB,QAAfC,EAAAn9B,EAAQk9B,eAAAA,IAAOC,EAAAA,EAAI3zB,KAAK0zB,SAAAA,KAGpCE,QAAU9+B,SAASE,cAAc,UAEtC,MAAM6+B,EAA4B,QAAdC,EAAAt9B,MAAAA,OAAAA,EAAAA,EAASgR,aAAAA,IAAKssB,EAAAA,EAAI9zB,KAAK4zB,QAAQpsB,MAC7CusB,EAA8B,QAAfC,EAAAx9B,MAAAA,OAAAA,EAAAA,EAASiR,cAAAA,IAAMusB,EAAAA,EAAIh0B,KAAK4zB,QAAQnsB,YAEhDD,MAAQgpB,GAAiBqD,GAAAA,KACzBpsB,OAAS+oB,GAAiBuD,GAC/B,MAAME,EAAWj0B,KAAK4zB,QAAQ3rB,WAAW,MACzC,IAAKgsB,EAEH,MAAM,IAAIvuB,MAAM,iFAEXsC,KAAOisB,EAITC,4BAEH9d,MAAOpW,KAAKoW,MAAQpW,KAAKoW,MAAMpB,QAAU,KACzCqe,YAAarzB,KAAKqzB,YAAcrzB,KAAKqzB,YAAYre,QAAU,KAC3DuL,UAAWvgB,KAAKugB,UAChBmN,UAAW1tB,KAAK0tB,UAChB8F,SAAUxzB,KAAKwzB,SACfE,QAAS1zB,KAAK0zB,SAOlBS,wBACctB,OAOPG,iBACAH,QAAAA,EAUPrrB,wBACc4sB,iBAEd5sB,UAAiBpW,QACVwiC,QAAQpsB,MAAQpW,EACrB4O,KAAKq0B,eAAiBjjC,EACtB4O,KAAKgzB,YAUPvrB,yBACc6sB,kBAGd7sB,WAAkBrW,QACXwiC,QAAQnsB,OAASrW,EACtB4O,KAAKu0B,gBAAkBnjC,EACvB4O,KAAKgzB,YAGCoB,8BACqB,QAAnBI,EAAAx0B,KAAKq0B,sBAAAA,IAAcG,EAAAA,EAAIx0B,KAAK4zB,QAAQpsB,OAAwB,EAAfxH,KAAK0zB,QAGpDY,+BACsB,QAApBG,EAAAz0B,KAAKu0B,uBAAAA,IAAeE,EAAAA,EAAIz0B,KAAK4zB,QAAQnsB,QAAyB,EAAfzH,KAAK0zB,QAM9D/D,yBACS9W,GAAY+W,cAAc5vB,KAAKo0B,iBAAAA,KAAwBvgB,MAAMzT,EAAGJ,KAAKs0B,kBAAAA,KAAyBzgB,MAAMxT,EAAGgM,EAAOmG,MAQvH+N,4BACcuS,WAEdvS,cAAqBnvB,QACd0hC,WAAa1hC,EAClB4O,KAAKgzB,YAQP5c,wBACc2c,OAEd3c,UAAiBhlB,UACC,QAAXsjC,EAAA10B,KAAK+yB,cAAAA,IAAM2B,OAAA,EAAAA,EAAE5d,MAAM1lB,KAAAA,KACjB4hC,YAAAA,KAEFD,OAAStC,GAAMr/B,GAAO,IAAA4O,KAAWgzB,cAQxCK,8BACcsB,aAEdtB,gBAAuBjiC,UACC,QAAjBwjC,EAAA50B,KAAK20B,oBAAAA,IAAYC,OAAA,EAAAA,EAAE9d,MAAM1lB,KAAAA,KACvB4hC,YAAAA,KAEF2B,aAAelE,GAAMr/B,GAAO,IAAA4O,KAAWgzB,cAQ9CtF,4BACcuF,WAEdvF,cAAqBt8B,QACd6hC,WAAa7hC,EAClB4O,KAAKgzB,YAIPQ,2BACcN,UAGdM,aAAoBpiC,QACb8hC,UAAY9hC,EACjB4O,KAAKgzB,YAIPU,0BACcP,SAGdO,YAAmBtiC,QACZ+hC,SAAW/hC,EAChB4O,KAAKgzB,YAOA6B,iBACAhC,QAAAA,EACL7yB,KAAKgI,KAAKK,UAAU,EAAG,EAAGrI,KAAKo0B,iBAAAA,KAAuBE,mBAAAA,KACjDtsB,KAAKgoB,OAAAA,KACL8E,uBAAuB90B,KAAKgI,MAAAA,KAC5B+sB,QAAQ/0B,KAAKgI,MAAAA,KACbA,KAAKsoB,UAEVS,GAAciE,KAAKh1B,KAAK4zB,SAAAA,GAGhBkB,uBAAuBnZ,kBAC1BiY,QAAQpsB,MAAQxH,KAAKo0B,iBAAAA,KACrBR,QAAQnsB,OAASzH,KAAKs0B,kBAC3B3Y,EAAIlC,UAAUzZ,KAAK0zB,QAAS1zB,KAAK0zB,SACjC/X,EAAI6W,sBAAwBxyB,KAAKugB,UACjC5E,EAAI+R,UAAY1tB,KAAK0tB,UACrB/R,EAAIsZ,YAAyB,QAAbC,EAAAl1B,KAAKwzB,gBAAAA,IAAQ0B,EAAAA,EAAIvZ,EAAIwZ,eACrCxZ,EAAIC,YAA8B,QAAhBwZ,EAAAp1B,KAAKqzB,mBAAAA,IAAW+B,OAAA,EAAAA,EAAEniC,WACpC0oB,EAAInT,UAAsB,QAAV6sB,EAAAr1B,KAAKoW,aAAAA,IAAKif,OAAA,EAAAA,EAAEpiC,WAGpB68B,WAAW/T,EAA8B3b,EAAWC,QACnDwyB,QAAAA,KACFgC,YAGP9Y,EAAG0W,UAAUzyB,KAAK4zB,QAASxzB,EAAGC,UC7NrB8E,WAAeytB,eAQN0C,GAClBhjB,MAAMgjB,GAAAA,KADYA,SAAAA,EAJpB3Z,sBACc3T,KAOPgN,eACE,IAAI7P,GAAO/U,OAAD+c,OAAA/c,OAAA+c,OAAA/c,OAAA+c,OAAA,QACPmoB,UAAAA,KACA5F,uBAAAA,KACAwE,uBAIZa,QAAQpZ,YACW,QAAb4Z,EAAAv1B,KAAKs1B,gBAAAA,IAAQC,OAAA,EAAAA,EAAEzZ,QACJ,QAAb0Z,EAAAx1B,KAAKs1B,gBAAAA,IAAQE,GAAAA,EAAE1Z,KAAKH,IAAAA,KAEZ2Z,SAASG,OAAAA,KACZzC,mBCqCE0C,WAAe1I,eAmHd2I,GACVrjB,QAAAA,KAnHKgM,OAAiB,IAAInZ,GAAO,CACjCob,WAAAA,EACAzE,KAAM9b,KAAK8b,KAAKhmB,KAAKkK,aAEf41B,cAAiC,GAAA51B,KACjC+J,OAAS,EAET/J,KAAA61B,kBAAAA,EACA71B,KAAA81B,eAAyB,EACzB91B,KAAA+1B,WAAqB,EACrB/1B,KAAAg2B,gBAA6C,QAC7CC,aAA0C,QAM3CC,KChGT,yqHDiGSl2B,KAAAm2B,UAAY,IACZn2B,KAAAo2B,WAAa,IAoBbp2B,KAAAq2B,gBAAyBjhB,GAAMiC,MAK/BrX,KAAAs2B,gBAA0B,UAY1Bt2B,KAAAu2B,oBAAAA,EAWGv2B,KAAAw2B,kBAA4BC,GAAAC,EAAAzjC,WAAA+M,KA2B/B22B,eAAyB,YAKzB32B,KAAA42B,mBAAqB,KAC1B,IAAIC,EAAmC/hC,SAASgiC,eAAe,yBAC1DD,IACHA,EAAgB/hC,SAASE,cAAc,WAGzC6hC,EAAcz4B,GAAK,iBACnBy4B,EAAcE,YAAc/2B,KAAK22B,eACjCE,EAAc/uB,MAAM8b,QAAU,OACvBiT,GASHlB,GAAAA,KACGqB,aAAarB,GAvEtBsB,yBACYC,gBAAAA,KACHA,cAAgB,IAAIC,MACzBn3B,KAAKk3B,cAAcE,IAAMp3B,KAAKk2B,MAAAA,KAGpBgB,cAIdG,wCACcC,uBAEdC,oCACcC,mBAOdC,kBACE,MAAMC,EAAe5iC,SAASgiC,eAAe,8BACzCY,IAAAA,KACGJ,uBAAyBI,GAAAA,KAEtBJ,yBAAAA,KACHA,uBAAyBxiC,SAASE,cAAc,OAAAgL,KAChDs3B,uBAAuBl5B,GAAK,sBACjC4B,KAAKs3B,uBAAuBxvB,MAAMC,SAAW,WAC7CjT,SAASoT,KAAKC,YAAYnI,KAAKs3B,yBAAAA,KAEvBK,cAAAA,KACHA,YAAc7iC,SAASE,cAAc,SAAAgL,KACrC23B,YAAYZ,YAAc/2B,KAAKw2B,kBACpC1hC,SAAS8iC,KAAKzvB,YAAYnI,KAAK23B,cAAAA,KAEvBH,qBAAAA,KACHA,mBAAqBx3B,KAAK42B,qBAAAA,KAC1BU,uBAAuBnvB,YAAYnI,KAAKw3B,qBAAAA,KAEnCA,mBAkCPK,WAAWlO,QACXmO,QAAUnO,EACf3pB,KAAKse,OAAO9W,MAAQxH,KAAK83B,QAAQxZ,OAAO9W,MACxCxH,KAAKse,OAAO7W,OAASzH,KAAK83B,QAAQxZ,OAAO7W,OAOpCswB,YAAYC,GACjB,MAAMvkC,EAAMuM,KAAK+J,cACZ6rB,cAAc5iC,KAAKglC,GAAAA,KACnBhC,gBAAgBviC,GAAO,EAC5BuM,KAAKi2B,aAAaxiC,GAAO,EACzBuM,KAAK81B,iBAOAkB,aAAarB,GAClB,IAAI5lC,EAAI,EACR,MAAM8W,EAAM8uB,EAAUrkC,YAEdvB,EAAI8W,EAAK9W,IAAAA,KACVgoC,YAAYpC,EAAU5lC,IAOxBkoC,uBACOlC,aAAAA,KAAoBD,eAM3BoC,iBACL,OACSxzB,KADA6xB,mBACA7xB,QAAQC,gBAEVkxB,kBAAAA,EACL71B,KAAKy3B,YAAY3vB,MAAM8b,QAAU,QACjC9uB,SAASoT,KAAKgX,iBAAiB,SAAUiZ,cACnCA,EAAI1kC,KAAAA,KACDgkC,YAAYW,WAGL,IAAI1zB,SAAeC,IACjC,MAAM0zB,EAAsBn1B,IAE1BA,EAAE6lB,kBACFpkB,UAEG8yB,YAAYvY,iBAAiB,QAASmZ,GAAAA,KACtCZ,YAAYvY,iBAAiB,WAAYmZ,GAAAA,KACzCZ,YAAYvY,iBAAiB,YAAamZ,OAO9CC,sBACAzC,kBAAAA,EACL71B,KAAKy3B,YAAY3vB,MAAM8b,QAAU,OAM5BzE,eACImY,uBAAuB7X,gBAAAA,KACzB6X,uBAAuBiB,YAAYv4B,KAAKw3B,oBAC7C1iC,SAASoT,KAAKqwB,YAAYv4B,KAAKs3B,wBAC/BxiC,SAAS8iC,KAAKW,YAAYv4B,KAAK23B,aAAAA,KAC1BL,uBAAyB,KAC9Bt3B,KAAKw3B,mBAAqB,KAC1Bx3B,KAAK23B,YAAc,MAIvBa,OAAOV,EAAiBW,IAUXzD,yDACLtwB,QAAQg0B,IACZ14B,KAAK41B,cAAc30B,KAAKoC,GACtBA,EAAE2xB,OAAO2D,SAAQ,UAEV5C,yBAML3kB,EAAM,WAAApR,KACDk4B,uBAIL/T,GAASyU,SAAAA,KACVN,iBAAAA,KAEQh+B,KAAO0F,KAAK41B,8SAGpBiD,4BACA9C,aAMP+C,2BACchD,eAAiB,EAAI3nB,EAAMnO,KAAK+1B,WAAY,EAAG/1B,KAAK81B,gBAAAA,KAAuBA,eAAiB,EAQnGha,KAAKH,GACV,MAAMgH,EAAe3iB,KAAK83B,QAAQnV,aAAe3iB,KAAK83B,QAAQjZ,WACxD4D,EAAcziB,KAAK83B,QAAQrV,YAAcziB,KAAK83B,QAAQjZ,WAE5D,GACQpsB,KADC6kC,uBACP,CAAA,MAAM7kC,EAAOuN,KAAK83B,QAAQxZ,OAAOnP,WAC3B4J,EAAM/Y,KAAK83B,QAAQxZ,OAAOhP,UAC1BypB,EAAc/4B,KAAKy3B,YAAYpU,YAC/B2V,EAAeh5B,KAAKy3B,YAAYnU,kBAC7B2V,oBAAAA,KACF3B,uBAAuBxvB,MAAMrV,KAAUuN,KAAKi5B,mBAAmB74B,EAA3B,KACzCJ,KAAKs3B,uBAAuBxvB,MAAMiR,IAAS/Y,KAAKi5B,mBAAmB54B,EAA3B,OAAAL,KAEnCs3B,uBAAuBxvB,MAAMrV,KAAUA,EAAOgwB,EAAc,EAAIsW,EAAc,EAA1C,KACzC/4B,KAAKs3B,uBAAuBxvB,MAAMiR,IAASA,EAAM4J,EAAe,EAAIqW,EAAe,EAAI,IAA/C,MAI5Crd,EAAInT,UAAYxI,KAAKs2B,gBACrB3a,EAAIud,SAAS,EAAG,EAAGzW,EAAaE,GAEhC,IAAIwW,EAAQxW,EAAe,EAC3B,MAAMnb,EAAQzV,KAAKwL,IAAIyC,KAAKm2B,UAAyB,IAAd1T,GACvC,IAAI2W,EAAQ3W,EAAc,EAAIjb,EAAQ,OAE7B6xB,eACPD,EAAQp5B,KAAKq5B,aAAaj5B,EAC1B+4B,EAAQn5B,KAAKq5B,aAAah5B,GAG5B,MAAMi5B,EAAcvnC,KAAKD,MAAM0V,GAAAA,KAAc4uB,WAAap2B,KAAKm2B,YACzDoD,EAAev5B,KAAK83B,QAAQ0B,kBASlC,GAEEx5B,KAVG83B,QAAQ2B,iBAAAA,GAAgBz5B,KACnBq5B,aAGR1d,EAAI8W,UAAUzyB,KAAKi3B,OAAQ,EAAG,EAAGj3B,KAAKm2B,UAAWn2B,KAAKo2B,WAAYgD,EAAOD,EAAO3xB,EAAO8xB,GAFvF3d,EAAI8W,UAAUzyB,KAAKi3B,OAAQ,EAAG,EAAGj3B,KAAKm2B,UAAWn2B,KAAKo2B,WAAYgD,EAAOD,EAAQG,EAAc,GAAI9xB,EAAO8xB,IAAAA,KAMlG/C,oBAAAA,KAA2BV,iBAEnC,YAAA71B,KADK83B,QAAQ2B,gBAAgBF,GAI/B,IAAIG,EAAWN,EACXO,EAAWR,OACNS,qBACPF,EAAW15B,KAAK45B,mBAAmBx5B,EACnCu5B,EAAW35B,KAAK45B,mBAAmBv5B,GAGrCsb,EAAI+R,UAAY,EAChBmM,GAAmBle,EAAK+d,EAAUC,EAAUnyB,EAAO,GAAI,GAAIxH,KAAKq2B,iBAChE,MAEMyD,EAFWtyB,EAAQxH,KAAK84B,SAEG/V,GAEjC8W,GACEle,EACA+d,EALa,EAMbC,EANa,EAObG,EAAgB,GAAKA,EAAgB,GALxB,GAOb,EACA,KACA95B,KAAKq2B,iBAAAA,KAEFyB,QAAQ2B,gBAAgBF,IE7YjC,MAAMQ,GAA+C,CACnDC,MAAO,QACPC,SAAU,WACVC,WAAY,qBAiCDC,sBACHC,UAA8B,KAE/Bp6B,KAAAq6B,YAAwB,GAAAr6B,KA+FvBs6B,eAAgC,CAEtCC,cAAe,WACb,MAAMC,EAAO1lC,SAASE,cAAc,mBAC1BwlC,EAAKvyB,aAAcuyB,EAAKvyB,WAAW,QAI/CwyB,mBAAoB,WAClB,MAAMC,EAAM,IAAIC,eAChBD,EAAIE,KAAK,MAAO,SAEdF,EAAIG,aAAe,cACnB,MAAO33B,kCAGFw3B,EAAIG,cAIbC,eAAgB,kBAEqD,IADpDhmC,SAASE,cAAc,UACxB+lC,UAAU,aAAatpC,QAAQ,mBAI/CupC,iBAAkB,yBACAziC,QAAAA,oBAA+B0iC,KAAAA,oBAA4BA,KAI7EC,YAAa,WACX,MAAMpzB,EAAQhT,SAASE,cAAc,KAAK8S,aAC1CA,EAAMqzB,QAAU,yCAAA,GACHrzB,EAAMwuB,iBAAiB7kC,QAAQ,SAAW,SAKnD2pC,aAA6B,CACnCC,gBAAiB,oBAEP9iC,OAAQ8L,cACR9L,OAAQ+L,oBACR/L,OAAQsM,iBACRtM,OAAQuM,gBACRvM,OAAQwM,gBAGlBu2B,aAAc,WACZ,MAAMd,EAAO1lC,SAASE,cAAc,mBAC1BwlC,EAAKvyB,aAAcuyB,EAAKvyB,WAAW,iBA/I1CmyB,UAAYp6B,KAAKu7B,uBAQjBC,4BACkB,OAAAx7B,KAAdo6B,YAAAA,KACFA,UAAYp6B,KAAKu7B,wBAAAA,KAEZnB,UAOPqB,qBACL,IAAIC,EAAM,+DACV,MAAM90B,EAAO,yEAEP+0B,EAAiB37B,KAAKw7B,yBACvB,MAAMphC,KAAWhK,OAAOC,KAAK0pC,IAC5B4B,EAAUvhC,IACZshC,GAAAA,UACA90B,EAAK5T,KAAAA,mCACL4T,EAAK5T,KAAAA,yCAAK4oC,GAEH,UAAAC,EACF7oC,KAAAA,iCACL4T,EAAK5T,KAAAA,wCAGP0oC,GAAO,IAAM3B,GAAAA,GAA6B,KAGvCzyB,EAAAA,QAELF,GAAAA,QAAQN,IAAIpP,MAAM0P,QAOZy0B,GAAAN,8BAGJjd,OAAQ,KAAAte,KACMs6B,eAAeC,gBADrB,GAKRuB,YAAa,KAAA97B,KACCs6B,eAAeG,qBADhB,GAKbsB,QAAS,KAAA/7B,KACKs6B,eAAeQ,iBADpB,GAKTkB,UAAW,KAAAh8B,KACGs6B,eAAeU,mBADlB,GAKXiB,KAAM,KAAAj8B,KACQs6B,eAAeY,cADvB,GAKNjB,SAAU,KAAAj6B,KACIo7B,aAAaC,kBADjB,GAKVrB,MAAO,KAAAh6B,KACOo7B,aAAaE,eADpB,GAKPpB,aACiBgC,UAAWC,aA6DzB/mC,OAEL,IAAqBwmC,GAAA,MAChB,MAAMxmC,KAAAA,KAAaklC,eACjBt6B,KAAKs6B,eAA0CzoC,GAAAA,KAAKmO,QAAAA,KAClDq6B,YAAYrnC,KACjBkT,GAAO2L,EAAAA,cAAcne,MAAM,wDAC3B0oC,GAAiBR,GAAA,GAGjBQ,GACFR,EAAA,OAAA,MAIG,MAAMS,KAAAA,KAAgBjB,aACpBp7B,KAAKo7B,aAAiCiB,MAClCxqB,EAAAA,cAAc5K,KAAK,4EAI9Bq1B,mBCtMFC,eAES1B,EACA2B,EAAqBC,GAAA,QAFrBtsC,KACAyrC,EAAA57B,KAAA66B,aACAgB,EAAA77B,KAAAw8B,UAZFC,EAAAz8B,KAAA1F,KAAU,KACV0F,KAAA08B,OAAwB7qB,EAAAA,cACxB7R,KAAA28B,OAA0B,IAAoB38B,GAAAA,MAiB9Ci4B,kBACgB,OAAdj4B,KAAK1F,KAINsiC,WAONjkB,qBALUvjB,KACRynC,GAAOlkB,GAAA,OAAS/O,KAAKC,MAEd8O,GAAA,OAAS/O,KAAKC,MAOlB8O,EAAAqc,cACE,IAAItwB,SAASC,CAASC,EAAAA,KAET,GAAA,OAAd5E,KAAK1F,KAIP,OAAA0F,KAHK08B,OAAO31B,MAAM,iCAAkC/G,KAAK7P,MACzD6P,KAAK28B,OAAOtQ,KAAK,WAAYrsB,KAAK1F,WAC1B0F,EAAAA,KAAK1F,MAIf,MAAgBwiC,EAAA,IAAInC,eACZC,EAAAA,KAAK,MAAO56B,KAAKw8B,UAAYx8B,KAAK48B,WAAW58B,KAAK7P,MAAQ6P,KAAK7P,MAAM,GACrE0qC,EAAAA,aAAe76B,KAAK66B,aACpB3b,EAAAA,iBAAiB,aAAoBlf,GAAAA,KAAK28B,OAAOtQ,KAAK,YAAanpB,KACnEgc,EAAAA,iBAAiB,YAAmBlf,GAAAA,KAAK28B,OAAOtQ,KAAK,WAAYnpB,KACjEgc,EAAAA,iBAAiB,SAAgBlf,GAAAA,KAAK28B,OAAOtQ,KAAK,QAASnpB,KAC3Dgc,EAAAA,iBAAiB,QAAelf,GAAAA,KAAK28B,OAAOtQ,KAAK,OAAQnpB,KACzDgc,EAAAA,iBAAiB,QAAQ,KAER,GAAA,IAAX6d,EAAAA,QAAmC,MAAXA,EAAAA,OAIlC,OAAA/8B,KAHK08B,OAAOhpC,MAAM,2BAA4BsM,KAAK7P,KAAM,oCAA6C4sC,EAAAA,QACtG/8B,KAAK28B,OAAOtQ,KAAK,QAAiB2Q,EAAAA,eAC3BC,EAAQD,EAAAA,eAIZ1iC,KAAe0iC,EAAAA,SACpBh9B,KAAK28B,OAAOtQ,KAAK,WAAYrsB,KAAK1F,MAClC0F,KAAK08B,OAAO31B,MAAM,6BAA8B/G,KAAK7P,MAC7C6P,EAAAA,KAAK1F,SAEP4iC,EAAAA,mVCzCdC,GAAA,IAAAC,GAAA,MACEC,YAAuBh9B,EAAWi9B,EAChCvtC,GAAA,MAA+CwtC,EAA3Bn9B,GAAIC,EAAIi9B,EAAU91B,EAAAA,OACxB81B,EAAUhjC,EAAAA,KACXkjC,GAAMC,EAAaF,EAAKC,GAAMC,EAAaF,EAAKC,GAAMC,EAAaF,EAAA,IAChFC,EAAMC,EAAaF,EAAKG,GACxBF,EAAMC,EAAaF,EAAKG,GACxBF,EAAMC,EAAaF,EAAKG,GAAAA,IAPNN,GAAAO,GAHrB3rB,CACC5J,EAAAA,CAAAA,QAAS,0CAEEw1B,IAkBb,IAAAC,GAAA,MACER,YAAuBh9B,EAAWi9B,EAChCvtC,GAAA,MAA+CwtC,EAA3Bn9B,GAAIC,EAAIi9B,EAAU91B,EAAAA,OACxB81B,EAAUhjC,EAAAA,KAClBmjC,EAAaF,EAAK,GAAA,IAAYE,EAAaF,EACjDC,GAAMC,EAAaF,EAAK,GAAA,IAAYE,EAAaF,EACjDC,GAAMC,EAAaF,EAAK,GAAA,IAAYE,EAAaF,EAAA,KANlCM,GAAAF,GAHlB3rB,CACC5J,EAAAA,CAAAA,QAAS,uCAEE01B,IAiBb,IAAAC,GAAA,kBAIqBC,QAAAz1B,QACnBy1B,EAAAX,YAAuBh9B,EAAWi9B,EAChCvtC,GAAA,MAA+CwtC,EAA3Bn9B,GAAIC,EAAIi9B,EAAU91B,EAAAA,OACxB81B,EAAUhjC,EAAAA,KACM,IAApBmjC,EAAaF,EAAA,KACfE,EAAaF,EAAKxrC,GAAAA,KAAKuc,MAAMtO,KAAKuI,QAAgBk1B,EAAaF,EAAA,OATvDQ,GAAAJ,GAHnB3rB,CACC5J,EAAAA,CAAAA,QAAS,wCAEE61B,IAsBb,IAAAC,GAAA,kBAIqBC,QAAA/nB,MACnB+nB,EAAAd,YAAuBh9B,EAAWi9B,EAChCvtC,GAAA,MAA+CwtC,EAA3Bn9B,GAAIC,EAAIi9B,EAAU91B,EAAAA,OACxB81B,EAAUhjC,EAAAA,KACM,IAApBmjC,EAAaF,EAAA,KACfE,EAAaF,EAAA,IAAYE,EAAaF,EAAKv9B,GAAAA,KAAKoW,MAAW/S,GACjEm6B,EAAMC,EAAaF,EAAA,IAAYE,EAAaF,EAAKv9B,GAAAA,KAAKoW,MAAW5d,GACjEglC,EAAMC,EAAaF,EAAA,IAAYE,EAAaF,EAAKv9B,GAAAA,KAAKoW,MAAW5e,GAAA,KAXlD0mC,GAAAP,GAHpB3rB,CACC5J,EAAAA,CAAAA,QAAS,yCAEEg2B,IAuBb,IAAAC,GAAA,kBAIsCC,EAAA,SAAjBzoB,OACnByoB,EAAAjB,YAAuBh9B,EAAWi9B,EAChCvtC,GAAA,MAA+CwtC,EAA3Bn9B,GAAIC,EAAIi9B,EAAU91B,EAAAA,OACxB81B,EAAUhjC,EAAAA,KACV8a,EAAMmpB,GAAAA,QAAcd,EAAaF,EAAIC,GAAMC,EAAaF,EAAIC,GAAMC,EAAaF,EAAIC,GAAMC,EAAaF,EAAA,IAAI3nB,QACtH5V,KAAK6V,QAED4nB,EAAaF,EAAKnnB,GAAM/S,EAC9Bm6B,EAAMC,EAAaF,EAAKnnB,GAAM5d,EAC9BglC,EAAMC,EAAaF,EAAKnnB,GAAM5e,EAC9BgmC,EAAMC,EAAaF,EAAKnnB,GAAM7e,EAAAA,IAdd8mC,GAAAV,GAHnB3rB,CACC5J,EAAAA,CAAAA,QAAS,wCAEEo2B,IAyBb,IAAAC,GAAA,kBAIsCC,EAAA,SAAjB7oB,OACnB6oB,EAAArB,YAAuBh9B,EAAWi9B,EAChCvtC,GAAA,MAA+CwtC,EAA3Bn9B,GAAIC,EAAIi9B,EAAU91B,EAAAA,OACxB81B,EAAUhjC,EAAAA,KACV8a,EAAMmpB,GAAAA,QAAcd,EAAaF,EAAIC,GAAMC,EAAaF,EAAIC,GAAMC,EAAaF,EAAIC,GAAMC,EAAaF,EAAA,IAAIvnB,OACtHhW,KAAK6V,QAED4nB,EAAaF,EAAKnnB,GAAM/S,EAC9Bm6B,EAAMC,EAAaF,EAAKnnB,GAAM5d,EAC9BglC,EAAMC,EAAaF,EAAKnnB,GAAM5e,EAC9BgmC,EAAMC,EAAaF,EAAKnnB,GAAM7e,EAAAA,IAdfknC,GAAAd,GAHlB3rB,CACC5J,EAAAA,CAAAA,QAAS,oCAEEu2B,IAyBb,IAAAC,GAAA,kBAIsCC,EAAA,SAAjBhpB,OACnBgpB,EAAAxB,YAAuBh9B,EAAWi9B,EAChCvtC,GAAA,MAA+CwtC,EAA3Bn9B,GAAIC,EAAIi9B,EAAU91B,EAAAA,OACxB81B,EAAUhjC,EAAAA,KACV8a,EAAMmpB,GAAAA,QAAcd,EAAaF,EAAIC,GAAMC,EAAaF,EAAIC,GAAMC,EAAaF,EAAIC,GAAMC,EAAaF,EAAA,IAAItnB,SACtHjW,KAAK6V,QAED4nB,EAAaF,EAAKnnB,GAAM/S,EAC9Bm6B,EAAMC,EAAaF,EAAKnnB,GAAM5d,EAC9BglC,EAAMC,EAAaF,EAAKnnB,GAAM5e,EAC9BgmC,EAAMC,EAAaF,EAAKnnB,GAAM7e,EAAAA,IAdbqnC,GAAAjB,GAHpB3rB,CACC5J,EAAAA,CAAAA,QAAS,yCAEE02B,IAyBb,IAAAC,GAAA,kBAIsCC,EAAA,SAAjBnpB,OACnBmpB,EAAA3B,YAAuBh9B,EAAWi9B,EAChCvtC,GAAA,MAA+CwtC,EAA3Bn9B,GAAIC,EAAIi9B,EAAU91B,EAAAA,OACxB81B,EAAUhjC,EAAAA,KACV8a,EAAMmpB,GAAAA,QAAcd,EAAaF,EAAIC,GAAMC,EAAaF,EAAIC,GAAMC,EAAaF,EAAIC,GAAMC,EAAaF,EAAA,IAAIrnB,WACtHlW,KAAK6V,QAED4nB,EAAaF,EAAKnnB,GAAM/S,EAC9Bm6B,EAAMC,EAAaF,EAAKnnB,GAAM5d,EAC9BglC,EAAMC,EAAaF,EAAKnnB,GAAM5e,EAC9BgmC,EAAMC,EAAaF,EAAKnnB,GAAM7e,EAAAA,IAdXwnC,GAAApB,GAHtB3rB,CACC5J,EAAAA,CAAAA,QAAS,2CAEE62B,IA0Bb,IAAAC,GAAA,kBAIqBC,QAAA/oB,MACnB+oB,EAAA9B,YAAuBh9B,EAAWi9B,EAChCvtC,GAAA,MAA+CwtC,EAA3Bn9B,GAAIC,EAAIi9B,EAAU91B,EAAAA,OACxB81B,EAAUhjC,EAAAA,KACM,IAApBmjC,EAAaF,EAAA,KACfE,EAAaF,EAAKv9B,GAAAA,KAAKoW,MAC7BonB,EAAMC,EAAaF,EAAKv9B,GAAAA,KAAKoW,MAC7BonB,EAAMC,EAAaF,EAAKv9B,GAAAA,KAAKoW,MAAM5e,cC3Ne4nC,GACtDC,wBACSA,EAAAlyB,OAGLwL,OAAK,MAAM/Y,KAEqB+Y,EAAA,mBAAA3Y,KAAPJ,KAAAA,KAEE0/B,GAAO1/B,EAAAA,mBAMlC0S,GAAAA,SAMaitB,GAAA,IAHKC,EAAAA,QAAO,SACvBC,mBAAOruC,KACNE,SACoBiuC,EAAA,IAAyB,iBAAPA,EAAA,IAA0BA,EAAA,aAAc51B,OAC/E3J,KAAKmN,OAAYoyB,EAAA,MD0LRL,GAAAvB,GAHhB3rB,CACC5J,EAAAA,CAAAA,QAAS,qCAEEs3B,UEnJXC,eAAiDv/B,EAAWC,EAAWmH,EAAeC,EAnD/Em4B,QAAYx/B,EACZ,EAAAJ,KAAYK,EAUZ,EAAAL,KAAAivB,SACA,EAAAjvB,KAAA6U,OAAwBnC,EAAAA,KACxB1S,KAAA6/B,OAAwBrtB,EAAAA,KACxBxS,KAAA6T,MAAuBpB,EAAAA,IAKvBzS,KAAA8/B,kBAAmB,EAEnB9/B,KAAA08B,OAAwB7qB,EAAAA,cAKxB7R,KAAAgvB,cAAwB,EAKxBhvB,KAAA+uB,gBAA0B,EAE1B/uB,KAAA+/B,QAAkC,GAAA//B,KAElCwH,MACA,EAAAxH,KAAAyH,OAEC,EAAAzH,KAAAggC,cAAmC,KACnChgC,KAAAigC,WAAuC,KACvCjgC,KAAAkgC,WAAwB,KACxBlgC,KAAAmgC,eAAyB,EACzBngC,KAAAogC,cAAwB,EAkGxBpgC,KAAAqgC,SAxFN,EAAA,IAAYC,EACZjB,EAAIiB,GAAAA,KAAmBA,aAAyBC,MACxBC,EAAlBF,EAAclgC,EAClBC,EAAsBogC,EAAlBH,EAAcjgC,EAClBmH,EAA8B+1B,EAAtB+C,EAAc94B,EAAAA,MACUo4B,EAAvBU,EAAc74B,EAAAA,OACf64B,EAAcrP,EAAAA,OACVyP,GAEV,MAAM,IAAIh7B,MADM,2DAKXtF,EAAKogC,GACdxgC,EAAAA,KAASK,EAAKogC,GAEdzgC,EAAAA,KAAK2gC,QACL3gC,EAAAA,KAAKggC,cAAgBlrC,SAASE,cAAc,UAC5CgL,KAAKggC,cAAcx4B,MACnBxH,EAAAA,KAAKggC,cAAcv4B,OACnBzH,EAAAA,KAAKigC,WAAajgC,KAAKggC,cAAc/3B,WAAW,MAChDjI,KAAK4gC,yBAEL5gC,KAAKwH,MACLxH,EAAAA,KAAKyH,OAzEPm4B,EAAAre,uBACSxvB,KAAKwhB,IAAIvT,KAAKwH,MAAQxH,KAAK6T,MAGpCzT,GAAAohB,wBACSzvB,KAAKwhB,IAAIvT,KAAKyH,OAASzH,KAAK6T,MAuEvBxT,GAAAugC,kEAEV,MAAM3P,QAAAA,KAAmB0P,QAAQE,YAC5Br5B,MAAQxH,KAAKwH,OAAes5B,EAAAA,aACjC9gC,KAAKyH,OAASzH,KAAKyH,QAAgBs5B,EAAAA,cACnC/gC,KAAKggC,cAAcx4B,MAAQxH,KAAKggC,cAAcx4B,OAAes5B,EAAAA,aAC7D9gC,KAAKggC,cAAcv4B,OAASzH,KAAKggC,cAAcv4B,QAAgBs5B,EAAAA,cAC/D/gC,KAAKghC,cACLhhC,KAAKogC,cAAe,EACpB,MACApgC,QAAK08B,OAAOhpC,MAAM,yBAA0BsM,KAAK2gC,QAAQxwC,KAAM+S,oSAI3D89B,cACFhhC,GACmBA,KADd2gC,QAAQ1I,aAAAA,KAAoBkI,cACnC,CAAA,MAAqBngC,EAAAA,KAAK2gC,QAAQ1P,MAAM6P,cAClCC,EAAgB/gC,EAAAA,KAAK2gC,QAAQ1P,MAAM8P,eAOzC,EALI/gC,GACeA,KADVwH,MACPxH,GAAAA,KAAK08B,OAAOz1B,KAAK,oBAAoBjH,KAAKwH,2DAClBs5B,4BAAuC9gC,KAAK2gC,QAAQxwC,QAAAA,KAGrEqX,OAAcs5B,GAAgBvB,GACrC,EAAA,MAAM,IAAI75B,MAAM,gEAAgE1F,KAAKwH,0BAA0Bs5B,KAG7G9gC,GACeA,KADVyH,OACPzH,GAAAA,KAAK08B,OAAOz1B,KAAK,qBAAqBjH,KAAKyH,6DACnBs5B,4BAAwC/gC,KAAK2gC,QAAQxwC,QAAAA,KAGtEsX,QAAes5B,GAAiBE,GACvC,EAAA,MAAM,IAAIv7B,MAAM,kEAAkE1F,KAAKyH,4BAA4Bs5B,UAGhHG,gBAELlhC,KAAKmgC,eAAgB,GAIjBe,gBACN,MAAqBlhC,EAAAA,KAAK2gC,QAAQ1P,MAAM6P,cAClCC,EAAgB/gC,EAAAA,KAAK2gC,QAAQ1P,MAAM8P,eAEzC/gC,OAAKigC,WAAW53B,UAAa,EAAGrI,EAAAA,KAAKwH,MAAOxH,KAAKyH,QACjDzH,KAAKigC,WAAWxN,UACdzyB,KAAK2gC,QAAQ1P,MACPjxB,EAAAA,KAAQI,EAAG0gC,EACjB3yB,GAAMnO,EAAAA,KAAQK,EAAG0gC,EACjB5yB,GAAMnO,EAAAA,KAAKwH,MAAUs5B,EACrB3yB,GAAMnO,EAAAA,KAAKyH,OAAWs5B,EACtBE,GACA,EACAjhC,EAAAA,KAAKwH,MACLxH,KAAKyH,QAQFc,QACLvI,QAAKqgC,SAMA1nB,EAAAwoB,iBACAC,UAAU,IAAIhE,IAMdxmB,cACAwqB,UAAU,IAAIvD,IAMdzP,KACLpuB,QAAKohC,UAAU,IAAiBhrB,GAAAA,IAO3BirB,SACLrhC,QAAKohC,UAAU,IAAqBhrB,GAAAA,IAM/BR,QAAyB+C,EAAA,SACzByoB,UAAU,IAAoBvrB,GAAAA,IAM9BG,OAAwB2C,EAAA,SACxByoB,UAAU,IAAmBvrB,GAAAA,IAM7BI,SAA0B0C,EAAA,SAC1ByoB,UAAU,IAAqBvrB,GAAAA,IAM/BK,WAA4ByC,EAAA,SAC5ByoB,UAAU,IAAuBvrB,GAAAA,IAOjCurB,UACLphC,QAAK+/B,QAAQ/sC,KAGRgN,GAAAA,KAAK2gC,QAAQ1I,YAAAA,KAAoBkI,cAGpCngC,KAAKshC,gBAFLthC,KAAKogC,cAAe,EAiBjBmB,aACL5oB,GAAA,IAAqBsoB,GAEnBO,EADmBP,EAAA,iBACHQ,EAEAzhC,EAAAA,KAAK+/B,QAAQtuC,QAI3B+vC,GAAgBP,EAAKO,GAAiBxhC,GAAAA,KAAK+/B,QAAQzuC,SAIvD0O,KAAK+/B,QAAQh1B,OAAsBk2B,EAI9BjhC,GAAAA,KAAK2gC,QAAQ1I,YAAAA,KAAoBkI,cAGpCngC,KAAKshC,gBAFLthC,KAAKogC,cAAe,GAMhBkB,gBACNthC,GAKcA,KALTkhC,gBAEDlhC,KAAK+/B,QAAQzuC,OACf0O,EAAAA,MAAKkgC,WAAalgC,KAAKigC,WAAWyB,aAAgB,EAAG1hC,EAAAA,KAAKwH,MAAOxH,KAAKyH,QAEtE,MAAYzH,EAAAA,KAAK+/B,QAAQzuC,WACpB,IAAQ2vC,EAAGlxC,EAAI8W,EAAK9W,EAAAA,IACvB,IAAK,IAAQ4xC,EAAGthC,EAAIL,EAAAA,KAAKyH,OAAQpH,IAC/B,IAAK,IAAQuhC,EAAGxhC,EAAIJ,EAAAA,KAAKwH,MAAOpH,IAC9BJ,KAAK+/B,QAAW1C,GAAAA,YAAeh9B,EAAGL,EAAAA,KAAKkgC,iBAIxCD,WAAW53B,UAAa,EAAGrI,EAAAA,KAAKwH,MAAOxH,KAAKyH,QACjDzH,KAAKigC,WAAW4B,aAAa7hC,KAAKkgC,WAAe,EAGnDlgC,QAAKogC,cAAe,EAMf0B,oBACA/B,QAAQzuC,OACb0O,EAAAA,KAAKshC,gBAMAS,SAIArmB,UAAyCtb,EAAWC,EACzDsb,GAAIqU,EAAAA,OACAvW,EAAAA,UAAapZ,EACjBsb,GAAI/G,EAAAA,OAAO5U,KAAKivB,UAChB,MAAejvB,EAAAA,KAAKuhB,UAAYvhB,KAAK6U,OAC/BmtB,EAAShiC,EAAAA,KAAKwhB,WAAaxhB,KAAK6U,OAEtC8G,EAAIC,EAAAA,YAAoBzE,GAAAA,MAAMlkB,WAC1B4oB,EAAAA,YAAqBmmB,GAAQhiC,EAAAA,KAAKuhB,UAAWvhB,KAAKwhB,YAClD8O,EAAAA,UAeCxU,KAA2D1b,EAAYC,EACxE4hC,GAAAA,aAAwBC,yBAC1BliC,KAAKmiC,iBAAmBxmB,CAAAA,IAAmBvb,EAAAA,EAAGC,EAAAA,EAAAA,SAEzC8hC,iBAIDxpB,GAAAwpB,wCACNC,EAAA,MAAMzmB,IAAK0mB,EAAEjiC,EAACkiC,EAAEjiC,EAACkiC,EAAAtT,SAAUuT,EAAAjhB,UAAWkhB,EAAAjhB,WAAYkhB,EAAA7tB,OAAQ8tB,EAAA9C,OAAQ+C,EAAAr6B,QAASs6B,EAAA9T,eAAgB3B,EAAA4B,aAAmB8T,GAAA1yC,OAAH+c,OAAA/c,OAAA+c,OAAA,GAC/FwL,GACVsW,CAAAA,SAA0B,QAAhBz4B,EAAQy4B,EAAAA,gBAAAA,IAAQ8T,EAAI/iC,EAAAA,KAAKivB,SACnC1N,UAA4B,QAAjB/qB,EAAQ+qB,EAAAA,iBAAAA,IAASyhB,EAAIhjC,EAAAA,KAAKwH,MACrCga,WAA8B,QAAlBhrB,EAAQgrB,EAAAA,kBAAAA,IAAUyhB,EAAIjjC,EAAAA,KAAKyH,OACvCsnB,eAAsC,QAAtBv4B,EAAQu4B,EAAAA,sBAAAA,IAAcmU,EAAIljC,EAAAA,KAAK+uB,eAC/CC,aAAkC,QAApBx4B,EAAQw4B,EAAAA,oBAAAA,IAAYmU,EAAInjC,EAAAA,KAAKgvB,aAC3Cna,OAAsB,QAAdre,EAAQqe,EAAAA,cAAAA,IAAMsoB,EAAIn9B,EAAAA,KAAK6U,OAC/BgrB,OAAsB,QAAdrpC,EAAQqpC,EAAAA,cAAAA,IAAMuD,EAAIpjC,EAAAA,KAAK6/B,OAC/Bt3B,SAAyB,QAAf/R,EAAQ+R,EAAAA,eAAAA,IAAO86B,EAAIA,EAAA,IAAmB,QAAbrjC,EAAAA,KAAKqgC,gBAAAA,IAAQ+B,EAAIA,EAAA,UAG7ChC,cACPpgC,KAAKshC,gBAGP,MAAgB/f,EAAY1M,EAAOzU,EAAIy/B,EAAOz/B,EACxCkjC,EAAU9hB,EAAa3M,EAAOxU,EAAIw/B,EAAOx/B,EACzC8vB,EAAYnwB,EAAAA,KAAK6T,MAAUzT,EAAI,EAAK,GACpCgwB,EAAYpwB,EAAAA,KAAK6T,MAAUxT,EAAI,EAAK,GAE1Csb,EAAIqU,EAAAA,OAEAvW,EAAAA,UAAapZ,EAIjBsb,GAAI9H,EAAAA,MAAM9hB,KAAKwhB,IAAIvT,KAAK6T,MAAU9hB,GAAAA,KAAKwhB,IAAIvT,KAAK6T,MAAMxT,IAElDL,KAAK8/B,kBAGHrmB,EAAAA,WAAqB6pB,GAG3B3nB,GAAIlC,EAAAA,UAAmB6pB,EACvB3nB,GAAI/G,EAAAA,OAEJ+G,GAAI9H,EAAAA,MAAiBuc,EACrBzU,GAAIlC,EAAAA,WAAqB6pB,GAErBvU,GAAAA,IACEtV,EAAAA,UAAqBgpB,EACzB9mB,GAAI9H,EAAAA,OAAU,EAAA,IAGZmb,IACEvV,EAAAA,UAAa+H,EACjB7F,GAAI9H,EAAAA,MAAU,GAAA,IAEhB,MAAiB8H,EAAI4nB,EAAAA,YACjBA,EAAAA,YAEJ5nB,EAAI8W,EAAAA,UACFzyB,KAAKggC,cAEL,EACAhgC,EAAAA,KAAKwH,MACLxH,KAAKyH,OAEL,EACAzH,EAAAA,KAAKwH,MACLxH,KAAKyH,QAEH87B,EAAAA,YACJ5nB,EAAI2U,EAAAA,UAMCtb,QACL,MAAewuB,EAAA,IAAWxjC,GAAAA,KAAK2gC,QAAS3gC,KAAQA,EAAAA,KAAQA,EAAAA,KAAKwH,MAAOxH,KAAKyH,QAClEoN,EAAAA,OAAS7U,KAAK6U,OAAOG,QACrBnB,EAAAA,MAAQ7T,KAAK6T,MAAMmB,QACnBia,EAAAA,SAAWjvB,KAAKivB,SAChBF,EAAAA,eAAiB/uB,KAAK+uB,eACtBC,EAAAA,aAAehvB,KAAKgvB,aAE3B,MAAYhvB,EAAAA,KAAK+/B,QAAQzuC,WACpB,IAAQmyC,EAAG1zC,EAAI8W,EAAK9W,EAAAA,IAChBqxC,EAAAA,UAAUphC,KAAK+/B,QAAQhwC,WA8BpCyzC,GAAA,IAAAE,GAAA,cAAyCC,GAAAA,iBAGUvjC,EAAYC,EAAYmH,EAAgBC,EACvF6K,GAAAA,MAAqBlS,EAAGC,EAAGmH,EAAOC,EAAAA,KAJnBi8B,sUAAAE,CAJlB5xB,CACC5J,EAAAA,CAAAA,QAAS,mDACT6J,gBAAiB,2BAENyxB,UC7ZXG,eAAwCrH,EAAYsH,GAAA,QAAjC3zC,KAAqB4zC,EAAA/jC,KAAAw8B,UAnBhCsH,EAAA9jC,KAAAgkC,QAAkB,KAWnBhkC,KAAA6gC,OAAS,IAAIn8B,SAA0BC,SACvCs/B,eAAiBt/B,KAQtB3E,KAAKkkC,UAAY,IAAa/zC,GAAM4zC,EAAA,OACpC/jC,GAAAA,KAAKgkC,QAAU,IAAWhkC,GAAAA,KAAS,EAAG,EAAG,EAf3C,GAAAixB,wBACc32B,KAqBP29B,wBACS39B,KAMH06B,gDAGT,IACAmP,EAAKnkC,GACGokC,KADEj0C,KAAKqB,SAAS,eAIhBwO,EAAAA,KAAK7P,SAHX,CAAA,MAAMi0C,QAAAA,KAAkBF,UAAUlP,OAC5BiG,EAAAA,IAAIoJ,gBAMZC,GAAA,MAAcA,EAAA,IAAInN,MACZC,EAAAA,IAAMmN,QACAC,EAAAA,SAGZxkC,KAAK1F,KACL0F,EAAAA,KAAKwH,MAAQxH,KAAKgkC,QAAQx8B,MAAcs5B,EAAAA,aACxC9gC,KAAKyH,OAASzH,KAAKgkC,QAAQv8B,OAAes5B,EAAAA,cAC1C/gC,KAAKgkC,QAAU,IAAWhkC,GAAAA,KAAS,EAAGA,EAAAA,KAAKwH,MAAOxH,KAAKyH,QACvD,MAAAg9B,SACM//B,QAAQE,OAAO,qCAGlBq/B,eAAejkC,KAAK1F,MAClB0F,KAAK1F,qSAGPoqC,uBACOV,eCEdW,eAAoDC,EAAmBC,EAAeC,EAzD/EC,QAAAH,QAAoB,GAAA5kC,KAUpBglC,aAEC,EAAAhlC,KAAAilC,iBACA,EAAAjlC,KAAAklC,mBAED,EAAAllC,KAAA6U,OAAwBrC,EAAAA,KACxBxS,KAAAivB,SACA,EAAAjvB,KAAA6T,MAAuBpB,EAAAA,IAKvBzS,KAAA8kC,MAAgB,EAMhB9kC,KAAAmlC,aAOA,EAAAnlC,KAAAgvB,cAAwB,EAKxBhvB,KAAA+uB,gBAA0B,EAE1B/uB,KAAAuhB,UACA,EAAAvhB,KAAAwhB,WACA,EAAAxhB,KAAAwH,MACA,EAAAxH,KAAAyH,OAEC,EAAAzH,KAAAqgC,SAWN,EAAA,IAAa+E,EACbjB,EAAIiB,GAAAA,KAAoBA,aAA0BC,IAChD,CAAA,MAAeD,EACfzb,EAAS2b,EAAO3b,EAAAA,OACN2b,EAAOV,EAAAA,QACTU,EAAOT,EAAAA,MACRS,EAAOR,EAAAA,UAGXF,QACL5kC,EAAAA,KAAK6kC,MACL7kC,EAAAA,KAAK83B,QACL93B,EAAAA,KAAKilC,iBAAmBjlC,KAAK6kC,MAEjB,MAARC,IACF9kC,KAAK8kC,KAGHF,GAAWA,GAAQN,EAAA,KAAAtkC,KAChBwhB,WAAqB8iB,EAAKM,GAAQN,EAAG9iB,GAAAA,WAC1CxhB,EAAAA,KAAKuhB,UAAoB+iB,EAAKM,GAAQN,EAAG/iB,GAAAA,UAEzCvhB,EAAAA,KAAKwH,MAAgB88B,EAAKM,GAAQN,EAAG98B,GAAAA,MACrCxH,EAAAA,KAAKyH,OAAiB68B,EAAKM,GAAQN,EAAG78B,GAAAA,OAEtCzH,EAAAA,KAAKmlC,YAAsB7zC,EAAAA,OAOxB,GAAAiX,QACLvI,QAAKqgC,SAMA1nB,EAAAwoB,iBACAC,UAAU,IAAIhE,IAMdxmB,cACAwqB,UAAU,IAAIvD,IAMdzP,KACLpuB,QAAKohC,UAAU,IAAiBhrB,GAAAA,IAO3BirB,SACLrhC,QAAKohC,UAAU,IAAqBhrB,GAAAA,IAM/BR,QAAyB+C,EAAA,SACzByoB,UAAU,IAAoBvrB,GAAAA,IAM9BG,OAAwB2C,EAAA,SACxByoB,UAAU,IAAmBvrB,GAAAA,IAM7BI,SAA0B0C,EAAA,SAC1ByoB,UAAU,IAAqBvrB,GAAAA,IAM/BK,WAA4ByC,EAAA,SAC5ByoB,UAAU,IAAuBvrB,GAAAA,IAMjCurB,UACLzoB,OAAK,MAAM5oB,KAAAA,KAAU60C,QACnB5kC,KAAK4kC,QAAWxD,GAAAA,UAebzoB,GAAA4oB,aACL5oB,OAAK,MAAM5oB,KAAAA,KAAU60C,QACnB5kC,KAAK4kC,QAAWrD,GAAAA,aAOb5oB,GAAAmpB,mBACA,MAAM/xC,KAAAA,KAAU60C,QACnB5kC,KAAK4kC,QAAW9C,GAAAA,eAIZyD,WAEN5sB,OAAK,MAAM5oB,KAAAA,KAAU60C,QACnB5kC,KAAK4kC,QAAW/vB,GAAAA,OAAO1B,MAAY/S,EAAGsZ,EAAMrZ,EAKxCA,GAAAmlC,aAEN7sB,OAAK,MAAM5oB,KAAAA,KAAU60C,QACnB5kC,KAAK4kC,QAAW3V,GAAAA,SAKZtW,EAAA8sB,UAEN9sB,OAAK,MAAM5oB,KAAAA,KAAU60C,QACnB5kC,KAAK4kC,QAAW/wB,GAAAA,MAQb8E,EAAAopB,aACAiD,aAMA,EAAAU,qBACQZ,MAAQ9kC,KAAKglC,cAAgBhlC,KAAK4kC,QAAQtzC,OAQlDq0C,KAAsBC,EAC3B1iC,GAAIlD,GAGJA,KAHSklC,oBACPhiC,EAAA,YAEGgiC,kBACLllC,EAAAA,KAAKilC,kBACDjlC,EAAAA,KAAKilC,kBAAoB,IAC3BjlC,KAAKglC,aAAehlC,KAAK8kC,MAAQ9kC,KAAKglC,aAAoBhlC,GAAAA,KAAK4kC,QAAQtzC,OAAS0O,KAAKglC,aACrFhlC,EAAAA,KAAKilC,iBAAmBjlC,KAAK6kC,OAG/B7kC,KAAK6lC,gBACL,MAAgB7lC,EAAAA,KAAK4kC,QAAQ5kC,KAAKglC,cAC9Bc,IACF9lC,KAAKwH,MAAgBA,EAAAA,MACrBxH,KAAKyH,OAAiBA,EAAAA,OACtBzH,KAAKuhB,UAAoBA,EAAAA,UACzBvhB,KAAKwhB,WAAqBA,EAAAA,YAItBqkB,qBACDN,WAAWvlC,KAAK6U,QACrB7U,KAAKwlC,aAAaxlC,KAAKivB,UACvBjvB,KAAKylC,UAAUzlC,KAAK6T,OAOfkyB,KACL/lC,QAAKglC,cAAgBhlC,KAAKglC,aAAyBhlC,GAAAA,KAAK4kC,QAAQtzC,OAe3DwqB,KAA2D1b,EAAYC,EACxE4hC,GAAAA,aAAwBC,yBAC1BliC,KAAKmiC,iBAAmBxmB,CAAAA,IAAmBvb,EAAAA,EAAGC,EAAAA,EAAAA,SAEzC8hC,iBAIDxpB,GAAAwpB,sCACN6D,EAAA,MAAoBC,EAAA71C,OAAH+c,OAAA/c,OAAA+c,OAAA,GACLwL,GACVsW,CAAAA,SAA0B,QAAhBz4B,EAAQy4B,EAAAA,gBAAAA,IAAQiX,EAAIlmC,EAAAA,KAAKivB,SACnC1N,UAA4B,QAAjB/qB,EAAQ+qB,EAAAA,iBAAAA,IAAS4kB,EAAInmC,EAAAA,KAAKuhB,UACrCC,WAA8B,QAAlBhrB,EAAQgrB,EAAAA,kBAAAA,IAAU4kB,EAAIpmC,EAAAA,KAAKwhB,WACvCuN,eAAsC,QAAtBv4B,EAAQu4B,EAAAA,sBAAAA,IAAcsX,EAAIrmC,EAAAA,KAAK+uB,eAC/CC,aAAkC,QAApBx4B,EAAQw4B,EAAAA,oBAAAA,IAAYsX,EAAItmC,EAAAA,KAAKgvB,aAC3Cna,OAAsB,QAAdre,EAAQqe,EAAAA,cAAAA,IAAM0xB,EAAIvmC,EAAAA,KAAK6U,OAC/BtM,SAAyB,QAAf/R,EAAQ+R,EAAAA,eAAAA,IAAOi+B,EAAIA,EAAA,IAAmB,QAAbxmC,EAAAA,KAAKqgC,gBAAAA,IAAQ2F,EAAIA,EAAA,KAItD,IADAhmC,OAAK6lC,gBAED7lC,KAAKglC,aAAehlC,KAAK4kC,QAAQtzC,SACtB0O,EAAAA,KAAK4kC,QAAQ5kC,KAAKglC,cACpBlpB,EAAAA,KAAK2qB,KAGQ,IAAtBzmC,KAAKmlC,aAAsBnlC,KAAKglC,cAAgBhlC,KAAK4kC,QAAQtzC,SAClD0O,EAAAA,KAAK4kC,QAAmB5kC,EAAAA,KAAKmlC,YAAgBnlC,EAAAA,KAAK4kC,QAAQtzC,OAAS,IACrEwqB,EAAAA,KAAK2qB,IAIdC,IACF1mC,KAAKuhB,UAAuBA,EAAAA,UAC5BvhB,KAAKwhB,WAAwBA,EAAAA,YAS1BmlB,KAAgBtmC,EACrBL,QAAK+hC,QACL/hC,KAAK83B,QAAQ8O,cAAc5mC,KAASK,EAAAA,IA8BxC,IAAAwmC,GAAA,cAA4CC,GAAAA,iBAGUC,EAAmBlC,EAAgBC,EACrFxyB,GAAAA,MAAsBy0B,EAAQlC,EAAOC,EAAAA,SC/X7BkC,MCIVC,GDHAC,GD0XoBL,oUArWfN,EAqWeY,CAJrBn1B,CACC5J,EAAAA,CAAAA,QAAS,uCACT6J,gBAAiB,4BAEN40B,UG3UJO,yCACLzuB,UAAsBqM,EAAeqiB,EAAaC,EAAAA,IACtCtiB,EACDA,EAASuiB,GAAOC,EAAMH,EAAKriB,EAAOsiB,EAAYD,GAE9CE,GAAOC,EAAMxiB,EAAOqiB,EAAKC,EAS/BG,yCACL9uB,UAAuB+uB,GAAAA,+BAGlB/uB,qCACLA,UAAsBqM,EAAeqiB,EAAaC,EAAAA,IACzC,IAAWC,EAAOC,EAAMxiB,EAAM5kB,EAAGinC,EAAIjnC,EAAGknC,EAAWC,GAAOC,EAAMxiB,EAAM3kB,EAAGgnC,EAAIhnC,EAAGinC,EAAAA,KAI7EK,GAAAA,OAAyCD,GAAAA,gCACpDtiB,CAAqBwiB,EAAoBC,EAAkBP,EAAAA,KACpCM,GACHxiB,GAAekiB,EAAWM,EAInCE,IAAAC,GAAAA,WAA6BL,GAAAA,gCACxCtiB,CAAqBwiB,EAAoBC,EAAkBP,EAAAA,KACpCM,GAAAA,IACPN,GAEiBliB,GAAcwiB,EAIpCE,IAAAE,GAAAA,YAA8CN,GAAAA,gCACzDtiB,CAAqBwiB,EAAoBC,EAAkBP,EAAAA,MACpCM,GAAAA,IACPN,GAAAA,IACiCW,EAAKL,GAI3CE,IAAAI,GAAAA,cAAgDR,GAAAA,gCAC3DtiB,CAAqBwiB,EAAoBC,EAAkBP,EAAAA,KACpCM,GACtBxiB,GAAekiB,GAAWa,EAER,GACRN,EAAWO,EAAKhjB,EAAcA,EAAcwiB,EAI7CC,GAAWO,EAAA,KAAqBhjB,GAAc6iB,EAAK,GAAKL,GAAAA,KAIvDS,GAAAA,YAA8CX,GAAAA,gCACzDtiB,CAAqBwiB,EAAoBC,EAAkBP,EAAAA,KACpCM,GAAAA,IACPN,GACiBliB,GAAcA,EAAcwiB,EAIlDE,IAAAQ,GAAAA,aAA+CZ,GAAAA,gCAC1DtiB,CAAqBwiB,EAAoBC,EAAkBP,EAAAA,KAE3CA,GADfO,GAAsBD,GAAAA,MAGWxiB,EAAcA,EAAc6iB,EAAKL,GAAAA,KAIxDW,GAAAA,eAAiDb,GAAAA,gCAC5DtiB,CAAqBwiB,EAAoBC,EAAkBP,EAAAA,KACpCM,GACtBxiB,GAAekiB,GAAWa,EACR,GACRN,EAAWO,EAAKhjB,EAAcA,EAAcA,EAAcwiB,EAG5DC,EAAWO,EAAA,IADJH,GACwB7iB,GAAcA,EAAc6iB,EAAKL,GAAAA,+TAzE5EY,CAJCx2B,CACC5J,EAAAA,CAAAA,QAAS,kFACT6J,gBAAiB,oFC9CnBw2B,eAHQR,QAAAS,SAAqB,GAAA1oC,KAErB2oC,kBAA8B,GAAA3oC,KAE/B4oC,OAOAX,EAAAl0B,IACL/T,QAAK0oC,SAAS11C,KAOT2lB,GAAAjI,OACLiI,GAAA,MAAc3Y,EAAAA,KAAK0oC,SAASj3C,QAC5BuO,QAAK0oC,SAAS39B,OAAc+8B,EAMvB,GAAAe,oBACAH,SAASp3C,OACd0O,EAAAA,KAAK2oC,kBAAkBr3C,OACnB0O,EAAAA,KAAK8oC,gBACP9oC,KAAK8oC,eAAeC,OAQjBC,yBACON,SAAS/sC,OAAOqE,KAAK2oC,mBAO5BM,sBACOP,SAASp3C,OAMhB,EAAA43C,oBAC2B,IAAzBlpC,KAAK0oC,SAASp3C,OAMhBywC,aACA2G,SAAW1oC,KAAKgpC,aAErB,MAAYhpC,EAAAA,KAAK0oC,SAASp3C,WACrB,IAAQw2C,EAAG/3C,EAAI8W,EAAK9W,EAAAA,IACvBiQ,KAAK0oC,SAAY3G,GAAAA,aAEd4G,kBAAoB,GAOpBnQ,OACDx4B,QAAK0oC,SAASp3C,OAAS,IACzB0O,KAAK8oC,eAAiB9oC,KAAK0oC,SAC3B1oC,GAAAA,KAAK8oC,eAAetQ,OAEhBx4B,GAAAA,KAAK8oC,eAAeI,WAAWlpC,KAAK4oC,SACtC5oC,KAAK2oC,kBAAkB31C,KAAKgN,KAAK0oC,SAASS,iBCpFhDC,eAA0BC,EAAsDC,EAHxElB,QAAAmB,UAAoB,EAI1BvpC,KAAKwpC,eACLxpC,EAAAA,KAAKypC,eAAiB,IAAkB1e,GACxC/qB,GAAAA,KAAK0pC,aAAe1pC,KAAKypC,eAAeE,WAExC3pC,KAAK4pC,QACL5pC,EAAAA,KAAK6pC,gBAEL7pC,EAAAA,KAAKwpC,eAAexpC,KAAKypC,gBACzBzpC,KAAK4pC,UAGApR,OACDx4B,QAAK0pC,aAAaR,eAAAA,KACfQ,aAAab,eAClB7oC,KAAKwpC,eAAexpC,KAAKypC,gBACzBzpC,KAAK4pC,WAAAA,KAEFF,aAAalR,OAGb7f,GAAAuwB,yBACOK,UAAavpC,KAAK4pC,SAAgB5pC,GAAAA,KAAK0pC,aAAaR,aAG3DH,YACAQ,UAAW,EAGXxH,aACA6H,QAAU5pC,KAAK6pC,uBC1BtBC,eAA0BT,EAHlBU,QAAAR,UAAoB,EAI1BvpC,KAAKwpC,eACLxpC,EAAAA,KAAKypC,eAAiB,IAAkB1e,GACxC/qB,GAAAA,KAAK0pC,aAAe1pC,KAAKypC,eAAeE,WAExC3pC,KAAKwpC,eAAexpC,KAAKypC,gBAGpBjR,OACDx4B,QAAKupC,WAILvpC,KAAK0pC,aAAaR,eAAAA,KACfQ,aAAab,eAClB7oC,KAAKwpC,eAAexpC,KAAKypC,iBAG3BzpC,KAAK0pC,aAAalR,OAAOlP,IAGpB4f,yBACOK,SAGPR,YACAQ,UAAW,EAChBvpC,KAAK0pC,aAAab,eAGb9G,gBC3BPiI,eAA0BhmB,EAAiBF,EAAiB+gB,EAI1DsD,GAPM,GAMoBnkB,KANpBimB,UAAW,EACXjqC,KAAAupC,UAAW,EAGjBvpC,KAAK4oC,OACL5oC,EAAAA,KAAKkqC,OACLlqC,EAAAA,KAAKmqC,QAAU,IAAWnmB,EAASF,EAC/B+gB,GAASsD,GAEX,EAAA,MADOt2B,EAAAA,cAAcne,MAAM,+DACrBy0C,GAAA,IAAIziC,MAAM,kDAIb8yB,OACAx4B,QAAKiqC,WACRjqC,KAAKiqC,UAAW,EAChBjqC,KAAKoqC,OAAS,IAAWpqC,EAAAA,KAAK4oC,OAAOtgC,IAAOtI,EAAAA,KAAK4oC,OAAOtgC,IACxDtI,GAAAA,KAAKqqC,KAAOrqC,KAAKoqC,OAAOr2B,IAAI/T,KAAKmqC,SACjCnqC,KAAKsqC,UAAYtqC,KAAKmqC,QAAQx2B,KAC9B3T,KAAKuqC,KAAOvqC,KAAKqqC,KAAKp2B,IAAIjU,KAAKoqC,QAAQ7vC,aAAAA,KAGhC2uC,WAAWlpC,KAAK4oC,SACvB5oC,KAAK4oC,OAAOtgC,IAAUtI,EAAAA,KAAKqqC,KAAQrqC,EAAAA,KAAKqqC,KACxCrqC,GAAAA,KAAK4oC,OAAO4B,IAAU9xB,EAAG,EAAA,IAEzB1Y,KAAK4oC,OAAO4B,IAAMxqC,KAAKuqC,KAAK12B,MAAM7T,KAAKkqC,QAIpChB,WACLvwB,eAAY4wB,UAAkBjhC,EAAAA,IAAIkL,SAASxT,KAAKoqC,SAAWpqC,KAAKsqC,UAG3DvB,YACAH,OAAO4B,IAAU9xB,EAAG,EACzB1Y,GAAAA,KAAKupC,UAAW,EAGXxH,aACAkI,UAAW,SCzClBQ,eAA0BC,EAAeC,EAAe9F,EAFhD+F,QAAAX,UAAW,EACXjqC,KAAAupC,UAAW,EAEjBvpC,KAAK4oC,OACL5oC,EAAAA,KAAKqqC,KAAO,IAAWK,EAAOC,EAC9B3qC,GAAAA,KAAKkqC,OAGAU,EAAApS,OACAx4B,QAAKiqC,WACRjqC,KAAKiqC,UAAW,EAChBjqC,KAAKoqC,OAAS,IAAWpqC,EAAAA,KAAK4oC,OAAOtgC,IAAOtI,EAAAA,KAAK4oC,OAAOtgC,IACxDtI,GAAAA,KAAKsqC,UAAYtqC,KAAKoqC,OAAO52B,SAASxT,KAAKqqC,MAC3CrqC,KAAKuqC,KAAOvqC,KAAKqqC,KAAKp2B,IAAIjU,KAAKoqC,QAAQ7vC,aAEzC,MAAUyF,EAAAA,KAAKuqC,KAAK12B,MAAM7T,KAAKkqC,aAC1BtB,OAAO4B,IAAUK,EAAEzqC,EAAGyqC,EAAExqC,EAEzBL,GAAAA,KAAKkpC,WAAWlpC,KAAK4oC,UAAAA,KAClBA,OAAOtgC,IAAUtI,EAAAA,KAAKqqC,KAAQrqC,EAAAA,KAAKqqC,KACxCrqC,GAAAA,KAAK4oC,OAAO4B,IAAU9xB,EAAG,EAAA,IAItBwwB,WACLvwB,eAAY4wB,UAAY,IAAWxe,EAAMziB,EAAAA,IAAOyiB,EAAMziB,EAAAA,IAAOkL,GAAAA,SAASxT,KAAKoqC,SAAWpqC,KAAKsqC,UAGtFvB,YACAH,OAAO4B,IAAU9xB,EAAG,EACzB1Y,GAAAA,KAAKupC,UAAW,EAGXxH,aACAkI,UAAW,INvClBhD,GALU6D,KAAYC,GAAA,KAKtB9D,GAAA+D,aAAA,GAAA,eAKA/D,GAAAA,GAAAgE,YAAA,GAAA,cAKAhE,GAAAA,GAAAiE,UAAA,GAAA,YAKAjE,GAAAA,GAAAkE,iBAAA,GAAA,yBOFAC,eAA0BC,EAAsBxG,EAAeyG,EAFvDC,QAAAtB,UAAW,EACXjqC,KAAAupC,UAAW,EAEjBvpC,KAAK4oC,OACL5oC,EAAAA,KAAKqqC,KACLrqC,EAAAA,KAAKkqC,OACLlqC,EAAAA,KAAKwrC,cAAgCV,GAAaE,GAAAA,aAG7CxS,OACL7f,GAAA,IAIoB5mB,KAJVk4C,SACRjqC,MAAKiqC,UAAW,EAChBjqC,KAAKoqC,OAASpqC,KAAK4oC,OAAO3Z,SAC1BjvB,KAAKyrC,uBAAyBzrC,KAAK4oC,OAAO3Z,SAC1C,MAAkBl9B,EAAAA,KAAKwhB,IAAIvT,KAAKqqC,KAAOrqC,KAAKoqC,QAC1BsB,EAAaC,EAW/BC,SAVgBC,EACd7rC,GAAAA,KAAK8rC,eACL9rC,EAAAA,KAAK+rC,cAAgBJ,IAErB3rC,KAAK8rC,eACL9rC,EAAAA,KAAK+rC,cAGP/rC,GAAAA,KAAKgsC,yBAA2BhsC,KAAKoqC,OAASpqC,KAAKqqC,KAAqBxqC,GAAc9N,GAAAA,KAE9EiO,GAAAA,KAAKwrC,oBACOR,GAAAA,kBACXV,UAAYtqC,KAAK8rC,eAClB9rC,KAAKgsC,wBACPhsC,KAAKisC,WAELjsC,EAAAA,KAAKisC,YAEP,aACgBhB,GAAAA,iBACXX,UAAYtqC,KAAK+rC,cAClB/rC,KAAKgsC,wBACPhsC,KAAKisC,YAELjsC,EAAAA,KAAKisC,WAEP,aACgBf,GAAAA,eACXe,WACDjsC,EAAAA,KAAKgsC,wBACPhsC,KAAKsqC,UAAYtqC,KAAK8rC,eAEtB9rC,KAAKsqC,UAAYtqC,KAAK+rC,yBAGRZ,GAAAA,sBACXc,YACAjsC,EAAAA,KAAKgsC,wBAGRhsC,KAAKsqC,UAAYtqC,KAAK+rC,cAFtB/rC,KAAKsqC,UAAYtqC,KAAK8rC,qBAQzBlD,OAAOsD,gBAAkBlsC,KAAKisC,WAAajsC,KAAKkqC,OACrDlqC,KAAKyrC,wBAA0BzrC,KAAKisC,WAAajsC,KAAKkqC,QAAmBvxB,EAAA,KAErE3Y,KAAKkpC,eAAAA,KACFN,OAAO3Z,SAAWjvB,KAAKqqC,KAC5BrqC,KAAK4oC,OAAOsD,gBACZlsC,EAAAA,KAAKupC,UAAW,GAIbL,aACL,MAA0Bn3C,EAAAA,KAAKwhB,IAAIvT,KAAKyrC,uBAAyBzrC,KAAKoqC,oBAC1Db,UAAiCx3C,GAAAA,KAAKwhB,IAAIvT,KAAKsqC,WAGtDvB,YACAH,OAAOsD,gBACZlsC,EAAAA,KAAKupC,UAAW,EAGXxH,aACAkI,UAAW,SC/ElBkC,eAA0BC,EAA4BvH,EAAeyG,EAF7De,QAAApC,UAAW,EACXjqC,KAAAupC,UAAW,EAEjBvpC,KAAK4oC,OACL5oC,EAAAA,KAAKkqC,OACLlqC,EAAAA,KAAKmqC,QACLnqC,EAAAA,KAAKwrC,cAAgCV,GAAaE,GAAAA,aAG7CxS,OACL7f,GAAA,IAMoB5mB,KANVk4C,SACRjqC,MAAKiqC,UAAW,EAChBjqC,KAAKoqC,OAASpqC,KAAK4oC,OAAO3Z,SAC1BjvB,KAAKyrC,uBAAyBzrC,KAAK4oC,OAAO3Z,SAC1CjvB,KAAKqqC,KAAOrqC,KAAKoqC,OAASpqC,KAAKmqC,QAE/B,MAAkBp4C,EAAAA,KAAKwhB,IAAIvT,KAAKqqC,KAAOrqC,KAAKoqC,QAC1BkC,EAAaX,EAW/BY,SAVgBV,EACd7rC,GAAAA,KAAK8rC,eACL9rC,EAAAA,KAAK+rC,cAAgBJ,IAErB3rC,KAAK8rC,eACL9rC,EAAAA,KAAK+rC,cAGP/rC,GAAAA,KAAKgsC,yBAA2BhsC,KAAKoqC,OAASpqC,KAAKqqC,KAAqBxqC,GAAc9N,GAAAA,KAE9EiO,GAAAA,KAAKwrC,oBACOR,GAAAA,kBACXV,UAAYtqC,KAAK8rC,eAClB9rC,KAAKgsC,wBACPhsC,KAAKisC,WAELjsC,EAAAA,KAAKisC,YAEP,aACgBhB,GAAAA,iBACXX,UAAYtqC,KAAK+rC,cAClB/rC,KAAKgsC,wBACPhsC,KAAKisC,YAELjsC,EAAAA,KAAKisC,WAEP,aACgBf,GAAAA,eACXe,WACDjsC,EAAAA,KAAK8rC,gBACP9rC,EAAAA,KAAKsqC,UAAYtqC,KAAK8rC,eAEtB9rC,KAAKsqC,UAAYtqC,KAAK+rC,yBAGRZ,GAAAA,sBACXc,YACDjsC,EAAAA,KAAK8rC,gBACP9rC,EAAAA,KAAKsqC,UAAYtqC,KAAK8rC,eAEtB9rC,KAAKsqC,UAAYtqC,KAAK+rC,oBAMzBnD,OAAOsD,gBAAkBlsC,KAAKisC,WAAajsC,KAAKkqC,OACrDlqC,KAAKyrC,wBAA0BzrC,KAAKisC,WAAajsC,KAAKkqC,QAAmBvxB,EAAA,KAErE3Y,KAAKkpC,eAAAA,KACFN,OAAO3Z,SAAWjvB,KAAKqqC,KAC5BrqC,KAAK4oC,OAAOsD,gBACZlsC,EAAAA,KAAKupC,UAAW,GAIbL,aACL,MAA0Bn3C,EAAAA,KAAKwhB,IAAIvT,KAAKyrC,uBAAyBzrC,KAAKoqC,oBAC1Db,UAAiCx3C,GAAAA,KAAKwhB,IAAIvT,KAAKsqC,WAGtDvB,YACAH,OAAOsD,gBACZlsC,EAAAA,KAAKupC,UAAW,EAGXxH,aACAkI,UAAW,SCxEpBuC,sBAoBEC,MAAiB,KAKjBz3B,QACE,MAAqB03B,EAAA,IAAK1sC,KAAK2sC,gBAC1B,MAAMvpC,KAAAA,KACLpD,GACUA,KADLtH,eAAsBk0C,GAC7B,CAAA,MAAY5sC,EAAAA,KAAKoD,IApDdhD,OAqDUhE,EAAAA,QAAAA,EArDP4Y,EAAAA,QAqDwB,UAAoB43B,GAAA,UAChDC,EAAazpC,EAAQhH,GAAI4Y,EAAAA,QAEZ5R,EAAQhH,GAzD/B0wC,EAAA,IA6DIC,SAyBGL,SAAMM,WAGXR,eAA4Dp7C,EAC1DkhB,GAAAA,QAD0BtS,KAAA9F,KAAgCwyC,EAAA1sC,KAAA5O,MChEvD67C,SAAMC,WAAbV,qCACkBxsC,KAAA9F,KAAO,YAKhB8F,KAAAwqC,IAAqBh4B,EAAAA,KAKrBxS,KAAAmtC,IAAqB36B,EAAAA,KAKrBxS,KAAAotC,YAA6B56B,EAAAA,KAK7BxS,KAAAksC,gBAKA,EAAAlsC,KAAAqtC,OAKA,EAAArtC,KAAAstC,QAAkB,IX7DzBpG,GADUF,KAAeuG,GAAA,KACzBrG,GAAAsG,EAAA,IAAA,IACAtG,GAAAA,GAAAzuB,EAAA,IAAA,IAGF,MAAcrc,GACA8qC,GAAA,IACHA,EAEF9qC,EAAM8qC,EAAK,GAAI,EAsBjB,QAAPuG,sBAYSnzC,KAAqB,IAAIozC,aAAa,IA8WrC1tC,KAAA2tC,YASA,EAAA3tC,KAAA4tC,YA3WD,eAA2Bl7C,EAAesmB,EAAgBD,EAAa80B,EAAcC,EAC1FzqC,GAAA,MAAY0qC,EAAA,IAoBZN,UAnBInzC,EAAAA,KAAU,GAAK5H,GAAQD,EAC3Bu7C,GAAI1zC,EAAAA,KAAU,GACd0zC,EAAI1zC,EAAAA,KAAU,GACd0zC,EAAI1zC,EAAAA,KAAU,GAEd0zC,EAAI1zC,EAAAA,KAAU,GACd0zC,EAAI1zC,EAAAA,KAAU,GAAKye,GAAMC,EACzBg1B,GAAI1zC,EAAAA,KAAU,GACd0zC,EAAI1zC,EAAAA,KAAU,GAEd0zC,EAAI1zC,EAAAA,KAAU,GACd0zC,EAAI1zC,EAAAA,KAAU,GACd0zC,EAAI1zC,EAAAA,KAAK,KAAO,GAAWuzC,EAC3BG,GAAI1zC,EAAAA,KAAK,IAET0zC,EAAI1zC,EAAAA,KAAK,MAAgB7H,EAAAA,IAAiBA,EAC1Cu7C,GAAI1zC,EAAAA,KAAK,MAAc0e,EAAAA,IAAiBA,EACxCg1B,GAAI1zC,EAAAA,KAAK,MAAcuzC,EAAAA,IAAeA,EACtCG,GAAI1zC,EAAAA,KAAK,IACF0zC,EAMFD,EAAA/4B,QACL,MAAYi5B,EAAA,IAoBZR,UAnBInzC,EAAAA,KAAU0F,GAAAA,KAAK1F,KACnB0zC,GAAI1zC,EAAAA,KAAU0F,GAAAA,KAAK1F,KACnB0zC,GAAI1zC,EAAAA,KAAU0F,GAAAA,KAAK1F,KACnB0zC,GAAI1zC,EAAAA,KAAU0F,GAAAA,KAAK1F,KAEnB0zC,GAAI1zC,EAAAA,KAAU0F,GAAAA,KAAK1F,KACnB0zC,GAAI1zC,EAAAA,KAAU0F,GAAAA,KAAK1F,KACnB0zC,GAAI1zC,EAAAA,KAAU0F,GAAAA,KAAK1F,KACnB0zC,GAAI1zC,EAAAA,KAAU0F,GAAAA,KAAK1F,KAEnB0zC,GAAI1zC,EAAAA,KAAU0F,GAAAA,KAAK1F,KACnB0zC,GAAI1zC,EAAAA,KAAU0F,GAAAA,KAAK1F,KACnB0zC,GAAI1zC,EAAAA,KAAK,IAAM0F,KAAK1F,KAAK,IACrBA,EAAAA,KAAK,IAAM0F,KAAK1F,KAAK,IAErBA,EAAAA,KAAK,IAAM0F,KAAK1F,KAAK,IACrBA,EAAAA,KAAK,IAAM0F,KAAK1F,KAAK,IACrBA,EAAAA,KAAK,IAAM0F,KAAK1F,KAAK,IACrBA,EAAAA,KAAK,IAAM0F,KAAK1F,KAAK,IAOpB2zC,oBACL,MAAYA,EAAA,IAoBZR,UAnBInzC,EAAAA,KAAU,GACd0zC,EAAI1zC,EAAAA,KAAU,GACd0zC,EAAI1zC,EAAAA,KAAU,GACd0zC,EAAI1zC,EAAAA,KAAU,GAEd0zC,EAAI1zC,EAAAA,KAAU,GACd0zC,EAAI1zC,EAAAA,KAAU,GACd0zC,EAAI1zC,EAAAA,KAAU,GACd0zC,EAAI1zC,EAAAA,KAAU,GAEd0zC,EAAI1zC,EAAAA,KAAU,GACd0zC,EAAI1zC,EAAAA,KAAU,GACd0zC,EAAI1zC,EAAAA,KAAK,IACT0zC,EAAI1zC,EAAAA,KAAK,IAET0zC,EAAI1zC,EAAAA,KAAK,IACT0zC,EAAI1zC,EAAAA,KAAK,IACT0zC,EAAI1zC,EAAAA,KAAK,IACT0zC,EAAI1zC,EAAAA,KAAK,IACF0zC,EAQFC,qBAA8B5tC,EACnC6C,GAAA,MAAYgrC,EAAOC,GAAAA,kBACf7zC,EAAAA,KAAK,IACT0zC,EAAI1zC,EAAAA,KAAK,IACF0zC,EAQFI,eAAyBC,EAC9BnrC,GAAA,MAAYgrC,EAAOC,GAAAA,kBACf7zC,EAAAA,KAAUg0C,GACdN,EAAI1zC,EAAAA,KAAU+zC,GACdL,EAAI1zC,EAAAA,KAAK,IACT0zC,EAAI1zC,EAAAA,KAAK,IACF0zC,EAOFI,kBACLz1B,GAAA,MAAYu1B,EAAOC,GAAAA,kBACf7zC,EAAAA,KAAUvI,GAAAA,KAAK4gB,IACnBq7B,GAAI1zC,EAAAA,KAAK,IAAMvI,KAAK6gB,IACpBo7B,GAAI1zC,EAAAA,KAAUvI,GAAAA,KAAK6gB,IACnBo7B,GAAI1zC,EAAAA,KAAUvI,GAAAA,KAAK4gB,IACZq7B,GASTO,EAAAv0B,MAEErB,GAAIsC,OAAAA,aACFuyB,EAAO,IACLvyB,EAAM7a,EAAIJ,EAAAA,KAAK1F,KAAU2gB,GAAM5a,EAAIL,EAAAA,KAAK1F,KAHlC,GAGgD0F,EAAAA,KAAK1F,KAAU,GAAI0F,EAAAA,KAAK1F,KAAK,IAC7E8F,EAAIJ,EAAAA,KAAK1F,KAAU2gB,GAAM5a,EAAIL,EAAAA,KAAK1F,KAJlC,GAIgD0F,EAAAA,KAAK1F,KAAU,GAAI0F,EAAAA,KAAK1F,KAAK,MAI7Eqe,EAAK3Y,GAAAA,KAAK1F,KAAU2gB,GAAMtC,EAAK3Y,GAAAA,KAAK1F,KARpC,GAQkD0F,EAAAA,KAAK1F,KAAU,GAAI0F,EAAAA,KAAK1F,KAAK,IAE/Eqe,EAAK3Y,GAAAA,KAAK1F,KAAU2gB,GAAMtC,EAAK3Y,GAAAA,KAAK1F,KAVpC,GAUkD0F,EAAAA,KAAK1F,KAAU,GAAI0F,EAAAA,KAAK1F,KAAK,KAU3Fk0C,MACE71B,GAAA,MAAa41B,EAAA,IACPE,GAAMzuC,EAAAA,KAAK1F,KACXo0C,GAAM1uC,EAAAA,KAAK1F,KACXq0C,GAAM3uC,EAAAA,KAAK1F,KACXs0C,GAAM5uC,EAAAA,KAAK1F,KAEXu0C,GAAM7uC,EAAAA,KAAK1F,KACXw0C,GAAM9uC,EAAAA,KAAK1F,KACXy0C,GAAM/uC,EAAAA,KAAK1F,KACX00C,GAAMhvC,EAAAA,KAAK1F,KAEX20C,GAAMjvC,EAAAA,KAAK1F,KACX40C,GAAMlvC,EAAAA,KAAK1F,KACX60C,GAAMnvC,EAAAA,KAAK1F,KAAK,IACV0F,EAAAA,KAAK1F,KAAK,IAEV0F,EAAAA,KAAK1F,KAAK,IACV0F,EAAAA,KAAK1F,KAAK,IACV0F,EAAAA,KAAK1F,KAAK,IACV0F,EAAAA,KAAK1F,KAAK,IAEV2gB,EAAM3gB,EAAAA,KACZ80C,GAAMn0B,EAAM3gB,EAAAA,KACZ+0C,GAAMp0B,EAAM3gB,EAAAA,KACZg1C,GAAMr0B,EAAM3gB,EAAAA,KAEZi1C,GAAMt0B,EAAM3gB,EAAAA,KACZk1C,GAAMv0B,EAAM3gB,EAAAA,KACZm1C,GAAMx0B,EAAM3gB,EAAAA,KACZo1C,GAAMz0B,EAAM3gB,EAAAA,KAEZq1C,GAAM10B,EAAM3gB,EAAAA,KACZs1C,GAAM30B,EAAM3gB,EAAAA,KACZu1C,GAAM50B,EAAM3gB,EAAAA,KAAK,IACX2gB,EAAM3gB,EAAAA,KAAK,IAEX2gB,EAAM3gB,EAAAA,KAAK,IACX2gB,EAAM3gB,EAAAA,KAAK,IACX2gB,EAAM3gB,EAAAA,KAAK,IACX2gB,EAAM3gB,EAAAA,KAAK,IAElBA,EAAAA,KAAUm0C,GAAMqB,EAAMjB,EAAMO,EAAMH,EAAMI,EAAMU,EAAMT,EACzDU,EAAK11C,EAAAA,KAAUo0C,GAAMoB,EAAMhB,EAAMM,EAAMF,EAAMG,EAAMY,EAAMX,EACzDU,EAAK11C,EAAAA,KAAUq0C,GAAMmB,EAAMf,EAAMK,EAAMD,EAAME,EAAMa,EAAMZ,EACzDU,EAAK11C,EAAAA,KAAUs0C,GAAMkB,EAAMd,EAAMI,EAAMe,EAAMd,EAAMe,EAAMd,EAEzDU,EAAK11C,EAAAA,KAAUm0C,GAAMc,EAAMV,EAAMW,EAAMP,EAAMQ,EAAMM,EAAML,EACzDM,EAAK11C,EAAAA,KAAUo0C,GAAMa,EAAMT,EAAMU,EAAMN,EAAMO,EAAMQ,EAAMP,EACzDM,EAAK11C,EAAAA,KAAUq0C,GAAMY,EAAMR,EAAMS,EAAML,EAAMM,EAAMS,EAAMR,EACzDM,EAAK11C,EAAAA,KAAUs0C,GAAMW,EAAMP,EAAMQ,EAAMW,EAAMV,EAAMW,EAAMV,EAEzDM,EAAK11C,EAAAA,KAAUm0C,GAAMkB,EAAMd,EAAMe,EAAMX,EAAMY,EAAME,EAAMM,EACzDL,EAAK11C,EAAAA,KAAUo0C,GAAMiB,EAAMb,EAAMc,EAAMV,EAAMW,EAAMI,EAAMI,EACzDL,EAAK11C,EAAAA,KAAK,IAAYq1C,EAAMZ,EAAMa,EAAMT,EAAMU,EAAMK,EAAMG,EAC1DL,EAAK11C,EAAAA,KAAK,IAAYq1C,EAAMX,EAAMY,EAAMO,EAAMN,EAAMO,EAAMC,EAE1DL,EAAK11C,EAAAA,KAAK,IAAYg2C,EAAMzB,EAAM0B,EAAMtB,EAAMuB,EAAMT,EAAMU,EAC1DT,EAAK11C,EAAAA,KAAK,IAAYg2C,EAAMxB,EAAMyB,EAAMrB,EAAMsB,EAAMP,EAAMQ,EAC1DT,EAAK11C,EAAAA,KAAK,IAAYg2C,EAAMvB,EAAMwB,EAAMpB,EAAMqB,EAAMN,EAAMO,EAC1DT,EAAK11C,EAAAA,KAAK,IAAYg2C,EAAMtB,EAAMuB,EAAMJ,EAAMK,EAAMJ,EAAMK,EAE1DC,EAAA,MAAU1wC,EAAAA,KAAK2wC,kBACVhD,EAAAA,YAAmB7jC,GAAE1J,EAAKwwC,GAAKZ,GAAKrC,EAAAA,aACpCC,EAAAA,YAAmB9jC,GAAEzJ,EAAKuwC,GAAKZ,GAAKpC,EAAAA,aAU3CW,EAAA90B,UAAqBpZ,EACnB6C,GAAA,MAAYlD,EAAAA,KAAK1F,KACXo0C,GAAM1uC,EAAAA,KAAK1F,KACXq0C,GAAM3uC,EAAAA,KAAK1F,KACXs0C,GAAM5uC,EAAAA,KAAK1F,KAEXu0C,GAAM7uC,EAAAA,KAAK1F,KACXw0C,GAAM9uC,EAAAA,KAAK1F,KACXy0C,GAAM/uC,EAAAA,KAAK1F,KACX00C,GAAMhvC,EAAAA,KAAK1F,KAEX20C,GAAMjvC,EAAAA,KAAK1F,KACX40C,GAAMlvC,EAAAA,KAAK1F,KACX60C,GAAMnvC,EAAAA,KAAK1F,KAAK,IACV0F,EAAAA,KAAK1F,KAAK,IAEV0F,EAAAA,KAAK1F,KAAK,IACV0F,EAAAA,KAAK1F,KAAK,IACV0F,EAAAA,KAAK1F,KAAK,IACV0F,EAAAA,KAAK1F,KAAK,gBAKjBA,KAAK,IAAY8F,EAAIyuC,EAAMxuC,EAFtB6C,EAE0B+rC,EAD1B5M,EACoC0N,EAC9C/vC,EAAAA,KAAK1F,KAAK,IAAY8F,EAAI0uC,EAAMzuC,EAHtB6C,EAG0BgsC,EAF1B5M,EAEoC2N,EAC9CjwC,EAAAA,KAAK1F,KAAK,IAAY8F,EAAI2uC,EAAM1uC,EAJtB6C,EAI0BisC,EAH1B5M,EAGoC2N,EAC9ClwC,EAAAA,KAAK1F,KAAK,IAAY8F,EAAI4uC,EAAM3uC,EALtB6C,EAK0BitC,EAJ1B3N,EAIoC4N,EAEvCpwC,EAAAA,KAGF6wC,YAAuBxwC,EAC5BL,QAAK1F,KAAK,IACV0F,EAAAA,KAAK1F,KAAK,IAGL4I,EAAA4L,qBACM9O,EAAAA,KAAK1F,KAAK,IAAK0F,KAAK1F,KAAK,KAOtCsa,OACE+D,GAAA,MAAY3Y,EAAAA,KAAK1F,KACXo0C,GAAM1uC,EAAAA,KAAK1F,KACXq0C,GAAM3uC,EAAAA,KAAK1F,KACXs0C,GAAM5uC,EAAAA,KAAK1F,KAEXu0C,GAAM7uC,EAAAA,KAAK1F,KACXw0C,GAAM9uC,EAAAA,KAAK1F,KACXy0C,GAAM/uC,EAAAA,KAAK1F,KACX00C,GAAMhvC,EAAAA,KAAK1F,KAEXw2C,GAAO/+C,EAAAA,KAAK6gB,IACZm+B,GAASh/C,EAAAA,KAAK4gB,IAYpBgG,eAVKre,KAAUy2C,GAAStC,EAAMqC,EAAOjC,EACrC7uC,EAAAA,KAAK1F,KAAUy2C,GAASrC,EAAMoC,EAAOhC,EACrC9uC,EAAAA,KAAK1F,KAAUy2C,GAASpC,EAAMmC,EAAO/B,EACrC/uC,EAAAA,KAAK1F,KAAUy2C,GAASnC,EAAMkC,EAAO9B,EAErChvC,EAAAA,KAAK1F,KAAUy2C,GAASlC,EAAMiC,EAAOrC,EACrCzuC,EAAAA,KAAK1F,KAAUy2C,GAASjC,EAAMgC,EAAOpC,EACrC1uC,EAAAA,KAAK1F,KAAUy2C,GAAShC,EAAM+B,EAAOnC,EACrC3uC,EAAAA,KAAK1F,KAAUy2C,GAAS/B,EAAM8B,EAAOlC,EAE9B5uC,EAAAA,KAQT6T,MAAiBxT,EACf6C,GAAA,MAAYlD,EAAAA,KAAK1F,KACXo0C,GAAM1uC,EAAAA,KAAK1F,KACXq0C,GAAM3uC,EAAAA,KAAK1F,KACXs0C,GAAM5uC,EAAAA,KAAK1F,KAEXu0C,GAAM7uC,EAAAA,KAAK1F,KACXw0C,GAAM9uC,EAAAA,KAAK1F,KACXy0C,GAAM/uC,EAAAA,KAAK1F,KACX00C,GAAMhvC,EAAAA,KAAK1F,KAYjB,eAVKA,KAAUm0C,GAAMruC,EACrBJ,EAAAA,KAAK1F,KAAUo0C,GAAMtuC,EACrBJ,EAAAA,KAAK1F,KAAUq0C,GAAMvuC,EACrBJ,EAAAA,KAAK1F,KAAUs0C,GAAMxuC,EAErBJ,EAAAA,KAAK1F,KAAUu0C,GAAMxuC,EACrBL,EAAAA,KAAK1F,KAAUw0C,GAAMzuC,EACrBL,EAAAA,KAAK1F,KAAUy0C,GAAM1uC,EACrBL,EAAAA,KAAK1F,KAAU00C,GAAM3uC,EAEdL,EAAAA,KAGFgxC,YACLr4B,GAAA,MAAqB3Y,EAAAA,KAAK2wC,WACb5+C,EAAAA,KAAK6gB,IACZm+B,GAASh/C,EAAAA,KAAK4gB,IAEpB3S,QAAK1F,KAAUy2C,GAASE,EAAa7wC,EACrCJ,EAAAA,KAAK1F,KAAUw2C,GAAOG,EAAa5wC,EACnCL,EAAAA,KAAK1F,KAAK,IAAa22C,EAAa7wC,EACpCJ,EAAAA,KAAK1F,KAAUy2C,GAASE,EAAa5wC,EAGhCA,EAAA6wC,qBACSn/C,EAAAA,KAAK4iB,MAAM3U,KAAK1F,KAAU0F,GAAAA,KAAKmxC,YAAanxC,KAAK1F,KAAU0F,GAAAA,KAAKoxC,cAIzEA,YAEL,MAAev+B,EAAI7S,EAAAA,KAAK1F,KAAS0F,GAAAA,KAAK1F,KAAK,IAAIqZ,iBACnCg6B,YAGP0D,EAAAF,YAEL,MAAet+B,EAAI7S,EAAAA,KAAK1F,KAAS0F,GAAAA,KAAK1F,KAAK,IAAIqZ,iBACnCi6B,YAMPyD,EAAAV,kBACM3wC,EAAAA,KAAKoxC,YAAapxC,KAAKmxC,aAI7BG,UACLtxC,QAAK2tC,YAAmBvxC,GAExBuc,GAAA,MAAe9F,EAAI7S,EAAAA,KAAK1F,KAAU0F,GAAAA,KAAK2tC,YAAa3tC,KAAK1F,KAAU0F,GAAAA,KAAK2tC,aAAapzC,iBAChFD,KAAUi3C,GAAOnxC,EAAIhE,EAC1B4D,EAAAA,KAAK1F,KAAUi3C,GAAOlxC,EAAIjE,EAIrBuc,EAAA64B,UACLxxC,QAAK4tC,YAAmBxxC,GAExBuc,GAAA,MAAe9F,EAAI7S,EAAAA,KAAK1F,KAAU0F,GAAAA,KAAK4tC,YAAa5tC,KAAK1F,KAAU0F,GAAAA,KAAK4tC,aAAarzC,iBAChFD,KAAUm3C,GAAOrxC,EAAIhE,EAC1B4D,EAAAA,KAAK1F,KAAUm3C,GAAOpxC,EAAIjE,EAGrBuc,EAAA+4B,SACL1xC,QAAKsxC,UAAgBlxC,EACrBJ,GAAAA,KAAKwxC,UAAgBnxC,EAMhBA,GAAAsxC,kCACOr3C,KAAU0F,GAAAA,KAAK1F,KAAU0F,GAAAA,KAAK1F,KAAU0F,GAAAA,KAAK1F,KAGpD,GAAAs3C,mBAML,MACmBC,EADP7xC,EAAAA,KAAK2xC,sBAEP3xC,EAAAA,KAAK1F,KACT9C,GAAIwI,EAAAA,KAAK1F,KACT7C,GAAIuI,EAAAA,KAAK1F,KACT0I,GAAIhD,EAAAA,KAAK1F,KAETuwC,GAAIqD,EAAOC,GAAAA,WAEf7zC,EAAAA,KAAU0I,GAAI8uC,EAChBjH,EAAEvwC,EAAAA,KAAK,IAAUw3C,EACjBjH,EAAEvwC,EAAAA,KAAK,IAAUw3C,EACjBjH,EAAEvwC,EAAAA,KAAU/C,GAAIu6C,EAEhBD,EAAA,MAAW7xC,EAAAA,KAAK1F,KAAK,IACV0F,EAAAA,KAAK1F,KAAK,WAGnBA,EAAAA,KAAK,MAAauwC,EAAEvwC,EAAAA,KAAUy3C,GAAKlH,EAAEvwC,EAAAA,KAAK,IAC1CA,EAAAA,KAAK,MAAauwC,EAAEvwC,EAAAA,KAAUy3C,GAAKlH,EAAEvwC,EAAAA,KAAK,IAKvC03C,EAAAC,oBAEc,IAAjBjyC,KAAK1F,KAAK,IACO,IAAjB0F,KAAK1F,KAAK,IACO,IAAjB0F,KAAK1F,KAAK,IACO,IAAjB0F,KAAK1F,KAAK,IACO,IAAjB0F,KAAK1F,KAAK,IACO,IAAjB0F,KAAK1F,KAAK,IACO,IAAjB0F,KAAK1F,KAAK,IACO,IAAjB0F,KAAK1F,KAAK,IACO,IAAjB0F,KAAK1F,KAAK,IACO,IAAjB0F,KAAK1F,KAAK,IACQ,IAAlB0F,KAAK1F,KAAK,KACQ,IAAlB0F,KAAK1F,KAAK,KACQ,IAAlB0F,KAAK1F,KAAK,KACQ,IAAlB0F,KAAK1F,KAAK,KACQ,IAAlB0F,KAAK1F,KAAK,KACQ,IAAlB0F,KAAK1F,KAAK,IAIPrH,uBAEN+M,KAAK1F,KAAK,MAAM0F,KAAK1F,KAAK,MAAM0F,KAAK1F,KAAK,MAAM0F,KAAK1F,KAAK,UAC1D0F,KAAK1F,KAAK,MAAM0F,KAAK1F,KAAK,MAAM0F,KAAK1F,KAAK,MAAM0F,KAAK1F,KAAK,UAC1D0F,KAAK1F,KAAK,MAAM0F,KAAK1F,KAAK,MAAM0F,KAAK1F,KAAK,OAAO0F,KAAK1F,KAAK,UAC3D0F,KAAK1F,KAAK,MAAM0F,KAAK1F,KAAK,MAAM0F,KAAK1F,KAAK,OAAO0F,KAAK1F,KAAK,gBY3ejD43C,WAKX1E,cACEl7B,GAAAA,MAAS,EACTtS,GAAAA,KAAKmyC,MAAgBC,EAAAA,KACrBpyC,KAAKqyC,MAAgBC,EAAAA,KACrBtyC,KAAKuyC,MAAgBC,EAAAA,KACrBxyC,KAAKyyC,MAAgBC,EAAAA,KAEvBtyC,oBACoBJ,GAAAA,KAAKmyC,QAGZ/1C,MACX4D,QAAKuyC,MACLvyC,GAAAA,KAAU5D,GAGZuc,EAAAtY,oBACoBL,GAAAA,KAAKqyC,QAEZj2C,MACX4D,QAAKyyC,MACLzyC,GAAAA,KAAU5D,GC0Cduc,GAAA,ICzEYg6B,GAAAA,GD8EVC,GCzEAC,GCgBUC,GAOAC,OFkDVH,GALUI,KAAUC,GAAA,KAKpBC,MAAA,QAKAN,GAAA31B,OAAA,eAGWk2B,WAAb3G,qCACkBxsC,KAAA9F,KAAO,eAEf8F,KAAA6yB,QAAS,EAED7yB,KAAA+Z,OAAgBo0B,GAAAA,WAAW10B,UAAa,EAAG7E,GAAAA,OAAUf,GAAAA,MAAS,EACtE,GAAA7T,KAAA4e,UA1Da7E,CAAAA,IACrB,MAAeA,EAyDmB/Z,KAAK+Z,cAxDhC,IAAeq5B,GACpBZ,CAAAA,KAAOpyC,IACE9F,EAAAA,KAAqBkzC,GAAKptC,GAEnCsyC,GAAAA,KAAOryC,IACE/F,EAAAA,KAAqBme,GAAKpY,GAEnC+xC,GAAAA,KAAM,IACU93C,EAAAA,KAAqBkzC,GAErC8E,GAAAA,KAAM,IACUh4C,EAAAA,KAAqBme,GAAAA,MAblBsB,GA2Db/Z,KAAAqzC,UACA,EAAArzC,KAAAszC,OA1Cev5B,CAAAA,IACvB,MAAeA,EAyCkB/Z,KAAK+Z,cAxC/B,IAAeq5B,GACpBZ,CAAAA,KAAOpyC,IACEkxC,EAAAA,UAAUlxC,IAEnBsyC,KAAOryC,IACEmxC,EAAAA,UAAUnxC,IAEnB+xC,KAAM,IACUhB,EAAAA,YAEhBkB,KAAM,IACUnB,EAAAA,eAbKp3B,GA0EhB/Z,KAAAuzC,WAAwBL,GAAAA,MAoExBlzC,KAAYwzC,EAlGX,EAAAC,oBACDJ,UAAYrzC,KAAK+Z,OAAOm3B,cAC7BlxC,KAAK6yB,QAAS,EAGT6gB,8BACKxkC,OAGDlP,KAAKkP,OAAOwkC,kBAAkBlF,MAAMxuC,KAAK+Z,QAFzC/Z,KAAK+Z,OAMT45B,4BAEHrrC,IAAKtI,KAAK4zC,UACV//B,MAAO7T,KAAK6zC,YACZ5kB,SAAUjvB,KAAK8zC,eACZ9zC,EAAAA,KACHuzC,EAAAA,WAAYvzC,KAAKuzC,YAIrBrkC,mBACE6kC,SAA0B,QAARA,EAAA,QAAX/zC,EAAAA,MAAAA,UAAAA,EAAAA,KAAMysC,aAAAA,IAAKmG,OAAA,EAAE1jC,EAAAA,cAAAA,IAAM6kC,OAAA,EAAEn/C,EAAAA,IAAIu+C,IAalC7qC,sBACWuqB,QACP7yB,KAAKyzC,eAEAzzC,KAAK4e,UAGdtW,QACEtI,QAAK+Z,OAAO82B,YAAgBzwC,EAAGhE,EAAIiE,EACnCL,GAAAA,KAAK6yB,QAAS,EAIhBsB,gBACE6f,EAAe,OAAA,QAAXh0C,EAAAA,MAAAA,UAAAA,EAAAA,KAAMysC,aAAAA,IAAKuH,OAAA,EAAE9kC,EAAAA,SAEflP,KADoBkP,OACNilB,YAEJtB,OAMd+gB,gBACE,MAAe5zC,EAAAA,KAAK0zC,yBACb,IAAeN,GACpBhB,CAAAA,KAAM,IAAa93C,EAAAA,KAAqBkzC,GACxC8E,GAAAA,KAAM,IAAah4C,EAAAA,KAAqBme,GACxC+5B,GAAAA,KAAOpyC,QACLguC,EAAIpuC,GACwBA,KADnBkP,OACP,CAAA,MAA0B+kC,GAAA,QAAXj0C,EAAAA,KAAKkP,cAAAA,IAAMk/B,OAAA,EAAEsF,EAAAA,kBAAkB9B,mBAAmB53B,MAAO5Z,CAAGnM,EAAOqG,EAAAA,KAAqBme,GAAAA,UAClGsB,OAAOzf,KAAqBkzC,GAAKzsB,GAAAA,OAAAA,KAEjChH,OAAOzf,KAAqBkzC,GAAKptC,GAG1CsyC,GAAAA,KAAOryC,QACL6zC,EAAIl0C,GAC0BA,KADrBkP,OACP,CAAA,MAA4B,CAAA+kC,GAAA,QAAXj0C,EAAAA,KAAKkP,cAAAA,IAAMglC,OAAA,EAAER,EAAAA,kBAAkB9B,mBAAmB53B,MAAO/lB,CAAOqG,EAAAA,KAAqBkzC,GAAIntC,GAAAA,SACrG0Z,OAAOzf,KAAqBme,GAAKuI,GAAAA,OAAAA,KAEjCjH,OAAOzf,KAAqBme,GAAKpY,GAAAA,KAM9CuzC,cACEj7B,GAAA,MAAwB3Y,EAAAA,KAAKkP,YAItB5G,IAAM6rC,EAAgBT,EAAAA,kBAAkB9B,mBAAmB53B,MAFrD5d,GAefuc,EAAAsW,2BACW4D,QACP7yB,KAAKyzC,eAEAzzC,KAAKqzC,UAGdpkB,aACEjvB,QAAK+Z,OAAOi3B,YACZhxC,GAAAA,KAAK6yB,QAAS,EAGhBihB,iCACcJ,kBAAkBxC,cAGhC4C,mBACEn7B,GAAA,MAAwB3Y,EAAAA,KAAKkP,YAItB+f,SAAW7yB,EAAM+3C,EAAgBL,EAAAA,eAO1Cn7B,EAAA9E,wBACWgf,QACP7yB,KAAKyzC,eAEAzzC,KAAKszC,OAGdz/B,UACE7T,QAAK+Z,OAAO23B,SACZ1xC,GAAAA,KAAK6yB,QAAS,EAGhBghB,kBACE,MAAe7zC,EAAAA,KAAK0zC,yBACb,IAAeN,GACpBhB,CAAAA,KAAM,IAAahB,EAAAA,YACnBkB,KAAM,IAAanB,EAAAA,YACnBqB,KAAOpyC,IACDJ,GACmBA,KADdkP,OACP,CAAA,MAAqBlP,EAAAA,KAAKkP,OAAO2kC,YACjC7zC,OAAK+Z,OAAOu3B,UAAc8C,EAAAA,QAAAA,KAErBr6B,OAAOu3B,UAAUlxC,IAG1BsyC,KAAOryC,IACDL,GACmBA,KADdkP,OACP,CAAA,MAAqBlP,EAAAA,KAAKkP,OAAO2kC,YACjC7zC,OAAK+Z,OAAOy3B,UAAc6C,EAAAA,QAAAA,KAErBt6B,OAAOy3B,UAAUnxC,MAM9BwzC,gBACEl7B,GAAA,MAAwB3Y,EAAAA,KAAKkP,YAItB2E,MAAQhB,EAAIzW,EAAIgE,EAAI+zC,EAAgBN,EAAAA,YAAez3C,EAAIiE,EAAI8zC,EAAgBN,EAAAA,YAFnEz3C,GAUVuc,EAAAjhB,MACLihB,eAAYoB,OAAOC,MAOdrB,GAAA27B,aACL37B,eAAYoB,OAAO63B,mBAAmB53B,MAAMN,UG5Q9C66B,eAA0BC,EAAgBC,EAAgBC,EAAgBC,EAFlEC,QAAA3K,UAAW,EACXjqC,KAAAupC,UAAW,EAEjBvpC,KAAK4oC,OACL5oC,EAAAA,KAAK60C,MACL70C,EAAAA,KAAK80C,MACL90C,EAAAA,KAAK+0C,QACL/0C,EAAAA,KAAKg1C,QAGAJ,EAAApc,OACL7f,GAAA,MAAkB3Y,EAAAA,KAAK4oC,OAAOh0C,IAAIu+C,IACnBnzC,EAAAA,KAAK4oC,OAAOh0C,IAAIs4C,IAC1BltC,GASgBA,KATXiqC,WACRjqC,KAAKiqC,UAAW,EAChBjqC,KAAKi1C,QAAoBphC,EAAAA,MACzB7T,EAAAA,KAAKk1C,QAAoBrhC,EAAAA,MACzB7T,EAAAA,KAAKm1C,WAAapjD,KAAKwhB,IAAIvT,KAAK60C,MAAQ70C,KAAKi1C,SAC7Cj1C,KAAKo1C,WAAarjD,KAAKwhB,IAAIvT,KAAK80C,MAAQ90C,KAAKk1C,UAGzCnjD,KAAKwhB,IAAcM,EAAAA,MAAU7T,EAAAA,KAAKi1C,UAAYj1C,KAAKm1C,WAIhD/H,EAAAA,YAAgBhtC,EAAA,MAHvB,CAAA,MAAmBJ,EAAAA,KAAK80C,MAAQ90C,KAAKk1C,SAAe,EACpDG,EAAOjI,EAAAA,YAAgBptC,EAAAA,KAAK+0C,QAK9BO,EAAMvjD,GAAAA,KAAKwhB,IAAcM,EAAAA,MAAU7T,EAAAA,KAAKk1C,UAAYl1C,KAAKo1C,WAIhDhI,EAAAA,YAAgB/sC,EAAA,MAHvB,CAAA,MAAmBL,EAAAA,KAAK80C,MAAQ90C,KAAKk1C,SAAe,EACpDG,EAAOjI,EAAAA,YAAgBptC,EAAAA,KAAKg1C,QAK1Bh1C,OAAKkpC,eAAAA,KACFN,OAAO/0B,MAAY7T,EAAAA,KAAK60C,MAAO70C,KAAK80C,OAClC1H,EAAAA,YAAgBhtC,EACvBi1C,EAAOjI,EAAAA,YAAgB/sC,EAIpB,GAAA6oC,yBAEEK,UACJx3C,KAAKwhB,IAAIvT,KAAK4oC,OAAO/0B,MAAU7T,EAAAA,KAAKi1C,UAAYj1C,KAAKm1C,YAAcpjD,KAAKwhB,IAAIvT,KAAK4oC,OAAO/0B,MAAU7T,EAAAA,KAAKk1C,UAAYl1C,KAAKo1C,WAItHrM,OACL,MAAe/oC,EAAAA,KAAK4oC,OAAOh0C,IAAIs4C,IACxBE,EAAAA,YAAgBhtC,EACvBi1C,EAAOjI,EAAAA,YAAgB/sC,EACvBL,EAAAA,KAAKupC,UAAW,EAGXxH,aACAkI,UAAW,SCtDlBsL,eAA0BC,EAAsBC,EAAsB5Q,EAJ9D6Q,QAAAzL,UAAW,EACXjqC,KAAAupC,UAAW,EAIjBvpC,KAAK4oC,OACL5oC,EAAAA,KAAKmqC,QAAU,IAAWqL,EAAcC,EACxCz1C,GAAAA,KAAK+0C,QAAU/0C,KAAKg1C,QAGfU,EAAAld,OACL7f,GAAA,MAAkB3Y,EAAAA,KAAK4oC,OAAOh0C,IAAIu+C,IACnBnzC,EAAAA,KAAK4oC,OAAOh0C,IAAIs4C,SACrBjD,WACRjqC,KAAKiqC,UAAW,EAChBjqC,KAAK21C,YAAwB9hC,EAAAA,MAAMmB,QACnChV,KAAK41C,UAAY51C,KAAK21C,YAAY5hC,IAAI/T,KAAKmqC,SAC3CnqC,KAAKm1C,WAAapjD,KAAKwhB,IAAIvT,KAAK41C,UAAc51C,EAAAA,KAAK21C,YACnD31C,GAAAA,KAAKo1C,WAAarjD,KAAKwhB,IAAIvT,KAAK41C,UAAc51C,EAAAA,KAAK21C,YACnD31C,GAAAA,KAAK61C,YAAc71C,KAAK41C,UAAc51C,EAAAA,KAAK21C,YAAiBv1C,GAAI,EAChEJ,EAAAA,KAAK81C,YAAc91C,KAAK41C,UAAc51C,EAAAA,KAAK21C,YAAiBt1C,GAAI,EAGlEg1C,GAAOjI,EAAAA,YAAgBptC,EAAAA,KAAK+0C,QAAU/0C,KAAK61C,YACpCzI,EAAAA,YAAgBptC,EAAAA,KAAKg1C,QAAUh1C,KAAK81C,YAEvC91C,KAAKkpC,eACGr1B,EAAAA,MAAQ7T,KAAK41C,UAChBxI,EAAAA,YAAgBhtC,EACvBi1C,EAAOjI,EAAAA,YAAgB/sC,EAIpB,GAAA6oC,yBAEEK,UACJx3C,KAAKwhB,IAAIvT,KAAK4oC,OAAO/0B,MAAU7T,EAAAA,KAAK21C,YAAYv1C,IAAMJ,KAAKm1C,YAC1DpjD,KAAKwhB,IAAIvT,KAAK4oC,OAAO/0B,MAAU7T,EAAAA,KAAK21C,YAAYt1C,IAAML,KAAKo1C,WAI1DrM,OACL,MAAe/oC,EAAAA,KAAK4oC,OAAOh0C,IAAIs4C,IACxBE,EAAAA,YAAgBhtC,EACvBi1C,EAAOjI,EAAAA,YAAgB/sC,EACvBL,EAAAA,KAAKupC,UAAW,EAGXxH,aACAkI,UAAW,SC7DlB8L,eAFQC,QAAAC,QAAqB,KACrBj2C,KAAAk2C,gBAA0B,EAEhCl2C,KAAKi2C,QAGAD,EAAAxd,OACLx4B,QAAKi2C,UACLj2C,KAAKk2C,gBAAiB,EAEjBhN,yBACOgN,eAEPnU,aACAmU,gBAAiB,EAEjBnN,YACAmN,gBAAiB,SCRxBC,eAEE/1C,EACAC,EACAinC,EACO8O,EAJAC,QAAAtrB,MAIAurB,EAAAt2C,KAAAo2C,UAZDC,EAAAr2C,KAAAu2C,iBACA,EAAAv2C,KAAAw2C,cAAwB,IACxBx2C,KAAAy2C,WAAqB,IAAWjJ,EAAG,EACnC,GAAAxtC,KAAA02C,SAAmB,IAAWlJ,EAAG,EACjC,GAAAxtC,KAAA22C,cAAwB,EACxB32C,KAAAupC,UAAoB,EACpBvpC,KAAAsqC,UAQNtqC,EAAAA,KAAKw2C,cACLx2C,EAAAA,KAAK02C,SAAW,IAAWt2C,EAAGC,EAExBu2C,GAAAC,mBACDJ,WAAa,IAAWz2C,EAAAA,KAAK+qB,MAAMziB,IAAOtI,EAAAA,KAAK+qB,MAAMziB,IAC1DtI,GAAAA,KAAKu2C,iBACLv2C,EAAAA,KAAKsqC,UAAYtqC,KAAKy2C,WAAWjjC,SAASxT,KAAK02C,UAG1Cle,OACAx4B,QAAK22C,eACR32C,KAAK62C,cACL72C,KAAK22C,cAAe,GAItB32C,KAAKu2C,kBACL59B,EAAA,IAAW3Y,EAAAA,KAAK+qB,MAAMziB,IAClB0Y,EAAOhhB,EAAAA,KAAK+qB,MAAMziB,IAClBtI,OAAKu2C,iBAAmBv2C,KAAKw2C,eAC3Bx2C,EAAAA,KAAK02C,SAAa12C,EAAAA,KAAKy2C,WAEvBz2C,EAAAA,KAAKy2C,WACJz2C,GAAAA,KAAKo2C,UAAUp2C,KAAKu2C,iBAAkBv2C,KAAK02C,SAAY12C,EAAAA,KAAKy2C,WAAcz2C,EAAAA,KAAKw2C,eAAiBx2C,KAAK02C,SAEjG12C,GAAAA,KAAKo2C,UAAUp2C,KAAKu2C,iBAAkBv2C,KAAKy2C,WAAcz2C,EAAAA,KAAK02C,SAAY12C,EAAAA,KAAKw2C,eAGpFx2C,EAAAA,KAAK02C,SAAa12C,EAAAA,KAAKy2C,WAEvBz2C,EAAAA,KAAKy2C,WACJz2C,GAAAA,KAAKo2C,UAAUp2C,KAAKu2C,iBAAkBv2C,KAAK02C,SAAY12C,EAAAA,KAAKy2C,WAAcz2C,EAAAA,KAAKw2C,eAAiBx2C,KAAK02C,SAEjG12C,GAAAA,KAAKo2C,UAAUp2C,KAAKu2C,iBAAkBv2C,KAAKy2C,WAAcz2C,EAAAA,KAAK02C,SAAY12C,EAAAA,KAAKw2C,eAGxFx2C,KAAK+qB,MAAMyf,IAAWzpB,GAAO/gB,EAAAA,KAAK+qB,MAAMziB,IAAIlI,IAAcuY,EAAA,MAAe3Y,EAAAA,KAAK+qB,MAAMziB,IAAIjI,IAAcsY,EAAA,QAAA3Y,KAEjG+qB,MAAMziB,IAAUtI,EAAAA,KAAK02C,SAAY12C,EAAAA,KAAK02C,SAC3C12C,GAAAA,KAAK+qB,MAAMyf,IAAah4B,EAAAA,MAGrB02B,WACLvwB,eAAY4wB,UAAY,IAAWxe,EAAMziB,EAAAA,IAAOyiB,EAAMziB,EAAAA,IAAOkL,GAAAA,SAASxT,KAAKy2C,aAAez2C,KAAKsqC,UAG1FvI,aACA4U,cAAe,EAEf5N,YACAhe,MAAMyf,IAAU9xB,EAAG,EACxB1Y,GAAAA,KAAKupC,UAAW,SC1DlBuN,eAA0BC,EAAqBC,EAAwBC,EAAoBC,EARnF,QAAAC,aACA,EAAAn3C,KAAAo3C,gBACA,EAAAp3C,KAAAq3C,aACA,EAAAr3C,KAAAs3C,WAGA,EAAAt3C,KAAAupC,UAAoB,EACpBvpC,KAAAiqC,UAAoB,EAE1BjqC,KAAK4oC,OACL5oC,EAAAA,KAAKm3C,aACLn3C,EAAAA,KAAKo3C,gBACLp3C,EAAAA,KAAKu3C,WAA2BP,EAAkBC,GAG7CC,EAAA1e,OACAx4B,QAAKiqC,WACRjqC,KAAKiqC,UAAW,GAGlBjqC,KAAKq3C,cACLr3C,EAAAA,KAAKs3C,YACDt3C,EAAAA,KAAK4oC,OAAO4O,SAAWx3C,KAAKq3C,cAAgBr3C,KAAKm3C,eACnDn3C,KAAK4oC,OAAO4O,SAAU,EACtBx3C,KAAKq3C,aAAe,IAGjBr3C,KAAK4oC,OAAO4O,SAAWx3C,KAAKq3C,cAAgBr3C,KAAKo3C,kBACpDp3C,KAAK4oC,OAAO4O,SAAU,EACtBx3C,KAAKq3C,aAGHr3C,GAAAA,KAAKkpC,eAAAA,KACFN,OAAO4O,SAAU,GAInBtO,yBACOK,UAAYvpC,KAAKs3C,YAAct3C,KAAKu3C,UAG3CxO,YACAH,OAAO4O,SAAU,EACtBx3C,KAAKupC,UAAW,EAGXxH,aACAkI,UAAW,EAChBjqC,KAAKq3C,aACLr3C,EAAAA,KAAKs3C,WCjDF,SAWLG,eAA0BC,EAAoB7S,EAJtC8S,QAAAC,YACA,EAAA53C,KAAAiqC,UAAW,EACXjqC,KAAAupC,UAAW,EAGjBvpC,KAAK4oC,OACL5oC,EAAAA,KAAK63C,YACL73C,EAAAA,KAAKkqC,OAGAyN,EAAAnf,OACAx4B,QAAKiqC,WACRjqC,KAAKiqC,UAAW,EAGZjqC,KAAK63C,YAAc73C,KAAK4oC,OAAOrgC,QACjCvI,KAAK43C,aAEL53C,EAAAA,KAAK43C,YAIL53C,GAAAA,KAAKkqC,OAAS,IAChBlqC,KAAK4oC,OAAOrgC,SAAYvI,KAAK43C,aAAe7lD,KAAKwhB,IAAIvT,KAAK4oC,OAAOrgC,QAAUvI,KAAK63C,aAAyB73C,GAAAA,KAAKkqC,QAGhHlqC,KAAKkqC,QAEDlqC,EAAAA,KAAKkpC,eAAAA,KACFN,OAAOrgC,QAAUvI,KAAK63C,aAGtBhmC,EAAAA,cAAc9K,MAAM,+BAAgC/G,KAAK4oC,OAAOrgC,SAGlE2gC,yBACOK,UAAYx3C,KAAKwhB,IAAIvT,KAAK4oC,OAAOrgC,QAAUvI,KAAK63C,aAAe,IAGtE9O,YACAQ,UAAW,EAGXxH,aACAkI,UAAW,SC5ClB6N,eAA0B1mC,EAJlB2mC,QAAAV,aAEA,EAAAr3C,KAAAiqC,UAAoB,EACpBjqC,KAAAupC,UAAW,EAEjBvpC,KAAK4oC,OACL5oC,EAAAA,KAAKg4C,OAGAD,EAAAvf,OACAx4B,QAAKiqC,WACRjqC,KAAKiqC,UAAW,GAGlBjqC,KAASA,EAAAA,KAAK4oC,OAAOtgC,IACrBtI,EAAAA,KAASA,EAAAA,KAAK4oC,OAAOtgC,IAErBtI,EAAAA,KAAKq3C,cAGP1+B,EAAAuwB,yBACcK,UAAYvpC,KAAKq3C,cAAgBr3C,KAAKg4C,OAG7CjP,YACAQ,UAAW,EAGlBxH,aACOsV,aACLr3C,EAAAA,KAAKiqC,UAAW,SC3BlBgO,eAFQC,QAAA3O,UAAW,EAGjBvpC,KAAK4oC,OAGAsP,EAAA1f,OACLx4B,QAAK4oC,OAAOuP,QAAQtP,eACpB7oC,KAAK4oC,OAAOwP,OACZp4C,KAAKupC,UAAW,EAGXL,yBACOK,SAGPR,QAIAhH,gBCVPsW,eAA0BC,EAAsBC,EAHxCC,QAAAvO,UAAW,EACXjqC,KAAAupC,UAAW,EAGjBvpC,KAAK4oC,OACL5oC,EAAAA,KAAKy4C,eACLz4C,EAAAA,KAAK04C,SAAW,IAAW14C,EAAAA,KAAK4oC,OAAOtgC,IAAOtI,EAAAA,KAAK4oC,OAAOtgC,IAC1DtI,GAAAA,KAAKqqC,KAAO,IAAWiO,EAAchwC,EAAAA,IAAOgwC,EAAchwC,EAAAA,IAC1DtI,GAAAA,KAAK24C,sBAAAA,IAAkDJ,EAAiBv4C,EAAAA,KAAK04C,SAASllC,SAASxT,KAAKqqC,MACpGrqC,KAAKkqC,OAGA,EAAA1R,OACAx4B,QAAKiqC,WACRjqC,KAAKiqC,UAAW,EAChBjqC,KAAK44C,iBAAmB54C,KAAK04C,SAASllC,SAASxT,KAAKqqC,MACpDrqC,KAAKuqC,KAAOvqC,KAAKqqC,KAAKp2B,IAAIjU,KAAK04C,UAAUn+C,aAG3C,MAA2BxI,EAAAA,KAAKkhB,KAAKlhB,KAAKmhB,IAAIlT,KAAKy4C,eAAejO,IAAOpqC,EAAKrO,GAAAA,KAAKmhB,IAAIlT,KAAKy4C,eAAejO,IAAOnqC,EAAA,IACvF,GAAA,IAAvBw4C,IACF74C,KAAKkqC,OAEPlqC,GAAAA,KAAK04C,SAAe14C,EAAAA,KAAK4oC,OAAOtgC,IAAOtI,EAAAA,KAAK4oC,OAAOtgC,IAEnDtI,GAAAA,KAAKqqC,KAAWrqC,EAAAA,KAAKy4C,eAAenwC,IAAOtI,EAAAA,KAAKy4C,eAAenwC,IAC/DtI,GAAAA,KAAK44C,iBAAmB54C,KAAK04C,SAASllC,SAASxT,KAAKqqC,MACpDrqC,KAAKuqC,KAAOvqC,KAAKqqC,KAAKp2B,IAAIjU,KAAK04C,UAAUn+C,YAErCyF,KAAK44C,kBAAoB54C,KAAK24C,iBAChC,CAAA,MAAU34C,EAAAA,KAAKuqC,KAAK12B,MAAM7T,KAAKkqC,aAC1BtB,OAAO4B,IAAUK,EAAEzqC,EAAGyqC,EAAExqC,EAAAA,QAAAA,KAExBuoC,OAAO4B,IAAU9xB,EAAG,EAGvB1Y,QAAKkpC,eAAAA,KACFN,OAAOtgC,IAAUtI,EAAAA,KAAKqqC,KAAQrqC,EAAAA,KAAKqqC,KACxCrqC,GAAAA,KAAK4oC,OAAO4B,IAAU9xB,EAAG,EAAA,IAItBqwB,YACAH,OAAO4B,IAAU9xB,EAAG,EACzB1Y,GAAAA,KAAKupC,UAAW,EAGXL,yBAEOK,SAGPxH,aACAkI,UAAW,SClDlB6O,eAA0BC,EAAoBlU,EAJtCmU,QAAA/O,UAAW,EACXjqC,KAAAupC,UAAW,EACXvpC,KAAAi5C,oBAAqB,EAG3Bj5C,KAAK4oC,OACL5oC,EAAAA,KAAKk5C,aACLl5C,EAAAA,KAAK04C,SAAW,IAAW14C,EAAAA,KAAK4oC,OAAOtgC,IAAOtI,EAAAA,KAAK4oC,OAAOtgC,IAC1DtI,GAAAA,KAAKqqC,KAAO,IAAW0O,EAAYzwC,EAAAA,IAAOywC,EAAYzwC,EAAAA,IACtDtI,GAAAA,KAAKkqC,OAAkB8O,GAAA,OAAA,IAEnBnU,IACF7kC,KAAKi5C,oBAAqB,GAIvBzgB,OACAx4B,QAAKiqC,WACRjqC,KAAKiqC,UAAW,EAChBjqC,KAAK44C,iBAAmB54C,KAAK04C,SAASllC,SAASxT,KAAKqqC,MACpDrqC,KAAKuqC,KAAOvqC,KAAKqqC,KAAKp2B,IAAIjU,KAAK04C,UAAUn+C,aAG3C,MAAyBxI,EAAAA,KAAKkhB,KAAKlhB,KAAKmhB,IAAIlT,KAAKk5C,aAAa1O,IAAOpqC,EAAKrO,GAAAA,KAAKmhB,IAAIlT,KAAKk5C,aAAa1O,IAAOnqC,EAAA,IACnF,IAAML,GAAAA,KAAKi5C,qBAClCj5C,KAAKkqC,OAEPlqC,GAAAA,KAAK04C,SAAe14C,EAAAA,KAAK4oC,OAAOtgC,IAAOtI,EAAAA,KAAK4oC,OAAOtgC,IAEnDtI,GAAAA,KAAKqqC,KAAWrqC,EAAAA,KAAKk5C,aAAa5wC,IAAOtI,EAAAA,KAAKk5C,aAAa5wC,IAC3DtI,GAAAA,KAAK44C,iBAAmB54C,KAAK04C,SAASllC,SAASxT,KAAKqqC,MACpDrqC,KAAKuqC,KAAOvqC,KAAKqqC,KAAKp2B,IAAIjU,KAAK04C,UAAUn+C,YAEzC,MAAUyF,EAAAA,KAAKuqC,KAAK12B,MAAM7T,KAAKkqC,aAC1BtB,OAAO4B,IAAUK,EAAEzqC,EAAGyqC,EAAExqC,EAEzBL,GAAAA,KAAKkpC,eAAAA,KACFN,OAAOtgC,IAAUtI,EAAAA,KAAKqqC,KAAQrqC,EAAAA,KAAKqqC,KACxCrqC,GAAAA,KAAK4oC,OAAO4B,IAAU9xB,EAAG,EAAA,IAItBwwB,yBACOK,UAAYvpC,KAAK44C,kBAGxB,EAAA7P,YACAH,OAAO4B,IAAU9xB,EAAG,EACzB1Y,GAAAA,KAAKupC,UAAW,EAGXxH,aACAkI,UAAW,SCjClBkP,eACEn5C,QAAK4oC,OACL5oC,EAAAA,KAAKo5C,OAAS,IAAgBruB,GAGzBsuB,GAAA1P,uBACOyP,OAGP5gB,OACLx4B,QAAKo5C,OAAO5gB,OAMP7f,GAAAkwB,oBACAuQ,OAAOvQ,eAsBPyQ,mBACLC,EAAA,IAAQC,EACJn5C,EAAIo5C,EACJnS,EAAW0K,EACXoE,EAAYsD,EAAgB/R,GAAAA,cACvBhvB,EAAA,aACPvY,GAAIwG,EAAK+R,EAAGvY,GACZC,EAAIuG,EAAK+R,EAAGtY,GACZinC,EAAW1gC,EAAK+R,EAChBy9B,GAAmBrI,EAAA,QAAPnnC,EAAK+R,EAAA,UAAA,IAAEghC,EAAIvD,EAAAA,IAEnBxvC,EAAK+R,EACTtY,GAAIuG,EAAK+R,EACT2uB,GAAW1gC,EAAK+R,EAChBy9B,GAAmBrI,EAAA,QAAPnnC,EAAK+R,EAAA,UAAA,IAAE4gC,EAAInD,EAGzBp2C,GAAAA,KAAKo5C,OAAOrlC,IAAI,IAAW/T,GAAAA,KAAK4oC,OAAWvoC,EAAGinC,EAAU8O,EAAAA,IACjDp2C,KAoBF4tB,OAAgCgsB,EAAkBC,EACvD9pD,GAAA,IAAQypD,EACJn5C,EAAIo5C,EACJ5U,EAAQmN,EAWZ,SAVI8H,aACF15C,GAAI05C,EAAO15C,EACXC,EAAIy5C,EAAOz5C,EACXwkC,EAAQ+U,EAAAA,IAEJE,EACJz5C,EAAIu5C,EACJ/U,EAAQgV,EAEV75C,GAAAA,KAAKo5C,OAAOrlC,IAAI,IAAW/T,GAAAA,KAAK4oC,OAAWvoC,EAAGwkC,EAAAA,IACvC7kC,KAYF+5C,OAAyCC,EAAwBH,EACtE9pD,GAAA,IAAcypD,EACVS,EAAUR,EACV5U,EAAQmN,EAWZ,SAVIkI,aACFC,GAAUD,EAAgB95C,EAC1B65C,EAAUC,EAAgB75C,EAC1BwkC,EAAQmV,EAAAA,IAEEE,EACVD,EAAUD,EACVnV,EAAQgV,EAEV75C,GAAAA,KAAKo5C,OAAOrlC,IAAI,IAAW/T,GAAAA,KAAK4oC,OAAiBqR,EAASpV,EAAAA,IACnD7kC,KAWFo6C,SAA+BvV,EAAeyG,EAEnDv7C,eADKqpD,OAAOrlC,IAAI,IAAa/T,GAAAA,KAAK4oC,OAAsB/D,EAAOyG,EAAAA,IACxDtrC,KAWFq6C,SAAqCxV,EAAeyG,EAEzDv7C,eADKqpD,OAAOrlC,IAAI,IAAa/T,GAAAA,KAAK4oC,OAA4B/D,EAAOyG,EAAAA,IAC9DtrC,KAuBFs6C,QACLC,EACAC,EACAC,EAEA3wC,GAAA,IAAY2vC,EACRiB,EAAQ1I,EACR0C,EAAS3G,EACT4G,EAASgG,EAkBb,SAhBIC,aAAmCL,GAAAA,aAAwBluC,IACrDuuC,EAAcx6C,EACtBs6C,EAAQE,EAAcv6C,EAEtBq0C,EAAS6F,EAAan6C,EACtBu0C,EAAS4F,EAAal6C,EAEKA,GAAA,iBAAoCsY,GAAA,iBAAjB4hC,IACtCK,EACRF,EAAQH,EAER7F,EAAS8F,EACT7F,EAAS8F,EAGXz6C,GAAAA,KAAKo5C,OAAOrlC,IAAI,IAAY/T,GAAAA,KAAK4oC,OAAe8R,EAAOhG,EAAQC,EAAAA,IACxD30C,KAoBF66C,QAA8CC,EAA4BjW,EAC/E90C,GAAA,IAAkBgrD,EACdC,EAAcvB,EAclB,SAZIwB,aAA+B5uC,IACnB4uC,EAAoB76C,EAClC46C,EAAcC,EAAoB56C,EAElCwkC,EAAQiW,EAEyB53C,GAAA,iBAA0CyV,GAAA,iBAAvBmiC,IACtCG,EACdD,EAAcF,EAGhB96C,GAAAA,KAAKo5C,OAAOrlC,IAAI,IAAY/T,GAAAA,KAAK4oC,OAAqBoS,EAAanW,EAAAA,IAC5D7kC,KAYFk7C,MAA2BlE,EAAwBC,EAAoBlnD,EAE5E,eADKqpD,OAAOrlC,IAAI,IAAU/T,GAAAA,KAAK4oC,OAAqBoO,EAAgBC,EAAAA,IAC7Dj3C,KAUFm7C,KAAsB3T,EAE3BtkC,eADKk2C,OAAOrlC,IAAI,IAAS/T,GAAAA,KAAK4oC,OAAiBpB,EAAAA,IACxCxnC,KASFoR,MAELuH,eADKygC,OAAOrlC,IAAI,IAAU/T,GAAAA,KAAK4oC,OAAQpB,IAChCxnC,KAQFo7C,kBACAhC,OAAOrlC,IAAI,IAAQ/T,GAAAA,KAAK4oC,SACtB5oC,KAQFq7C,WAEL1iC,eADKygC,OAAOrlC,IAAI,IAAeniB,GAAAA,IACxBoO,KAqBFspC,OAA6DgS,EAClEp4C,UAIAlD,GAAAA,KAAKo5C,OAAOrlC,IAAI,IAAW/T,GAAAA,KAAK4oC,OAAuB0S,EAAAA,IAEhDt7C,OAAAA,KALAu7C,cACEv7C,GAAAA,MAuBJu7C,cAEL5iC,eADKygC,OAAOrlC,IAAI,IAAkB/T,GAAAA,KAAK4oC,OAAQS,IACxCrpC,KAQFw7C,OAAqBjD,EAM1Br1C,mBAJElD,EAAAA,KAAKo5C,OAAOrlC,IAAI,IAAW/T,GAAAA,KAAK4oC,OAAQ7d,IAExC/qB,KAAKo5C,OAAOrlC,IAAI,IAAW/T,GAAAA,KAAK4oC,OAAe2P,EAAAA,IAE1Cv4C,KASFy7C,KAAmB5W,EAMxB3hC,mBAJElD,EAAAA,KAAKo5C,OAAOrlC,IAAI,IAAS/T,GAAAA,KAAK4oC,OAAQ7d,IAEtC/qB,KAAKo5C,OAAOrlC,IAAI,IAAS/T,GAAAA,KAAK4oC,OAAe/D,EAAAA,IAExC7kC,KAOF07C,mBACQ,IAAIh3C,SAAeC,SACzBy0C,OAAOrlC,IACV,IAAegiC,IAAA,KACbpxC,aZ/YRkuC,GALUF,KAAagJ,GAAA,KAKvBC,iBAAA,mBAMA/I,GAAAgJ,QAAA,UAMAhJ,GAAAiJ,OAAA,SASAjJ,GAAA52B,MAAA,iBCfA42B,GAAAA,EAAAkJ,OAAA,SACAlJ,EAAAmJ,UAAA,aAFUC,KAA2BC,GAAA,cAYrCrJ,GAAAA,EAAAA,EAAAsJ,gBAAA,GAAA,mBADUrJ,KAAkBsJ,GAAA,cAQ5BvJ,GAAAA,EAAAA,EAAAwJ,MAAA,GAAA,SADUtJ,KAAUuJ,GAAA,WAgBbC,GAAAC,4BACUrP,GAAAA,IAEVqP,mBACLC,GAAQtP,GAAAA,IAqCHx0B,4BACG+jC,GAAAA,4BAA0DX,GAAAA,oCAQ1DW,GAAAA,4BAA0DV,GAAAA,UAY7DW,kDACUC,GAAAA,8BAGVD,yCACLF,GAAQG,GAAAA,8BApEIjkC,GAAAw0B,GAAAA,IAAM,IAAWK,EAAG,EAWpB,GAAAqP,GAAAA,SAAU,EAQVC,GAAAA,mBAA4DX,GAAAA,gBAU5DO,GAAAA,4BAAuFX,GAAAA,OAIvFgB,GAAAA,YAIA,GAAAC,GAAAA,WAAoCX,GAAAA,MAoBpCO,GAAAA,8BAiBA,EAAAK,GAAAA,cAKA,EAAAC,GAAAA,mBAKA,EAAAC,GAAAA,mBAKA,EAAAC,GAAAA,KAMA,EAAAC,GAAAA,eAKA,GAAAC,GAAAA,WAAY,EAKZC,GAAAA,yBAA0B,EAK1BC,GAAAA,eAEA,GAAAC,GAAAA,aAAe,IAEfC,GAAAA,cAAgBjB,EAAQgB,GAAAA,aAExBE,GAAAA,UAMA,GAAAC,GAAAA,oBAAqB,EAOrBC,GAAAA,gCAAiC,4TAlE/CC,CAJC9rC,CACC5J,EAAAA,CAAAA,QAAS,kFACT6J,gBAAiB,kFY9CnB8rC,eAA0BC,EAAkBC,EAC1Cj+C,QAAKk+C,MACLl+C,EAAAA,KAAKm+C,UACLn+C,EAAAA,KAAKo+C,MAMPC,EAAAvmD,uBACcomD,MAMdF,2BACcG,UAMdF,uBACcG,MAOPE,WACL3lC,UAAwC,IAAhC3Y,KAAKg+C,SAAiBC,EAAAA,OAAgD,IAA1BD,EAAAA,SAAWh+C,KAAKi+C,MAQ/DrnC,gBACE,IAAmBmnC,GAAA,KAAO/9C,KAAKlI,KAAO,KAAMkI,KAAKg+C,UAAWh+C,KAAKi+C,qBAUxEtlC,GAAA,MAAqB4lC,EAAgBt9C,EAAAA,KAAWxJ,GAAEK,EAAAA,OAAMiF,KAAK,KACpCwhD,EAAgBC,EAAAA,QAAQ1Y,CAASttC,EAAAA,IAAQwlD,EAAAA,SAAoBS,GAGtF,UAAO,IAAmBC,GAAcC,EAFlBA,GASjBC,uBACLjmC,UAAsBqC,GAAAA,QAAyBpE,GAAAA,UA5EnCioC,GAAAA,IAAM,IAAmBd,GAAA,2BAA4B,GAAI,SCvBzEe,sBACSC,UAA2B,GAAA/+C,KAC3Bg/C,cAAqC,GAM5CC,SACEj/C,QAAK++C,UAAU/rD,KAOjB2lB,GAAAumC,UACEl/C,QAAKg/C,cAAchsD,KAOrB2lB,GAAAwmC,WACExmC,GAAA,MAAU3Y,EAAAA,KAAK++C,UAAUttD,QAAQ2tD,IACtB,IACTp/C,GAAAA,KAAK++C,UAAUh0C,OAAUs0C,EAQ7B,GAAAC,YACE3mC,GAAA,MAAU3Y,EAAAA,KAAKg/C,cAAcvtD,QAAQ2G,IAC1B,IACT4H,GAAAA,KAAKg/C,cAAcj0C,OAAUs0C,EAQjC,GAAAE,UACEv/C,QAAK++C,UAAUjuC,SAAehQ,GAAE0+C,EAAAA,OAAOp3C,UAClC42C,cAAcluC,SAAc2uC,GAAGr3C,EAAAA,KAMtCkI,aACOyuC,UAAUztD,OACf0O,EAAAA,KAAKg/C,cAAc1tD,OCxEhB,SAELouD,eAA+CC,EAA5BN,QAAAO,UAA4BC,EAAA7/C,KAAA2/C,UADxCN,EAAAr/C,KAAa5B,GAAA,KAElB4B,KAAU8/C,GAAKC,GAAAA,kBAA4B3hD,EAAIuhD,GAAUvhD,EAAAA,sBAGbuhD,WAC5C5E,EAAA,MAA8BtB,EAAA,QAAhBmG,EAAAA,MAAAA,OAAAA,EAAWnT,EAAAA,aAAAA,IAAKmS,OAAA,EAAEhqD,EAAAA,IAAIorD,IACNhO,EAAA,QAAhB2N,EAAAA,MAAAA,OAAAA,EAAWlT,EAAAA,aAAAA,IAAKsO,OAAA,EAAEnmD,EAAAA,IAAIorD,aAI/BC,IAAUC,IAKJC,EAAAA,MAAM7B,WAAiB6B,EAAAA,QAKxBC,EAAAA,gBAAgCnkC,GAAAA,OAAemkC,EAAAA,gBAAgCnkC,GAAAA,OAK/EmkC,EAAAA,gBAAgCxE,GAAAA,kBAA0BwE,EAAAA,gBAAgCxE,GAAAA,mBAKzFyE,EAAAA,SAAiBA,EAAAA,QAU9B/B,iBACE,MAAkBt+C,EAAAA,KAAK4/C,UACL5/C,EAAAA,KAAK2/C,iBACXrB,GAAAA,WAAsBqB,EAM7BW,GAAAC,sBACOX,UAAUW,QAAQvgD,KAAK2/C,WAQ9Ba,YACL7nC,UAAO8nC,IAAazgD,KAAK4/C,WAAaa,IAAazgD,KAAK2/C,mCAMLe,EACnDx9C,UAAQ9R,EAAAA,MAAYA,EAAAA,MACX,IAAQA,EAAAA,SAAaA,EAAAA,QAErB,IAAQA,EAAAA,SAAaA,EAAAA,eC3EhCuvD,eAAuCrjD,EAApBsjD,QAAArjD,IAAoBsjD,EAAA7gD,KAAA1C,IAChCsjD,EAAAE,SACLnoC,eAAYrb,IAAiBC,EAAAA,KAAkBD,EAAAA,IAAM0C,KAAKzC,IAGrDwjD,WACLpoC,eAASmoC,SACH9gD,GAAAA,KAAK1C,IAAiBA,EAAAA,IACNA,EAAAA,IAAM0C,KAAKzC,IAEtByC,KAAK1C,IAAiBC,EAAAA,ICF9B,SAMLyjD,eAAmBC,QAAA/xC,OACjBlP,EAAAA,KAAKkP,OAAmB+xC,GAAA,KACxBjhD,KAAK1F,KAAO,KACZ0F,KAAKkhD,OAAS,IACdlhD,GAAAA,KAAKvN,KAAO,KACZuN,KAAKtN,MAAQ,KACbsN,KAAKyH,OAGA,EAAA05C,qBACQ1uD,OAASuN,KAAKtN,aAoB7BiP,eAA8Cy/C,EAAA,IAAiB30C,IAAAA,OAAOC,WAAYD,OAAOC,UAAWD,OAAOC,UAAWD,OAAOC,iBAA1G20C,YACjBrhD,EAAAA,KAAKpQ,KAAO,KACZoQ,KAAKshD,MAAQ,GAMPC,QAEN5oC,GAAkB,GAAA,OAAd3Y,KAAKpQ,KAGP,OAAAoQ,KAFKpQ,KAAO4xD,OAAAA,KACP5xD,KAAKsf,OAAS,MAKrB,MAAiBsyC,EAAKN,EAAAA,OACtB,IAAkBlhD,EAAAA,KAAKpQ,WACHuxD,EAAAA,UAClB,CAAA,MAAaM,EAAYhvD,EAAAA,KACXgvD,EAAY/uD,EAAAA,MAEb+uD,EAAYP,EAAAA,OAAOjnC,eACXwnC,EAAYP,EAAAA,OAAOlmC,QACNf,GAAAA,eAGrB8zB,EAAI2T,EAGXC,EAAkBhH,EAAK+G,GAAeE,EAG5CnI,GAAA,IAAeoI,EACf,EAAA,MAAqBC,EAAS9mC,EAAAA,QAAakmC,EAAAA,QAC3C,IACIa,EACAtvD,EAAK0uD,EAAAA,SACIa,EAAa/nC,EAAAA,eAExB8nC,GAAUtvD,EAAKyuD,EAAAA,OAAOjnC,eACZ+nC,EAAa/nC,EAAAA,eACZgoC,EAAUF,EAAUJ,EAGjChH,GAAA,IAAgBpY,EAChB,EAAA,MAAsBuf,EAAS9mC,EAAAA,QAAckmC,EAAAA,QACzCxuD,GAAMyuD,EAAAA,SACIe,EAAcjoC,EAAAA,eAE1B8nC,GAAUrvD,EAAMwuD,EAAAA,OAAOjnC,eACbioC,EAAcjoC,EAAAA,eACZgoC,EAAUF,EAAUJ,EAI9BQ,GAAOC,EAAYD,GAAOE,EAC5B9f,EAAA,MAIE6f,EAAWC,EACC5vD,EAEAC,EAKlB4vD,EAAA,MAAkBb,EAAYvyC,EAAAA,OACZuqC,EAAA,IAAa8I,GAC/BC,GAAUtB,EAAAA,OAAkBlmC,EAAAA,QAAoBkmC,EAAAA,QACtCz5C,EAAAA,OAAqBA,EAAAA,OAEb,EAAA,OAEZ86C,GAAU9vD,EAAAA,OACZ8vD,EAAU9vD,EAAAA,KAEV8vD,EAAU7vD,EAAAA,MAGZ8vD,EAAU/vD,EAAAA,KACV+vD,EAAU9vD,EAAAA,MAEV+uD,EAAYvyC,EAAAA,OACZsyC,EAAKtyC,EAAAA,OAASszC,IAGJ/vD,EAAAA,KACV+vD,EAAU9vD,EAAAA,MAEV+uD,EAAYvyC,EAAAA,OACZsyC,EAAKtyC,EAAAA,OACLlP,EAAAA,KAAKpQ,KAIP6pD,GAAA,IAAkB+H,EAAKtyC,EAAAA,YACH8iC,GAGlB,CAFAyQ,GAAcziD,EAAAA,KAAK0iD,SAASD,IAEXhwD,EAAAA,KACf,MAAM,IAAIiT,MAAM,uDAElBssC,GAAA,IAAiBt/C,EAAAA,MACf,MAAM,IAAIgT,MAAM,wDAGlB+8C,GAAYh7C,EAAAA,OAAa1V,EAAAA,KAAKuL,IAAgB7K,EAAAA,KAAKgV,OAAoB/U,EAAAA,MAAM+U,QACjEy5C,EAAAA,OAAqBzuD,EAAAA,KAAKyuD,OAAOlmC,QAAoBtoB,EAAAA,MAAMwuD,QAEzDuB,EAAYvzC,EAAAA,QAOtByzC,QACNhqC,GAAI6oC,GAAAA,IAASxhD,KAAKpQ,KAEhB,YAAAoQ,KADKpQ,KAAO,MAId,MAAe4xD,EAAKtyC,EAAAA,OACAA,EAAOA,EAAAA,OAC3B,IAOAozC,EALEM,GADE1zC,EAAOzc,EAAAA,OACCyc,EAAOxc,EAAAA,MAEAD,EAAAA,KAIbowD,EAAYpwD,CAAAA,EAAAA,OACdowD,EAAYpwD,EAAAA,KAEZowD,EAAYnwD,EAAAA,MAEdkwD,EAAQ1zC,EAAAA,OAER4zC,EAAA,IAAkBD,EAClBC,OACEL,GAAcziD,EAAAA,KAAK0iD,SACnBD,GAAYvB,EAAAA,OAAqBzuD,EAAAA,KAAKyuD,OAAOlmC,QAAoBtoB,EAAAA,MAAMwuD,QAC3Dz5C,EAAAA,OAAa1V,EAAAA,KAAKuL,IAAgB7K,EAAAA,KAAKgV,OAAoB/U,EAAAA,MAAM+U,QAE/Dg7C,EAAYvzC,EAAAA,YAAAA,KAGvBtf,KACLgzD,EAAQ1zC,EAAAA,OAAS,KAOd6zC,cACLpqC,GAAA,MAAaqqC,EAAA,IACbC,GAAK3oD,EAAAA,KACL2oD,EAAK/B,EAAAA,OAAkBA,EAAAA,OAClBA,EAAAA,OAAOzuD,MACZwwD,EAAK/B,EAAAA,OAAOnoC,KACZkqC,EAAK/B,EAAAA,OAAOxuD,OACZuwD,EAAK/B,EAAAA,OAAOloC,QACZhZ,EAAAA,KAAKshD,MAAeljD,EAAGhN,GAAAA,OACvB4O,EAAAA,KAAKuhD,QAMAyB,GAAAE,sBACLF,EAAA,MAAahjD,EAAAA,KAAKshD,MAAeljD,EAAGhN,GAAAA,OACpC,IACE0xD,EAAA,OAAA,EAEF,MAAUrC,EAASS,EAAAA,OAGnB,IACSrvC,KADCwvC,YAAY5xC,SAKpB6yC,GAAA,OAJOzwC,EAAAA,cAAc5K,KACnB,oBAA+B7I,EAAGhN,GAAAA,MAAQ,0EAE5C4O,KAAKmjD,gBAAgB1C,IACd,EAGLwC,GAAK/B,EAAAA,OAAOzxC,SACd6yC,GAAA,OAAA,EAGFtiD,GAQ6BA,KARxB2iD,QACLnrD,GAAE/E,EAAAA,MAAgBwqD,GAAAA,cAChBlkC,EAAAA,KAAekkC,GAAAA,cACfvqD,EAAAA,OAAiBuqD,GAAAA,cACjBjkC,EAAAA,QAAkBikC,GAAAA,cAGPxQ,EAAAA,MACX,CAAA,MAA2B2W,EAAA,QAAd3C,EAAShU,EAAAA,aAAAA,IAAKuW,OAAA,EAAEpuD,EAAAA,IAAIorD,IAC7B93C,GACFk7C,EAAA,CAAA,MAA8BC,EAAbn7C,GAAKsiC,EAAAA,IAAcpqC,EAAA,IAAgBw8C,GAAAA,8BACtB0G,EAAbp7C,GAAKsiC,EAAAA,IAAcnqC,EAAA,IAAgBu8C,GAAAA,8BAEvCyG,EACX7rD,EAAE/E,EAAAA,MAEF+E,EAAE9E,EAAAA,OAGA6wD,EAASD,EACX9rD,EAAEuhB,EAAAA,KAEFvhB,EAAEwhB,EAAAA,QAORsqC,UAFKpC,EAAAA,OACLlhD,EAAAA,KAAKuhD,QAAQ0B,IACN,EAMFE,gBACLxqC,GAAA,MAAa3Y,EAAAA,KAAKshD,MAAeljD,EAAGhN,GAAAA,OAC/B6xD,IAGLjjD,KAAK2iD,QACL3iD,GAAAA,KAAKshD,MAAeljD,EAAGhN,GAAAA,OAAS,YAAA4O,KACpBshD,MAAeljD,EAAGhN,GAAAA,QAMxBsxD,SACN/pC,GAAa,GAAA,OACXA,EAAA,MAAM,IAAIjT,MAAM,+BAGdu9C,GAAK9B,EAAAA,UAAiB15C,EAAAA,OACxB,EAAA,OAGFkR,EAAA,MAAasqC,EAAKxwD,EAAAA,KACJwwD,EAAKvwD,EAAAA,MAETuwD,EACJzrD,EAAI/E,EACJgF,EAAI/E,EACJsQ,EAAIvQ,EAAKA,EAAAA,KACLA,EAAKC,EAAAA,MACLA,EAAMD,EAAAA,KACNC,EAAMA,EAAAA,MAEA+E,EAAEgQ,EAAAA,OAAWA,EAAAA,OAEzB+7C,GAAUnhB,EAyCZ,EAAA,OAvCE5vC,EAAAA,KACFgF,EAAEyX,EAAAA,OAAWA,EAAAA,OACXA,EAAAA,OAIEzX,EAAEyX,EAAAA,OACEA,EAAAA,OAAOzc,OACXgF,EAAEyX,EAAAA,OAAOzc,KAETgF,EAAEyX,EAAAA,OAAOxc,MAGXsN,EAAAA,KAAKpQ,KAIHuE,EAAEsT,EAAAA,OAAWA,EAAAA,QACb/U,EAAAA,MACF6E,EAAE7E,EAAAA,MACF8F,EAAE0W,EAAAA,OAEF3X,EAAE2pD,EAAAA,OAAWA,EAAAA,OAAOlmC,QAAUkmC,EAAAA,QAC5BA,EAAAA,OAAWA,EAAAA,OAAOlmC,QAAUkmC,EAAAA,QAE5Bz5C,EAAAA,OAAa1V,EAAAA,KAAKuL,IAAMmK,EAAAA,OAAUA,EAAAA,QAClCA,EAAAA,OAAa1V,EAAAA,KAAKuL,IAAMmK,EAAAA,OAAUA,EAAAA,UAElC/U,EAAAA,MACF6E,EAAE7E,EAAAA,MACFyB,EAAE+a,EAAAA,OAEF3X,EAAE2pD,EAAAA,OAAWA,EAAAA,OAAOlmC,QAAUkmC,EAAAA,QAC5BA,EAAAA,OAAWA,EAAAA,OAAOlmC,QAAUkmC,EAAAA,QAE5Bz5C,EAAAA,OAAa1V,EAAAA,KAAKuL,IAAMmK,EAAAA,OAAUA,EAAAA,QAClCA,EAAAA,OAAa1V,EAAAA,KAAKuL,IAAMmK,EAAAA,OAAUA,EAAAA,SAMxCuqC,EAAIwR,GAAWnhB,GAAG,EAOhB,CALA7qC,GAAE/E,EAAAA,KACF+E,EAAE0X,EAAAA,OAAWA,EAAAA,OACXA,EAAAA,OAGE1X,EAAE0X,EAAAA,OACA1X,GAAE0X,EAAAA,OAAOzc,OACX+E,EAAE0X,EAAAA,OAAOzc,KAAO+E,MAEhB,CAAIA,GAAE0X,EAAAA,OAAOxc,QACX4vD,EAAA,KAAM,8BAENpzC,EAAAA,OAAOxc,MAAQ8E,YAGd5H,KAyBP6pD,SArBMhyC,EAAAA,OAAWA,EAAAA,QACb/U,EAAAA,MACF6E,EAAE9E,EAAAA,KACFyQ,EAAEgM,EAAAA,OAEF3X,EAAE2pD,EAAAA,OAAWA,EAAAA,OAAOlmC,QAAUkmC,EAAAA,QAC5BA,EAAAA,OAAWA,EAAAA,OAAOlmC,QAAUkmC,EAAAA,QAE5Bz5C,EAAAA,OAAa1V,EAAAA,KAAKuL,IAAMmK,EAAAA,OAAUA,EAAAA,QAClCA,EAAAA,OAAa1V,EAAAA,KAAKuL,IAAMmK,EAAAA,OAAUA,EAAAA,UAElC/U,EAAAA,MACF6E,EAAE9E,EAAAA,KACFuQ,EAAEkM,EAAAA,OAEF3X,EAAE2pD,EAAAA,OAAWA,EAAAA,OAAOlmC,QAAUkmC,EAAAA,QAC5BA,EAAAA,OAAWA,EAAAA,OAAOlmC,QAAUkmC,EAAAA,QAE5Bz5C,EAAAA,OAAa1V,EAAAA,KAAKuL,IAAMmK,EAAAA,OAAUA,EAAAA,QAClCA,EAAAA,OAAa1V,EAAAA,KAAKuL,IAAMmK,EAAAA,OAAUA,EAAAA,SAKxCgyC,SAMK9gC,EAAA8qC,mBACa,OAAdzjD,KAAKpQ,KAGFoQ,EAAAA,KAAKpQ,KAAK6X,OAUZi8C,MAAmB1/C,EACxBd,GAAA,MAAeu9C,EAASS,EAAAA,OACRuB,EAAAA,IACVA,GAAeA,GAAYvB,EAAAA,OAAO/lC,UAAmB2nC,GACvD,CAAA,IAAgB3B,EAAAA,UAAwB7mD,EAAAA,OAKtCqe,EAAA,OAAc8pC,EAAYhwD,EAAAA,OAAgBgwD,EAAY/vD,EAAAA,OAJlDsR,GAASnS,EAAAA,KAAe4wD,EAAYnoD,EAAAA,MACtC,OAAA,YAQD0F,EAAAA,KAAKpQ,MAWP+zD,aAAuBrmD,EAAcwV,EAAAA,EAAAA,EAC1C/iB,GAAA,MAAgB0yD,EAAAA,IACVA,GAAeA,GAAYvB,EAAAA,OAAO/mC,QAAa7c,EAAM4F,GACvD,CAAA,IAAgBi+C,EAAAA,SAOd,OAAcsB,EAAYhwD,EAAAA,OAAgBgwD,EAAY/vD,EAAAA,OANlDsR,GAASnS,EAAAA,KAAU4wD,EAAYnoD,EAAAA,MAEjC,OAAA,YASD0F,EAAAA,KAAKpQ,MAGPg0D,WACL,MAAgBnB,EACVA,GACMA,EAAAA,CAAa9mD,GAAAA,OAAc8mD,EAAYhwD,EAAAA,MAAcgwD,EAAY/vD,EAAAA,QAElE,UAGGsN,EAAAA,KAAKpQ,MAGdmX,MAEL4R,GAAA,MAAgB8pC,EAAAA,IACVA,IACctB,EAAAA,SACFD,EAAAA,OAAOplC,KAAS1G,EAAMiD,GAAAA,OAEtB6oC,EAAAA,OAAOplC,KAAS1G,EAAMiC,GAAAA,OAGpB5kB,EAAAA,MACPgwD,EAAYhwD,EAAAA,MAELC,EAAAA,OACP+vD,EAAY/vD,EAAAA,SAKlBsN,EAAAA,KAAKpQ,aCjedi0D,eAAyBppC,EACvBza,QAAKsI,IACLtI,EAAAA,KAAKya,IAAUlgB,EAAAA,YAQV4gB,UACLxC,GAAA,MAAkBuU,EAAK42B,EAAAA,MAAM7vC,IAAIjU,KAAKsI,KAGE,GAAA,IAApCtI,KAAKya,IAAIpG,MAAW0vC,EAAAA,aAAmD,IAApB1vC,EAAAA,MAAMrU,KAAKya,KAChE,OAIF,EAAA,MAAgBza,EAAAA,KAAKya,IAAIpG,MAAW0vC,EAAAA,YACpB,GAAA,IACdC,EAAA,OAGF,EAAA,MAAUC,EAAU5vC,EAAAA,MAAW0vC,EAAAA,YAE/BC,EAAIrrC,GAAK2pC,GACP,EAAA,CAAA,MAAU2B,EAAU5vC,EAAAA,MAAMrU,KAAKya,KAAiByS,EAAKg3B,EAAAA,YACjDC,GAAK1K,GAAK0K,GAAK1K,GACjB,EAAA,OAGJ6I,SAGK,EAAA8B,eACLzrC,GAAA,MAAa3Y,EAAAA,KAAKmb,UAClBxC,UAAW0rC,EACF,EAAA,KAEFrkD,KAAKskD,SAMPD,GAAAC,SACL3rC,eAAYrQ,IAAIyL,IAAI/T,KAAKya,IAAI5G,MAAM2zB,WC1CvC+c,sBACUC,sBAAwB,IACxB7iD,GAAA3B,KAAAykD,YAAc,IAAIC,IAElB1kD,KAAA2kD,oBAA8B,GAAA3kD,KAC9B4kD,WAAyB,GAE1BC,2BACOD,WAMPE,MACLnsC,GAAK3kB,GAIL2kB,EAAI3kB,GAAAA,aAAqC+wD,GACvC,CAAA,MAAkB/wD,EAAO6wD,EAAAA,mBACpB,MAAMptD,KACTA,EAAEg1C,EAAAA,MAAeA,EAAAA,MACjBzsC,KAAK4kD,WAAW5xD,KAChBgN,GAAAA,KAAKwkD,sBAAsBzB,cAActrD,QAAAA,KAGtCmtD,WAAW5xD,KAChBgN,GAAAA,KAAKwkD,sBAAsBzB,cAAc/uD,QAZlC6d,EAAAA,cAAc5K,KAAK,8BAmBvB+9C,QACLrsC,GAAK3kB,GAKL2kB,EAAI3kB,GAAAA,aAAqC+wD,GACvC,CAAA,MAAkB/wD,EAAO6wD,EAAAA,mBACpB,MAAMptD,KACT4sD,EAAA,CAAA,MAAcrkD,EAAAA,KAAK4kD,WAAWnzD,QAAQgG,IACvB,IACbuI,GAAAA,KAAK4kD,WAAW75C,OAAck6C,EAEhCjlD,GAAAA,KAAKwkD,sBAAsBrB,gBAAgB1rD,QAG7C,CAAA,MAAcuI,EAAAA,KAAK4kD,WAAWnzD,QAAQuC,IACvB,IACbgM,GAAAA,KAAK4kD,WAAW75C,OAAcs5C,EAEhCrkD,GAAAA,KAAKwkD,sBAAsBrB,gBAAgBnvD,QAlBpC6d,EAAAA,cAAc5K,KAAK,kCAsBtBi+C,6BAAkDvF,EAGxDz8C,GACoB,GAAA,OAAP9E,EAAAA,IACM,OAAPA,EAAAA,IACAA,EAAAA,KAAiBA,EAAAA,IACN,OAAVquC,EAAAA,OACU,OAAVA,EAAAA,OACAA,EAAAA,QAAoBA,EAAAA,MAC/B,OAAA,EAIF,MAAaqT,EAAKC,GAAAA,kBAA4B3hD,EAAIuhD,GAAUvhD,EAAAA,gBACnDqmD,YAAY7wD,IAAIuxD,KAKXx1B,EAAAA,YAAYpW,sBAAiCoW,EAAAA,YAAYpW,qBAI3D+kC,GAAAA,WAAsBqB,EAAAA,GAM7ByF,WAAgC97B,EAAeU,EACpDj6B,GAAA,MAAgBu5B,EAAQpmB,EAAA,IAGGmiD,EAAQ7lB,EAAAA,QAAQvkB,UACzCqqC,EAAA,MAAwBC,EAAA,QAAXtqC,EAAMwxB,EAAAA,aAAAA,IAAK+Y,OAAA,EAAE5wD,EAAAA,IAAIorD,WACZ,QAAX/kC,EAAMwxB,EAAAA,aAAAA,IAAK6Y,OAAA,EAAEjF,EAAAA,SAAeD,EAAAA,gBAAgCxE,GAAAA,oBAQrE,IAJA57C,OAAK2kD,oBAAsB,GAAA3kD,KACtBykD,YAAYn0C,YAIZ,IAAQm1C,EAAGhwC,EAAIiwC,EAAmBp0D,EAAAA,OAAYmkB,EAAGjjB,EAAAA,IACzCkzD,EAAmBlzD,EAE9BwN,GAAAA,KAAKwkD,sBAAsBd,MAAiBzoC,GAAAA,IACtCjb,GACWA,KADNklD,6BAAuCjqC,EAAQ0qC,GACtD,CAAA,MAAaC,EAAA,IAASnF,GAAUxlC,EAChCjb,QAAKykD,YAAY1wC,IAAS3V,EAAAA,IAC1B4B,KAAK2kD,oBAAoB3xD,KAG3B4yD,eAGA57B,GAAAA,IACI67B,EAAAA,QAAQC,MAAQ9lD,KAAK2kD,oBAAoBrzD,QAKrCssD,GAAAA,mBACV,IAAK,MAAM6C,KACThH,EAAA,CAAA,MAAagH,EAAShU,EAAAA,MAAM73C,IAAIorD,IAE5B93C,GAAKk4C,EAAAA,gBAAgCtE,GAAAA,OACvC,SAIF,MACE5zC,EAAKsiC,EAAAA,IAAI72B,KACO2uC,EAAhBp6C,GAAKilC,EAAAA,IAAIx5B,KAAuBoyC,EAG5BC,EAAej0D,EAAAA,KAAKwL,IAAa2jD,EAAAA,OAAOz5C,OAAiBy5C,EAAAA,OAAO15C,OAClEi1C,GAAQoB,GAAAA,gCAAmDmI,EAAeC,EACxEj8B,EAAAA,CACFA,GAAM67B,EAAAA,QAAQK,aAKhB,MAAkBh+C,EAAKI,EAAAA,IAAI2L,IAASkyC,EAAAA,QAChB1F,EAASjnC,EAAAA,OACPinC,EAAS2F,EAAAA,iBAAsB5b,EAAAA,KAC9B6b,EAAcpyC,EAAAA,IAE/BmG,GAAWynC,EAAA,IAAQ5zB,GAAQ/lB,EAAKsiC,EAAAA,KAItC,IADApwB,EAAI9R,EAAAA,IAAUA,EAAAA,IAAIyL,IAAQ0G,EAAAA,IAAI5G,OAAW4oC,EAAQe,GAAAA,iBAEjD,IAA2Bnb,EAAA,IAAWvvB,EAAAA,EAAAA,EAAUA,EAAAA,GAChD9S,GAEqBib,KAFhBupC,sBAAsBb,aAAkB2C,EAA0CC,EAAzB9J,EAAQe,GAAAA,gBAAqBviC,IACrFwlC,GAAAA,IAAsBX,GAAKxB,GAAAA,WAAqBrjC,EAAQurC,GAC1D,CAAA,MAAiBvrC,EAAMd,EAAAA,QAAamsC,EAA0CC,EAAzB9J,GAAQe,GAAAA,gBACzDiJ,GACFC,EAAA,CAAA,MAAkBD,EAASxyC,EAAAA,IACvBwF,GAAU9F,EAAAA,KAAoBA,EAAAA,OACjB8F,EACfktC,EAAc1rC,EAAAA,gBAOH5O,GAAOu6C,EAAAA,QAAuBvkB,GAC/C,CAAA,MAAawkB,EAAA,IAASpG,GAAUkG,EAC3B3mD,QAAKykD,YAAY7wD,IAASwK,EAAAA,MAAAA,KACxBqmD,YAAY1wC,IAAS3V,EAAAA,IAC1B4B,KAAK2kD,oBAAoB3xD,KAAK8zD,IAIhC,MAAcC,EAAY9yC,EAAAA,IAC1B/L,GAAKI,EAAAA,IACFyL,EAAAA,IACAA,GAAAA,IACAA,GAAAA,IAAQ0G,EAAAA,IAAI5G,MAAW4oC,GAAQe,GAAAA,iBACzBhlB,EAAAA,OAAY1e,EAAAA,WAGnBkQ,GAAM67B,EAAAA,QAAQmB,mCAOZrC,oBAOPsC,YAA2Bj9B,EAChC9mB,GAAA,IAAmCgkD,EAAA,OAC9B,IAAQ5E,EAAGvyD,EAAI+1D,EAAMx0D,EAAAA,OAAQvB,IAChC,CAAA,MAAoB+1D,EAAM/1D,EAAGwwD,GAAAA,UAC7B4G,GAAWA,EAASxrD,EAAAA,OAChBquB,GAASo9B,GAAY91D,EAAAA,OACvB,EAAA,IAAK,MAAMmG,KACTuyB,EAAM67B,EAAAA,QAAQsB,SAASluD,IAAMmF,EAAI3G,GAOvC4vD,UAHIr9B,IACI67B,EAAAA,QAAQyB,YAAuBh2D,EAAAA,QAQlC41D,EAAA1uB,OACL7f,GAAA,IAAc4uC,EACd,EAAA,MAAYlC,EAAQ/zD,EAAAA,WAEf,IAAQgxD,EAAGvyD,EAAI8W,EAAK9W,EAAAA,IACnBiQ,KAAKwkD,sBAAsBtB,eAAuBnzD,EAAAA,KACpDy3D,WAMCD,EAAAxgD,MACL/G,QAAKwkD,sBAAsBz9C,MAAMgV,UC5OrC0rC,sBAEuC9hD,GAASnN,EAAA,WAAqBq2B,GAAAA,OAAAA,KAC5D8N,OAAoC,IAA8B38B,GAAAA,MAOlE0nD,SAGL/uC,gBAFqB4nC,QAAQtlC,IAVhB4T,GAAAA,ICHV,QAAM84B,WAMXF,eACEn1C,GAAAA,QALMtS,KAAA4nD,oBAAsB,IACtBrD,GAAAvkD,KAAA6nD,iBAAmB,IACnBlmD,GAAA3B,KAAA4kD,WAAyB,OAI1B,MAAMntD,KACTuI,EAAAA,KAAK8nD,YAITP,GAAAQ,sBACOnD,WAAa,GAGpBkD,YACE9nD,QAAK28B,OAAO9P,KAAc8P,EAAAA,QAC1B38B,KAAK4kD,WAAW5xD,KAChBgN,GAAAA,KAAK4nD,oBAAoB9C,MACzB9kD,GAAAA,KAAK6nD,iBAAiB9E,cAGxBpqC,GAAAqvC,eACEhoD,QAAK28B,OAAO5P,OAAgB4P,EAAAA,QACH8jB,EAAUzgD,EAAAA,KAAK4kD,YACxC5kD,KAAK4nD,oBAAoB5C,QACzBhlD,GAAAA,KAAK6nD,iBAAiB1E,gBAGxBxqC,GAAAksC,2BACcD,WAGdqD,qBAEEC,SAA2B,QAALA,EAAA,QAAfloD,EAAAA,KAAKmoD,kBAAAA,IAAUC,OAAA,EAAE9/C,EAAAA,WAAAA,IAAG4/C,EAAI77C,EAAOmG,EAAAA,KAGxCgH,mBACE6uC,SAA2B,QAALA,EAAA,QAAfroD,EAAAA,KAAKmoD,kBAAAA,IAAUG,OAAA,EAAEhgD,EAAAA,WAAAA,IAAG+/C,EAAIh8C,EAAOmG,EAAAA,KAGxC0uC,mBAEEqH,EAAA,MAAkBvoD,EAAAA,KAAK6kD,sBACGrG,EAAAA,QACvBrR,CAAKsT,EAAAA,IAAiBzlC,EAAAA,QAAiBkmC,EAAAA,SACpB,QAARqH,EAAA,QAAZC,EAAUtB,EAAA,UAAA,IAAEuB,OAAA,EAAEvH,EAAAA,cAAAA,IAAMqH,EAAIA,GAAA,IAAkB9uC,IAAAA,UAAUzZ,KAAKioD,WAM7Dt4B,wBAEE+4B,EAAA,MAAkB1oD,EAAAA,KAAK6kD,sBACGrG,EAAAA,QAAQrR,CAAKsT,EAAAA,IAAiBzlC,EAAAA,QAAiB2U,EAAAA,cAAuC,QAAb+4B,EAAA,QAAZF,EAAUtB,EAAA,UAAA,IAAEyB,OAAA,EAAEh5B,EAAAA,mBAAAA,IAAW+4B,EAAIA,EAAA,IAKtHE,IAAAC,WAEE,MAAkB7oD,EAAAA,KAAK6kD,eACvB,IAAqBiE,EAAA,OAChB,MAAMrI,KACToI,EAAOA,EAAKltD,EAAAA,OAAgBktD,EAAAA,aAKhCC,EAAA1C,iBACEztC,GAAA,MAAkB3Y,EAAAA,KAAK6kD,eACUqC,EAAA,OAC5B,MAAMzG,KACTsI,EAAe/1D,EAAAA,KAAcozD,EAAAA,iBAAiBj6C,IAGhD,IAAgB48C,EAAe7B,EAC3B8B,GAAev8C,GAAAA,OAAOC,cACrB,MAAMgN,KACTwtC,EAAA,CAAA,MAAiBxtC,EAAM9M,EAAAA,IACnB4G,GAAWw1C,EAAAA,IACDtvC,EACZsvC,EAAcx1C,EAGlBy1C,UAGF1D,EAAA2D,WACEvwC,GAAA,MAAkB3Y,EAAAA,KAAK6kD,eACvB,IAAmBqC,EACnB,MAAK,MAAMzG,KACT0I,EAAgB1I,GAASyI,EAAAA,WAE3BvwC,UAGFuuC,EAAA3G,QACE5nC,GAAA,IAAsBsC,EAAAA,CAClBA,GAAAA,aAAiB0sC,KACF1sC,EAAM4pC,EAAAA,gBAGzB,MAAsBqC,EAAA,OACjB,MAAMzvD,KACTuI,EAAAA,KAAK6nD,iBAAiBnE,MAAU0F,GAAAA,IACxBp2D,EAAAA,KAAK,IAASyE,GAAG2xD,EAAAA,KAAAA,KAK3B,IAAmC9G,EAAA,OAC9B,MAAM18C,KACTuhD,EAAWA,EAASxrD,EAAAA,OAAS4kD,EAAAA,kBAKjC+B,EAAA+G,sBACE1wC,GAAA,MAAkB3Y,EAAAA,KAAK6kD,eACDqC,EAAA,GAClBjsC,GAAAA,aAAoC8pC,GACtC,CAAA,MAAuB9pC,EAAM4pC,EAAAA,mBACxB,MAAMjF,KACTkJ,EAAA,IAAK,MAAMnJ,KACT2C,EAAA,CAAA,MAAkB1C,EAAUyJ,EAAAA,sBACxBC,GACFC,GAAMv2D,EAAAA,KAAKs2D,SAAAA,IAKZ,MAAM7I,KACTqI,EAAA,CAAA,MAAkB7tC,EAAMouC,EAAAA,sBACpBC,GACFC,GAAMv2D,EAAAA,KAKZw2D,GAAID,GAAMj4D,EAAAA,OACR,CAAA,IAAgBi4D,EAAMrC,EAAGhD,GAAAA,YACXqF,EAAMrC,EACpB,OAAK,MAAMh6B,KACTg6B,EAAA,CAAA,MAAeh6B,EAAKg3B,EAAAA,YACPuF,EAAAA,IACCn4D,EACZo4D,EAAUx8B,EAGdq4B,UAEFiE,SAAO,KAET/5C,SACEkJ,GAAA,MAAkB3Y,EAAAA,KAAK6kD,mBAClB,MAAMpE,KACTqI,EAAIrI,GAAShxC,EAAAA,SACXkJ,GAAA,OAAA,WAKNwB,QAAkB7c,EAChB4F,GAAA,MAAkBlD,EAAAA,KAAK6kD,eACEvC,EAAA,OACpB,MAAM7B,KACTyG,EAAA,CAAA,MAAYzG,EAAStmC,EAAAA,QAAa7c,EAC9BuV,GACFqG,GAAOlmB,EAAAA,KAGXi2D,GAAI/vC,GAAO5nB,EAAAA,OACT,CAAA,IAAe4nB,EAAOopC,EAClBqH,GAAcC,EAASh9C,EAAAA,IAAQ6N,EAAAA,SAC9B,MAAMf,KACT4oC,EAAA,CAAA,MAAiBloC,EAAIK,EAAAA,IAAI7N,IACrB4G,GAAWm2C,EAAAA,IACFjwC,EACXiwC,EAAcn2C,EAGlB+xC,UAEFsE,SAAO,KAETC,QACEnxC,GAAA,MAAkB3Y,EAAAA,KAAK6kD,eACKqC,EAAA,OACvB,MAAMzG,KACToJ,EAAA,CAAA,MAAapJ,EAASqJ,EAAAA,QAClBC,GACFC,GAAMh3D,EAAAA,KAIVi3D,GAAID,GAAM14D,EAAAA,OACR,CAAA,MAAsB44D,EAAA,IAAeF,GAAM9C,EAAG3pD,GAAAA,IAAW2pD,EAAG5pD,GAAAA,SACvD,MAAMysD,KACTI,EAAc5sD,EAAAA,IAAMxL,KAAKwL,IAASA,EAAAA,IAAmBA,EAAAA,KACvCD,EAAAA,IAAMvL,KAAKuL,IAASA,EAAAA,IAAmBA,EAAAA,YAIzD4sD,SAAO,KAGT1xB,OACE7f,GAAImB,GACFnB,EAAA,CAAA,MAAkB3Y,EAAAA,KAAK6kD,mBAClB,MAAMpE,KACTA,EAAShU,EAAAA,MAAQzsC,KAAKysC,MACbjU,EAAAA,OAAO1e,IAKtBgC,KAAoC1F,EAAe9N,EACjDvY,GAAA,MAAkBiQ,EAAAA,KAAK6kD,mBAClB,MAAMpE,KACTA,EAAS3kC,EAAAA,KAAU1F,EAAO9N,EAIvBvY,GAAAgX,MAAoCqP,EACzClT,GAAA,MAAkBlD,EAAAA,KAAK6kD,mBAClB,MAAMpE,KACTA,EAAS15C,EAAAA,MAAUqP,EAIvBlT,GAAAwY,UAAyCtF,EACvClT,GAAA,MAAkBlD,EAAAA,KAAK6kD,mBAClB,MAAMpE,KACTA,EAAS3kC,EAAAA,KAAU1F,EAGvBlT,GAAA8R,eACS,IAAsBhV,GAAAA,KAAK4kD,WAAW3jD,KAAWxJ,GAAEud,EAAAA,kBCtP5Do1C,eAAyC/iB,EAAtBgjB,QAAAvG,MAAsBwG,EAAAtqD,KAAAqnC,IAKzCgjB,EAAAE,wBACeljB,IAAQrnC,EAAAA,KAAK8jD,MAAMzjD,IAAML,KAAKqnC,IAAQrnC,EAAAA,KAAK8jD,MAM1D1jD,GAAAoqD,4BACc1G,MAAU9jD,EAAAA,KAAKuqD,MAAQvqD,KAAK8jD,MAMnC1jD,EAAAoU,qBACO6yB,IAAIpzB,IAAIjU,KAAK8jD,OAAOtvC,SAG3BiG,kBACO4sB,IAAIpzB,IAAIjU,KAAK8jD,OAGpBnqC,wBACQmqC,WAAYzc,KAMpB0c,WACL,MAAc/jD,EAAAA,KAAK8jD,MACP9jD,EAAAA,KAAKqnC,IACAyc,EAAMtwC,EAAAA,SACvBi3C,UAAWx2C,EAAAA,IAAWJ,GAAAA,MAAUL,EAM3Bk3C,GAAAC,UACL,MAAc3qD,EAAAA,KAAK8jD,kBACFzc,IACNpzB,IAMN22C,GAAA1G,YACL,MAAclkD,EAAAA,KAAK8jD,MACP9jD,EAAAA,KAAKqnC,WACM7zB,EAAAA,SAOzBi3C,GAAAI,2BACc/G,MAAM/vC,IAAI/T,KAAKqnC,KAAKxzB,MAAM,IAMjCi3C,cACE,IAAS9qD,GAAAA,KAAKqnC,IAAKrnC,KAAK8jD,OAO1BiH,MAELpyC,eADqB0uB,IAAQrnC,EAAAA,KAAK8jD,MAAM1jD,IAAYC,EAAIL,EAAAA,KAAK8jD,MAAMzjD,IAAML,KAAKqnC,IAAQrnC,EAAAA,KAAK8jD,MAAMzjD,IAAYD,EAAIJ,EAAAA,KAAK8jD,MAAM1jD,IASvH,EAAA4qD,KAAyB15D,EAC9B4R,GAAA,IAAU+nD,EACVxwC,EAAMA,EAAIlgB,EAAAA,YAEV,MAAakgB,EAAI7N,EAAAA,IAAI5M,KAAK8jD,OACpBhW,EAAMrzB,EAAI7N,EAAAA,IAAI5M,KAAKqnC,KAEnBntB,EAAU83B,EAAA,GACZnE,GAAQyU,GACVpoC,GAAQlnB,EAAAA,KAAKgN,KAAK8jD,OAETrK,GACTv/B,GAAQlnB,EAAAA,KAAKgN,KAAKqnC,KAGTyG,EAAM2L,EACf,EAAA,CAAA,MAAiB5L,EAAQA,GAAOC,EAChC5zB,GAAQlnB,EAAAA,KAAKgN,KAAK8jD,MAAM/vC,IAAI/T,KAAKqnC,IAAIpzB,IAAIjU,KAAK8jD,OAAOjwC,MAAMq3C,YAEtC,IAAX55D,EAAAA,OACH,KAGF,IAAS4oB,GAAQ83B,EAAI93B,GAAQ83B,EAAA,IAQ/BmZ,gBAA+BC,EAAkBloD,GAAA,GACtD,MAAWwW,EAAMtZ,EACXirD,EAAK3xC,EAAMrZ,EAEXoV,EAAIzV,EAAAA,KAAKkkD,YAIT1wC,IAFKxT,KAAKqnC,IAAQrnC,EAAAA,KAAK8jD,MAENwH,GADZtrD,GAAAA,KAAKqnC,IAAQrnC,EAAAA,KAAK8jD,MACIuH,GAAKrrD,EAAAA,KAAKqnC,IAAQrnC,EAAAA,KAAK8jD,MAAU9jD,EAAAA,KAAKqnC,IAAQrnC,EAAAA,KAAK8jD,MAAWruC,GAC/FgkC,SAAgBjmC,EAAWzhB,EAAAA,KAAKwhB,IAY3By+B,GAAAuZ,kBACL5yC,GAAA,MAAgB3Y,EAAAA,KAAK8jD,MAAM7vC,IACrBtR,GAAI3C,EAAAA,KAAK+jD,kBAEA9vC,EAAAA,IAAMJ,EAAAA,MAAcjH,EAAAA,IAAIjK,KAWlC6oD,UAAsB7yC,EAAA,KAAkBzV,EAAA,MAC7C,MAAUlD,EAAAA,KAAKuqD,MACLvqD,EAAAA,KAAKwqD,UAEL,GAAA,OACR7xC,EAAA,OAAO,IAAWvY,EAAGyqC,EAAIzqC,EAAI5I,EACxB8qD,GAAU,GAAA,OACfp/C,EAAA,OAAO,IAAY7C,GAAI7I,EAAKqzC,GAAGxqC,EAE/B6C,GAAA,MAAM,IAAIwC,MAAM,sCAqBb+lD,WACL,IACIC,EAAYC,EAEhB,EAA4B,GAAjBp4D,iBAAAA,UAAU,IAA2C,iBAAjBA,UAC7Cq4D,GAAYC,EAAA,IAAWt4D,EAAAA,UAAcA,GAAAA,UAAU,IACnCA,EAAAA,UAAU,IAAM,MACvB,CAAA,KAAIA,UAAU,aAInBi6C,GAAA,KAAM,wDAHMj6C,EAAAA,UACZm4D,GAAYn4D,EAAAA,UAAU,IAKxB,EAAA,MAAYq4D,EAAUxrD,EAAIJ,EAAAA,KAAK8jD,MACzBgI,EAAMF,EAAUvrD,EAAIL,EAAAA,KAAK8jD,MAEzBiI,EAAM/rD,EAAAA,KAAKqnC,IAAQrnC,EAAAA,KAAK8jD,MACxBkI,EAAMhsD,EAAAA,KAAKqnC,IAAQrnC,EAAAA,KAAK8jD,MAExBzvC,EAAQ43C,EAAMD,EAAMF,EAAMC,EAGhCtS,UAAI1nD,KAAKwhB,IAAam4C,GAAAA,KAKlB35D,KAAKwhB,IAAIw4C,IAAQh6D,KAAKwhB,IACjBw4C,GAAMtS,EAAIz5C,EAAAA,KAAK8jD,MAAW8H,GAAUxrD,EAAKwrD,GAAUxrD,EAAKJ,GAAAA,KAAKqnC,IAAQrnC,EAAAA,KAAKqnC,IAASukB,GAAUxrD,EAAKwrD,GAAUxrD,EAAKJ,GAAAA,KAAK8jD,MAEtHkI,EAAMha,EAAIhyC,EAAAA,KAAK8jD,MAAW8H,GAAUvrD,EAAKurD,GAAUvrD,EAAKL,GAAAA,KAAKqnC,IAAQrnC,EAAAA,KAAKqnC,IAASukB,GAAUvrD,EAAKurD,GAAUvrD,EAAKL,GAAAA,KAAK8jD,MAAMzjD,aCnN7G6rD,GAAY/H,EAAWgI,EAAYtsD,EAmB7DyiD,GAAA,MAAW4J,EAAGj4C,EAAAA,IAGR1c,GAAI4sD,EAAEv3C,EAAAA,IAENpV,GAAI2sD,EAAEv3C,EAAAA,IAENnV,GAAIoI,EAAE+M,EAAAA,IAEN5J,GAAImhD,EAAEv3C,EAAAA,IAEN1J,GAAIrD,EAAE+M,EAAAA,IAGNw/C,GAAQ70D,EAAIE,EAAID,EAAIA,EAC1Bu2C,EAAA,IAAaqe,EACTC,EAASD,EAEb/pB,EAAc,GAAA,IAAK+pB,GAAS/pB,GAAA,IAC1B,CAAA,MAAyBr/B,EAAIxL,EAC7Bu2C,SAAO,IAASme,GAAIC,EAAGp4C,EAAAA,IAAMF,EAAAA,MAAMy4C,KAIrC,IAAe90D,EAAI0L,EAAIzL,EAAIuL,EAGvBupD,EAAWh1D,EAAI2L,EAAI1L,EAAIwL,EAqC3B6+C,SAlCerf,EACbgqB,GAAWhqB,EACX+pB,EAAWrpD,EACXmpD,EAAS50D,EACA+0D,GAAWC,EAAAA,IACTA,EACXF,EAAWrpD,EAAI1L,EACf60D,EAAS50D,EAGP80D,GAAW9pB,EACb8pB,GAAW9pB,EACNz/B,GAAI6+C,EACP2K,EAAWhqB,EACDx/B,GAAIzL,EACdi1D,EAAWC,EAEXD,GAAYxpD,GACZypD,EAASl1D,EAAAA,IAES80D,EAAAA,IACTA,EACNrpD,GAAIxL,EAAIu2C,EACXye,EAAWhqB,EACDx/B,GAAIxL,EAAID,EAClBi1D,EAAWC,EAEXD,GAAYxpD,GAAIxL,EAChBi1D,EAASl1D,EAAAA,IAGFxF,EAAAA,KAAKwhB,IAAgBivB,GAAA,KAAYgqB,EAAWC,EACvDF,EAAWx6D,EAAAA,KAAKwhB,IAAgBkvB,GAAA,KAAY8pB,EAAWF,EAEhD9pB,EAAA,IAAS2pB,GAAGn4C,EAAAA,IAAMF,EAAAA,MAAM24C,IAAez4C,EAAAA,IAAMF,EAAAA,MAAM04C,KAGrD,MAA6BG,GAClC,CAAAC,0BAAqDC,EAEnD1pD,GAAA,MAAsB0pD,EAAS3E,EAAAA,SACR4E,EAAc54C,EAAAA,IAAag0C,EAAAA,UAC5B6E,EAAer4C,EAAAA,SAEbu9B,EAAA,IAAQ+a,GAAS9E,EAAAA,SACnC+E,GAAiBjf,EAAA,IAAQ8e,GAAeI,EAExCC,GAAYH,EAAS5yC,EAAAA,QAAyBpG,GAAAA,IAAoB0G,EAAAA,IAAI5G,MAAM,KAC/D+4C,EAASzyC,EAAAA,QAAwBpG,GAAAA,IAAmB0G,EAAAA,IAAI5G,MAAM,KAEhEk5C,EAASI,EAAAA,eACpBC,GAAYR,EAASO,EAAAA,eAU3BtL,UAPWwL,GAASC,EAAAA,KAAKxJ,MACNwJ,EAAAA,KAAK3C,UAGH2C,EAAAA,KAAKxJ,MACNwJ,EAAAA,KAAK3C,YAK3B4C,uBAAiDC,EAE/CtqD,GAAA,MAAsBsqD,EAAKvF,EAAAA,SACUh0C,IAAYg0C,EAAAA,UAEzB3F,EAAA,IAAQmL,GAAQxF,EAAAA,SAElCiF,GAAYO,EAAQtzC,EAAAA,QAAyBpG,GAAAA,IAAoB0G,EAAAA,IAAI5G,MAAM,KAEhE45C,EAAQN,EAAAA,eAGnBjB,GAAKmB,EAASC,EAAAA,KAAKxJ,MACfuJ,EAASC,EAAAA,KAAK3C,UAGP6C,EAAKE,EAAAA,gBAMHxB,GAAI/H,EALLwJ,EAAS7J,EAAAA,MACC6G,EAAAA,YAO9BiD,yBAAmDj/B,EAGjDzrB,GAAA,MAAsByrB,EAAOs5B,EAAAA,SACN4E,EAAc54C,EAAAA,IAAYg0C,EAAAA,UAEzBxO,EAAA,IAAQgU,GAAQxF,EAAAA,SAAyB1tD,EAAAA,aAE/CkzD,EAAQtzC,EAAAA,QAAyBpG,GAAAA,IAAoB0G,EAAAA,IAAI5G,MAAM,KAEhE45C,EAAQN,EAAAA,eAGnBjB,GAAKmB,EAASC,EAAAA,KAAKxJ,MACfuJ,EAASC,EAAAA,KAAK3C,UAGxB,IAASxG,GAAE/jD,EAAKysD,GAAczsD,EAAI8rD,EAAG9rD,EAAK+jD,GAAE9jD,EAAKwsD,GAAcxsD,EAAI6rD,EAAG7rD,EAAAA,KAASD,EAAI+jD,EAAE/jD,EAAI+jD,EAAE9jD,EAAI8jD,EAAE9jD,EAG7FsY,GAAIstB,EACNttB,EAAIstB,EACKttB,EAAIstB,EAAA,IACTA,EAIN,GAAA,MAAUl0C,EAAAA,KAAKkhB,KAAKlhB,KAAKmhB,IAAO9S,EAAI+jD,EAAE/jD,EAAIuY,EAAIk0C,EAAczsD,EAAGA,EAAKrO,GAAAA,KAAKmhB,IAAO7S,EAAI8jD,EAAE9jD,EAAIsY,EAAIk0C,EAAcxsD,EAAGA,EAAA,IAAa8tB,EAAAA,OAE1G+9B,GAAG9rD,EAAI+jD,EAAE/jD,EAAIuY,EAAIk0C,EAAczsD,EAAKuuB,GAAOR,EAAAA,QAAkBA,EAAAA,OACzE0/B,GAAY3B,GAAG7rD,EAAI8jD,EAAE9jD,EAAIsY,EAAIk0C,EAAcxsD,EAAKsuB,GAAOR,EAAAA,QAAkBA,EAAAA,OAC/EkU,UAAO,IAAS8hB,GAAEtwC,EAAAA,MAASE,GAAAA,IAAS4mC,GAAA,IAAWkS,EAAczsD,EAAI0tD,EAASjB,EAAcxsD,EAAIwtD,EAAAA,KAG9FE,wBAAiDC,EAE/C9qD,GAAA,MAAsB8qD,EAAQ/F,EAAAA,SACOh0C,IAAYg0C,EAAAA,UAE5BgG,EAAQhG,EAAAA,SACMh0C,IAAYg0C,EAAAA,UAEvBxO,EAAA,IAAQwU,GAAQhG,EAAAA,SAClC+E,GAAiBhb,EAAA,IAAQgc,GAAQ/F,EAAAA,SAEjCiF,GAAYe,EAAQ9zC,EAAAA,QACpB+zC,GAAaF,EAAQ7zC,EAAAA,QAE3B63B,UAAO,IAASkb,GAAWgB,EAAAA,IAG7BC,sBAA8CX,EAE5CtqD,GAAA,MAAsByrB,EAAOs5B,EAAAA,SAGZuF,EAAKE,EAAAA,SACJC,EAAS7J,EAAAA,MACR6J,EAAShD,EAAAA,UAK5B,IAASxG,GAAE/jD,EAAKguD,GAAchuD,EAAI8rD,EAAG9rD,EAAK+jD,GAAE9jD,EAAK+tD,GAAc/tD,EAAI6rD,EAAG7rD,EAAAA,KAASD,EAAI+jD,EAAE/jD,EAAI+jD,EAAE9jD,EAAI8jD,EAAE9jD,EAG7FsY,GAAIo1B,EACNp1B,EAAIo1B,EACKp1B,EAAIo1B,EAAA,IACTA,EAIN,GAAA,MAAUh8C,EAAAA,KAAKkhB,KAAKlhB,KAAKmhB,IAAO9S,EAAI+jD,EAAE/jD,EAAIuY,EAAIy1C,EAAchuD,EAAGA,EAAKrO,GAAAA,KAAKmhB,IAAO7S,EAAI8jD,EAAE9jD,EAAIsY,EAAIy1C,EAAc/tD,EAAGA,EAAA,IAAa8tB,EAAAA,OAE1G+9B,GAAG9rD,EAAI+jD,EAAE/jD,EAAIuY,EAAIy1C,EAAchuD,EAAKuuB,GAAOR,EAAAA,QAAkBA,EAAAA,OACzE0/B,GAAY3B,GAAG7rD,EAAI8jD,EAAE9jD,EAAIsY,EAAIy1C,EAAc/tD,EAAKsuB,GAAOR,EAAAA,QAAkBA,EAAAA,OAC/EwsB,UAAO,IAASwJ,GAAEtwC,EAAAA,MAASE,GAAAA,IAAS0lC,GAAA,IAAW2U,EAAchuD,EAAI0tD,EAASM,EAAc/tD,EAAIwtD,EAAAA,KAG9FQ,oBAAyCC,EAEvCprD,GAAA,MAAkBqrD,EAAMb,EAAAA,SACLc,EAAU1K,EAAAA,MACT0K,EAAU7D,EAAAA,UAKZ2D,EAAMZ,EAAAA,gBAMLxB,GAAI/H,EALJsK,EAAU3K,EAAAA,MACC6G,EAAAA,mBCtNrB+D,WAiBXjH,eACEn1C,GAAAA,QAdKtS,KAAA6/B,OAAwBrtB,EAAAA,KAe7BxS,KAAK6/B,OAAiBA,EAAAA,QAAiBrtB,EAAAA,KACvCxS,KAAKmuB,OAAiBA,EAAAA,QAdxB,EAAA85B,qBACE0G,cAAY9uB,OAAO9rB,IAAwB,QAAL46C,EAAA,QAAf3uD,EAAAA,KAAKmoD,kBAAAA,IAAUyG,OAAA,EAAEtmD,EAAAA,WAAAA,IAAGqmD,EAAItiD,EAAOmG,EAAAA,MAmBjDwC,eACE,IAAmB65C,GACxBhvB,CAAAA,OAAQ7/B,KAAK6/B,OAAO7qB,QACpBmZ,OAAQnuB,KAAKmuB,SAOjB3U,mBACEs1C,cAAYjvB,OAAO9rB,IAAwB,QAAL+6C,EAAA,QAAf9uD,EAAAA,KAAKmoD,kBAAAA,IAAU4G,OAAA,EAAEzmD,EAAAA,WAAAA,IAAGwmD,EAAIziD,EAAOmG,EAAAA,MAMjD/C,kBAGLi7C,SAFgC,QAALA,EAAA,QAAf1qD,EAAAA,KAAKmoD,kBAAAA,IAAU6G,OAAA,EAAE1mD,EAAAA,WAAAA,IAAGoiD,EAAI1qD,EAAAA,KAAK6/B,QACpBrsB,SAASkG,IACd1Z,KAAKmuB,OAUhBhU,QAAkB7c,EAAcwV,EAAAA,EAAAA,GAErC,MAAU9S,EAAAA,KAAKwZ,OACHY,EAAIK,EAAAA,IACHL,EAAI9R,EAAAA,IAEIvW,EAAAA,KAAKkhB,KAAKlhB,KAAKmhB,IAAQtG,EAAAA,IAASqH,EAAAA,IAAIxc,IAAU1F,GAAAA,KAAKmhB,IAASe,EAAAA,IAAOT,GAAAA,WAAiBzhB,GAAAA,KAAKmhB,IAAIlT,KAAKmuB,OAAQ,IAE3H8gC,GAAejd,EAEjB,EAAA,OAAO,KAEP,CAAA,IAAUjE,EACV,EAAqB,GAAA,IAEnBiE,EAAA,OADOv3B,GAAI7N,EAAAA,IAASqH,EAAAA,IAAIxc,IACds2C,EAAKmhB,GAAM5xD,EACZ8c,EAAIkqC,EAAAA,SAENvW,GAAA,KAEP,CAAA,MAActzB,GAAI7N,EAAAA,IAASqH,EAAAA,IAAIxc,IACzB03D,EAAQ10C,GAAI7N,EAAAA,IAASqH,EAAAA,IAAIxc,IAEzB23D,EAAwBvN,EAAA,GAClBwN,GACVD,GAAYp8D,EAAAA,KAGVm8D,GAAQxU,GACVyU,GAAYp8D,EAAAA,KAGd2nD,GAAA,MAAe5oD,EAAAA,KAAKwL,OACpBskD,UAAcvkD,GACL8c,EAAIkqC,EAAAA,SAENre,GAAA,OAKNojB,sBACL1wC,GAAI22C,GAAAA,aACFT,GAAA,OAA4Bd,GAAAA,wBAAwB/tD,KAC/C2Y,GAAI22C,GAAAA,aACTC,GAAA,OAA4B3B,GAAAA,yBAAgC5tD,EAAAA,MAAM8qD,OACzDwE,GAAAA,aACTE,GAAA,OAA4BrB,GAAAA,sBAAsBnuD,KAAa8qD,GAAAA,OAE/D,MAAM,IAAIplD,MAAM,gEAObiT,GAAA4nC,QACL5nC,GAAI8nC,GAAAA,aACFoO,GAAA,OAA0BY,GAAAA,oBAAoBzvD,KACzC2Y,GAAI8nC,GAAAA,aACT8O,GAAA,OAA0BG,GAAAA,qBAAqB1vD,KAC1C2Y,GAAI8nC,GAAAA,aACT+O,GAAA,OAA0BG,GAAAA,kBAAkB3vD,KAE5C2Y,GAAA,MAAM,IAAIjT,MAAM,+DAObiT,GAAAytC,iBACLztC,eAAYa,OAAOzF,IAAcxZ,EAAAA,YAAYsZ,MAAM7T,KAAKmuB,SAOnDyhC,sBAELj3C,UADsBpe,EAAAA,YACXsZ,MAAM7T,KAAKmuB,QAMxB+yB,iBACE2O,EAAA,MAAW7vD,EAAAA,KAAKmoD,WACa2H,EAAA,QAAbC,EAAAA,MAAAA,OAAAA,EAAInc,EAAAA,iBAAAA,IAASic,EAAIxjD,EAAOmG,EAAAA,YACjC,IACLxS,GAAAA,KAAK6/B,OAAWmwB,EAAQ5vD,EAAIJ,EAAAA,KAAKmuB,OACjCnuB,KAAK6/B,OAAWmwB,EAAQ3vD,EAAIL,EAAAA,KAAKmuB,OACjCnuB,KAAK6/B,OAAWmwB,EAAQ5vD,EAAIJ,EAAAA,KAAKmuB,OACjCnuB,KAAK6/B,OAAWmwB,EAAQ3vD,EAAIL,EAAAA,KAAKmuB,QAOrCwB,yBACS,IACL3vB,GAAAA,KAAK6/B,OAAW7/B,EAAAA,KAAKmuB,OACrBnuB,KAAK6/B,OAAW7/B,EAAAA,KAAKmuB,OACrBnuB,KAAK6/B,OAAW7/B,EAAAA,KAAKmuB,OACrBnuB,KAAK6/B,OAAW7/B,EAAAA,KAAKmuB,QAOzB06B,oBAQOK,WACLvwC,UAAe3Y,EAAAA,KAAKmuB,OAASnuB,KAAKmuB,OAI7B,EAAAqK,OACLx4B,QAAKmoD,WAMAxvC,EAAAmxC,QACLnxC,GAAA,MAAgBs3C,EAAA,GACFjwD,EAAAA,KAAKwZ,OACM5M,IAIzB+L,UAHQ3lB,EAAAA,KACRk9D,GAAQl9D,EAAAA,KAAkBgN,EAAAA,KAAKmuB,QACvBn7B,EAAAA,KAAkBgN,EAAAA,KAAKmuB,QACxB,IAAep8B,GAAAA,KAAKwL,IAAI7F,MAAM3F,KAAgBA,GAAAA,KAAKuL,IAAI5F,MAAM3F,KAAMm+D,IAGrEp0C,KAAoC1F,EAAehB,EAAMiD,GAAAA,MAAqBhM,EAAOmG,EAAAA,MAC1F,MAAelK,EAAIyL,EAAAA,IAAI/T,KAAK6/B,QACxBpS,EAAAA,YACAjlB,EAAAA,UAAkBvV,EAAAA,WAClB+6B,EAAAA,IAAW5tB,EAAG+vD,EAAO9vD,EAAGL,EAAAA,KAAKmuB,OAAqB,EAAVp8B,EAAAA,KAAK+a,IAC7CghB,EAAAA,YACAM,EAAAA,OAGCrnB,MAAoCqP,EACzClT,GAAA,MAAWlD,EAAAA,KAAKmoD,WACJ4H,GAAAA,MAAAA,OAAAA,EAAInc,EAAAA,WAAYmc,MAAAA,OAAAA,EAAInc,EAAAA,UAAU7/B,IAAI/T,KAAK6/B,QAAU7/B,KAAK6/B,OAC/DuwB,EAAAA,WAAgBpwD,EAAAA,KAAKmuB,OAInBjrB,GAAAwY,UAAyCtF,EAAehB,EAAMiD,GAAAA,OACnE,MAAkBrY,EAAAA,KAAKmoD,WACXruC,EAAYA,EAAUxR,EAAAA,IAAIyL,IAAI/T,KAAK6/B,QAAU7/B,KAAK6/B,OAC7C/lB,EAAYA,EAAUmV,EAAAA,SAEvCtT,EAAI8R,EAAAA,YACA7R,EAAAA,YAAoB3oB,EAAAA,WACpB+6B,EAAAA,IAAQ5tB,EAAGkI,EAAIjI,EAAGL,EAAAA,KAAKmuB,OAAqB,EAAVp8B,EAAAA,KAAK+a,IACvCghB,EAAAA,YACAC,EAAAA,SACAN,EAAAA,YACAG,EAAAA,OAAWxtB,EAAGkI,EAAIjI,EACtBsb,GAAIkS,EAAAA,OAAO97B,KAAK4gB,IAAgB3S,GAAAA,KAAKmuB,OAAa/tB,EAAGrO,EAAAA,KAAK6gB,IAAgB5S,GAAAA,KAAKmuB,OAAa9tB,EAC5Fsb,GAAImS,EAAAA,YACAC,EAAAA,gBCxMNsiC,eAEE1Q,EACA2Q,EACA97C,EACA+7C,EACAr3C,EACAs3C,EACAxpD,EAvDM2zC,QAAA8V,WAAY,EAyDlBzwD,KAAK4/C,UACL5/C,EAAAA,KAAK2/C,UACL3/C,EAAAA,KAAKswD,IACLtwD,EAAAA,KAAKwU,OACLxU,EAAAA,KAAKuwD,QACLvwD,EAAAA,KAAKkZ,OACLlZ,EAAAA,KAAKwwD,YACLxwD,EAAAA,KAAKgH,KACLhH,EAAAA,KAAU8/C,GAAKC,GAAAA,kBAA4B3hD,EAAIuhD,GAAUvhD,EAAAA,IAMpDsyD,aACL,MAAc1wD,EAAAA,KAAK4/C,UAAUnT,MAAM73C,IAAIorD,IACzBhgD,EAAAA,KAAK2/C,UAAUlT,MAAM73C,IAAIorD,IAC1BE,GACPD,GAAM0Q,EAAAA,WAAmBA,EAAAA,WACjBA,EAAAA,UAAkBvQ,EAAAA,gBAAgCnkC,GAAAA,OAAe20C,EAAAA,aAAuBlT,GAAAA,eAC1FmT,EAAAA,aAAY,GAEVF,EAAAA,UAAkBvQ,EAAAA,gBAAgCnkC,GAAAA,OAAe20C,EAAAA,aAAuBlT,GAAAA,eAC1FmT,EAAAA,aAAY,IAMnBC,yBACOL,UAGPM,cACAN,WAAY,SCnDnBO,uCAA4DC,EAC1D/tD,GAAA,IAAsBuJ,GAAAA,OAAOC,UACD64C,EAAA,KACEgB,EAAA,KACDN,GACzBiL,EAAgC7B,EAAA,KACpC,MAAc8B,EAAMC,EAAAA,WACDD,EAAME,EAAAA,oBACpB,IAAQC,EAAGvhE,EAAIwhE,EAAMjgE,EAAAA,OAAQvB,IAChC,CAAA,MAAawhE,EAAMxhE,EACbw6B,GAAOte,EAAKuI,EAAAA,SACJy8C,EAAM7K,EAAAA,iBAAsB3xC,EAAAA,UAGnBxI,EAAKk/C,EAAAA,gBAAuB9oB,GAAA,GAC9BmvB,EAAAA,IACFC,EACjBC,EAAWzlD,EACX0lD,EAAWpnC,EACXqnC,EAAgB7hE,EAChBmhE,EAAiBW,EAIrBxvB,UACEoe,SACAqR,EAAAA,WAAuBN,EAAiBO,EACxCxnC,GAAAA,KACAte,EAAAA,KACA+lD,EAAAA,UAAsBJ,EACtBK,GAAAA,OACAv4C,EAAAA,MACAw4C,EAAAA,WAAuBjB,EAAMrB,EAAAA,sBAAgCn7C,EAAAA,UAAY,yCAIlBg5C,EACzDvqD,GAAA,MAAauqD,EAAQ5E,EAAAA,KACV4E,EAAQj0C,EAAAA,OAEAvF,IAAWg0C,EAAAA,UACHwF,EAAQrH,EAAAA,iBAAyB3xC,EAAAA,UACvDzhB,EAAAA,KAAwBihB,EAAAA,IAAWg0C,EAAAA,UAAU1tD,aAElD,IAAiBkS,EAAAA,OAAOC,UACV2iD,EAAA,KACE8C,GAChB,MAAK,IAAQtL,EAAG92D,EAAI84D,EAAKv3D,EAAAA,OAAQvB,IAC/B,CAAA,MAAc09D,EAAQ3D,EAAAA,QAAa/5D,EAAAA,IACrB4+B,EAAOm7B,EAAAA,QAAa/5D,EAAAA,IAClBqiE,EAAMrR,EAAAA,WACtBc,GAAIwQ,GAAWpsB,GACb,EAAA,OAAO,KAEOqsB,EAAAA,IACCD,EACbE,EAAU1J,EAAK94D,EACfyiE,GAAWziE,EAIjB82D,UAAesL,EACN,EAAA,KAEM53D,EAAAA,YAAYsZ,MAAMy+C,IC3G9B,MAA2BG,GAChC,CAAAhD,oBAA6CzB,EAC3C9qD,GAAA,MAAmB+qD,EAAQhG,EAAAA,SACR+F,EAAQ/F,EAAAA,SACJgG,EAAQ9/B,EAAAA,OAAiBA,EAAAA,OAC/BukC,EAAWl/C,EAAAA,SAE5B+xC,GAAI/xC,GAAWm/C,EACbpM,EAAA,MAAA,GAIF,MAAmBoM,EAAiBn/C,EAG9BgB,EAASo+C,EAAW3+C,EAAAA,IAAgB1Z,GAAAA,YAC1Bia,EAAOD,EAAAA,gBACXC,EAAOX,EAAAA,MAEb6F,GAAQu0C,EAAQ7H,EAAAA,iBAChByM,GAAQ5E,EAAQ2B,EAAAA,sBAStBuC,UAAQ,IAAqBlE,GAASD,EAAS8E,EAAKt+C,EAAQ+7C,EAAU72C,EAAAA,CAAQ2oB,IAPjDC,IAC3Bme,SACAqR,EAAAA,WACAvnC,EAAAA,KACA7Q,EAAAA,MAAOA,MAMXg2C,qBAA6CjC,WAC3ClI,EAAA,IAAcwN,EAAeC,GAAAA,4BAAoCvF,EACjEvqD,GAAA,IACEqjD,EAAA,MAAA,GAIF,MAAgBgM,EAAQ3lD,EAAAA,IAAY4M,EAAAA,OAAOvF,IAAWuF,EAAAA,SAC5Cy5C,EAAUhN,EAAIsM,EAAQ99C,EAAAA,SAEhC8xC,EAAA,MAAc53B,EAAOy3B,EAAAA,iBAEfyM,GAD0CV,GAAA,QAAzB5M,EAAA,QAAZ52B,EAAO8d,EAAAA,aAAAA,IAAKslB,OAAA,EAAEn9D,EAAAA,IAAIu+C,WAAAA,IAAmBoS,EAAIA,EAAA,IAAIpS,IACvCmB,aACX9/B,GAAS+9C,EAAQh4D,EAAAA,YAGrBkmD,EAAAA,CAAAA,SACAqR,EAAAA,YAAqBn+C,EAAAA,KACrB4W,KACA7Q,EAAAA,MACAw4C,EAAAA,WACAjmD,EAAAA,KAAcinD,EAAAA,SAAgBz+C,EAAAA,UAC9Bu9C,UAAmBmB,EAAAA,cAAqB1+C,EAAAA,kBAGlC,IAAqBka,GAAQ8+B,EAAS8E,EAAS/9C,EAAQA,EAAOD,EAAAA,gBAAiB,CAAS86C,IAASroD,GAAAA,KAG3G2oD,kBAA0CnC,EAKxCtqD,GAAA,MAAWyrB,EAAOnV,EAAAA,OAEAg0C,EAAKE,EAAAA,SACb0F,EAAU/rB,EAAAA,IAAIpzB,IAAc6vC,EAAAA,OAG5B5gD,EAAE0J,EAAAA,IAAcy6B,EAAAA,IAAIpzB,IAAIo/C,IACxBnwD,EAAE0J,EAAAA,IAAOqH,EAAAA,IAAc6vC,EAAAA,QACpB0J,EAAKE,EAAAA,SACAF,EAAK8F,EAAAA,cAGnBzzD,GAAKwvD,GACP,EAAA,CAAA,MAAW+D,EAAUtP,EAAAA,MAAM7vC,IACrBs/C,GAAMC,EAAG5mD,EAAAA,IAEf6mD,GAAIF,GAAM5kC,EAAOR,EAAAA,OAAgBA,EAAAA,OAC/B,MAAA,GAGF,MAAeqlC,EAAGj5D,EAAAA,YACCo0B,EAAOR,EAAAA,OAASp8B,KAAKkhB,KAElCjM,GACJy5C,EAAAA,CAAAA,SACAqR,EAAAA,WACAvnC,EAAAA,KACA7Q,EAAAA,MAAYoqC,EAAAA,MACZ73C,KACA+lD,EAAAA,UAGFnQ,UACE,IAAqBlzB,GAAQ6+B,EAAMh5C,EAAOX,EAAAA,MAAmBW,GAAQA,EAAOD,EAAAA,gBAAiB,CAAMuvC,EAAAA,QAAmBA,EAAAA,OAAQ98C,IAK9Hm9C,GAAK8B,GACP,EAAA,CAAA,MAAWmN,EAAU/rB,EAAAA,IAAIpzB,IACnBy/C,GAAMC,EAAG/mD,EAAAA,IACf6mD,GAAIC,GAAM/kC,EAAOR,EAAAA,OAAgBA,EAAAA,OAC/B,MAAA,GAGF,MAAewlC,EAAGp5D,EAAAA,YACCo0B,EAAOR,EAAAA,OAASp8B,KAAKkhB,KAElCjM,GACJy5C,EAAAA,CAAAA,SACAqR,EAAAA,WACAvnC,EAAAA,KACA7Q,EAAAA,MAAY2tB,EAAAA,IACZp7B,KACA+lD,EAAAA,UAGFnQ,UACE,IAAqBlzB,GAAQ6+B,EAAMh5C,EAAOX,EAAAA,MAAmBW,GAAQA,EAAOD,EAAAA,gBAAiB,CAAM8yB,EAAAA,MAAiBA,EAAAA,KAAMrgC,IAK9H,MAAY9D,EAAE0J,EAAAA,IACRgnD,GAAcR,EAAUtP,EAAAA,MAC3BjwC,MACAE,GAAAA,IAAcszB,EAAAA,IAAIxzB,MAAMhU,IACxBgU,MAAUggD,EACP7wD,GAAIqwD,EAAGp/C,EAAAA,IAEP6/C,GAAK9wD,EAAE4J,EAAAA,IACb01B,GAAIwxB,GAAKnlC,EAAOR,EAAAA,OAAgBA,EAAAA,OAC9B,MAAA,GAGF,IAAajrB,EAAEqR,EAAAA,gBAEJ3H,EAAAA,IAAOqH,EAAAA,IAAc6vC,EAAAA,QAAU,IACjC1jD,EAAKoU,GAAOpU,EACnBoU,EAAOnU,EAAKmU,GAAOnU,EAGrBmU,GAASA,EAAOja,EAAAA,YAChB,MAAmBo0B,EAAOR,EAAAA,OAASp8B,KAAKkhB,KAElC6/C,GAAMt+C,EAAOX,EAAAA,MACb7M,GACJy5C,EAAAA,CAAAA,SACAqR,EAAAA,WACAvnC,EAAAA,KACA7Q,EAAAA,MACAzN,EAAAA,KACA+lD,EAAAA,UAGFnQ,UACE,IACElzB,GACA6+B,EACAsF,EACAt+C,EAAOC,EAAAA,SACAA,EAAAA,SAASF,gBAChB,CACA8tB,IAAapuB,EAAAA,IAASg0C,EAAAA,WACtBjhD,KAKN+sD,gBAAe,IAAA,GAKfC,mBAA6CxG,SAC3CyG,EAAA,MAAWxG,EAAQj0C,EAAAA,OACRg0C,EAAKh0C,EAAAA,OACDvF,IAAQ1Z,GAAAA,YAGN0rD,EAAA,IAAoBsJ,GACnCr2C,CAAAA,OAASs0C,CAAK1J,EAAAA,MAAYzc,EAAAA,IAAUA,EAAAA,IAAItzB,IAAQF,EAAAA,MAAM,MAAYiwC,EAAAA,MAAM/vC,IAAQF,EAAAA,MAAM,OACtFgsB,OAAaA,EAAAA,SAEN4M,EAAAA,MAAaA,EAAAA,OACD,QAAV+gB,EAAK/gB,EAAAA,aAAAA,IAAKwnB,OAAA,EAAEr/D,EAAAA,IAAIu+C,MAEhB3a,EAAAA,OAAYiU,EAAAA,MAAM73C,IAAIu+C,KAGjC,MAAgBnzC,EAAAA,KAAKk0D,sBAA+BC,EAOpDlO,UANY30D,EAAAA,SAEF+9D,EAAG1P,GAAAA,UACVz0B,EAAQmkC,EAAGjxD,GAAa0hD,GAAKC,GAAAA,kBAA0B3hD,EAAIovD,GAAKpvD,EAAAA,KAMrEixD,GAAA6E,sBAA8CjD,eAI5ChL,EAAA,MAAoB8M,EAAeqB,GAAAA,6BAAoCnD,EAEvE/tD,GAAImxD,GAAYvC,EAAAA,WACd,EAAA,MAAA,GAGF,MAAoBiB,EAAeqB,GAAAA,6BAAoCjD,EAEvEx4C,GAAI27C,GAAYxC,EAAAA,WACd,EAAA,MAAA,GAIF,MAAmBuC,EAAYvC,EAAAA,WAAyBA,EAAAA,WAA2BwC,EAI7EC,EADQzC,GAAWrR,EAAAA,WAAqBwQ,EAAQE,EAC/B+B,GAAAA,SAAoB3oC,EAAAA,KAAK9V,UAI9Bq9C,EAAW7lD,EAAAA,KACduoD,EAAU/5C,EAAAA,MAAMlgB,YAGbg6D,EAASvJ,EAAAA,KAAYv2C,EAAAA,UAAkB7H,EAAAA,IAAck3C,EAAAA,QACvE,IAA4BthB,EAAA,KACxBiyB,GAAAA,IACSA,EAAUzJ,EAAAA,KAAa0J,EAAO9nD,EAAAA,IAAcy6B,EAAAA,OAMvD7E,EAAA,CAAA,MAAemyB,EAASh7C,EAAAA,YAAY6lB,QAC3Bg1B,GAAUzJ,EAAAA,MAAMnlD,KAGzB,IAAaksD,EAAWvnC,EAAAA,KACV/V,EAAOD,EAAAA,gBAEX0zC,EAAAA,SAASh0C,IAAUg0C,EAAAA,UAAUr7C,IAAcgoD,GAAA,IAC1CpgD,EAAOC,EAAAA,SACND,EAAOD,EAAAA,iBAInB,IAA4BsgD,EAAA,GACxB/C,GAAWrR,EAAAA,WACb9nC,EAAA,CAAA,MAA+Cm8C,EAAA,QAAzBjO,EAAA,QAAXoK,EAAMxkB,EAAAA,aAAAA,IAAKsoB,OAAA,EAAEngE,EAAAA,IAAIu+C,WAAAA,IAAmB0T,EAAIA,EAAA,IACnD2J,GAAct3C,EAAOjY,EAAAA,KAAW+zD,GAAG1gB,EAAAA,aAAa1uC,SAEhD,CAAA,MAA+CqvD,EAAA,QAAzBhP,EAAA,QAAXkL,EAAM1kB,EAAAA,aAAAA,IAAK8Z,OAAA,EAAE3xD,EAAAA,IAAIu+C,WAAAA,IAAmB8S,EAAIA,EAAA,IACnDuK,GAAct3C,EAAOjY,EAAAA,KAAW+zD,GAAG1gB,EAAAA,aAAa1uC,YAE1C,IAAqBurD,GAAOF,EAAOz8C,EAAOX,EAAAA,OAAkBi+C,EAAAA,YAAqBvB,EAASr3C,EAAQs3C,EAAasB,EAAAA,cAK3HoD,sBAAiDhD,eAC/CiD,EAAA,MAAejqC,EAAQ00B,EAAAA,UACqCuS,EAAA,QAAzBiD,EAAA,QAAvBlqC,EAAQ00B,EAAAA,UAAUnT,aAAAA,IAAK4oB,OAAA,EAAEzgE,EAAAA,IAAIu+C,WAAAA,IAAmBiiB,EAAIA,EAAA,IAC1DE,GAASpqC,EAAQy0B,EAAAA,UACqC1Z,EAAA,QAAzBkvB,EAAA,QAAvBjqC,EAAQy0B,EAAAA,UAAUlT,aAAAA,IAAKgnB,OAAA,EAAE7+D,EAAAA,IAAIu+C,WAAAA,IAAmBgiB,EAAIA,EAAA,IAGhEI,GAAIC,GAAAA,aAAkB9G,IAAkB4G,aAAkCzG,GAIxE,QAH8B1gC,EAAAA,OAAgBA,EAAAA,OACzB7lB,EAAAA,IAAIkL,SAAalL,EAAAA,MAMpCktD,GAAAA,aAAkBC,IAAmBH,aAAkBG,IAC7CzuD,EAAAA,KAAKgrD,UACf,CAAA,IACI0D,EASJC,SARY3uD,EAAAA,KAAKy5C,WACfx0C,GAAO2pD,EAAA,IAASC,GAAIn+D,EAAAA,MAAcsP,EAAAA,KAAKgrD,UAAUlO,OAAYpsD,EAAAA,MAAcsP,EAAAA,KAAKgrD,UAAU3qB,MAC7EyuB,EAAIp+D,EAAAA,MAAMw6D,KAEhB0D,EAAA,IAASE,GAAIp+D,EAAAA,MAAcsP,EAAAA,KAAKgrD,UAAUlO,OAAYpsD,EAAAA,MAAcsP,EAAAA,KAAKgrD,UAAU3qB,MAC7EwuB,EAAIn+D,EAAAA,MAAMw6D,IAGb/G,EAAAA,gBAA4BwK,GAAA,GAMzCH,GAAAA,aAAkBC,IAAmBH,aAAkB5G,IACvD4G,aAAkBG,IAAmBD,aACtC3G,GACA,CAAA,MAAmBgH,EAAIn+D,EAAAA,MACvBwL,GAAIgoB,GAAQlkB,EAAAA,KAAKiF,KACf,OAAejF,EAAAA,KAAKiF,KAAKk/C,gBAA4ByK,GAAA,GAMtDJ,GAAAA,aAAkBO,IAAgBT,aAAkBG,IACpDH,aAAkBS,IAAgBP,aACnCjG,GACA,CAAA,IAMAqG,EAJEF,GADExqC,EAAQlkB,EAAAA,KAAKy5C,WACFqV,EAAIp+D,EAAAA,MAEJm+D,GAAIn+D,EAAAA,MAEfwzB,GAAQlkB,EAAAA,KAAKiF,KACf,OAAejF,EAAAA,KAAKiF,KAAKk/C,gBAA4ByK,GAAA,GAMtDJ,GAAAA,aAAkB9G,IAAkB4G,aAAkBS,IACtDT,aAAkB5G,IAAkB8G,aACrChG,GAEA,CAAA,MAAmBsG,EAAIp+D,EAAAA,MAEvBwL,GAAA,IACIsyD,EAAAA,aAAkB9G,KACN8G,EAAOpP,EAAAA,iBAAyB5xC,EAAAA,SAGhD,MAAakhD,EAAWliD,EAAAA,SAExBmiD,GAAIzqC,GAAQlkB,EAAAA,KAAKiF,KACf,OAAc+pD,EAAKC,GAAOD,EAI9B,SAAO,UCnUED,WAOXtO,sBACEn1C,EAAAA,QACAtS,KAAK8jD,MAAgBA,EAAAA,OAAgBtxC,EAAAA,KACrCxS,KAAKqnC,IAAcA,EAAAA,KAAc70B,EAAAA,KACjCxS,KAAK6/B,OAAuB,QAAdrpC,EAAQqpC,EAAAA,cAAAA,IAAMq2B,EAAI7pD,EAAOmG,EAAAA,KAMlCwC,eACE,IAAiBw6C,GACtB1L,CAAAA,MAAO9jD,KAAK8jD,MAAM9uC,QAClBqyB,IAAKrnC,KAAKqnC,IAAIryB,UAIlBizC,mBACEkO,EAAA,MAAWn2D,EAAAA,KAAKmoD,kBACqB,QAA9B4H,EAAAA,MAAAA,OAAAA,EAAInc,EAAAA,UAAU7/B,IAAI/T,KAAK6/B,eAAAA,IAAOs2B,EAAIn2D,EAAAA,KAAK6/B,OAMhDrmB,yBACmBsqC,MAAMhwC,QAAQ9T,KAAKqnC,KAAKtzB,IAAI/T,KAAKo2D,eAI5CA,kBACNC,EAAA,MAAWr2D,EAAAA,KAAKmoD,kBACa,QAAb4H,EAAAA,MAAAA,OAAAA,EAAInc,EAAAA,iBAAAA,IAASyiB,EAAIhqD,EAAOmG,EAAAA,KAIlC8jD,uBACN,MAAWt2D,EAAAA,KAAKmoD,WACF4H,EAAKA,EAAGjc,EAAAA,eACtB,cAAYgQ,MAAMlvC,OAAcb,GAAAA,IAAI/T,KAAKo2D,eAGnCG,qBACN,MAAWv2D,EAAAA,KAAKmoD,WACF4H,EAAKA,EAAGjc,EAAAA,eACtB,cAAYzM,IAAIzyB,OAAcb,GAAAA,IAAI/T,KAAKo2D,eAMlCrS,WACL,MAAc/jD,EAAAA,KAAKs2D,uBACPt2D,EAAAA,KAAKu2D,qBACAzS,EAAMtwC,EAAAA,SACvBgjD,UAAWviD,EAAAA,IAAWJ,GAAAA,MAAUL,EAM3BoiD,GAAA1R,YACL,MAAclkD,EAAAA,KAAKs2D,uBACPt2D,EAAAA,KAAKu2D,4BACM/iD,EAAAA,SAOlBgjD,GAAA/mD,oBAOA0K,QAAkB7c,EAAcwV,EAAAA,EAAAA,GACrC,MAAkB9S,EAAAA,KAAKs2D,uBAAuBriD,IAAQ3L,EAAAA,KAGf,GAAA,IAA/BmS,EAAAA,IAAIpG,MAAMrU,KAAK+jD,aAAkD,IAAnB1vC,EAAAA,MAAUoG,EAAAA,KAC9D,OAAO,KAIT,MAAgBL,EAAIK,EAAAA,IAAIpG,MAAMrU,KAAK+jD,YACnB,GAAA,IACd4R,EAAA,OAAO,KAGT,MAAU1R,EAAU5vC,EAAAA,MAAMrU,KAAK+jD,YAE/B4R,EAAIh9C,GAAKq9C,GAAKr9C,GAAKrb,GACjB4F,EAAA,CAAA,MAAU+gD,EAAU5vC,EAAAA,MAAUoG,EAAAA,KAAiBza,EAAAA,KAAKkkD,YAChDC,GAAKsS,GAAKtS,GAAKsS,GACjB,EAAA,OAAWnS,EAAAA,SAIf0R,UAAO,KAOF3M,sBACL1wC,GAAI22C,GAAAA,aACFT,GAAA,OAA4BV,GAAAA,sBAA6BnuD,EAAAA,MAChDsvD,GAAAA,aACTC,GAAA,OAA4BhC,GAAAA,uBAA8BvtD,EAAAA,MAAM8qD,OACvDwE,GAAAA,aACTE,GAAA,OAA4BnB,GAAAA,oBAAoBruD,KAEhD2Y,GAAA,MAAM,IAAIjT,MAAM,gEAObiT,GAAA4nC,QACL5nC,GAAI22C,GAAAA,aACFT,GAAA,OAA0Bc,GAAAA,kBAAyB3vD,EAAAA,MAC1CsvD,GAAAA,aACTC,GAAA,OAA0ByE,GAAAA,mBAA0Bh0D,EAAAA,MAC3CsvD,GAAAA,aACTE,GAAA,OAA0BuE,GAAAA,kBAE1B,MAAM,IAAIruD,MAAM,6DAObiT,GAAAytC,iBACLztC,GAAA,MAAyB3Y,EAAAA,KAAKs2D,uBACPt2D,EAAAA,KAAKu2D,4BACd3pD,EAAAA,IAAwB6pD,GAC7BC,EAEAC,EAIHf,EAAAgB,oBAAmCvvB,EAAa3T,EAAU3jC,EAAA,WAGzD,IACLgC,GAAAA,KAAKwL,IAAU6C,EAAGinC,EAAIjnC,EAAKszB,GAC3B3hC,EAAAA,KAAKwL,IAAU8C,EAAGgnC,EAAIhnC,EAAKqzB,GAC3B3hC,EAAAA,KAAKuL,IAAU8C,EAAGinC,EAAIjnC,EAAKszB,GAC3B3hC,EAAAA,KAAKuL,IAAU+C,EAAGgnC,EAAIhnC,EAAKqzB,GAO/B3jC,GAAAmxD,aACE,MAAyBlhD,EAAAA,KAAKs2D,uBACPt2D,EAAAA,KAAKu2D,iCAChBK,oBAAsCD,EAMpDE,GAAAlnC,8BACcinC,oBAAoB52D,KAAK8jD,MAAO9jD,KAAKqnC,KAM5CqmB,gBACE,IAAS1tD,GAAAA,KAAKs2D,uBAAwBt2D,KAAKu2D,sBAM7CjD,qBACE,IAAStzD,GAAAA,KAAK8jD,MAAO9jD,KAAKqnC,KAMnCwhB,WACE,MAAU7oD,EAAAA,KAAKu2D,qBAAqBtiD,IAAIjU,KAAKs2D,wBACxB9hD,SAERqiD,EAAA,UACR7jE,EAAAA,KACL61D,GAAK71D,EAAAA,KAAgByhB,EAAAA,UAChBzhB,EAAAA,KAAgBwhB,EAAAA,UAChBxhB,EAAAA,KAAgBwhB,EAAAA,SAASC,UAQzBoiD,EAAA3N,WACLvwC,GAAA,MAAe3Y,EAAAA,KAAKqnC,IAAIpzB,IAAIjU,KAAK8jD,OAAOtwC,WACxC,SAAcliB,EAASA,EAMlBulE,EAAAr+B,OACLx4B,QAAKmoD,WAMAxvC,EAAAmxC,QACLnxC,GAAA,MAAgBk+C,EAAA,GAEA72D,EAAAA,MAAKs2D,4BAA6BC,sBACtCr9C,EAAO5nB,EAAAA,WACd,IAAQ0kE,EAAGjmE,EAAI8W,EAAK9W,EAAAA,IACfiD,EAAAA,KAAYjD,EAAG6c,GAAAA,IAAI2d,WAGtB,IAAex4B,GAAAA,KAAKwL,IAAI7F,MAAM3F,KAAgBA,GAAAA,KAAKuL,IAAI5F,MAAM3F,KAAMm+D,IAGrEp0C,KAAoC1F,EAAehB,EAAMiD,GAAAA,MAAqBhM,EAAOmG,EAAAA,MAC1F,MAAcxS,EAAAA,KAAK8jD,MAAM/vC,IACnBszB,GAAMrnC,EAAAA,KAAKqnC,IAAItzB,IACrB4H,GAAIC,EAAAA,YAAoB3oB,EAAAA,WACpBw6B,EAAAA,YACAG,EAAAA,OAAaxtB,EAAG0jD,EAAMzjD,EAC1Bsb,GAAIkS,EAAAA,OAAWztB,EAAGinC,EAAIhnC,EACtBsb,GAAImS,EAAAA,YACAC,EAAAA,SAGChnB,MAAoCqP,EACzClT,GAAA,MAAclD,EAAAA,KAAKs2D,uBACPt2D,EAAAA,KAAKu2D,qBACdO,EAAAA,SAAgBzvB,EAAKjxB,EAAOlT,EAC/B6Y,GAAGq0C,EAAAA,WAAkB2G,EAAG3gD,EACxB2F,GAAGq0C,EAAAA,WAAgBuF,EAAGv/C,EAIjBlT,GAAAwY,UAAyCtF,EAAehB,EAAMuC,GAAAA,KACnE,MAAc3X,EAAAA,KAAKs2D,uBACPt2D,EAAAA,KAAKu2D,qBACb36C,EAAAA,YAAoB3oB,EAAAA,WACpBw6B,EAAAA,YACAG,EAAAA,OAAaxtB,EAAG0jD,EAAMzjD,EAC1Bsb,GAAIkS,EAAAA,OAAWztB,EAAGinC,EAAIhnC,EACtBsb,GAAImS,EAAAA,YACAC,EAAAA,gBC/QK0nC,WAkBXhO,sBACEn1C,EAAAA,QANMtS,KAAAg3D,mBAA+B,GAAAh3D,KAC/Bi3D,MAAkB,GAAAj3D,KAClBk3D,OAAiB,GAAAl3D,KACjBm3D,YAAsB,GAAAn3D,KAIvB6/B,OAAuB,QAAdrpC,EAAQqpC,EAAAA,cAAAA,IAAMu3B,EAAI/qD,EAAOmG,EAAAA,KACvC,MAAM6kD,IAAoBC,EAAAA,sBACrBp+C,QAAoB1iB,EAAQ0iB,EAAAA,OAAOq+C,UAAoBr+C,EAAAA,SAAW,GAAAlZ,KAGlEw3D,2BAMAxiD,eACE,IAAoBu6C,GACzB1vB,CAAAA,OAAQ7/B,KAAK6/B,OAAO7qB,QACpBkE,OAAQlZ,KAAKkZ,OAAOjY,KAAW2E,GAAEoP,EAAAA,YAOrCizC,2BACWE,WACAnoD,KAAKmoD,WAAW7/C,IAAIyL,IAAI/T,KAAK6/B,QAE/B7/B,KAAK6/B,OAMdrmB,yBACc0nC,OAAO1nC,OAMbg+C,2BACN,MAAkBx3D,EAAAA,KAAKmoD,WAEXruC,EAAYA,EAAU85B,EAAAA,UAAU7/B,IAAI/T,KAAK6/B,QAAU7/B,KAAK6/B,OACtD/lB,EAAYA,EAAUg6B,EAAAA,eAC9BjgC,EAAQiG,EAAYA,EAAU+5B,EAAAA,YAAqBphC,EAAAA,IAE7CzS,EAAAA,KAAKkZ,OAAO5nB,YACnB0lE,mBAAmB1lE,OACxB,MAAK,IAAQmmE,EAAG1nE,EAAI8W,EAAK9W,EAAAA,IACvBiQ,KAAKg3D,mBAAwBh3D,GAAAA,KAAKkZ,OAAUrF,GAAAA,MAAae,GAAAA,OAAcb,GAAAA,IAOpE2jD,GAAAC,mCACAH,2BACEx3D,KAAKg3D,mBAMP5F,WACDpxD,GACKA,KADAk3D,OAAO5lE,OACd,OAAA0O,KAAYk3D,OAEd,MAAcU,EAAA,GACC53D,EAAAA,KAAK23D,uBACRz+C,EAAO5nB,EAAAA,WACd,IAAQqkE,EAAG5lE,EAAI8W,EAAK9W,EAAAA,IAEjBiD,EAAAA,KAAK,IAASkmB,GAAOnpB,EAAImpB,GAAQnpB,GAAI4lE,EAAK9uD,GAAAA,iBAE7CqwD,OACEl3D,EAAAA,KAAKk3D,OAMP7F,gBACDrxD,GACKA,KADAm3D,YAAY7lE,OACnB,OAAA0O,KAAYm3D,YAEd,MAAcS,EAAA,GACC53D,EAAAA,KAAKkZ,OACRA,EAAO5nB,EAAAA,WACd,IAAQqkE,EAAG5lE,EAAI8W,EAAK9W,EAAAA,IAEjBiD,EAAAA,KAAK,IAASkmB,GAAOnpB,EAAImpB,GAAQnpB,GAAI4lE,EAAK9uD,GAAAA,iBAE7CswD,YACEn3D,EAAAA,KAAKm3D,YAOPjE,SACLv6C,GAAA,MAAc3Y,EAAAA,KAAKoxD,WACnB,IAAeG,EAAMmG,EACjB1O,GAAev8C,GAAAA,OAAOC,cACrB,IAAWspD,EAAG/pD,EAAOslD,EAAMjgE,EAAAA,OAAQ2a,IACtC,CAAA,MAAoBslD,EAAMtlD,EAEpB4rD,GADaC,EAAYtjD,EAAAA,SACE5H,IAC7BirD,GAAgB7O,EAAAA,IACP8O,EACX9O,EAAc6O,EAGlBxI,UAOK0I,EAAA5E,cACLx6C,GAAA,MAAc3Y,EAAAA,KAAKqxD,gBACnB,IAAeE,EAAMmG,EACjB1O,GAAev8C,GAAAA,OAAOC,cACrB,IAAWspD,EAAG/pD,EAAOslD,EAAMjgE,EAAAA,OAAQ2a,IACtC,CAAA,MAAoBslD,EAAMtlD,EAEpB4rD,GADaC,EAAYtjD,EAAAA,SACE5H,IAC7BirD,GAAgB7O,EAAAA,IACP8O,EACX9O,EAAc6O,EAGlBxI,UAMF0I,EAAAlP,WACM7oD,GACKA,KADAi3D,MAAM3lE,OACb,OAAA0O,KAAYi3D,MAEd,MAAaj3D,EAAAA,KAAKoxD,WAAWnwD,KAAW6I,GAAE0K,EAAAA,uBACrCyiD,MACEj3D,EAAAA,KAAKi3D,MAGPz+B,OACLx4B,QAAKmoD,WACLnoD,EAAAA,KAAKk3D,OAAO5lE,OACZ0O,EAAAA,KAAKm3D,YAAY7lE,OACjB0O,EAAAA,KAAKi3D,MAAM3lE,OACX0O,EAAAA,KAAKg3D,mBAAmB1lE,OACxB0O,EAAAA,KAAK23D,uBACL33D,KAAKoxD,WACLpxD,KAAKqxD,gBAMA5hD,SAGLkJ,GAAA,MAAgB++C,EAAA,IAAQh+C,GAAOf,EAAA,IAAW60B,EAAG,EAAA,gBACjB4jB,WAAW5S,QAAO,SAAiBvyC,EAC7D8rD,UAAY58C,EAAAA,UAAUlP,IACb+rD,EAAQC,EAEVD,EAAAA,IAGY,GAAM,GAMtB,EAAA3O,sBACL1wC,GAAI8nC,GAAAA,aACFoO,GAAA,OAA4BjB,GAAAA,yBAAyB5tD,KAChD2Y,GAAI8nC,GAAAA,aACT8O,GAAA,OAA4B5C,GAAAA,0BAA0B3sD,KACjD2Y,GAAI8nC,GAAAA,aACT+O,GAAA,OAA4BjC,GAAAA,uBAAuBvtD,KAEnD2Y,GAAA,MAAM,IAAIjT,MAAM,gEASbiT,GAAA4nC,QACL5nC,GAAI8nC,GAAAA,aACFoO,GAAA,OAA0Ba,GAAAA,qBAA+B1vD,EAAAA,MAChDygD,GAAAA,aACT8O,GAAA,OAA0B2E,GAAAA,sBAAsBl0D,KAC3C2Y,GAAI8nC,GAAAA,aACT+O,GAAA,OAA0BwE,GAAAA,mBAAmBh0D,KAE7C2Y,GAAA,MAAM,IAAIjT,MAAM,gEAObiT,GAAAytC,iBACLztC,GAAA,MAAY3Y,EAAAA,KAAK23D,uBACjB,IAAoBI,EAAA,KACDtrD,GAAAA,OAAOC,cACrB,IAAQspD,EAAGjmE,EAAImoE,EAAI5mE,EAAAA,OAAQvB,IAC9B,CAAA,MAAiBoc,EAAUS,EAAAA,IAAQ7c,EAAAA,IACpBi5D,EAAAA,IACCx1C,EACd6yC,EAAgB6R,EAAInoE,EAAAA,WAUnBgoE,EAAAnI,sBACLj3C,GAAA,MAAY3Y,EAAAA,KAAKkZ,OACjB,IAAoBg/C,EAAIR,EACpB1O,GAAev8C,GAAAA,OAAOC,cACrB,IAAQspD,EAAGjmE,EAAImoE,EAAI5mE,EAAAA,OAAQvB,IAC9B,CAAA,MAAiBoc,EAAUS,EAAAA,IAAQ7c,EAAAA,IACpBi5D,EAAAA,IACCx1C,EACd6yC,EAAgB6R,EAAInoE,EAAAA,WAUnBgoE,EAAA5K,eACLx0C,GAAA,MAAc3Y,EAAAA,KAAKoxD,WACnB,IAAU3kD,EAAAA,OAAO0rD,kBACAxC,GACbniD,EAAYwiD,GAChB,MAAK,IAAQoC,EAAGroE,EAAIwhE,EAAMjgE,EAAAA,OAAQvB,IAChC,CAAA,MAAawhE,EAAMxhE,EAAGo7D,GAAAA,gBAClB8K,GAAO14D,EAAAA,IACH04D,EACNoC,EAAYtoE,EACZyjB,EAAWyiD,EAIf5G,UAAmB,IAEf77C,EAAAA,CAAAA,SAAgB6kD,EAAW7jD,GAAAA,SAASX,MACpCy5C,GAAAA,KAAY+K,EAAAA,IAIT,KAMTnX,qBACE6W,EAAA,MAAW/3D,EAAAA,KAAKmoD,WACa6N,EAAA,QAAfjG,EAAAA,MAAAA,OAAAA,EAAIlc,EAAAA,mBAAAA,IAAWykB,EAAIjsD,EAAOoG,EAAAA,IACL2lD,EAAA,QAAlBrI,EAAAA,MAAAA,OAAAA,EAAIjc,EAAAA,sBAAAA,IAAc4jB,EAAIA,EACjCpvD,EAAoB+mD,GAAA,QAAbU,EAAAA,MAAAA,OAAAA,EAAInc,EAAAA,iBAAAA,IAASmkB,EAAI1rD,EAAOmG,EAAAA,MAAMuB,IAAI/T,KAAK6/B,oBACxClQ,YAAY9b,MAAae,GAAAA,OAAiB6E,GAAAA,UAMxD41C,GAAA1/B,yBACqB/V,GAAAA,WAAW5Z,KAAKkZ,QAO9BgwC,WACLvwC,GAAA,IAAgB4/C,EACZC,EAAcC,EAClB,MAAK,IAAQC,EAAG3oE,EAAIiQ,EAAAA,KAAKkZ,OAAO5nB,OAAQvB,IACtC,CAAA,MAAkBA,GAAI2oE,EAAK14D,GAAAA,KAAKkZ,OAAO5nB,OACrB0O,EAAAA,KAAKkZ,OAAiB7E,GAAAA,MAAMrU,KAAKkZ,OAAOnpB,IAExD4oE,GACC34D,GAAAA,KAAKkZ,OAAUtM,GAAAA,IAAI5M,KAAKkZ,OAAOnpB,IAAMiQ,KAAKkZ,OAAUtM,GAAAA,IAAI5M,KAAKkZ,OAAO0/C,IAAa54D,KAAKkZ,OAAiBtM,GAAAA,IAAI5M,KAAKkZ,OAAO0/C,KAC3GD,GAEjB3C,SAAer9C,EAAMsrC,GAAYuU,EAM5BC,GAAAt+C,QAAkB7c,EAAcwV,EAAAA,EAAAA,GAGrC,MAAc9S,EAAAA,KAAKoxD,WACPG,EAAMjgE,EAAAA,OAClB,IAAqBmb,EAAAA,OAAOC,UACR0rD,GACpB,MAAK,IAAQ/I,EAAGt/D,EAAI8W,EAAK9W,EAAAA,IACvB,CAAA,MAAoBqqB,EAAIe,EAAAA,UAAgBprB,EAAAA,IACrB8oE,GAAKC,GAAcC,EAAkBD,GAAex7D,GAAAA,IACpDw7D,EACjBE,EAAejpE,EAKnBs/D,UAAoB+I,GACXh+C,EAAIkqC,EAAAA,SAIN0R,GAAA,KAMFlM,QACLnxC,GAAA,MAAe3Y,EAAAA,KAAK23D,uBACRz+C,EAAO5nB,EAAAA,OACnB,IAAUmb,EAAAA,OAAOC,UACND,GAAAA,OAAOC,cACb,IAAQ0rD,EAAGroE,EAAI8W,EAAK9W,EAAAA,IACvB,CAAA,MAAempB,EAAOnpB,EAAG6c,GAAAA,IACzBrP,GAAMxL,EAAAA,KAAKwL,IAAS07D,EACpB37D,GAAMvL,EAAAA,KAAKuL,IAAS27D,EAGtBC,UAAO,IAAe37D,GAAKD,EAGtB04D,GAAAl6C,KAAoC1F,EAAehB,EAAMiD,GAAAA,MAAqBhM,EAAOmG,EAAAA,MAC1F,MAAwBlK,EAAIyL,EAAAA,IAAI/T,KAAK6/B,QACjCpS,EAAAA,YACAjlB,EAAAA,UAAkBvV,EAAAA,WAEtB,MAAmB+M,EAAAA,KAAKkZ,OAAUnF,GAAAA,IAClC4H,GAAIiS,EAAAA,OAAkBxtB,EAAG+4D,EAAW94D,EAGpCL,GAAAA,KAAKkZ,OACFjY,KAAW2E,GAAEmO,EAAAA,IAAIqlD,KACjBtoD,SAAQ,SACP6K,GAAIkS,EAAAA,OAAaztB,EAAGsZ,EAAMrZ,EAAAA,MAE1BwtB,EAAAA,OAAkBztB,EAAG+4D,EAAW94D,EACpCsb,GAAImS,EAAAA,YACAM,EAAAA,OAECrnB,MAAoCqP,EACzClT,GAAA,MAAmBlD,EAAAA,KAAK23D,uBAClBz+C,GAAUigD,EAAAA,CAAAA,UAAoBxB,uBACpC0B,OAAK,IAAQC,EAAGvpE,EAAImpB,EAAO5nB,EAAAA,OAAYvB,EAAAA,IAClC+mE,EAAAA,SAAgB/mE,EAAImpB,GAAOnpB,EAAIupE,EAAIljD,GAAOlT,EAC7C6Y,GAAGq0C,EAAAA,WAAkBrgE,EAAIupE,GAAGljD,EAC5B2F,GAAGq0C,EAAAA,WAAkBrgE,EAAIupE,EAAI,GAAGljD,EAK7BlT,GAAAwY,UAAyCtF,EAAehB,EAAMuC,GAAAA,KAC/D8V,EAAAA,YACA7R,EAAAA,YAAoB3oB,EAAAA,WAExB,MAAmB+M,EAAAA,KAAK23D,uBACxBh8C,GAAIiS,EAAAA,OAAkBxtB,EAAG+4D,EAAW94D,EACpCL,GAAAA,KAAK23D,uBAAuB7mD,SAAQ,SAClC6K,GAAIkS,EAAAA,OAAaztB,EAAGsZ,EAAMrZ,EAAAA,MAExBwtB,EAAAA,OAAkBztB,EAAG+4D,EAAW94D,EACpCsb,GAAImS,EAAAA,YACAC,EAAAA,gBC3aNwrC,cAA0B9xD,EAAgBoN,EAAiBxI,EAAOqG,EAAAA,KAAuBrG,EAAOmG,EAAAA,aACvF,IAAoB+8C,GACzBr2C,CAAAA,OAAQ,IAAiB1R,IAAQqN,EAAOzU,EAAIqH,GAASoN,EAAOxU,EAAGmH,EAAQA,EAAQqN,EAAOzU,EAAGqH,EAASA,EAASoN,EAAOxU,EAAGsZ,GAAAA,YACrHkmB,OAAQA,mBAUqBy3B,EAA4Bp0D,GAAA,EAAwBmJ,EAAOmG,EAAAA,aACnF,IAAoB+8C,GACzBr2C,CAAAA,OACA2mB,EAAAA,OACAy3B,EAAAA,iBAAkBA,kBASQz3B,EAAiBxzB,EAAOmG,EAAAA,aAC7C,IAAmBq8C,GACxB1gC,CAAAA,OACA0R,EAAAA,OAAQA,gBASewH,EACzBnkC,UAAO,IAAiBssD,GACtB1L,CAAAA,MACAzc,EAAAA,IAAKA,WC1CEmyB,WAcXhtB,eACEl6B,GAAAA,QAdctS,KAAA9F,KAAO,cAEhB8F,KAAA28B,OAAS,IAAoB38B,GAAAA,MAAAA,KAI7By5D,eAAiB,IAKjB3a,GAAA9+C,KAAA05D,iBAAmB,IAIxB15D,GAAAA,KAAK/G,IAIA0gE,GAAA/kE,kBACOglE,UAGP3gE,IAYL0f,eAXSihD,YACP55D,KAAK28B,OAAO5P,OAAgB4P,EAAAA,QAC5B38B,KAAK05D,iBAAiBna,UAAUv/C,KAAK45D,YAEnCnZ,IACFzgD,KAAK45D,UACL55D,EAAAA,KAAK45D,UAAUntB,MAAQzsC,KAAKysC,MAC5BzsC,KAAK28B,OAAO9P,KAAc8P,EAAAA,QAC1B38B,KAAKy5D,eAAela,UACpBv/C,GAAAA,KAAKw4B,UAKT7f,EAAAuoC,mBACE2Y,SAA6B,QAARA,EAAA,QAAd75D,EAAAA,KAAK45D,iBAAAA,IAASE,OAAA,EAAE5Y,EAAAA,cAAAA,IAAM2Y,EAAIA,EAAA,IAGnCjR,GAAAj5B,wBACEoqC,SAAkC,QAAbA,EAAA,QAAd/5D,EAAAA,KAAK45D,iBAAAA,IAASI,OAAA,EAAErqC,EAAAA,mBAAAA,IAAWoqC,EAAIA,EAAA,IAGjCnR,GAAApwB,aACLyhC,EAAA,MAAqBC,EAAA,QAAVl6D,EAAAA,KAAKysC,aAAAA,IAAKwtB,OAAA,EAAErlE,EAAAA,IAAIu+C,SAClBymB,YACP55D,KAAK45D,UAAUntB,MAAQzsC,KAAKysC,MAE1BzsC,GAAAA,KAAK45D,UAAUphC,OAAOu3B,IAK5BxP,QACE5nC,GAAA,IAAgB3Y,EAAAA,KAAK45D,UACL3+C,EAAM2+C,EAAAA,UAIRO,GAAA,EACVxa,GAAAA,aAAqBgI,KACXhI,EACZA,EAAY3/C,EAAAA,KAAK45D,UACPO,GAAA,GAGRn6D,KAAK45D,UACP,CAAA,MAAiBha,EAAUW,EAAAA,QAC3B6Z,UACMC,GACFlT,GAASr2C,EAAAA,SAASoa,IACRolC,EAAAA,IAAcA,EAAAA,IAAI77C,SAClBD,EAAAA,OAAiBA,EAAAA,OAAOC,SACxB87C,EAAAA,QAAkB/7C,EAAAA,OAAOD,gBACzBqrC,EAAAA,UAAY5/C,KAAK45D,UACjBja,EAAAA,UAAkBia,EAAAA,aAKzB5D,GAAA,YAKXsE,MACMt6D,QAAK45D,WACP55D,KAAKw4B,SAGPx4B,KAAK28B,OAAUlZ,GAAA,gBAAiB0U,IAC9B,MAAqBA,EACrBoiC,EAAO59B,EAAAA,OAAOtQ,KACZ,eACA,IAAsBmuC,GAAaxmE,EAAAA,OAAOy4C,MAAoBxxB,EAAAA,MAAMwxB,MAAoBxgC,EAAAA,KAAmBgN,EAAAA,kBAG/GjZ,KAAK28B,OAAUlZ,GAAA,iBAAkB0U,IAC/B,MAAsBA,EACtBoiC,EAAO59B,EAAAA,OAAOtQ,KACZ,gBACA,IAAuBouC,GAAczmE,EAAAA,OAAOy4C,MAAqBxxB,EAAAA,MAAMwxB,MAAqBxgC,EAAAA,KAAoBgN,EAAAA,kBAGpHjZ,KAAK28B,OAAUlZ,GAAA,kBAAmB0U,IAChC,MAAcA,EACdoiC,EAAO59B,EAAAA,OAAOtQ,KAAK,iBAAkB,IAAwBrH,GAAMhxB,EAAAA,OAAOy4C,MAAaxxB,EAAAA,MAAMwxB,MAAavhB,EAAAA,aAE5GlrB,KAAK28B,OAAUlZ,GAAA,gBAAiB0U,IAC9B,MAAYA,EACZoiC,EAAO59B,EAAAA,OAAOtQ,KAAK,eAAgB,IAAsBgb,GAAIrzC,EAAAA,OAAOy4C,MAAWxxB,EAAAA,MAAMwxB,WAIzFiuB,gBACO/9B,OAAOrsB,QACZtQ,KAAK05D,iBAAiBna,UAAUv/C,KAAK45D,WAUvCe,eAA8BlzD,EAAgBoN,EAAiBxI,EAAOqG,EAAAA,KAAuBrG,EAAOmG,EAAAA,MAClG,MAAiBooD,EAAMC,GAAAA,IAAWpzD,EAAQoN,EAAQ2E,EAClD1P,eAAa7Q,IAYf+8D,GAAA8E,mBAAqCthD,EAAiBnN,EAAOmG,EAAAA,MAC3D,MAAaooD,EAAMG,GAAAA,QAAgBpiD,GAAA,EACnCzV,eAAajK,IAQf+hE,GAAAC,kBAAkCzhD,EAAiBnN,EAAOmG,EAAAA,MACxD,MAAiBooD,EAAMM,GAAAA,OAAe1hD,EACtCtW,eAAajK,IASf+hE,GAAAG,gBAA+B9zB,EAC7BnkC,GAAA,MAAiB03D,EAAMQ,GAAAA,KAAY/zB,EACnCnkC,eAAajK,IAGf+hE,GAAAK,qBACE1iD,eAAa1f,IAAI,IAAsBuvD,GAAAA,KCxK3C,IAAY8S,GACVC,IAAAA,GADUD,KAAeE,GAAA,KACzBC,SAAA,WACAF,GAAA/tB,EAAA,IACA+tB,GAAA9iD,EAAA,UAOWunC,WAOXxT,0BACEl6B,EAAAA,QAPctS,KAAA9F,KAAO,UAChB8F,KAAA07D,aAAgBvoB,CAAoBjG,GAAAA,SAEVvnC,GAASnN,EAAA,OAAsBq2B,GAAAA,OAAAA,KACzD8N,OAAS,IAAoB38B,GAAAA,MAAAA,KAc7BogD,cAA6CxE,GAAAA,iBAK7C57C,KAAAmgD,MAAuCtB,GAAAA,IAKvC7+C,KAAA27D,KAAuB5e,GAAAA,YAYvB/8C,KAAA4wD,YAAsBnU,EAAQgB,GAAAA,aAK9Bz9C,KAAA47D,SAA4Bre,GAAAA,wBAE3Bv9C,KAAA67D,WAAY,EAgEb77D,KAAA87D,WAKA,GAAA97D,KAAA+7D,SAAmB,IAKnB/7D,KAAAg8D,YAAsB,EAKtBh8D,KAAAi8D,qBAA0C,GAAAj8D,KAqC1CmmD,OAAiB,IAAW3Y,EAAG,EAgB/B,GAAAxtC,KAAAk8D,OAAiB,IAAW1uB,EAAG,EAiB/B,GAAAxtC,KAAAm8D,OAAwB3pD,EAAAA,KAgBxBxS,KAAAo8D,YA6BA,EAAAp8D,KAAAq8D,SAA0B5pD,EAAAA,IAzO3Bjc,IACFwJ,KAAKogD,cAA4B,QAAZ5pD,EAAQ0D,EAAAA,YAAAA,IAAIoiE,EAAIt8D,EAAAA,KAAKogD,cAC1CpgD,KAAKmgD,MAAqB,QAAb3pD,EAAQ2pD,EAAAA,aAAAA,IAAK6a,EAAIh7D,EAAAA,KAAKmgD,MACnCngD,KAAKg8D,WAA+B,QAAlBxlE,EAAQwlE,EAAAA,kBAAAA,IAAUO,EAAIv8D,EAAAA,KAAKg8D,YAsBjDQ,8BACcpc,gBAAgCnkC,GAAAA,MAAY,EAAIjc,EAAAA,KAAK27D,KAiBnEhL,2BACckL,UAOPhL,YACL7wD,QAAK67D,UACAlL,EAIH3wD,GAAAA,KAAKwqC,IAAah4B,EAAAA,KAClBxS,KAAKmtC,IAAa36B,EAAAA,KAClBxS,KAAKksC,gBACLlsC,EAAAA,KAAK4wD,YALL5wD,GAAAA,KAAK4wD,YAAcnU,EAAQgB,GAAAA,aAYxBgf,oBACIZ,WACP77D,KAAK6wD,aAAY,GAEnB,MAAsB7wD,EAAAA,KAAKwqC,IAAI72B,KAAO3T,KAAKwqC,IAAI72B,KAAO5hB,KAAKwhB,IAAIvT,KAAKksC,gBAAkBlsC,KAAKksC,iBAC9EuQ,EAAQkB,GAAAA,eAChBiT,YAAqB5wD,EAAAA,KAAK4wD,aAAmB8L,EAAQC,GAC1D38D,EAAAA,KAAK4wD,YAAoB5wD,EAAAA,KAAK4wD,YAAgB,EAAKnU,GAAQgB,GAAAA,cACvDz9C,KAAK47D,UAAY57D,KAAK4wD,YAAsBnT,GAAAA,cAC9Cz9C,KAAK6wD,aAAY,GAOrBvjB,cAEE,MAAiBttC,EAAAA,KAAKysC,MAAM73C,IAAI4kE,WAC5B/Y,MAAAA,OAAAA,EAAU7rD,EAAAA,OACIA,EAAAA,MAAMs0D,WAAWlpD,KAAK27D,MAQ1C,EAAAiB,iCACcxc,gBAAgCnkC,GAAAA,MAAY,EAAIjc,EAAAA,KAAKstC,QA2BnE+S,iBACEwc,WAAmB,QAAV78D,EAAAA,KAAKysC,aAAAA,IAAKowB,OAAA,EAAExc,EAAAA,QAGvB7mC,yBACclR,IAGdwR,oBACEgjD,SAAiB,QAAV98D,EAAAA,KAAKysC,aAAAA,IAAKqwB,OAAA,EAAEloE,EAAAA,IAAIu+C,IAGzBkC,iBACE0nB,SAAiB,QAAV/8D,EAAAA,KAAKysC,aAAAA,IAAKswB,OAAA,EAAEnoE,EAAAA,IAAIs4C,IAQzB5kC,sBACcwR,UAAU85B,UAGxBtrC,QACEtI,QAAK8Z,UAAU85B,UAWjBj7B,EAAA6xB,sBACc6K,OAAO7K,IAGrBA,QACExqC,QAAKq1C,OAAO7K,IAYd7xB,EAAAw0B,sBACckI,OAAOlI,IAGrBA,QACEntC,QAAKq1C,OAAOlI,IAWdx0B,EAAA00B,yBACcgI,OAAOhI,OAGrBA,WACErtC,QAAKq1C,OAAOhI,OAWd10B,EAAAsW,2BACcnV,UAAUg6B,eAGxB7kB,aACEjvB,QAAK8Z,UAAUg6B,eAOjBn7B,EAAA9E,wBACciG,UAAU+5B,YAGxBhgC,UACE7T,QAAK8Z,UAAU+5B,YAajBl7B,EAAA21B,qBACc+G,OAAOjI,YAGrBhtC,EAAc48D,OACZh9D,QAAKq1C,OAAOjI,YAAgB4vB,EAO9BrkD,EAAA01B,qBACcgH,OAAOjI,YAGrB/sC,EAAc48D,OACZj9D,QAAKq1C,OAAOjI,YAAgB6vB,EAO9BtkD,EAAAukD,qBACc7nB,OAAOnJ,gBAOP96C,OACZ4O,QAAKq1C,OAAOnJ,gBAMdvzB,EAAAuzB,kCACcmJ,OAAOnJ,gBAMrBA,oBACElsC,QAAKq1C,OAAOnJ,gBAQPvzB,EAAAwkD,aAA4BC,EACjCl6D,GAAIlD,GAIJA,KAJSogD,gBAAgCtE,GAAAA,OACvC,OAGF,MAAqBshB,EAAQvpD,EAAAA,MAAM7T,KAAKw8D,aACpCx8D,GAUyB0Z,KAVpBuiD,qBAAqBzqE,SAAyBg8C,GAAAA,KACxCptC,EAAIA,EAEfJ,GAAAA,KAAKi8D,qBAAqBzqE,SAAyBinB,GAAAA,KACxCpY,EAAIA,EAGnBL,GAAAA,KAAKwqC,IAAIt2B,SAASmpD,IAEbr9D,KAAKi8D,qBAAqBzqE,SAAyBiqE,GAAAA,UACtD,CAAA,MAA2B/hD,EAAMzF,EAAAA,IAAIjU,KAAKsI,UACrC4jC,iBAAmBlsC,KAAK48D,eAAoCvoD,EAAAA,MAAM+oD,IAQpEE,mBACL3kD,GAAI3Y,GAIJA,KAJSogD,gBAAgCtE,GAAAA,OACvC,OAGF,MAAqBshB,EAAQvpD,EAAAA,MAAM7T,KAAKw8D,kBAE/BP,qBAAqBzqE,SAAyBg8C,GAAAA,KACxCptC,EAAIA,EAEfJ,GAAAA,KAAKi8D,qBAAqBzqE,SAAyBinB,GAAAA,KACxCpY,EAAIA,EAGnBL,GAAAA,KAAKwqC,IAAMxqC,KAAKwqC,IAAIz2B,IAQfwpD,GAAAC,oBAAmCJ,EACxCl6D,GAAIlD,GAKyB0Z,KALpB0mC,gBAAgCtE,GAAAA,SAIpC97C,KAAKi8D,qBAAqBzqE,SAAyBiqE,GAAAA,UACtD,CAAA,MAA2B/hD,EAAMzF,EAAAA,IAAIjU,KAAKsI,UACrC4jC,iBAAmBlsC,KAAK48D,eAAoCvoD,EAAAA,MAAM+oD,IAOpEK,2BAEAvB,OAAO/oD,MAAMnT,KAAKwqC,IAAOxqC,EAAAA,KAAKwqC,IACnCxqC,GAAAA,KAAKmmD,OAAOhzC,MAAMnT,KAAKsI,IAAOtI,EAAAA,KAAKsI,IACnCtI,GAAAA,KAAKm8D,OAAOhpD,MAAMnT,KAAKmtC,IAAOntC,EAAAA,KAAKmtC,IACnCntC,GAAAA,KAAKq8D,SAASlpD,MAAMnT,KAAK6T,MAAS7T,EAAAA,KAAK6T,MACvC7T,GAAAA,KAAKo8D,YAAcp8D,KAAKivB,SAG1BvT,UAAU1T,KAlXI6mB,GAAAA,ICxBT,QAAP6uC,sBACUC,SAAmB,IAAWnwB,EAAG,EACjC,GAAAxtC,KAAA49D,UAAoB,IAAWpwB,EAAG,EAClC,GAAAxtC,KAAA69D,YAAsB,IAAWrwB,EAAG,EACpC,GAAAxtC,KAAA89D,aAAuB,IAAWtwB,EAAG,EActC,GAAAuwB,kBAAgCp0C,EACrCzmB,GAAA,MAAqB6nB,EAAMizC,EAAAA,eAAez8C,UACpBwJ,EAAMizC,EAAAA,eAAex8C,WAC1BuJ,EAAMkE,EAAAA,SACRlE,EAAMvR,EAAAA,OACJuR,EAAMkzC,EAAAA,oBAElBN,SAAe1V,EAAS7nD,EAAI89D,EAAeC,EAAGlW,EAAS5nD,EAAI+9D,EAAgBC,EAChFr+D,GAAAA,KAAK29D,SAAW39D,KAAK29D,SAAS/oD,OAAiBC,EAE/C7U,GAAAA,KAAK49D,UAAgB3V,EAAS7nD,EAAI89D,EAAeC,EAAGlW,EAAS5nD,EAAI+9D,EAAgBC,EACjFr+D,GAAAA,KAAK49D,UAAY59D,KAAK49D,UAAUhpD,OAAiBC,EAEjD7U,GAAAA,KAAK69D,YAAkB5V,EAAS7nD,EAAI89D,EAAeC,EAAGlW,EAAS5nD,EAAI+9D,EAAgBC,EACnFr+D,GAAAA,KAAK69D,YAAc79D,KAAK69D,YAAYjpD,OAAiBC,EAErD7U,GAAAA,KAAK89D,aAAmB7V,EAAS7nD,EAAI89D,EAAeC,EAAGlW,EAAS5nD,EAAI+9D,EAAgBC,EACpFr+D,GAAAA,KAAK89D,aAAe99D,KAAK89D,aAAalpD,OAAiBC,EAEvDujD,GAAA,MAAsBzuC,EAAO5H,EAAAA,yBAAyB/hB,KAAK29D,UACpCh0C,EAAO5H,EAAAA,yBAAyB/hB,KAAK49D,WACnCj0C,EAAO5H,EAAAA,yBAAyB/hB,KAAK69D,aACpCl0C,EAAO5H,EAAAA,yBAAyB/hB,KAAK89D,mBAC1DQ,SAAW,GAAAt+D,KACXu+D,SAAW,GAAAv+D,KAEXs+D,SAAStrE,KAAmBoN,EAAGo+D,EAAep+D,EAAGq+D,EAAiBr+D,EAAGs+D,EAAkBt+D,EAC5FJ,GAAAA,KAAKu+D,SAASvrE,KAAmBqN,EAAGm+D,EAAen+D,EAAGo+D,EAAiBp+D,EAAGq+D,EAAkBr+D,EAE5FL,GAAAA,KAAK2+D,MAAQ5sE,KAAKwL,IAAI7F,MAAM,KAAMsI,KAAKs+D,UACvCt+D,KAAK4+D,MAAQ7sE,KAAKwL,IAAI7F,MAAM,KAAMsI,KAAKu+D,UACvCv+D,KAAK6+D,MAAQ9sE,KAAKuL,IAAI5F,MAAM,KAAMsI,KAAKs+D,UACvCt+D,KAAK8+D,MAAQ/sE,KAAKuL,IAAI5F,MAAM,KAAMsI,KAAKu+D,UAEvC,MAAiB50C,EAAOrI,EAAAA,yBAAyB,IAAWthB,EAAAA,KAAK2+D,MAAO3+D,KAAK4+D,QAC5Dj1C,EAAOrI,EAAAA,yBAAyB,IAAWthB,EAAAA,KAAK6+D,MAAO7+D,KAAK8+D,aACxEC,WAAsB3+D,EAC3BJ,EAAAA,KAAKg/D,WAAsB3+D,EAC3BL,EAAAA,KAAKi/D,WAAsB7+D,EAC3BJ,EAAAA,KAAKk/D,WAAsB7+D,EAE3BA,EAAA,MACEmiC,EAAA,CAAA,IAAWxiC,EAAAA,KAAK2+D,MAAO3+D,KAAK4+D,OAC5B,IAAW5+D,EAAAA,KAAK6+D,MAAO7+D,KAAK4+D,OAC5B,IAAW5+D,EAAAA,KAAK2+D,MAAO3+D,KAAK8+D,OAC5B,IAAW9+D,EAAAA,KAAK6+D,MAAO7+D,KAAK8+D,QAM5BK,GAAe38B,EAAGpiC,GAAIA,EACtB++D,GAAe38B,EAAGpiC,GAAIupB,EAAOrL,EAAAA,OAAO+E,cACpBmf,EAAGniC,GAAIA,EAAK8+D,GAAe38B,EAAGniC,GAAIspB,EAAOrL,EAAAA,OAAOgF,cAEhE,OAAA,EAMA67C,GAAe38B,EAAGniC,GAAIA,EACtB8+D,GAAe38B,EAAGniC,GAAIspB,EAAOrL,EAAAA,OAAOgF,eACpBkf,EAAGpiC,GAAIA,EAAK++D,GAAe38B,EAAGpiC,GAAIupB,EAAOrL,EAAAA,OAAO+E,aAEhE,OAAA,MAIG,IAAQ+7C,EAAGrvE,EAAIovE,EAAe7tE,EAAAA,OAAQvB,IAEvCovE,GAAepvE,EAAGqQ,GAAIA,EACtB++D,GAAepvE,EAAGsQ,GAAIA,EACtB8+D,GAAepvE,EAAGqQ,GAAIupB,EAAOrL,EAAAA,OAAO+E,aACrBtzB,EAAGsQ,GAAIspB,EAAOrL,EAAAA,OAAOgF,aAEpC,OAAA,WAOC5H,UAELC,GAAI8R,EAAAA,YACA7R,EAAAA,YAAoBvE,GAAAA,MAAMpkB,WAC1BosE,EAAAA,KAAKr/D,KAAK++D,WAAY/+D,KAAKg/D,WAAYh/D,KAAKi/D,WAAaj/D,KAAK++D,WAAY/+D,KAAKk/D,WAAal/D,KAAKg/D,YACjGjxC,EAAAA,SAEAvlB,EAAAA,UAAkBmP,GAAAA,IAAI1kB,WACtBw6B,EAAAA,YACAO,EAAAA,IAAIhuB,KAAK29D,SAAY39D,EAAAA,KAAK29D,SAAYt9D,EAAG,EAAa,EAAVtO,EAAAA,KAAK+a,IACjDghB,EAAAA,YACAM,EAAAA,OAEA5lB,EAAAA,UAAkB6P,GAAAA,MAAMplB,WACxBw6B,EAAAA,YACAO,EAAAA,IAAIhuB,KAAK49D,UAAa59D,EAAAA,KAAK49D,UAAav9D,EAAG,EAAa,EAAVtO,EAAAA,KAAK+a,IACnDghB,EAAAA,YACAM,EAAAA,OAEA5lB,EAAAA,UAAkByP,GAAAA,KAAKhlB,WACvBw6B,EAAAA,YACAO,EAAAA,IAAIhuB,KAAK69D,YAAe79D,EAAAA,KAAK69D,YAAex9D,EAAG,EAAa,EAAVtO,EAAAA,KAAK+a,IACvDghB,EAAAA,YACAM,EAAAA,OAEA5lB,EAAAA,UAAkBuP,GAAAA,QAAQ9kB,WAC1Bw6B,EAAAA,YACAO,EAAAA,IAAIhuB,KAAK89D,aAAgB99D,EAAAA,KAAK89D,aAAgBz9D,EAAG,EAAa,EAAVtO,EAAAA,KAAK+a,IACzDghB,EAAAA,YACAM,EAAAA,cChIRkxC,sBACSC,WAAyB,IAEzB7B,GAAAllC,OAAqB7O,EAC1BzmB,GAAA,MAAe6nB,EAAM+B,EAAAA,gBAErB,IAAwBuxC,GAAA,EACI,MAAlBL,EAAAA,iBACYh+D,EAAAA,KAAKu/D,WAAWxB,kBAAyBp0C,EAAAA,IAG/D,IAA2BqsC,GAAA,EACbrsC,GAAO61C,EAAAA,cAAuBA,EAAAA,aAAax/C,QAAiBw/C,EAAAA,aAAax/C,OAAOhC,WAAmB9O,EAAAA,SACvFya,GAAO61C,EAAAA,aAAax/C,OAAOhC,SAAS7C,UAAgBslC,EAAAA,SAASS,SAG5Eue,EAAAA,YAMqB1B,GAAAA,IACrB1xC,EAAAA,KAAK,gBAAiB,IAAuBtB,GAAAA,IAC9C20C,EAAAA,gBAAgB,cAPI3B,GAAAA,IACnB1xC,EAAAA,KAAK,eAAgB,IAAsBtB,GAAAA,IAC5C40C,EAAAA,aAAa,IAAiBC,GAAA,sBCpBnCC,GAAArnC,OAAqB7O,EACrBoB,GAAM+0C,EAAAA,uBAGDC,EAAAA,YAIH7jE,EAAAA,MAAM8jE,SAASC,gCAAgCl1C,WCMxDm1C,eAAmBC,QAAA7lE,KADV6lE,EAAAngE,KAAA9F,KAA0B,4BAOJkG,GAC/BggE,WAAyBA,GAAA,oBAATlmE,EAAAA,WAQhBmmE,eAAmBD,QAAA9lE,KADV8lE,EAAApgE,KAAA9F,KAA4B,8BAOJkG,GACjCkgE,WAAyBA,GAAA,sBAATpmE,EAAAA,WAcLqmE,WAGXC,eAAsC1oE,EAGpC2oE,GAFAnuD,GAAAA,QAYKtS,KAAaugE,GAAO1xC,GAAAA,MAEnB7uB,KAAAk+C,MAAgB,YAiBjBl+C,KAAAqgD,QAAkB,EA0DjBrgD,KAAA0gE,oBAA8C,GAAA1gE,KAC9C2gE,yBAA2B,IAAIhuC,IAC/B3yB,KAAA4gE,2BAA6B,IAAIjuC,IAEjC3yB,KAAA6gE,UAAsB,GAAA7gE,KACtB8gE,WAAuB,GAAA9gE,KAexB+gE,gBAAkB,IAUlBjiB,GAAA9+C,KAAAghE,kBAAoB,IAUnBliB,GAAA9+C,KAAAihE,QAAkB,KAKnBjhE,KAAAkhE,eAAiB,IACjBpiB,GAAA9+C,KAAAmhE,iBAAmB,IAElBriB,GAAA9+C,KAAAohE,UAAsB,GAAAphE,KAoOtBqhE,gBAAiB,EA5WvBrhE,KAAKshE,SACDC,GACFjB,EAAA,IAAK,MAAMkB,KACTxhE,EAAAA,KAAK2/D,aAWD8B,GAAAH,SACJxpE,GAAAA,IACFkI,KAAKk+C,MAGTvlC,GAAA7gB,uBACcomD,MAGdvhB,yBACc7P,gBAWPsrB,YACAiI,QAAS,EAGT0f,uBACQ1f,OAMfqhB,uBACcb,UAOPc,OACLhpD,eAAY+oD,KAAKlwE,SAQZmnB,GAAAipD,OACLjpD,eAAYgnD,aAAa,IAAiBnsE,GAAAA,IAUrCquE,UAAuBC,EAAQ5+D,GAAA,eACxBw8D,gBAAqBoC,EAMnC5+D,GAAA6+D,wBACcjB,WAYNkB,qBACDnB,UAAYl3D,MAAMsH,KAAKjR,KAAK4gE,2BAA2BqB,UACzDziC,QAAc/nC,GAAAA,aAAau1C,KAC3B/rC,KAAWxJ,GAAEyC,EAAAA,YACX4mE,WAAan3D,MAAMsH,KAAKjR,KAAK4gE,2BAA2BvwE,QAGxD6xE,uBACEv4D,MAAMsH,KAAKjR,KAAK4gE,2BAA2BqB,UAO5CE,oBACNniE,QAAKgiE,gBACL,MAAcI,EAAA,IAAmBlC,GAC/BsB,CAAAA,UACAjH,EAAAA,OAAQv6D,YAEL+gE,gBAAgBxhB,UAIf6iB,GAAAC,uBACN1pD,GAAA,MAAgBypD,EAAA,IAAqB/B,GACnCmB,CAAAA,UACAjH,EAAAA,OAAQv6D,YAELghE,kBAAkBzhB,UACvBv/C,GAAAA,KAAKgiE,gBAIP9yD,yBACc+xD,QAUdqB,2BACclB,UAMPmB,gBACItB,UACPjhE,KAAKihE,QAAQ1oC,YAAYv4B,MAAAA,KACpBihE,QAAU,MAQZuB,SACL7pD,GAAsB,GAAA,OAAXzJ,EAAAA,OAQT,MAAM,IAAIxJ,MAAM,+DAPZ1F,GACIA,KADCyiE,eAAejxE,SACtBmnB,GAAA,MAAM,IAAIjT,MAAM,iDAEb07D,UAAUpuE,KACfunE,GAAO0G,EAAAA,QAAUjhE,KAAAA,KACZkhE,eAAe3hB,UAIfv/C,GAAAA,KAOFu4B,YAML5f,UALWzJ,EAAAA,SAAWlP,OACKu6D,EAAQv6D,EAAAA,KAAKohE,WAC/BH,EAAAA,QAAU,KACjBjhE,KAAKmhE,iBAAiB5hB,UAAUgb,IAE3Bv6D,KAMF0iE,gCACAJ,SAASxxD,SAASrZ,SAChB8gC,YAAY9gC,MAEZuI,KAMFyiE,eACL,MAA0BziE,EAAAA,OAC1B,IAAcA,EAAAA,KAAKkP,YAEjBnc,GAAOC,EAAAA,KACP8yC,GAAUA,EAAQ52B,EAAAA,cAENqoD,EAAAA,UAMToL,iBACL,IAAwB3iE,EAAAA,OACDA,EAAAA,YACV1O,EAAAA,OAAY,GACvB,CAAA,MAAasxE,EAAMvyD,EAAAA,MACXuyD,EAAMjnE,EAAAA,OAAY2mE,EAAAA,UACjBvvE,EAAO4I,EAAAA,OAAY2mE,EAAAA,iBAQzBO,EAAA7tD,QACL,MAAkB6tD,EAAA,IAClBC,OAAK,MAAMrrE,KAAAA,KAAUsqE,MACTpC,EAAAA,aAAa3/D,KAAKpL,IAAOogB,GAAAA,aAEhC,MAAM+tD,KAAAA,KAAcT,SACbE,EAAAA,SAAextD,EAAAA,gBAUtB6tD,EAAAG,YAAoClB,EAAiB5+D,GAAA,OACrD,MAAMzL,KAAoByqE,EAAAA,gBAC7BliE,KAAK2/D,aAAe3qD,EAAAA,QAEtB9R,OAAK,MAAM6/D,KAAwBT,EAAAA,SACjCtiE,KAAKwiE,SAAextD,EAAAA,QAAQguD,YAAYD,gBAUrCpD,aAAgDmC,EAAiB5+D,GAAA,GAElElD,GAMOA,KANFpM,IAAcsG,EAAAA,MACrB,CAAA,IAKEgJ,EAAA,OAAAlD,UAHK0/D,gBAQT/mD,GAAI6oD,GAAU9F,EAAAA,cAA0BA,EAAAA,aAAapqE,OACnD,IAAK,MAAM2xE,KAAkBvH,EAAAA,aAC3B17D,KAAK2/D,aAAa,IAItB6B,GAAU/0B,EAAAA,MAAQzsC,KAClB,MAAuBwhE,EAAU70B,EAAAA,wBAC5Bg0B,yBAAyB1nE,IAAoBuoE,EAClDxhE,GAAAA,KAAK4gE,2BAA2B3nE,IAAciB,EAAAA,KAC1CsnE,GAAUlH,EAAAA,OACFA,EAAAA,MAAMt6D,MAAAA,KAEbmiE,oBAEEniE,GAAAA,KAUF0/D,gBAA8FoC,EAAQ5+D,GAAA,UAE1EA,EAAA,iBAC7BlD,EAAAA,KAAKkjE,uBACIC,GAAAA,aAA2BC,IACpCpjE,KAAKkjE,uBAAuChpE,EAAAA,MAG9C8F,KAAK0gE,oBAAoB1tE,KAGpBgN,GAAAA,KAGDkjE,uBACNvqD,GAAI3Y,GACgBA,KADXpM,IAAW+kB,GAClB,CAAA,MAAkB3Y,EAAAA,KAAKpL,IACvB4sE,GAAU/0B,EAAAA,MAAQ,KACJiuB,EAAAA,UACFA,EAAAA,SAAS16D,MAErB,MAAawhE,EAAU70B,EAAAA,iBAClBg0B,yBAAyB0C,OAC9BrjE,GAAAA,KAAK4gE,2BAA2ByC,OAAiBnpE,EAAAA,MACjD8F,KAAKqiE,uBAAuBb,IAQzB8B,8BACA,MAAMH,KAAAA,KAAwBzC,oBACjC,CAAA,MAAwC6C,EAAA,iBAAWJ,EAAkBA,EAAgBjpE,EAAAA,UAChFgpE,uBAEPljE,QAAK0gE,oBAAoBpvE,OASpB,EAAAsC,IACL+kB,0BACS3Y,EAAAA,KAAK4gE,2BAA2BhtE,IAEhCoM,GAAAA,KAAK2gE,yBAAyB/sE,IAYlC+kB,GAAA/jB,IACL+jB,0BACS3Y,EAAAA,KAAK4gE,2BAA2BhsE,IAEhCoL,GAAAA,KAAK2gE,yBAAyB/rE,IASzC+jB,GAAA6qD,gCACcnC,eAUPxqB,YACA72C,QAAKwjE,gBACRxjE,KAAKyjE,aACLnxD,GAAAA,MAAM+Z,KAAK,aAAc,IAAoB1C,GAAQ3pB,EAAAA,OAAAA,KAChDqhE,gBAAiB,GAUnBqC,WAA2Bp6C,EAChCtpB,QAAKqsB,KAAK,YAAa,IAAmB1C,GAAQL,EAAOtpB,EAAAA,OAAAA,KACpD2jE,YAAoBr6C,EASpBpmB,GAAA0gE,YAA4Bt6C,EACjCtpB,QAAKqsB,KAAK,aAAc,IAAoB1C,GAAQL,EAAOtpB,EAAAA,OAAAA,KACtD6jE,aAAqBv6C,EASrBpmB,GAAAugE,aAAa3rC,IASb6rC,YAA6BlrC,EAAAA,IAS7BorC,aAA8BprC,EAAAA,IAY9BD,OAAuBlP,EAC5BtpB,QAAK62C,YACL72C,GAAAA,KAAK0jE,WAAmBp6C,EACxBpmB,OAAK,MAAM6/D,KAAAA,KAAcT,SACjB9pC,EAAAA,OAAelP,EAEvBtpB,QAAK4jE,YAAoBt6C,EAAAA,IAxcZuF,GAAAA,ICtDV,QAAMi1C,WAGXt3B,sBACEl6B,EAAAA,QADiBtS,KAAA8b,KAFHioD,EAAA/jE,KAAA9F,KAAO,YAKrB8F,KAAK8b,KAAgB,QAAT9b,EAAAA,KAAK8b,YAAAA,IAAIkoD,EAAIA,EAAA,iBCAGC,GAC9BC,WAAyCv+B,EAAAA,WAgEzCw+B,eAA4DC,EAAxCC,QAAA/uC,SAAwC4uC,EAAAlkE,KAAAokE,UADrDC,EAAArkE,KAAAskE,SAAiE,GAExExsE,uBACcw9B,SAASx9B,KAWhBysE,KACL5rD,GAAK6rD,GAGH7rD,EAAA,CAAA,IAAmB8rD,EAAA,KACfD,EAAAA,aACIA,GAEAxkE,EAAAA,KAAKokE,UAAUM,WAEvB1kE,GAAAA,KAAKskE,SAAWtkE,KAAKskE,SAAS9kC,QAAchnC,GAAEyrE,EAAAA,UAAYU,SAAAA,KARrDL,SAAShzE,OAmBX,EAAAszE,KAA6DpuE,EAElE0M,GAAA,IAYAi7D,SAbUj7D,EAAA9S,OAAH+c,OAAA,GAEHq3D,GAAAA,aACFG,GAAM3kE,EAAAA,KAAKokE,UAAUS,aAA6B7vD,EAAAA,QAElD2vD,GAAM3kE,EAAAA,KAAKokE,UAAUM,WAChBC,GACHz+D,GAAO2L,EAAAA,cAAcne,MACnB,4CAA4C8wE,0CAC5CxkE,KAAKokE,UAAUU,aAKnB9kE,GAAAA,KAAKskE,SAAStxE,KAAOixE,CAAAA,QAAcztE,EAAAA,QAAAA,IAG5B2nE,GAAA,KASJ4G,IAA4DvuE,EAGjE0M,UAFUA,EAAA9S,OAAH+c,OAAA,GACPnN,GAAAA,KAAKukE,OACEvkE,KAAK4kE,KAAuBpuE,EAQrC0M,GAAA8hE,wBACc1vC,SAAS0vC,MAQvBA,UACEhlE,QAAKs1B,SAAS0vC,MAMhBrsD,EAAAknB,iBACEolC,SAA2B,QAApBjlE,EAAAA,KAAKs1B,SAASuK,cAAAA,IAAMolC,EAAI54D,EAAOmG,EAAAA,KAGxCqtB,WACE7/B,QAAKs1B,SAASuK,OAIXlnB,SAILusD,eAAoBC,QAAAC,WAHZD,EAAAnlE,KAAAqlE,QAA2B,GAAArlE,KAC3BslE,UAAoD,QAGrDxiE,QAAU,IAAkBqhE,GAAErsE,CAAAA,KAAM,UAAWktE,MAAYI,GAChEplE,GAAAA,KAAKulE,eAAevlE,KAAK8C,SAEpBuhB,OACL1L,GAAA,MAAc6sD,EAAA,IAAkBhvE,GAASwJ,EAAAA,KAAKolE,wBAClCG,eAYPC,GAAA5wE,IACL+jB,UACS3Y,EAAAA,KAAKylE,UAEPzlE,GAAAA,KAAKqlE,QAGPzxE,IACL+kB,UAAO7gB,KAAAA,KAAawtE,UAGdC,eACN5sD,eAAS2sD,UAAgBxtE,EAAAA,MAEhBkI,KAAKslE,UAAgBxtE,EAAAA,OAE9BkI,KAAKslE,UAAgBxtE,EAAAA,MACrBkI,EAAAA,KAAKqlE,QAAQryE,KACbgN,GAAAA,KAAKqlE,QAAQjmE,MAAM7H,CAAGC,EAAAA,IAAQwtE,EAAAA,MAAUA,EAAAA,QAIlCrsD,GAAA8sD,UACN9sD,eAAY2sD,UAAUxtE,UAOb4tE,WAqDXl5B,eACEl6B,GAAAA,QArDOtS,KAAA9F,KAAO,cAER8F,KAAAokE,UAAgD,QA4BjD5sB,SAAmB,EAKnBx3C,KAAAuI,QAKA,EAAAvI,KAAA6/B,OAAwBrtB,EAAAA,KAKxBxS,KAAA6U,OAAwBnC,EAAAA,KAKxB1S,KAAA6kE,cAAwB,EA6FvB7kE,KAAA2lE,QAAuB,KAxFnBC,EAAAx1E,OAAH+c,OACLqqC,CAAAA,QAASx3C,KAAKw3C,SAIhBouB,GAAA,MAAM9/B,QAAS0/B,EAAA3wD,OAAQspD,EAAA51D,QAAS81D,EAAA7mB,QAASwe,EAAAsO,SAAUlM,EAAAv4B,OAAQwvB,EAAAwV,aAAc1S,EAAA0T,UAAWhkB,EAAAikB,WAAiBtvE,GAErGwJ,OAAKokE,UAAwBhM,GAAA,QACxBv4B,OAASA,MAAAA,EAAU7/B,EAAAA,KAAK6/B,OAC7B7/B,KAAKuI,QAAUA,MAAAA,EAAWvI,EAAAA,KAAKuI,QAC/BvI,KAAK6U,OAASA,MAAAA,EAAU7U,EAAAA,KAAK6U,OAC7B7U,KAAK6kE,aAAeA,MAAAA,EAAgB7kE,EAAAA,KAAK6kE,aACzC7kE,KAAK6lE,UAAYA,MAAAA,EAAa7lE,EAAAA,KAAK6lE,UACnC7lE,KAAK8lE,WAAaA,MAAAA,EAAc9lE,EAAAA,KAAK8lE,WACrC9lE,KAAKw3C,UAELx3C,EAAAA,KAAK+lE,OAAS,IAAmB/lE,GAAAA,MAClBA,GAAAA,KAAKokE,UAAUt+B,IAC5B9lC,KAAK4kE,KAAK5kE,KAAKokE,UAAUt+B,IAnEtB4+B,WACL/rD,eAAYyrD,UAMPzrD,GAAAmsD,kBACE10E,OAAOC,KAAK2P,KAAKokE,WAkE1Bt+B,0BACcigC,OAAOjjE,QAAQwhE,SAM7BA,2BACcF,UAUPrwD,IAAqCkwD,EAC1C/gE,GAAA,IAAW8iE,EAAA,UACiBC,EAAA,4BAE1BnuE,GAAO0sE,EACP0B,EAAejC,EAEfiC,GAAe1B,EAGjBxkE,EAAAA,KAAKokE,UAAkBpkE,GAAAA,KAAK6kE,aAA4B7vD,EAAAA,QAC3CixD,EAAA,YACXjmE,GAAAA,KAAK4kE,KAAK,WAQPqB,EAAArB,KAA6DpuE,EAClE0M,eAAY6iE,OAAOjjE,QAAQ8hE,KAAuBpuE,EAQ7C0M,GAAA6hE,IAA4DvuE,EACjE0M,eAAY6iE,OAAOjjE,QAAQiiE,IAAsBvuE,EAW5C0M,GAAAqhE,KACLvkE,QAAK+lE,OAAOjjE,QAAQyhE,KAItB5rD,GAAAgX,gBACE3vB,QAAK2lE,QAGPhtD,EAAAgX,kBACM3vB,GACKA,KADA2lE,QACP,OAAA3lE,KAAY2lE,QAEd,IAASQ,EAAA,IACTvd,OAAK,MAAMnnD,KAAAA,KAAcskE,OAAOnxE,MAC9B,IAAK,MAAMqvE,QAAS+B,EAAAxvE,QAAEA,KAAmB8tE,EAAAA,SACvC,CAAA,IAAatkE,EAAAA,KAAK6U,OACL7U,EAAAA,KAAK6/B,QACdrpC,MAAAA,OAAAA,EAASqe,EAAAA,UACFre,EAAQqe,EAAAA,SAEfre,MAAAA,OAAAA,EAASqpC,EAAAA,UACFrpC,EAAQqpC,EAAAA,QAEnB,MAAeokC,EAAQt0C,EAAAA,YACNuxB,GAAO15C,EAAAA,MAAgBqM,EAAAA,MAAUgB,EAAOzU,EAAIy/B,EAAOz/B,EAC9D0jB,EAAWo9B,GAAOz5C,EAAAA,OAAiBoM,EAAAA,MAAUgB,EAAOxU,EAAIw/B,EAAOx/B,EACrEmb,EAAKyoD,EAAAA,MAAAA,OAAAA,EAASt0C,EAAAA,YAAYlW,UAAcuK,EAAUviB,EAAMo+B,EAAAA,OAAU/b,EAAUriB,EAAMo+B,EAAAA,OAAOx/B,IAAI2a,QAGjGmrD,UAQKA,EAAA3tC,OAAwBoN,EAA2B1iC,EACxD,OAAK,MAAMzB,KAAAA,KAAcskE,OAAOnxE,MAC9B,IAAK,MAAMqvE,QAAEA,KAAmBK,EAAAA,SACVL,GAAAA,KAClBA,MAAAA,GAASt+B,EAAAA,KAAcC,EAAAA,WC9YpBwgC,WACXC,eACE/zD,GAAAA,MACAtS,GAAAA,KAAKwH,MAAgBA,EAAAA,MACrBxH,KAAKyH,OAAiBA,EAAAA,OACtBzH,KAAK60B,YAGA7f,eACE,IAAcsxD,GAAAl2E,OAAD+c,OAAA/c,OAAA+c,OAClB3F,CAAAA,MAAOxH,KAAKwH,MACZC,OAAQzH,KAAKyH,aACLioB,uBAAAA,KACAwE,uBAIZa,QACM/0B,QAAKoW,OACH8iB,EAAAA,SAAY,EAAGl5B,EAAAA,KAAKwH,MAAOxH,KAAKyH,QAElCzH,KAAKqzB,aACHxX,EAAAA,WAAc,EAAG7b,EAAAA,KAAKwH,MAAOxH,KAAKyH,eCvB/ByzD,WAWXmL,sBACE/zD,EAAAA,MAXMi0D,GAAAvmE,KAAAwmE,QAYNxmE,EAAAA,KAAK0zB,QAAyB,QAAfl9B,EAAQk9B,EAAAA,eAAAA,IAAO+yC,EAAIA,EAClCzmE,EAAAA,KAAKmuB,OAAiBA,EAAAA,OACtBnuB,KAAK60B,YAbP1G,yBACcq4C,QAEdr4C,WACEnuB,QAAKwmE,QACLxmE,EAAAA,KAAKwH,MAAQxH,EAAAA,KAAKwmE,QAClBxmE,KAAKyH,OAASzH,EAAAA,KAAKwmE,QACnBxmE,KAAKgzB,YASAhe,eACE,IAAW0xD,GAAAt2E,OAAD+c,OAAA/c,OAAA+c,OACfghB,CAAAA,OAAQnuB,KAAKmuB,aACLuB,uBAAAA,KACAwE,uBAIZa,QACM/0B,QAAKmuB,OAAS,IACZV,EAAAA,YACAO,EAAAA,IAAIhuB,KAAKmuB,OAAQnuB,KAAKmuB,OAAQnuB,KAAKmuB,OAAqB,EAAVp8B,EAAAA,KAAK+a,IAEnD9M,KAAKoW,OACHgY,EAAAA,OAGFpuB,KAAKqzB,aACHtF,EAAAA,eCXA44C,GA4BAC,GAoCAC,GAMAC,MA5FVC,uUC8IKC,SAAMC,WAwVXnE,eACExwD,GAAAA,QAvKMtS,KAAAknE,QAAwB76D,GAAOqG,EAAAA,MAAa1S,GAAAA,KAAKmnE,oBAAoBtnE,UAoDrEwgC,SAUD,EAAArgC,KAAA08B,OAAwB7qB,EAAAA,cAKxB7R,KAAAonE,MAAe,KAEfpnE,KAAAqnE,OAAsC,QAQtCrJ,eAA2B,KAK1Bh+D,KAAAsnE,YAAsB,EACtBtnE,KAAAunE,WAAqB,EAErBvnE,KAAAwnE,yBAA2B,UAC5BD,WAAY,GAGXvnE,KAAAynE,uBAAyB,UAC1BF,WAAY,GAGXvnE,KAAA0nE,wBAA2BrpC,SACxBkpC,YACPvnE,KAAKsI,IAASq/D,EAAAA,QAAQC,eAIlB5nE,KAAA6nE,yBAA4BxpC,SACzBkpC,YACPvnE,KAAKsI,IAASq/D,EAAAA,QAAQC,eA6BnB5nE,KAAA8nE,OAAkB,GAAA9nE,KAoBlB8/D,sBAAgC,EAKhC9/D,KAAA+nE,eACLC,CAAAA,mBAAmB,EACnBC,mBAAmB,QA6HbC,sBACN,yKAYMC,mBACN,2GAQMC,mBACN,8FAxIA,MAAMtwE,KACAuwE,EACJjoE,EAAC4lE,EACD3lE,EAAC4lE,EAAA39D,IACEggE,EAAAz0D,MACE00D,EAAA/gE,MACAw/D,EAAAv/D,OACCmtD,EAAAzmC,OACAq6C,EAAA/nB,SACEgoB,EAAAj+B,IACLlI,EAAA6K,IACA5K,EAAAtT,SACKwT,EAAAyJ,gBACOvJ,EACf6Q,EAAC5Q,EAAAxsB,MACIysB,EAAA2U,QACEpqB,EAAAvY,OACDiuB,EAAAsd,cACOjzB,EAAAu7C,eAEXC,GAAAv4E,OAAH+c,OAAA,GAIDnN,QAAKshE,SACLthE,GAAAA,KAAK6U,OAASA,MAAAA,EAAUoyD,EAAM2B,GAAAA,SAAS/zD,OAAOG,QAE9ChV,KAAK2/D,aAAa,IAAIxsB,IACtBnzC,KAAKsI,IAAMA,MAAAA,EAAOuK,EAAIzS,EAAAA,MAAAA,EAAK4lE,EAAG3lE,EAAAA,MAAAA,EAAK4lE,EACnCjmE,GAAAA,KAAKivB,SAAWA,MAAAA,EAAYwT,EAC5BziC,EAAAA,KAAK6T,MAAQA,MAAAA,EAAShB,EAAI6F,EAAG,EAC7B1Y,GAAAA,KAASwzC,EAAAA,MAAAA,EAAK5Q,EAEd5iC,EAAAA,KAAK2/D,aAAa,IAAI+F,IACtB1lE,KAAK2/D,aAAa,IAAwBkJ,IAACltD,CAAK2N,EAAAA,IAAUtpB,KAAK8b,KAAUwN,EAAAA,WACpEq2C,aAAa,IAAIzyB,IACtBltC,KAAKwqC,IAAMA,MAAAA,EAAOn+B,EAAOmG,EAAAA,KACzBxS,KAAKmtC,IAAMA,MAAAA,EAAO9gC,EAAOmG,EAAAA,KACzBxS,KAAKksC,gBAAkBA,MAAAA,EAAmBvJ,EAE1C3iC,EAAAA,KAAK2/D,aAAa,IAAI3f,IACtBhgD,KAAKkI,KAAKk4C,cAAgBA,MAAAA,EAAiBzN,EAAckJ,GAAAA,QACrD6sB,IACF1oE,KAAKkI,KAAKi4C,MAGRM,GACFzgD,EAAAA,KAAK2/D,aAAa,IAAsBlf,GAAAA,IAExCzgD,EAAAA,KAAK2/D,aAAa,IAAsB/E,GAAMM,GAAAA,OAAel7D,EAAAA,KAAK6U,UAAAA,KAE7D8qD,aAAa,IAAsB/E,GAAMC,GAAAA,IAAIrzD,MAAAA,EAASw/D,EAAGv/D,EAAAA,MAAAA,EAAUmtD,EAAG50D,EAAAA,KAAK6U,UAAAA,KAG7E2iC,QAAUA,MAAAA,GAEXphC,EAAAA,IACFpW,KAAKoW,MACD5O,EAASC,GACXzH,EAAAA,KAAKskE,SAASvwD,IACZ,IAAcuyD,GACZlwD,CAAAA,MACA5O,EAAAA,MACAC,EAAAA,OAAAA,KAIJzH,GAAAA,KAAKskE,SAASvwD,IACZ,IAAW2yD,GACTtwD,CAAAA,MACA+X,EAAAA,OAAAA,MAOEvc,EAAAA,UAAiBxM,EAAAA,gBAEzBpF,KAAK8nE,OAAO90E,KAAK,IAAIssE,IAEvBt/D,KAAK8nE,OAAO90E,KAAK,IAAI6sE,IAGrB7/D,KAAKm4C,QAAU,IAAkBn4C,GAAAA,MAjanCkI,uBACctT,IAAIorD,IAMlBlmC,4BACcllB,IAAIu+C,IAMlBkC,yBACczgD,IAAIs4C,IAMlBo3B,2BACc1vE,IAAI8wE,IAMlBjlB,2BACc7rD,IAAI4kE,IAMlBlxD,sBACcwR,UAAUxR,IAMxBA,QACEtI,QAAK8Z,UAAUxR,IAAa0M,EAAAA,QAM9BmxC,yBACcj+C,KAAKi+C,OAMnBA,WACEnmD,QAAKkI,KAAKi+C,OAAOhzC,MAAa/S,EAAG0oE,EAAOzoE,EAM1CA,GAAAmqC,sBACc6K,OAAO7K,IAMrBA,QACExqC,QAAKq1C,OAAO7K,IAAax1B,EAAAA,QAM3BknD,yBACch0D,KAAKg0D,OAMnBA,WACEl8D,QAAKkI,KAAKg0D,OAAO/oD,MAAa/S,EAAG2oE,EAAO1oE,EAO1CA,GAAA8sC,sBACckI,OAAOlI,IAMrBA,QACEntC,QAAKq1C,OAAOlI,IAAan4B,EAAAA,QAM3BmnD,WACEn8D,QAAKkI,KAAKi0D,OAAOhpD,MAAa/S,EAAG4oE,EAAO3oE,EAM1CA,GAAA87D,yBACcj0D,KAAKi0D,OAMnBltC,2BACcnV,UAAUmV,SAMxBA,aACEjvB,QAAK8Z,UAAUmV,SAMjBtW,EAAAuzB,kCACcmJ,OAAOnJ,gBAMrBA,oBACElsC,QAAKq1C,OAAOnJ,gBAGdvzB,EAAA9E,wBACcjf,IAAIu+C,IAAoBt/B,MAGtCA,UACE7T,QAAKpL,IAAIu+C,IAAoBt/B,MAe/B8E,EAAA9D,yBACcqyD,QAGdryD,WACE7U,QAAKknE,QAAgBr0D,GAAMhT,GAAMG,GAAAA,KAAKmnE,oBAAoBtnE,UACrDsnE,oBAGCxuD,GAAAwuD,oBACFnnE,QAAKskE,WACPtkE,KAAKskE,SAASzvD,OAOlB8D,GAAA8mD,8BACckC,OAAO,aAOrBnqB,0BACc8sB,SAAS9sB,QAGvBA,YACEx3C,QAAKskE,SAAS9sB,QAYhB7+B,EAAApQ,0BACc83B,SAGd93B,YACEvI,QAAKqgC,SAwDP1nB,EAAAswD,4BACc3B,WAGd2B,cACMC,GAAAA,IACEA,IAAgBlpE,KAAKsnE,YACvBtnE,KAAQyjB,GAAA,mBAAoBzjB,KAAKwnE,0BACjCxnE,KAAQyjB,GAAA,iBAAkBzjB,KAAKynE,wBAC/BznE,KAAQyjB,GAAA,kBAAmBzjB,KAAK0nE,yBAChC1nE,KAAQyjB,GAAA,mBAAoBzjB,KAAK6nE,4BACR7nE,GAAAA,KAAKsnE,aAC9BtnE,KAAKof,IAAI,mBAAoBpf,KAAKwnE,0BAClCxnE,KAAKof,IAAI,iBAAkBpf,KAAKynE,wBAChCznE,KAAKof,IAAI,kBAAmBpf,KAAK0nE,yBACjC1nE,KAAKof,IAAI,mBAAoBpf,KAAK6nE,2BAGpC7nE,KAAKsnE,WAeT3uD,GAAAvC,wBACc2c,OAEd3c,UACEpW,QAAK+yB,OAAW/d,EAAAA,QAwHXyuD,aAAa3rC,IAWb+e,YACLvkC,GAAAA,MAAMukC,YACNl+B,OAAK,MAAMoqD,KAAAA,KAAcT,SACjBzrB,EAAAA,YAoCFl+B,GAAAwwD,sBACNxwD,GAAI2T,GACF3T,EAAA,CAAA,MAAqC2T,EAAU1xB,EAAAA,eAES,IAApDoF,KAAKkoE,sBAAsBz2E,QAAQ23E,KAAAA,KAChCtJ,sBAAuB,GAEyB,IAAjD9/D,KAAKmoE,mBAAmB12E,QAAQ23E,KAAAA,KAC7BrB,eAAeC,mBAAoB,IAGW,IAAjDhoE,KAAKooE,mBAAmB32E,QAAQ23E,KAAAA,KAC7BrB,eAAeE,mBAAoB,KAoEtC37C,GAAmB5B,EAC3B1qB,QAAKmpE,sBACL72D,GAAAA,MAASga,GAAW5B,EAiEfxnB,GAAAwpB,KAAwBhC,EAC7B1qB,QAAKmpE,sBACL72D,GAAAA,MAAMoa,KAAgBhC,EA8DjBxnB,GAAAkc,IAAuBsL,EAC5BpY,GAAAA,MAAM8M,IAAesL,EAWhBxnB,GAAAmmE,SACL/2D,GAAAA,MAAM+Z,KAAK,UAAW,IAAiBrsB,GAAAA,OAAAA,KAClCspE,UAQA3wD,GAAA2wD,UAAUC,IAUVC,UACLl3D,GAAAA,MAAM+Z,KAAK,WAAY,IAAkBrsB,GAAAA,OAAAA,KACpCypE,WAQA9wD,GAAA8wD,WAAWF,IAQXnxB,YACIgvB,OACPpnE,KAAKqpE,SAASrpE,KAAKonE,OACnBpnE,KAAKqsB,KAAK,OAAQ,IAAcrsB,GAAAA,OAChCsS,MAAM8lC,OACNp4C,KAAKwpE,UAAUxpE,KAAKonE,QAEpBpnE,KAAK08B,OAAOz1B,KAAK,sDAOdyiE,cACArpB,QAAS,EAMT0f,uBACQ1f,OAqBRspB,WACLl2E,GAAMA,EAAIR,EAAAA,WACN+M,KAAKg+D,iBAAmBh+D,KAAKqnE,OAAe5zE,KACtB,MAApBuM,KAAKqnE,OAAO5zE,IACduM,KAAKqnE,OAAYtlC,GAAAA,QACjB/hC,KAAKg+D,eAAiBh+D,KAAKqnE,OAAO5zE,IAE3Boe,EAAAA,cAAcne,MAAM,6BAA6BD,qBAAAA,KAGnDuqE,gBAAkBh+D,KAAKg+D,0BAA0Bn3B,IACxD7mC,KAAKg+D,eAAer4B,KAyBjB,GAAAikC,aACoB,IAArBr2E,UAAUjC,QACZ0O,KAAKqnE,OAAe9zE,UAAU,IAAMA,UAC/ByM,GAAAA,KAAKg+D,iBACRh+D,KAAKg+D,eAAiBzqE,UAAU,MAG9BA,UAAU,aAAcmwC,IAC1B1jC,KAAK4pE,WAAW,UAAWr2E,UAAU,IAEnCA,UAAU,aAAcgtC,IAC1BvgC,KAAK4pE,WAAW,UAAWr2E,UAAamxC,GAAAA,aAS9C8O,oBACc5+C,IAAIu+C,IAUXK,EAAAq2B,wBACOj1E,IAAIu+C,IASlBK,EAAas2B,MACX9pE,QAAKpL,IAAIu+C,IAAwB22B,EAW5BnxD,EAAAoxD,UACL/pE,QAAKpL,IAAIu+C,IAAwB62B,EAMnCrxD,EAAAa,oBACS,IAAWxZ,EAAAA,KAAKsI,IAAQtI,EAAAA,KAAKwH,MAAYxH,EAAAA,KAAK6U,OAAW7U,EAAAA,KAAKwH,MAAOxH,KAAKsI,IAAQtI,EAAAA,KAAKyH,OAAazH,EAAAA,KAAK6U,OAAW7U,EAAAA,KAAKyH,QAGlID,wBACci5C,SAAS9wB,YAAYnoB,MAAQxH,KAAKiqE,iBAGhD7pE,EAAAqH,yBACcg5C,SAAS9wB,YAAYloB,OAASzH,KAAKiqE,iBAQ1C5pE,EAAA6pE,gCACOt1E,IAAIu+C,IAAoBW,eAQ/BmqB,2BACOrpE,IAAIu+C,IAAoBS,UAM/Bq2B,6BACOr1E,IAAIu+C,IAAoBU,YAW/BpkC,SAAoBpP,EAAW8pE,EAAmBp6E,GAAA,GACvD,MAAc8iB,EAAIzS,EAAGC,EACfogD,GAAWzgD,EAAAA,KAAKpL,IAAI4kE,IACjBhhC,EAAAA,SACT,MAAoBioB,EAAS7rD,EAAAA,MAAM6a,SAEnC26D,UAEIC,EACArqE,GAAAA,KAAKsiE,SAASgI,MACLvH,GAAMtzD,EAAAA,SAAYpP,EAAG6C,GAAA,KAa7BqnE,EAAAC,OAAqBh3D,EAC1BtQ,GAAA,MAAiBlD,EAAAA,KAAKpL,IAAI4kE,IACJzuC,EAAMn2B,EAAAA,IAAI4kE,WAChB5kE,EAAAA,MAAMy0D,sBAAoCz0D,EAAAA,OAAOsvD,aAa5DhhD,EAAAs1B,OAAuBlP,EAC5BtpB,QAAK62C,YACL72C,GAAAA,KAAK0jE,WAAmBp6C,EAGxBpmB,GAAA,MAAgBlD,EAAAA,KAAKg+D,eACNyM,GAAAA,aAAmB5jC,IACxBlB,EAAAA,KAAYhc,EAAOK,EAAAA,MAAM0gD,UAAUtsE,IAI7C4B,KAAKm4C,QAAQ3f,OAGbt1B,OAAK,MAAMynE,KAAAA,KAAc7C,OACjBtvC,EAAAA,OAAOx4B,KAAcspB,EAQ7BtpB,QAAK4jE,YAAoBt6C,EAQpBpmB,GAAAygE,YAA6BlrC,EAAAA,IAS7BorC,aAA8BprC,EAAAA,IAU9BirC,WAA2Bp6C,EAChCtpB,QAAKqsB,KAAK,YAAa,IAAmB1C,GAAQL,EAAOtpB,EAAAA,OAAAA,KACpD2jE,YAAoBr6C,EASpBpmB,GAAA0gE,YAA4Bt6C,EACjCtpB,QAAKqsB,KAAK,aAAc,IAAmB1C,GAAQL,EAAOtpB,EAAAA,OAAAA,KACrD6jE,aAAqBv6C,EAWrBpmB,GAAA4Y,KAAoCwN,EAIzCpmB,GAFAyY,GAAIqU,EAAAA,OAEAhwB,KAAKg+D,eACHvkD,CAAAA,EAAAA,WAAYzZ,KAAKwH,MAAQxH,KAAK6U,OAAa7U,GAAAA,KAAKyH,OAASzH,KAAK6U,OAElE7U,GAAAA,KAAK4qE,SAActhD,EACnBpmB,GAAA,MAAgBlD,EAAAA,KAAKg+D,eAEJh+D,GAAAA,KAAKwH,MAAgBA,EAAAA,MAAgBqM,EAAAA,MAAW7T,GAAAA,KAAK6U,OAChEiP,EAAW9jB,GAAAA,KAAKyH,OAAiBA,EAAAA,OAAiBoM,EAAAA,MAAW7T,GAAAA,KAAK6U,OAExE7U,OAAKg+D,eAAeliD,KAAOH,CAAAA,IAAKvb,EAAG4jB,EAAS3jB,EAAGyjB,EAASvb,EAAAA,QAASvI,KAAKuI,eAEtEvI,GAGmBA,KAHd4qE,SAActhD,EACftpB,GAAAA,KAAKoW,OAASpW,KAAKygD,SAErB,CAAA,MAAiBzgD,EAAAA,KAAKpL,IAAI4kE,IACjBhhC,EAAAA,SACK0oB,EAAAA,OAAO3nC,sBAEfgqB,EAAAA,YAAcvjC,KAAKuI,QACd3T,EAAAA,MAAMknB,KAAU9b,EAAAA,KAAKoW,MAAWsC,EAAG,EAAA,KAI9C4X,EAAAA,UACJtwB,KAAK6qE,UAAevhD,EAQfpmB,GAAA2iE,UAA0CptC,EAAAA,IAS1CqtC,WAA2CrtC,EAAAA,IAU3CmyC,SAAwCthD,EAC7CtpB,QAAKqsB,KAAK,UAAW,IAAiB1Q,GAAK2N,EAAOtpB,EAAAA,OAAAA,KAC7C6lE,UAAev8C,EASfpmB,GAAA2nE,UAAyCvhD,EAC9CtpB,QAAKqsB,KAAK,WAAY,IAAiB1Q,GAAK2N,EAAOtpB,EAAAA,OAAAA,KAC9C8lE,WAAgBx8C,EAQhBpmB,GAAAwY,UAAU1T,KA9lCH4gE,GAAAA,SACZ/zD,CAAAA,OAAenC,EAAAA,MAsMjBo4D,GADC94D,CAAW5J,EAAAA,CAAAA,QAAS,2CAA4C6J,gBAAiB,6DAkBlF64D,GAJC94D,CACC5J,EAAAA,CAAAA,QAAS,2CACT6J,gBAAiB,6DA8jBnB64D,GAJC94D,CACC5J,EAAAA,CAAAA,QAAS,8CACT6J,gBAAiB,uFAsCnB64D,GAJC94D,CACC5J,EAAAA,CAAAA,QAAS,8CACT6J,gBAAiB,8DAiCnB64D,GAJC94D,CACC5J,EAAAA,CAAAA,QAAS,6CACT6J,gBAAiB,qEAwBnB64D,GAJC94D,CACC5J,EAAAA,CAAAA,QAAS,6CACT6J,gBAAiB,2EChgCR84D,WAMXC,eACE14D,GAAAA,MAAMliB,OAAD+c,OAAA,GAAMm4B,IACXtlC,KAAKpL,IAAIu+C,IAAoBI,WAAwBt2B,GAAAA,OACrDjd,KAAK8nE,OAAS,GAAA9nE,KACT8nE,OAAO90E,KAAK,IAAI6sE,IACrB7/D,KAAK6U,OAAa6D,EAAG,EACrB1Y,GAAAA,KAAKkI,KAAKk4C,cAA8BxE,GAAAA,iBACxC57C,KAAKygD,SAASka,eAAe36D,KAAKwH,MAAOxH,KAAKyH,OAAQzH,KAAK6U,QAC3D7U,KAAK8/D,sBAAuB,EAGvBjpB,YACL72C,QAAK83B,QACLxlB,EAAAA,MAAMukC,YAGDl+B,GAAAlJ,SAAoBpP,EAAW4qE,EAAoBl7E,GAAA,GACpDk7E,GACFl7E,EAAA,OAAOuiB,MAAM7C,SAAYpP,EAG3B6C,GAAA,MAAelD,EAAAA,KAAK83B,QAAQ/V,yBAAyB,IAAW3hB,EAAGC,EAAAA,WAC5DiS,MAAM7C,SAAgBrP,EAAG8qE,EAAO7qE,EAAAA,UCMzC8qE,eAA8CC,EAAmBC,EAAmBC,EAClFlB,GA9BM,GA8ByBpqE,KA9BzBwd,QAAiB3L,EAAAA,cAElB7R,KAAa5B,GAEZ,EAAA4B,KAAAq3C,aACA,EAAAr3C,KAAAurE,gBAEA,EAAAvrE,KAAAwrE,UAAW,EAEXxrE,KAAAyrE,eAGD,EAAAzrE,KAAAorE,SACA,GAAAprE,KAAAqrE,SAAmB,EACnBrrE,KAAA0rE,oBAEC,EAAA1rE,KAAA2rE,WAAY,EAIb3rE,KAAAonE,MAAe,KAUD,mBACjBwE,EAAA,CAAA,MAAgBC,EAChBA,EAAMr1E,EAAQq1E,EAAAA,IACHr1E,EAAQ40E,EAAAA,SACT50E,EAAQ60E,EAAAA,QACA70E,EAAQ80E,EAAAA,gBAGtBA,GAAmBA,GAAmBlB,GAAA,IAC1CpqE,KAAK0rE,mBACAL,GACHS,GAAA,MAAM,IAAIpmE,MAAM,8DAIVqmE,GAAMC,GAAAA,UAChBhsE,KAAKorE,SAAuBprE,GAAAA,KAAKorE,SACjCprE,KAAKqrE,QAAqBrrE,GAAAA,KAAKqrE,QAE/BrrE,KAAKisE,WAAa,GAGhBjsE,GAAAA,KAAQ6rE,GAnCZD,GAAAM,2BACcP,UA0CJE,GACR7rE,QAAKisE,WAAWj5E,KAOX2lB,GAAAyG,IACLzG,GAAA,MAAc3Y,EAAAA,KAAKisE,WAAWx6E,QAC9BuO,QAAKisE,WAAWlhE,OAAcohE,EAOzB,GAAA3zC,OACDx4B,QAAKwrE,WACPxrE,KAAKurE,iBACLvrE,EAAAA,KAAKq3C,cAEDr3C,EAAAA,KAAK0rE,oBAAsB,GAAK1rE,KAAKyrE,gBAAkBzrE,KAAK0rE,qBAC9D1rE,KAAK2rE,WAAY,EACjB3rE,KAAKwrE,UAAW,EAChBxrE,KAAKq3C,aAAe,IAGjBr3C,KAAKksE,UAAYlsE,KAAKq3C,cAAgBr3C,KAAKorE,WAC9CprE,KAAKisE,WAAWn7D,SAASrZ,IACrB5F,EAAAA,KAAKmO,SAGTA,KAAKyrE,iBACDzrE,KAAKqrE,UAGPrrE,KAAK2rE,WAAY,EACjB3rE,KAAKwrE,UAAW,GAHhBxrE,KAAKq3C,aAAe,IAiBrBtV,MAA4BqqC,EAKjClpE,GAJMmpE,GAAeA,GAAe1zD,GAAA,IAClC3Y,KAAKorE,SAGDprE,GAAAA,KAAK0rE,oBAAsB1rE,KAAK0rE,oBAAsB,IAC1D1rE,KAAK0rE,mBACA1rE,GAAAA,KAAKqrE,SACR,MAAM,IAAI3lE,MAAM,8DAIfimE,WAAY,EACjB3rE,KAAKq3C,aACLr3C,EAAAA,KAAKyrE,eAGP,EAAAa,gCACcb,eAGPc,6BACOhB,gBAMdiB,mCACWN,SAGFlsE,EAAAA,KAAKorE,SAAWprE,KAAKq3C,aAM9Bo1B,8CACcp1B,aAGdq1B,4BACclB,SAMPmB,oBACAnB,UAAW,EACTxrE,KAQF4sE,eACApB,UAAW,EAMXjnD,qBACAinD,UAAW,EACTxrE,KAMFglB,oBACKoiD,OACRpnE,KAAKwd,QAAQvW,KAAK,0EAGpBjH,KAAKwrE,UAAW,EACZxrE,KAAKksE,WACPlsE,KAAK2rE,WAAY,EACjB3rE,KAAKq3C,aACLr3C,EAAAA,KAAKyrE,eAGAzrE,GAAAA,KAMF+oC,mBACAyiC,UAAW,EAChBxrE,KAAKq3C,aACLr3C,EAAAA,KAAKyrE,eACEzrE,EAAAA,KAMF+wD,cACA4b,QACD3sE,KAAKonE,OACPpnE,KAAKonE,MAAMyF,YAAY7sE,OAxNZgsE,GAAAA,QA0Kf,4TAAAc,CADC96D,CAAW5J,EAAAA,CAAAA,QAAS,6BAA8B6J,gBAAiB,2DCxIpE86D,eAA0CvwC,EAAqBwwC,GAAA,QAAnC78E,KA3CpB88E,EAAAjtE,KAAAwd,QAAiB3L,EAAAA,cA4BlB7R,KAAA1F,KAAyB,IAAI68B,MAgBlCn3B,KAAKkkC,UAAY,IAAa/zC,GAAM88E,EAAA,OAAQzwC,IACnC0wC,EAAAA,SAAS,SAAgBA,EAAAA,SAAS,UAAAltE,KACpCwd,QAAQvW,KAAK,iEAAiE9W,yCAErF6P,KAAKmtE,MAAQ,IAAIzoE,SAA2BC,SACrCs/B,eAAiBt/B,KA3C1B6C,wBACcypB,MAAM6P,aAMpBr5B,yBACcwpB,MAAM8P,cAOb9I,wBACS39B,KAAK88B,IAOrBnG,wBACc32B,KA0BR06B,4CACAh1B,GACKA,KADAi4B,WACP,OAAAj4B,KAAY1F,SAIZ,IACA8yE,EAAKptE,GACGokC,KADEj0C,KAAKqB,SAAS,eAIhBwO,EAAAA,KAAK7P,SAHX,CAAA,MAAMi0C,QAAAA,KAAkBF,UAAUlP,OAC5BiG,EAAAA,IAAIoJ,gBAMZgpC,GAAA,MAAcA,EAAA,IAAIl2C,MACZC,EAAAA,IAAMmN,QACAC,EAAAA,SAGZxkC,KAAK1F,KACL+yE,EAAA,MAAAC,SACM5oE,QAAQE,OAAO,qCAGlBq/B,eAAejkC,KAAK1F,MAClB0F,KAAK1F,qSAMPizE,kBACSt8D,GAAAA,KAAKjR,+BAQnB2Y,GAAA,MAAc00D,EAAA,IAAgBh8C,GAAIlhC,EAAAA,aAC1B8nC,EAAAA,WACA39B,EAAAA,KAAWA,EAAAA,KAEbumC,EAAAA,OAAOrc,MAAK,KACRlqB,EAAAA,KAAWA,EAAAA,QASvB+yE,EAAAG,cACOlzE,KAAO,IAAI68B,aC9FPs2C,WAWX38C,wBACExe,EAAAA,MACAtS,GAAAA,KAAKixB,MAAgBA,EAAAA,MACrB,MAAMzpB,MAAOkmE,EAAAjmE,OAAajR,GAC1BwJ,OAAK2tE,WAA+B,QAAlBn3E,EAAQm3E,EAAAA,kBAAAA,IAAUN,EAAMjtE,EAAAA,CAAGA,EAAGC,EAAGA,EAAGmH,EAAAA,MAAOA,MAAAA,EAASkmE,EAAGjmE,EAAAA,OAAQA,MAAAA,EAAUmmE,EAC3F5tE,QAAK6tE,SAA2B,QAAhBr3E,EAAQq3E,EAAAA,gBAAAA,IAAQC,EAAMtmE,EAAAA,CAAAA,MAAOA,MAAAA,EAASkmE,EAAGjmE,EAAAA,OAAQA,MAAAA,EAAUmmE,EAC3E5tE,QAAK+tE,0BACL/tE,KAAKixB,MAAMk8C,MAAM3oD,MAAK,UACfupD,yCAbPp1D,UAAO,IAAWq1D,GAChB/8C,CAAAA,MAAOA,IAgBH88C,wCACNxD,EAAA,MAAQ/iE,MAAoBC,EAAAA,OAAyBzH,GAAAA,KAAKixB,WAGrD08C,WAAWnmE,OAAuB,QAAfxH,EAAAA,KAAK2tE,kBAAAA,IAAUM,OAAA,EAAEzmE,EAAAA,QACzCxH,EAAAA,KAAK2tE,WAAWlmE,QAAwB,QAAfzH,EAAAA,KAAK2tE,kBAAAA,IAAUO,OAAA,EAAEzmE,EAAAA,SAG1CzH,EAAAA,KAAK6tE,SAASrmE,OAAqB,QAAbxH,EAAAA,KAAK6tE,gBAAAA,IAAQM,OAAA,EAAE3mE,EAAAA,SAAwB,QAAfxH,EAAAA,KAAK2tE,kBAAAA,IAAUS,OAAA,EAAE5mE,EAAAA,QAC/DxH,EAAAA,KAAK6tE,SAASpmE,QAAsB,QAAbzH,EAAAA,KAAK6tE,gBAAAA,IAAQQ,OAAA,EAAE5mE,EAAAA,UAAyB,QAAfzH,EAAAA,KAAK2tE,kBAAAA,IAAUpD,OAAA,EAAE9iE,EAAAA,SAEjEzH,EAAAA,KAAKwH,MAAQzV,KAAK4L,KAAKqC,KAAK6tE,SAASrmE,OACrCxH,KAAKyH,OAAS1V,KAAK4L,KAAKqC,KAAK6tE,SAASpmE,QAG9BooB,SAAuCzvB,EAAWC,EACtDL,QAAKixB,MAAMgH,YAAAA,KACR81C,0BAEPz7D,MAAMud,SAAazvB,EAAGC,EAGjBtQ,GAAA+/B,WAAyC1vB,EAAWC,EACrDL,QAAKixB,MAAMgH,aAAAA,KACR81C,0BACFt7C,EAAAA,UACDzyB,KAAKixB,MAAMA,MACXjxB,KAAK2tE,WACL3tE,EAAAA,KAAK2tE,WACL3tE,EAAAA,KAAK2tE,WAAWnmE,MAChBxH,KAAK2tE,WAAWlmE,OAEhBpH,EACAL,EAAAA,KAAK6tE,SAASrmE,MACdxH,KAAK6tE,SAASpmE,iCAUlBkR,GAAA,MAAY21D,EAAO3tC,EAAAA,QACL4tC,EAAYC,GAAAA,kBAC1BC,UAAO,IAAWT,GAChB/8C,CAAAA,MACA08C,EAAAA,WACEvtE,CAAGkuE,EAAOluE,EACVC,EAAGiuE,EAAOjuE,EACVmH,EAAAA,MAAcA,EAAAA,MACdC,OAAeA,EAAAA,gCAYnBkR,GAAA,MAAc21D,EAAOr9C,EAAAA,MACTy9C,EAAA,IAAYz9C,GAAM9gC,EAAAA,aAC1BmK,EAAAA,KAAa22B,EAAAA,MAEV,IAAiBI,GAAKi9C,EAAOX,EAAAA,WAAcW,EAAOX,EAAAA,WAAcW,EAAOX,EAAAA,WAAWnmE,MAAcmmE,EAAAA,WAAWlmE,QAG7GuN,eACE,IAAWg5D,GAAA59E,OAAD+c,OACf8jB,CAAAA,MAAOjxB,KAAKixB,MACZ08C,WAAYv9E,OAAF+c,OAAA,QAAYwgE,YACtBE,SAAUz9E,OAAF+c,OAAA,QAAY0gE,gBACZn+C,0BLhHZq3C,GAJU4H,KAAQC,GAAA,KAIlBC,GAAA,KAIA9H,GAAA+H,IAAA,MAIA/H,GAAAgI,GAAA,KAIAhI,GAAAiI,GAAA,KAIAjI,GAAAkI,QAAA,aAUAlI,GAAAA,EAAAj7D,KAAA,OAIAi7D,EAAAh7D,MAAA,QAIAg7D,EAAAmI,OAAA,SAKAnI,EAAAz/C,MAAA,QAKAy/C,EAAAoI,IAAA,OAtBUxI,KAASyI,GAAA,cAgCnBrI,GAAAA,EAAAn7D,IAAA,MAKAm7D,EAAAsI,QAAA,UAIAtI,EAAAuI,OAAA,SAIAvI,EAAAwI,WAAA,aAOAxI,EAAAyI,YAAA,cAMAzI,EAAAl7D,OAAA,UA9BU+6D,KAAS6I,GAAA,cAqCnB1I,GAAAA,EAAA2I,OAAA,SACA3I,EAAA4I,OAAA,SACA5I,EAAA6I,QAAA,WAHU/I,KAASgJ,GAAA,cAOnB9I,GAAAA,EAAA+I,YAAA,MACA/I,EAAAgJ,YAAA,OAFUjJ,KAASkJ,GAAA,WM1BnBC,eAEEC,EACAC,EACAC,EACAC,EACAC,EAjDMC,QAAAC,SAAqB,GAAAxwE,KACrBi3B,OAAyB,KACzBj3B,KAAAywE,SACA,EAAAzwE,KAAA0wE,MACA,EAAA1wE,KAAA2wE,SACA,EAAA3wE,KAAA4wE,UACA,EAAA5wE,KAAA6wE,SA6CN,EAAA,IAA6BC,GAAA,EACzBC,GAAAA,aAAkCpnE,MACpC3J,KAAKwwE,SAAWO,IAEgBA,GAAAA,aAAkCxwC,IAQhEvgC,KAAKi3B,OACLj3B,EAAAA,KAAKywE,SACLzwE,EAAAA,KAAK0wE,MACL1wE,EAAAA,KAAK2wE,SACL3wE,EAAAA,KAAK4wE,UACL5wE,EAAAA,KAAK6wE,SAAsBN,GAAA,IAZ3BvwE,KAAKywE,SAAkCP,EAAAA,QACvClwE,KAAK0wE,MAA+BP,EAAAA,KACpCnwE,KAAK2wE,SAAkCP,EAAAA,QACvCpwE,KAAK4wE,UAAmCP,EAAAA,SACxCrwE,KAAKi3B,OAAgChG,EAAAA,MACrCjxB,KAAK6wE,SAAkCP,EAAAA,SASzCtwE,GAAAA,KAAKwwE,SAAW,IAAI7mE,MAAM3J,KAAKywE,SAAWzwE,KAAK0wE,OAC/BI,GAAA,GAId9wE,KAAKixB,iBAA0B4S,GACjC,CAAA,IAA4BmtC,GAAA,EACCC,GAAA,EACzBjxE,GAIMA,KAJDixB,MAAMgH,WAGb,CAFAi5C,GAAelxE,EAAAA,KAAKowE,QAAUpwE,KAAKkwE,QAAUlwE,KAAKixB,MAAMA,MAAM6P,aAC9C9gC,EAAAA,KAAKqwE,SAAWrwE,KAAKmwE,KAAOnwE,KAAKixB,MAAMA,MAAM8P,cAE3DiwC,EAAA,MAAM,IAAIG,WAEN,mCAAGnxE,KAAKkwE,kBAAkBlwE,KAAKowE,oBAAoBpwE,KAAKixB,MAAMA,MAAM6P,wCAItEswC,GACFH,EAAA,MAAM,IAAIE,WAEN,oCAAGnxE,KAAKmwE,eAAenwE,KAAKqwE,qBAAqBrwE,KAAKixB,MAAMA,MAAM8P,2CAOxEswC,GACFP,EAAA,CAAA,MAAgB9wE,EAAAA,KAAKsxE,2BAEhB,IAAUL,EAAGM,EAAMvxE,EAAAA,KAAKmwE,KAAMoB,IACjC,IAAK,IAAUC,EAAGC,EAAMzxE,EAAAA,KAAKkwE,QAASuB,IACpCzxE,KAAKwwE,SAAee,EAAMvxE,EAAAA,KAAKkwE,SAAW,IACxClwE,GAAAA,KAAKixB,MACCjxB,EAAAA,KAAKowE,QAAkBrtD,EAAAA,OAAeutD,EAAQ79E,EAAAA,KAC9CuN,EAAAA,KAAKqwE,SAAmBttD,EAAAA,OAAeutD,EAAQv3D,EAAAA,IACrD/Y,KAAKowE,QACLpwE,KAAKqwE,WAUfC,0BACcO,SAMdjsC,6BACkB4rC,UAMlBv/C,wBACcgG,OAMdi5C,0BACcO,SAMdN,uBACcO,MAMdN,0BACcO,SAMdN,2BACcO,UAOPU,+BACLE,yBAA4BxxE,KAAZswE,QAEZ79E,CAAAA,KAAMuN,KAAKswE,QACXv3D,IAAK/Y,KAAKswE,QACVvtD,OAAQ/iB,KAAKswE,UAIb79E,KAAuB,QAAjBuN,EAAAA,KAAKswE,QAAQ79E,YAAAA,IAAIu+E,EAAIA,EAC3Bj4D,EAAAA,IAAqB,QAAhB/Y,EAAAA,KAAKswE,QAAQv3D,WAAAA,IAAGk4D,EAAIA,EACzBluD,EAAAA,OAA2B,QAAnB/iB,EAAAA,KAAKswE,QAAQvtD,cAAAA,IAAMyuD,EAAIA,EAY9B,GAAAE,sBAAsCC,EAAmB9sC,EAC9D90C,GAAA,IAAuB4hF,EAAQ1wE,EAAAA,KACtBjB,GAAAA,KAAK4kC,QAAQrzC,YAGbw1C,EAAO9lC,EAAAA,KAAI,SAClB2wE,UAAS58D,EAAAA,WAEJ,IAAc2U,GAAQod,EAAQlC,EAYhC90C,GAAA8hF,oBAAoCC,EAAoBC,EAAkBltC,EAC/E/6B,GAAA,IAAa9J,EAAAA,KAAK4kC,QAAQtyC,MAAkBy/E,EAI5ChiF,UAHSg3C,EAAO9lC,EAAAA,KAAI,SAClB+wE,UAASh9D,EAAAA,WAEJ,IAAc2U,GAAQod,EAAQlC,EAShC/6B,GAAAmoE,mBAAmCptC,EACxC3hC,GAAA,MAAgBlD,EAAAA,KAAK4kC,QAAQ3jC,KAAI,SAC/BixE,UAASl9D,EAAAA,kBAEJ,IAAc2U,GAAQib,EAASC,EAQjC3hC,GAAAivE,UACLx5D,GAAIpnB,GAASonB,GAAKpnB,GAAQyO,EAAAA,KAAK4kC,QAAQtzC,OACrC,OAAA0O,KAAY4kC,QAEZjsB,GAAA,MAAM,IAAIjT,MAAM,kBAYbiT,GAAAy5D,qBAAqCC,EAAiCxtC,EAC3E90C,GAAA,IAAuBuiF,EACnBC,EAAoBC,EACxB,EAAA,MAA0BC,EAAA,IAAI9oE,MAAwBrY,EAAAA,YACjD,IAAQohF,EAAG3iF,EAAIsiF,EAAkB/gF,EAAAA,OAAQvB,IAC5C,CAAA,MAAcsiF,EAAkBtiF,EAEhC4iF,GAAM1hD,EAAAA,MAAcA,EAAAA,OAASjxB,KAAKixB,MACvBl/B,EAAAA,KAAKuL,IAAcq1E,EAAMpxD,EAAAA,WACxBxvB,EAAAA,KAAKuL,IAAeq1E,EAAMnxD,EAAAA,YAC9BzxB,EAAK2iF,GAAA,IAAWC,GAG1BC,GAAA,MAAaC,EAAA,IAAclpD,GAAQib,EAASC,EAI5C90C,UAFKwxB,EAAAA,UACLuxD,EAAKtxD,EAAAA,WACEsxD,EAgCXD,GAAA,IAAAE,GAAA,cAqCE9C,eAEE+C,EACAC,EACA/C,EACAC,EACAC,EACAC,EACAC,EAEAh+D,GAAAA,MACEguB,aACIuD,GACA5S,CAAAA,MACAm/C,EAAAA,QACAC,EAAAA,SACAF,EAAAA,KACAD,EAAAA,QACAI,EAAAA,QAAoB4C,GAEpB5yC,GAxDAoyC,GAAA1yE,KAAAmzE,cAA6Bh8D,GAAAA,MAC7BnX,KAAAozE,gBACA,EAAApzE,KAAAqzE,cAAwC,QAGxCC,eAAyB,EACzBtzE,KAAAuzE,kBAA4B,EAC5BvzE,KAAAwzE,iBAAgCr8D,GAAAA,MAChCnX,KAAAyzE,mBAAgD,QAChDC,eACA,EAAA1zE,KAAA2zE,eAiDFrzC,GAAmBA,GAAAA,aAAyBC,KACnCD,EAAc0yC,EAAAA,SACP1yC,EAAc2yC,EAAAA,iBAGlCjzE,KAAKgzE,SACLhzE,EAAAA,KAAKizE,gBACLjzE,EAAAA,KAAKqzE,cAAgBrzE,KAAK4zE,iBAMrBA,iBACL,MAA0CC,EAAA,OACrC,IAAQC,EAAG/jF,EAAIiQ,EAAAA,KAAKgzE,SAAS1hF,OAAQvB,IACxC,CAAA,IAAWiQ,EAAAA,KAAKgzE,SACZhzE,QAAKizE,kBACAc,EAAKn5E,EAAAA,eAEPm5E,EAAQ/zE,GAAAA,KAAK4kC,QAAW5vB,GAAAA,eAW5B6+D,EAAAG,cAA+BlwD,EAAiBmwD,EACrDj0E,QAAKszE,eAAgB,EACrBtzE,KAAK0zE,eACL1zE,EAAAA,KAAK2zE,eACL3zE,EAAAA,KAAKwzE,iBAA+Bx+D,EAAAA,QACpChV,KAAKuzE,kBAAmB,MACnB,MAAMW,KAAAA,KAAkBb,cAC3BrzE,KAAKyzE,mBAAgCzzE,GAAAA,KAAKqzE,cAAyBr+D,GAAAA,QAOhEm/D,cACLn0E,QAAKszE,cACD7vD,EACFzjB,GAAAA,KAAKg0E,cAAiB,EAAGh0E,EAAAA,KAAKwzE,kBAO3B13D,KAAoCs4D,EAAch0E,EAAWC,EAAW7J,EAG7EmM,GAFAnM,GAAUwJ,EAAAA,KAAKq0E,cAEXr0E,GAAAA,KAAKmzE,cAAclgF,aAAuBmjB,EAAAA,MAAMnjB,YAAAA,KAAmBmgF,kBAA4B7qE,EAAAA,QACjGvI,MAAKozE,gBAA0B7qE,EAAAA,QAC/BvI,KAAKmzE,cAAwB/8D,EAAAA,UACxB,MAAM29D,KAAAA,KAAaV,cACtBrzE,KAAKqzE,cAAoBvxC,GAAAA,eACzB9hC,KAAKqzE,cAAoBjlD,GAAAA,KAAahY,EAAAA,OACtCpW,KAAKqzE,cAAoB9qE,GAAAA,QAAgBA,EAAAA,SAIzCvI,GACSs0E,KADJhB,eAAiBtzE,KAAKuzE,kBAAoBvzE,KAAKwzE,iBACtD,KAAK,MAAMc,KAAAA,KAAwBb,mBACjCzzE,KAAKyzE,mBAAoC3xC,GAAAA,eACzC9hC,KAAKyzE,mBAAoCryC,GAAAA,UAAU,IAAiBphC,GAAAA,KAAKwzE,iBAAiBx+D,eAEvFu+D,kBAAmB,EAI1B,MAAevzE,EAAAA,KAAK4kC,QAGdn9B,GAAS6mE,EAAO7mE,EAAAA,OAGRjR,EAAQ+9E,EAAAA,SAEhBjjF,EAAS8iF,EAAK9iF,EAAAA,OAAgBkW,EAAAA,MAAgB4sE,EAAK9iF,EAAAA,OAAiBkjF,EAAAA,cAE1E,IAAYp0E,EACR5J,EAAQi+E,EAAAA,YAAwB3oE,GAAAA,MAAgB2oE,EAAAA,YAAwBntD,GAAAA,MAClElnB,EACC5J,EAAQi+E,EAAAA,YAAwB1oE,GAAAA,OAAiB0oE,EAAAA,YAAwBtF,GAAAA,IAC1E/uE,EAAI9O,EACHkF,EAAQi+E,EAAAA,YAAwBvF,GAAAA,SACjC9uE,EAAI9O,EAASojF,EAGvB,GAAA,IAAYr0E,EAAIoH,EAASoM,EACrBrd,EAAQm+E,EAAAA,YAAwB/oE,GAAAA,KAAe+oE,EAAAA,YAAwBtF,GAAAA,QACjEhvE,EAER7J,EAAQm+E,EAAAA,YAAwBnF,GAAAA,aACxBmF,EAAAA,YAAwB9oE,GAAAA,QACxB8oE,EAAAA,YAAwBpF,GAAAA,WAExBlvE,EAAIoH,EAASoM,EACZrd,EAAQm+E,EAAAA,YAAwBrF,GAAAA,SACjCjvE,EAAKoH,EAASoM,EAAS+gE,EAGjC,OAAK,IAAQC,EAAG9kF,EAAIqkF,EAAK9iF,EAAAA,OAAQvB,IAC/B,CAAA,IAAgBqkF,EAAKrkF,EACjBiQ,QAAKizE,kBACKiB,EAAUt5E,EAAAA,wBAIb04E,gBACPtzE,KAAKyzE,mBAA8B3zC,GAAAA,kBAAmB,EACtD9/B,KAAKyzE,mBAA8B5/D,GAAAA,MAAYA,EAAOA,EACtD7T,GAAAA,KAAKyzE,mBAA8B33D,GAAAA,KAAUg5D,EAAQ90E,EAAAA,KAAK0zE,eAAwB1zE,EAAAA,KAAK2zE,iBAGzF,MAAmB3zE,EAAAA,KAAKqzE,cACxB0B,GAAWj1C,EAAAA,kBAAmB,EACnBjsB,EAAAA,MAAYA,EAAOA,EAC9BkhE,GAAWj5D,EAAAA,KAAUg5D,EAAOE,EAC5BF,GAASC,GAAWxzD,EAAAA,UAAoBizD,EAAAA,cACxC,MACAtuE,GAAO2L,EAAAA,cAAcne,MAAM,iCAAiCwgF,KAK1DG,cACN17D,UACE47D,SAAkBA,EAAAA,UAClBC,GAAAA,cAAuBA,EAAAA,eACvBp+D,EAAAA,MAAeA,EAAAA,OAAee,GAAAA,MAC9Bs9D,WAA0BA,EAAAA,UAAmDA,EAAAA,WAC7EE,WAA0BA,EAAAA,UAAqDA,EAAAA,WAC/EM,SAAkBA,EAAAA,WAClB1sE,EAAAA,QAAiBA,EAAAA,SAAW,KAzMXwqE,oUA/ShBjC,EA+SgBoE,CAJtBljE,CACC5J,EAAAA,CAAAA,QAAS,yCACT6J,gBAAiB,8BAENkjE,UCxPXC,eAXQC,QAAA73D,QAAiB3L,EAAAA,cACT7R,KAAA4kC,QAAoB,GAWlC,MAAMA,QAAS0wC,EAAAnF,KAAM0E,EAAA3E,QAAc15E,GACnCwJ,OAAK4kC,QACL5kC,EAAAA,KAAKmwE,KAAOA,MAAAA,EAAQ0E,EACpB70E,EAAAA,KAAKkwE,QAAUA,MAAAA,EAAWlwE,EAAAA,KAAK4kC,QAAQtzC,OAQlC6gF,UAAqB9xE,EAC1B6C,GAAI9C,GAAKJ,GAAAA,KAAKkwE,SAAev3D,EAE3B,EAAA,OAAA3Y,KADKwd,QAAQvW,KAAK,2CAA2C7G,MAAMC,UAAUD,6BAA6BJ,KAAKkwE,QAAU,KAClH,KAEL7vE,GAAKL,GAAAA,KAAKmwE,MAAYjtE,EAExB,EAAA,OAAAlD,KADKwd,QAAQvW,KAAK,2CAA2C7G,MAAMC,UAAUA,6BAA6BL,KAAKmwE,KAAO,KAC/G,KAET,MAAoB/vE,EAAIC,EAAIL,EAAAA,KAAKkwE,oBACrBtrC,QAMP2wC,gCACL58D,GAAA,MAAgB68D,EAAkB5wC,EAAAA,QAAQ3jC,KAAiBwsE,GAAOgI,GAAAA,iBAAiBC,YAC5E,IAAgBN,GACrBxwC,CAAAA,QAAAA,+BAUFjsB,GAAA,MAAgBg9D,EAAY/wC,EAAAA,QAAQ3jC,KAAcwsE,GAAOmI,GAAAA,eAAetH,YACjE,IAAsB1pC,GAkCxBixC,iCACLA,EAAA,MAA0BN,EAAA,GAClBjF,EAAAA,QAAyB,QAAf95E,EAAQ85E,EAAAA,eAAAA,IAAOuF,EAAIA,EAAA,GACrC,MAAM5kD,MAEJ6kD,EAAAA,MAAM3F,KAAQD,EAAAA,QAAa6F,EAAAC,YAAaC,EAAAC,aACxC5F,GAAAA,SAAS6F,aAAczB,EAAA3xD,OAAEA,IAErBqzD,EAAiB/zC,EAAAjyC,OAAH+c,OAAK/M,CAAGA,EAAGC,EAAGA,EAAM81E,GAClCE,GAAiBxhB,EAAAzkE,OAAH+c,OAAK/M,CAAGA,EAAGC,EAAGA,EAAM0iB,GACxCuzD,OAAK,IAAQC,EAAGn2E,EAAIo2E,EAAMp2E,EAAAA,IACxB,IAAK,IAAQq2E,EAAGp2E,EAAI8vE,EAAM9vE,EAAAA,IAChBD,EAAIC,EAAIm2E,EAAQT,GAAA,IAAW/H,GACjC/8C,CAAAA,MACA08C,EAAAA,WACEvtE,CAAGA,EAAI41E,EAAcK,EAAej2E,EAAIA,EAAIg2E,EAAeh2E,EAC3DC,EAAGA,EAAI61E,EAAeG,EAAeh2E,EAAIA,EAAI+1E,EAAe/1E,EAC5DmH,EAAAA,MACAC,EAAAA,OAEFomE,GAAAA,SAAYpmE,CAAAA,OAAsBD,EAAAA,MAAOwuE,YAIxC,IAAgBZ,GACrBxwC,CAAAA,QACAurC,EAAAA,KACAD,EAAAA,QAASsG,YCpGbE,uUCnEKT,SAAMU,WA+GX7T,eAA6CziE,EAAWu2E,EAAmBC,EAAoB1G,EAAcqG,EAE3GT,GADAzjE,GAAAA,QA/GMtS,KAAA82E,OACA,EAAA92E,KAAA+2E,gBACA,EAAA/2E,KAAAg3E,cAAwB,KACxBh3E,KAAAi3E,gBACA,EAAAj3E,KAAAk3E,cAAwB,KACxBl3E,KAAAm3E,cAAyD,QAEzDC,iBAAmB,IAAIzkD,IACxB3yB,KAAA08B,OAAwB7qB,EAAAA,cACf7R,KAAA1F,KAAe,GAAA0F,KACvB0wE,MAAkB,GAAA1wE,KAClBq3E,MAAkB,GAAAr3E,KACnBw3C,SAAU,EACVx3C,KAAAs3E,aAAc,EAMbt3E,KAAA6yB,QAAS,EA6FuB0jD,GAAA,iBACpCA,EAAA,CAAA,MAAegB,EACfA,EAAYjyC,EAAOllC,EACnBC,EAAIilC,EAAOjlC,EACXu2E,EAAYtxC,EAAOsxC,EAAAA,UACNtxC,EAAOuxC,EAAAA,WACbvxC,EAAO6qC,EAAAA,KACP7qC,EAAOkxC,EAAAA,UAEX7W,aAAa,IAAIxsB,IACtBnzC,KAAK2/D,aAAa,IAAIzyB,IACtBltC,KAAK2/D,aACH,IAAkB6X,GAChBt9E,CAAAA,KAAoB+hB,GAAAA,cAGnB0jD,aAAa,IAAwBkJ,IAACltD,CAAK2N,EAAAA,IAAUtpB,KAAK8b,KAAUwN,EAAAA,WACpEq2C,aACH,IAAsB8X,GACpB3R,CAAAA,WAAanqD,CAAK2N,EAAAA,IAAUtpB,KAAK8b,KAAUwN,EAAAA,WAG1Cq2C,aAAa,IAAInG,IACtBx5D,KAAKmoD,WAAanoD,KAAKpL,IAAIu+C,IAC3BnzC,KAAK03E,QAAU13E,KAAKpL,IAAIs4C,IACxBltC,KAAK45D,UAAY55D,KAAKpL,IAAI4kE,IAC1Bx5D,KAAK23E,WAAa33E,KAAK45D,UAAUyB,qBAAqB,IAAAr7D,KAErCu3E,EACjBv3E,EAAAA,KAASK,EACTL,EAAAA,KAAK42E,UACL52E,EAAAA,KAAK62E,WACL72E,EAAAA,KAAKmwE,KACLnwE,EAAAA,KAAKw2E,KACLx2E,EAAAA,KAAK1F,KAAO,IAAIqP,MAAmB6sE,EACnCx2E,GAAAA,KAAK0wE,MAAQ,IAAI/mE,MACjB3J,GAAAA,KAAKq3E,MAAQ,IAAI1tE,MACjBosE,GAAA,IAAyBE,EAAA,OACpB,IAAQrB,EAAG7kF,EAAIymF,EAAMzmF,EAAAA,IACxB,KAAK,IAAQ2kF,EAAGliF,EAAI29E,EAAM39E,EAAAA,IACxB,CAAA,MAAWolF,EAAA,IAAS7nF,GAAI6mF,EAAoBW,EAAW/kF,EAAIqkF,EAAax2E,EAAGu2E,EAAWC,EAAY9mF,EAAIyC,EAAIgkF,EAC1GqB,GAAG52E,EAAAA,IAAMjB,KAAAA,KACJ1F,KAAS9H,EAAIgkF,EAAQqB,GAC1BC,EAAW9kF,EAAAA,KACNgN,GAAAA,KAAK0wE,MAAMl+E,KAAAA,KACTk+E,MAAWgE,GAAA,IAAA10E,KAEb0wE,MAAS19E,GAAAA,KAEhBgN,QAAKq3E,MAAWS,GAChBA,EAAa7B,EAAA,QAGVrhF,IAAI8wE,IAAmB/1C,YAAc,IACxCl9B,GAAAA,CAAAA,KACAsmB,EAAAA,IACArmB,EAAAA,MAAOsN,KAAKw2E,KAAOx2E,KAAK42E,UACxB59D,OAAQhZ,KAAKmwE,KAAOnwE,KAAK62E,aArJtB7jD,iBACAH,QAAS,EAOhBzyB,YACE23E,SAA4B,QAArB/3E,EAAAA,KAAKmoD,WAAW7/C,IAAIlI,SAAAA,IAAC23E,EAAIA,EAGlC,EAAa37E,aACQ47E,GAAA,QAAfh4E,EAAAA,KAAKmoD,kBAAAA,IAAU6vB,OAAA,EAAE1vE,EAAAA,OAAAA,KACd1T,IAAIu+C,IAAoB7qC,IAAUlM,EAAK4D,EAAAA,KAAKK,IAIrDA,cACE43E,SAA6B,QAAPA,EAAA,QAAfj4E,EAAAA,KAAKmoD,kBAAAA,IAAU+vB,OAAA,EAAE5vE,EAAAA,IAAIjI,SAAAA,IAAC43E,EAAIA,EAGnC,EAAa77E,aACQ+7E,GAAA,QAAfn4E,EAAAA,KAAKmoD,kBAAAA,IAAUgwB,OAAA,EAAE7vE,EAAAA,OAAAA,KACd6/C,WAAW7/C,IAAUtI,EAAAA,KAAQ5D,EAAAA,IAItCo3C,YACE4kC,SAAwB,QAAjBp4E,EAAAA,KAAKmoD,WAAW3U,SAAAA,IAAC4kC,EAAIA,EAG9B,EAAah8E,aACQi8E,GAAA,QAAfr4E,EAAAA,KAAKmoD,kBAAAA,IAAUkwB,OAAA,EAAE7kC,EAAAA,KAAAA,KACd2U,WAAe/rD,EAIxBuc,GAAAsW,qBACEqpD,SAAgC,QAAVA,EAAA,QAAft4E,EAAAA,KAAKmoD,kBAAAA,IAAUowB,OAAA,EAAEtpD,EAAAA,gBAAAA,IAAQqpD,EAAIA,EAGtC,EAAArpD,oBACqBupD,GAAA,QAAfx4E,EAAAA,KAAKmoD,kBAAAA,IAAUqwB,OAAA,EAAEvpD,EAAAA,YAAAA,KACdk5B,WAAWl5B,SAIpBtW,GAAA9E,kBACE4kE,SAA6B,QAAPA,EAAA,QAAfz4E,EAAAA,KAAKmoD,kBAAAA,IAAUuwB,OAAA,EAAE7kE,EAAAA,aAAAA,IAAK4kE,EAAIpsE,EAAOoG,EAAAA,IAE1CoB,iBACqB8kE,GAAA,QAAf34E,EAAAA,KAAKmoD,kBAAAA,IAAUwwB,OAAA,EAAE9kE,EAAAA,SAAAA,KACds0C,WAAWt0C,MAIpB8E,GAAArQ,sBACc6/C,WAAW7/C,IAGzBA,QACEtI,QAAKmoD,WAAW7/C,IAGlBqQ,EAAA6xB,sBACcktC,QAAQltC,IAGtBA,QACExqC,QAAK03E,QAAQltC,IAQR7xB,EAAG2T,GAAmB5B,EAC3BpY,GAAAA,MAASga,GAAW5B,EA0EfxnB,GAAA2zC,YACLvkC,GAAAA,MAAMukC,YAYDl+B,GAAAigE,oBAAiCjD,EAEpC31E,QAAKm3E,cADHxB,GAAAA,aACwBA,GAEAzyE,EAAAkyE,GAAAyD,sBAOtB31E,GAAA41E,wBACDnB,WAAW5vB,iBAChB,MAAiCgxB,EAAA,GACjC,IAEAC,MAAK,IAAQC,EAAGlpF,EAAIiQ,EAAAA,KAAKw2E,KAAMzmF,IAE7B,KAAK,IAAQmpF,EAAG1mF,EAAIwN,EAAAA,KAAKmwE,KAAM39E,IAEnB,CAAA,IAANA,IACQwmF,EAAA,MAEZ,MAAah5E,EAAAA,KAAK1F,KAAS9H,EAAIwN,EAAAA,KAAKw2E,MAE3B2C,EAAAA,MACFrzC,EAGOA,EAAQ9qB,EAAAA,QAAakmC,EAAAA,QAFhBA,EAAAA,QAOfsH,GAAUx1D,EAAAA,KAEZ8yC,GAAUkzC,EAAA,MAIVlzC,GAEFkzC,EAAA,CAAA,MAAaxwB,EAAUA,EAAUl3D,EAAAA,OAC7B8nF,GAAQA,GAAKrgE,EAAAA,MAAgBA,EAAAA,KAAYC,EAAAA,SAAmBA,EAAAA,OACpDwvC,EAAUl3D,EAAAA,OAAc8nF,GAAKp+D,EAAAA,QAGvCwtC,GAAUx1D,EAAAA,KAAK8yC,SAIhB6xC,WAAa33E,KAAK45D,UAAUyB,qBAAqB,QACjD,MAAM5jE,KACTshF,EAAA,CAAA,MAAiBne,EAAMC,GAAAA,IAAMrzD,EAAAA,MAASC,EAAAA,OAAe+K,EAAAA,KAAU/a,EAAEhF,EAAAA,KAAOuN,KAAKsI,IAAO7Q,EAAEshB,EAAAA,IAAM/Y,KAAKsI,IAAIjI,IAC5FosC,EAAAA,MAAQzsC,KAAAA,KACZ23E,WAAW7vB,YAElB9nD,QAAK45D,UAAUphC,SAMV6gD,eACL1gE,eAAYre,KAKPqe,GAAA2gE,QAAmBj5E,EACxB6C,UAAQyV,EAAKtY,GAAI6C,EAAK9C,GAAKJ,GAAAA,KAAKw2E,MAAax2E,GAAAA,KAAKmwE,KACzC,KAEFnwE,KAAK1F,KAAS+F,EAAIL,EAAAA,KAAKw2E,MAMzB+C,eAA0Bl5E,EAC/BD,GAAIrO,EAAAA,KAAKD,OAAWkO,EAAAA,KAAKsI,IAAStI,GAAAA,KAAK42E,WACnC7kF,EAAAA,KAAKD,OAAWkO,EAAAA,KAAKsI,IAAStI,GAAAA,KAAK62E,YACvC,MAAa72E,EAAAA,KAAKs5E,QAAWj5E,EAC7B6C,UAASyV,GAAKtY,GAAK6C,GAAK9C,GAAIJ,EAAAA,KAAKw2E,MAAYx2E,EAAAA,KAAKmwE,MACzCqJ,EAEFP,EAAA,KAGFQ,sBACO/I,MAGPgJ,yBACOrC,MAGP1T,YAA6BlrC,EAAAA,IAI7BorC,aAA8BprC,EAAAA,IAI9BD,OAAuBlP,EAC5BtpB,QAAK2jE,YAAoBr6C,EACzBtpB,GAAAA,KAAKqsB,KAAK,YAAa,IAA0B1C,GAAQL,EAAOtpB,EAAAA,OAAAA,KACvD6yB,SACP7yB,KAAK6yB,QAAS,EACd7yB,KAAK84E,oBAAAA,KAGFhC,SACL,MAAoBntD,EAAOnH,EAAAA,iBACE3P,EAAIwuC,EAAY5uD,EAAAA,KAAkBsmB,EAAAA,KACjClG,EAAIwuC,EAAY3uD,EAAAA,MAAmBsmB,EAAAA,aAE5D+9D,gBAAkBhlF,KAAKuL,IAAIvL,KAAKD,OAA4BsO,EAAIJ,EAAAA,KAAUA,GAAAA,KAAK42E,WAAgB,EACpG52E,GAAAA,KAAKi3E,gBAAkBllF,KAAKuL,IAAIvL,KAAKD,OAA4BuO,EAAIL,EAAAA,KAAUA,GAAAA,KAAK62E,YAAiB,EACrG72E,GAAAA,KAAKg3E,cAAgBjlF,KAAKuL,IAAIvL,KAAKD,OAA6BsO,EAAIJ,EAAAA,KAAUA,GAAAA,KAAK42E,WAAgB,EACnG52E,GAAAA,KAAKk3E,cAAgBnlF,KAAKuL,IAAIvL,KAAKD,OAA6BuO,EAAIL,EAAAA,KAAUA,GAAAA,KAAK62E,YAAiB,EACpG72E,GAAAA,KAAKmoD,WAAW7/C,IAAUtI,EAAAA,KAAQA,EAAAA,KAElCA,GAAAA,KAAK6jE,aAAqBv6C,EAC1BtpB,GAAAA,KAAKqsB,KAAK,aAAc,IAA2B1C,GAAQL,EAAOtpB,EAAAA,OAQ7D8b,KAA+DwN,EACpEtpB,QAAKqsB,KAAK,UAAW,IAAwB1Q,GAAY2N,EAAOtpB,EAAAA,OAEhE,IAAQA,EAAAA,KAAK+2E,gBACb,MAAahlF,EAAAA,KAAKwL,IAAIyC,KAAKg3E,cAAeh3E,KAAKw2E,MAC/C,IAAQx2E,EAAAA,KAAKi3E,gBACb,MAAallF,EAAAA,KAAKwL,IAAIyC,KAAKk3E,cAAel3E,KAAKmwE,MAE/C,IAAkCwJ,EAAuBC,EAEzDlF,OAAYmF,EAAMz5E,EAAAA,IAChB,MAAY05E,EAAMz5E,EAAAA,IAIhB,IAFWL,EAAAA,KAAKs5E,QAAWj5E,EAAGikE,GAAAA,SAETyV,EAAGH,EAActV,EAAShzE,EAAAA,OAAwBsoF,EAAaD,EAAAA,IAElF,CAAA,MAAgBrV,EAASqV,EACrB1V,GAAAA,IACItoD,aAAeumB,yBAKV+hC,aAAmB+J,KAEvBhuE,KAAKo3E,iBAAiBxjF,IAAIqwE,IAC7BjkE,KAAKo3E,iBAAiBn+E,IAAa+gF,EAAAhM,GAAA4H,eAA+B3R,IAEpEjkE,KAAKo3E,iBAAiBxiF,IAAaknB,GAAAA,KAAU1b,EAAIJ,EAAAA,KAAK42E,UAAe52E,EAAAA,KAAK62E,cATtD5S,GAAAA,KAClBA,MAAAA,GAASt+B,EAAAA,KAAY3lC,EAAAA,KAAK82E,SAEpBh7D,EAAAA,KAAU1b,EAAIJ,EAAAA,KAAK42E,UAAe52E,EAAAA,KAAK62E,cAWnD72E,EAAAA,KAAKi3E,qBAGN5qD,KAAK,WAAY,IAAyB1Q,GAAY2N,EAAOtpB,EAAAA,QA1KpEi6E,GADCjoE,CAAW5J,EAAAA,CAAAA,QAAS,+FA4LV8xE,WAA6BvD,GAAAA,iBAGKt2E,EAAYu2E,EAAoBC,EAAqB1G,EAAeqG,EAC/GlkE,GAAAA,MAAiBjS,EAAGu2E,EAAWC,EAAY1G,EAAMqG,EAAAA,UAOxC2D,WA4DXrX,eAEEziE,EACAmH,EACAC,EACAlW,EACA4nF,EAAiBiB,GAAA,EACcC,EAAA,IAE/B/nE,GAAAA,QAzCMtS,KAAAs6E,QAAS,EAiBDt6E,KAAAskE,SAA+B,GAAAtkE,KAIxC1F,KAAO,IAAIq4B,IAqBsB4nD,GAAA,iBACpCA,EAAA,CAAA,MAAehD,EACfA,EAAYjyC,EAAOllC,EACnBC,EAAIilC,EAAOjlC,EACXmH,EAAQ89B,EAAO99B,EAAAA,MACN89B,EAAO79B,EAAAA,OACR69B,EAAO/zC,EAAAA,MACP+zC,EAAO6zC,EAAAA,MACJ7zC,EAAOV,EAAAA,aAEH2yC,EACjBv3E,EAAAA,KAASK,EACTL,EAAAA,KAAKwH,MACLxH,EAAAA,KAAKyH,OACLzH,EAAAA,KAAKzO,MACLyO,EAAAA,KAAKm5E,MACLn5E,EAAAA,KAAKskE,SACLtkE,EAAAA,KAAK2lE,QAAU,IAAgB3lE,GAAAA,KAAQA,EAAAA,KAAQA,EAAAA,KAASA,EAAAA,KAAKwH,MAAOxH,KAASA,EAAAA,KAAKyH,QAvDpF0xE,wBACcmB,OAKdnB,iBACUqB,EAAA,QAARx6E,EAAAA,KAAKiB,WAAAA,IAAGu5E,GAAExnD,EAAAA,YACVhzB,KAAKs6E,OAkDP3hE,EAAAuoC,yBACcykB,QAGdnsD,oBACS,IAAWxZ,EAAAA,KAASA,EAAAA,KAAKwH,MAAWxH,EAAAA,KAASA,EAAAA,KAAKyH,OAQpD,GAAAgzE,WACLz6E,QAAK06E,WAOA/hE,GAAA+hE,WACDzW,GAAAA,aACFjkE,GAAAA,KAAKskE,SAAStxE,KAAKg7E,GAAAyH,iBAAiCxR,IAEpDjkE,KAAKskE,SAAStxE,KAOX2lB,GAAAgiE,cACLnrE,GAAoBy0D,EAASjkE,EAAAA,KAAKskE,UAM7BsW,qBACAtW,SAAShzE,OA3BhB,GAAA2oF,GADCjoE,CAAW5J,EAAAA,CAAAA,QAAS,6BAA8B6J,gBAAiB,qDAoDzD4oE,WAA0BV,GAAAA,iBAKnC95E,EACAmH,EACAC,EACAlW,EACA4nF,EACAv0C,EAEAtyB,GAAAA,MAAiBjS,EAAGmH,EAAOC,EAAQlW,EAAO4nF,EAAOv0C,EAAAA,UD3hBnDk2C,eAAmBC,QAAA/6D,OAMZ+6D,EAAAC,YACLh7E,QAAKggB,OAAOi7D,YAAY,IAA8BlwD,GAAAA,IAQjDmwD,gBAA8B3wD,EACnCvqB,QAAKggB,OAAOi7D,YAAY,IAAkClwD,GAAOR,EAAAA,IAa5D4wD,eAA6BC,EAA0BC,EAC5Dr7E,QAAKggB,OAAOi7D,YAAY,IAA2BlwD,GAAOqwD,EAAkBC,EAAAA,IAQvEC,kBAAgCntD,EACrCnuB,QAAKggB,OAAOi7D,YAAY,IAA8BlwD,GAAOoD,EAAAA,IAOxDotD,kBACLv7E,QAAKggB,OAAOi7D,YAAY,IAA8BO,GAAAA,MAQxD9E,GADUzvD,KAAIw0D,GAAA,KACd/E,GAAAlpC,EAAA,GAAA,IACAkpC,GAAAA,GAAAj+D,EAAA,GAAA,UAOAijE,eAAmBhF,QAAA1iF,OACZ0iF,EAAA12E,KAAA27E,OAAU3nF,CAAe4nF,EAAcC,EAAcpjD,EAAAA,IACpCjf,EAAAA,cASxBsiE,eAAyCvxD,EAAtBwxD,QAAA/nF,OAAsBgoF,EAAAh8E,KAAAuqB,KAClCwxD,EAAA/7E,KAAA27E,OAAU3nF,CAAeioF,EAAaJ,EAAcpjD,EAAAA,KACzD,MAAezkC,EAAOwlB,EAAAA,OACDyiE,EAAIC,EAAAA,uBAChB3xD,OAAcijB,GACdA,EAAA,IAAWh0B,EAAOpZ,EAAG+7E,EAAa97E,EAElCA,GAAA,IAAW87E,EAAa/7E,EAAGoZ,EAAOnZ,EAAAA,WAkB7C+7E,eAAyChB,EAAiCC,EAAvDgB,QAAAroF,OAAsBsoF,EAAAt8E,KAAAo7E,iBAAiCmB,EAAAv8E,KAAAq7E,eACnEgB,EAAAr8E,KAAA27E,OAAU3nF,CAAeioF,EAAaJ,EAAcpjD,EAAAA,KACzD,MAAiBzkC,EAAOwlB,EAAAA,OACxB,IAAYyiE,EAAIC,EAAAA,WACAD,EAAIzxC,EAAAA,IAAIx1B,QAMxB,MAAgBjN,EAASkM,EAAAA,IAAWJ,GAAAA,MAAM7T,KAAKo7E,kBACnCoB,EAAUzoE,EAAAA,IAItBgmE,GAAA,MAAiByC,EAAU3oE,EAAAA,OAAO,GAAGA,MAAM7T,KAAKq7E,uBACpCmB,EAAUzoE,EAAAA,IAGtB0oE,GAAQA,EAAM1oE,EAAAA,IAEP0oE,GAAAA,UAUTC,eAAyCvuD,EAAtBwuD,QAAA3oF,OAAsB4oF,EAAA58E,KAAAmuB,OAClCwuD,EAAA38E,KAAA27E,OAAU3nF,CAAeioF,EAAaJ,EAAcpjD,EAAAA,KACzD,MAAiBzkC,EAAOwlB,EAAAA,OACVyiE,EAAIC,EAAAA,WAEAn0E,EAASkM,EAAAA,IACrBT,GAAWrH,EAAUwH,EAAAA,KACvBH,GAAYxT,GAAAA,KAAKmuB,OACnB,CAAA,MAAe3a,EAAWxT,EAAAA,KAAKmuB,cAClBpa,EAAAA,IAAcxZ,EAAAA,YAAYsZ,MAAMgsB,WAExC48C,UAsBTI,eAAmBC,QAAA9oF,OAFnB8oF,EAAA98E,KAAA+8E,kBAA4B,EAIrB/8E,KAAA27E,OAAU3nF,CAAqBioF,EAAaJ,EAAcpjD,EAAAA,KAC/D,MAAcwjD,EAAIC,EAAAA,gBAERa,oBACG/jE,EAAAA,OAAgBD,EAAAA,IAAWyI,EAAAA,YAAqB9uB,EAAAA,MAAeD,EAAAA,KAAY8uB,EAAAA,YAC7E1P,EAAAA,cAAc5K,KAAK,gEAE5BjH,KAAK+8E,kBAAmB,GAG1B,IAAaN,EAAMr8E,EACf48E,EAASP,EAAMp8E,EAanBA,SAZUD,EAAIpM,EAAOvB,EAAAA,KAAYgvB,EAAAA,cACtBztB,EAAOvB,EAAAA,KAAYgvB,EAAAA,cACbrhB,EAAIpM,EAAOtB,EAAAA,MAAa+uB,EAAAA,gBAC9BztB,EAAOtB,EAAAA,MAAa+uB,EAAAA,eAGrBphB,EAAIrM,EAAO+kB,EAAAA,IAAW2I,EAAAA,eACrB1tB,EAAO+kB,EAAAA,IAAW2I,EAAAA,eACZrhB,EAAIrM,EAAOglB,EAAAA,OAAc0I,EAAAA,iBAC/B1tB,EAAOglB,EAAAA,OAAc0I,EAAAA,gBAGrBu7D,EAAQD,EAAAA,WAYVE,WAAb1c,qCAGUxgE,KAAAm9E,kBAA2C,GAAAn9E,KAE5Co9E,SAA8B,IAAsBp9E,GAAAA,MAAAA,KAK9Cq9E,GAeN,EAAAr9E,KAAas9E,GAIb,EAAAt9E,KAAau9E,GAKb,EAAAv9E,KAAAivB,SAKA,EAAAjvB,KAAak9D,GAgBZ,EAAAl9D,KAAAw9E,aAAc,EACdx9E,KAAAy9E,KAAwBpxE,GAAOmG,EAAAA,MAAM,IAAAxS,KAAYw9E,aAAc,SAYhEhzC,IAAqBh4B,EAAAA,KAKrBxS,KAAAmtC,IAAqB36B,EAAAA,KAEpBxS,KAAA09E,eAAyB,EACzB19E,KAAAu2C,iBACA,EAAAv2C,KAAAw2C,cAAwB,IACxBx2C,KAAAy2C,WAAqB,KACrBz2C,KAAA02C,SAAmB,KAKjB12C,KAAA29E,YAAsB,EACxB39E,KAAA49E,iBACA,EAAA59E,KAAA69E,iBACA,EAAA79E,KAAA89E,eACA,EAAA99E,KAAA+9E,kBACA,EAAA/9E,KAAAg+E,QACA,EAAAh+E,KAAAi+E,QAEE,EAAAj+E,KAAAk+E,YAAsB,EACxBl+E,KAAAm+E,WACA,EAAAn+E,KAAAo+E,SACA,EAAAp+E,KAAAq+E,iBACA,EAAAr+E,KAAAs+E,cAIA,EAAAt+E,KAAAu+E,YAA8Ch2C,GAAAA,eAC9CvoC,KAAAw+E,QAA0Cj2C,GAAAA,eAE1CvoC,KAAAy+E,WACA,EAAAz+E,KAAA0+E,YAkKA,EAAA1+E,KAAA2f,UAAyB,KA4EzB3f,KAAAqhE,gBAAiB,EA3UzBx+C,uBAIAw6D,GAAAx6D,SACE7iB,QAAU5D,GACN4D,EAAAA,KAAK83B,UACP93B,KAAKy+E,WAAaz+E,KAAK83B,QAAQrW,cAC/BzhB,KAAK0+E,YAAc1+E,KAAK83B,QAAQpW,gBAyBpCwqB,kCAIAgxB,GAAAhxB,oBACElsC,QAAU5O,GAQZunB,EAAArQ,sBACcm1E,KAEdn1E,QACEtI,QAAKy9E,KAAgB5qE,GAAK8F,GAAA,IAAA3Y,KAAYw9E,aAAc,SAC/CA,aAAc,EA+CrBp9E,oBACckI,IAMdlI,EAAahP,MACN4O,QAAK2+E,SAAY3+E,KAAK09E,gBACzB19E,KAAKsI,IAAUlX,EAAO4O,EAAAA,KAAKsI,IAAIjI,IAOnCA,oBACciI,IAMdjI,EAAajP,MACN4O,QAAK2+E,SAAY3+E,KAAK09E,gBACzB19E,KAAKsI,IAAUtI,EAAAA,KAAKsI,IAAOlX,EAAAA,IAO/BwtF,qBACcp0C,IAGdpqC,EAAchP,OACZ4O,QAAKwqC,IAAUp5C,EAAO4O,EAAAA,KAAKwqC,IAM7BnqC,GAAAw+E,qBACcr0C,IAGdnqC,EAAcjP,OACZ4O,QAAKwqC,IAAUxqC,EAAAA,KAAKwqC,IAAOp5C,EAM7BunB,GAAAmmE,qBACc3xC,IAGd/sC,EAAchP,OACZ4O,QAAKmtC,IAAU/7C,EAAO4O,EAAAA,KAAKmtC,IAM7B9sC,GAAA0+E,qBACc5xC,IAGd9sC,EAAcjP,OACZ4O,QAAKmtC,IAAUntC,EAAAA,KAAKmtC,IAAO/7C,EAMtBunB,GAAAujE,uBACO5zE,IAYP02E,KAAkB13C,EAAkB23C,EAA2BvlC,EAAgBnR,GAAAA,gBAC5D,GACtB,mBAAAx4C,EAAA,KAAM,+CAIC4uF,QACAj6E,QAAQE,OAAO0D,IAIpBtI,KAAKk/E,cAAgBl/E,KAAKm/E,cAC5Bn/E,KAAKm/E,aAGPn/E,GAAAA,KAAKk/E,aAAe,IAAIx6E,SAAiBC,SAClCw6E,aAAex6E,KAEtB3E,KAAKy2C,WAAaz2C,KAAKk8E,WAAWlnE,QAClChV,KAAKw2C,cACLx2C,EAAAA,KAAK02C,SACL12C,EAAAA,KAAKu2C,iBACLv2C,EAAAA,KAAK09E,eAAgB,EACrB19E,KAAKw+E,QAEEx+E,EAAAA,KAAKk/E,cASPE,MAA0BC,EAAoB/3C,EACnDtnC,QAAK29E,YAAa,EAClB39E,KAAK49E,iBACL59E,EAAAA,KAAK69E,iBACL79E,EAAAA,KAAK89E,eASA/tF,EAAAuvF,aAA4Bh4C,EAAmBpkC,EAAG+7E,EAA2BvlC,EAAgBnR,GAAAA,4BAC7Fg3C,aAAe,IAAI76E,SAAkBC,SACnC66E,aAAe76E,KAIpB3E,GAAAA,KAAKk+E,YAAa,EAClBl+E,KAAKu+E,YACLv+E,EAAAA,KAAKq+E,iBACLr+E,EAAAA,KAAKs+E,cACLt+E,EAAAA,KAAKm+E,WAAan+E,KAAK6iB,KACvB7iB,KAAKo+E,SAOAp+E,EAAAA,KAAKu/E,eALVv/E,KAAKk+E,YAAa,EAClBl+E,KAAK6iB,KACEne,EAAAA,QAAQC,SAAQ,IAU3BqZ,2BACW2B,UACA3f,KAAK2f,UAGP,IAAgBipC,GAAG,EAAG,EAAG,EAO3B,GAAAqyB,YACLj7E,QAAKm9E,kBAAkBnqF,KAOlB2lB,GAAA8mE,eACLjwE,GAAoBkwE,EAAgB1/E,EAAAA,KAAKm9E,mBAMpCwC,0BACAxC,kBAAkB7rF,OASlB,EAAAoyE,WAA2Bp6C,EAChCtpB,QAAKqsB,KAAK,YAAa,IAAmB1C,GAAQL,EAAOtpB,EAAAA,OAAAA,KACpD2jE,YAAoBr6C,EAQpBpmB,GAAAygE,YAA6BlrC,EAAAA,IAU7BmrC,YAA4Bt6C,EACjCtpB,QAAKqsB,KAAK,aAAc,IAAoB1C,GAAQL,EAAOtpB,EAAAA,OAAAA,KACtD6jE,aAAqBv6C,EAQrBpmB,GAAA2gE,aAA8BprC,EAAAA,IAMrC+qC,gCACcnC,eAGPxqB,YACA72C,QAAKwjE,gBACRxjE,KAAK83B,QACL93B,EAAAA,KAAKy+E,WAAqBh9D,EAAAA,cAC1BzhB,KAAK0+E,YAAsBh9D,EAAAA,eAEtB1hB,KAAKw9E,cACRx9E,KAAKsI,IAAQwvB,EAAQrW,EAAAA,cACrBzhB,KAAKsI,IAAQwvB,EAAQpW,EAAAA,gBAGvB1hB,KAAKyjE,aACLnxD,GAAAA,MAAM+Z,KAAK,aAAc,IAAoByL,GAAS93B,EAAAA,OAAAA,KACjDqhE,gBAAiB,GASnBoC,aAAa3rC,IAOVxL,GAAgB5B,EACxBpY,GAAAA,MAASga,GAAW5B,EAOfxnB,GAAAkc,IAAuBsL,EAC5BpY,GAAAA,MAAM8M,IAAesL,EAOhBxnB,GAAAwpB,KAAwBhC,EAC7BpY,GAAAA,MAAMoa,KAAgBhC,EAGjBxnB,GAAAs1B,OAAwBlP,EAa7BpmB,GAZAlD,GAeU4/E,KAfL/oC,YACL72C,GAAAA,KAAK0jE,WAAoBp6C,EAGzBtpB,GAAAA,KAAKsI,IAAMtI,KAAKsI,IAAIyL,IAAI/T,KAAKwqC,IAAI32B,MAAc3Q,EAAA,MAC/ClD,KAAK6iB,MAAS7iB,KAAUspB,GAASpmB,EAAA,IAEjClD,KAAKwqC,IAAMxqC,KAAKwqC,IAAIz2B,IAAI/T,KAAKmtC,IAAIt5B,MAAc3Q,EAAA,MAC/ClD,KAAKs9E,IAAOt9E,KAAUspB,GAASpmB,EAAA,IAE/BlD,KAAKivB,UAAajvB,KAAKksC,gBAA2BhpC,EAAA,IAE9ClD,KAAKk+E,WACHl+E,GAEI4/E,KAFCvB,iBAAmBr+E,KAAKs+E,cAC/B,CAAA,MACgBuB,EAAAA,KADQtB,YACGv+E,KAAKq+E,iBAAkBr+E,KAAKm+E,WAAYn+E,KAAKo+E,SAAUp+E,KAAKs+E,oBAElFz7D,KACL7iB,EAAAA,KAAKq+E,kBAAoB/0D,OAAAA,KAEpB40D,YAAa,EAClBl+E,KAAK6iB,KAAO7iB,KAAKo+E,SACjBp+E,KAAKq+E,iBACLr+E,EAAAA,KAAKw/E,cAAa,GAIlBx/E,GAEmB05C,KAFdgkC,cACH19E,GACiB05C,KADZnD,iBAAmBv2C,KAAKw2C,cAC/B,CAAA,MAAmBkD,EAAgBomC,GAAAA,2BAA2B9/E,KAAKw+E,QAAhCsB,CAEN9/E,KAAKu2C,iBAAkBv2C,KAAKy2C,WAAYz2C,KAAK02C,SAAU12C,KAAKw2C,oBAEpFluC,IAELtI,EAAAA,KAAKu2C,kBAAoBjtB,MAEzBtpB,MAAKsI,IAAMtI,KAAK02C,SAChB,MAAY12C,EAAAA,KAAK02C,SAAS1hC,aAErByhC,WAAa,KAClBz2C,KAAK02C,SAAW,KAChB12C,KAAKu2C,iBACLv2C,EAAAA,KAAK09E,eAAgB,EAErB19E,KAAKm/E,aAILn/E,QAAK+/E,kBAAAA,KACFpC,YAAa,EAClB39E,KAAK+9E,kBACL/9E,EAAAA,KAAK49E,iBACL59E,EAAAA,KAAK69E,iBACL79E,EAAAA,KAAK89E,eACL99E,EAAAA,KAAKg+E,QACLh+E,EAAAA,KAAKi+E,QAAU,IAEfj+E,KAAK+9E,mBACL/9E,EAAAA,KAAKg+E,QAAYjsF,GAAAA,KAAKuM,SAAW0B,KAAK49E,iBACtC59E,GAAAA,KAAKi+E,QAAYlsF,GAAAA,KAAKuM,SAAW0B,KAAK69E,iBAAoB,QAGvD,MAAM/zE,KAAAA,KAAUqzE,kBACnBn9E,KAAKsI,IAAQqzE,EAAAA,OAAO9pF,KAAQiY,EAAE9V,EAAAA,OAAQgM,KAAespB,EAGvDtpB,QAAK2f,UAAY,IACf3f,GAAAA,KAASA,EAAAA,KAAKy+E,WACdz+E,KAASA,EAAAA,KAAK0+E,YACd1+E,KAASA,EAAAA,KAAKy+E,WACdz+E,KAASA,EAAAA,KAAK0+E,aAGhB1+E,KAAK4jE,YAAqBt6C,EASrBpmB,GAAA4Y,KACLnD,GAAA,IAAkBqnE,EACdr9D,EAAes9D,EACftkE,EAAAA,aAAeumB,0BACHvmB,EAAI2C,EAAAA,OAAO9W,MACVmU,EAAI2C,EAAAA,OAAO7W,SAEZkU,EAAInU,EAAAA,MACHmU,EAAIlU,EAAAA,QAErB,MAAczH,EAAAA,KAAKk8E,WACAl8E,EAAAA,KAAK83B,QAAU93B,KAAK83B,QAAQjZ,WACzCgE,EAAO7iB,EAAAA,KAAK6iB,KAEKJ,EAAcI,EAAOhE,EACtCqhE,EAAkBv9D,EAAeE,EAAOhE,EAE9ClD,EAAI9H,EAAAA,MAAYgP,EAChBlH,GAAIlC,EAAAA,WAAiBrZ,EAAI+/E,EAAiBC,EAAIpgF,EAAAA,KAAKg+E,SAAgB39E,EAAI6/E,EAAkBnG,EAAI/5E,EAAAA,KAAKi+E,SAI7FviE,UAAU1T,IAIT+3E,6BACOpC,YAAc39E,KAAK+9E,mBAAqB/9E,KAAK89E,yBEvtB9B/yD,GAC9Bs1D,UAAOt1D,aCaTggD,GAAA,MAAiDuV,GAC/Ch4E,CAAAA,IAAYkK,EAAAA,KACZhL,MACAC,GAAAA,OACA+vC,GAAAA,SAAS,EACTmkC,OAAQ,OAGRn8C,OAAQ,KAAA,EACR8J,QAAS,SAQEi3C,WAsBXvV,eACE14D,GAAAA,MAAQlS,CAAGogF,EAAKl4E,EAAAA,IAAOjI,EAAGmgF,EAAKl4E,EAAAA,IAAOd,EAAAA,MAAYA,EAAAA,MAAOC,OAAaA,EAAAA,cAlBjEk0E,OAAqB,OAOrB37E,KAAAw/B,OAAqC,KAAA,OAIrC8J,QAQLk3C,EAAOH,EAAYjgF,EAAA,GAAqBogF,GAExCxgF,GAAAA,KAAKw/B,OAAcA,EAAAA,QAAUx/B,KAAKw/B,OAClCx/B,KAAKspC,OAAcA,EAAAA,QAAUtpC,KAAKspC,OAClCtpC,KAAK27E,OAAcA,EAAAA,QAAU37E,KAAK27E,OACzB3nF,EAAAA,SACPgM,KAAKhM,OAAcA,EAAAA,QAGrBgM,KAAKw3C,QAAeA,EAAAA,QACpBx3C,KAAKkI,KAAKk4C,cAA8BvE,GAAAA,QACxC77C,KAAK8sB,gBAAkB,IAAoB9sB,GAAAA,MAAAA,KAEtC28B,OAAUlZ,GAAA,kBAAmB0U,SACvBqH,OAAWvkB,EAAAA,SAAAA,KACboR,KAAK,QAAS,IAAsBrsB,GAAAA,KAAUib,EAAAA,QACnDjb,KAAKygF,kBAEe,IAAhBzgF,KAAKspC,QACPtpC,KAAKo4C,WAKXp4C,KAAK28B,OAAUlZ,GAAA,gBAAiB0U,SACrBqH,OAAWvkB,EAAAA,QAClBjb,KAAKqsB,KAAK,OAAQ,IAAqBrsB,GAAAA,KAAUib,EAAAA,WAKvDjnB,WACEgM,QAAKosB,QACLpsB,EAAAA,KAAKw/B,OAA4BzU,GAAAA,IAGnCpS,EAAA3kB,yBACco4B,QAGPyqB,YACLvkC,GAAAA,MAAMukC,YAGAl+B,GAAA8nE,kBACc,IAAhBzgF,KAAKspC,SACPtpC,KAAK27E,OAAO9pF,KAAKmO,MAAAA,KACZspC,UAKF5tB,UACLpJ,GAAAA,MAAMoJ,UAENC,GAAIqU,EAAAA,OACAvW,EAAAA,UAAUzZ,KAAKsI,IAAOtI,EAAAA,KAAKsI,IAE/BjI,GAAA,MAAWL,EAAAA,KAAKygD,SAASS,OACdlhD,EAAAA,KAAKi+D,eACbxrE,EAAAA,KAAUA,EAAAA,KAAU2N,EACvBob,EAAG9oB,EAAAA,MAAWA,EAAAA,MAAW0N,EACzBob,EAAGzC,EAAAA,IAASA,EAAAA,IAAS1Y,EACrBmb,EAAGxC,EAAAA,OAAYA,EAAAA,OAAY3Y,EAE3Bsb,EAAInT,EAAAA,UAAkBwP,GAAAA,OAAO/kB,WACzB2oB,EAAAA,YAAoB5D,GAAAA,OAAO/kB,WAC3ByV,EAAAA,SAAS,UAAe,GAAA,IACzBgT,EAAAA,UAEHC,GAAI2U,EAAAA,WCvIR,IAAYowD,GACVC,IAAAA,GADUD,KAAUE,GAAA,KACpBC,OAAA,SACAF,GAAAG,KAAA,aAwBFC,sBAkBSC,SAwCA,EAAAxhC,OAAOyhC,WAUdC,eAAmBC,QAAA7mF,KADV6mF,EAAAnhF,KAAA9F,KAAuB,yBAQEkG,GAClCghF,WAAyBA,GAAA,iBAATlnF,EAAAA,WAQhBmnF,eAAmBD,QAAA9mF,KADV8mF,EAAAphF,KAAA9F,KAAyB,2BAOCkG,GACnCkhF,WAAyBA,GAAA,mBAATpnF,EAAAA,WClHhBqnF,eAAoBD,QAAAE,OAHbF,EAAAthF,KAAAyhF,SAAqB,GAAAzhF,KACrB0hF,aAA+C,QAmG9CC,kBAA8B,GA3F/BC,eAAsCC,EAC3C3+E,OAAK,MAAMq3D,KAAAA,KAAeknB,SAEjBjpD,EAAAA,OAAyB7O,EAAAA,OAC3B4wC,GAAOla,EAAAA,QACVrgD,KAAK8hF,aASJ7B,GAAAzgC,OACDuiC,GAAiB35E,GAAAA,IAEnBpI,KAAKwhF,OAAOQ,aAAaC,UAAkB3nF,EAAAA,KAAKigE,QAG3BnyD,GAAAA,IACrBpI,KAAKwhF,OAAOQ,aAAatiB,gBAAwBplE,EAAAA,KAAKigE,OAAgBjgE,EAAAA,KAAKknE,WAQxEygB,UACL1nB,GAAOla,EAAAA,QAAS,EACZka,IAAWv6D,KAAK0hF,aAAoBtjF,EAAAA,MAAAA,KACjCsjF,aAAoBtjF,EAAAA,IACzB4B,EAAAA,KAAKyhF,SAASzuF,KACdgN,GAAAA,KAAKwhF,OAAOQ,aAAaC,UACzB1nB,GAAOwG,EAAAA,gBAAgB9hB,SAASj/C,MACzBghE,EAAAA,kBAAkB/hB,SAASj/C,MAG3BsiE,EAAAA,SAASxxD,SAAe9Q,GAAAA,KAAKiiF,UAAUxqF,KACvCypE,EAAAA,eAAejiB,SACpBO,CAAAA,OAASt8C,SACF++E,UAAU/+E,MAGZi+D,EAAAA,iBAAiBliB,SACtBO,CAAAA,OAASt8C,SACF4+E,aAAgBI,GAAA,OAQtBJ,aAA0CK,EAAWj/E,GAAA,OAC1D+8E,EAAA,IAASmC,EAEPhkF,EADEikF,EAAAA,aACGA,GAAWjkF,EAEXikF,GAEP1pE,EAAA,MAAe3Y,EAAAA,KAAK0hF,aAChBnnB,GAAUA,GAAOla,EAAAA,QACZjI,EAAAA,OAGK+pC,GACZniF,EAAAA,KAAK2hF,kBAAkB3uF,KAAKunE,WAAAA,KAIlBmnB,aACRnnB,GAAAA,IACuBA,EAAQv6D,EAAAA,KAAKyhF,UACtCzhF,KAAKwhF,OAAOQ,aAAaF,aACzBvnB,GAAOwG,EAAAA,gBAAgB5hB,WAAWn/C,MAC3BghE,EAAAA,kBAAkB7hB,WAAWn/C,MAG7BsiE,EAAAA,SAASxxD,SAAe9Q,GAAAA,KAAK8hF,aAAgBK,EAAAA,KAC7CjhB,EAAAA,eAAe5wD,QACf6wD,EAAAA,iBAAiB7wD,SAGQ,QAA3BtQ,EAAAA,KAAKwhF,OAAOjjE,eAAAA,IAAe0hE,OAAA,EAAEt2D,EAAAA,SAC/B3pB,KAAKwhF,OAAOjjE,QAAgBoL,OAAOK,MAAM0gD,UAAU4X,OAAOC,WAM1DC,4BACA,MAAMjoB,KAAAA,KAAeonB,kBACbthC,EAAAA,QAGXrgD,KAAK8hF,aAAqBW,GAAA,GAIvBC,+BACA,MAAMnoB,KAAAA,KAAeknB,SACjBne,EAAAA,0BAIJqf,QACLhqE,eAAY+oE,aAGP/oE,GAAAiqE,UACLjqE,eAAY8oE,SAASjiD,QAAYt8B,GAAEpL,EAAAA,OAG9B6gB,IAAArI,YACA,MAAMiqD,KAAAA,KAAeknB,SACxBzhF,KAAK8hF,aAAavnB,ICtIjB,MAAsBwH,GACf8gB,GAAA,IAAWzjF,GAAAA,MAAM7H,CAAGC,EAAAA,IAAQsrF,EAAAA,cAActrF,KAAIuF,KAAK,WCapDgmF,WAaXjkC,eACExsC,GAAAA,QAZMtS,KAAAgjF,UAAsB,GAalBH,EAAA,aAAc9sF,SACtBiK,KAAK+hE,MAAsC9gE,EAAAA,KAAIgiF,IAAM,IAAQ/oF,GAAAA,YAExD6nE,MAdT8gB,EAAApvF,sBACWyvF,KACAljF,KAAKkjF,KAENljF,KAAKkjF,KAAoBljF,GAAAA,KAAK+hE,OAmBjCohB,YAILxqE,UAFE3Y,GAAAA,KAAKgjF,UAAU5jF,KAEVY,GAAAA,KAAKgjF,UAOPf,UAAU1nB,IACIv6D,EAAAA,KAAKgjF,UAAWzoB,IAAWv6D,KAAKojF,QAAQ7oB,KAAAA,KACpDyoB,UAAUhwF,KACfgN,GAAAA,KAAKu/C,UAAU,IAAgBgb,GAAAA,KAQ5BunB,aACDnpE,GAAyB4hD,EAAQv6D,EAAAA,KAAKgjF,YACxChjF,KAAKu/C,UAAU,IAAkBgb,GAAAA,IAO9BjqD,aACA0yE,UAAU1xF,OACf,MAAK,MAAM8tD,KAAAA,KAAiBL,UAC1B/+C,KAAKm/C,WAeFkkC,GAAAD,QACLzqE,GAAA,IAAsB2qE,EAAA,GAClBC,EAAAA,aACMA,GAAcxhB,EAAAA,MAKxBppD,EAAA,IAAc6qE,GAAA,MACT,MAAMtpF,KAAAA,KAAa6nE,MACtBqhB,GAAUA,EAAWrhB,GAAMtwE,EAAAA,QAAQyI,IAAS,GAE1CspF,EAAA,OAAA,SAMCA,EAAAC,QACL9qE,eAAYopD,MAAMtwE,QAAQyI,IAAS,SCjGrCwpF,eAAoBC,QAAAnC,OAFZmC,EAAA3jF,KAAA4jF,SAAyD,GAQzDC,UACN7jF,QAAK4jF,SAAsBlgC,GAAMqe,EAAAA,QACjCppD,MAAK,MAAM4hD,KAAAA,KAAeinB,OAAOsC,cAAcrC,SACvCQ,EAAAA,UAQHqB,GAAAS,iBAC0BprE,GAAA,IAArBomC,EAAAA,UAAUztD,SACZgf,EAAAA,eAAAA,KACMszE,SAAsBlgC,GAAMqe,EAAAA,SAQrCkgB,UACLtpE,OAAK,MAAMqrE,KAAAA,KAAkBJ,SACvB5jF,KAAK4jF,SAASI,IAChBhkF,KAAK4jF,SAAoB3B,GAAAA,UAUxBtpE,GAAA+mD,gBAAgC8B,EACrCt+D,OAAK,MAAM8gF,KAAAA,KAAkBJ,SAGvB5jF,KAAK4jF,SAAoBH,GAAAA,QAAkBvpF,EAAAA,OAC7C8F,KAAK4jF,SAAoB9B,GAAAA,aASxBnpE,GAAAmpE,aACLnpE,OAAK,MAAMqrE,KAAAA,KAAkBJ,SAC3B5jF,KAAK4jF,SAAoB9B,GAAAA,aAQtBnpE,GAAAsrE,YACLtrE,GAAA,MAA2B3Y,EAAAA,KAAKkkF,SAChCvrE,GAAIwrE,GACFC,EAAA,OAEFA,EAAA,MAAcZ,EAAA,IAAazhB,GAE3BppD,eADKkrE,UACEngC,GAOF8/B,EAAAU,SACLvrE,GAAA,MAAY0rE,EAAatiB,GACzBppD,eAASirE,SACA5jF,GAAAA,KAAK4jF,SAEPQ,GAAA,YC7ETE,eAAoBC,QAAA/C,OAHb+C,EAAAvkF,KAAAwkF,QAAsC,GAAAxkF,KAEtCykF,aAAc,EAQd7vF,IACL+jB,eAAY6rE,QAAQE,MAAY56E,GAAAA,aAO3B6O,IAAAgsE,UAELhsE,GAAA,IAAYopD,EAAAA,OAAiC,IAAjBA,EAAAA,MAAMzwE,OAChC,MAAM,IAAIoU,MAAM,+CAGlB,MAAc1F,EAAAA,KAAKwhF,OAAOQ,aAAaiC,YAAmBliB,EAAAA,YACrDyiB,QAAQxxF,KACbgN,GAAAA,KAAKwkF,QAAQplF,MAAM7H,CAAGC,EAAAA,IAAQwpF,EAAAA,SAAaA,EAAAA,WACrC/hC,EAAAA,SACFj/C,GAAAA,KAAKykF,aAAsBG,EAAAA,YACtBA,EAAAA,WAAW5kF,KAAKwhF,OAAOjjE,SAQ3BsmE,aACLlsE,GAAyBmsE,EAAQ9kF,EAAAA,KAAKwkF,SACtC,MAAcxkF,EAAAA,KAAKwhF,OAAOQ,aAAakC,SAAgBniB,EAAAA,OACnDre,IACIvE,EAAAA,WACNn/C,GAAAA,KAAKwhF,OAAOQ,aAAa+B,iBAAiBrgC,IAUvCqhC,cAAgCxmE,EAAsB+K,EAC3Dv5B,GAAA,IAEa+Z,KAFH26E,YACRzkF,MAAKykF,aAAc,MACd,MAAM36E,KAAAA,KAAU06E,QACbI,EAAAA,YACFA,EAAAA,WAAW5kF,KAAKwhF,OAAOjjE,SAK/B,MAAgBve,EAAAA,KAAKwkF,QAAQhlD,QAAc11B,GAAEk7E,EAAAA,aAC7CrsE,QAAK,MAAM7O,KACLA,EAAEm7E,EAAAA,WACFA,EAAAA,UAAmB37D,EAIzBv5B,OAAK,MAAM+Z,KAETs4E,EAAA,CAAA,MAAiBpiF,EAAAA,KAAKwhF,OAAOQ,aAAakC,SAAWniB,EAAAA,OAAOohB,YAAc/jF,EAAAA,MAEtEmf,GAAAA,aACF2mE,GAAA,IAAK,MAAM3qB,KACTA,EAAO1jB,EAAAA,YAAYt4B,MAAAA,OAAAA,EAASoL,EAAAA,QAG9B6O,EAAAA,OAAiBlP,EAGrBv5B,OAAK,MAAM+Z,KACLA,EAAEq7E,EAAAA,YACFA,EAAAA,WAAoB77D,EAKrBv5B,GAAAugB,YACA,MAAMw0E,KAAAA,KAAeN,QACxBxkF,KAAK6kF,aAAaC,UCxFtBM,eAAmBC,QAAA9mE,QARZ8mE,EAAArlF,KAAAgiF,aAA6B,IAAiBhiF,GAAAA,MAAAA,KAC9C8jF,cAA4C,IAA+B9jF,GAAAA,MAAAA,KAC3EslF,cAA4C,IAA+BtlF,GAAAA,MAWlFw4B,OAAyBlP,EACnBpvB,GAAAA,IAAoB2mF,GAAAA,QAEtB7gF,KAAK8jF,cAAclC,eAAe5hF,KAAKue,QAEzCve,GAAAA,KAAKslF,cAAcP,cAAoB/kF,EAAAA,KAAKue,QAC5Cve,GAAAA,KAAK8jF,cAAcpB,2BACnB1iF,KAAK8jF,cAActB,wBAarBzuE,IACMwxE,GAAAA,aAA0BhlB,IAC5BvgE,KAAK8jF,cAAc7B,UAGjBsD,GAAAA,aAA0BC,IAC5BxlF,KAAKslF,cAAcX,UAcvBhsE,GAAAjI,OAA0DyxE,EAAWj/E,GAAA,GAC/DqiF,aAA0BhlB,IAC5BvgE,KAAK8jF,cAAchC,aAA6BK,EAG9CoD,GAAAA,aAA0BC,IAC5BxlF,KAAKslF,cAAcT,aAIvBlsE,GAAA8sE,qBACO3B,cAAcxzE,QAGrBo1E,oBACOJ,cAAch1E,eCzErBq1E,oBAAgDtwC,EAAyBuwC,EAAkBC,EACzF/7E,GAAA,MAAgB+7E,EAAY/7E,EAAA,IACrB0gC,EAAAA,IAAIt2B,SAAkBL,EAAAA,MAAMkyC,IACzBz9C,EAAAA,IAAI4L,SAAgBs2B,EAAAA,IAAI32B,MAAMkyC,IAAU7xC,SAAkBL,EAAAA,MAAYkyC,GAAUA,EAAAA,IAEnF7Z,EAAAA,iBAA0BmB,EAAAA,QAAgBgI,EAAO/H,EAAAA,SACxDxzB,EAAUmV,EAAAA,UAAmBid,EAAAA,gBAE7BpyB,EAAUjG,EAAAA,MAAMK,SAAgBk5B,EAAAA,YAAYv5B,MAAMkyC,WCJzC+/B,WAAb/E,qCACkB/gF,KAAA+hE,MAAS,kCAClBijB,WAAwBnE,GAAAA,OACxB7gF,KAAAghF,UAEP,EAAAxoD,OAA4BqtD,EAC1B3iF,GAAA,IACImyC,EACJ0wC,MAAK,MAAMxrB,KACTzgD,EAAYygD,CAAAA,EAAO3lE,EAAAA,IAAIu+C,IACdonB,EAAO3lE,EAAAA,IAAIs4C,IAEpB,MAAqBqtB,EAAO3lE,EAAAA,IAAIorD,IAC5BgmC,GAAAA,MAAAA,OAAAA,EAAcr1B,EAAAA,SAChB,SAGF,MAAiBtb,EAAOlI,EAAAA,IAAIn4B,SACxBgxE,MAAAA,OAAAA,EAAc5lC,EAAAA,iBAAgCtE,GAAAA,SAAUkqC,MAAAA,OAAAA,EAAchqB,EAAAA,aAC/D9nD,EAAAA,SAAiBsoC,GAAAA,SAE5BwpC,MAAAA,GAAcvoB,EAAAA,sBAGEwoB,GAAAA,UAAqB5wC,EAAQuwC,EAAUC,EAAAA,IAI3DnqE,UAAU1T,WCgBHk+E,GAAAC,MAgBLxtE,eAdKytE,SAGLj/B,GAAWA,EAAS3nB,EAAAA,QAAO/nC,IAAQq5D,EAAAA,oBAG9Bu1B,cAGLrmF,GAAAA,KAAKsmF,cAGLtmF,GAAAA,KAAKumF,UAEEp/B,GCvDJxuC,SAAM6tE,WACJN,GAAAE,SACLztE,OAAK,MAAMuS,KACTvS,EAAA,CAAA,MAAajV,EAAKwI,EAAAA,cAAsBokD,EAAAA,KAC5BplC,EAAQolC,EAAAA,IAAI77C,SAEhBmrC,EAAAA,UAAUjjB,OAAOtQ,KAAK,eAAgB,IAAsBnB,GAAQ00B,EAAAA,UAAmBD,EAAAA,UAAiB2Q,EAAAA,IACxG3Q,EAAAA,UAAUhjB,OAAOtQ,KACvB,eACA,IAAsBnB,GAAQy0B,EAAAA,UAAmBC,EAAAA,UAAgB5zC,EAAAA,YAAmBskD,GAAI77C,EAAAA,YAKvF8xE,mBACLE,MAAK,MAAMv7D,KACTvS,EAAA,CAAA,MAAkBuS,EAAQ00B,EAAAA,UACR10B,EAAQy0B,EAAAA,UACG+mC,EAAA,QAAf9mC,EAAUnT,EAAAA,aAAAA,IAAKk6C,OAAA,EAAE/xF,EAAAA,IAAIorD,IACNogC,EAAA,QAAfzgC,EAAUlT,EAAAA,aAAAA,IAAKg6C,OAAA,EAAE7xF,EAAAA,IAAIorD,IAC/BC,GAASC,GAAAA,IACDE,EAAAA,gBAAgCvE,GAAAA,SAAiBuE,EAAAA,gBAAgCvE,GAAAA,SACzF,SAGJ,MAAan4C,EAAKwI,EAAAA,cAAsBokD,EAAAA,KAC5BplC,EAAQolC,EAAAA,IAAI77C,SAEhBmrC,EAAAA,UAAUjjB,OAAOtQ,KAAK,gBAAiB,IAAuBnB,GAAQ00B,EAAAA,UAAmBD,EAAAA,UAAiB2Q,EAAAA,IAC1G3Q,EAAAA,UAAUhjB,OAAOtQ,KACvB,gBACA,IAAuBnB,GAAQy0B,EAAAA,UAAmBC,EAAAA,UAAgB5zC,EAAAA,YAAmBskD,GAAI77C,EAAAA,YAKxF6xE,uBACLM,MAAK,MAAM17D,KACTvS,EAAA,CAAA,IAAUuS,EAAQolC,EAAAA,IAClB,MAAkBplC,EAAQ00B,EAAAA,UACR10B,EAAQy0B,EAAAA,UACGygC,EAAA,QAAfxgC,EAAUnT,EAAAA,aAAAA,IAAKo6C,OAAA,EAAEjyF,EAAAA,IAAIorD,IACN+5B,EAAA,QAAfp6B,EAAUlT,EAAAA,aAAAA,IAAKm6C,OAAA,EAAEhyF,EAAAA,IAAIorD,IAC/BC,GAASC,GACX65B,EAAA,CAAI95B,GAAMG,EAAAA,gBAAgCvE,GAAAA,SAAiBuE,EAAAA,gBAAgCvE,GAAAA,QACzF,SAGQuE,EAAAA,gBAAgCtE,GAAAA,QAAgBsE,EAAAA,gBAAgCtE,GAAAA,SAElFwU,EAAIz8C,EAAAA,MAAM,KAIRusC,EAAAA,gBAAgCtE,GAAAA,SAClCxzC,EAAAA,IAASgoD,GAAIlwD,EACnB6/C,EAAM33C,EAAAA,IAASgoD,GAAIjwD,EAGjB6/C,GAAME,EAAAA,gBAAgCtE,GAAAA,SAClCxzC,EAAAA,IAASgoD,GAAIlwD,EACnB8/C,EAAM53C,EAAAA,IAASgoD,GAAIjwD,EAAAA,KAMpBgmF,uBACLS,MAAK,MAAM57D,KACTvS,EAAA,CAAA,MAAkBuS,EAAQ00B,EAAAA,UACR10B,EAAQy0B,EAAAA,UACG+mC,EAAA,QAAf9mC,EAAUnT,EAAAA,aAAAA,IAAKs6C,OAAA,EAAEnyF,EAAAA,IAAIorD,IACNogC,EAAA,QAAfzgC,EAAUlT,EAAAA,aAAAA,IAAKq6C,OAAA,EAAElyF,EAAAA,IAAIorD,IAE/BC,GAASC,GAEXkgC,EAAA,CAAIngC,GAAMG,EAAAA,gBAAgCvE,GAAAA,SAAiBuE,EAAAA,gBAAgCvE,GAAAA,QACzF,SAGF,MAAe3wB,EAAQ1W,EAAAA,OACNA,EAAOC,EAAAA,SAGpBwrC,GAAMG,EAAAA,gBAAgCtE,GAAAA,OACxC,CAAA,MAAetnC,EAAOX,EAAAA,MAAajH,EAAAA,IAAU49B,EAAAA,IAAI/1B,WAC3C+1B,EAAAA,IAAYA,EAAAA,IAAIz2B,IAGxBizE,GAAI9mC,GAAME,EAAAA,gBAAgCtE,GAAAA,OACxC,CAAA,MAAemrC,EAASpzE,EAAAA,MAAejH,EAAAA,IAAU49B,EAAAA,IAAI/1B,WAC/C+1B,EAAAA,IAAYA,EAAAA,IAAIz2B,IAAImzE,aCjGlCC,eAAyCt0B,EAAsB3nC,EAA5Ck8D,QAAA1tE,MAAsB2tE,EAAArnF,KAAA6yD,MAAsBy0B,EAAAtnF,KAAAkrB,QA2DxDk8D,EAAApnF,KAAAunF,cAKA,EAAAvnF,KAAAwnF,eAKA,EAAAxnF,KAAAynF,WAKA,EAAAznF,KAAA0nF,YAKA,EAAA1nF,KAAA2nF,WAAqB,IAAWn6C,EAAG,EAKnC,GAAAxtC,KAAA4nF,WAAqB,IAAWp6C,EAAG,EAnFxCxtC,GAAAA,KAAKw4B,SAMPA,eACEwuD,EAAA,MAA0Ca,EAAA,QAA5B7nF,EAAAA,KAAKkrB,QAAQ00B,UAAUnT,aAAAA,IAAKq7C,OAAA,EAAElzF,EAAAA,IAAIorD,IACN+lC,EAAA,QAA5B/lF,EAAAA,KAAKkrB,QAAQy0B,UAAUlT,aAAAA,IAAKu6C,OAAA,EAAEpyF,EAAAA,IAAIorD,IAE5CC,GAASC,GACX6lC,EAAA,CAAA,MAAe/lF,EAAAA,KAAKkrB,QAAQ1W,OACZxU,EAAAA,KAAKkrB,QAAQqlC,aAExBo3B,WAAa3nF,KAAK0Z,MAAMzF,IAAU3L,EAAAA,KACvCtI,KAAK4nF,WAAa5nF,KAAK0Z,MAAMzF,IAAU3L,EAAAA,KAEvC,MAAyBtI,EAAAA,KAAK2nF,WAAWtzE,MACnC0zE,GAAmB/nF,EAAAA,KAAK4nF,WAAWvzE,MAEzCrU,QAAKynF,WACGjrB,EAAAA,YACAA,EAAAA,YACAI,EAAAA,eAAoCorB,EAC1C9nC,EAAM0c,EAAAA,eAAoCmrB,EAE5CrB,EAAA,MAA0B1mF,EAAAA,KAAK2nF,WAAWtzE,MACpC4zE,GAAoBjoF,EAAAA,KAAK4nF,WAAWvzE,MAE1CrU,QAAK0nF,YACGlrB,EAAAA,YACAA,EAAAA,YACAI,EAAAA,eAAqCsrB,EAC3ChoC,EAAM0c,EAAAA,eAAqCqrB,EAG/ClO,cAMKoO,4BACLC,EAAA,MAA0CP,EAAA,QAA5B7nF,EAAAA,KAAKkrB,QAAQ00B,UAAUnT,aAAAA,IAAK47C,OAAA,EAAEzzF,EAAAA,IAAIorD,IACN+lC,EAAA,QAA5B/lF,EAAAA,KAAKkrB,QAAQy0B,UAAUlT,aAAAA,IAAK27C,OAAA,EAAExzF,EAAAA,IAAIorD,IAC5CC,GAASC,GAGX6lC,EAAA,CAAA,MAAa9lC,EAAMzV,EAAAA,IAAIz2B,IAAWM,EAAAA,MAAY63B,EAAAA,gBAAiBlsC,KAAK2nF,oBACjDn9C,EAAAA,IAAIz2B,IAAWM,EAAAA,MAAY63B,EAAAA,gBAAiBlsC,KAAK4nF,aACxD3zE,IAEdq0E,UAAc91E,EAAAA,YClDL+1E,WAAbrC,qCACElmF,KAAAwoF,kBAAmD,IAAI71D,IAGvD3yB,KAAAyoF,sBAA+D,IAAI91D,IAEnE+1D,6BACEC,SAAyC,QAAlC3oF,EAAAA,KAAKyoF,sBAAsB7zF,IAAIwJ,UAAAA,IAAGuqF,EAAIA,EAAA,GAG/CvC,oBACEL,MAAK,MAAM76D,KAETvS,EAAA,CAAA,MAAajV,EAAKwI,EAAAA,cAAsBokD,EAAAA,KAChC1Q,EAAAA,UAAUjjB,OAAOtQ,KAAK,eAAgB,IAAsBnB,GAAQ00B,EAAAA,UAAmBD,EAAAA,UAAiBz0B,EAAQolC,EAAAA,MAChH1Q,EAAAA,UAAUjjB,OAAOtQ,KACvB,yBACA,IAA2BnB,GAAQ00B,EAAAA,UAAmBD,EAAAA,UAAiBz0B,EAAQolC,EAAAA,IAAKplC,IAE9Ey0B,EAAAA,UAAUhjB,OAAOtQ,KACvB,eACA,IAAsBnB,GAAQy0B,EAAAA,UAAmBC,EAAAA,UAAgB5zC,EAAAA,YAAmBkf,GAAQolC,EAAAA,IAAI77C,WAE1FkrC,EAAAA,UAAUhjB,OAAOtQ,KACvB,yBACA,IAA2BnB,GAAQy0B,EAAAA,UAAmBC,EAAAA,UAAgB5zC,EAAAA,YAAmBkf,GAAQolC,EAAAA,IAAI77C,SAAUyW,IAIzGwlC,EAAAA,aAIV,MAA2B/mD,EAAAA,MAAMsH,KAAKjR,KAAKyoF,sBAAsBp4F,YAC5D,MAAM66B,KAETvS,EAAA,CAAA,MAAciwE,EAAmBn3F,EAAAA,QAAgB2M,EAAAA,IACpCyqF,GAAA,GACQ99E,EAAAA,OAAc89E,EAEnC,GAAA,MAAgEzI,EAAA,QAA1CpgF,EAAAA,KAAKyoF,sBAAsB7zF,IAAYwJ,EAAAA,WAAAA,IAAG0qF,EAAIA,EAAA,GAEpE,IAAiB/O,EACjB,EAAA,MAAc7uD,EAAQ00B,EAAAA,UAAUnT,MAAM73C,IAAIorD,IAC5B90B,EAAQy0B,EAAAA,UAAUlT,MAAM73C,IAAIorD,IACtCC,GAASC,GACXo2B,EAAA,IAAK,MAAM58D,KAAiBR,EAAAA,OAC1B,CAAA,MAAegS,EAAQ1W,EAAAA,OACP0W,EAAQqlC,EAAAA,QAEL72C,EAAMzF,EAAAA,IAAU3L,EAAAA,KAChBoR,EAAMzF,EAAAA,IAAU3L,EAAAA,KAEVq/E,EAAWtzE,EAAAA,MAC9B0zE,GAAmBH,EAAWvzE,EAAAA,MAE9BozE,GACJxnC,EAAMuc,EAAAA,YACAA,EAAAA,YACAI,EAAAA,eAAoCorB,EAC1C9nC,EAAM0c,EAAAA,eAAoCmrB,EAEtCG,EAAoBP,EAAWtzE,EAAAA,MAC/B4zE,GAAoBL,EAAWvzE,EAAAA,MAE/BqzE,GACJznC,EAAMuc,EAAAA,YACAA,EAAAA,YACAI,EAAAA,eAAqCsrB,EAC3ChoC,EAAM0c,EAAAA,eAAqCqrB,EAGzCc,EAAcC,EAAAA,KAA+C,QAAPjD,EAAA,QAAzBgD,EAAcC,EAAAA,UAAAA,IAAWnB,OAAA,EAAEnuE,EAAAA,aAAAA,IAAKqsE,OAAA,EAAEtyE,EAAAA,eAAeiG,IAChFqvE,GAAcC,EAAYtvE,GAAAA,MAC1BqvE,EAAcC,EAAYn2B,GAAAA,MAAgBrC,EAAAA,YAAYw4B,IAGxCA,EAAcjP,GAAA,IAA2BrgE,GAAOwR,EAAQslC,EAAAA,YAAyBtlC,GAIjG69D,GAAcC,EAAYrB,GAAAA,WAC1BoB,EAAcC,EAAYpB,GAAAA,WAC1BmB,EAAcC,EAAYvB,GAAAA,WAC1BsB,EAAcC,EAAYtB,GAAAA,YAE1BsB,EAAAA,SAGCP,sBAAsBxvF,IAAYmF,EAAI2qF,GAI7C3I,OAAK,MAAMhiF,KACT4B,EAAAA,KAAKyoF,sBAAsBplB,OAK7BwlB,GAAIpsC,GAAQa,GAAAA,UACVt9C,KAAKs9C,UAAU6J,YAEV,MAAMj8B,KACTvS,EAAA,CAAA,MAAsB3Y,EAAAA,KAAK0oF,sBAA8BtqF,EAAAA,QACpD,MAAMsb,KACTA,EAAM6tE,EAAAA,cACN7tE,EAAM8tE,EAAAA,eAMd,GAAAjB,UACE5tE,OAAK,MAAMuS,KACTvS,EAAA,CAAA,MAAcuS,EAAQ00B,EAAAA,UAAUnT,MAAM73C,IAAIorD,IAC5B90B,EAAQy0B,EAAAA,UAAUlT,MAAM73C,IAAIorD,IAEtCC,GAASC,GAEX+oC,EAAA,CAAIhpC,GAAMG,EAAAA,gBAAgCvE,GAAAA,SAAiBuE,EAAAA,gBAAgCvE,GAAAA,QACzF,SAII4gB,EAAAA,eACAA,EAAAA,eAIR,MAAa/4D,EAAKwI,EAAAA,cAAsBokD,EAAAA,KAChC1Q,EAAAA,UAAUjjB,OAAOtQ,KAAK,gBAAiB,IAAuBnB,GAAQ00B,EAAAA,UAAmBD,EAAAA,UAAiBz0B,EAAQolC,EAAAA,MAClH1Q,EAAAA,UAAUjjB,OAAOtQ,KACvB,wBACA,IAA4BnB,GAAQ00B,EAAAA,UAAmBD,EAAAA,UAAiBz0B,EAAQolC,EAAAA,IAAKplC,IAE/Ey0B,EAAAA,UAAUhjB,OAAOtQ,KACvB,gBACA,IAAuBnB,GAAQy0B,EAAAA,UAAmBC,EAAAA,UAAgB5zC,EAAAA,YAAmBkf,GAAQolC,EAAAA,IAAI77C,WAE3FkrC,EAAAA,UAAUhjB,OAAOtQ,KACvB,wBACA,IAA4BnB,GAAQy0B,EAAAA,UAAmBC,EAAAA,UAAgB5zC,EAAAA,YAAmBkf,GAAQolC,EAAAA,IAAI77C,SAAUyW,SAK/Gs9D,kBAAkBl4E,YAClB,MAAM7Y,KACTuI,EAAAA,KAAKwoF,kBAAkBvvF,IAAMmF,EAAI3G,GAQrCyxF,GAAA5rC,qBACE6rC,MAAK,MAAMj+D,KACTvS,EAAA,CAAA,MAAqCywE,EAAA,QAAvBl+D,EAAQ00B,EAAAA,UAAUnT,aAAAA,IAAK48C,OAAA,EAAEz0F,EAAAA,IAAIorD,IACN0mC,EAAA,QAAvBx7D,EAAQy0B,EAAAA,UAAUlT,aAAAA,IAAKw8C,OAAA,EAAEr0F,EAAAA,IAAIorD,IACvCC,GAASC,GACXwmC,EAAA,CAAA,MAAgEwC,EAAA,QAA1ClpF,EAAAA,KAAKyoF,sBAAsB7zF,IAAYwJ,EAAAA,WAAAA,IAAG+qF,EAAIA,EAAA,OAC/D,MAAMzvE,KACTwvE,EAAIzsC,GAAQa,GAAAA,UACV,CAAA,MAAsBpyB,EAAQ1W,EAAAA,OAAOX,MAAY0zE,EAAAA,eAC1Br8D,EAAQqlC,EAAAA,QAAQ18C,MAAY2zE,EAAAA,gBACnCD,EAAcxzE,EAAAA,IAE9BksC,GAAMkd,EAAAA,aAAmBzjD,EAAAA,MAAejF,EAAAA,UAClC0oD,EAAAA,aAAmBzjD,EAAAA,MAAO0jD,QAE1BmqB,EAAAA,cACN7tE,EAAM8tE,EAAAA,eAAiB,IAWjClB,yBACEgD,MAAK,IAAQC,EAAGx5F,EAAI0sD,EAAQS,GAAAA,mBAAoBntD,IAC9C,IAAK,MAAMm7B,KACTvS,EAAA,CAAA,MAAqC6wE,EAAA,QAAvBt+D,EAAQ00B,EAAAA,UAAUnT,aAAAA,IAAKy8C,OAAA,EAAEt0F,EAAAA,IAAIorD,IACN0mC,EAAA,QAAvBx7D,EAAQy0B,EAAAA,UAAUlT,aAAAA,IAAKg9C,OAAA,EAAE70F,EAAAA,IAAIorD,IAEvCC,GAASC,GAEXwmC,EAAA,CAAIzmC,GAAMG,EAAAA,gBAAgCvE,GAAAA,SAAiBuE,EAAAA,gBAAgCvE,GAAAA,QACzF,SAGF,MAA8D6tC,EAAA,QAA1C1pF,EAAAA,KAAKyoF,sBAAsB7zF,IAAYwJ,EAAAA,WAAAA,IAAGkrF,EAAIA,EAAA,OAC7D,MAAM5vE,KACTgwE,EAAA,CAAA,MAAex+D,EAAQ1W,EAAAA,OACJm1E,EAAmBz0B,GAAAA,sBAA+Bx7C,EAAMm5C,EAAAA,OAGpDutB,GAKjBwJ,EAAgBz7E,EANGsuC,EAAQY,GAAAA,gBAEpBZ,EAAQW,GAAAA,MAI8DgjC,EAC7EhjB,GAAU5oD,EAAOX,EAAAA,OAAuB6F,EAAM+tE,EAAAA,YAI1CrnC,EAAAA,gBAAgCtE,GAAAA,SAClCxzC,EAAAA,IAAYA,EAAAA,IAAIyL,IAAYU,EAAAA,SAASZ,MAAY2oD,EAAAA,cACjDvtC,EAAAA,UAAkB04D,EAAAA,WAAWtzE,MAAiB4rC,GAAM2c,EAAAA,gBAGlDxc,EAAAA,gBAAgCtE,GAAAA,SAClCxzC,EAAAA,IAAYA,EAAAA,IAAIyL,IAAYF,EAAAA,MAAY2oD,EAAAA,cACxCvtC,EAAAA,UAAkB24D,EAAAA,WAAWvzE,MAAiB6rC,GAAM0c,EAAAA,mBAQtEypB,yBACEwD,MAAK,IAAQN,EAAGx5F,EAAI0sD,EAAQU,GAAAA,mBAAoBptD,IAC9C,IAAK,MAAMm7B,KACTvS,EAAA,CAAA,MAAqCmxE,EAAA,QAAvB5+D,EAAQ00B,EAAAA,UAAUnT,aAAAA,IAAKi9C,OAAA,EAAE90F,EAAAA,IAAIorD,IACN0mC,EAAA,QAAvBx7D,EAAQy0B,EAAAA,UAAUlT,aAAAA,IAAKs9C,OAAA,EAAEn1F,EAAAA,IAAIorD,IAEvCC,GAASC,GAEXwmC,EAAA,CAAIzmC,GAAMG,EAAAA,gBAAgCvE,GAAAA,SAAiBuE,EAAAA,gBAAgCvE,GAAAA,QACzF,SAGF,MAAoBoE,EAAM6b,EAAAA,WAAmBA,EAAAA,WAC5B/pE,EAAAA,KAAKwL,IAAUw+D,EAAAA,SAAgBA,EAAAA,UAEcqkB,EAAA,QAA1CpgF,EAAAA,KAAKyoF,sBAAsB7zF,IAAYwJ,EAAAA,WAAAA,IAAGyrF,EAAIA,EAAA,OAE7D,MAAMnwE,KAKT0mE,EAAA,CAAA,IAJyB1mE,GAAMyuE,EAAAA,sBAGWv7E,IAAY2jD,EAAAA,SACXm3B,EAAAA,YAM3C,MAAoB3rB,EAAWriD,EAAM6tE,EAAAA,cAClBp5E,EAAMuL,EAAM8tE,EAAAA,eAAgCwC,GAAaA,EAC5EC,GAAeC,EAAaxwE,EAAM8tE,EAAAA,eAC5BA,EAAAA,eAENzN,EAAA,MAAgB7uD,EAAQqlC,EAAAA,QAAQ18C,MAChCosC,GAAMkd,EAAAA,aAAmBzjD,EAAAA,MAAejF,EAAAA,UAClC0oD,EAAAA,aAAmBzjD,EAAAA,MAG3Bg7D,OAAK,MAAMh7D,KAOT0mE,EAAA,CAAA,IAAI6J,IAAsBE,EALDzwE,GAAMyuE,EAAAA,sBAGSv7E,IAAY4H,EAAAA,QAEaizE,EAAAA,WAKjE,MAAmB11F,EAAAA,KAAKuL,IAAUiqF,EAAAA,cAA8B6C,EAChEH,GAAeC,EAAaxwE,EAAM6tE,EAAAA,cAC5BA,EAAAA,cAEN8C,EAAA,MAAgBn/D,EAAQ1W,EAAAA,OAAOX,MAC/BosC,GAAMkd,EAAAA,aAAmBzjD,EAAAA,MAAejF,EAAAA,UAClC0oD,EAAAA,aAAmBzjD,EAAAA,MAAO0jD,aCrR/BktB,WAAbvJ,qCACkB/gF,KAAA+hE,MAAS,gDAClBijB,WAAwBnE,GAAAA,OACxB7gF,KAAAghF,UAGC,EAAAhhF,KAAAuqF,iBAAmB,IACnBC,GAAAxqF,KAAAyqF,cAAgB,IAChBC,GAAA1qF,KAAA2qF,WAAa,IACbpmC,GAAAvkD,KAAA4qF,mBAAqB,IAAIj4D,IACzB3yB,KAAA6qF,sBAAwB,IAAIl4D,IAE5B3yB,KAAA8qF,eAAkC9qF,GAAAA,KAAK2qF,WAAW7lC,MAClDglC,QAAAiB,iBAAoC/qF,GAAAA,KAAK2qF,WAAW3lC,QAE5D8kC,GAAAtqC,OACE7mC,GAAIqyE,GAAoB5iF,GAAUuQ,GAChC,CAAA,MAA0BvQ,EAAQ9N,EAAAA,KAAK1F,IAAI4kE,IACzBC,EAAAA,eAAeva,UAAUl/C,KAAK8qF,gBAC9BpxB,EAAAA,iBAAiBxa,UAAUl/C,KAAK+qF,kBAClD,MAAiBE,EAAkBr2F,EAAAA,MAEjCoL,GAAAA,KAAK2qF,WAAW7lC,MAAMrE,OAGxB,CAAA,MAA0Br4C,EAAQ9N,EAAAA,KAAK1F,IAAI4kE,IAC1ByxB,EAAkBr2F,EAAAA,MAEjCoL,GAAAA,KAAK2qF,WAAW3lC,QAAQvE,IAK9BmkC,WACE5kF,QAAK83B,QAAgBnO,EAAAA,OAGvB6O,OAA4BqtD,SAC1BqF,EAAA,IAAaruC,GAAAA,QACX,OAIF,IAA4ButC,EAAA,OACvB,MAAM7vB,KACT5hD,EAAA,CAAA,MAAqB4hD,EAAO3lE,EAAAA,IAAI4kE,IACf2xB,EAAAA,MAAAA,OAAAA,EAAcv2F,EAAAA,MAC3Bu2F,IAAkC,QAAlBA,EAAa1+C,EAAAA,aAAAA,IAAKy+C,OAAA,EAAE7qC,EAAAA,UACzB7nB,EAAAA,SACTioB,aACF+H,GAAYA,EAAU7sD,EAAAA,OAAgBkpD,EAAAA,gBAE5B7xD,EAAAA,KAAKytD,SAQhBkqC,WAAWnyD,OAGhB4xD,GAAA,MAAcpqF,EAAAA,KAAK2qF,WAAWvlC,WAAsBygC,EAEpD7lF,QAAK6qF,sBAAsBv6E,QAG3B,IAAetQ,EAAAA,KAAK2qF,WAAW1jC,YAAmBjnD,EAAAA,KAAK83B,QAAQ/wB,MAAMijB,MAAM0gD,WAE3C1qE,EAAAA,KAAKorF,YAGnBjF,MAGlBh/B,GAASr2C,EAAAA,SAAe9Q,GAAAA,KAAK6qF,sBAAsB5xF,IAAMmF,EAAI3G,GAAAA,UAGxD4zF,qBAGLrrF,KAAK4qF,mBAAmBt6E,QAGxBtQ,KAAK4qF,mBAAqB,IAAIj4D,IAAI3yB,KAAK6qF,uBAGzCO,mBACiB1uC,GAAAA,8BAA4DV,GAAAA,UAAYh8C,KAAKuqF,iBAAmBvqF,KAAKyqF,cAGtH1jF,MACE/G,QAAK2qF,WAAW5jF,MAGX4R,GAAA0yE,yBACA,MAAW5zF,EAAAA,KAAAA,KAAWozF,sBAEzB,IACoBpzF,KADVmzF,mBAAmBh3F,IAAS03F,GACpC,CAAA,MAAkB7zF,EAAEmoD,EAAAA,UACFnoD,EAAEkoD,EAAAA,UACVhjB,EAAAA,OAAOtQ,KAAK,iBAAkB,IAAwBuzB,GAAWD,EAAWloD,EAAAA,IAC5EklC,EAAAA,OAAOtQ,KAAK,eAAgB,IAAsBuzB,GAAWD,EAAWloD,EAAAA,IACxEklC,EAAAA,OAAOtQ,KAAK,iBAAkB,IAAwBszB,GAAWC,EAAWnoD,EAAAA,IAC5EklC,EAAAA,OAAOtQ,KAAK,eAAgB,IAAsBszB,GAAWC,EAAWnoD,EAAAA,QAKjF,MAAWA,EAAAA,KAAAA,KAAWmzF,mBACzB,IACoBnzF,KADVozF,sBAAsBj3F,IAAS23F,GACvC,CAAA,MAAkB9zF,EAAEmoD,EAAAA,UACFnoD,EAAEkoD,EAAAA,UACVhjB,EAAAA,OAAOtQ,KAAK,eAAgB,IAAsBuzB,GAAWD,EAAAA,IAC7DhjB,EAAAA,OAAOtQ,KAAK,aAAc,IAAoBuzB,GAAWD,EAAAA,IACzDhjB,EAAAA,OAAOtQ,KAAK,eAAgB,IAAsBszB,GAAWC,EAAAA,IAC7DjjB,EAAAA,OAAOtQ,KAAK,aAAc,IAAoBszB,GAAWC,EAAAA,YClIlE4rC,kBACeC,GAAAA,cACpBC,EAAoBC,GAAAA,iBCaxB,GAAA,ICEYC,GFnBIC,GCqBdP,GCEAQ,GFvBcL,GAAAA,cACA,EAAAE,GAAAA,iBCgBhB,GAIEL,GAJUS,KAAiBC,GAAA,KAI3B7c,IAAA,MAIAmc,GAAAW,KAAA,OAIAX,GAAAY,SAAA,WAKAZ,GAAAa,OAAA,eA+CWC,WAiBXt7D,wBACExe,EAAAA,MAhBKg5E,GAAAtrF,KAAA28B,OAAS,IAAyB38B,GAAAA,MAAAA,KAClCqnE,OAAkB,GAAArnE,KAClBo9E,SAAgD6O,GAAAA,KAChDjsF,KAAAqsF,cAAwB,IACxBrsF,KAAAssF,UAEC,EAAAtsF,KAAAklC,mBAEA,EAAAllC,KAAAusF,YAAa,EACbvsF,KAAAwsF,cACA,EAAAxsF,KAAAilC,iBACA,EAAAjlC,KAAAisC,WACA,EAAAjsC,KAAAysF,OAAQ,EACRzsF,KAAA0sF,UAAW,EAIjB1sF,KAAKqnE,OAAiBA,EAAAA,OACtBrnE,KAAKo9E,SAA2B,QAAhB5mF,EAAQ4mF,EAAAA,gBAAAA,IAAQuP,EAAI3sF,EAAAA,KAAKo9E,SACzCp9E,KAAKqsF,cAAqC,QAArB71F,EAAQ61F,EAAAA,qBAAAA,IAAaO,EAAI5sF,EAAAA,KAAKqsF,cAEnDrsF,KAAK6sF,UAGA,GAAA73E,eACE,IAAc83E,GAAA18F,OAAD+c,OAClBk6D,CAAAA,OAAQrnE,KAAKqnE,OAAOpmE,KAAYsqF,GAAAn7F,OAAD+c,OAAA,GAAMhZ,KACrCk4F,cAAersF,KAAKqsF,cACpBjP,SAAUp9E,KAAKo9E,eACP1tD,+CA8BVq9D,EACAC,EACA5P,EAA8B2O,EAAkBE,GAAAA,MAEhD,MAAiBtW,EAAY/wC,EAAAA,QAAQtzC,OAC/B27F,EAAiBF,EAAavtD,EAAAA,QAAkBjuC,GAAQ27F,EAAK37F,GAAQob,EAM3E48E,WALmBj4F,EAAAA,QACP67F,GAAAA,QAAQlmF,KAChB,4DAA4ElK,EAAAA,KAAK,+BAG9E,IAAc+vF,GACnBzlB,CAAAA,OAAoBziC,EAAAA,QACjBpF,QAAQr4B,CAAG5V,EAAAA,IAAuBE,EAAAA,QAAQF,IAAU,IACpD0P,KAAK9M,IAAM,CACV8vE,QACA38B,EAAAA,SAAU0lD,MAEd5P,SAAUA,6BAWkCgQ,EAC9ClqF,GAAA,MAAsBkqF,EAAU/lB,EAAAA,OAAOpmE,KAASwsE,GAAOmI,GAAAA,eAAiB3R,EAAAA,kBACjE,IAA4Bp9B,GACjCjC,CAAAA,QACAE,EAAAA,KAAgBs4C,EAAAA,WAA+B6O,GAAAA,KAC/C9mD,YAAuBi4C,EAAAA,WAA+B+O,GAAAA,OAAuB76F,EAAAA,OAAS,OAAA,EACtFuzC,MAAiBwnD,EAAAA,cACjB1iE,OAAQA,IAIZqb,+BACWwnD,eAAsBxsF,GAAAA,KAAKwsF,cAAgBxsF,KAAKqnE,OAAO/1E,OACvD0O,KAAKqnE,OAAOrnE,KAAKwsF,eAEnB,KAGTa,4BACcX,SAGP/lD,YACA+lD,UAAW,EAGX/f,aACA+f,UAAW,EAChB1sF,KAAKusF,YAAa,EAGbxqD,aACA0qD,OAAQ,EACbzsF,KAAKusF,YAAa,EAClBvsF,KAAKwsF,cAGP,EAAAc,4BACelQ,eACYjO,GAAAA,SACAgd,GAAAA,kCAS3BoB,uBACcd,MAGPI,mBACL7sF,OAAKwsF,cACLxsF,EAAAA,KAAKilC,iBAAmBjlC,KAAKqsF,cAC7B,MAAmBrsF,EAAAA,KAAKqnE,OAAOrnE,KAAKwsF,eAChCgB,IAAextF,KAAKysF,QACtBzsF,KAAKilC,kBAAmBuoD,MAAAA,OAAAA,EAAYlmD,EAAAA,WAAYtnC,KAAKqsF,cACrDrsF,KAAKwH,MAA0B,QAAlBgmF,EAAWvpB,EAAAA,eAAAA,IAAOwpB,OAAA,EAAEjmF,EAAAA,MACjCxH,KAAKyH,OAA2B,QAAlB+lF,EAAWvpB,EAAAA,eAAAA,IAAOypB,OAAA,EAAEjmF,EAAAA,OAClCzH,KAAK28B,OAAOtQ,KAAK,QAASmhE,IAItBG,aACN,MAAqB3tF,EAAAA,KAAKwsF,cACtBxsF,GAGJA,KAHSysF,MACP,OAEFmB,EAAA,IAAYC,GAEZ,cAAazQ,eACY6O,GAAAA,KACbjnD,GAAe4oD,EAAK5tF,GAAAA,KAAKqnE,OAAO/1E,OAC3B,IACX0O,GAAAA,KAAK28B,OAAOtQ,KAAK,OAAQrsB,iBAINmvE,GAAAA,IACdnqC,EAAe4oD,EAClBzjF,EAAQnK,GAAAA,KAAKqnE,OAAO/1E,SACtB0O,KAAKysF,OAAQ,EACbzsF,KAAKwsF,cAAgBxsF,KAAKqnE,OAAO/1E,OACjC0O,KAAK28B,OAAOtQ,KAAK,MAAOrsB,kBAILmsF,GAAAA,OACdh+E,EAAM62B,EAAe4oD,EAAG,EAAG5tF,EAAAA,KAAKqnE,OAAO/1E,OAC1C6Y,GAAQnK,GAAAA,KAAKqnE,OAAO/1E,OAAS,IAC/B0O,KAAKysF,OAAQ,EACbzsF,KAAK28B,OAAOtQ,KAAK,MAAOrsB,kBAILksF,GAAAA,SACFlsF,EAAAA,KAAKisC,YAAcjsC,KAAKqnE,OAAO/1E,SAChD0O,KAAKisC,YACLjsC,EAAAA,KAAK28B,OAAOtQ,KAAK,OAAQrsB,OAGRA,EAAAA,KAAKisC,WAAa,IACnCjsC,KAAKisC,WACLjsC,EAAAA,KAAK28B,OAAOtQ,KAAK,OAAQrsB,OAGpBglC,EAAgBhlC,EAAAA,KAAKisC,WAAajsC,KAAKqnE,OAAO/1E,cAOpDu8F,EAAAloD,KAAkCC,EAA2B1iC,EAC9DlD,QAAKklC,oBAAsBU,IAG/B5lC,KAAKklC,kBACAllC,EAAAA,KAAK0sF,WAKN1sF,KAAKusF,aACPvsF,KAAKusF,YAAa,EAClBvsF,KAAK28B,OAAOtQ,KAAK,QAASrsB,KAAKglC,eAGjChlC,KAAKilC,kBAA0CjlC,EAAAA,KAAKssF,UAChDtsF,KAAKilC,kBACPjlC,GAAAA,KAAK6sF,UAAU7sF,KAAK2tF,cAAAA,KAEjBG,sBAGCA,0BACF9tF,OAAKglC,eACPhlC,KAAKwH,MAAiC,QAAzBxH,EAAAA,KAAKglC,aAAai/B,eAAAA,IAAO8pB,OAAA,EAAEvmF,EAAAA,MACxCxH,KAAKyH,OAAkC,QAAzBzH,EAAAA,KAAKglC,aAAai/B,eAAAA,IAAO+pB,OAAA,EAAEvmF,EAAAA,QAInCqoB,WAA0C1vB,EAAWC,EACzDL,QAAKglC,cACPhlC,KAAKglC,aAAai/B,QAAQnoD,KAAU1b,EAAGC,EAAAA,IA3O5B8sF,GAAAA,QAAiBt7E,EAAAA,oBEpErBo8E,WAGXn9D,eACExe,GAAAA,MAHK47E,GAAAluF,KAAAmuF,QAA8B,GAAAnuF,KAI9BmuF,QAAkBA,EAAAA,QACvBnuF,KAAK8tF,oBAGA94E,eACE,IAAkBo5E,GAAAh+F,OAAD+c,OACtBghF,CAAAA,QAAS,SAASA,eACVz+D,wBAIJo+D,oBACN,IAASO,EAAA,IACTzlC,OAAK,MAAMqb,QAASqqB,EAAAhmF,IAAEA,KAAAA,KAAc6lF,QAC7BlqB,EAAQt0C,EAAAA,YAAYlW,UAAeuB,GAAAA,QAM1CqzE,eAHK7mF,MAAWA,EAAAA,MAChBxH,KAAKyH,OAAYA,EAAAA,OAKnB4mF,EAAA1+D,kBACE,IAAS0+D,EAAA,IACTzlC,OAAK,MAAMqb,QAASqqB,EAAAhmF,IAAEA,KAAAA,KAAc6lF,QAC7BlqB,EAAQt0C,EAAAA,YAAYlW,UAAeuB,GAAAA,QAE1CqzE,UAGMA,EAAAE,oBACN51E,UAAOsrD,aAAmBmoB,IAAanoB,aAGlCmqB,GAAAzoD,KAAkCC,EACvC1iC,OAAK,MAAMsrF,KAAAA,KAAeL,QACxB,CAAA,MAAuBK,EAAOvqB,EAAAA,aACrBsqB,oBAAoBE,IACZ9oD,EAAAA,KAA0BC,EAAAA,IAKxC7D,YACA,MAAMysD,KAAAA,KAAeL,QACxB,CAAA,MAAuBK,EAAOvqB,EAAAA,aACrBsqB,oBAAoBE,IACZ1sD,EAAAA,SAKXlS,SAAuCzvB,EAAWC,EAC1DL,QAAK8tF,oBACLx7E,MAAMud,SAAazvB,EAAGC,EAGdtQ,GAAA+/B,WAAyC1vB,EAAWC,EAC5DtQ,OAAK,MAAMy+F,KAAAA,KAAeL,QACrBn+D,EAAAA,OACAvW,EAAAA,UAAapZ,EAChBmuF,GAAOvqB,EAAAA,QAAQnoD,KAAS0yE,EAAOlmF,EAAAA,IAAOkmF,EAAOlmF,EAAAA,IACzCtI,GAAAA,KAAK8uB,WAEJ/nB,EAAAA,MAAMiV,SAAY,EAAGhc,EAAAA,KAAKwH,MAAOxH,KAAKyH,QAExC6oB,EAAAA,iBC1EIo+D,WAAb3N,qCACkB/gF,KAAA+hE,MAAS,oCACTijB,WAAwBlE,GAAAA,KACjC9gF,KAAAghF,SACC,EAAAhhF,KAAA82E,OAKD,EAAA8N,WACL5kF,QAAK2uF,iBAAyBhlE,EAAAA,OAAOilE,gBACrC5uF,KAAKigB,QAAgBD,EAAAA,OACrBhgB,KAAK83B,QAAgBnO,EAAAA,OAGhBvqB,KAAgB5H,EACrB0L,UAAStO,EAAAA,IAAIu+C,IAAwB37C,EAAE5C,EAAAA,IAAIu+C,IAGtCK,EAAAhb,OAA2BlP,SAGhCulE,EAAA,IACIvqB,EAHJtkE,OAAK8uF,eACL9uF,KAAK82E,aAIA,MAAMvc,KACTzgD,EAAYygD,CAAAA,EAAO3lE,EAAAA,IAAIu+C,IACZonB,EAAO3lE,EAAAA,IAAI8wE,IAGtB,MAAwB1lE,EAAAA,KAAK+uF,aAAwBzqB,EACjD0qB,GAAAA,IAA2BrtB,EAAAA,OAAO,eAC7B70C,EAAAA,gBAAgBT,KAAK,eAAgB,IAAsBkuC,GAAAA,IAC3DoF,EAAAA,aAAa,IAAiBC,GAAA,gBAGfrF,GAAOoH,EAAAA,OAAO,eAC7B70C,EAAAA,gBAAgBT,KAAK,gBAAiB,IAAuBkuC,GAAAA,IAC7DmF,EAAAA,gBAAgB,cAGrBsvB,IAKJhvF,KAAKivF,qBAELjvF,GAAAA,KAAK2uF,iBAAiB3+D,OAGbwI,EAAAA,OAAcx4B,EAAAA,KAAK82E,QAG5B92E,KAAKkvF,gBAGD5qB,GAASuB,EAAAA,WACFA,EAAAA,UAAU7lE,KAAK2uF,iBAG1B3uF,GAAAA,KAAK2uF,iBAAiBpmF,QAAmBA,EAAAA,SAAkC,QAAtBgyD,EAAehyD,EAAAA,eAAAA,IAAOsmF,EAAIA,EAG/E7uF,GAAAA,KAAKmvF,uBAGD7qB,GAASwB,EAAAA,YACFA,EAAAA,WAAW9lE,KAAK2uF,iBAG3B3uF,GAAAA,KAAK2uF,iBAAiBr+D,UAGtBtwB,KAAKovF,oBAAoBt1E,SAGtB60E,iBAAiBU,QACtBrvF,KAAK83B,QAAQ9N,MAAM0gD,UAAUpG,SAASgrB,YAAkC3D,GAAAA,iBACxE3rF,KAAK83B,QAAQ9N,MAAM0gD,UAAUpG,SAASirB,UAAgC9D,GAAAA,cAGhEqD,oBACDH,iBAAiBr+E,QAGhBy+E,aAA4CzqB,EAClDphE,GAAI4W,OAAUy5B,EAAAA,aAA0BL,GAAAA,QAEtClzC,KADgCigB,QAAQjC,SAAS7C,UAAmBwU,EAAAA,YAAY7V,UAAoB45B,EAAAA,oBAQhGy7C,gCACNK,EAAIC,GAAkBj4C,EAAAA,QAEpB,IAAK,MAAM/1C,KAA2BskE,EAAAA,OAAOnxE,MAC3C,IAAK,MAAMqvE,QAASslB,EAAA/yF,QAAEA,KAAmB8tE,EAAAA,SACvC,CAAA,IAAamrB,EAAkB56E,EAAAA,OAClB46E,EAAkB5vD,EAAAA,QAC3BrpC,MAAAA,OAAAA,EAASqe,EAAAA,UACFre,EAAQqe,EAAAA,SAEfre,MAAAA,OAAAA,EAASqpC,EAAAA,UACFrpC,EAAQqpC,EAAAA,QAGnB,MAAiBokC,GAAQz8D,EAAAA,MAAepH,EAAIy/B,EAAOz/B,EAC7C0jB,EAAWmgD,GAAQx8D,EAAAA,OAAgBpH,EAAIw/B,EAAOx/B,EAIpDA,EAFA4jE,GAAAA,MAAAA,GAASnoD,EAAAA,KAAK9b,KAAK2uF,iBAA4BltF,EAAMo+B,EAAAA,OAAU/b,EAAUriB,EAAMo+B,EAAAA,OAAOx/B,IAEtE,QAAZL,EAAAA,KAAK83B,eAAAA,IAAO43D,OAAA,EAAEC,EAAAA,UAAW3vF,KAAK83B,QAAQ/wB,MAAMu9D,SAASsrB,WACvD,CAAA,MAAe/8E,EAAImR,EAAUviB,EAAMo+B,EAAAA,OAAU/b,EAAUriB,EAAMo+B,EAAAA,OAC7Dx/B,GAAI4jE,GAAAA,aACFmqB,GAAA,IAAK,MAAM51F,KAAa21F,EAAAA,QACb,QAAT31F,EAAEyrE,EAAAA,eAAAA,IAAOurB,GAAE7/D,EAAAA,YAAYlW,UAAiB1F,EAAAA,IAAMzL,EAAAA,MAAMwT,KAAK9b,KAAK2uF,iBAAkB3uF,KAAK83B,QAAQ/wB,MAAMu9D,SAASurB,kBAI9G5rB,MAAAA,GAASt0C,EAAAA,YAAYlW,UAAkBqC,GAAAA,KAAK9b,KAAK2uF,iBAAkB3uF,KAAK83B,QAAQ/wB,MAAMu9D,SAASurB,eAYnGX,gBACNv2E,GAAA,MAAkB4hD,EAAOkI,EAAAA,mBACpB,MAAMqtB,KACTC,EAAA,CAAA,MAAkBD,EAAAA,MAAAA,OAAAA,EAAUl7F,EAAAA,IAAIu+C,IAC5Br5B,IACF9Z,KAAK2uF,iBAAiBl1E,UAAoBnR,EAAAA,IAAOwR,EAAUxR,EAAAA,IAC3DtI,GAAAA,KAAK2uF,iBAAiB96E,MAAgBA,EAAAA,MAASiG,EAAUjG,EAAAA,MACzD7T,GAAAA,KAAK2uF,iBAAiB/5E,OAAiBqa,EAAAA,YASrCggE,qBAEFn1E,GAAUy5B,EAAAA,aAA0BL,GAAAA,QACtClzC,KAAK2uF,iBAAiB3+D,OAClBhwB,KAAKigB,SACPjgB,KAAKigB,QAAQnE,KAAK9b,KAAK2uF,mBASrBS,oBACFt1E,GAAUy5B,EAAAA,aAA0BL,GAAAA,OAEtClzC,KAAK2uF,iBAAiBr+D,iBCzKf0/D,WAAbjP,qCACkB/gF,KAAA+hE,MAAS,kCAClBijB,WAAwBlE,GAAAA,KACxB9gF,KAAAghF,UAMA,EAAA4D,WACL5kF,QAAKgI,KAAa2hB,EAAAA,OAAOhO,IACzB3b,KAAK83B,QAAgBnO,EAAAA,OACrB3pB,KAAKigB,QAAgBD,EAAAA,OAGhB5gB,KAAgB5H,EACrB0L,UAAStO,EAAAA,IAAIu+C,IAAwB37C,EAAE5C,EAAAA,IAAIu+C,IAGtCK,EAAAhb,OAA2BlP,EAGhCpmB,GAAA,IACI+sF,EAHJjwF,OAAK8uF,eAIL,MAAerN,EAASnwF,EAAAA,WACnB,IAAQo1F,EAAG32F,EAAIuB,EAAQvB,EAAAA,IACZA,EAAaynD,GAAAA,UAAsBznD,EAAa0vE,GAAAA,cAChDgiB,EAAS1xF,EAAG6E,GAAAA,IAAIu+C,IACfsuC,EAAS1xF,EAAG6E,GAAAA,IAAIkvE,IAE7B9jE,KAAKgI,KAAKgoB,OACVhwB,KAAKivF,qBAELjvF,GAAAA,KAAKgI,KAAKgoB,OACVhwB,KAAKkvF,gBAAyBn/F,EAAAA,IACnB+rB,EAAAA,KAAK9b,KAAKgI,KACrBhI,GAAAA,KAAKgI,KAAKsoB,UAEVtwB,KAAKovF,oBACLpvF,GAAAA,KAAKgI,KAAKsoB,WAAAA,KAGHwH,QAAQ63D,UACf3vF,KAAKgI,KAAKgoB,OACVhwB,KAAKivF,qBACLjvF,GAAAA,KAAKgI,KAAK4T,YAAc,SACd7rB,EAAwB2rB,GAAAA,UAAU1b,KAAKgI,MACjDhI,KAAKovF,oBACLpvF,GAAAA,KAAKgI,KAAKsoB,gBAGLwH,QAAQ63D,UACf3vF,KAAKgI,KAAKgoB,OACVhwB,KAAKigB,QAAQnE,KAAK9b,KAAKgI,MACvBhI,KAAKigB,QAAQvE,UAAU1b,KAAKgI,MAC5BhI,KAAKgI,KAAKsoB,WAAAA,KAGPwH,QAAQ9N,MAAM0gD,UAAUpG,SAASgrB,YAAkC3D,GAAAA,iBACxE3rF,KAAK83B,QAAQ9N,MAAM0gD,UAAUpG,SAASirB,UAAgC9D,GAAAA,cAGhEyD,gBACNv2E,GAAA,MAAkB4hD,EAAOkI,EAAAA,mBACpB,MAAMqtB,KACTI,EAAA,CAAA,MAAkBJ,EAAAA,MAAAA,OAAAA,EAAUl7F,EAAAA,IAAIu+C,IAC5Br5B,IACF9Z,KAAKgI,KAAKyR,UAAoBnR,EAAAA,IAAOwR,EAAUxR,EAAAA,IAC/CtI,GAAAA,KAAKgI,KAAK4M,OAAiBqa,EAAAA,UAC3BjvB,KAAKgI,KAAK6L,MAAgBA,EAAAA,MAASiG,EAAUjG,EAAAA,MAAMxT,KAKjDyuF,oBACD9mF,KAAKK,UAAa,EAAGrI,EAAAA,KAAKgI,KAAKsW,OAAO9W,MAAOxH,KAAKgI,KAAKsW,OAAO7W,QACnEzH,KAAKgI,KAAKQ,UAAYxI,KAAK83B,QAAQxB,gBAAgBrjC,WACnD+M,KAAKgI,KAAKkxB,SAAY,EAAGl5B,EAAAA,KAAKgI,KAAKsW,OAAO9W,MAAOxH,KAAKgI,KAAKsW,OAAO7W,QAG5DwnF,qBACFn1E,GAAUy5B,EAAAA,aAA0BL,GAAAA,QAEtClzC,KAAKgI,KAAKgoB,OACNhwB,KAAKigB,SACPjgB,KAAKigB,QAAQnE,KAAK9b,KAAKgI,OAKrBonF,oBACFt1E,GAAUy5B,EAAAA,aAA0BL,GAAAA,OAEtClzC,KAAKgI,KAAKsoB,YHjFdw7D,GAJUF,KAAWC,GAAA,KAIrBC,GAAA5wB,OAAA,GAAA,SAIA4wB,GAAAA,GAAA1lB,UAAA,GAAA,kBAMW+pB,WAuCXrtB,eAEEstB,EACA7nF,EACA8nF,EACAC,EACAvoF,EACAwoF,EACAC,EACAC,EACAC,EAEAp+E,GAAAA,QAlDKtS,KAAA+H,SAAmB,IAAWylC,EAAG,EACjC,GAAAxtC,KAAAuwF,SAAmB,IAAW/iD,EAAG,EACjC,GAAAxtC,KAAAwwF,aAAuB,IAAWhjD,EAAG,EACrC,GAAAxtC,KAAA2wF,2BACA,EAAA3wF,KAAA4wF,gBAEA,EAAA5wF,KAAAy8E,MAAgB,KAChBz8E,KAAA6wF,WACA,EAAA7wF,KAAAuI,QACA,EAAAvI,KAAAqwF,WAA0Bh5E,GAAAA,MAC1BrX,KAAAswF,SAAwBj5E,GAAAA,MAGxBrX,KAAAowF,KAAe,IACfpwF,KAAA8wF,UAAoB,EAGnB9wF,KAAA+wF,OACA,EAAA/wF,KAAAgxF,OACA,EAAAhxF,KAAAixF,OACA,EAAAjxF,KAAAkxF,OACA,EAAAlxF,KAAAmzE,cAA6B97D,GAAAA,MAE9BrX,KAAAmxF,QAA2B,KAC3BnxF,KAAAoxF,aACA,EAAApxF,KAAAqxF,eAAuC,KAIvCrxF,KAAAsxF,SACA,EAAAtxF,KAAAuxF,kBAEA,EAAAvxF,KAAAw3C,SAAU,EACVx3C,KAAAs3E,aAAc,EAkBnB,IAAcka,EACd1F,EAAIqF,GAAAA,KAAaK,aAA2BC,IAC1C,CAAA,MAAeD,EACfL,EAAU7rD,EAAO6rD,EAAAA,QACV7rD,EAAO8qD,EAAAA,KACJ9qD,EAAO/8B,EAAAA,QACN+8B,EAAOgrD,EAAAA,SACLhrD,EAAO+qD,EAAAA,WACT/qD,EAAOv9B,EAAAA,SACPu9B,EAAOirD,EAAAA,SACHjrD,EAAOkrD,EAAAA,aACVlrD,EAAOmrD,EAAAA,UACTnrD,EAAOorD,EAAAA,aAEdS,QACLnxF,EAAAA,KAAKowF,KAAepwF,GAAAA,KAAKowF,KACzBpwF,KAAKuI,QAAqBvI,GAAAA,KAAKuI,QAC/BvI,KAAKswF,SAAuBtwF,GAAAA,KAAKswF,SAASt7E,QAC1ChV,KAAKqwF,WAA2BrwF,GAAAA,KAAKqwF,WAAWr7E,QAChDhV,KAAKmzE,cAAgBnzE,KAAKqwF,WAAWr7E,QACrChV,KAAK+H,UAAwB/H,GAAAA,KAAK+H,UAAUgM,IAAI/T,KAAKmxF,QAAQ7oF,KAC7DtI,KAAKuwF,SAAuBvwF,GAAAA,KAAKuwF,SACjCvwF,KAAKwwF,aAA+BxwF,GAAAA,KAAKwwF,aACzCxwF,KAAK+wF,QAAU/wF,KAAKswF,SAAatwF,EAAAA,KAAKqwF,WAAgBrwF,GAAAA,KAAKowF,KAC3DpwF,KAAKgxF,QAAUhxF,KAAKswF,SAAatwF,EAAAA,KAAKqwF,WAAgBrwF,GAAAA,KAAKowF,KAC3DpwF,KAAKixF,QAAUjxF,KAAKswF,SAAatwF,EAAAA,KAAKqwF,WAAgBrwF,GAAAA,KAAKowF,KAC3DpwF,KAAKkxF,OAASlxF,KAAKuI,QAAUvI,KAAKowF,KAElCpwF,KAAKywF,UAAyB/b,GAC9B10E,EAAAA,KAAK0wF,QAAqBpa,GAEtBt2E,EAAAA,KAAK0wF,QAAe1wF,GAAAA,KAAKywF,UAAY,IACvCzwF,KAAKsxF,UAAYtxF,KAAK0wF,QAAU1wF,KAAKywF,WAAazwF,KAAKowF,KACvDpwF,KAAKoxF,aAAepxF,KAAKywF,WAG3BzwF,KAAK2/D,aAAc3/D,KAAK8Z,UAAY,IAAIq5B,IACxCnzC,KAAK2/D,aAAa,IAAyBhkD,IAAQ3b,GAAAA,KAAK8b,KAAKH,WACxDgkD,aAAc3/D,KAAKskE,SAAW,IAAIoB,IAEvC1lE,KAAK8Z,UAAUxR,IAAMtI,KAAK+H,SAC1B/H,KAAK8Z,UAAUmV,SAAWjvB,KAAK4wF,gBAC/B5wF,KAAK8Z,UAAUjG,MAAY6E,EAAG,EAC1B1Y,GAAAA,KAAKqxF,gBACPrxF,KAAKskE,SAAS/7D,QAAUvI,KAAKuI,QAC7BvI,KAAKskE,SAASS,IAAW0Q,GAAAA,iBAAiBz1E,KAAKqxF,kBAAAA,KAE1C/sB,SAASwB,WAAcnqD,IACtBqU,EAAAA,OACJhwB,KAAKskE,SAAS/7D,QAAUvI,KAAKuI,QAC7B,MAAiBvI,EAAAA,KAAKmzE,cAAcn+D,QAC3Bzd,EAAIA,EACbokB,EAAI5U,EAAAA,MAAM2qF,UAAch5E,EAAG,EAAI,GAAEtC,CAAAA,MAAiBzC,EAAAA,KAAM3T,KAAKoxF,eACzD9gE,EAAAA,WAKH8nB,YACA+4C,QAAQQ,eAAe3xF,MAGvBw4B,OAAwBlP,EAyB7BpmB,GAxBAlD,GAyBgBA,KAzBXowF,KAAOpwF,KAAKowF,KACjBpwF,EAAAA,KAAKuxF,kBAAoBvxF,KAAKuxF,kBAE1BvxF,EAAAA,KAAKowF,KACPpwF,GAAAA,KAAKo4C,OAGHp4C,KAAK8wF,WACP9wF,KAAKuI,QAAqBvI,EAAAA,KAAKkxF,OAASlxF,KAAKowF,KAAM,KAAQ,IAGzDpwF,KAAKywF,UAAiBzwF,GAAAA,KAAK0wF,QAAU,IACvC1wF,KAAKoxF,aACHpxF,EAAAA,KAAKsxF,SAAmBtxF,EAAAA,KAAKoxF,aAC7Br/F,KAAKwL,IAAIyC,KAAKywF,UAAWzwF,KAAK0wF,SAC9B3+F,KAAKuL,IAAI0C,KAAKywF,UAAWzwF,KAAK0wF,WAAAA,KAI7Bvd,cAAkB9vE,EAAWrD,EAAAA,KAAKmzE,cAAkBnzE,EAAAA,KAAK+wF,OAAgB7tF,EAAG,EAAA,KACjFlD,KAAKmzE,cAAkB36E,EAAWwH,EAAAA,KAAKmzE,cAAkBnzE,EAAAA,KAAKgxF,OAAgB9tF,EAAG,EAAA,KACjFlD,KAAKmzE,cAAkB37E,EAAWwI,EAAAA,KAAKmzE,cAAkBnzE,EAAAA,KAAKixF,OAAgB/tF,EAAG,EAAA,KACjFlD,KAAKmzE,cAAkB57E,EAAWyI,EAAAA,KAAKuI,QAAS,KAE5CvI,GAAAA,KAAKy8E,MACP,CAAA,MAAcz8E,EAAAA,KAAKy8E,MAChBxoE,IAAIjU,KAAK+H,UACTxN,YACAsZ,MAAM7T,KAAK6wF,YACXh9E,MAAc3Q,EAAA,UACZqtF,SAAWvwF,KAAKuwF,SAASx8E,IAAI69E,QAAAA,KAE7BrB,SAAWvwF,KAAKuwF,SAASx8E,IAAI/T,KAAKwwF,aAAa38E,MAAc3Q,EAAA,WAE/D6E,SAAW/H,KAAK+H,SAASgM,IAAI/T,KAAKuwF,SAAS18E,MAAc3Q,EAAA,MAE1DlD,KAAK2wF,6BACP3wF,KAAK4wF,iBAAmB5wF,KAAK4wF,gBAAmB5wF,KAAK2wF,2BAAsCztF,EAAA,MAAanR,EAAAA,KAAK+a,KAG/G9M,KAAK8Z,UAAUxR,IAAMtI,KAAK+H,SAC1B/H,KAAK8Z,UAAUmV,SAAWjvB,KAAK4wF,gBAC/B5wF,KAAK8Z,UAAUjG,MAAY6E,EAAG,EAC9B1Y,GAAAA,KAAKskE,SAAS/7D,QAAUvI,KAAKuI,QAGxBuT,KACLnD,GAAI3Y,GACFA,KADOqxF,eAGP,OAAArxF,KAFKqxF,eAAe9oF,QAAQvI,KAAKuI,cAAAA,KAC5B8oF,eAAev1E,KAAUnD,EAAG,EAInCgD,GAAIqU,EAAAA,OACJhwB,KAAKmzE,cAAkB57E,EAAWyI,EAAAA,KAAKuI,QAAS,KAChDoT,GAAInT,EAAAA,UAAYxI,KAAKmzE,cAAclgF,WAC/Bw6B,EAAAA,YACAO,EAAAA,IAAO,EAAGhuB,EAAAA,KAAKoxF,aAA2B,EAAVr/F,EAAAA,KAAK+a,IACrCshB,EAAAA,OACAN,EAAAA,YACAwC,EAAAA,iBAkBKuhE,WAA8B1B,GAAAA,iBAgBvCC,EACA7nF,EACA8nF,EACAC,EACAvoF,EACAwoF,EACAC,EACAC,EACAC,EAEAp+E,GAAAA,MAAuB89E,EAAM7nF,EAAS8nF,EAAYC,EAAUvoF,EAAUwoF,EAAUC,EAAcC,EAAWC,EAAAA,UAyChGe,WAkJXzmB,wBACE14D,EAAAA,MAAQ9K,CAAAA,MAAmB,QAAZ89B,EAAO99B,EAAAA,aAAAA,IAAKsqF,EAAIA,EAAGrqF,EAAAA,OAAqB,QAAb69B,EAAO79B,EAAAA,cAAAA,IAAMsqF,EAAIA,EAAA,SAlJrDC,iBAED,EAAAhyF,KAAAiyF,aAUA,EAAAjyF,KAAAkyF,YAAsB,EAItBlyF,KAAAmyF,UAAwB,GAAAnyF,KAKxBoyF,cAA4B,GAAApyF,KAK5BqyF,OAIA,EAAAryF,KAAAsyF,OAKA,EAAAtyF,KAAAwwF,aAAuB,IAAWhjD,EAAG,EAKrC,GAAAxtC,KAAAuyF,SAIA,EAAAvyF,KAAAwyF,SAKA,EAAAxyF,KAAAyyF,SAIA,EAAAzyF,KAAA0yF,aAAuB,IAgBvB1yF,KAAA8wF,UAAoB,EAKpB9wF,KAAAy8E,MAAgB,KAIhBz8E,KAAA6wF,WAAqB,KAIrB7wF,KAAAywF,UAAoB,KAIpBzwF,KAAA0wF,QAAkB,KAKlB1wF,KAAA2yF,QAIA,EAAA3yF,KAAA4yF,QAKA,EAAA5yF,KAAAqwF,WAA0Bh5E,GAAAA,MAI1BrX,KAAAswF,SAAwBj5E,GAAAA,MAEvBrX,KAAA6yF,IAA4B,KAC5B7yF,KAAAgkC,QAAkB,KAkBnBhkC,KAAA8yF,YAAuC1sB,GAAAA,UAKvCpmE,KAAAmuB,OAKA,EAAAnuB,KAAA2wF,2BAKA,EAAA3wF,KAAA+yF,gBAA0B,EAQ/B,MACE3yF,EAAC4yF,EACD3yF,EAAC4yF,EAAA3qF,IACE4qF,EAAAhB,WACOiB,EAAAd,OACJ5jD,EAAA6jD,OACAc,EAAA5C,aACM6C,EAAAd,SACJe,EAAAd,SACA39B,EAAA49B,SACAc,EAAAb,aACIlwD,EAAAj6B,QACLirF,EAAA1C,SACCpuD,EAAA+5C,MACHgX,EAAA5C,WACK6C,EAAAjD,UACDnjE,EAAAojE,QACFiD,EAAAhB,QACAtlE,EAAAulE,QACAgB,EAAAvD,WACGwD,EAAAvD,SACFwD,EAAAzC,eACM0C,EAAAjB,YACHkB,EAAA7lE,OACL8lE,EAAAtD,2BACoBuD,EAAAnB,eACZoB,EAAA71F,OAEZ81F,GAAAhkG,OAAH+c,OAAA,GAEDnN,QAAKsI,IAAMA,MAAAA,EAAOuK,EAAIzS,EAAAA,MAAAA,EAAK4yF,EAAG3yF,EAAAA,MAAAA,EAAK4yF,EACnCjzF,GAAAA,KAAKkyF,WAAaA,MAAAA,EAAclyF,EAAAA,KAAKkyF,WACrClyF,KAAKqyF,OAASA,MAAAA,EAAUryF,EAAAA,KAAKqyF,OAC7BryF,KAAKsyF,OAASA,MAAAA,EAAUtyF,EAAAA,KAAKsyF,OAC7BtyF,KAAKwwF,aAAeA,MAAAA,EAAgBxwF,EAAAA,KAAKwwF,aACzCxwF,KAAKuyF,SAAWA,MAAAA,EAAYvyF,EAAAA,KAAKuyF,SACjCvyF,KAAKwyF,SAAWA,MAAAA,EAAYxyF,EAAAA,KAAKwyF,SACjCxyF,KAAKyyF,SAAWA,MAAAA,EAAYzyF,EAAAA,KAAKyyF,SACjCzyF,KAAK0yF,aAAeA,MAAAA,EAAgB1yF,EAAAA,KAAK0yF,aACzC1yF,KAAKuI,QAAUA,MAAAA,EAAWvI,EAAAA,KAAKuI,QAC/BvI,KAAK8wF,SAAWA,MAAAA,EAAY9wF,EAAAA,KAAK8wF,SACjC9wF,KAAKy8E,MAAQA,MAAAA,EAASz8E,EAAAA,KAAKy8E,MAC3Bz8E,KAAK6wF,WAAaA,MAAAA,EAAc7wF,EAAAA,KAAK6wF,WACrC7wF,KAAKywF,UAAYA,MAAAA,EAAazwF,EAAAA,KAAKywF,UACnCzwF,KAAK0wF,QAAUA,MAAAA,EAAW1wF,EAAAA,KAAK0wF,QAC/B1wF,KAAK2yF,QAAUA,MAAAA,EAAW3yF,EAAAA,KAAK2yF,QAC/B3yF,KAAK4yF,QAAUA,MAAAA,EAAW5yF,EAAAA,KAAK4yF,QAC/B5yF,KAAKqwF,WAAaA,MAAAA,EAAcrwF,EAAAA,KAAKqwF,WACrCrwF,KAAKswF,SAAWA,MAAAA,EAAYtwF,EAAAA,KAAKswF,SACjCtwF,KAAKqxF,eAAiBA,MAAAA,EAAkBrxF,EAAAA,KAAKqxF,eAC7CrxF,KAAK8yF,YAAcA,MAAAA,EAAe9yF,EAAAA,KAAK8yF,YACvC9yF,KAAKmuB,OAASA,MAAAA,EAAUnuB,EAAAA,KAAKmuB,OAC7BnuB,KAAK2wF,2BAA6BA,MAAAA,EAA8B3wF,EAAAA,KAAK2wF,2BACrE3wF,KAAK+yF,eAAiBA,MAAAA,EAAkB/yF,EAAAA,KAAK+yF,eAE7C/yF,KAAKkI,KAAKk4C,cAA8BxE,GAAAA,iBAExC57C,KAAK1B,OAASA,MAAAA,EAAU81F,EAAA,IAGxBC,MAAK,IAAQC,EAAGvkG,EAAIiQ,EAAAA,KAAK8nE,OAAOx2E,OAAQvB,IAClCiQ,KAAK8nE,OAAO/3E,aAAcuvE,IAC5Bt/D,KAAK8nE,OAAO/8D,OAAUupF,EAzJ5B,GAAA/rF,qBACS+J,MAAM/J,QAKfA,YACE+J,GAAAA,MAAM/J,QA+CRoQ,EAAA04E,iCACcwB,IAGdxB,mBACErxF,QAAK6yF,IACDz2F,EAAAA,IACF4D,KAAKgkC,QAAiByxC,GAAAA,iBAAiBr5E,IAiGpCu1F,eACL3xF,QAAKoyF,cAAcp/F,KAOd2lB,GAAA47E,qBACLC,MAAK,IAAQC,EAAG1kG,EAAI2kG,EAAe3kG,EAAAA,IACjC,CAAA,MAAUiQ,EAAAA,KAAK20F,uBACVxC,UAAUn/F,KAAK4S,IACL,QAAX5F,EAAAA,MAAAA,UAAAA,EAAAA,KAAMonE,aAAAA,IAAKotB,OAAA,EAAEI,EAAAA,QACf50F,KAAKonE,MAAMwtB,MAAM7gF,IAAInO,IAKpBivF,sBACA1C,UAAU7gG,OAIT,EAAAqjG,kBAEN,IAAWG,EACPC,EAAOC,EAEX,EAAA,MAAcP,EAAmBz0F,EAAAA,KAAKuyF,SAAUvyF,KAAKwyF,SAAUxyF,KAAK1B,QACxD22F,EAAmBj1F,EAAAA,KAAKqyF,OAAQryF,KAAKsyF,OAAQtyF,KAAK1B,QACjD0B,EAAAA,KAAKywF,WAAgCzwF,EAAAA,KAAK2yF,QAAS3yF,KAAK4yF,QAAS5yF,KAAK1B,QACxEksC,EAAMz4C,EAAAA,KAAK4gB,IAChBksE,GAAKr0C,EAAMz4C,EAAAA,KAAK6gB,IAEtB6hF,GAAIz0F,GAGGA,KAHE8yF,cAA4B1sB,GAAAA,UAC5B0uB,EAAmBI,EAAGl1F,EAAAA,KAAKwH,MAAOxH,KAAK1B,QACvC02F,EAAmBE,EAAGl1F,EAAAA,KAAKyH,OAAQzH,KAAK1B,aACtC0B,GACMA,KADD8yF,cAA4B53B,GAAAA,OAC1C,CAAA,MAAei6B,EAAmBD,EAAGl1F,EAAAA,KAAKmuB,OAAQnuB,KAAK1B,QAChD6vB,EAASp8B,EAAAA,KAAK4gB,IACrBoiF,GAAO5mE,EAASp8B,EAAAA,KAAK6gB,IAGvB6hF,GAAA,MAAU5lD,EAAA,IACR7uC,GAAAA,KAAAA,KACK0yF,aACL1yF,KAAKuI,QACLvI,KAAKqwF,WACLrwF,KAAKswF,SACL,IAAW8E,EAAML,EACjBC,GAAA,IAAWpW,EAAIC,EACf7+E,GAAAA,KAAKwwF,aACLxwF,KAAKywF,UACLzwF,KAAK0wF,gBAELI,EAAAA,SAAW9wF,KAAK8wF,SAChBM,EAAAA,aACEpxF,EAAAA,KAAKqxF,iBACLA,EAAAA,eAAiBrxF,KAAKqxF,eACtB/sB,EAAAA,SAAS/7D,QAAUvI,KAAKuI,QACxB+7D,EAAAA,SAASS,IAAI/kE,KAAKgkC,UAEpB2sD,EAAAA,2BAA6B3wF,KAAK2wF,2BAChC3wF,KAAK+yF,iBACLnC,EAAAA,gBAAqCsE,EAAa,EAAVnjG,EAAAA,KAAaiO,GAAAA,KAAK1B,SAE1D0B,KAAKy8E,QACLA,EAAAA,MAAQz8E,KAAKy8E,MAAM1oE,IAAI,IAAW/T,EAAAA,KAAKsI,IAAOtI,EAAAA,KAAKsI,IAAIjI,IACvDwwF,EAAAA,WAAa7wF,KAAK6wF,YAKjBhiD,EAAArW,OAAuBlP,SAC5BhX,EAAAA,MAAMkmB,OAAelP,EAEjBtpB,GAAAA,KAAKkyF,aACPlyF,KAAKgyF,kBAAoBhyF,KAAKyyF,UAAoBvvF,EAAA,KAC9ClD,KAAKgyF,iBAAmB,IAC1BhyF,KAAKu0F,cAAcxiG,KAAKD,MAAMkO,KAAKgyF,mBACnChyF,KAAKgyF,iBAAmBhyF,KAAKgyF,iBAAmBjgG,KAAKD,MAAMkO,KAAKgyF,wBAK/D,IAAQqD,EAAGtlG,EAAIiQ,EAAAA,KAAKoyF,cAAc9gG,OAAQvB,IACpBiQ,EAAAA,KAAKoyF,cAAkBpyF,GAAAA,KAAKmyF,YACtC,QAAXnyF,EAAAA,MAAAA,UAAAA,EAAAA,KAAMonE,aAAAA,IAAKqtB,OAAA,EAAEG,EAAAA,QACf50F,KAAKonE,MAAMwtB,MAAMlkF,OAAO1Q,KAAKoyF,cAAcriG,IAAI,QAG9CqiG,cAAc9gG,OAGd,EAAAwqB,KAGL9b,QAAKmyF,UAAUrhF,SAAelL,GAAEkW,EAAAA,KAAKH,KAGhCD,UACLpJ,GAAAA,MAAMoJ,UACNC,GAAInT,EAAAA,UAAkB2O,GAAAA,MAAMlkB,WACxByV,EAAAA,SAAS,cAAgB1I,KAAKmyF,UAAU7gG,OAAQ0O,KAAKsI,IAAOtI,EAAAA,KAAKsI,IAAQjI,EAAA,IAEzEL,KAAKy8E,QACHvjD,EAAAA,SAASl5B,KAAKy8E,MAAUz8E,EAAAA,KAAKsI,IAAOtI,EAAAA,KAAKy8E,MAAUz8E,EAAAA,KAAKsI,IAAOjI,EAAG,EACtE,GAAcsb,GAAKvG,EAAMqC,GAAAA,OAAQzX,KAAKy8E,MAAUz8E,EAAAA,KAAKsI,IAAOtI,EAAAA,KAAKy8E,MAAUz8E,EAAAA,KAAKsI,IAAOtI,EAAAA,KAAKwZ,OAAUxZ,EAAAA,KAAKwZ,OAC3GmC,GAAIjT,EAAAA,SAAS,QAAS1I,KAAKy8E,MAAUz8E,EAAAA,KAAKsI,IAAOtI,EAAAA,KAAKy8E,MAAUz8E,EAAAA,KAAKsI,IAAIjI,WI/lBlEi1F,WAAbvU,qCACkB/gF,KAAA+hE,MAAS,sBACTijB,WAAwBlE,GAAAA,KACjC9gF,KAAAghF,SAAW,IAMX4D,WACL5kF,QAAK2uF,iBAAyBhlE,EAAAA,OAAOilE,gBACrC5uF,KAAKigB,QAAgBD,EAAAA,OACrBhgB,KAAK83B,QAAgBnO,EAAAA,OACrB3pB,KAAKu1F,iBAAyBX,EAAAA,MAAMtP,cAAc1wF,IAAI01F,IAGxD9xD,OAA2BC,WACzBw8D,EAAA,IAIAj1F,KAJU83B,QAAQ63D,QAChB,OAGF,MAAuB3vF,EAAAA,KAAK83B,QAAQ/wB,MAAMy4B,OAE1C,IACI1nC,EACJ09F,EAAA,MAAuBx1F,EAAAA,KAAK83B,QAAQ/wB,MAAMwzD,OAE1C,IACAk7B,EAAA,MAAmBz1F,EAAAA,KAAK83B,QAAQ/wB,MAAM+S,UAEtC,IACA47E,EAAA,MAAuB11F,EAAAA,KAAK83B,QAAQ/wB,MAAMsuC,OAE1C,IACAsgD,EAAA,MAAyB31F,EAAAA,KAAK83B,QAAQ/wB,MAAM05C,SAEpBzgD,EAAAA,KAAK83B,QAAQ/wB,MAAM8+C,QAE3C,IACA+vC,EAAA,MAAyB51F,EAAAA,KAAK83B,QAAQ/wB,MAAMu9D,SAE5C,IACAuxB,EAAA,MAAqB71F,EAAAA,KAAK83B,QAAQ/wB,MAAMmB,KAEjBlI,EAAAA,KAAK83B,QAAQ/wB,MAAMiZ,WACrC,MAAMu6C,KACT5hD,EAAA,CAAI4hD,GAAOoH,EAAAA,OAAO,aAEhB,SAEEpH,GAAAA,aAEFu7B,GAAA,SAEEC,GAAeC,EAAAA,UAGjB,CAAA,GAF6C,IAAfC,EAAAA,IAAI3kG,SACO2kG,EAAAA,IAAIzkG,SAAgB4M,EAAAA,IAE3D,SAIF,GAKF,KAPkC83F,EAAAA,YACKp+F,EAAAA,KAAKtG,SAAwB0kG,EAAAA,WAEhE,SAIJ,IAAa7pF,EAAOmG,EAAAA,KACpB,MAAmBK,EAAI6F,EAAG,EAAA,IAoD1BxQ,GAnDKqyD,EAAOn8D,EACZtG,GAAOyiE,EAAOziE,EAAAA,KACTyiE,EAAO3lE,EAAAA,IAAIu+C,IAGhBnzC,KAAKivF,qBAELjvF,GAAAA,KAAK2uF,iBAAiB3+D,OAEtBhwB,KAAKkvF,gBACDn/B,GAAAA,KACaomC,EAAAA,SAAsBC,EAAAA,gBAAAA,KAC9BzH,iBAAiB5nF,MAAM2qF,UAAiBl/E,EAAAA,KAAQmB,CAAAA,KAASyC,EAAAA,MAAkBigF,EAAAA,qBAC3E1H,iBAAiB5nF,MAAMuvF,SAAS,MAAShuF,EAAAA,IAAIrV,SAAesjG,GACjEA,GAASA,EAAOxiF,EAAAA,IAAIyiF,KAGHL,EAAAA,SAA0BM,EAAAA,UAAAA,KACtC9H,iBAAiB5nF,MAAMuvF,SAAS,MAAMl4F,MAAU8Q,EAAAA,OAAS,gBAAiC,QAAP+lF,EAAA,QAATllC,EAAG7gD,EAAAA,cAAAA,IAAMwnF,OAAA,EAAEjqD,EAAAA,aAAAA,IAAKwoD,OAAA,EAAE72F,EAAAA,IAAK,IAAM,KAC5Gm4F,GAASA,EAAOxiF,EAAAA,IAAIyiF,KAGHL,EAAAA,SAA0BQ,EAAAA,YAAAA,KACtChI,iBAAiB5nF,MAAMuvF,SAAS,QAAQx+F,KAC7Cy+F,GAASA,EAAOxiF,EAAAA,IAAIyiF,KAGPL,EAAAA,SAAsBS,EAAAA,gBAAAA,KAC9BjI,iBAAiB73B,SACbtkD,EAAAA,KACAqkF,EAAAA,UAAa5nE,EAAAA,UAAUpb,MAAM,IAAIE,IAAWvB,EAAAA,MACxCskF,EAAAA,cAGb92F,GAAAA,KAAK2uF,iBAAiB5nF,MAAMuvF,SAAS,WAA0BvmC,EAAG9gC,EAAAA,UAAUxmB,QAAQ,MACpF8tF,GAASA,EAAOxiF,EAAAA,IAAIyiF,KAGPL,EAAAA,SAAsBY,EAAAA,YACnC/2F,KAAK2uF,iBAAiB73B,SAAgBtkD,EAAAA,KAASqB,EAAAA,MAAME,IAAWvB,EAAAA,MAAkBwkF,EAAAA,WAAY,IAIvFz8B,EAAO3lE,EAAAA,IAAI8wE,IAClBpB,IACmB6xB,EAAAA,SAA4BvG,EAAAA,aACvBjgE,EAAAA,YACjB7T,KAAK9b,KAAK2uF,iBAAmCkB,EAAAA,aAIjDt1B,EAAO3lE,EAAAA,IAAIorD,IACd93C,KACeiuF,EAAAA,SAAwBc,EAAAA,sBAAAA,KAClCtI,iBAAiB5nF,MAAMuvF,SAAS,mBAAwBn2C,EAAAA,MAAMroD,QACnEy+F,GAASA,EAAOxiF,EAAAA,IAAIyiF,KAGLL,EAAAA,SAAwBe,EAAAA,qBAAAA,KAClCvI,iBAAiB5nF,MAAMuvF,SAAS,kBAAuBl2C,EAAAA,iBAC5Dm2C,GAASA,EAAOxiF,EAAAA,IAAIyiF,KAGLL,EAAAA,SAAwBgB,EAAAA,YAAAA,KAClCxI,iBAAiB5nF,MAAMuvF,SAAS,QAAa36B,EAAAA,QAClD46B,GAASA,EAAOxiF,EAAAA,IAAIyiF,KAGLL,EAAAA,SAAwBiB,EAAAA,cAAAA,KAClCzI,iBAAiB5nF,MAAMuvF,SAAS,UAAe1lC,EAAAA,eACpD2lC,GAASA,EAAOxiF,EAAAA,IAAIyiF,KAGLL,EAAAA,SAAwBkB,EAAAA,gBAAAA,KAClC1I,iBAAiB5nF,MAAMuvF,SAAS,YAAiB16B,EAAAA,SAAgBjL,EAAAA,SAAU,gBAChF4lC,GAASA,EAAOxiF,EAAAA,IAAIyiF,KAAAA,KAInB7H,iBAAiBr+D,UAEbiqC,EAAO3lE,EAAAA,IAAIs4C,IAChBmI,KACiB8gD,EAAAA,SAA0BmB,EAAAA,gBAAAA,KACtC3I,iBAAiB5nF,MAAMuvF,SAAS,MAAa9rD,EAAAA,IAAIv3C,SAAesjG,GACrEv2F,GAAAA,KAAK2uF,iBAAiB73B,SAAYljB,EAAAA,UAAcA,EAAAA,UAAU7/B,IAAWy2B,EAAAA,KAAqB+sD,EAAAA,cAC1FhB,GAASA,EAAOxiF,EAAAA,IAAIyiF,KAGHL,EAAAA,SAA0BqB,EAAAA,mBAC3Cx3F,KAAK2uF,iBAAiB73B,SAAYljB,EAAAA,UAAcA,EAAAA,UAAU7/B,IAAWo5B,EAAAA,KAAqBsqD,EAAAA,kBAAmB,IAKlGl9B,EAAO3lE,EAAAA,IAAI4kE,IAExBm8B,EAAA,CAAA,MAAiBxK,EAAav2F,EAAAA,MAI9B,IAHqBuhG,EAAAA,SAA4BuB,EAAAA,eACtC3wF,EAAAA,MAAM/G,KAAK2uF,iBAAmCgJ,EAAAA,eAEpCxB,EAAAA,SAA4BvG,EAAAA,WAC3CnvC,GAAAA,aAAuCsE,GACzC,CAAA,MAAkBtE,EAASoE,EAAAA,mBACtB,MAAMpE,KACTm3C,EAAA,CAAA,MAAen3C,EAASS,EAAAA,OACZruC,EAAIquC,EAAOzuD,EAAAA,KAAasmB,EAAAA,UAC/B41E,iBAAiB5nF,MAAMiV,SAAa5b,EAAGkI,EAAIjI,EAAG6gD,EAAO15C,EAAAA,MAAcC,EAAAA,OAAU2O,CAAAA,MAAwBy5E,EAAAA,eACrFsG,EAAAA,SAA4B0B,EAAAA,YAC/C73F,KAAK2uF,iBAAiB5nF,MAAMuvF,SAAS,YAAqB7pD,EAAAA,MAAMruC,MAGpE+sF,GAAajqC,EAAAA,OAAOplC,KAAK9b,KAAK2uF,iBAAmCkB,EAAAA,iBAEjE,CAAA,MAAe1E,EAAajqC,EAAAA,OAChBruC,EAAIquC,EAAOzuD,EAAAA,KAAasmB,EAAAA,UAC/B41E,iBAAiB5nF,MAAMiV,SAAa5b,EAAGkI,EAAIjI,EAAG6gD,EAAO15C,EAAAA,MAAcC,EAAAA,OAAU2O,CAAAA,MAAwBy5E,EAAAA,eACrFsG,EAAAA,SAA4B0B,EAAAA,YAC/C73F,KAAK2uF,iBAAiB5nF,MAAMuvF,SAAS,YAAyB7pD,EAAAA,MAAMruC,MAAOkK,SAM9E8mF,oBAQPqG,GALAz1F,GAM6BA,KANxB2uF,iBAAiB3+D,OACtBhwB,KAAKigB,QAAQnE,KAAK9b,KAAK2uF,mBACHwH,EAAAA,SAA2B2B,EAAAA,oCAC7C93F,KAAKu1F,iBAAiBxuF,MAAM/G,KAAK2uF,kBAEfwH,EAAAA,SAA2B4B,EAAAA,uBAAyCC,EAAAA,qBACtF,IAAK,MAAU9sE,EAAAA,KAAAA,KAAiB4M,QAAQ/wB,MAAMijB,MAAM0gD,UAAU7kB,QAAQsB,SACpE,CAAI8wC,GAAgB9B,EAAAA,SAA2B4B,EAAAA,sBAC7C,IAAK,MAAMr+E,KAAiBR,EAAAA,OAC1BlZ,KAAK2uF,iBAAiB5nF,MAAM2qF,UAAmB/9E,EAAAA,CAAAA,KAASyC,EAAAA,MAAuB8hF,EAAAA,wBAI/ED,GAAgB9B,EAAAA,SAA2B6B,EAAAA,qBAC7C,IAAK,MAAMt+E,KAAiBR,EAAAA,OAC1BlZ,KAAK2uF,iBAAiB5nF,MAAM+vD,SAAgB5rC,EAAQ1W,EAAAA,OAAOX,MAAM,IAAIE,IAAYokF,GAC/E/hF,CAAAA,MAAuBgiF,EAAAA,4BAM5BzJ,iBAAiBr+D,UAElB+nE,IACFr4F,KAAK2uF,iBAAiB3+D,OACtBhwB,KAAKigB,QAAQnE,KAAK9b,KAAK2uF,mBACJwH,EAAAA,SAA0BmC,EAAAA,YAC3Ct4F,KAAK2uF,iBAAiBv+B,WAAWpwD,KAAKigB,QAAQ3X,IAAQ+vF,EAAeE,EAAAA,aAEpDpC,EAAAA,SAA0BqC,EAAAA,WAC3Cx4F,KAAK2uF,iBAAiB5nF,MAAMuvF,SAAS,QAAQt2F,KAAKigB,QAAQ4C,QAAS7iB,KAAKigB,QAAQ3X,KAElFtI,KAAK2uF,iBAAiBr+D,WAAAA,KAGnBq+D,iBAAiBU,QAOhBH,gBACNv2E,GAAA,MAAkB4hD,EAAOkI,EAAAA,mBACpB,MAAMqtB,KACT2I,EAAA,CAAA,MAAkB3I,EAAAA,MAAAA,OAAAA,EAAUl7F,EAAAA,IAAIu+C,IAC5Br5B,IACF9Z,KAAK2uF,iBAAiBl1E,UAAoBnR,EAAAA,IAAOwR,EAAUxR,EAAAA,IAC3DtI,GAAAA,KAAK2uF,iBAAiB96E,MAAgBA,EAAAA,MAASiG,EAAUjG,EAAAA,MACzD7T,GAAAA,KAAK2uF,iBAAiB/5E,OAAiBqa,EAAAA,YASrCggE,qBAEFn1E,GAAUy5B,EAAAA,aAA0BL,GAAAA,QACtClzC,KAAK2uF,iBAAiB3+D,OAClBhwB,KAAKigB,SACPjgB,KAAKigB,QAAQnE,KAAK9b,KAAK2uF,mBASrBS,oBACFt1E,GAAUy5B,EAAAA,aAA0BL,GAAAA,OAEtClzC,KAAK2uF,iBAAiBr+D,eCpRhBooE,GCQAC,GAUAC,GChBAC,GAWAC,GAQAC,MCvBVC,GHIAC,GCOAC,GCNAC,GEsXUC,GAAAA,GAlEVC,GCvTUC,GACVC,uUCkCK/D,SAAMgE,WAgEXh5B,iBACEluD,QAhEMtS,KAAAwd,QAAyB3L,EAAAA,cAI1B7R,KAAAggB,OAAiB,IAKjBy5E,GAAAz5F,KAAA40F,MAAQ,IAAU50F,GAAAA,MAAAA,KAkDjBqhE,gBAA0B,EAC1BrhE,KAAA05F,QAAmB,GAAA15F,KACnB25F,aAAwB,GAAA35F,KAMzB40F,MAAM7gF,IAAI,IAAI+xE,IACnB9lF,KAAK40F,MAAM7gF,IAAI,IAAIu2E,IACT14E,EAAAA,UAAiBxM,EAAAA,eACzBpF,KAAK40F,MAAM7gF,IAAI,IAAIi8E,IAEnBhwF,KAAK40F,MAAM7gF,IAAI,IAAI26E,IAErB1uF,KAAK40F,MAAM7gF,IAAI,IAAIuhF,IA5DrBhT,yBACcsS,MAAM9Q,cAAcrC,SAASjiD,QAChCt8B,GAAAA,aAAa+jE,KAIxBwa,2BACcmT,MAAM9Q,cAAcrC,SAMlCmY,2BACchF,MAAM9Q,cAAcrC,SAASjiD,QAChCt8B,GAAAA,aAAaq9E,KAOxBsZ,2BACcjF,MAAM9Q,cAAcrC,SAASjiD,QAChCt8B,GAAAA,aAAag3E,KAiBxB4f,iCACcxX,OAAO9iD,QAAcjoC,GAAAA,aAAawzE,KA+BtCz+C,GAAmB5B,EAC3BpY,GAAAA,MAASga,GAAW5B,EAafxnB,GAAAwpB,KAAwBhC,EAC7BpY,GAAAA,MAAMoa,KAAgBhC,EAajBxnB,GAAAkc,IAAuBsL,EAC5BpY,GAAAA,MAAM8M,IAAesL,EAOhBxnB,GAAAugE,aAAa3rC,IAQbiiE,WAA6BC,EAAAA,IAQ7BC,aAA+BD,EAAAA,IAS/Br2B,YAA6BlrC,EAAAA,IAS7BorC,aAA8BprC,EAAAA,IAS9BotC,UAA0CptC,EAAAA,IAS1CqtC,WAA2CrtC,EAAAA,IAO1CyhE,0BACD,MAAMn3B,KAAAA,KAAc0e,SACjB5qC,EAAAA,YAAY72C,KAAK2pB,QAO3B65C,gCACcnC,eAUPxqB,YACA72C,QAAKwjE,gBACRxjE,KAAK2pB,OAIL3pB,EAAAA,KAAKyjE,aAAa5xE,KAAKmO,KACvBA,GAAAA,KAAKk6F,sBAELl6F,KAAKwd,QAAQzW,MAAM,qBAAsB/G,KACzCA,GAAAA,KAAK8sB,gBAAgBT,KAAK,aAAc,IAAoB1C,GAAQ3pB,EAAAA,OAAAA,KAC/DqhE,gBAAiB,GAUnB84B,UAA2BvuE,EAChC5rB,QAAKwd,QAAQzW,MAAM,mBAAoB/G,MAAAA,KAClC+5F,WAAqBnuE,EASrB1oB,GAAAk3F,YAA6BxuE,EAClC5rB,QAAKwd,QAAQzW,MAAM,qBAAsB/G,MAAAA,KACpCi6F,aAAuBruE,EASvB1oB,GAAAwgE,WAA4Bp6C,EACjCtpB,QAAKqsB,KAAK,YAAa,IAAmByL,GAASxO,EAAOtpB,EAAAA,OAAAA,KACrD2jE,YAAqBr6C,EASrBpmB,GAAA0gE,YAA6Bt6C,EAClCtpB,QAAKqsB,KAAK,aAAc,IAAoByL,GAASxO,EAAOtpB,EAAAA,OAAAA,KACvD6jE,aAAsBv6C,EAUtBpmB,GAAA0nE,SAAyCnyC,EAC9Cz4B,QAAKqsB,KAAK,UAAW,IAAiBrkB,GAAMywB,EAAQz4B,EAAAA,OAAAA,KAC/C6lE,UAAgBptC,EAUhBv1B,GAAA2nE,UAA0CpyC,EAC/Cz4B,QAAKqsB,KAAK,WAAY,IAAkBrkB,GAAMywB,EAAQz4B,EAAAA,OAAAA,KACjD8lE,WAAiBrtC,EAQjBv1B,GAAAs1B,OAAuBlP,EAM5BpmB,GAAA,IAAe2D,EAEfsuF,WAPKzxB,WAAmBp6C,EACpBtpB,GAAAA,KAAKggB,QACPhgB,KAAKggB,OAAOwY,OAAelP,EAKxBv5B,GAAIsqG,EAAGxzF,EAAM7G,EAAAA,KAAK25F,aAAaroG,OAAYuV,EAAK9W,EAAAA,IACnDiQ,KAAKs6F,YAAYt6F,KAAK25F,aAAa5pG,SAEhC4pG,aAAaroG,OAGlB,MAAK,MAAMipG,KAAAA,KAAcb,QACjBlhE,EAAAA,OAGRx4B,QAAK40F,MAAMp8D,OAAkBqoD,GAAAA,OAE7B7gF,GAAAA,KAAKw6F,mBAEL7wE,GAAOztB,EAAAA,MAAM8jE,SAASy6B,wBAEtBz6F,KAAK4jE,YAAoBt6C,EAQpBpmB,GAAA4Y,KAAoCwN,SACzCtpB,OAAK4qE,SAActhD,EAEnBtpB,GAAAA,KAAK40F,MAAMp8D,OAAkBsoD,GAAAA,KAAMx3D,IAEpB,QAAXtpB,EAAAA,KAAK2pB,cAAAA,IAAM0wE,OAAA,EAAE1K,EAAAA,UACf3vF,KAAK0b,UAEP1b,GAAAA,KAAK6qE,UAAevhD,EASfpmB,GAAAwY,UACL1b,QAAKqsB,KAAK,eAAgB,IAAsB1Q,GAAK3b,EAAAA,OAAAA,KAEhDqsB,KAAK,gBAAiB,IAAuB1Q,GAAK3b,EAAAA,OAMlDyP,SACLkJ,eAAY2pE,OAAO7wF,QAAQs5B,IAiCtB,EAAAhX,IACL/T,QAAKqsB,KAAK,cAAiBr4B,CAAAA,OAAQumE,SAC9Bq6B,MAAM7gF,IACXwmD,GAAO6M,EAAAA,MAAQpnE,KACXu6D,aAAkBwR,KACD/rE,EAAAA,KAAK05F,QAASn/B,IAC/Bv6D,KAAK06F,SAASngC,IA+Bb7pD,OACD6pD,GAAAA,aAAkBgG,KACpBvgE,KAAKqsB,KAAK,gBAAmBr4B,CAAAA,OAAQumE,SAChCq6B,MAAMlkF,OAAO6pD,IAEhBA,aAAkBwR,IACpB/rE,KAAKs6F,YAWF3hF,GAAAgiF,iBACL36F,QAAK+T,IAQA4E,GAAAiiF,oBACL56F,QAAK0Q,OAQAiI,GAAAkiF,WACL76F,QAAK40F,MAAM7gF,IAQN4E,GAAAmiF,cACL96F,QAAK40F,MAAMlkF,OAONiI,GAAA+hF,SAGL/hF,eAFK+gF,QAAQ1mG,KACbunG,GAAMnzB,EAAAA,MAAQpnE,KAST2Y,EAAA2hF,YACL3hF,GAAA,MAAU3Y,EAAAA,KAAK05F,QAAQjoG,QAIvBknB,UAHW,IACT3Y,GAAAA,KAAK05F,QAAQ3uF,OAAUgwF,EAElBR,GAOF5hF,EAAAk0D,YAELl0D,eADKghF,aAAa3mG,KACXunG,GAMF5hF,EAAAqiF,cACLriF,eAAY+gF,QAAQjoG,QAAQ8oG,IAAU,IAAYruB,EAAAA,SAG7C+uB,8BACItxE,QACA3pB,KAAK2pB,OAAO61C,eAAiBx/D,KAKhCw6F,mBACN7hF,OAAK,MAAMuiF,KAAAA,KAAYpB,eACd9vE,EAAAA,MAAM0gD,UAAU4X,OAAO5iC,SAG3B,MAAM30B,KAAAA,KAAcu3D,OAChBt4D,CAAAA,EAAAA,MAAM0gD,UAAU4X,OAAO6Y,YACzB,MAAMp4B,KAAeT,EAAAA,SACOS,GAE7Bp5C,GAAOK,EAAAA,MAAM0gD,UAAU4X,OAAO5iC,KAEvB11B,EAAAA,MAAM0gD,UAAU4X,OAAO6Y,UAtdtCC,GAJCppF,CACC5J,EAAAA,CAAAA,QAAS,uCACT6J,gBAAiB,0HA+XnBmpF,GADCppF,CAAW5J,EAAAA,CAAAA,QAAS,uCAAwC6J,gBAAiB,yDAU9EmpF,GADCppF,CAAW5J,EAAAA,CAAAA,QAAS,uCAAwC6J,gBAAiB,+DAU9EmpF,GADCppF,CAAW5J,EAAAA,CAAAA,QAAS,uCAAwC6J,gBAAiB,mDAU9EmpF,GADCppF,CAAW5J,EAAAA,CAAAA,QAAS,uCAAwC6J,gBAAiB,0DHpf9E+mF,GADUqC,KAAcC,GAAA,KACxBtC,GAAAuC,UAAA,GAAA,YACAvC,GAAAA,GAAAwC,YAAA,GAAA,cACAxC,GAAAA,GAAAyC,UAAA,GAAA,kBAqFAC,eAA0CC,EAAoBZ,GAAA,EAA0CM,EAAeE,GAAAA,gBAApG5xE,OAAuBqvE,EAAAh5F,KAAA27F,SAAkCZ,EAAA/6F,KAAA47F,UA1EpEC,EAAA77F,KAAA87F,cACN,8SAkBM97F,KAAA+7F,gBACN,oxBAuDA/7F,KAAKg8F,gBAAkBlnG,SAASE,cAAc,UAC9CgL,KAAKg8F,gBAAgBx0F,MAAe+Z,EAAAA,UACpCvhB,KAAKg8F,gBAAgBv0F,OAAgB+Z,EAAAA,WAGrCxhB,KAAKi8F,IAA6Bj8F,KAAKg8F,gBAAgB/zF,WAAW,QAAWi0F,CAAAA,uBAAuB,SAE/FC,SAAWn8F,KAAKi8F,IAAIG,gBACzB,MAAuBp8F,EAAAA,KAAKq8F,WAAW,WAAYr8F,KAAKs8F,yBAAyBV,IAC3D57F,EAAAA,KAAKq8F,WAAW,SAAUr8F,KAAK87F,oBAEhDG,IAAIM,aAAav8F,KAAKm8F,SAC3Bn8F,GAAAA,KAAKi8F,IAAIM,aAAav8F,KAAKm8F,SAC3Bn8F,GAAAA,KAAKi8F,IAAIO,YAAYx8F,KAAKm8F,UAErBn8F,KAAKi8F,IAAIQ,oBAAoBz8F,KAAKm8F,SAAUn8F,KAAKi8F,IAAIS,cACjD7qF,EAAAA,cAAcne,MAAM,kCAG7BsM,KAAKi8F,IAAIU,WAAW38F,KAAKm8F,UAGnBG,yBACN3jF,GAAA,IAAWikF,EAAA,UACPhB,IAA6BL,GAAAA,UAE7BqB,EAAA,8HAGOhB,IAA6BJ,GAAAA,YAEpCoB,EAAA,8HAGOhB,IAA6BH,GAAAA,YAEpCmB,EAAA,iIAKA58F,KAAK27F,SACP37F,KAAK+7F,gBAAkB/7F,KAAK+7F,gBAAgBphG,QAAQ,eAAgB,8BAEpEqF,KAAK+7F,gBAAkB/7F,KAAK+7F,gBAAgBphG,QAAQ,eAAgB,mCAG/DqF,KAAK+7F,gBAAgBphG,QAAQ,gBAG9BiiG,GAAAC,cAAyBx8F,EAAWmH,EAAeC,EACzDqC,GAAA,MAAW1J,EACLitB,EAAKjtB,EAAIoH,EACT4lB,EAAK/sB,EACLitB,EAAKjtB,EAAIoH,EACfzH,OAAKi8F,IAAIa,WAAW98F,KAAKi8F,IAAIc,aAAc,IAAIrvD,aAAcvgB,CAAIC,EAAIC,EAAID,EAAID,EAAIG,EAAIH,EAAIG,EAAID,EAAID,EAAIC,EAAIC,EAAAA,SAAW2uE,IAAIe,aAGlHX,WAAyBY,EAC/B/5F,GAAA,IAYAg6F,qBAVEC,EAASn9F,EAAAA,KAAKi8F,IAAImB,aAAap9F,KAAKi8F,IAAIoB,iBACtB,WAClBF,EAASn9F,EAAAA,KAAKi8F,IAAImB,aAAap9F,KAAKi8F,IAAIqB,eAEjCzrF,EAAAA,cAAcne,MAAM,4BAG7BsM,GAAAA,KAAKi8F,IAAIsB,aAAqBN,EAC9Bj9F,GAAAA,KAAKi8F,IAAIuB,cAEJx9F,GAAAA,KAAKi8F,IAAIwB,mBAA2Bz9F,EAAAA,KAAKi8F,IAAIyB,gBAChDx3F,GAAO2L,EAAAA,cAAcne,MAAM,4BAA6BsM,KAAKi8F,IAAI0B,iBAAiBR,IAC3E,MAMJ3nG,QAA0BooG,EAE/B16F,GAAA,MAAyBlD,EAAAA,KAAKi8F,IAAI4B,kBAAkB79F,KAAKm8F,SAAU,cAC1Cn8F,EAAAA,KAAKi8F,IAAI4B,kBAAkB79F,KAAKm8F,SAAU,cAE5Cn8F,EAAAA,KAAKi8F,IAAIv3E,oBAC3Bu3E,IAAI6B,WAAW99F,KAAKi8F,IAAIc,aAC7B/8F,GAAAA,KAAKi8F,IAAIa,WACP98F,KAAKi8F,IAAIc,aACT,IAAIrvD,aAAc,CAAK,EAAK,EAAK,EAAK,EAAK,EAAK,EAAK,EAAK,EAAK,EAAK,EAAK,EAAA,SACpEuuD,IAAIe,aAEXh9F,KAAKi8F,IAAI8B,wBACT/9F,GAAAA,KAAKi8F,IAAI+B,oBAAsCC,EAAGj+F,EAAAA,KAAKi8F,IAAIiC,OAAO,EAAU,EAG5E,GAAA,MAAgBl+F,EAAAA,KAAKi8F,IAAIrqE,qBACpBqqE,IAAI3qE,YAAYtxB,KAAKi8F,IAAI1qE,WAG9BvxB,GAAAA,KAAKi8F,IAAIpqE,cAAc7xB,KAAKi8F,IAAI1qE,WAAYvxB,KAAKi8F,IAAInqE,eAAgB9xB,KAAKi8F,IAAIlqE,eAC9E/xB,KAAKi8F,IAAIpqE,cAAc7xB,KAAKi8F,IAAI1qE,WAAYvxB,KAAKi8F,IAAIjqE,eAAgBhyB,KAAKi8F,IAAIlqE,eAC9E/xB,KAAKi8F,IAAIpqE,cAAc7xB,KAAKi8F,IAAI1qE,WAAYvxB,KAAKi8F,IAAIhqE,mBAAoBjyB,KAAKi8F,IAAI/pE,SAClFlyB,KAAKi8F,IAAIpqE,cAAc7xB,KAAKi8F,IAAI1qE,WAAYvxB,KAAKi8F,IAAI9pE,mBAAoBnyB,KAAKi8F,IAAI/pE,SAElFlyB,KAAKi8F,IAAIkC,YAAYn+F,KAAKi8F,IAAImC,oBAE9Bp+F,GAAAA,KAAKi8F,IAAIxqE,WAAWzxB,KAAKi8F,IAAI1qE,WAAevxB,EAAAA,KAAKi8F,IAAIvqE,KAAM1xB,KAAKi8F,IAAIvqE,KAAM1xB,KAAKi8F,IAAItqE,cAGnFhZ,GAAA,MAA2B3Y,EAAAA,KAAKi8F,IAAIoC,mBAAmBr+F,KAAKm8F,SAAU,qBAGjEF,IAAIqC,UAA8Bt+F,EAAAA,KAAKg8F,gBAAgBx0F,MAAOxH,KAAKg8F,gBAAgBv0F,QAGxF,MAAuBzH,EAAAA,KAAKi8F,IAAIv3E,oBAC3Bu3E,IAAI6B,WAAW99F,KAAKi8F,IAAIc,aAC7B/8F,GAAAA,KAAKi8F,IAAI8B,wBACT/9F,GAAAA,KAAKi8F,IAAI+B,oBAAsCd,EAAGl9F,EAAAA,KAAKi8F,IAAIiC,OAAO,EAAU,EAG5El+F,GAAAA,KAAK68F,cAAiB,EAAG5rE,EAAMzpB,EAAAA,MAAaC,EAAAA,QAG5CzH,KAAKi8F,IAAIsC,WAAWv+F,KAAKi8F,IAAIuC,UAAc,EAG3C,GAAA,MAAkB/I,EAAA,IAAIgJ,WAAiBj3F,EAAAA,MAAcC,EAAAA,OACrDzH,QAAKi8F,IAAIyC,WAAc,EAAGztE,EAAMzpB,EAAAA,MAAaC,EAAAA,OAAQzH,KAAKi8F,IAAIvqE,KAAM1xB,KAAKi8F,IAAItqE,cAEvEV,GAAM32B,EAAAA,KAAMrB,IAElB2kG,GAAI/7D,EAAAA,aAAoBlpB,EAAG,EAAA,UIvN7BgmF,eACE3+F,QAAK83B,QAGA8mE,EAAAC,QACL7+F,QAAK83B,QAAQgnE,eAAe9rG,KAAK,IAAwBgN,GAAAA,KAAK83B,SAAS,EAAOinE,IAGzEpD,SACL37F,QAAK83B,QAAQgnE,eAAe9rG,KAAK,IAAwBgN,GAAAA,KAAK83B,SAAS,EAAMinE,WCyI/E/1F,eASOg2F,QAAAh1E,MAKL0gD,CAAAA,UAAW,IAMXu0B,GAAAA,UAAW,IAAIC,SAYV1/D,OAILw2D,CAAAA,WAAW,EAIXE,UAAW,GAIXD,IAAK,SAMA17B,OACL47B,CAAAA,SAAS,EACTM,QAAQ,EACRE,UAAU,QAML78E,UACLq8E,CAAAA,SAAS,EAETC,cAAc,EACdC,cAAqB5+E,GAAAA,OAErBs/E,WAAW,EACXC,WAAkB3+E,GAAAA,MAElBu+E,cAAc,EACdE,cAAqB7+E,GAAAA,WAMhBqsD,SACL6xB,CAAAA,SAAS,EAETvG,YAAY,EACZC,YAAmBp4E,GAAAA,aAMdgpC,SACL01C,CAAAA,SAAS,EAETvG,YAAY,EACZC,YAAmB53E,GAAAA,KAEnB4/E,WAAW,EAEXH,cAAc,EACdC,cAAqBt/E,GAAAA,YAMhBwtC,QACLswC,CAAAA,SAAS,EAET2B,mCAAmC,EAEnCE,sBAAsB,EACtBI,qBAA4BjgF,GAAAA,KAE5B4/E,uBAAuB,EACvBG,sBAA6BvgF,GAAAA,UAMxB09B,OACL8gD,CAAAA,SAAS,EAETmB,cAAc,EACdC,cAAqB9/E,GAAAA,OAErB+/E,kBAAkB,EAClBC,kBAAyB9/E,GAAAA,UAMpBzP,KACLiuF,CAAAA,SAAS,EAETc,oBAAoB,EACpBC,mBAAmB,EACnBG,cAAc,EACdD,YAAY,EACZD,UAAU,QAMLn3E,OACLm2E,CAAAA,SAAS,EAETmC,WAAW,EACXC,WAAkB5gF,GAAAA,IAElB6gF,UAAU,QAlJL1gE,QAEL93B,EAAAA,KAAKm/F,eAAiB,IAAoBn/F,GAAAA,KAAK83B,gBAwJnDzgC,sBACU+nG,IACA,EAAAp/F,KAAAy4B,OACA,EAAAz4B,KAAAq/F,KACA,EAAAr/F,KAAAs/F,YACNnE,CAAAA,MACA5Y,EAAAA,OACA7iC,EAAIA,GACJ,EAAA6/C,4BACcpE,MAAQn7F,KAAKuiF,QAE3Bid,wBACcD,UAAYv/F,KAAK0/C,UAGzB+/C,eACNjnE,CAAAA,OACA1c,EAAAA,KACA,EAAA0jF,wBACchnE,OAASx4B,KAAK8b,YAItB4jF,cAA8B,IAE9BC,GAAA3/F,KAAA4/F,eACNrQ,CAAAA,UACAD,EAAAA,YAQK,GAAAvtD,MACD89D,GACF7/F,GAAAA,KAAU6/F,GAAWzhG,EACrB4B,GAAAA,KAAKspB,MAAmBA,EAAAA,MACxBtpB,KAAK8/F,IAAiBA,EAAAA,IACtB9/F,KAAKsiF,OAAO6Y,MAAmB7Y,EAAAA,OAAO6Y,MACtCn7F,KAAKsiF,OAAOC,OAAoBD,EAAAA,OAAOC,OACvCviF,KAAKsiF,OAAYud,GAAWvd,EAAAA,OAC5BtiF,GAAAA,KAAKsnC,SAAS9O,OAAoB8O,EAAAA,SAAS9O,OAC3Cx4B,KAAKsnC,SAASxrB,KAAkBwrB,EAAAA,SAASxrB,KACzC9b,KAAK0/F,cAAc39D,MAAiB8jB,EAAAA,SACpC7lD,KAAKskE,SAASirB,UAAuBjrB,EAAAA,SAASirB,UAC9CvvF,KAAKskE,SAASgrB,YAAyBhrB,EAAAA,SAASgrB,cAEhDtvF,KAAUA,GAAAA,KAAKspB,MAAQtpB,KAAK8/F,IAC5B9/F,EAAAA,KAAKsiF,OAAO6Y,MAAQn7F,KAAKsiF,OAAOC,OAASviF,KAAKsiF,OAAY5iC,GAC1D1/C,EAAAA,KAAKsnC,SAAS9O,OAASx4B,KAAKsnC,SAASxrB,KACrC9b,EAAAA,KAAK0/F,cAAc39D,QACnB/hC,KAAKskE,SAASgrB,YAActvF,KAAKskE,SAASirB,UAOvC,GAAAv6E,QACL,MAAW+qF,EAAA,IAIX1oG,UAFG0qC,EAAAA,MAAM/hC,MAQX+/F,EAAA3hG,qBACcghG,IAMAhuG,OACZ4O,QAAKo/F,IAMPzmF,EAAA2Q,wBACcmP,OAOdnP,UACEtpB,QAAKy4B,OAMP9f,EAAAmnF,sBACcT,KAOdS,QACE9/F,QAAKq/F,KAMP1mF,EAAA2pE,yBACcgd,YAMdh4D,2BACcm4D,eAMd55C,0BACc65C,cAMdp7B,2BACcs7B,sBAIhBD,sBACUK,OACA,EAAAhgG,KAAAykD,YACA,EAAAzkD,KAAAigG,UAA2C,IAAIttE,IAC/C3yB,KAAAkgG,YACA,EAAAlgG,KAAAmgG,oBACA,EAAAngG,KAAAogG,YACA,EAAApgG,KAAAqgG,aAOD,EAAAt+D,MACD89D,GACF7/F,GAAAA,KAAK8lD,MAAmBA,EAAAA,MACxB9lD,KAAKsnD,WAAwBA,EAAAA,WAC7BtnD,KAAKmnD,SAAsBA,EAAAA,SAC3BnnD,KAAKkmD,WAAwBA,EAAAA,WAC7BlmD,KAAKgnD,mBAAgCA,EAAAA,mBACrChnD,KAAKolD,WAAwBA,EAAAA,WAC7BplD,KAAKinD,YAAyBA,EAAAA,cAE9BjnD,KAAK8lD,MAAQ9lD,KAAKsnD,WAAatnD,KAAKkmD,WACpClmD,EAAAA,KAAKgnD,mBAAqBhnD,KAAKolD,WAAaplD,KAAKinD,YACjDjnD,EAAAA,KAAKmnD,SAAS72C,SAOX0E,QACL,MAAWsrF,EAAA,IAIXX,UAFG59D,EAAAA,MAAM/hC,MAKXsgG,EAAAx6C,wBACck6C,OAGdl6C,UACE9lD,QAAKggG,OAGPrnF,EAAA2uC,6BACc7C,YAGd6C,eACEtnD,QAAKykD,YAGP9rC,EAAAwuC,2BACc84C,UAGd94C,aACEnnD,QAAKigG,UAGPtnF,EAAAutC,6BACcg6C,YAGdh6C,eACElmD,QAAKkgG,YAGPvnF,EAAAquC,qCACcm5C,oBAGdn5C,uBACEhnD,QAAKmgG,oBAGPxnF,EAAAysC,6BACcg7C,YAGdh7C,eACEplD,QAAKogG,YAGPznF,EAAAsuC,8BACco5C,aAGdp5C,gBACEjnD,QAAKqgG,aAAejvG,IRzhBtB6nG,GAFUP,KAAI6H,GAAA,KAEdC,KAAA,UACAvH,GAAAwH,KAAA,UACAxH,GAAAyH,KAAA,UACAzH,GAAA0H,KAAA,UACA1H,GAAA2H,KAAA,UACA3H,GAAA4H,KAAA,UACA5H,GAAA6H,KAAA,UACA7H,GAAA8H,KAAA,UACA9H,GAAA+H,KAAA,UACA/H,GAAAgI,KAAA,UACAhI,GAAAiI,OAAA,YACAjI,GAAAkI,YAAA,iBACAlI,GAAAmI,YAAA,iBACAnI,GAAAoI,UAAA,eAEApI,GAAAqI,WAAA,gBACArI,GAAAsI,QAAA,UACAtI,GAAAuI,QAAA,UACAvI,GAAAwI,QAAA,UACAxI,GAAAyI,QAAA,UACAzI,GAAA0I,QAAA,UACA1I,GAAA2I,QAAA,UACA3I,GAAA4I,QAAA,UACA5I,GAAA6I,QAAA,UACA7I,GAAA8I,QAAA,UACA9I,GAAA+I,QAAA,UACA/I,GAAAgJ,UAAA,YACAhJ,GAAAiJ,eAAA,iBACAjJ,GAAAkJ,eAAA,iBACAlJ,GAAAmJ,aAAA,eAEAnJ,GAAAoJ,cAAA,gBAGApJ,GAAAqJ,QAAA,UACArJ,GAAAsJ,UAAA,YACAtJ,GAAAuJ,WAAA,aACAvJ,GAAAwJ,QAAA,UACAxJ,GAAAyJ,SAAA,WAGAzJ,GAAA0J,KAAA,SACA1J,GAAA2J,KAAA,SACA3J,GAAA4J,KAAA,SACA5J,GAAA6J,KAAA,SACA7J,GAAA8J,KAAA,SACA9J,GAAA+J,KAAA,SACA/J,GAAAgK,KAAA,SACAhK,GAAAiK,KAAA,SACAjK,GAAAkK,KAAA,SACAlK,GAAAmK,KAAA,SACAnK,GAAAoK,OAAA,SACApK,GAAAqK,OAAA,SACArK,GAAAsK,OAAA,SACAtK,GAAAuK,OAAA,SACAvK,GAAAwK,OAAA,SACAxK,GAAAyK,OAAA,SACAzK,GAAA0K,OAAA,SACA1K,GAAA2K,OAAA,SACA3K,GAAA4K,OAAA,SACA5K,GAAA6K,OAAA,SAGA7K,GAAA8K,EAAA,OACA9K,GAAA+K,EAAA,OACA/K,GAAAgL,EAAA,OACAhL,GAAAiL,EAAA,OACAjL,GAAAkL,EAAA,OACAlL,GAAAmL,EAAA,OACAnL,GAAAoL,EAAA,OACApL,GAAAqL,EAAA,OACArL,GAAAjoF,EAAA,OACAioF,GAAArwC,EAAA,OACAqwC,GAAAsL,EAAA,OACAtL,GAAAuL,EAAA,OACAvL,GAAAwL,EAAA,OACAxL,GAAAyL,EAAA,OACAzL,GAAA5nG,EAAA,OACA4nG,GAAA9gG,EAAA,OACA8gG,GAAA0L,EAAA,OACA1L,GAAA2L,EAAA,OACA3L,GAAA/D,EAAA,OACA+D,GAAAhW,EAAA,OACAgW,GAAA4L,EAAA,OACA5L,GAAA/gG,EAAA,OACA+gG,GAAA6L,EAAA,OACA7L,GAAAzrD,EAAA,OACAyrD,GAAAxgF,EAAA,OACAwgF,GAAAviE,EAAA,OACAuiE,GAAA8L,KAAA,OACA9L,GAAA+L,KAAA,OACA/L,GAAAgM,KAAA,OACAhM,GAAAiM,KAAA,OACAjM,GAAAkM,KAAA,OACAlM,GAAAmM,KAAA,OACAnM,GAAAoM,KAAA,OACApM,GAAAqM,KAAA,OACArM,GAAAsM,KAAA,OACAtM,GAAAuM,KAAA,OACAvM,GAAAwM,KAAA,OACAxM,GAAAyM,KAAA,OACAzM,GAAA0M,KAAA,OACA1M,GAAA2M,KAAA,OACA3M,GAAA4M,KAAA,OACA5M,GAAA6M,KAAA,OACA7M,GAAA8M,KAAA,OACA9M,GAAA+M,KAAA,OACA/M,GAAAgN,KAAA,OACAhN,GAAAiN,KAAA,OACAjN,GAAAkN,KAAA,OACAlN,GAAAmN,KAAA,OACAnN,GAAAoN,KAAA,OACApN,GAAAqN,KAAA,OACArN,GAAAsN,KAAA,OACAtN,GAAAuN,KAAA,OAGAvN,GAAAwN,UAAA,YACAxN,GAAAyN,MAAA,QACAzN,GAAA0N,MAAA,QACA1N,GAAA2N,MAAA,QACA3N,GAAA4N,OAAA,SACA5N,GAAA6N,MAAA,QACA7N,GAAA8N,MAAA,QACA9N,GAAA+N,YAAA,cACA/N,GAAAgO,UAAA,YACAhO,GAAAiO,aAAA,eACAjO,GAAAkO,UAAA,YAGAlO,GAAA3sF,GAAA,UACA2sF,GAAA1sF,KAAA,YACA0sF,GAAAntF,KAAA,YACAmtF,GAAAltF,MAAA,aACAktF,GAAAmO,QAAA,UACAnO,GAAAoO,UAAA,YACApO,GAAAqO,UAAA,YACArO,GAAAsO,WAAA,aAGAtO,GAAAuO,MAAA,QACAvO,GAAAwO,IAAA,SACAxO,GAAAyO,OAAA,eAMWC,WAMXC,eAAqCx2G,EAAuBy2G,EAC1Dv1F,GAAAA,QADiBtS,KAAAvM,IAAkBwlG,EAAAj5F,KAAA5O,MAAuB02G,EAAA9nG,KAAA6nG,cAQvD3K,SAAM6K,WAKXvnC,iBACEluD,QALMtS,KAAAgoG,MAAgB,GAAAhoG,KAChBioG,QAAkB,GAAAjoG,KAClBkoG,UAAoB,GAUlB57E,GAAmB5B,EAC3BpY,GAAAA,MAASga,GAAW5B,EAMtBxnB,GAAAilG,KACExvF,GAAA,IACEA,EAAA,IAOE,MAAayvF,EAAA,OAGb7vG,OAAOwgB,IAAImG,iBAAiB,OAC5B3mB,GAAAA,OAAOwgB,IAAIwG,oBAAoB,OAG/B1qB,GAAS0D,EAAAA,OAAOwgB,IAChB,MAEAlkB,GAAS0D,EAAAA,OAEFsZ,EAAAA,cAAc5K,KACnB,iJAMCiY,EAAAA,iBAAiB,QAAQ,UACzB8oF,MAAM12G,OAAS,KAIf4tB,EAAAA,iBAAiB,SAAUyN,IAChC,MAAaA,EAAGltB,EAAAA,KACJO,EAAAA,KAAKgoG,MAAMv2G,QACvBuO,QAAKgoG,MAAMj9F,OAAYs9F,EACvBroG,GAAAA,KAAKioG,QAAQj1G,KACbs1G,GAAA,MAAiBrK,EAAA,IAAax+F,GAAMktB,EAAGl5B,EAAAA,IAGvCuM,QAAK8sB,gBAAgBT,KAAK,KAC1BrsB,GAAAA,KAAK8sB,gBAAgBT,KAAK,UAAWk8E,MAIhCrpF,EAAAA,iBAAiB,WAAYyN,IAClC,MAAaA,EAAGltB,EAAAA,KAChB,IAAkC,IAA9BO,KAAKgoG,MAAMv2G,QAAsB62G,GACnCtoG,MAAKgoG,MAAMh1G,KACXgN,GAAAA,KAAKkoG,UAAUl1G,KACfs1G,GAAA,MAAiBD,EAAA,IAAa5oG,GAAMktB,EAAGl5B,EAAAA,IACvCuM,QAAK8sB,gBAAgBT,KAAK,OAC1BrsB,GAAAA,KAAK8sB,gBAAgBT,KAAK,QAASk8E,OAKlC/vE,cAEA0vE,UAAU52G,OACf0O,EAAAA,KAAKioG,QAAQ32G,OAGb,MAAK,IAAQk3G,EAAGz4G,EAAIiQ,EAAAA,KAAKgoG,MAAM12G,OAAQvB,IACrCiQ,KAAK8sB,gBAAgBT,KAAK,OAAQ,IAAarsB,GAAAA,KAAKgoG,MAAMj4G,KAOvD04G,sBACOT,MAOPU,WACL/vF,eAAYuvF,UAAUz2G,QAAQgC,IAOzB,EAAAk1G,OACLhwF,eAAYqvF,MAAMv2G,QAAQgC,IAOrB,EAAAm1G,YACLjwF,eAAYsvF,QAAQx2G,QAAQgC,IAAQ,IChRtCylG,GADUP,KAAWl1E,GAAA,KACrBolF,MAAA,QACA3P,GAAA4P,MAAA,QACA5P,GAAA6P,IAAA,MACA7P,GAAA8P,QAAA,mBAWA9P,GAAAA,EAAA/zF,OAAA,SAKA+zF,EAAA+P,SAAA,YAVUrQ,KAAYsQ,GAAA,WAgBXC,WAmEX3oC,iBACEluD,QAlEctS,KAAKmpG,GAAQn9B,GAAAA,UACrBhsE,KAAAopG,SAAmB,EACnBppG,KAAAqpG,UAAoB,EAEpBrpG,KAAAspG,oBAA4Ch4G,CAAAA,OAE5C,QAAAi4G,QAAmB,GAAAvpG,KACnBwpG,iBAA4B,GAAAxpG,KAC5BypG,4BAAuC,GAAAzpG,KAEvC0pG,iBAAoBnyG,CAAUC,EAAAA,IAC9Bg8C,EAAAA,IAAQA,EACLh8C,EAAE4G,EAAK7G,GAAE6G,EAEX5G,GAAEg8C,EAAIj8C,EAAEi8C,EAkCVA,OAAAm2D,YAAsB,KAKtB3pG,KAAA4pG,cAAwB,KAKxB5pG,KAAA4nE,aAAuB,KAKvB5nE,KAAA6pG,WAAoB,KAKzB7pG,KAAQyjB,GAAA,OAAQzjB,KAAK8pG,gBACrB9pG,KAAQyjB,GAAA,OAAQzjB,KAAK+pG,gBACrB/pG,KAAQyjB,GAAA,KAAMzjB,KAAKgqG,cAlDrBC,6BACcb,QAMdc,8BACeb,UAAYrpG,KAAKopG,QAMhCe,4BACcd,WAAarpG,KAAKopG,QAMhCgB,yCACgBd,oBAAoBh4G,OAmCjCi7B,GAAe7B,EAChBpY,GAAAA,MAASia,GAAO7B,EAOlBxnB,GAAAwpB,KAAoBhC,EAClBpY,GAAAA,MAAMoa,KAAYhC,EAOpBxnB,GAAAkc,IAAmBsL,EACjBpY,GAAAA,MAAM8M,IAAWsL,EAMZxnB,GAAAs1B,cACI6wE,WAAarpG,KAAKopG,QACzBppG,KAAKqpG,UAAW,GACNrpG,KAAKqpG,UAAYrpG,KAAKopG,UAChCppG,KAAKqpG,UAAW,GAElBrpG,KAAKwpG,iBAAmB,SAASD,cAC5BE,4BAA8B,GAO9BY,qBACArqG,QAAKsqG,yBAAyBv/E,KAAAA,KAC5Bu+E,oBAA0BlrG,EAAAA,IAC/B4B,EAAAA,KAAKspG,oBAAoBh4G,QACzB0O,EAAAA,KAAKupG,QAAQv2G,KAAK+3B,IAKpB/qB,KAAKupG,QAAQnqG,KAAKY,KAAK0pG,kBAOlBa,wBACDvqG,QAAKsqG,yBAAyBv/E,YAAAA,KACpBu+E,oBAA0BlrG,EAAAA,IACtC4B,KAAKspG,oBAAoBh4G,QACzBke,EAAoBub,EAAO/qB,EAAAA,KAAKupG,SAChCvpG,KAAKypG,4BAA4Bz2G,KAAK+3B,IAOnCy/E,oCACOjB,QAMPkB,6CACOjB,iBAMPkB,iCACOnB,QACT5tG,OAAOqE,KAAKwpG,kBACZhqE,QAAQzU,CAAOh7B,EAAGD,EAAAA,IACL2B,EAAAA,QAAQs5B,KAErB3rB,IAAAA,KAAKY,KAAK0pG,kBAORiB,uBACLhyF,gBAASivD,cACMn4D,EAAAA,SAASzP,KAAK4nE,aAAgB5nE,EAAAA,KAAK4nE,aAAiBvnE,GAAuB0qB,GAAAA,IASrF6/E,qBACLjyF,eAAY6wF,iBAAiB/3G,QAAQs5B,IAOhC,EAAAu/E,yBACL3xF,WAAiBonD,EAAAA,aAAoBqH,EAAAA,QAASpnE,KAAKspG,oBAAoB5wG,eAAqB0F,EAAGnL,GAAAA,aAGzF62G,eACN9pG,QAAK2pG,YAAc,IAAWh9E,EAAGk+E,EAAAA,QAAWl+E,EAAGk+E,EAAAA,QAC/C7qG,GAAAA,KAAK4pG,cAAgB,IAAWj9E,EAAGm+E,EAAAA,UAAan+E,EAAGm+E,EAAAA,UACnD9qG,GAAAA,KAAK4nE,aAAe,IAAWj7C,EAAGs7B,EAAAA,SAAYt7B,EAAGs7B,EAAAA,SAG3C5nD,GAAA0pG,eACN/pG,QAAK2pG,YAAc,IAAWh9E,EAAGk+E,EAAAA,QAAWl+E,EAAGk+E,EAAAA,QAC/C7qG,GAAAA,KAAK4pG,cAAgB,IAAWj9E,EAAGm+E,EAAAA,UAAan+E,EAAGm+E,EAAAA,UACnD9qG,GAAAA,KAAK4nE,aAAe,IAAWj7C,EAAGs7B,EAAAA,SAAYt7B,EAAGs7B,EAAAA,SACjDjoD,GAAAA,KAAKopG,SAAU,EAGTY,aACNhqG,QAAKopG,SAAU,EACfppG,KAAK6pG,WAAa,MAhNL79B,GAAAA,QCjCjB,GACEmtB,GADUN,KAAmBkS,GAAA,KAC7B5R,GAAA6R,UAAA,GAAA,WACA7R,GAAAA,GAAArtF,KAAA,GAAA,OACAqtF,GAAAA,GAAA7pB,OAAA,GAAA,SACA6pB,GAAAA,GAAAptF,MAAA,GAAA,QACAotF,GAAAA,GAAA6P,QAAA,GAAA,mBAOA7P,GAAAA,EAAArtF,KAAA,OACAqtF,EAAA7pB,OAAA,SACA6pB,EAAAptF,MAAA,QACAotF,EAAA6P,QAAA,UACA7P,EAAA6R,SAAA,YALUlS,KAAamS,GAAA,cASvB9R,GAAAA,EAAA+R,MAAA,QACA/R,EAAAgS,KAAA,OACAhS,EAAAiS,KAAA,QAHUrS,KAAcsS,GAAA,WA6BbC,WA8BX1D,eAESjgC,EACAp2E,EACAg6G,EACAlhF,EACAsC,EAEPra,GAAAA,QAPUtS,KAAAwrG,YACHrS,EAAAn5F,KAAA2nE,QACA8jC,EAAAzrG,KAAAzO,MACA82G,EAAAroG,KAAAurG,YACAtN,EAAAj+F,KAAAqqB,OACAqhF,EAAA1rG,KAAA2sB,GASFg/E,EAAA3rG,KAAAywD,WAAY,EA1CnB34D,uBACcomD,MAId+J,2BACcujD,YAAYvjD,SAASjzC,QAInC61F,0BACcW,YAAYX,QAAQ71F,QAIlC81F,4BACcU,YAAYV,UAAU91F,QAsBpC1M,sBACckjG,YAAYvjD,SAASjzC,QAQ5B+7C,cACAN,WAAY,EAOZK,yBACOL,UAGPm7C,UACL5rG,QAAK6rG,SAED7rG,GAAAA,KAAK8oB,UAAY9oB,KAAK8wD,cAAsB5hD,EAAAA,QAC9ClP,KAAK4rG,UAAgB18F,EAAAA,QAOlB28F,SACD9gF,GAAAA,IACF/qB,KAAK8rG,eACL/gF,GAAMsB,EAAAA,KAAKrsB,KAAKk+C,MAAOl+C,MAAAA,KAClB+rG,aAAahhF,IAIZ+gF,eAAeljE,IAIfmjE,aAAanjE,WAMvBojE,eACYC,QAAAC,kBAaLD,EAAA5nF,OAELsjD,EACAp2E,EACAg6G,EACAlhF,EACAsC,EAEAtpB,UAAO,IAAIrD,KAAKksG,kBAA+BvkC,EAASp2E,EAAOg6G,EAAalhF,EAAQsC,EAAAA,UAI3Ew/E,WAAyBb,UAEzBc,WAAbC,qCACYrsG,KAAAk+C,MAAQ,YAER6tD,aACQ/rG,QAAK2nE,QAETwiC,WAAmBpiC,EAAAA,eAAeE,mBACtCn7C,EAAAA,gBAAgBT,KAAK,iBAAkBrsB,aAKtCssG,WAAbD,qCACYrsG,KAAAk+C,MAAQ,cAER6tD,aACJ/rG,QAAK2nE,QAAQuiC,aAAqBniC,EAAAA,eAAeE,mBAC7Cn7C,EAAAA,gBAAgBT,KAAK,mBAAoBrsB,aAKxCusG,WAAbF,qCACYrsG,KAAAk+C,MAAQ,cAEX0tD,UAOD5rG,QAAK2nE,QAAQ2iC,yBAAyBv/E,KAAAA,KACnC8gF,SAED7rG,GAAAA,KAAK8oB,UAAY9oB,KAAK8wD,cAAsB5hD,EAAAA,QAC9ClP,KAAK4rG,UAAgB18F,EAAAA,SAKjB48F,eACH/gF,GAAMg9C,EAAAA,eAAeC,mBAStBhoE,KAAK2nE,QAAQsiC,YAAoBliC,EAAAA,eAAeE,mBAC5Cn7C,EAAAA,gBAAgBT,KAAK,kBAAmBrsB,aAqBvCwsG,WAAbH,qCACYrsG,KAAAk+C,MAAQ,eAER4tD,eACH/gF,GAAMg9C,EAAAA,eAAeC,kBAKlB+jC,aACQ/rG,QAAK2nE,QAETsiC,YAAoBliC,EAAAA,eAAeE,mBACvCn7C,EAAAA,gBAAgBT,KAAK,mBAAoBrsB,aAKxCysG,WAAbJ,qCACYrsG,KAAAk+C,MAAQ,eAER4tD,eACH/gF,GAAMg9C,EAAAA,eAAeC,kBAKlB+jC,aACQ/rG,QAAK2nE,QAETsiC,YAAoBliC,EAAAA,eAAeE,mBACvCn7C,EAAAA,gBAAgBT,KAAK,mBAAoBrsB,aAKxC0sG,WAAbL,qCACYrsG,KAAAk+C,MAAQ,uBAQPyuD,WAeX/E,eAESvnG,EACAusG,EACAC,EACA7qF,EACAC,EACA1wB,EACAu7G,EACAC,EACAC,EACAC,EACAtgF,EAEPra,GAAAA,QAbOtS,KAAAI,EACA8sG,EAAAltG,KAAAK,EACA8sG,EAAAntG,KAAA4sG,MACAQ,EAAAptG,KAAA6sG,MACAQ,EAAArtG,KAAAgiB,QACAsrF,EAAAttG,KAAAiiB,QACAsrF,EAAAvtG,KAAAzO,MACAikG,EAAAx1F,KAAA8sG,OACAj+D,EAAA7uC,KAAA+sG,OACAtX,EAAAz1F,KAAAgtG,OACAQ,EAAAxtG,KAAAitG,UACAvX,EAAA11F,KAAA2sB,GAKD8gF,EAAAztG,KAAA0tG,aAAc,EAKf38C,cACA28C,aAAc,EAOd58C,yBACO48C,sBAQdphF,GACAk/E,EACA7jC,EACAp2E,EACAg6G,EACAlhF,EACAsC,EAEAghF,GAAA,IAEA1+D,SACE2+D,YACY3+D,EAAA,IAA6Bm9D,GAAAA,qBAG7Bn9D,EAAA,IAA6Bq9D,GAAAA,qBAG7Br9D,EAAA,IAA6Bs9D,GAAAA,uBAG7Bt9D,EAAA,IAA6By9D,GAAAA,sBAG7Bz9D,EAAA,IAA6Bu9D,GAAAA,sBAG7Bv9D,EAAA,IAA6Bw9D,GAAAA,WAI5BpoF,EAAAA,OAAoBsjD,EAASp2E,EAAOg6G,EAAalhF,EAAQsC,EOxXnEghF,SA2BLE,eAA4ChD,EAAwBC,EAAjDgD,QAAA7lD,SAAyB2lD,EAAA5tG,KAAA6qG,QAAwBkD,EAAA/tG,KAAA8qG,UAxB7DgD,0BAAiDE,EAA4BC,EAClFl+G,GAAA,IACI88G,EACAhC,EACAlhF,EAEqBgkF,EAAA,IAArBp6G,UAAUjC,QACIwoD,EAChB+yD,EAAgBmB,EAChBnD,EAAUqD,EAAA,IAAWtB,EAAOC,EAC5BljF,GAASskF,EAAAA,IAESn0D,EAClB8yD,EAAQ/B,EAAQzqG,EAChBysG,EAAQhC,EAAQxqG,EAChBspB,EAAiBqkF,EAGnB9qG,GAAA,MAAkBymB,EAAOjT,EAAAA,OAAOoK,wBAC1BmnC,GAAWt+B,EAAOjT,EAAAA,OAAO4K,yBAE/B2tB,UAAO,IAAsBgZ,GAAU4iD,EAASC,EAAAA,UCqCvCqD,WAWX3tC,eACEluD,GAAAA,QATMtS,KAAAouG,aAA+B,GAAApuG,KAC/BquG,WAA6B,GAAAruG,KAC7BsuG,aAA+B,GAAAtuG,KAC/BuuG,eAAiC,GAAAvuG,KACjCwuG,OAAuB,GAAAxuG,KACvByuG,UAAuB,GAAAzuG,KACvB0uG,gBAA4B,GAAA1uG,KAK7B83B,QACL93B,EAAAA,KAAKyuG,UAAUz7G,KAAK,IAAIm2G,IACxBnpG,KAAK0uG,gBAAoB,EAAA,QACpBC,QAAU3uG,KAAKyuG,UAWf,GAAGniF,GAAmB5B,EAC3BpY,GAAAA,MAASga,GAAW5B,EAWfxnB,GAAAilG,KAAKn0G,IACDA,EAAUgM,GAAAA,KAAK83B,QAAQxZ,QAGzBY,iBAAiB,aAAclf,KAAK4uG,kBAAkB,OAAQ5uG,KAAKouG,eACnElvF,EAAAA,iBAAiB,WAAYlf,KAAK4uG,kBAAkB,KAAM5uG,KAAKquG,aAC/DnvF,EAAAA,iBAAiB,YAAalf,KAAK4uG,kBAAkB,OAAQ5uG,KAAKsuG,eAClEpvF,EAAAA,iBAAiB,cAAelf,KAAK4uG,kBAAkB,SAAU5uG,KAAKuuG,iBAInEh2G,OAAQ+yG,cAEhBtrG,KAAK83B,QAAQxZ,OAAOxW,MAAM+mG,YAAc,OACjC3vF,EAAAA,iBAAiB,cAAelf,KAAK8uG,oBAAoB,OAAQ9uG,KAAKouG,eACtElvF,EAAAA,iBAAiB,YAAalf,KAAK8uG,oBAAoB,KAAM9uG,KAAKquG,aAClEnvF,EAAAA,iBAAiB,cAAelf,KAAK8uG,oBAAoB,OAAQ9uG,KAAKsuG,eACtEpvF,EAAAA,iBAAiB,gBAAiBlf,KAAK8uG,oBAAoB,SAAU9uG,KAAKuuG,kBAClEh2G,OAAQw2G,gBAEtB/uG,KAAK83B,QAAQxZ,OAAOxW,MAAcknG,cAAgB,OAC5C9vF,EAAAA,iBAAiB,gBAAiBlf,KAAK8uG,oBAAoB,OAAQ9uG,KAAKouG,eACxElvF,EAAAA,iBAAiB,cAAelf,KAAK8uG,oBAAoB,KAAM9uG,KAAKquG,aACpEnvF,EAAAA,iBAAiB,gBAAiBlf,KAAK8uG,oBAAoB,OAAQ9uG,KAAKsuG,eACxEpvF,EAAAA,iBAAiB,kBAAmBlf,KAAK8uG,oBAAoB,SAAU9uG,KAAKuuG,mBAG5ErvF,EAAAA,iBAAiB,YAAalf,KAAKivG,kBAAkB,OAAQjvG,KAAKouG,eAClElvF,EAAAA,iBAAiB,UAAWlf,KAAKivG,kBAAkB,KAAMjvG,KAAKquG,aAC9DnvF,EAAAA,iBAAiB,YAAalf,KAAKivG,kBAAkB,OAAQjvG,KAAKsuG,gBAI3E,MACEY,EAAAA,CAAAA,UACElvG,KAAK83B,QAAQq3E,2BAAkDtwD,GAAAA,KAC/D7+C,KAAK83B,QAAQq3E,2BAAkDhqG,GAAAA,qBAGlDrQ,SAASE,cAAc,OAE/BkqB,EAAAA,iBAAiB,QAASlf,KAAKovG,kBAAkB,QAASpvG,KAAKwuG,QAASa,QAAAA,IACtEv6G,SAASw6G,aAEXpwF,EAAAA,iBAAiB,aAAclf,KAAKovG,kBAAkB,QAASpvG,KAAKwuG,QAG3Ex6G,GAAOkrB,EAAAA,iBAAiB,sBAAuBlf,KAAKovG,kBAAkB,QAASpvG,KAAKwuG,QASjFe,GAAAC,aAELlnG,EACA+hB,EAA8BwuE,EAAoB/sF,GAAAA,KACThC,EAAA,QACrBnH,EAEpB,GAAA,IAAIvC,EAAIutG,EACJttG,EAAI4uC,EAEJ3mC,EAAAA,aAAemnG,IACbnnG,EAAIuiG,EAAAA,QACRxqG,EAAIiI,EAAIuiG,EAAAA,QACR3/B,EAAS5iE,EAAAA,IAELA,EAAIlI,EACRC,EAAIiI,EAAIjI,EACR6qE,EAASgjC,EAAA,IAAsB5lG,GAAI0M,EAAAA,QAAaA,EAAAA,QAAaA,EAAAA,UAG/D,MACE43F,EAAAA,CAAAA,MACAC,EAAAA,MACA6C,EAAAA,UACAnE,EAAAA,YACAlhF,EAAAA,OACAslF,EAAAA,eAAgB,eAMhBh3F,mBACOm2F,oBAA+B9uG,EAAAA,KAAKsuG,aAAsBsB,GAC/DC,yBAEKf,oBAA+B9uG,EAAAA,KAAKouG,aAAsBwB,GAC/DC,uBAEKf,oBAA+B9uG,EAAAA,KAAKquG,WAAoBuB,GAC7DC,2BAEKf,oBAA+B9uG,EAAAA,KAAKuuG,eAAwBqB,GAGrEC,OAAK,MAAM9kF,KAAAA,KAAc+M,QAAQ0nC,aAAa8iB,OAC5C,CAAA,MAAuBv3D,EAAM+8C,EAAAA,OAAOtoC,QAAc7mB,GAAAA,aAAam3F,KAC3D/nC,GACFA,GAAevvC,EAAAA,OAAcx4B,EAAAA,KAAK83B,QAGtC93B,QAAKy6F,wBACLz6F,KAAKw4B,SAMAA,cACA61E,WAAW/8G,OAChB0O,EAAAA,KAAKouG,aAAa98G,OAClB0O,EAAAA,KAAKsuG,aAAah9G,OAClB0O,EAAAA,KAAKuuG,eAAej9G,OACpB0O,EAAAA,KAAKwuG,OAAOl9G,OAEZ,MAAK,IAAQy+G,EAAGhgH,EAAIiQ,EAAAA,KAAKyuG,UAAUn9G,OAAQvB,IACzCiQ,KAAKyuG,UAAaj2E,GAAAA,SAQZjnC,GACRonB,GAAIpnB,GAASyO,GAAAA,KAAKyuG,UAAUn9G,OAE1B,IAAK,IAAQ0O,EAAAA,KAAKyuG,UAAUn9G,OAAYgM,EAAM/L,EAAOxB,EAAIuN,EAAKvN,EAAAA,IAC5DiQ,KAAKyuG,UAAUz7G,KAAK,IAAIm2G,IACxBnpG,KAAK0uG,gBAAgB17G,MAAM,eAInBy7G,UAMP91F,GAAAvI,oBACOq+F,UAAUn9G,OAGjB2uE,gCACLtnD,OAAK,MAAMgvD,KAAAA,KAAgB8mC,UACb9D,EAAAA,uBACVhjC,GAAQ0iC,EAAAA,qBAER1iC,GAAQ4iC,EAAAA,wBAKN5xF,GAAAq3F,oBACNr3F,OAAK,MAAMwf,KACTxf,EAAA,IAAK,MAAMoS,KAAa48C,EAAAA,QAAQ+iC,qBACzBvyE,GAAI24B,EAAAA,cACH86C,EAAAA,UAAU7gF,IAEPjC,EAAAA,SAAegoC,EAAAA,aAEtB,MAMAm/C,8BACN,MAA+EC,EAAA,GACrCC,EAAA,OAErC,MAAMh4E,KAAAA,KAAYm2E,aACrB,IAAK,MAAMvjF,KAAa48C,EAAAA,QAAQ+iC,qBAE9B,IACmCvyE,EAAIwvC,EAAAA,QAAavpE,GAAA,IAAYA,EAAAA,KAC1DupE,EAAAA,QAAQijC,qBAAqB7/E,KAC5B48C,EAAAA,QAAQ2iC,yBAAyBv/E,KACjC+lC,EAAAA,aAE2B34B,CAAAA,EAAIwvC,EAAAA,QAAavpE,GAAA,IAAYA,EAAAA,IAC7DgyG,EAAA,MAAWC,EACTC,GAAA,QACA,IAAsBn4E,GAAI8vB,EAAAA,SAAc4iD,EAAAA,QAAaC,EAAAA,WACjDnjC,EAAAA,QACAp2E,EAAAA,MACAg6G,EAAAA,YACAlhF,EAAAA,OACAsC,EAAAA,IAGHi/E,EAAAA,UACH2E,GAAav9G,EAAAA,KAInBw9G,UAGML,EAAAM,8BACN,MAAuEP,EAAA,GAC7BC,EAAA,OAErC,MAAMh4E,KAAAA,KAAYm2E,aACrB,IAAK,MAAMvjF,KAAa48C,EAAAA,QAAQ+iC,qBAE9B,IAC2BvyE,EAAIwvC,EAAAA,QAAQvpE,MAChCupE,EAAAA,QAAQijC,qBAAqB7/E,IAC9B48C,EAAAA,QAAQ2iC,yBAAyBv/E,KAChC+lC,EAAAA,aAEmB34B,CAAAA,EAAIwvC,EAAAA,QAAQvpE,IACpCgyG,EAAA,MAAWC,EACTC,GAAA,QACA,IAAsBn4E,GAAI8vB,EAAAA,SAAc4iD,EAAAA,QAAaC,EAAAA,WACjDnjC,EAAAA,QACAp2E,EAAAA,MACAg6G,EAAAA,YACAlhF,EAAAA,OACAsC,EAAAA,IAEHi/E,EAAAA,UACH8E,GAAa19G,EAAAA,KAETmlC,GAAIwvC,EAAAA,QAAQsiC,aACVtiC,EAAAA,QAAQkiC,WAKpB8G,UAGKR,EAAA1V,6BACAuV,oBAAoBhwG,KAAKouG,cAC9BpuG,KAAKgwG,oBAAoBhwG,KAAKquG,YAC9BruG,KAAKgwG,oBAAoBhwG,KAAKsuG,cAC9BtuG,KAAKiwG,8BACLjwG,KAAKywG,8BACLzwG,KAAKgwG,oBAAoBhwG,KAAKuuG,oBAGzB,MAAMp2E,KAAAA,KAAYq2E,OACrB,IAAK,MAAMzjF,KAAAA,KAAc0jF,UAAcl9G,EAAAA,OAAOi5G,wBAC5CxqG,GASEA,KATG4wG,4BAAmCz4E,EAAAA,IAC/BrP,EAAAA,SAAegoC,EAAAA,aAEtB,MAMA8/C,4BAA0CC,EAChD9lF,GAAMsB,EAAAA,KAAK,eAGPwkF,GAAW/nF,EAAAA,UAAuBgoC,EAAAA,cAAsB5hD,EAAAA,QAC1DlP,KAAK4wG,4BAAkC1hG,EAAAA,OAInChM,GAAA+rG,kBAAqC6B,EAC3C5tG,UAAQA,IACJysG,EAAAA,iBAEF,MAAgB3vG,EAAAA,KAAQ+wG,GAClBvF,GAAciE,EAAkBuB,GAAAA,iBAAmBpE,EAAAA,MAASC,EAAAA,MAAO7sG,KAAK83B,SACnEu4E,EACT/jF,GACAk/E,EACA7jC,EACAgpC,EACAhY,EAAYmQ,GAAAA,MACZ9oG,KAAKixG,6BAA+B5mF,EAAAA,QAItCymF,GAAS99G,EAAAA,KACT20E,GAAQ76C,EAAAA,gBAAgBT,KAAgBgS,EAAAA,IAIpCuwE,kBAAqCkC,EAC3C5tG,UAAQA,IACJysG,EAAAA,qBACG,IAAQgB,EAAG9pG,EAAM3D,EAAEguG,EAAAA,eAAe5/G,OAAYuV,EAAK9W,EAAAA,IACtD,CAAA,MAAciQ,EAAAA,KAAKyuG,UAAUn9G,OAAa0O,EAAAA,KAAKmxG,iBAAmBD,EAAAA,eAAkBE,GAAAA,YACpF,EAAA,IAAe,IACbZ,EAAA,SAGF,MAAgBxwG,EAAAA,KAAQzO,GAClBi6G,GAAciE,EAAkBuB,GAAAA,iBAAmBE,EAAAA,eAAkBtE,GAAAA,MAASsE,EAAAA,eAAkBrE,GAAAA,MAAO7sG,KAAK83B,SACvGu4E,EAAyB/jF,GAAWk/E,EAAa7jC,EAASp2E,EAAOonG,EAAYkQ,GAAAA,MAAqBG,GAAAA,QAE7G8H,GAAS99G,EAAAA,KACT20E,GAAQ76C,EAAAA,gBAAgBT,KAAgBgS,EACxCr+B,GAAAA,KAAKqsB,KAAgBgS,EAEjBr+B,GAAAA,KAAKyuG,UAAUn9G,OAAS,IACR,OAEhB0O,EAAAA,KAAK0uG,gBAAgBn9G,IACE,EAAA,SAAd+6B,IAETtsB,KAAK0uG,gBAAyBxrG,GAAEguG,EAAAA,eAAkBE,GAAAA,eAOpDtC,oBAAuCgC,EAA0B5lC,EACvEn7E,UAAQmT,IACJysG,EAAAA,iBAGF,MAAc3vG,EAAAA,KAAKyuG,UAAUn9G,OAAa0O,EAAAA,KAAKmxG,iBAAmBzB,EAAAA,WAClE,EAAA,IAAe,IACbc,EAAA,OAGF,MAAgBxwG,EAAAA,KAAQzO,GAClBi6G,GAActgC,EAAUukC,GAAkBuB,GAAAA,iBAAmBpE,EAAAA,MAASC,EAAAA,MAAO7sG,KAAK83B,SAC7Eu4E,EACT/jF,GACAk/E,EACA7jC,EACAp2E,EACAyO,EAAAA,KAAKqxG,qBAAuB9F,EAAAA,aAC5BvrG,KAAKixG,6BAA+B5mF,EAAAA,QAItCymF,GAAS99G,EAAAA,KACT20E,GAAQ76C,EAAAA,gBAAgBT,KAAgBgS,EACxCr+B,GAAAA,KAAKqsB,KAAgBgS,EAGjBr+B,GAAAA,KAAKyuG,UAAUn9G,OAAS,IACR,OAEhB0O,EAAAA,KAAK0uG,gBAAgBn9G,IACE,EAAA,SAAd+6B,IAETtsB,KAAK0uG,gBAAyBxrG,GAAEwsG,EAAAA,aAMhCN,kBAAqC0B,EAC3C5tG,UAAQA,UAGC40B,QAAQq3E,2BAAkDtwD,GAAAA,KAC9D7+C,KAAK83B,QAAQq3E,2BAAkDhqG,GAAAA,QAAYnR,EAAAA,SAAWgM,KAAK83B,QAAQxZ,SAElGqxF,EAAAA,iBAEJ,MAAe3vG,EAAAA,KAAK83B,QAAQphB,OAAOoK,wBAA4B5d,EAAE0pG,EAAAA,MAASC,EAAAA,QAC5D7sG,EAAAA,KAAK83B,QAAQphB,OAAO4K,yBAM5BwrF,GAAS5pG,EAAE4pG,EAAAA,QAAYwE,EAAAA,cAraS,EAAA,KAsahCvE,EACJ7pG,EAAE6pG,EAAAA,QAAYwE,EAAAA,cAvasB,EAAA,KAua4BC,EAAAA,aAva5B,EAAA,KAua6EC,EAAAA,QAC7GzE,EAAS9pG,EAAE8pG,EAAAA,QACjB,EAAA,IAAgBjU,EAAemS,GAAAA,MAEzB+B,EAAAA,YACgB,IAAdA,EAAAA,UACQlU,EAAeoS,GAAAA,KACF,IAAd8B,EAAAA,YACClU,EAAeqS,GAAAA,OAI/B,MAAWsG,EAAA,IAAe9c,GAAMx0F,EAAGw0F,EAAMv0F,EAAG6C,EAAE0pG,EAAAA,MAASC,EAAAA,MAAczsG,EAAGsW,EAAOrW,EAAGA,EAAGysG,EAAQC,EAAQC,EAAQC,EAAW/pG,EAExH4tG,GAAS99G,EAAAA,KACTgN,GAAAA,KAAQ+wG,GAAGjkF,GAAAA,gBAAgBT,KAAgBslF,EAC3C3xG,GAAAA,KAAKqsB,KAAgBslF,EAAAA,IAQjBR,iBACNx4F,GAAA,IACAi5F,EAAA,IAAW5xG,EAAAA,KAAK0uG,gBAAgBj9G,QAAQi+G,KACtC,EAAA,OAGFkC,MAAK,IAAQC,EAAG9hH,EAAIiQ,EAAAA,KAAK0uG,gBAAgBp9G,OAAQvB,IAC/C,IAAiC,IAA7BiQ,KAAK0uG,gBACPmD,GAAA,OAKJA,SAGM,EAAAZ,6BACNt4F,UACEA,QAAyBqyF,GAAAA,gBACFA,GAAAA,cACEl/F,GAAAA,YACFA,GAAAA,UACEwjE,GAAAA,cACFA,GAAAA,YACEvjE,GAAAA,aACFA,GAAAA,WACEi9F,GAAAA,eACFA,GAAAA,uBAEJl/F,EAAAA,IAIfunG,qBACN14F,UACEA,sBACqBkwF,GAAAA,yBAEAC,GAAAA,uBAEAC,GAAAA,mBAEAC,GAAAA,gBN3hBd8I,WAuBXtxC,iBACEluD,QApBKtS,KAAA68C,SAAU,EAKV78C,KAAA27B,YAAoBO,UAAWC,YAO9Bn8B,KAAA+xG,mBAAsB,CAAG,EAAG,EAAG,EAC/B,QAAAC,SAAsB,GAAAhyG,KACtBiyG,MAAmB,GAAAjyG,KACnBkyG,cAAwB,EACxBlyG,KAAAmyG,WAAqCj2E,UACrCl8B,KAAAoyG,sBAA8C,KAM/CjK,YACKxsE,YAGN37B,KAAKkyG,eAMTlyG,KAAKgyG,SAAWhyG,KAAKqyG,WAAWryG,KAAKmyG,WAAWh2E,eAAAA,KACvC61E,SAAS1gH,QAAU0O,KAAKgyG,SAAS,KAAAhyG,KACnCkyG,cAAe,KAUjBI,+BACLtyG,QAAKuyG,mBACLvyG,KAAKoyG,sBAMCz5F,EAAA45F,wBACI11D,UACR78C,KAAK68C,SAAU,EACf78C,KAAKw4B,UAODg6E,gBACN75F,GAAA,IAGA3Y,KAHUoyG,sBACR,OAAA,EAEF,IACEz5F,EAAA,OAAA,EAEF,MAAmB85F,EAAI5pD,EAAAA,KAAKrpB,QAAQpuC,IAAAA,IAEjCE,OAEkBmhH,EAAIC,EAAAA,QAAQlzE,QAAQpuC,IAAAA,IAEtCE,cACkB0O,GAAAA,KAAKoyG,sBAAsB7nF,MAAwBvqB,GAAAA,KAAKoyG,sBAAsBM,SAAeC,EAAAA,UAQ1GrmF,GAAmB5B,EAC3B1qB,QAAKuyG,mBACLjgG,MAASga,GAAW5B,EAGfxnB,GAAAkc,IAAuBsL,EAC5B1qB,QAAKuyG,mBACLjgG,MAAM8M,IAAesL,EAMhBxnB,GAAAs1B,SACL,IAGAx4B,KAHU68C,UAAY78C,KAAK27B,UACzB,YAEGwsE,OAEL,MAAiBnoG,EAAAA,KAAKmyG,WAAWh2E,kBAE5B,IAAQy2E,EAAG7iH,EAAI8iH,EAASvhH,EAAAA,OAAQvB,IACnC,CAAA,IAAcA,EAAI6iH,GAChB,CAAA,MAAgB5yG,EAAAA,KAAQjQ,GAEpBm6B,GAAQyoF,EAAAA,WACV3yG,KAAK8sB,gBAAgBT,KAAK,aAAc,IAA2Bt8B,GAAGm6B,EAAAA,IAGhEyoF,EAAAA,WAAY,WAWtB,IAP6C1oF,KAD9Bl6B,GAAG4iH,GAAAA,WAAa3yG,KAAKwyG,gBAAyBziH,EAAAA,KAAAA,KACpD+8B,gBAAgBT,KAAK,UAAW,IAAwBt8B,GAAGiQ,EAAAA,KAAQjQ,GAAAA,KAAAA,KAGlEA,GAAG4iH,GAAAA,WAAY,EAIZ5iH,EAAG+iH,GAAAA,WAAsB/iH,EAAG+iH,GAAAA,YAAc9yG,KAAK+xG,mBAC1Da,GAAA,SASF,IAAelmD,EAAYn1D,EAAW+kD,EAAYlrD,EAElDu8G,MAAKn2G,KAAAA,KARAu6G,mBAAwBc,GAAS9iH,EAAG+iH,GAAAA,UAGzC9yG,KAAQjQ,GAAGgjH,GAAAA,iBAA4BhjH,EAK7BijH,GACRtmD,GAAUsmD,EAAQx7G,GACAy7G,GAAA,iBACZJ,GAAS9iH,EAAG2iH,GAAAA,QAAQhmD,KACdmmD,EAAS9iH,EAAG2iH,GAAAA,QAAYthH,GAAAA,MAC5BA,IAAU4O,KAAKgyG,SAAYkB,GAAAA,UAAUxmD,KAC1B38D,EAAG2iH,GAAAA,QAAYS,GAAAA,SAC1BnzG,KAAQjQ,GAAGqjH,GAAAA,aAAiBhiH,EAC5B4O,GAAAA,KAAQjQ,GAAG+8B,GAAAA,gBAAgBT,KAAK,SAAU,IAAuBqgC,GAAIt7D,EAAO4O,EAAAA,KAAQjQ,GAAAA,MAAAA,KAE5EA,GAAGqjH,GAAAA,aAAiBzC,EAAA,SAQjCp5G,KACH+kD,GAAU88C,EAAK7hG,GACGi5G,GAAA,iBAAPl0D,IACDu2D,EAAS9iH,EAAG84D,GAAAA,KAChBz3D,GAAAA,IAAU4O,KAAKgyG,SAAYqB,GAAAA,QAAQ/2D,KAAAA,KAC7BvsD,GAAGujH,GAAAA,WAAeliH,EAC1B4O,GAAAA,KAAQjQ,GAAG+8B,GAAAA,gBAAgBT,KAAK,OAAQ,IAAqBiwB,GAAIlrD,EAAO4O,EAAAA,KAAQjQ,GAAAA,YAKjFiiH,SAAchyG,GAAAA,KAAKuzG,UAAmBxjH,EAAAA,KAOrCwB,GAERonB,GADA3Y,GAGeA,KAHVuyG,mBACQvyG,GAAAA,KAAKiyG,MAAM3gH,OAEtB,IAAK,IAAQ0O,EAAAA,KAAKiyG,MAAM3gH,OAAYgM,EAAM/L,EAAOxB,EAAIuN,EAAKvN,EAAAA,IACxDiQ,KAAKiyG,MAAMj/G,KAAK,IAAIwgH,IACpBxzG,KAAKgyG,SAASh/G,KAAK,IAAIwgH,gBAIfvB,MAMPt5F,GAAA86F,wBACAlB,mBACL,MAA0BmB,EAAA,OACrB,IAAQd,EAAG7iH,EAAIiQ,EAAAA,KAAKiyG,MAAM3gH,OAAQvB,IACjCiQ,KAAKwyG,gBAAgBxyG,KAAQjQ,GAAGgjH,GAAAA,mBAAqB/yG,KAAQjQ,GAAG4iH,GAAAA,WAC3D3/G,EAAAA,KAAKgN,KAAQjQ,GAAAA,WASnB2jH,EAAAtjG,oBACO6hG,MAAMzyE,QAAc55B,GAAE+sG,EAAAA,YAAWrhH,OAGvC+gH,WACN15F,GAAA,MAAYi6F,EAAA,OACP,IAAQK,EAAGpsG,EAAM8sG,EAAKriH,EAAAA,OAAYuV,EAAK9W,EAAAA,IACtCiD,EAAAA,KAAKgN,KAAKuzG,UAAexjH,EAAAA,YAQzB6iH,EAAAW,UACN56F,GAAA,IAAO9R,EACPosG,EAAA,MAAkBtC,EAAA,IAElBiD,GAAA,IACEj7F,EAAA,OAGFg4F,MAASiC,EAAG/rG,EAAM4rG,EAAIC,EAAAA,QAAQphH,OAAYuV,EAAK9W,EAAAA,IACrC2iH,EAAAA,QAAQ3iH,IACJqjH,EAAAA,aAAgBX,EAAIC,EAAAA,QAAWthH,GAAAA,WAGpCwhH,EAAG/rG,EAAM4rG,EAAI5pD,EAAAA,KAAKv3D,OAAYuV,EAAK9W,EAAAA,IAChCujH,EAAAA,WAAcb,EAAI5pD,EAAAA,KAAK94D,WA9NvB4gH,GAAAkD,GAAAA,qBAAuB,UAyO1BL,WAMXhzC,iBACEluD,QANKtS,KAAA2yG,WAAY,EAEX3yG,KAAA8zG,SAAqB,IAAInqG,MAAM,IAC/B3J,KAAAi3D,MAAkB,IAAIttD,MAK5B,OAAK,IAAQoqG,EAAGhkH,EAAIiQ,EAAAA,KAAK8zG,SAASxiH,OAAQvB,IACxCiQ,KAAK8zG,SAAcC,GAErB,MAAK,IAAQC,EAAGjkH,EAAIiQ,EAAAA,KAAKi3D,MAAM3lE,OAAQvB,IACrCiQ,KAAKi3D,MAAW+8C,GASb,EAAAC,gBAAiCvoD,EAAoBxoD,EAC1D,eAAY4wG,SAASzpF,IAMhBnnB,EAAAgwG,UACLv6F,eAAYm7F,SAOPn7F,GAAA06F,QACL16F,GAAA,MAAc3Y,EAAAA,KAAKi3D,MAEnBt+C,UAAI5mB,KAAKwhB,IAAau+F,GAAS+B,GAAAA,qBAGtBziH,EAIJ8iH,EAAAd,aAAkChiH,EACvC4O,QAAK8zG,SAAwB1iH,GAGxB8R,EAAAowG,WAA8BliH,EACnC4O,QAAKi3D,MAAmB7lE,GAO5B8R,IAIEm2F,GAJU2Z,KAAOmB,GAAA,KAIjB9a,GAAA+a,MAAA,GAAA,QAIA/a,GAAAA,GAAAgb,MAAA,GAAA,QAIAhb,GAAAA,GAAAib,MAAA,GAAA,QAIAjb,GAAAA,GAAAkb,MAAA,GAAA,QAIAlb,GAAAA,GAAAmb,WAAA,GAAA,aAIAnb,GAAAA,GAAAob,YAAA,GAAA,cAIApb,GAAAA,GAAAqb,YAAA,GAAA,cAIArb,GAAAA,GAAAsb,aAAA,GAAA,eAIAtb,GAAAA,GAAAub,OAAA,GAAA,SAIAvb,GAAAA,GAAA/xE,MAAA,GAAA,QAIA+xE,GAAAA,GAAAwb,UAAA,IAAA,YAIAxb,GAAAA,GAAAyb,WAAA,IAAA,aAIAzb,GAAAA,GAAA0b,OAAA,IAAA,SAIA1b,GAAAA,GAAA2b,SAAA,IAAA,WAIA3b,GAAAA,GAAA4b,SAAA,IAAA,WAIA5b,GAAAA,GAAA6b,UAAA,IAAA,qBAUA7b,GAAAA,EAAAA,EAAA8b,WAAA,GAAA,aAIA9b,EAAAA,EAAA+b,WAAA,GAAA,aAIA/b,EAAAA,EAAAgc,YAAA,GAAA,cAIAhc,EAAAA,EAAAic,YAAA,GAAA,eAhBUlc,KAAImc,GAAA,WOlVdC,eAAmBnc,QAAAr6E,gBAxCXq6E,EAAAr5F,KAAAy1G,SAAU,EACVz1G,KAAA01G,gBAA6D,GAElEppF,GAAmB5B,EAChB1qB,QAAK01G,gBAAgBppF,IACvBtsB,KAAKof,IAAepf,EAAAA,KAAK01G,gBAAgBppF,IAE3CtsB,KAAK01G,gBAA6B11G,GAAAA,KAAK21G,UACvC31G,GAAAA,KAAKgf,gBAAgBE,iBAA4Blf,EAAAA,KAAK01G,gBAAgBppF,IAExElN,IAAuBsL,EAChBA,GAAAA,IACO1qB,EAAAA,KAAK01G,gBAAgBppF,IAEjCtsB,KAAKgf,gBAAgBO,oBAA+BmL,EACpD1qB,GAAAA,KAAK01G,gBAA6B/8F,GAAA,KAG5Bg9F,UACNh9F,UAAQwf,SACIs9E,SACAt9E,EAAAA,IAKPw0C,aACA8oC,SAAU,EAGVlxF,cACAkxF,SAAU,EAGVnlG,YACA,MAAMic,KAAAA,KAAcmpF,gBACvB11G,KAAKof,IAAImN,UAUbqpF,eAAmDC,EAA/BC,QAAAC,cAA+BC,EAAAh2G,KAAA61G,gBACjD71G,EAAAA,KAAKi2G,iBAAmB,IAAqBj2G,GAAAA,KAAK+1G,eAClD/1G,KAAKk2G,mBAAqB,IAAqBl2G,GAAAA,KAAK61G,iBAGtDt9G,yBACc09G,iBAGdnhH,2BACcohH,mBAGPvpC,aACAp0E,OAAOo0E,QACZ3sE,KAAKlL,SAAS63E,QAGTpoD,cACAhsB,OAAOgsB,SACZvkB,KAAKlL,SAASyvB,SAGTjU,aACA/X,OAAO+X,QACZtQ,KAAKlL,SAASwb,eC3ElB6lG,sBACUC,QAA2C,GAAAp2G,KAC3Cq2G,cAA+Cr2G,KAAKs2G,mBAEpDA,0BAEJ/tG,QAII,GAAAguG,qBAEJhuG,QAASvI,KAAKq2G,cAAc9tG,SAIzBynB,YACAomF,QAAQpjH,KAAKgN,KAAKq2G,eACvBr2G,KAAKq2G,cAAgBr2G,KAAKu2G,cAGrBjmF,eACA+lF,cAAgBr2G,KAAKo2G,QAAQ/lG,MAGpCy1B,0BACcuwE,qBCKHG,WAwBX1lF,eACExe,GAAAA,MAxBMmkG,GAAAz2G,KAAA02G,MAAQ,GAAA12G,KACR6yB,QAAS,EACV7yB,KAAAgzE,SAAmB,GAAAhzE,KAGnB22G,OAA6B,KAC7B32G,KAAAizE,iBAAkB,EAClBjzE,KAAAswE,QAEC,EAAAtwE,KAAAwd,QAAiB3L,EAAAA,cA4BjB7R,KAAAwwE,SAAqB,GAZ3B,MAAMwC,SAAU4jC,EAAAjhC,YAAas9B,EAAAhgC,gBAAiB09B,EAAArgC,QAASkgC,EAAAmG,OAAangH,GACpEwJ,OAAKgzE,SACLhzE,EAAAA,KAAK21E,YACL31E,EAAAA,KAAKizE,gBAAkBA,MAAAA,EAAmBjzE,EAAAA,KAAKizE,gBAC/CjzE,KAAKswE,QAAUA,MAAAA,EAAWtwE,EAAAA,KAAKswE,QAC/BtwE,KAAK22G,OAASA,MAAAA,EAAU32G,EAAAA,KAAK22G,OAE7B32G,KAAK21E,YAAY/wC,QAAW3T,GAAAA,MAAMk8C,MAAM3oD,MAAK,UACtCspE,mDArBPn1E,GAAA,MAAgBk+F,EAAWjyE,EAAAA,QAAQ3jC,IAAWw0E,GAAAA,yBACvC,IAAe+gC,GACpBxjC,CAAAA,SAAqBA,EAAAA,SACrB1C,QACA2C,EAAAA,gBAA4BA,EAAAA,gBAC5B0C,YAAa,IAAgBP,GAC3BxwC,CAAAA,QAAAA,MAoBEkyE,qBACNn+F,GAAA,IACS3Y,KADC6yB,OACR,OAAA7yB,KAAYwwE,SAGd,MAA0BumC,EAAA,GAEL/2G,EAAAA,KAAKizE,gBAAuB+jC,EAAAA,oBAC3ChkC,EAAWhzE,EAAAA,KAAKizE,gBAAkBjzE,KAAKgzE,SAASgkC,oBAAsBh3G,KAAKgzE,aAG5E,IAAkBikC,EAAGC,EAAcC,EAAa7lH,EAAAA,OAAQ4lH,IAE3D,CAAA,MAAeC,EAAaD,EAC5BD,GAAA,IAAkBjkC,EAASvhF,EAAAA,QAAQ2lH,IACd,IAAjBC,IACYC,EACdt3G,EAAAA,KAAKwd,QAAQvW,KAAK,oCAAoCmwG,8BAAmCpkC,OAG3F,MAAqBhzE,EAAAA,KAAK21E,YAAY/wC,QAClC2yE,GACFr9F,EAAQlnB,EAAAA,KAERgN,GAAAA,KAAKwd,QAAQvW,KAAK,wCAAwCmwG,gBAAqBC,4CAG9ExkF,QAAS,EACN7yB,KAAKwwE,SAGPumC,EAAAjpB,oBACN,MAAgB9tF,EAAAA,KAAK82G,qBAAqB92G,KAAK02G,OAC/C,IAAYK,EACRtvG,EAAS+vG,EACb,MAAK,MAAMlpC,KACT9mE,EAAS8mE,GAAO9mE,EAAAA,MAAQxH,KAAKswE,QACpBv+E,EAAAA,KAAKuL,IAAYgxE,EAAO7mE,EAAAA,aAE9BD,MACLxH,EAAAA,KAAKyH,OAGA+vG,EAAAC,WACDz3G,QAAK02G,QAAUtiC,IACjBp0E,KAAK6yB,QAAS,EACd7yB,KAAK02G,MACL12G,EAAAA,KAAK8tF,qBAICj+D,SAAuCzvB,EAAWC,EAC1DL,QAAK8tF,oBACLx7E,MAAMud,SAAazvB,EAAGC,EAGdtQ,GAAA+/B,WAAyC1vB,EAAWC,EAC5DtQ,GAAA,IAAa2nH,EACb,MAAK,MAAMppC,KAAAA,KAAewoC,qBAAqB92G,KAAK02G,OAE3C56F,EAAAA,KAAS1b,EAAIm2F,EAAQl2F,EAC5Bk2F,GAAUjoB,GAAO9mE,EAAAA,MAAQxH,KAAKswE,QAIlCqnC,OAAqCvjC,EAAch0E,EAAWC,EACxDL,QAAK02G,QAAUtiC,IACjBp0E,KAAK6yB,QAAS,EACd7yB,KAAK02G,MAGH12G,GAAAA,KAAK22G,SACJ3mF,EAAAA,OACAvW,EAAAA,UAAUzZ,KAAK22G,OAAO92E,OAAU7/B,EAAAA,KAAK22G,OAAO92E,OAC/C7/B,GAAAA,KAAK8b,KAAS1b,EAAGC,EACjB0b,GAAGuU,EAAAA,WAAAA,KAGAxU,KAAS1b,EAAGC,EAGnByJ,GAAAkL,eACS,IAAewhG,GACpBxjC,CAAAA,SAAUhzE,KAAKgzE,SACf2C,YAAa31E,KAAK21E,YAClBrF,QAAStwE,KAAKswE,iBCrJlBsnC,sBAOgBC,UCflB,qiEDgBS73G,KAAA2T,KAPL3T,GAAAA,KAAKg1B,OAWAA,mBACA8iF,aAAe,IAAgB93G,GAAAA,KAAK63G,WAClC73G,KAAK83G,aAAa9iF,OAAOxQ,MAAK,UAC9BuzF,aAA2BC,GAAAA,gBAC9B/mF,CAAAA,MAAOjxB,KAAK83G,aACZhiC,KACE3F,CAAAA,KACAD,EAAAA,QACA8F,GAAAA,YACAE,GAAAA,aAAc,WAGb+hC,YAAc,IAAezB,GAChCxjC,CAAAA,SAAU,oDACVC,iBAAiB,EACjB0C,YAAa31E,KAAK+3G,aAClBznC,SAAU,OAWT4nC,MAAqC9jC,EAAc9rE,EACpDtI,QAAK83G,aAAa7/E,YAAAA,KACfggF,YAAYN,OAAYvjC,EAAM9rE,EAAIlI,EAAGkI,EAAIjI,EAAAA,UEjClD83G,eAAoBC,QAAAC,IADZD,EAAAp4G,KAAAs4G,WAAa,IASrBV,GAAA57F,SAAoB3b,EAAWmH,EAAeC,EAC5CzH,QAAKq4G,IAAIE,MAAMvoF,OACfhwB,KAAKq4G,IAAIE,MAAM38F,YAAc,MAC7B5b,KAAKq4G,IAAIE,MAAM18F,WACb7b,KAAKq4G,IAAIG,cAAoBp4G,EAC7BJ,EAAAA,KAAKq4G,IAAIG,cAAoBn4G,EAC7BL,EAAAA,KAAKq4G,IAAIG,cAAwBhxG,EACjCxH,EAAAA,KAAKq4G,IAAIG,cAAyB/wG,EAEpCzH,GAAAA,KAAKq4G,IAAIE,MAAMjoF,UAGjBwmC,SAAwBzvB,EAAaoxE,EAAqCriG,EAAAA,CAAAA,MAAae,GAAAA,aAChFkhG,IAAIE,MAAMvoF,OACfhwB,KAAKq4G,IAAIE,MAAM9qF,YACfztB,KAAKq4G,IAAIE,MAAM38F,YAA0BxF,EAAAA,MAAMnjB,WAC/C+M,KAAKq4G,IAAIE,MAAM3qF,OAAO5tB,KAAKq4G,IAAIG,cAAsBp4G,EAAI4kB,EAAM5kB,EAAGJ,EAAAA,KAAKq4G,IAAIG,cAAsBn4G,EAAI2kB,EAAM3kB,EAC3GL,GAAAA,KAAKq4G,IAAIE,MAAM1qF,OAAO7tB,KAAKq4G,IAAIG,cAAoBp4G,EAAIinC,EAAIjnC,EAAGJ,EAAAA,KAAKq4G,IAAIG,cAAoBn4G,EAAIgnC,EAAIhnC,EACnGL,GAAAA,KAAKq4G,IAAIE,MAAM7qF,UACf1tB,EAAAA,KAAKq4G,IAAIE,MAAMxqF,SACf/tB,KAAKq4G,IAAIE,MAAMzqF,YACf9tB,KAAKq4G,IAAIE,MAAMjoF,UAGjBohE,UAAyBgnB,EAAuCtiG,EAAAA,CAAAA,MAAae,GAAAA,MAAOxD,KAAM,SACnF0kG,IAAIE,MAAMvoF,OACfhwB,KAAKq4G,IAAIE,MAAM9qF,YACfztB,KAAKq4G,IAAIE,MAAM/vG,UAAyB4N,EAAAA,MAAMnjB,WAC9C+M,KAAKq4G,IAAIE,MAAMvqF,IACbhuB,KAAKq4G,IAAIG,cAAsBp4G,EAAIsZ,EAAMtZ,EACzCJ,EAAAA,KAAKq4G,IAAIG,cAAsBn4G,EAAIqZ,EAAMrZ,EACzCq4G,EAAa/kG,EAAAA,KAEH,EAAV5hB,EAAAA,KAAK+a,IAEP9M,KAAKq4G,IAAIE,MAAMnqF,OACfpuB,KAAKq4G,IAAIE,MAAMzqF,YACf9tB,KAAKq4G,IAAIE,MAAMjoF,UAGjBgmE,SAAuBhuF,EACrBtI,QAAKs4G,WAAWJ,MAAMl4G,KAAKq4G,IAAW/vG,EAAAA,UAwCxCqwG,eAtBOC,QAAAtiF,gBAA+B9d,GAAAA,cAE9BxY,KAAA64G,OAAS,IAUV1C,GAAAn2G,KAAAw4G,aAAuB,EAoH9Bx4G,KAAA+G,MAAQ,IAA0C/G,GAAAA,MAzGhD,MAAM84G,cAAeC,EAAAC,mBAAoBC,EAAAT,YAAaU,EAAA34F,UAAW44F,EAAA7iF,gBAAsB9/B,GACvFwJ,OAAKu4G,MAAsBtwG,EAAAA,WAAW,KACpCmxG,CAAAA,MAAOJ,MAAAA,GAAAA,SAEJ1iF,gBAAkBA,MAAAA,EAAmBt2B,EAAAA,KAAKs2B,gBAC/Ct2B,KAAKw4G,YAAcA,MAAAA,EAAex4G,EAAAA,KAAKw4G,YACvCx4G,KAAKugB,UAAYA,MAAAA,EAAavgB,EAAAA,KAAKugB,UArCrC/Y,wBACc+wG,MAAMj6F,OAAO9W,MAG3BC,yBACc8wG,MAAMj6F,OAAO7W,OAO3Bc,0BACcswG,OAAO/yE,QAAQv9B,QAG7BA,YACEvI,QAAK64G,OAAO/yE,QAAQv9B,QAKtBoQ,EAAA4H,4BACcg4F,MAAM/lF,sBAGpBjS,cACEvgB,QAAKu4G,MAAM/lF,sBAaN7Z,EAAA2H,sBACAi4F,MAAMj4F,iBAGND,kBA8BPoS,UAEE6b,EACAD,EACAgrE,EACAC,EACA16B,EACAC,EACA06B,EACAC,EAEAhkG,GAAe,GAAA,IAAiB1L,GAAA,IAC9BnH,EAAA,OACoB,GAAA,IAAiBpL,GAAA,IACrCie,EAAA,OACyB,GAAA,IAAVhO,EAAAA,OAAgC,IAAXC,EAAAA,OACpC,YAGG8wG,MAAMh1E,YAAcvjC,KAAKuI,QAC9B,MAAc0oB,EAAAA,CAAOqd,EAAID,EAAIgrE,EAAQC,EAAS16B,EAAIC,EAAI06B,EAAQC,EAC3Dh6E,GAAAA,QAAQjoC,QAAAA,IACR0J,IAAAA,KAAyBw4G,GAAA,iBAAYz5G,GAAAA,KAAKw4G,cAAoBjhH,EACjEyI,SAAKu4G,MAAM9lF,UAAU/6B,MAAMsI,KAAKu4G,MAChC7sB,GAAoBD,GAAAA,gBACAE,GAAAA,iBAGf,EAAA70B,SAAwBzvB,EAAajxB,EAAcmX,EAAYzjB,EACpE9J,QAAKu4G,MAAMvoF,OACXhwB,KAAKu4G,MAAM9qF,YACXztB,KAAKu4G,MAAM38F,YAAoB3oB,EAAAA,WAC/B+M,KAAKu4G,MAAM3qF,OAAO5tB,KAAKw4G,cAAsBp4G,EAAI4kB,EAAM5kB,EAAGJ,EAAAA,KAAKw4G,cAAsBn4G,EAAI2kB,EAAM3kB,EAC/FL,GAAAA,KAAKu4G,MAAM1qF,OAAO7tB,KAAKw4G,cAAoBp4G,EAAIinC,EAAIjnC,EAAGJ,EAAAA,KAAKw4G,cAAoBn4G,EAAIgnC,EAAIhnC,EACvFL,GAAAA,KAAKu4G,MAAM7qF,UACX1tB,EAAAA,KAAKu4G,MAAMxqF,SACX/tB,KAAKu4G,MAAMzqF,YACX9tB,KAAKu4G,MAAMjoF,UAGNopF,cAA2BlyG,EAAeC,EAAgB2O,EAC/DpW,QAAKu4G,MAAMvoF,OACXhwB,KAAKu4G,MAAM/vG,UAAkBvV,EAAAA,WAC7B+M,KAAKu4G,MAAMr/E,SACTl5B,KAAKw4G,cAAoBp4G,EAAIkI,EAAIlI,EACjCJ,EAAAA,KAAKw4G,cAAoBn4G,EAAIiI,EAAIjI,EACjCL,EAAAA,KAAKw4G,cAAwBhxG,EAC7BxH,EAAAA,KAAKw4G,cAAyB/wG,EAEhCzH,GAAAA,KAAKu4G,MAAMjoF,UAGN8/B,WAAwBjiC,EAAgB/X,EAC7CpW,QAAKu4G,MAAMvoF,OACXhwB,KAAKu4G,MAAM9qF,YACXztB,KAAKu4G,MAAM/vG,UAAkBvV,EAAAA,WAC7B+M,KAAKu4G,MAAMvqF,IAAIhuB,KAAKw4G,cAAoBp4G,EAAIkI,EAAIlI,EAAGJ,EAAAA,KAAKw4G,cAAoBn4G,EAAIiI,EAAIjI,EAAG8tB,EAAQjrB,EAAa,EAAVnR,EAAAA,KAAK+a,IACvG9M,KAAKu4G,MAAMnqF,OACXpuB,KAAKu4G,MAAMzqF,YACX9tB,KAAKu4G,MAAMjoF,UAQbN,YACOuoF,MAAMvoF,OAMbM,eACOioF,MAAMjoF,UAQb7W,UAAqBpZ,EACnBL,QAAKu4G,MAAM9+F,UAAUzZ,KAAKw4G,cAAoBp4G,EAAGJ,EAAAA,KAAKw4G,cAAoBn4G,EAM5E6C,GAAA0R,OACE5U,QAAKu4G,MAAM3jG,OAQb+D,GAAA9E,MAAiBxT,EACfL,QAAKu4G,MAAM1kG,MAASxT,EAGtB6C,GAAAoN,aAEOioG,MAAMlwG,UAAa,EAAGrI,EAAAA,KAAKwH,MAAOxH,KAAKyH,QAC5CzH,KAAKu4G,MAAM/vG,UAAYxI,KAAKs2B,gBAAgBrjC,WAC5C+M,KAAKu4G,MAAMr/E,SAAY,EAAGl5B,EAAAA,KAAKwH,MAAOxH,KAAKyH,QACvB6I,GAAAA,QAMtB++E,gBCrQFsqB,sBACUC,YAAwB,GAAA55G,KACxB65G,kBAAmC1rE,GAAAA,WAEpCne,YACA4pF,YAAY5mH,KAAKgN,KAAK65G,mBAC3B75G,KAAK65G,kBAAoB75G,KAAK65G,kBAAkB7kG,QAG3Csb,eACAupF,kBAAoB75G,KAAK45G,YAAYvpG,MAGrCoJ,UAAqBpZ,EAC1B6C,eAAY22G,kBAAkBpgG,UAAapZ,EAGtC6C,GAAA0R,OACL+D,eAAYkhG,kBAAkBjlG,OAGzB+D,GAAA9E,MAAiBxT,EACtB6C,eAAY22G,kBAAkBhmG,MAASxT,EAGzC6C,GAAA4iC,YACE9lC,QAAK65G,kBAGPlhG,EAAAmtB,0BACc+zE,yBCDdC,eAAwDC,EAA+BC,EAAnEC,QAAAhe,IAAoCie,EAAAl6G,KAAA+5G,cAA+BI,EAAAn6G,KAAAg6G,gBAZhFC,EAAAj6G,KAAAi9F,QAA+B,KAE/Bj9F,KAAAo6G,SAA0D,QAC1DC,WAAoE,QACpEC,OAAsC,GAAAt6G,KAStCu6G,QAGCL,GAAAM,eAA0CC,EAA2BC,EAC3E3qH,GAAA,MAAgBqhC,EAAGgrE,EAAAA,gBACH,GAAA,OACdue,EAAA,MAAMj1G,MAAM,4CAWd,GAPG62F,EAAAA,aAAsBke,EACzBrpF,GAAGmrE,EAAAA,aAAsBme,EAGzBtpF,GAAGorE,EAAAA,YAGHme,IADmBle,EAAAA,oBAA6BrrE,EAAGsrE,EAAAA,aAEjD,MAAMh3F,MAAM,gCAAmCk1G,EAAAA,kBAAkB3d,cAM7D0d,EAAAE,eAA0C5mH,EAAgBiG,EAChEnK,GAAA,MAAeqhC,EAAGgsE,EAAAA,aAClBrtG,GAAe,GAAA,OACb4qH,EAAA,MAAMj1G,MAAM,4BAA4BzR,MAO1C,GAJGspG,EAAAA,aAAqBtpG,EACxBm9B,GAAGosE,EAAAA,cAGHmd,IADmBld,EAAAA,mBAA2BrsE,EAAGssE,EAAAA,gBAE/C,MAAMh4F,MAAM,6BAAgCi4F,EAAAA,iBAAiBR,cASjEwd,EAAAJ,QACE5hG,GAAA,MAAqB3Y,EAAAA,KAAK66G,eAAmB76G,EAAAA,KAAK+5G,cAAkBzc,EAAAA,eAC7Ct9F,EAAAA,KAAK66G,eAAmB76G,EAAAA,KAAKg6G,gBAAoB3c,EAAAA,iBACxDr9F,EAAAA,KAAKw6G,eAAmBC,EAAcC,EACtDI,eAAa7d,QAQR0d,EAAAI,iBAA+BzgH,EACpC4I,GAAA,IACEA,EAAA,MAAMwC,MAAM,0BAA0B5N,mCAExC,MAAWkI,EAAAA,KAAKi8F,SACXme,SAAiBzhG,GACpB7gB,CAAAA,KACAoC,EAAAA,KAAM,SACN8gH,SAAa3c,EAAAA,mBAAmBr+F,KAAKi9F,QACrC3iG,GAAAA,KASG4I,GAAA+3G,uBAAqC3gH,EAC1C4I,GAAA,IACEA,EAAA,MAAMwC,MAAM,kCAAkC5N,mCAEhD,MAAWkI,EAAAA,KAAKi8F,SACXme,SAAiBzhG,GACpB7gB,CAAAA,KACAoC,EAAAA,KAAM,UACN8gH,SAAa3c,EAAAA,mBAAmBr+F,KAAKi9F,QACrC3iG,GAAAA,KAUG4I,GAAAg4G,aAA2BvnG,EAAcwnG,EAAgB/xC,EAAat/D,GAAA,GAC3E,MAAW9J,EAAAA,KAAKi8F,IAEI4B,kBAAkB79F,KAAKi9F,QAC3Cj9F,QAAKq6G,WAAmB1hG,GACtB7gB,CAAAA,KACA6b,EAAAA,KACAwnG,EAAAA,OACA/xC,EAAAA,WACA4xC,EAAAA,SAEFh7G,QAAKs6G,OAAOtnH,KAAKgN,KAAKq6G,WAAWviH,IAMnCsjH,0BACE,IAAiBC,EACjB,MAAK,MAAMC,KAAAA,KAAahB,OACRgB,GAAK3nG,EAAAA,YAQvB0nG,EAAAE,2BACE,IAAiBF,EACjB,MAAK,MAAMC,KAAAA,KAAahB,OACtB,CAAA,IAAekB,EACf,EAEeA,EAFFL,EAAAA,cACDlf,IAAIiC,MAEZ,EAMJud,EAAcC,GAAWJ,EAAK3nG,EAAAA,YAU3B0nG,EAAAM,iBACLhjG,GAAA,IAAeijG,EACf,SAEeA,OAFFvB,WAAiBc,GAAAA,cAClBlf,IAAIiC,MAEZ,EAMJ,EAAkBl+F,EAAAA,KAAKq6G,WAAiB1mG,GAAAA,KAQnCoxD,MACL,MAAW/kE,EAAAA,KAAKi8F,IACbU,EAAAA,WAAW38F,KAAKi9F,SACnB,IAAa2e,EACb,MAAK,MAAMN,KAAAA,KAAahB,OACnBtc,EAAAA,oBAAyBgd,EAAAA,SAAernG,EAAAA,KAAWwnG,EAAAA,OAAa/xC,EAAAA,WAAYppE,KAAKu7G,qBACpFnqF,GAAG2sE,EAAAA,wBAA6Bid,EAAAA,UACtBh7G,GAAAA,KAAK27G,iBAAsB7jH,EAAAA,UAGlC,MAAMrE,KAAAA,KAAY2mH,SACrB,CAAA,MAAgBp6G,EAAAA,KAAKo6G,SACrByB,UAAgB3hH,EAAAA,mBAET4hH,EAAAA,iBAAyBd,EAAAA,UAAU,EAAe1gH,EAAAA,0BAIlDyhH,EAAAA,WAAmBf,EAAAA,SAAkB1gH,EAAAA,eChNhD0hH,eAAmBC,QAAA3+G,IAFnB2+G,EAAAj8G,KAAAk8G,WAAAA,EACOl8G,KAAAm8G,SAAgB,GAGvBC,qBACWD,SAAS7qH,QAAU0O,KAAK1C,IAMnC++G,qBACeD,SAGfroG,IACE/T,QAAKm8G,SAASnpH,KAGhB2lB,GAAAwG,sBACOg9F,SAAS7qH,OACP0O,EAAAA,YCPTs8G,eAESC,EACAC,EAAqBhB,EAAA,UAFrBiB,QACAC,EAAA18G,KAAAu8G,SACAX,EAAA57G,KAAAw8G,WARFhB,EAAAx7G,KAAA28G,iBACA,EAAA38G,KAAAzO,MACA,EAAAyO,KAAA48G,QAAkB,GAAA58G,KACjBwd,QAAiB3L,EAAAA,cAczBgrG,MACElkG,GAAA,MAAe4F,EAAQve,EAAAA,aAEdA,EAAAA,KAAKutF,QAEPvtF,GAAAA,KAAKutF,OAOduvB,OAEEv+F,GADeve,EAAAA,KAAKpL,OAAAA,KAEfrD,QAOPqD,OAQE+jB,GAPI3Y,GAEgBA,KAFXzO,QAAUyO,KAAKw8G,aAEtBx8G,KAAKwd,QAAQvW,KAAK,8DAClBjH,KAAKw8G,WAAax8G,EAAAA,KAAKw8G,YAIrBx8G,KAAK48G,QAAQ58G,KAAKzO,OAEpB,OAAAyO,KAAYu8G,SAASv8G,KAAK48G,QAAQ58G,KAAKzO,YAClConB,GAEL3Y,MAAK28G,mBACL,MAAgB38G,EAAAA,KAAK48G,QAAQ58G,KAAKzO,SAAAA,KAAgBkrH,WAElD9jG,UADOujG,EAAAA,MAAQl8G,KAcnB67G,GAAAtuB,QAEEvtF,QAAKzO,MACL,MAAK,MAAMgD,KACTokB,EAAA,CAAA,MAAkB3Y,EAAAA,KAAK48G,QAAQnrH,QAE/BuO,QAAK48G,QAAsB58G,GAAAA,KAAay8G,UACxCz8G,KAAK48G,QAAmBV,GAAAA,MAAQl8G,KAAAA,KAC3B28G,mBAEET,EAAAA,WAAAA,SCxDNvjG,SAaLokG,0BAZAC,OAAAh8B,SAIQ,EAAAhhF,KAAAi9G,QAA8B,KAC9Bj9G,KAAAk9G,qBAA+B,IAM/Bl9G,KAAAm9G,SAA8B,GAAAn9G,KAE/Bi8F,IAAc7qE,EACnBA,GAAA,MAAgB56B,EAAQ4mH,EAAAA,aACnBC,oBAAiD,QAA3B7mH,EAAAA,MAAAA,OAAAA,EAAS8mH,EAAAA,0BAAAA,IAAkBzB,EAAIA,EAC1D77G,EAAAA,KAAKk9G,qBAAmD,QAA5B1mH,EAAAA,MAAAA,OAAAA,EAAS+mH,EAAAA,2BAAAA,IAAmBC,EAAIx9G,EAAAA,KAAKk9G,qBACjE,MAA0CO,EAAA,QAArBjnH,EAAAA,MAAAA,OAAAA,EAASknH,EAAAA,oBAAAA,IAAYV,EAAIA,EAAA,IAAO,IAAoBh9G,GAAAA,KAAKk9G,2BAEzEf,SAAW,IACdG,IAAA,IAAM,IACL7kH,IAAMA,GAAE0nB,EAAAA,gBACJ+9F,sBAEPl9G,KAAK29G,WAAa,IAA0BD,GAAelmH,GAAMA,GAAE2nB,EAAAA,WAAW,KAMzEgpF,OACL,MAAWnoG,EAAAA,KAAKi8F,SACXkB,OAASn9F,KAAK49G,YAGnB59G,GAAAA,KAAK69G,UAAY,IAAInwE,aAAa1tC,KAAKm9F,OAAOie,oBAAsBp7G,KAAKq9G,oBAAsBr9G,KAAKk9G,sBACpGl9G,KAAKi9G,QAAav4F,EAAAA,eACfo5E,EAAAA,WAAcf,EAAAA,aAAc/8F,KAAKi9G,SACjCngB,EAAAA,WAAcC,EAAAA,aAAc/8F,KAAK69G,UAAcC,EAAAA,cAGpDrC,6BACcte,OAAOie,oBAGd2C,WACwBplG,GAAA,IAAzB3Y,KAAKm9G,SAAS7rH,QAChB0O,KAAKm9G,SAASnqH,KAAKgN,KAAK29G,WAAW/oH,OAGrC,MAAkBoL,EAAAA,KAAKm9G,SAASn9G,KAAKm9G,SAAS7rH,OAC9C,GAAI0sH,GAAU3B,EAAAA,SACFtoG,EAAAA,IAAIkqG,OAEd,CAAA,MAAiBj+G,EAAAA,KAAK29G,WAAW/oH,MACxBmf,EAAAA,IACT/T,GAAAA,KAAKm9G,SAASnqH,KAAKkrH,IAyBhBvG,SACL,MAAW33G,EAAAA,KAAKi8F,IACb6B,EAAAA,WAAcf,EAAAA,aAAc/8F,KAAKi9G,SACpCj9G,KAAKm9F,OAAOp4B,MACZ,IAAoBo5C,EAChBC,EAAmBC,EACvB,MAAK,MAAMC,KAAAA,KAAcnB,SAGvB,CAAA,MAAoBn9G,EAAAA,KAAKu+G,mBAAmBv+G,KAAK69G,UACjDzsF,GAAGotF,EAAAA,cAAiBzhB,EAAAA,aAAiB/8F,EAAAA,KAAK69G,WAE1C79G,KAAKy+G,YAAgBH,EAAOI,EAC5BN,GAAoBE,GAAMnC,EAAAA,SAAS7qH,OACnCqtH,SAEGxC,SAAS5uB,OACdvtF,KAAK29G,WAAWpwB,OAChBvtF,KAAKm9G,SAAS7rH,OACdo6F,EAAoBD,GAAAA,eACpBC,EAAoBC,GAAAA,kBC9HjB0yB,SAAPO,sBAESxoG,MAAqBe,GAAAA,MACrBnX,KAAAglB,MAAuBxS,EAAAA,KACvBxS,KAAAqnC,IAAqB70B,EAAAA,KACrB2M,sBACA/I,MAAU/S,EACfrD,EAAAA,KAAKoW,MAAU5d,EACfwH,EAAAA,KAAKoW,MAAU5e,EACfwI,EAAAA,KAAKoW,MAAU7e,EACfyI,EAAAA,KAAKglB,MAAM7R,MAAS,EACpBnT,GAAAA,KAAKqnC,IAAIl0B,MAAS,EACXnT,GAAAA,YAIE6+G,WACX9B,eAA+C+B,EAC7CxsG,GAAAA,MAAQ8e,CAAAA,GAAIgsF,EAAAA,QAAmBE,GAAAA,mBAAoB,SADNwB,aAE7C9+G,EAAAA,KAAKmoG,OAGPyV,YACEjlG,GAAA,MAAeomG,EAAA,IAAW3tF,GCjC9BzY,EAAA,mSCAA,4HFmCWuiG,EAAAA,aAAa,aAAiB9pF,EAAG8sE,EAAAA,OACjCgd,EAAAA,aAAa,UAAc9pF,EAAG8sE,EAAAA,OAC9B6c,EAAAA,iBAAiB,WAAY/6G,KAAK8+G,aAAa/kG,OAAOzf,MAI/DykH,EAAAC,QAAuB33E,EAAajxB,EAClCrmB,GAAA,MAAYiQ,EAAAA,KAAKm8G,SAASvnH,MACtBowB,EAAAA,MAAQhlB,KAAK8+G,aAAahlG,UAAUgsB,QAAQ9rB,MAChDikG,GAAI52E,EAAAA,IAAMrnC,KAAK8+G,aAAahlG,UAAUgsB,QAAQ9rB,MAC9CikG,GAAI7nG,EAAAA,MAAUA,EAAM/S,EACpB46G,EAAI7nG,EAAAA,MAAUA,EAAM5d,EACpBylH,EAAI7nG,EAAAA,MAAUA,EAAM5e,EACpBymH,EAAI7nG,EAAAA,MAAU6nG,EAAI7nG,EAAAA,MAAUpW,EAAAA,KAAK8+G,aAAatlH,MAAMssC,QAAQv9B,QAC5DvI,KAAK+9G,WAGPkB,GAAAV,mBAA+CD,EAC7Cp7G,GAAA,IAAYg8G,EACZ,MAAK,MAAM9B,KAAiBjB,EAAAA,SAEb5qH,EAAAA,KAAmByzB,EAAAA,MAChCm6F,EAAa5tH,EAAAA,KAAmByzB,EAAAA,MAChCm6F,EAAa5tH,EAAAA,KAAmB6kB,EAAAA,MAAU/S,EAAA,IAC7B9R,EAAAA,KAAmB6kB,EAAAA,MAAU5d,EAAA,IAC7BjH,EAAAA,KAAmB6kB,EAAAA,MAAU5e,EAAA,IAC7BjG,EAAAA,KAAmB6kB,EAAAA,MAGhC+oG,EAAa5tH,EAAAA,KAAmB81C,EAAAA,IAChC83E,EAAa5tH,EAAAA,KAAmB81C,EAAAA,IAChC83E,EAAa5tH,EAAAA,KAAmB6kB,EAAAA,MAAU/S,EAAA,IAC7B9R,EAAAA,KAAmB6kB,EAAAA,MAAU5d,EAAA,IAC7BjH,EAAAA,KAAmB6kB,EAAAA,MAAU5e,EAAA,IAC7BjG,EAAAA,KAAmB6kB,EAAAA,MAElC7e,SAAeyI,EAAAA,KAAKy7G,WAGtBgD,YAAuCW,EAAgCV,EACrEttF,GAAGmtE,EAAAA,WAAc8gB,EAAAA,MAAUX,EAAAA,KjBnE7BnlB,GADUD,KAAegmB,GAAA,KACzBnoF,MAAA,QACAoiE,GAAA4R,KAAA,OACA5R,GAAAnzB,UAAA,YACAmzB,GAAAr+B,OAAA,eAqCAqkD,eAEEjxE,EACAD,EACAgrE,EACAC,EACA16B,EACAC,EACA06B,EACAC,EA1CF3J,QAAAqM,WAAAA,EAEOl8G,KAAAw4G,aAAuB,EAGvBx4G,KAAA9F,KAAuBi9B,GAAAA,MACvBn3B,KAAAuI,QACA,EAAAvI,KAAAwH,MACA,EAAAxH,KAAAyH,OACA,EAAAzH,KAAAgwC,KAA0B,CAAG,EAC7B,QAAAwvE,KAA0C,CAAG,EAAG,EAAG,EAClD,QAAAC,MACL,EAAG,EACJ,IAAI,EACJ,IAAI,EACJ,IAAI,EACJ,IAAI,EACJ,IAAI,EAAA,SA2BCtX,KAAY75D,EAAID,EAAIgrE,EAAQC,EAAS16B,EAAIC,EAAI06B,EAAQC,EAGrD3J,GAAA1H,KAEL75D,EACAD,EACAgrE,EACAC,EACA16B,EACAC,EACA06B,EACAC,EAEAx5G,QAAK9F,KAAuBi9B,GAAAA,MAC5Bn3B,KAAKixB,MACLjxB,EAAAA,KAAKwH,OAAQypB,MAAAA,OAAAA,EAAOzpB,EAAAA,QAAmBsC,GACvC9J,EAAAA,KAAKyH,QAASwpB,MAAAA,OAAAA,EAAOxpB,EAAAA,SAAqB9E,GAC1C3C,EAAAA,KAAKw/G,KAAQ,CAAG,EAAGnG,EAAAA,MAAAA,EAAUpoF,EAAAA,MAAAA,OAAAA,EAAOzpB,EAAAA,MAAO8xG,MAAAA,EAAWroF,EAAAA,MAAAA,OAAAA,EAAOxpB,EAAAA,aACxDuoC,KAAQ1B,CAAID,EAAAA,YAEbuwC,QAAAA,IAAoBC,QAAAA,IAAoB06B,QAAAA,IAAwBC,IAClEx5G,KAAKw/G,KAAQlxE,CAAID,EAAIgrE,EAAAA,MAAAA,EAAUpoF,EAAAA,MAAAA,OAAAA,EAAOzpB,EAAAA,MAAO8xG,MAAAA,EAAWroF,EAAAA,MAAAA,OAAAA,EAAOxpB,EAAAA,aAC1DuoC,KAAQ4uC,CAAIC,EACjB7+E,QAAKwH,MACLxH,EAAAA,KAAKyH,OAGP+N,GAAA,IAAYk8F,EAOZ,EANA1xG,GAOa0Z,KAPR+lG,MAAMluH,KAAAA,MAAiBy+C,KAAShwC,QAAKgwC,KAAK,SAC1CyvE,MAAMluH,KAAAA,MAAiBy+C,KAAShwC,QAAKgwC,KAAUhwC,GAAAA,KAAKyH,aACpDg4G,MAAMluH,KAAAA,MAAiBy+C,KAAUhwC,GAAAA,KAAKwH,WAAYwoC,KAAK,SACvDyvE,MAAMluH,KAAAA,MAAiBy+C,KAAUhwC,GAAAA,KAAKwH,WAAYwoC,KAAK,SACvDyvE,MAAMluH,KAAAA,MAAiBy+C,KAAShwC,QAAKgwC,KAAUhwC,GAAAA,KAAKyH,aACpDg4G,MAAMluH,KAAAA,MAAiBy+C,KAAUhwC,GAAAA,KAAKwH,WAAYwoC,KAAUhwC,GAAAA,KAAKyH,aAC7D+wG,YACP,IAAK,MAAM9+F,KAAAA,KAAc+lG,MACjBC,EAAA,KAAaA,EACnBhmG,GAAMgmG,EAAA,KAAaA,EAGvB,eAGKC,SAAuB36F,EAAexd,EAAeC,EAC1DzH,QAAK9F,KAAuBksE,GAAAA,UAC5BpmE,KAAKoW,MACLpW,EAAAA,KAAKwH,MACLxH,EAAAA,KAAKyH,OACLqC,EAAA,IAAY81G,EAQZ,EAPA5/G,GAQa0Z,KARR+lG,MAAMluH,KAAAA,CAAkB6O,EAAG4kB,EAAM3kB,EACtCL,QAAKy/G,MAAMluH,KAAAA,CAAkB6O,EAAG4kB,EAAM3kB,EAAIL,EAAAA,KAAKyH,aAC1Cg4G,MAAMluH,KAAAA,CAAkB6O,EAAIJ,EAAAA,KAAKwH,MAAanH,EACnDL,QAAKy/G,MAAMluH,KAAAA,CAAkB6O,EAAIJ,EAAAA,KAAKwH,MAAanH,EACnDL,QAAKy/G,MAAMluH,KAAAA,CAAkB6O,EAAG4kB,EAAM3kB,EAAIL,EAAAA,KAAKyH,aAC1Cg4G,MAAMluH,KAAAA,CAAkB6O,EAAIJ,EAAAA,KAAKwH,MAAanH,EAAIL,EAAAA,KAAKyH,aAEnD+wG,YACP,IAAK,MAAM9+F,KAAAA,KAAc+lG,MACjBI,EAAA,KAAaA,EACnBnmG,GAAMmmG,EAAA,KAAaA,EAGvB,eAGKC,SAAuB96F,EAAeqiB,EAAa9Z,EACxDvtB,QAAK9F,KAAuBixG,GAAAA,KAC5BnrG,KAAKoW,MACLuC,EAAA,MAAY0uB,EAAIpzB,EAAAA,IAAW1Z,GAAAA,YACRga,gBACDgZ,EAAYzjB,EACxBi2G,EAAWvrG,EAAOX,EAAAA,MAAiBE,GAAAA,IACnCisG,GAAcxrG,EAAOX,EAAAA,OAAkBE,GAAAA,IACvCksG,GAASzrG,EAAOX,EAAAA,MAAiBE,GAAAA,IACjCmsG,GAAY1rG,EAAOX,EAAAA,OAAkBE,GAAAA,IAU3ChkB,GAAA,IAAYowH,EAQZ,EAPAngH,GAQa0Z,KARR+lG,MAAMluH,KAAAA,CAAqB6O,EAAG2/G,EAAS1/G,EAC5CL,QAAKy/G,MAAMluH,KAAAA,CAAmB6O,EAAG6/G,EAAO5/G,EACxCL,QAAKy/G,MAAMluH,KAAAA,CAAwB6O,EAAG4/G,EAAY3/G,EAClDL,QAAKy/G,MAAMluH,KAAAA,CAAwB6O,EAAG4/G,EAAY3/G,EAClDL,QAAKy/G,MAAMluH,KAAAA,CAAmB6O,EAAG6/G,EAAO5/G,EACxCL,QAAKy/G,MAAMluH,KAAAA,CAAsB6O,EAAG8/G,EAAU7/G,EAE1CL,QAAKw4G,YACP,IAAK,MAAM9+F,KAAAA,KAAc+lG,MACjBW,EAAA,KAAaA,EACnB1mG,GAAM0mG,EAAA,KAAaA,EAGvB,eAGKC,WAAwBlyF,EAAgB/X,EAC7CpW,QAAK9F,KAAuBghE,GAAAA,OAC5Bl7D,KAAKoW,MACLrmB,EAAA,MAAgBuY,EAAIyL,EAAAA,IAASoa,GAASA,GAAAA,IACrB7lB,EAAIyL,EAAAA,IAAQoa,EAASA,GAAAA,IAClB7lB,EAAIyL,EAAAA,IAAQoa,EAAQA,EAAAA,IACrB7lB,EAAIyL,EAAAA,IAASoa,GAAQA,EAAAA,IACxC,IAAYugB,EAQZ,EAPA1uC,GAQa0Z,KARR+lG,MAAMluH,KAAAA,CAAoB6O,EAAGkgH,EAAQjgH,EAC1CL,QAAKy/G,MAAMluH,KAAAA,CAAqB6O,EAAGmgH,EAASlgH,EAC5CL,QAAKy/G,MAAMluH,KAAAA,CAAuB6O,EAAGogH,EAAWngH,EAChDL,QAAKy/G,MAAMluH,KAAAA,CAAuB6O,EAAGogH,EAAWngH,EAChDL,QAAKy/G,MAAMluH,KAAAA,CAAqB6O,EAAGmgH,EAASlgH,EAC5CL,QAAKy/G,MAAMluH,KAAAA,CAAwB6O,EAAGqgH,EAAYpgH,EAE9CL,QAAKw4G,YACP,IAAK,MAAM9+F,KAAAA,KAAc+lG,MACjBiB,EAAA,KAAaA,EACnBhnG,GAAMgnG,EAAA,KAAaA,EAGvB,eAGKvhG,eACA8R,MAAQ,KACbjxB,KAAKwH,MACLxH,EAAAA,KAAKyH,OACLzH,EAAAA,KAAKw/G,KAAQ,CAAG,EAAG,EAAG,EACtBx/G,QAAKgwC,KAAQ,CAAG,EAEhB,GAAA,IAAY0wE,EAOZ,cANKjB,MAAMluH,KAAAA,MAAiBy+C,KAAShwC,QAAKgwC,KAAK,SAC1CyvE,MAAMluH,KAAAA,MAAiBy+C,KAAShwC,QAAKgwC,KAAUhwC,GAAAA,KAAKyH,aACpDg4G,MAAMluH,KAAAA,MAAiBy+C,KAAUhwC,GAAAA,KAAKwH,WAAYwoC,KAAK,SACvDyvE,MAAMluH,KAAAA,MAAiBy+C,KAAUhwC,GAAAA,KAAKwH,WAAYwoC,KAAK,SACvDyvE,MAAMluH,KAAAA,MAAiBy+C,KAAShwC,QAAKgwC,KAAUhwC,GAAAA,KAAKyH,aACpDg4G,MAAMluH,KAAAA,MAAiBy+C,KAAUhwC,GAAAA,KAAKwH,WAAYwoC,KAAUhwC,GAAAA,KAAKyH,aAKxEk5G,eAAkCp4G,EAChCrF,GAAI4W,GACFnB,EAAA,IAAK,IAAQioG,EAAG7wH,EAAIiQ,EAAAA,KAAKy/G,MAAMnuH,OAAQvB,IACrCiQ,KAAKy/G,MAAW3lG,GAAUE,EAAAA,MAAMha,KAAKy/G,MAAM1vH,IACvCiQ,KAAKw4G,cACPx4G,KAAKy/G,MAAWmB,GAAA,QAAQnB,MAASmB,GAAA,UAAWnB,MAASmB,GAAA,UAItDr4G,QAGPrF,EAAA29G,2BACcpB,aoB1MHqB,WAKX9E,eAA4C+E,EAC1CzuG,GAAAA,MADiB0uG,GAAAhhH,KAAAihH,SAAyBD,EAAAhhH,KAAA+gH,YAJrCH,EAAA5gH,KAAAkhH,SAA2B,GAAAlhH,KAC3Bm8G,SAA+B,GAAAn8G,KAC9BmhH,YAAyC,GAMjD/E,qBACWD,SAAS7qH,QAAU0O,KAAKihH,UAG7BjhH,KAAKkhH,SAAS5vH,QAAU0O,KAAK+gH,YAMnC1E,sBACWF,SAAS7qH,QAAU0O,KAAKihH,WAI7BjhH,KAAKkhH,SAAS5vH,OAAS0O,KAAK+gH,YAO1BK,6BACMjF,SAAS7qH,QAAU0O,KAAKihH,SAG9BI,6BACMH,SAAS5vH,QAAU0O,KAAK+gH,YAG9BO,iBACN3oG,eAAawoG,YAAoBlwF,EAAAA,MAAM7yB,IAGzCmjH,SACE5oG,iBAAUyoG,kBAAAA,KAAyBC,mBAAAA,KAA0BC,iBAAiBlE,KAAAA,KAIzErpG,IAAIqpG,GACF,IAGTrpG,IACE4E,GAAIykG,GAAQljH,EAAAA,OAAyBi9B,GAAAA,MACnC,CAAA,MAAgBpG,EAAciE,GAAAA,KAAa/D,EAAAA,QACH,IAApCjxB,KAAKkhH,SAASzvH,QAAQkvC,IACxB3gC,KAAKkhH,SAASluH,KAIlBgN,QAAKm8G,SAASnpH,KAGhB2lB,GAAA6oG,aAEE7oG,OAAK,IAAQ8oG,EAAG1xH,EAAIiQ,EAAAA,KAAK+gH,YAAahxH,IACjC2xH,EAAAA,cAAiBC,EAAAA,SACpBvwF,GAAGE,EAAAA,YAAeC,EAAAA,WAAYvxB,KAAKkhH,SAASnxH,IAAMiQ,KAAKkhH,SAAS,IAIpEU,kBACEjpG,UAAYsY,EAAAA,MACHjxB,KAAKkhH,SAASzvH,QAAsBmD,GAAAA,IAAYq8B,EAAAA,SAK3D,EAAA9R,sBACO7O,QACEtQ,KAGTsQ,aACO6rG,SAAS7qH,OACd0O,EAAAA,KAAKkhH,SAAS5vH,OACd0O,EAAAA,KAAKmhH,YAAc,UAIVU,WACX9E,eAA+C+B,EAC7CxsG,GAAAA,MACE8e,CAAAA,GACAgsF,EAAAA,QAEAE,GAAAA,mBACAC,EAAAA,oBAAqB,IACrBG,aAAc,IAAM,IAAenvF,GAAA,IAASuzF,EAAAA,aAAgBC,EAAAA,iCAPjBjD,aAS7C/tF,EAAcixF,GAAAA,gBACdhiH,GAAAA,KAAKmoG,OAGPyV,YAEEjlG,GAAA,MAAuByY,EAAG0wF,EAAAA,aAAgBC,EAAAA,yBAC3BE,EAAA,IAAW7wF,GCzH9BzY,EAAA,8yBDyHqD3Y,KAAKkiH,yBEzH1D,o4CFyHwGC,WAC7FjH,EAAAA,aAAa,aAAiB9pF,EAAG8sE,EAAAA,OACjCgd,EAAAA,aAAa,aAAiB9pF,EAAG8sE,EAAAA,OACjCgd,EAAAA,aAAa,iBAAqB9pF,EAAG8sE,EAAAA,OACrCgd,EAAAA,aAAa,YAAgB9pF,EAAG8sE,EAAAA,OAChCgd,EAAAA,aAAa,UAAc9pF,EAAG8sE,EAAAA,OAC9B6c,EAAAA,iBAAiB,WAAY/6G,KAAK8+G,aAAa/kG,OAAOzf,MAEtD2gH,EAAAA,uBACL,aACA,IAAItxG,MAAMw4G,IAAiBlhH,KAAKkG,CAAGpX,EAAAA,IAAMA,KAKrCkyH,EAAAC,yBAAyCnB,EAC/C79G,GAAA,IAAgBjP,EAAO0G,EAAAA,QAAQ,YAAyB1H,EAAAA,YAC7BmvH,EAAA,OACtB,IAAQC,EAAGtyH,EAAIgxH,EAAahxH,EAAAA,IACrBqyH,GAAA,IACgBC,EAAA,yBAAyBtyH,WAEzB,iCAAiCA,WAEnCqyH,GAAA,sCAAsCryH,qBACtCqyH,GAAA,gBAEdE,EAAU3nH,EAAAA,QAAQ,qBACvB2nH,GAGFL,EAAAM,UAAuBp0F,EAAgB/X,EAC5CrmB,GAAA,MAAgBiQ,EAAAA,KAAKm8G,SAASvnH,MAAMyrH,WAAgBlyF,EAAQ/X,EAC5DgnG,GAAQuD,EAAAA,eAAe3gH,KAAK8+G,aAAahlG,UAAUgsB,QAAS9lC,KAAK8+G,aAAatlH,MAAMssC,QAAQv9B,SAC5FvI,KAAK+9G,WAGAqE,GAAAI,aAA2Bl6G,EAAad,EAAeC,EAC5DqC,GAAA,MAAgB9J,EAAAA,KAAKm8G,SAASvnH,MAAM+qH,SAAgBr3G,EAAKd,EAAOC,EAChE21G,GAAQuD,EAAAA,eAAe3gH,KAAK8+G,aAAahlG,UAAUgsB,QAAS9lC,KAAK8+G,aAAatlH,MAAMssC,QAAQv9B,SAC5FvI,KAAK+9G,WAGA6B,GAAAZ,QAAsBh6F,EAAeqiB,EAAa9Z,EAAYzjB,EACnE,GAAA,MAAgB9J,EAAAA,KAAKm8G,SAASvnH,MAAMkrH,SAAgB96F,EAAOqiB,EAAK9Z,EAChE6vF,GAAQuD,EAAAA,eAAe3gH,KAAK8+G,aAAahlG,UAAUgsB,QAAS9lC,KAAK8+G,aAAatlH,MAAMssC,QAAQv9B,SAC5FvI,KAAK+9G,WAGA6B,GAAA6C,SAELn0E,EACAD,EACAgrE,EACAC,EACA16B,EACAC,EACA06B,EACAC,EAEAhkG,GAAA,MAAgBxV,EAAAA,KAAKm8G,SAASvnH,MAAMuzG,KAAc75D,EAAID,EAAIgrE,EAAQC,EAAS16B,EAAIC,EAAI06B,EAAQC,EAC3F4D,GAAQuD,EAAAA,eAAe3gH,KAAK8+G,aAAahlG,UAAUgsB,QAAS9lC,KAAK8+G,aAAatlH,MAAMssC,QAAQv9B,SAC5FvI,KAAK+9G,WAGArM,GAAA+M,YAAuCH,EAAmBI,EAE/DJ,GAAMkD,EAAAA,aAENpwF,GAAGmtE,EAAAA,WAAcC,EAAAA,UAAckgB,EAGjC3uH,GAAAwuH,mBAA+CD,WAC7CoE,EAAA,IAAgBC,EACZr0E,EAAas0E,EACbv0E,EAAaw0E,EACbC,EAAa5zE,EACb6zE,EAAaC,EACbC,EAAmBvR,EACnBwR,EAAoB/C,EACpBgD,EAAY/3G,EACZg4G,EAAehuG,EAAMmD,GAAAA,gBACpB,MAAM6kG,KAAiBjB,EAAAA,SACrBiB,CAAAA,EAAQoC,EAAAA,KACbnxE,GAAK+uE,EAAQoC,EAAAA,KACbsD,GAAK1F,EAAQoC,EAAAA,KACbuD,GAAK3F,EAAQoC,EAAAA,KAEbyD,GAAWzyF,EAAAA,IAA8B,QAAb4sF,EAAQnsF,EAAAA,aAAAA,IAAKoyF,OAAA,EAAE77G,EAAAA,QAAiBA,EAAAA,OAChDgpB,EAAAA,IAA8B,QAAb4sF,EAAQnsF,EAAAA,aAAAA,IAAKyxF,OAAA,EAAEj7G,EAAAA,SAAkBA,EAAAA,QAElD62G,EAAMsD,EAAAA,kBACdxE,GAAQljH,EAAAA,OAAyBixG,GAAAA,MAAgBjxG,EAAAA,OAAyBksE,GAAAA,YAC/Dh7D,GACbg4G,EAAehG,EAAQhnG,EAAAA,OAEblc,EAAAA,OAAyBghE,GAAAA,SACtB9vD,GACbg4G,EAAehG,EAAQhnG,EAAAA,OAKzB,IAAWk4B,EAAK20E,EACZK,EAAOj1E,EAAK60E,EACZK,EAAQj1E,GAAKw0E,EAAMG,GACnBO,EAAQn1E,GAAK00E,EAAMG,GACJ/C,GAAA,IAAfgD,IACKM,EACPH,EAAO1tB,EACP2tB,EAAOG,EACPF,EAAO3tB,EAKTspB,GAAawE,EAAAA,KAAuB9C,EAAAA,SAAY,GAChD1B,GAAawE,EAAAA,KAAuB9C,EAAAA,SAAY,GAChD1B,GAAawE,EAAAA,KAGbxE,EAAawE,EAAAA,KACbxE,EAAawE,EAAAA,KAEbxE,EAAawE,EAAAA,KAEbxE,EAAawE,EAAAA,KAAuBp7G,EAAAA,QAEvBo7G,EAAAA,KAA4BtgH,EAAIA,EAAA,IAChCsgH,EAAAA,KAA4BnrH,EAAIA,EAAA,IAChCmrH,EAAAA,KAA4BnsH,EAAIA,EAAA,IAChCmsH,EAAAA,KAA4BpsH,EAGzC4nH,EAAawE,EAAAA,KAAuB9C,EAAAA,SAAY,GAChD1B,GAAawE,EAAAA,KAAuB9C,EAAAA,SAAY,GAChD1B,GAAawE,EAAAA,KAGbxE,EAAawE,EAAAA,KACbxE,EAAawE,EAAAA,KAEbxE,EAAawE,EAAAA,KAEbxE,EAAawE,EAAAA,KAAuBp7G,EAAAA,QAEvBo7G,EAAAA,KAA4BtgH,EAAIA,EAAA,IAChCsgH,EAAAA,KAA4BnrH,EAAIA,EAAA,IAChCmrH,EAAAA,KAA4BnsH,EAAIA,EAAA,IAChCmsH,EAAAA,KAA4BpsH,EAGzC4nH,EAAawE,EAAAA,KAAuB9C,EAAAA,SAAY,GAChD1B,GAAawE,EAAAA,KAAuB9C,EAAAA,SAAY,GAChD1B,GAAawE,EAAAA,KAGbxE,EAAawE,EAAAA,KACbxE,EAAawE,EAAAA,KAEbxE,EAAawE,EAAAA,KAEbxE,EAAawE,EAAAA,KAAuBp7G,EAAAA,QAEvBo7G,EAAAA,KAA4BtgH,EAAIA,EAAA,IAChCsgH,EAAAA,KAA4BnrH,EAAIA,EAAA,IAChCmrH,EAAAA,KAA4BnsH,EAAIA,EAAA,IAChCmsH,EAAAA,KAA4BpsH,EAGzC4nH,EAAawE,EAAAA,KAAuB9C,EAAAA,SAAY,GAChD1B,GAAawE,EAAAA,KAAuB9C,EAAAA,SAAY,GAChD1B,GAAawE,EAAAA,KAGbxE,EAAawE,EAAAA,KACbxE,EAAawE,EAAAA,KAEbxE,EAAawE,EAAAA,KAEbxE,EAAawE,EAAAA,KAAuBp7G,EAAAA,QAEvBo7G,EAAAA,KAA4BtgH,EAAIA,EAAA,IAChCsgH,EAAAA,KAA4BnrH,EAAIA,EAAA,IAChCmrH,EAAAA,KAA4BnsH,EAAIA,EAAA,IAChCmsH,EAAAA,KAA4BpsH,EAGzC4nH,EAAawE,EAAAA,KAAuB9C,EAAAA,SAAY,GAChD1B,GAAawE,EAAAA,KAAuB9C,EAAAA,SAAY,GAChD1B,GAAawE,EAAAA,KAGbxE,EAAawE,EAAAA,KACbxE,EAAawE,EAAAA,KAEbxE,EAAawE,EAAAA,KAEbxE,EAAawE,EAAAA,KAAuBp7G,EAAAA,QAEvBo7G,EAAAA,KAA4BtgH,EAAIA,EAAA,IAChCsgH,EAAAA,KAA4BnrH,EAAIA,EAAA,IAChCmrH,EAAAA,KAA4BnsH,EAAIA,EAAA,IAChCmsH,EAAAA,KAA4BpsH,EAGzC4nH,EAAawE,EAAAA,KAAuB9C,EAAAA,SAAY,GAChD1B,GAAawE,EAAAA,KAAuB9C,EAAAA,SAAY,GAChD1B,GAAawE,EAAAA,KAGbxE,EAAawE,EAAAA,KACbxE,EAAawE,EAAAA,KAEbxE,EAAawE,EAAAA,KAEbxE,EAAawE,EAAAA,KAAuBp7G,EAAAA,QAEvBo7G,EAAAA,KAA4BtgH,EAAIA,EAAA,IAChCsgH,EAAAA,KAA4BnrH,EAAIA,EAAA,IAChCmrH,EAAAA,KAA4BnsH,EAAIA,EAAA,IAChCmsH,EAAAA,KAA4BpsH,EAG3CA,SAAmByI,EAAAA,KAAKy7G,kBG9U5BmI,sBAESlqG,MAAuBlH,EAAAA,KACvBxS,KAAAoW,MAAqBe,GAAAA,MACrBnX,KAAA2T,KACA,EAAAwL,sBACAzF,MAAMvG,MAAS,EACpBnT,GAAAA,KAAKoW,MAAU/S,EACfrD,EAAAA,KAAKoW,MAAU5d,EACfwH,EAAAA,KAAKoW,MAAU5e,EACfwI,EAAAA,KAAKoW,MAAU7e,EACfyI,EAAAA,KAAK2T,KACE3T,EAAAA,YAIE6jH,WACX9G,eAA+C+B,EAC7CxsG,GAAAA,MAAQ8e,CAAAA,GAAIgsF,EAAAA,QAAoBE,GAAAA,mBAAoB,SADPwB,aAE7C9+G,EAAAA,KAAKmoG,OAGPyV,YACExsF,GAAG0yF,EAAAA,aAAa,4BAChB,MAAeC,EAAA,IAAW3yF,GCnC9BzY,EAAA,qPCAA,igBFoCWuiG,EAAAA,aAAa,aAAiB9pF,EAAG8sE,EAAAA,OACjCgd,EAAAA,aAAa,UAAc9pF,EAAG8sE,EAAAA,OAC9Bgd,EAAAA,aAAa,SAAa9pF,EAAG8sE,EAAAA,OAC7B6c,EAAAA,iBAAiB,WAAY/6G,KAAK8+G,aAAa/kG,OAAOzf,MAI/DypH,EAAAC,SAAwB5tG,EAAczC,EACpC5jB,GAAA,MAAYiQ,EAAAA,KAAKm8G,SAASvnH,MACtB8kB,EAAAA,MAAQ1Z,KAAK8+G,aAAahlG,UAAUgsB,QAAQ9rB,MAChDikG,GAAI7nG,EAAAA,MAAUA,EAAM/S,EACpB46G,EAAI7nG,EAAAA,MAAUA,EAAM5d,EACpBylH,EAAI7nG,EAAAA,MAAUA,EAAM5e,EACpBymH,EAAI7nG,EAAAA,MAAUA,EAAM7e,EAAIyI,EAAAA,KAAK8+G,aAAatlH,MAAMssC,QAAQv9B,QACpDoL,EAAAA,KAAc5hB,EAAAA,KAAKuL,IAAI0C,KAAK8+G,aAAahlG,UAAUgsB,QAAQsL,YAAapxC,KAAK8+G,aAAahlG,UAAUgsB,QAAQqL,aAAAA,KAC3G4sE,WAGPkG,GAAA1F,mBAA+CD,EAC7Cp7G,GAAA,IAAYghH,EACZ,MAAK,MAAM9G,KAAiBjB,EAAAA,SACb5qH,EAAAA,KAAmBmoB,EAAAA,MAChCylG,EAAa5tH,EAAAA,KAAmBmoB,EAAAA,MAEhCylG,EAAa5tH,EAAAA,KAAmB6kB,EAAAA,MAAU/S,EAAA,IAC7B9R,EAAAA,KAAmB6kB,EAAAA,MAAU5d,EAAA,IAC7BjH,EAAAA,KAAmB6kB,EAAAA,MAAU5e,EAAA,IAC7BjG,EAAAA,KAAmB6kB,EAAAA,MAEhC+oG,EAAa5tH,EAAAA,KAAmBoiB,EAAAA,YAEnB3T,EAAAA,KAAKy7G,WAGtBgD,YAAuCW,EAAiCV,EACtEttF,GAAGmtE,EAAAA,WAAc4lB,EAAAA,OAAWzF,EAAAA,UG9C9B0F,eAAoBC,QAAAC,UADZD,EAAArkH,KAAAs4G,WAAa,IAUrBV,GAAA57F,SAAoB3b,EAAWmH,EAAeC,EAAgB88G,EAAqCnuG,EAAAA,CAAAA,MAAae,GAAAA,aACzG2/C,SAAa12D,EAAGC,EAAIwS,GAAIzS,EAAIoH,EAAOnH,EAAI6C,GAAA9S,OAAF+c,OAAA,GAAOo3G,IACjDvkH,KAAK82D,SAAa12D,EAAIoH,EAAOnH,EAAIwS,GAAIzS,EAAIoH,EAAOnH,EAAIoH,EAASqC,GAAA1Z,OAAF+c,OAAA,GAAOo3G,IAClEvkH,KAAK82D,SAAa12D,EAAIoH,EAAOnH,EAAIoH,EAASoL,GAAIzS,EAAGC,EAAIoH,EAASqC,GAAA1Z,OAAF+c,OAAA,GAAOo3G,IACnEvkH,KAAK82D,SAAa12D,EAAGC,EAAIoH,EAASoL,GAAIzS,EAAGC,EAAI6C,GAAA9S,OAAF+c,OAAA,GAAOo3G,IASpDztD,SAAwBzvB,EAAaoxE,EAAqCriG,EAAAA,CAAAA,MAAae,GAAAA,aAChFmtG,UAAUE,eAAexF,QAAe33E,EAAKoxE,EAAYriG,EAAAA,OAQhEs7E,UAAyBgnB,EAAuCtiG,EAAAA,CAAAA,MAAae,GAAAA,MAAOxD,KAAM,SACnF2wG,UAAUG,gBAAgBT,SAAgBtL,EAAatiG,EAAAA,MAAoBzC,EAAAA,MAGlF2iF,SAAuBhuF,EACrBtI,QAAKs4G,WAAWJ,MAAMl4G,KAAKskH,UAAiBh8G,EAAAA,UAuE9Co8G,eA5CQC,QAAAx8D,WAAa,IACbwxD,GAAA35G,KAAA64G,OAAS,IAqBV1C,GAAAn2G,KAAAw4G,aAAuB,EAEvBx4G,KAAAugB,WAAqB,EAErBvgB,KAAAs2B,gBAA+B9d,GAAAA,cAmItCxY,KAAA+G,MAAQ,IAAuC/G,GAAAA,MAhH7C,MAAM84G,cAAe8L,EAAA5L,mBAAoB6L,EAAAtkG,UAAWukG,EAAAtM,YAAauM,EAAAzuF,gBAAsB9/B,GACvFwJ,OAAKglH,KAAqB/8G,EAAAA,WAAW,QACnCg9G,CAAAA,UAAW1kG,MAAAA,EAAavgB,EAAAA,KAAKugB,UAC7B2kG,oBAAoB,EACpB9L,MAAOJ,MAAAA,GACPmM,EAAAA,OAAO,EACPC,gBAAiB,0BAEd5M,YAAcA,MAAAA,EAAex4G,EAAAA,KAAKw4G,YACvCx4G,KAAKugB,UAAYA,MAAAA,EAAavgB,EAAAA,KAAKugB,UACnCvgB,KAAKs2B,gBAAkBA,MAAAA,EAAmBt2B,EAAAA,KAAKs2B,gBAC/Ct2B,KAAKqlH,QA5BP98G,0BACcswG,OAAO/yE,QAAQv9B,QAG7BA,YACEvI,QAAK64G,OAAO/yE,QAAQv9B,QAGtBoQ,EAAAnR,wBACcw9G,KAAK1mG,OAAO9W,MAG1BC,yBACcu9G,KAAK1mG,OAAO7W,OAkBlB49G,QACN,MAAWrlH,EAAAA,KAAKglH,UAEXM,OAAgBC,GAAAA,MAASn0F,EAAG9S,EAAAA,OAAO9W,MAAU8W,EAAAA,OAAO7W,OAAW,EAAA,KAAM,KACvEuW,EAAAA,SAAY,EAAGoT,EAAG9S,EAAAA,OAAO9W,MAAU8W,EAAAA,OAAO7W,QAG1C+9G,EAAAA,WAAWxlH,KAAKs2B,gBAAoBjzB,EAAA,IAAKrD,KAAKs2B,gBAAoB99B,EAAA,IAAKwH,KAAKs2B,gBAAoB9+B,EAAA,IAAKwI,KAAKs2B,gBAC7GlF,GAAG9gB,EAAAA,MAASm1G,EAAAA,kBAGTjgH,EAAAA,OAAUkgH,EAAAA,OACVC,EAAAA,UAAaC,EAAAA,UAAcC,EAAAA,qBAE9B7lH,KAAKykH,gBAAkB,IAAkBrzF,GAAMrX,EAAAA,CAAAA,OAAQ/Z,KAAKslH,OAAQxrG,UAAW9Z,KAAKmoD,WAAY3uD,MAAOwG,KAAK64G,cACvG2L,eAAiB,IAAiBpzF,GAAMrX,EAAAA,CAAAA,OAAQ/Z,KAAKslH,OAAQxrG,UAAW9Z,KAAKmoD,WAAY3uD,MAAOwG,KAAK64G,cACrGiN,gBAAkB,IAAkB10F,GAAMrX,EAAAA,CAAAA,OAAQ/Z,KAAKslH,OAAQxrG,UAAW9Z,KAAKmoD,WAAY3uD,MAAOwG,KAAK64G,cAGvGlxG,QAAU,IAAWo+G,GACxBv+G,CAAAA,MAAU8W,EAAAA,OAAO9W,MACjBC,OAAW6W,EAAAA,OAAO7W,cAEf8wG,MAAQv4G,KAAK2H,QAAQgU,IAGrB2E,sBACA6nC,WAAWriB,QAAiBqI,GAAAA,WAG5B9tB,iBACL,MAAWrgB,EAAAA,KAAKglH,UACXM,OAAStlH,KAAKslH,OAAgBC,GAAAA,MAASn0F,EAAG9S,EAAAA,OAAO9W,MAAU8W,EAAAA,OAAO7W,OAAW,EAAA,KAAM,KACxFzH,KAAKykH,gBAAgBtnB,OAAO4d,iBAAiB,WAAY/6G,KAAKslH,OAAOhrH,MACrE0F,KAAKwkH,eAAernB,OAAO4d,iBAAiB,WAAY/6G,KAAKslH,OAAOhrH,MACpE0F,KAAK8lH,gBAAgB3oB,OAAO4d,iBAAiB,WAAY/6G,KAAKslH,OAAOhrH,MAGrE0F,KAAK2H,QAAQH,MAAW8W,EAAAA,OAAO9W,MAC/BxH,KAAK2H,QAAQF,OAAY6W,EAAAA,OAAO7W,OAgBlCgrB,UAEE6b,EACAD,EACAgrE,EACAC,EACA16B,EACAC,EACA06B,EACAC,EAEAhkG,GAAe,GAAA,IAAiB1L,GAAA,IAEVnH,GAAA,IAAiBpL,GAAA,IAEZie,GAAA,IAAVhO,EAAAA,OAAgC,IAAXC,EAAAA,OAItC,OAAKwpB,OAAAA,KASA60F,gBAAgBrD,SAAgBn0E,EAAID,EAAIgrE,EAAQC,EAAS16B,EAAIC,EAAI06B,EAAQC,EAAAA,IARrE3nG,EAAAA,cAAc5K,KAAK,8CAEtBG,QAAQ0K,OAEV1K,QAAQ0K,UAOPglD,SAAwBzvB,EAAajxB,EAAcmX,EAAYzjB,EACpE9J,QAAK8lH,gBAAgB9G,QAAeh6F,EAAOqiB,EAAK9Z,EAG3CzjB,GAAA4vG,cAA2BlyG,EAAeC,EAAgB2O,EAC/DpW,QAAK8lH,gBAAgBtD,aAAoBl6G,EAAKd,EAAOC,EAGhD1X,GAAAqgE,WAAwBjiC,EAAgB/X,EAC7CpW,QAAK8lH,gBAAgBvD,UAAep0F,EAAQ/X,EAKvCrmB,GAAAigC,YACAm4B,WAAWn4B,OAChBhwB,KAAK64G,OAAO7oF,OAGPM,eACA63B,WAAW73B,UAChBtwB,KAAK64G,OAAOvoF,UAGP7W,UAAqBpZ,EAC1BL,QAAKmoD,WAAW1uC,UAAUzZ,KAAKw4G,cAAoBp4G,EAAGJ,EAAAA,KAAKw4G,cAAoBn4G,EAG1E6C,GAAA0R,OACL5U,QAAKmoD,WAAWvzC,OAGX+D,GAAA9E,MAAiBxT,EACtBL,QAAKmoD,WAAWt0C,MAASxT,EAGpB6C,GAAA4W,UACL9Z,QAAKmoD,WAAWriB,QAGlBntB,EAAArI,QACE,MAAWtQ,EAAAA,KAAKglH,KACbQ,EAAAA,WAAWxlH,KAAKs2B,gBAAoBjzB,EAAA,IAAKrD,KAAKs2B,gBAAoB99B,EAAA,IAAKwH,KAAKs2B,gBAAoB9+B,EAAA,IAAKwI,KAAKs2B,gBAG7GlF,GAAG9gB,EAAAA,MAASm1G,EAAAA,kBACQn1G,GAAAA,QAMtB++E,QACE,MAAWrvF,EAAAA,KAAKglH,KACbhnG,EAAAA,SAAY,EAAGoT,EAAG9S,EAAAA,OAAO9W,MAAU8W,EAAAA,OAAO7W,QAE7CzH,KAAK8lH,gBAAgBnO,SACrB33G,KAAKwkH,eAAe7M,SACpB33G,KAAKykH,gBAAgB9M,iBChPvBqO,uUAhDFriH,GAAAA,KAgDEqiH,GAJUC,KAAoBC,GAAA,KAI9BF,GAAAt6G,KAAA,GAAA,OAIAs6G,GAAAA,GAAA7gH,OAAA,GAAA,SAIA6gH,GAAAA,GAAAnnE,IAAA,GAAA,YAsHWxZ,WAoTXm7B,0BACEluD,EAAAA,QAnNMtS,KAAAmmH,aAAuB,EAiBxBnmH,KAAA8+F,eAAkC,GAAA9+F,KAezBomH,OAAmC,QAM3CC,YAA+B,GAAArmH,KAgB/BsmH,qBAA+B,EAehCtmH,KAAAumH,sBAAgC,EAK/BvmH,KAAAwmH,UAAoB,EAIrBxmH,KAAAymH,WAAoB,IAAU9hB,GAAA,IAAK,IAAK,KASxC3kG,KAAA0mH,0BAAoC,EAKpC1mH,KAAA2mH,iBAAoBzjH,IAClB2O,EAAAA,cAAc3K,MAAMhE,IAgBrBlD,KAAA4mH,WAIA,EAAA5mH,KAAA6mH,YAAsB,EAEtB7mH,KAAAqhE,gBAA0B,EAE1BrhE,KAAA8mH,cAAwB,KAgGpBd,EAAA51H,OAAH+c,OAAA/c,OAAA+c,OAAA,GAAe45G,GAAAA,yBAEtB1hH,GAAM2hH,EAAAA,SAGNhnH,KAAK2e,QAAU,IAAkBpmB,GAAAA,OAAQzD,UAGzC,MAAiBmyH,EAAA,IACjBC,GAAA,IAAaC,EAAAA,0CAAAA,KAAiDC,YAAuBhyH,EAAAA,QACnF,CAAA,MAAgBN,EAAAA,SAASE,cAAc,OACvCoT,GAAQi/G,EAAAA,UAAY,6EACpBvyH,SAASoT,KAAKC,YAEdm/G,GAASjtF,EAAAA,YAAYvpB,SAAQ,SAC3By2G,GAAA,MAAoBzyH,EAAAA,SAASE,cAAc,OAC/BqyH,EAAAA,UAAY,2BACxBvyH,EAAAA,SAASoT,KAAKC,YAAYq/G,MAGhBC,EAAAA,gBACV,CAAA,MAAe3yH,EAAAA,SAASgiC,eAAuB2wF,EAAAA,iBAE7CnpG,GAAOmB,EAAAA,cAAc8Y,YAIzBmvF,eAEKN,aAAc,EAKjBhgH,QAAQN,MAAgB6gH,EAAAA,6BAE1BvgH,QAAQN,IACN,+BAA+B8gH,MAC/B,8GAGFxgH,QAAQN,IAAI,sEAKZM,QAAQN,IAAI,QAAS,yBAA0B,yBAIrCyvB,EAAAA,qBACVv2B,KAAKsmH,qBAAsB,GAG7BtmH,KAAKwd,QAAiB3L,EAAAA,cAGlB7R,KAAKwd,QAAQpX,eAA0BN,EAAAA,OAChC21B,EAAAA,qBAGXz7B,KAAKwd,QAAQzW,MAAM,sBAEnB/G,KAAKynH,gBAA0BA,EAAAA,gBAEnBA,EAAAA,iBACVznH,KAAKwd,QAAQzW,MAAM,mCAA6C0gH,EAAAA,iBAChEznH,KAAKse,OAA4BxpB,SAASgiC,eAAuB2wF,EAAAA,kBAChD3O,EAAAA,eACjB94G,KAAKwd,QAAQzW,MAAM,kCAA2C+xG,EAAAA,eAC9D94G,KAAKse,OAAiBw6F,EAAAA,gBAEtB94G,KAAKwd,QAAQzW,MAAM,kCACnB/G,KAAKse,OAA4BxpB,SAASE,cAAc,WAG1D,IAAqC6yH,EAAA,QAAnBrxH,EAAQ6nB,EAAAA,mBAAAA,IAAWypG,EAAI5yG,EAAY+G,EAAAA,MAChDzlB,GAAQgR,EAAAA,OAAiBC,EAAAA,QAAmBuW,EAAAA,eAAAA,IACnCK,EAAAA,cACInJ,EAAY+G,EAAAA,OAE5Bjc,KAAKwd,QAAQzW,MAAM,2BAAqCS,EAAAA,MAAQ,MAAgBC,EAAAA,SAC9D4W,EAAAA,cAClBre,KAAKwd,QAAQzW,MAAM,0BACLmO,EAAYiH,EAAAA,WAGlBvK,EAAAA,UAAiBzM,EAAAA,QACzB,CAAA,MAAgB4iH,EAAA,IAAqCpP,GACnDG,CAAAA,cAAe94G,KAAKse,OACpB06F,mBAAoBh5G,KAAK0mH,yBACzBnmG,UAAmB9B,EAAAA,aACnB6X,gBAAyBA,EAAAA,gBACzBkiF,YAAqBA,EAAAA,mBAElB5pB,gBACL5uF,EAAAA,KAAK2b,IAAc48F,EAAAA,UAEnB,CAAA,MAAmBwP,EAAA,IAAkCrD,GACnD5L,CAAAA,cAAe94G,KAAKse,OACpB06F,mBAAoBh5G,KAAK0mH,yBACzBnmG,UAAmB9B,EAAAA,aACnB6X,gBAAyBA,EAAAA,gBACzBkiF,YAAqBA,EAAAA,mBAElB5pB,gBACL5uF,EAAAA,KAAK2b,IAAiB48F,EAAAA,WAGnB7hG,OAAS,IAAWsxG,GACvB1pG,CAAAA,OAAQte,KAAKse,OACbC,QAASve,KAAK4uF,gBACdnwE,aAAkC,QAApBjoB,EAAQioB,EAAAA,oBAAAA,IAAYwpG,GAClCtpG,EAAAA,QAAS3e,KAAK2e,QACdX,SAA0B,QAAhBxnB,EAAQwnB,EAAAA,gBAAAA,IAAQkqG,EAAK1xH,EAAQgR,EAAAA,OAAiBC,EAAAA,OAAWD,CAAAA,MAAeA,EAAAA,MAAOC,OAAgBA,EAAAA,QAAsBgV,GAAAA,KAC/HwB,WAAoBA,EAAAA,WACpBI,YACAtW,EAAAA,SAAkBA,EAAAA,SAClB8W,WAAoBspG,EAAAA,qBAA2B,EAAA,YAG5CzxG,OAAOmH,6BAEAyY,EAAAA,kBACVt2B,KAAKs2B,gBAA0BA,EAAAA,gBAAgBthB,SAAAA,KAG5C0xG,yBAAmCA,EAAAA,yBAExC1mH,KAAKooH,QAAU,IACfpoH,GAAAA,KAAK+G,MAAQ,IAAU/G,GAAAA,MAAAA,KAElB62C,YAEL72C,GAAAA,KAAKqoH,UAAYroH,KAAKw/D,aAAe,IAErCx/D,GAAAA,KAAKsoH,SAAS,OAAQtoH,KAAKqoH,WA/Z7B5lG,8BACc/L,OAAO+L,YAMrBC,kCACchM,OAAOgM,gBAOrBC,+BACcjM,OAAOiM,aAMrBC,mCACclM,OAAOkM,iBAMrBrB,4BACc7K,OAAO6K,UAMrBE,gCACc/K,OAAO+K,cAMrBD,6BACc9K,OAAO8K,WAMrBE,iCACchL,OAAOgL,eAMrBlC,0BACc9I,OAAO8I,QAkBrBwK,wBACcjjB,MAAMijB,MAgCpBu+F,+BACc7xG,OAAO+J,aAMrBpC,8BACc3H,OAAO2H,YAOrBQ,6BACcnI,OAAOmI,WAgBrB8wE,0BACc62B,SAuDJl6F,GAAmB5B,EAC3BpY,GAAAA,MAASga,GAAW5B,EAefxnB,GAAAwpB,KAAwBhC,EAC7BpY,GAAAA,MAAMoa,KAAgBhC,EAejBxnB,GAAAkc,IAAuBsL,EAC5BpY,GAAAA,MAAM8M,IAAesL,EAgMhBxnB,GAAAsf,6BACO9L,OAAO8L,iBAMrBgmG,4BACc5B,WAOd4B,cACMp3H,GAASunB,GACXzS,EAAO2L,EAAAA,cAAcne,MAAM,+DAI7BsM,KAAK4mH,WAgBAjuG,EAAAiuB,cAAoCxmC,EAAWC,EACpDL,QAAKqmH,YAAYrzH,KAAK,IAAkBo6F,GAAWhtF,EAAGC,EAAAA,IAOjDw6F,WACL76F,QAAKw/D,aAAaq7B,WAMbliF,GAAAmiF,cACL96F,QAAKw/D,aAAas7B,cAObniF,GAAA+hF,SACL/hF,eAAY6mD,aAAak7B,SAOpB/hF,GAAA2hF,YACL3hF,eAAY6mD,aAAa86B,YAUpB3hF,GAAA2vG,SAAsBlhD,EACvBpnE,QAAKomH,OAAO3yH,IACduM,KAAKwd,QAAQvW,KAAK,QAAc0R,EAAA,8BAElC3Y,KAAKomH,OAAch/C,GAgBdlkE,EAAAulH,YACL9vG,GAAI4hD,GAAAA,aAEF2qB,GAAA,IAAK,MAAMzxF,KAAAA,KAAY2yH,OACjBpmH,KAAKomH,OAAO1tH,eAAejF,IACzBuM,KAAKomH,OAAO3yH,KAAS8mE,UAAAA,KACX6rD,OAMEsC,oBAAXnuD,UAAAA,KAEG6rD,OAuCTztG,GAAA5E,IACoB4E,GAAA,IAArBplB,UAAUjC,OAIV0O,KAAK8mH,eAAiB9mH,KAAKomH,OAAOpmH,KAAK8mH,eACzC9mH,KAAKomH,OAAOpmH,KAAK8mH,eAAe/yG,IAEhC/T,GAAAA,KAAKw/D,aAAazrD,IANlB/T,GAAAA,KAAKsoH,SAAiB/0H,UAAqBA,GAAAA,UAAU,IA0ClDmd,OACD6pD,GAAAA,aAAkBgG,IACpBvgE,KAAKw/D,aAAa9uD,OAGhB6pD,GAAAA,aAAkBi/B,IACpBx5F,KAAKyoH,YAGe9vG,GAAA,iBACpB3Y,GAAAA,KAAKyoH,YASF9vG,GAAAgwG,UAELhwG,GAAK3Y,GAMcA,KANTwjE,cAKNxjE,GACeA,KADVomH,OAAaztG,GACpB,CAAA,MAAiB3Y,EAAAA,KAAKw/D,aACLx/D,EAAAA,KAAKomH,OAEtBpmH,QAAKwd,QAAQzW,MAAM,kBAGf/G,GAAAA,KAAKw/D,aAAagE,gBACpBxjE,KAAKw/D,aAAa46B,YAAY1iG,MAAMsI,KAAKw/D,aAAe9zC,CAAUE,EAAAA,SAC7D4zC,aAAa1yC,gBAAgBT,KAAK,aAAc,IAAoBT,GAAU5rB,EAAAA,KAAKw/D,gBAAAA,KAIrFA,aACLx/D,EAAAA,KAAK0W,OAAOqJ,iBAA0BC,EAAAA,QAGtChgB,KAAKw/D,aAAa3oB,YAAY72C,MAAAA,KAEzBw/D,aAAa26B,UAAUziG,MAAMsI,KAAKw/D,aAAe9zC,CAAUE,EAAAA,SAC3D4zC,aAAa1yC,gBAAgBT,KAAK,WAAY,IAAkBX,GAAU1rB,EAAAA,KAAKw/D,oBAAAA,KAE/EhiD,QAAQ9pB,MAAM,QAAcilB,EAAA,6BA1B5BmuG,cAkCFnuG,EAAA2I,yBACL3I,eAAYjC,OAAO4K,yBAOd3I,GAAAoJ,yBACLpJ,eAAYjC,OAAOqL,yBAMbpJ,GAAAk+B,YAgBNl+B,GAAA,IAAgCiwG,EAfhC5oH,OAAKmvG,yBAAmC0Z,EAAAA,qBAGxC7oH,KAAK9D,MACH4sH,CAAAA,SAAU,IACV9oD,GAAAA,SAAU,IAAmBhgE,GAAAA,MAC7B6yG,SAAU,IAAIkW,SAEX7sH,MAAM4sH,SAAS3gB,OACpBnoG,KAAK9D,MAAM8jE,SAASmoC,KAAgB3xG,GAAQwyH,EAAAA,eAAiB9f,GAAAD,SAA8Bn0G,SAAWkL,KAAKse,QAC3Gte,KAAK9D,MAAM22G,SAAS1K,YAAAA,IAMTrzG,SAASm0H,QAETP,EAAA,SACUQ,EAAA,oBACV,aAAcp0H,UACM4zH,EAAA,WACVQ,EAAA,sBACV,iBAAkBp0H,WACE4zH,EAAA,eACVQ,EAAA,0BAGrBlpH,KAAK2e,QAAQ7pB,SAAY8zH,GAAkBM,GAAA,KACrCp0H,SAASm0H,IACXjpH,KAAK8sB,gBAAgBT,KAAK,SAAU,IAAgBrsB,GAAAA,OAAAA,KAC/Cwd,QAAQzW,MAAM,mBAAA/G,KAEd8sB,gBAAgBT,KAAK,UAAW,IAAiBrsB,GAAAA,OAAAA,KACjDwd,QAAQzW,MAAM,sBAIlB/G,KAAKynH,iBAA4B3O,EAAAA,eACpChkH,SAASoT,KAAKC,YAAYnI,KAAKse,QAI5BmlD,aAAa3rC,IAUb2B,gBACLz5B,QAAK0W,OAAO+H,aAMP9F,EAAA6gB,8BACO9iB,OAAO+H,aAMrB+kD,gCACcnC,eAGN8nD,oBACDnpH,QAAKwjE,gBACRxjE,KAAKyjE,aACLnxD,GAAAA,MAAM+Z,KAAK,aAAc,IAAoB1C,GAAQ3pB,EAAAA,OAAAA,KAChDqhE,gBAAiB,EAClBrhE,KAAK8mH,cACP9mH,KAAK2oH,UAAU3oH,KAAK8mH,eAEpB9mH,KAAK2oH,UAAU,SASbS,QACNzwG,GAAI3Y,GAEFA,KAFO6mH,WAOP,OAAA7mH,KALKooH,QAAQ5vF,OAAOx4B,KAEpBA,GAAAA,KAAK9D,MAAM4sH,SAAStwF,SACpBx4B,KAAK9D,MAAM8jE,SAASxnC,cAAAA,KACft8B,MAAM22G,SAASr6E,cAGjB2wF,oBAAoBnpH,MAAAA,KAEpB0jE,WAGL1jE,GAAAA,KAAKw/D,aAAahnC,OAAOx4B,KAIzBA,GAAAA,KAAKqmH,YAAcrmH,KAAKqmH,YAAY7mF,QAAO,SACzC6pF,UAAUj8B,EAAAA,UAAU1nD,YAItB1lC,KAAK9D,MAAM4sH,SAAStwF,SACpBx4B,KAAK9D,MAAM8jE,SAASxnC,SACpBx4B,KAAK9D,MAAM22G,SAASr6E,SAGpBx4B,KAAK4jE,YAMAjrD,GAAA+qD,WACL1jE,QAAKqsB,KAAK,YAAa,IAAmBrsB,GAAAA,KAAaA,EAAAA,OAAAA,KAClD2jE,YAAY3jE,KAGZ2Y,GAAAgrD,YAA6BlrC,EAAAA,IAO7BmrC,YACL5jE,QAAKqsB,KAAK,aAAc,IAAoBrsB,GAAAA,KAAaA,EAAAA,OAAAA,KACpD6jE,aAAa7jE,KAGb2Y,GAAAkrD,aAA8BprC,EAAAA,IAQ7B6wF,MACN3wG,GAAA,MAAY3Y,EAAAA,KAAK2b,IACjB3b,GAGEA,KAHG4qE,SAActhD,EAEftpB,GAAAA,KAAK6mH,WAIP,OAAA7mH,KAHKooH,QAAQ9pG,OAAOxC,KAAK9b,KAAK4uF,gBAAoB,EAAA,QAAA5uF,KAC7C4uF,gBAAgBS,aAMlBT,gBAAgBt4D,gBAAkBt2B,KAAKs2B,gBAE5Ct2B,KAAKw/D,aAAa1jD,KAAK9b,KAAK2b,IAG5BhD,GAAA,IAAQuwG,EACR,EAAA,MAAYlpH,EAAAA,KAAKqmH,YAAY/0H,YACjBuV,EAAKtP,EAAAA,IACfyI,KAAKqmH,YAAej5B,GAAAA,UAAUtxE,KAAU9b,EAAAA,KAAKqmH,YAAejmH,GAAGJ,EAAAA,KAAKqmH,YAAehmH,GAKrFA,GAAIL,GAGWA,KAHN2vF,QACP3vF,MAAK2b,IAAI4tG,KAAO,WAChBvpH,KAAK2b,IAAInT,UAAYxI,KAAKymH,WAAWxzH,WACrC,MAAa+M,EAAAA,KAAK9D,MAAM4sH,SAASrgB,cAC5B,IAAQ+gB,EAAGh3H,EAAInC,EAAKiB,EAAAA,OAAQkB,IAC/BwN,KAAK2b,IAAIjT,SAAclW,EAAGS,GAAAA,WAAa,OAAoB5C,GAAKmC,EAAAA,IAAiBnC,GAAKmC,EAAAA,IAAM,cAAe,IAAUA,GAAIg3H,EAAA,SAGtH7tG,IAAIjT,SAAS,OAAS1I,KAAKgqB,MAAM0gD,UAAUo1B,IAAIr3F,QAAWxV,GAAAA,WAAgB,GAAA,QAI5E,IAAQw2H,EAAG15H,EAAIiQ,EAAAA,KAAK8+F,eAAextG,OAAQvB,IAC9CiQ,KAAK8+F,eAAkBtpG,GAAAA,QAAQwK,KAAK2b,IAAI+lB,aAAgB,EAAG1hC,EAAAA,KAAKyiB,YAAaziB,KAAK2iB,cAAe3iB,KAAK2b,UAGnGkvD,UAAevhD,EAMf3Q,GAAAiyD,SAAyCthD,EAC9CtpB,QAAKqsB,KAAK,UAAW,IAAiBrkB,GAAMshB,EAAOtpB,EAAAA,OAAAA,KAC9C6lE,UAAgBv8C,EAGhBpmB,GAAA2iE,UAA0CptC,EAAAA,IAO1CoyC,UAA0CvhD,EAC/CtpB,QAAKqsB,KAAK,WAAY,IAAkBrkB,GAAMshB,EAAOtpB,EAAAA,OAAAA,KAChD8lE,WAAiBx8C,EAGjBpmB,GAAA4iE,WAA2CrtC,EAAAA,IAQ3C3J,UACL9uB,QAAKwmH,SAMA7tG,EAAA+wG,0BACAlD,UAAYxmH,KAAKwmH,SACfxmH,KAAKwmH,SASPxhG,MACLrM,GAAA,IACSjU,KADC0iH,YACR,OAAO1iH,QAAQE,OAAO,+CAMxB,IA2BA+kH,cA/BKjzG,OAAOwJ,4BACZlgB,KAAK0W,OAAOuH,WAAaje,KAAK0W,OAAOsH,SACrChe,KAAK0W,OAAOmH,6BACZ7d,KAAK4uF,gBAAgBvuE,iBAGnBrgB,GAAAA,KAAKooH,QACLpoH,EAAAA,KAAKooH,QAAQ7xF,mBAAqBv2B,KAAKsmH,qBAAuBtmH,KAAKooH,QAAQ7xF,mBAC3Ev2B,KAAKooH,QAAQvwF,WAAW73B,MACNA,EAAAA,KAAKg1B,KAAKh1B,KAAKooH,UAEf1jH,EAAAA,QAAQC,UAGZ6f,EAAAA,MAAK,UACd9N,OAAOyJ,2BACZngB,KAAK0W,OAAOmH,6BACZ7d,KAAK4uF,gBAAgBvuE,iBACrBrgB,KAAKqsB,KAAK,QAAS,IAAmBrsB,GAAAA,UAGnCA,KAAKmmH,cACRnmH,KAAKmmH,aAAc,EACnBnmH,KAAKwd,QAAQzW,MAAM,oBACnB/G,KAAK2e,QAAQ4F,SACNqlG,GAAAA,eAAe5pH,KAAMzH,OAAOsL,sBAAuB+F,KAAKC,IAAxD+/G,GAAPvkF,KAEK7nB,QAAQzW,MAAM,iBAOhB4iH,wBAAoCE,EAAiCC,EAC1E/5H,GAAA,IAAe+5H,EAAAA,oBAECC,IACTC,GAAK7D,EAAAA,YAGV,IACO8D,EAAAA,WAAiBF,EACtBC,GAAK39F,EAAAA,KAAK,WAAY,IAAkB29F,GAAMA,EAAKhgG,EAAAA,MAAMi1E,YAGzD,MAAY6qB,EAAAA,IACZ,IAAc/3H,EAAAA,KAAKD,MAAYo4H,EAAAA,IAK3BroC,EAAUsoC,EAAA,MACFA,EAEZ,GAAA,MAActoC,EAAUmoC,EAAKxB,EAAAA,UAGbwB,EAAKhgG,EAAAA,MAAMi1E,UAAe7gG,GAC1C4rH,EAAKhgG,EAAAA,MAAM0gD,UAAU3oC,QAChB/X,EAAAA,MAAM0gD,UAAe0/C,GAC1BJ,EAAKhgG,EAAAA,MAAM0gD,UAAUphD,MACrB0gG,EAAKhgG,EAAAA,MAAM0gD,UAAUo1B,IAAax2E,GAAQ+gG,EAAA,KAE1C,MAAqBP,EAAAA,IAChBV,EAAAA,QACLiB,GAAA,MAAoBP,EAAAA,IACfR,EAAAA,MACLe,GAAA,MAAkBP,EAAAA,IAEb9/F,EAAAA,MAAM0gD,UAAUpjC,SAAS9O,OAAuB8xF,EACrDN,EAAKhgG,EAAAA,MAAM0gD,UAAUpjC,SAASxrB,KAAmByuG,EAEjDL,EAAWrgH,EAEXmgH,EAAK39F,EAAAA,KAAK,YAAa,IAAmB29F,GAAMA,EAAKhgG,EAAAA,MAAM0gD,YACtD1gD,EAAAA,MAAMi1E,UAAUl9D,MAAW/X,EAAAA,MAAM0gD,WACtC,MACAnyE,GAAAA,OAAO2L,qBAA0B+lH,EAAAA,YAC5BlhF,EAAAA,OACA49E,EAAAA,iBAAiBzjH,KAQrB6lC,YACIo9E,cACPnmH,KAAKqsB,KAAK,OAAQ,IAAkBrsB,GAAAA,OAAAA,KAC/B2e,QAAQguD,QACb3sE,KAAKmmH,aAAc,EACnBnmH,KAAKwd,QAAQzW,MAAM,iBAOhByjH,uBACQrE,YAORsE,aACL,MAAeC,EAAA,IAAIvzF,MACPn3B,EAAAA,KAAKse,OAAOyc,UAAU,oBAC3B3D,EAAAA,IACArkC,EASF23H,EAAA11F,KAkBLrc,UAjBiB,IAAIjU,SAAeC,SAC7BkiH,YAAa,EAEX7xF,EAAAA,OAAOxQ,MAAK,UACR8hG,oBACPh1G,YAAW,UACJu1G,YAAa,EAClBliH,MAEC,MAEH3E,KAAK6mH,YAAa,EAClBliH,YA9zBOoiH,GAAAA,wBACbv/G,CAAAA,MACAC,EAAAA,OACAi/G,EAAAA,0BAA0B,EAC1Be,gBAAiB,GACjB3O,mBAAAA,EACAN,aAAa,EACbwQ,aAAc9f,GAAA/jG,OACdwiH,2BAA4B,KAC5BR,uCAAwC,KACxCgB,qBAAsB,KACtB5xF,mBAAoB,KACpBsyF,qBAA2C1jH,GAAAA,OAC3CmxB,gBAAuBlf,GAAAA,QAAQ,YAkNjCuzG,GADC34G,CAAW5J,EAAAA,CAAAA,QAAS,uCAAwC6J,gBAAiB,2DA8mBhF,IAAA24G,GAAA,kBACkDxqH,EAAkBC,EAA/CwqH,QAAAz9B,UAA6B09B,EAAA9qH,KAAAI,EAAkB2qH,EAAA/qH,KAAAK,EAAAA,IADjDuqH,GAAAD,GADlB34G,CAAW5J,EAAAA,CAAAA,QAAS,0CACf4iH,UCpwCOC,WA0BXrjB,eAA4C1pD,EAAgBgtE,EAAA,cAC1D54G,QADiBtS,KAAAhM,OAAyBm3H,EAAAnrH,KAAAk+C,MAtB5CgtE,EAAApiG,YAAmBsiG,IAMnBtiG,uBAMAuiG,mBACS,KAKTA,UAAoBC,IAWbviG,mBAQA4yD,UAQAiwB,aAMA2f,QAAQ3iF,WAOJ4iF,WACXC,eAAkC3mE,EAChCxyC,GAAAA,MAAco5G,EAAA,oBADkB1rH,KAAA8kD,MAK7B6mE,SAAMC,WAGXH,eAAmCI,EACjCv5G,GAAAA,MAAcw5G,EAAA,6BADmB9rH,KAAA6rH,eAGjC7rH,EAAAA,KAAK1F,KAAO0F,KAAK6rH,sBCvERE,WACX1lD,eAAmD2lD,EAAA,8BACjD15G,EAAAA,MAiDK05G,GAAAhsH,KAAAisH,QAEA,EAAAjsH,KAAAksH,OAAiB,aACjBlsH,KAAA8H,MAA6B4nE,GAAAA,OAC7B1vE,KAAAmsH,MAAgB,EAChBnsH,KAAAosH,KAA0Br9C,GAC1BA,GAAA/uE,KAAAy0E,UAAiC3oE,GAAAA,KACjC9L,KAAA20E,UAAiCpF,GAAAA,WACjCvvE,KAAAmM,UAAiC2jE,GAAAA,YACjC9vE,KAAA2T,KACA,GAAA3T,KAAA22G,OAA4D,KAQ3D32G,KAAAqsH,YAA2B,IAC3BzjE,GAAA5oD,KAAAssH,WACA,EAAAtsH,KAAAusH,YApENvsH,EAAAA,KAAKksH,OAAwB,QAAf11H,EAAAA,MAAAA,OAAAA,EAAS01H,EAAAA,cAAAA,IAAMM,EAAIxsH,EAAAA,KAAKksH,OACtClsH,KAAK8H,MAAsB,QAAdtR,EAAAA,MAAAA,OAAAA,EAASsR,EAAAA,aAAAA,IAAK2kH,EAAIzsH,EAAAA,KAAK8H,MACpC9H,KAAKmsH,KAAoB,QAAb31H,EAAAA,MAAAA,OAAAA,EAAS21H,EAAAA,YAAAA,IAAIO,EAAI1sH,EAAAA,KAAKmsH,KAClCnsH,KAAK2T,KAAoB,QAAbnd,EAAAA,MAAAA,OAAAA,EAASmd,EAAAA,YAAAA,IAAIg5G,EAAI3sH,EAAAA,KAAK2T,KAClC3T,KAAKosH,KAAoB,QAAb51H,EAAAA,MAAAA,OAAAA,EAAS41H,EAAAA,YAAAA,IAAIQ,EAAI5sH,EAAAA,KAAKosH,KAClCpsH,KAAKy0E,UAA8B,QAAlBj+E,EAAAA,MAAAA,OAAAA,EAASi+E,EAAAA,iBAAAA,IAAS01C,EAAInqH,EAAAA,KAAKy0E,UAC5Cz0E,KAAK20E,UAA8B,QAAlBn+E,EAAAA,MAAAA,OAAAA,EAASm+E,EAAAA,iBAAAA,IAAS01C,EAAIrqH,EAAAA,KAAK20E,UAC5C30E,KAAKmM,UAA8B,QAAlB3V,EAAAA,MAAAA,OAAAA,EAAS2V,EAAAA,iBAAAA,IAAS62G,EAAIhjH,EAAAA,KAAKmM,UAC5CnM,KAAKisH,QAA0B,QAAhBz1H,EAAAA,MAAAA,OAAAA,EAASy1H,EAAAA,eAAAA,IAAOva,EAAI1xG,EAAAA,KAAKisH,SACpCz1H,MAAAA,OAAAA,EAASmgH,EAAAA,UAAAA,KACNA,OAAS,QACTA,OAAOkW,KAA0B,QAAnBr2H,EAAQmgH,EAAAA,OAAOkW,YAAAA,IAAI1M,EAAIngH,EAAAA,KAAK22G,OAAOkW,KACtD7sH,KAAK22G,OAAO92E,OAA8B,QAArBrpC,EAAQmgH,EAAAA,OAAO92E,cAAAA,IAAMz0B,EAAIpL,EAAAA,KAAK22G,OAAO92E,OAC1D7/B,KAAK22G,OAAOvgG,MAA4B,QAApB5f,EAAQmgH,EAAAA,OAAOvgG,aAAAA,IAAKu/E,EAAI31F,EAAAA,KAAK22G,OAAOvgG,OAE1DpW,KAAKgzB,YAGAhe,eACE,IAAS83G,GAAA18H,OAAD+c,OAAA/c,OAAA+c,OAAA/c,OAAA+c,OAAA,QACLuiB,uBAAAA,KACAwE,sBAAAA,CACRvgB,KAAM3T,KAAK2T,KACXy4G,KAAMpsH,KAAKosH,KACXF,OAAQlsH,KAAKksH,OACbpkH,MAAO9H,KAAK8H,MACZqkH,KAAMnsH,KAAKmsH,KACX13C,UAAWz0E,KAAKy0E,UAChBE,UAAW30E,KAAK20E,UAChBxoE,UAAWnM,KAAKmM,UAChBwqG,OAAQ32G,KAAK22G,OAETkW,CAAAA,KAAM7sH,KAAK22G,OAAOkW,KAClBhtF,OAAQ7/B,KAAK22G,OAAO92E,OACpBzpB,MAAOpW,KAAK22G,OAAOvgG,OAEnB,QAwBR22G,+BACiBjlH,SAAS9H,KAAKmsH,KAAO,OAAS,MAAMnsH,KAAK2T,OAAO3T,KAAKosH,QAAQpsH,KAAKksH,SASnF1kH,wBACc8kH,WAGd9kH,UACExH,QAAKssH,WAGP3zG,EAAAlR,mBACEulH,EAAA,MAAoCC,EAAA,QAARD,EAAA,QAAXhtH,EAAAA,KAAKktH,cAAAA,IAAMC,OAAA,EAAE77H,EAAAA,cAAAA,IAAM07H,EAAIA,EACxC,cAAYT,YAGdU,EAAAxlH,oBACEwlH,EAAA,MAAoCG,EAAA,QAARH,EAAA,QAAXjtH,EAAAA,KAAKktH,cAAAA,IAAMG,OAAA,EAAE/7H,EAAAA,cAAAA,IAAM27H,EAAIA,EACxCjtH,OAAKusH,YAAsBe,EAG7BF,EAAAG,+BACc35F,QAAQpsB,MAGtBgmH,gCACc55F,QAAQnsB,OAGtBgmH,8BACS17H,KAAKD,MAAMkO,KAAK4zB,QAAQpsB,MAGjC,GAAAkmH,+BACS37H,KAAKD,MAAMkO,KAAK4zB,QAAQnsB,OAGjC,GAAAkoB,8BACc08F,YAGJv8F,WAAyC1vB,EAAWC,EACxDL,QAAKm0B,OACPn0B,KAAK60B,YAGJpC,EAAAA,UACDzyB,KAAK4zB,QAEL,EACA5zB,EAAAA,KAAKutH,aACLvtH,KAAKwtH,cACDxtH,EAAAA,KAAKutH,aAAevtH,KAAKisH,QAC7B5rH,EAAIL,EAAAA,KAAKwtH,cAAgBxtH,KAAKisH,QAC9BjsH,EAAAA,KAAKutH,aAAevtH,KAAKisH,QACzBjsH,KAAKwtH,cAAgBxtH,KAAKisH,SAIpBh8F,eAER09F,EAAA,MAA0BC,EAAA,QAAX5tH,EAAAA,KAAKiuB,cAAAA,IAAM0/F,EAAI3tH,EAAAA,KAAKqsH,YAAY7yG,OAC5CC,EAAAA,UAAiBrZ,EAAG6tB,EAAO5tB,EAC9B0b,GAAGnH,EAAAA,OAAO5U,KAAKivB,UACZxV,EAAAA,WAAkBrZ,EAAI6tB,GAAO5tB,EAGxBA,GAAA6vB,MACJlwB,QAAK+uB,iBACJtV,EAAAA,UAAUzZ,KAAKqsH,YAAY7kH,MAAQxH,KAAK6T,MAASzT,EACpD2b,GAAGlI,EAAAA,OAAU,EAAA,IAGX7T,KAAKgvB,eACJvV,EAAAA,UAAczZ,GAAAA,KAAKqsH,YAAY5kH,OAAazH,EAAAA,KAAK6T,MACpDkI,GAAGlI,EAAAA,MAAU,GAAA,IAIV4jG,WACDz3G,QAAK02G,QAAUtiC,IACjBp0E,KAAK02G,MACL12G,EAAAA,KAAKktH,OAASltH,KAAK02G,MAAM9gH,MAAM,MAC/BoK,KAAK8tF,oBACL9tF,KAAKgzB,aAID86D,oBACF9tF,GAEmBA,KAFd02G,MACP12G,MAAK6tH,WAAW7tH,KAAKgI,MACrB,MAAqBhI,EAAAA,KAAKktH,OAAO1uE,QAAQjnD,CAAGC,EAAAA,IACjClG,EAAAA,OAAWA,EAAAA,OAAakG,EAE7Bs2H,IAAU9tH,EAAAA,KAAKgI,KAAK+lH,YAC1B/tH,QAAKssH,WAAav6H,KAAKwhB,IAAYy6G,EAAAA,uBAAyBj8H,KAAKwhB,IAAY06G,EAAAA,wBAC7EjuH,KAAKusH,YAAcx6H,KAAKwhB,IAAY26G,EAAAA,yBAA2Bn8H,KAAKwhB,IAAY46G,EAAAA,0BAGhF,MAA2BnuH,EAAAA,KAAKusH,YAAcvsH,KAAKktH,OAAO57H,YAKrDsiC,QAAQpsB,MAASxH,GAAAA,KAAKssH,WAAatsH,EAAAA,KAAK0zB,SAAmB1zB,KAAKisH,QACrEjsH,KAAK4zB,QAAQnsB,OAAU2mH,GAAoCR,EAAf5tH,EAAAA,KAAK0zB,SAAmB1zB,KAAKisH,QAGzE,MAAUmB,EACJ/sH,EAAIguH,EACJC,EAAeF,EAAqBr8H,EAAAA,KAAKwhB,IAAY26G,EAAAA,8BACtD7B,YAAc,IACjB55H,GAAAA,CAAAA,KAAUV,EAAAA,KAAKwhB,IAAYy6G,EAAAA,uBAAyBhuH,KAAK0zB,QACzD3a,IAAShnB,EAAAA,KAAKwhB,IAAY26G,EAAAA,yBAA2BluH,KAAK0zB,QAC1D1a,OAAYs1G,EAAetuH,EAAAA,KAAK0zB,QAChChhC,MAAWX,EAAAA,KAAKwhB,IAAY06G,EAAAA,wBAA0BjuH,KAAK0zB,WAKvD7D,SAAuCzvB,EAAWC,EACtDL,QAAKm0B,OACPn0B,KAAK8tF,oBAEPx7E,MAAMud,SAAazvB,EAAGC,EAGdtQ,GAAAggC,UACJ/vB,QAAK8uB,WAEJ/nB,EAAAA,MAAMiV,UAAUhc,KAAKytH,kBAAmBztH,KAAK0tH,kBAAmB1tH,KAAKutH,aAAcvtH,KAAKwtH,eAE1Fl9F,EAAAA,UAGGu9F,WACNlyG,GAAIlC,EAAAA,UAAUzZ,KAAK0zB,QAAU1zB,KAAKytH,iBAAkBztH,KAAK0zB,QAAU1zB,KAAK0tH,mBACpE75G,EAAAA,MAAM7T,KAAKisH,QAASjsH,KAAKisH,SACzBx3C,EAAAA,UAAYz0E,KAAKy0E,UACjB85C,EAAAA,aAAevuH,KAAK20E,UACpB40C,EAAAA,KAAOvpH,KAAK+sH,WACZ5gH,EAAAA,UAAYnM,KAAKmM,UAEjBnM,KAAK22G,SACH1iC,EAAAA,YAAcj0E,KAAK22G,OAAOvgG,MAAMnjB,WAChCu7H,EAAAA,WAAaxuH,KAAK22G,OAAOkW,KACzB4B,EAAAA,cAAgBzuH,KAAK22G,OAAO92E,OAChClkB,EAAI+yG,EAAAA,cAAgB1uH,KAAK22G,OAAO92E,OAIpCx/B,GAAA00B,QACEpc,GAAI3Y,GAKiBA,KALZ02G,MAEP12G,MAAK80B,uBACL90B,GAAAA,KAAK6tH,WAELl1G,GAAA,MAAmB3Y,EAAAA,KAAKusH,gBACnB,IAAQoC,EAAG5+H,EAAIiQ,EAAAA,KAAKktH,OAAO57H,OAAQvB,IACtC,CAAA,MAAaiQ,EAAAA,KAAKktH,OACdltH,QAAKoW,OACH1N,EAAAA,SAAe0kH,EAAGr9H,EAAIymG,EAGxBx2F,GAAAA,KAAKqzB,aACHu7F,EAAAA,WAAiBxB,EAAGr9H,EAAIymG,EAI5Bx2F,QAAK8uB,YAGFnT,GAAKvG,EAAMuC,GAAAA,KAAM3X,KAAKytH,iBAAqBztH,EAAAA,KAAKytH,iBAAqB,EAG1EvgG,GAAKvR,GAAKvG,EAAMuC,GAAAA,IAAS3X,GAAAA,KAAK0tH,kBAAsB1tH,EAAAA,KAAK0tH,kBAAmB,KAK3E/V,OAAqCvjC,EAAch0E,EAAWC,EACnEL,QAAKy3G,WACLz3G,GAAAA,KAAK8b,KAAS1b,EAAGC,EAAAA,UCtPRwuH,WACX/9F,wBACExe,EAAAA,MAeMw8G,GAAA9uH,KAAA02G,MAAgB,GAAA12G,KAbjBupH,KAAmB,QAAZ/yH,EAAQ+yH,EAAAA,YAAAA,IAAIwF,EAAIA,EAAA,IAC5B/uH,GAAAA,KAAKoW,MAAqB,QAAb5f,EAAQ4f,EAAAA,aAAAA,IAAK44G,EAAIhvH,EAAAA,KAAKoW,MACnCpW,KAAKo0E,KAAeA,EAAAA,KAGfp/D,eACE,IAASi6G,GACd76C,CAAAA,KAAMp0E,KAAKo0E,KAAK9hF,QAChB8jB,MAAOpW,KAAKoW,MAAMpB,QAClBu0G,KAAMvpH,KAAKupH,KAAKv0G,UAKpBo/D,uBACcsiC,MAGdtiC,SACEp0E,QAAK02G,MACL12G,EAAAA,KAAKupH,KAAK9R,WAIZ9+F,GAAAvC,wBACWmzG,gBACAvpH,GAAAA,KAAKupH,KAAKnzG,MAENe,GAAAA,MAGff,UACMpW,QAAKupH,gBAAgBwC,KACvB/rH,KAAKupH,KAAKnzG,MAKduC,GAAA4wG,uBACc2F,MAEd3F,SAEIvpH,QAAKkvH,MADH3F,aACW94F,GAAM84F,GAAOA,GAASA,GAAKv2F,EAAAA,cAM5Cra,EAAAnR,wBACc+hH,KAAK/hH,MAGnBC,yBACc8hH,KAAK9hH,OAGnBkoB,8BACc45F,KAAK55F,YAGTM,QAAQooF,IAKRnoF,MAAMmoF,IAKNvoF,WAAyC1vB,EAAWC,EACxDL,QAAKupH,gBAAgBwC,KACvB/rH,KAAKupH,KAAKnzG,MAAQpW,KAAKoW,OAEzBpW,KAAKupH,KAAKx6F,eAAiB/uB,KAAK+uB,eAChC/uB,KAAKupH,KAAKv6F,aAAehvB,KAAKgvB,aAC9BhvB,KAAKupH,KAAK11G,MAAQ7T,KAAK6T,MACvB7T,KAAKupH,KAAKt6F,SAAWjvB,KAAKivB,SAC1BjvB,KAAKupH,KAAKt7F,OAASjuB,KAAKiuB,OACxBjuB,KAAKupH,KAAKhhH,QAAUvI,KAAKuI,QACzBvI,KAAKupH,KAAK5R,OAAW33G,EAAAA,KAAK02G,MAAUr2G,EAAAA,4UC1DjC8uH,SAAMC,WAgMXpkD,eACE14D,GAAAA,MAhMK+8G,GAAArvH,KAAAupH,KAAa,IACZuD,GAAA9sH,KAAA02G,MAAc,IAASuY,GAAE76C,CAAAA,KAAM,GAAIm1C,KAAMvpH,KAAKupH,YAgL/C/0C,cAMA,EAAAx0E,KAAAizE,iBAA2B,EAUhC,MAAMmB,KAAKk7C,EAAAhnH,IAAKinH,EAAEnvH,EAACovH,EAAEnvH,EAACguH,EAAAxX,WAAY4Y,EAAAlG,KAAM4F,EAAA/4G,MAAW5f,GAEnDwJ,OAAKsI,IAAMA,MAAAA,EAAQlI,EAAKC,GAAIwS,EAAIzS,EAAGC,EAAKL,GAAAA,KAAKsI,IAC7CtI,KAAKo0E,KAAOA,MAAAA,EAAQp0E,EAAAA,KAAKo0E,KACzBp0E,KAAK62G,WAAaA,MAAAA,EAAc72G,EAAAA,KAAK62G,WACrC72G,KAAKupH,KAAOA,MAAAA,EAAQvpH,EAAAA,KAAKupH,KACzBvpH,KAAKoW,MAAQA,MAAAA,EAASpW,EAAAA,KAAKoW,MAC3B,MAAYpW,EAAAA,KAAKpL,IAAI8wE,IACjB7wD,EAAAA,OAAgBrC,EAAAA,KAChBuyD,EAAAA,IAAI/kE,KAAK02G,OApMftiC,uBACcsiC,MAAMtiC,KAGpBA,SACEp0E,QAAK02G,MAAMtiC,KAGbz7D,EAAAvC,wBACcsgG,MAAMtgG,MAGpBA,UACEpW,QAAK02G,MAAMtgG,MAGbuC,EAAApQ,0BACcmuG,MAAMnuG,QAGpBA,YACEvI,QAAK02G,MAAMnuG,QAWboQ,EAAAwzG,uBACc5C,KAAK4C,KAGnBA,SACEnsH,QAAKupH,KAAK4C,KAYZxzG,EAAA+2G,6BACcnG,KAAK2C,OAGnBwD,eACE1vH,QAAKupH,KAAK2C,OAWZvzG,EAAA47D,2BACcg1C,KAAK51G,KAGnB4gE,aACEv0E,QAAKupH,KAAK51G,KAWZgF,EAAAg3G,4BACcpG,KAAKzhH,MAGnB6nH,cACE3vH,QAAKupH,KAAKzhH,MAWZ6Q,EAAAi3G,2BACcrG,KAAK6C,KAGnBwD,aACE5vH,QAAKupH,KAAK6C,KAWZzzG,EAAA87D,4BACc80C,KAAK90C,UAGnBA,cACEz0E,QAAKupH,KAAK90C,UAWZ97D,EAAAg8D,4BACc40C,KAAK50C,UAGnBA,cACE30E,QAAKupH,KAAK50C,UAgBZh8D,EAAAk+F,6BACcgZ,kBAGdhZ,eACEl+F,GAAIm3G,GACFn3G,EAAA,CAAIm3G,GAAAA,aAIF/8C,GAAA,OAAA/yE,KAHK6vH,kBACL7vH,EAAAA,KAAKi4G,YAAczB,GAAAuZ,qBAAgCD,QAAAA,KAC9CpZ,MAAM6S,KAAOvpH,KAAKi4G,kBAGpBA,YACLj4G,EAAAA,KAAK02G,MAAM6S,KAAOvpH,KAAKi4G,aAoCpBphE,YACLvkC,GAAAA,MAAMukC,YACN72C,GAAAA,KAAK2uF,iBAA0BC,EAAAA,gBAM1BohC,2BACOtZ,MAAMlvG,MAcbwsE,cAA+BlwD,EAAiBmwD,EACrDj0E,QAAKupH,KAAK5S,OAAW92E,CAAAA,OAAY7b,EAASF,EAAU+oG,GAAAA,KAASz2G,EAAAA,MAWxDrmB,GAAAokF,cACDn0E,QAAK62G,YACP72G,KAAK62G,WAAW1iC,cAYbx7D,GAAAs3G,uBACA1G,KAAK5S,OAAS,KAGd76F,KAAqC2c,EAC1Cv1B,GAAA,MAAclD,EAAAA,KAAK2uF,sBACd+nB,MAAM56F,KAAYo0G,EAAG,EAAA,IA9N5BC,GAJCn+G,CACC5J,EAAAA,CAAAA,QAAS,wCACT6J,gBAAiB,mDAmBnBk+G,GAJCn+G,CACC5J,EAAAA,CAAAA,QAAS,8CACT6J,gBAAiB,2DAkBnBk+G,GAJCn+G,CACC5J,EAAAA,CAAAA,QAAS,4CACT6J,gBAAiB,uDAkBnBk+G,GAJCn+G,CACC5J,EAAAA,CAAAA,QAAS,6CACT6J,gBAAiB,yDAkBnBk+G,GAJCn+G,CACC5J,EAAAA,CAAAA,QAAS,4CACT6J,gBAAiB,uDAkBnBk+G,GAJCn+G,CACC5J,EAAAA,CAAAA,QAAS,6CACT6J,gBAAiB,6DAkBnBk+G,GAJCn+G,CACC5J,EAAAA,CAAAA,QAAS,6CACT6J,gBAAiB,6DAuBnBk+G,GADCn+G,CAAAA,qCAyEDm+G,GAJCn+G,CACC5J,EAAAA,CAAAA,QAAS,iDACT6J,gBAAiB,8DAcnBk+G,GAJCn+G,CACC5J,EAAAA,CAAAA,QAAS,iDACT6J,gBAAiB,8DAgBnBk+G,GAJCn+G,CACC5J,EAAAA,CAAAA,QAAS,mDACT6J,gBAAiB,sECpRZm+G,iBAA4BnyE,EACjC/6C,GAAIlD,GACIA,KADCqwH,eAAiBrwH,KAAKswH,YAC7B,MAAM,IAAI5qH,MAAM,yBAAyB1F,KAAKswH,gCAE5CtwH,GACIA,KADCuwH,QAAQ37H,IACf+jB,GAAA,MAAM,IAAIjT,MAAM,mBAAmB5N,oBAErC,MAAco4H,EAAA,IAAmBp4H,GAAMkI,EAAAA,KAAKwwH,kBAAAA,IAAmCvyE,EAAQj+C,GAAAA,KAAKwwH,0BACvFA,aAAgBxwH,KAAKwwH,cAAqB,EAC/CxwH,EAAAA,KAAKqwH,iBACLrwH,KAAKuwH,QAAQt3H,IAAUknD,EAChBA,GAMF+vE,EAAAO,2BACE9mH,MAAMsH,KAAKjR,KAAKuwH,QAAQtuD,6BAQ/BtpD,eAAY43G,QAAQ37H,IAMf+jB,uBACA43G,QAAU,IAAI59F,IACnB3yB,KAAKwwH,aAAexwH,KAAK0wH,cACzB1wH,KAAKqwH,eA9CQ,GAAAK,GAAAA,cACA,EAAAJ,GAAAA,YACA,GAAAD,GAAAA,eACA,EAAAG,GAAAA,aAAqCE,GAAAA,cACrCH,GAAAA,QAAuC,IAAI59F,ICM5D,IAAAg+F,GAAA,kBAoBSC,QAAAljG,UAIA,EAAA1tB,KAAA6wH,QAAkB,EAEjB7wH,KAAA8wH,QAAoB,GAAA9wH,KACrB6U,OAAgBrC,EAAAA,KAChBxS,KAAA6/B,OAAgBrtB,EAAAA,KAChBxS,KAAAivB,SACA,EAAAjvB,KAAA6T,MAAepB,EAAAA,IACfzS,KAAAuI,QAMLvI,EAAAA,KAAK8wH,QAELF,EAAA,MAAa5wH,EAAAA,KAAK8wH,QAAQtyE,QAAQ46B,CAAc23C,EAAAA,IACvCh/H,KAAKwL,IAAUwzH,EAAK3wH,EAC1BA,IACGiZ,GAAOrZ,EAAAA,KAAK8wH,QAAQtyE,QAAQ46B,CAAc23C,EAAAA,IACvCh/H,KAAKuL,IAAUyzH,EAAK3wH,EAC1BA,IAEHJ,QAAKuhB,UAAmBpI,EAExB63G,EAAA,MAAahxH,EAAAA,KAAK8wH,QAAQtyE,QAAQ46B,CAAc23C,EAAAA,IACvCh/H,KAAKwL,IAAUwzH,EAAK1wH,EAC1BA,IACGiZ,GAAOtZ,EAAAA,KAAK8wH,QAAQtyE,QAAQ46B,CAAc23C,EAAAA,IACvCh/H,KAAKuL,IAAUyzH,EAAK1wH,EAC1BA,IAEHL,QAAKwhB,WAAoBpI,EAEzBpZ,EAAAA,KAAKyH,OAASzH,KAAKwhB,WACnBxhB,KAAKwH,MAAQxH,KAAKuhB,UAMb6f,aAcAG,gBAOAO,gBAIAC,SAgBAjmB,KAA2D1b,EAAYC,EACxE4hC,GAAAA,aAAwBC,yBAC1BliC,KAAKmiC,iBAAmBxmB,CAAAA,IAAmBvb,EAAAA,EAAGC,EAAAA,EAAAA,SAEzC8hC,iBAIDxpB,GAAAwpB,wCACN8uF,EAAA,MAAMt1G,IAAKu1G,EAAE9wH,EAAC+wH,EAAE9wH,EAAC+wH,EAAAniG,SAAUoiG,EAAA9vG,UAAWkiG,EAAAjiG,WAAYo0E,EAAA/gF,OAAQ6uG,EAAA7jF,OAAQg2D,EAAAttF,QAAS+oH,EAAAviG,eAAgBwiG,EAAAviG,aAAmBwiG,GAAAphI,OAAH+c,OAAA/c,OAAA+c,OAAA,GAC/FwL,GACVsW,CAAAA,SAA0B,QAAhBz4B,EAAQy4B,EAAAA,gBAAAA,IAAQwiG,EAAIzxH,EAAAA,KAAKivB,SACnC1N,UAA4B,QAAjB/qB,EAAQ+qB,EAAAA,iBAAAA,IAASmwG,EAAI1xH,EAAAA,KAAKuhB,UACrCC,WAA8B,QAAlBhrB,EAAQgrB,EAAAA,kBAAAA,IAAUmwG,EAAI3xH,EAAAA,KAAKwhB,WACvCuN,eAAsC,QAAtBv4B,EAAQu4B,EAAAA,sBAAAA,IAAc6iG,EAAI5xH,EAAAA,KAAK+uB,eAC/CC,aAAkC,QAApBx4B,EAAQw4B,EAAAA,oBAAAA,IAAY6iG,EAAI7xH,EAAAA,KAAKgvB,aAC3Cna,OAAsB,QAAdre,EAAQqe,EAAAA,cAAAA,IAAMi9G,EAAI9xH,EAAAA,KAAK6U,OAC/BgrB,OAAsB,QAAdrpC,EAAQqpC,EAAAA,cAAAA,IAAMkyF,EAAI/xH,EAAAA,KAAK6/B,OAC/Bt3B,SAAyB,QAAf/R,EAAQ+R,EAAAA,eAAAA,IAAOypH,EAAIA,EAAA,IAAkB,QAAZhyH,EAAAA,KAAKuI,eAAAA,IAAO0oH,EAAIA,EAAA,KAGtC1vG,EAAY1M,EAAOzU,EAAIy/B,EAAOz/B,EAAIA,EAC3C4hC,EAASxgB,EAAa3M,EAAOxU,EAAIw/B,EAAOx/B,EAAIA,EAElDsb,EAAIqU,EAAAA,OACAvW,EAAAA,UAAkBuoB,EACtBrmB,GAAI9H,EAAAA,MAAM7T,KAAK6T,MAAS7T,EAAAA,KAAK6T,MAC7B8H,GAAI/G,EAAAA,OACJ+G,GAAI8R,EAAAA,YACAC,EAAAA,UAAY1tB,KAAK0tB,UAGrB,MAAmB1tB,EAAAA,KAAK8wH,QACxBn1G,GAAIiS,EAAAA,OAAkBxtB,EAAG+4D,EAAW94D,EAEpCA,GAAA,IAAQ4xH,EACR,EAAA,MAAYjyH,EAAAA,KAAK8wH,QAAQx/H,YAEbuV,EAAK9W,EAAAA,IACX89B,EAAAA,OAAO7tB,KAAK8wH,QAAW1wH,GAAGJ,EAAAA,KAAK8wH,QAAWzwH,GAGhDsb,GAAIkS,EAAAA,OAAkBztB,EAAG+4D,EAAW94D,EACpCsb,GAAImS,EAAAA,YAEA9tB,KAAK6wH,SACHroH,EAAAA,UAAYxI,KAAKkyH,UAAUj/H,WAC3Bm7B,EAAAA,QAGFxS,EAAAA,YAAc5b,KAAKmyH,UAAUl/H,WAE7B87B,IACEtV,EAAAA,UAAqBgqG,EACzB9nG,GAAI9H,EAAAA,OAAU,EAAA,IAGZmb,IACEvV,EAAAA,UAAa+H,EACjB7F,GAAI9H,EAAAA,MAAU,GAAA,IAGhB,MAAiB8H,EAAI4nB,EAAAA,YACjBA,EAAAA,YACJ5nB,EAAIoS,EAAAA,SACAwV,EAAAA,YAEJ5nB,EAAI2U,EAAAA,YA5KYqgG,oUAApBmB,EAAoBM,CAJnBpgH,CACC5J,EAAAA,CAAAA,QAAS,qCACT6J,gBAAiB,0BAEN8oD,UCTAs3D,aCMkB96H,GAC7B+6H,WAAWz7E,EAAAA,qBAUmBt/C,GAC9B+6H,WAAW7uD,EAAAA,sBAWiBlsE,GAC5B+6H,WAAW5uD,EAAAA,oBAUkBnsE,GAC7B+6H,WAAW3uD,EAAAA,qBAWkBpsE,GAC7B+6H,WAAWzuD,EAAAA,sBAUmBtsE,GAC9B+6H,WAAWzuD,EAAAA,sBAiHctsE,GACzB+6H,WAAWzsD,EAAAA,mBAMetuE,GAC1B+6H,WAAWxsD,EAAAA,WDxLG5rE,GAAAA,KACZq4H,CAAAA,IAAK,GACLnuF,KAAM,OACNouF,KAAM,OACNp+C,KAAM,OACNt/E,SAAU,WACVgnC,YAAa,qBE0Df22F,eAAoBH,QAAAI,KAhEZJ,EAAAtyH,KAAA2yH,QACA,EAAA3yH,KAAAu3C,eAAAA,EAKAv3C,KAAA4yH,OAAQ,EA8CR5yH,KAAA6yH,YAAa,EACb7yH,KAAA8yH,WAAY,EAEZ9yH,KAAA+yH,cAAkD1uG,GAAAA,SAClDrkB,KAAAgzH,YAAchzH,KAAK+yH,cAAcE,aAMjCjzH,KAAAkzH,eAGNlzH,EAAAA,KAAKmzH,yBA1DPruF,SACE9kC,QAAK4yH,MAED5yH,EAAAA,KAAKozH,YACPpzH,KAAKozH,UAAUtuF,KACf9kC,EAAAA,KAAKqzH,kBAGTvuF,uBACc8tF,MAGdU,WACEliI,GAAQunB,EAAWvnB,EAAOunB,EAAG,EAE7B3Y,GAAAA,KAAK2yH,QAED3yH,EAAAA,KAAK6yH,YAAc7yH,KAAKgzH,YAAYO,KAAKC,gBAI3CxzH,KAAKgzH,YAAYO,KAAKC,gBAAuBxzH,EAAAA,KAAK+yH,cAAc3tG,YAAa,IAE7EplB,KAAKgzH,YAAYO,KAAKniI,MAG1BunB,EAAA26G,yBACcX,QAGdrrF,aACEtnC,QAAKu3C,UAMP5+B,EAAA2uB,2BACciQ,UAGdk8E,gCACcL,UAAiBpzH,GAAAA,KAAKozH,UAAUM,aAAatiI,OAAgB,GAAA,KAmBpEi8F,wBACOwlC,WAIPlsF,KAA8BhuB,EAAA,sBAC1Bm6G,YACP9yH,KAAK2zH,kBACLC,KAAAA,KAGQf,aACR7yH,KAAK6zH,iBACLD,KAAAA,KAGUE,gBAGPnnD,aACKkmD,aAIV7yH,KAAK8yH,WAAY,EACjB9yH,KAAK6yH,YAAa,EAElB7yH,KAAKozH,UAAUrqF,KAKf/oC,GAAAA,KAAK+zH,mBAGAhrF,YACK8pF,aAIV7yH,KAAK6yH,YAAa,EAClB7yH,KAAK8yH,WAAY,EAEjB9yH,KAAKkzH,eACLlzH,EAAAA,KAAKozH,UAAUrqF,KAGV/oC,GAAAA,KAAKozH,UAAUruG,SAClB/kB,KAAKg0H,kBAIDH,sBACDhB,YAAa,EAClB7yH,KAAK8yH,WAAY,EACjB9yH,KAAK8zH,gBAAkB,IAAIpvH,SAAkBC,SACtCsvH,gBAAkBtvH,KAGpB3E,KAAKozH,WACRpzH,KAAKmzH,yBAGPnzH,KAAKk0H,qBAELl0H,KAAKgzH,YAAYnuG,QAAQ7kB,KAAK+yH,cAAcjuG,aAC5C9kB,KAAKozH,UAAUpuG,MAAS,EACxBhlB,GAAAA,KAAKkzH,eAELlzH,EAAAA,KAAKqzH,iBAGCM,kBACN,IAIA3zH,KAJU8yH,UACR,YAGGA,WAAY,EACjB9yH,KAAK6yH,YAAa,EAKlB7yH,KAAKozH,UAAUruG,QAAU,KACzB/kB,KAAKmzH,yBAEL,MAAiBnzH,EAAAA,KAAKyzH,cAAgBzzH,KAAK0yH,KAAKprF,SAC5BtnC,EAAAA,KAAKkzH,eAEzBlzH,OAAKk0H,oBAAkC,IACvCl0H,GAAAA,KAAKozH,UAAUpuG,MAASmvG,EACxBn0H,GAAAA,KAAKqzH,iBAGCA,sBACIvuF,OACR9kC,KAAKozH,UAAUruG,QAAU,IAAA/kB,KAAWg0H,kBAIhCA,sBAGIlB,YACR9yH,KAAK6yH,YAAa,EAClB7yH,KAAKi0H,iBAAgB,IAIjBC,mBACNl0H,QAAKo0H,YAAa,IAAIxqH,MAAOyqH,WAAaC,EAGpC37G,GAAAo7G,uBACDb,iBAAmB,IAAItpH,MAAOyqH,UAAYr0H,KAAKo0H,YAAcp0H,KAAKyzH,cAAiB,IAGlFN,8BACDC,UAAYpzH,KAAK+yH,cAAcpuG,qBACpC3kB,KAAKozH,UAAU3uG,OAASzkB,KAAK0yH,KAC7B1yH,KAAKozH,UAAUtuF,KAAO9kC,KAAK8kC,KAC3B9kC,KAAKozH,UAAUM,aAAaa,eAAoB,EAEhDv0H,GAAAA,KAAKozH,UAAUvuG,QAAQ7kB,KAAKgzH,uBCnMJwB,GAC1BC,OACE,MAAUC,EAAA,IAAIC,MACGC,EAAA,sBACJJ,EAAKt/H,EAAAA,MAAgB0/H,GAClC,WAAMC,EAAAA,YAAY,SAKlBC,GAAA,MAEAC,UADOljH,EAAAA,cAAc5K,KAAK,wEAAyE/D,IAC5F,oTCAE8xH,WAoEXx0D,kBACEluD,GAAAA,QApEKtS,KAAA08B,OAAwB7qB,EAAAA,cAsDvB7R,KAAA4yH,OAAQ,EACR5yH,KAAA2yH,QACA,EAAA3yH,KAAAu3C,eAAAA,EACAv3C,KAAAi1H,YAAa,EACbj1H,KAAA8yH,WAAY,EACZ9yH,KAAAk1H,QAAmB,GAAAl1H,KAEnBm1H,qBAA+B,EAC/Bn1H,KAAA+yH,cAAoC1uG,GAAAA,SAO1CrkB,KAAKkkC,UAAY,IAAa3H,GAAA,GAAeriC,GAAAA,KAAK4hC,iBAO7C,MAAM3rC,KACTskI,EAAIW,GAAYjlI,GAAOukI,GACrB10H,MAAK7P,KACLukI,aAIMvkI,OACR6P,KAAK08B,OAAOz1B,KAAK,kEAAyElK,EAAAA,KAAK,OAC/FiD,KAAK08B,OAAOz1B,KAAK,oBAA2BwtH,EAAA,IAC5Cz0H,KAAK7P,KAAaskI,EAAA,IA/EtB3vF,SACE9kC,QAAK4yH,MAELj6G,MAAK,MAAMmsC,KAAAA,KAAcowE,QACjBpwF,EAAAA,KAAO9kC,KAAK4yH,WAGfl2F,OAAO31B,MAAM,sCAAuC/G,KAAK7P,KAAM,KAAM6P,KAAK4yH,OAEjF9tF,uBACc8tF,MAGdU,WACEtzH,QAAK2yH,QAELh6G,MAAK,MAAMmsC,KAAAA,KAAcowE,QACjB5B,EAAAA,OAAStzH,KAAK2yH,aAGjBtmG,KAAK,eAAgB,IAAqBrsB,GAAAA,OAAAA,KAE1C08B,OAAO31B,MAAM,sCAAuC/G,KAAK7P,KAAM,KAAM6P,KAAK2yH,SAEjFW,yBACcX,QAGdrrF,2BACciQ,UAMd89E,4BACcH,QAGd/kI,uBACc+zC,UAAU/zC,KAGxBA,SACE6P,QAAKkkC,UAAU/zC,KAuCVwoB,EAAAsf,wBACS39B,KAGH06B,iDACPh1B,GACKA,KADA1F,KACP,OAAA0F,KAAY1F,KAEd,MAAMwhC,QAAAA,KAAyBoI,UAAUlP,OACnCsgG,QAAAA,KAAyBC,YAAwBjjI,EAAAA,MAAM,gBACxDilD,UAAmC,iBAAW+9E,EAAYhuF,EAAAA,cAAAA,EAC/DtnC,KAAKqsB,KAAK,YAAa,IAA8BrsB,GAAAA,KAAMs1H,IACpDt1H,KAAK1F,KAAOg7H,KAGRC,+EAESxC,cAAcvuH,gBAAqBlS,EAAAA,MAAM,IAC3D,MAMAkjI,eALK94F,OAAOhpC,MACV,4KAIWgR,QAAQE,aAIlBizB,WACDlO,GAAAA,IACF3pB,KAAK83B,QAEL93B,EAAAA,KAAK83B,QAAWrU,GAAA,UAAU,KACb8iG,EAAAA,sBAAwBvmH,KAAKqtF,cAAAA,KACjC8nC,qBAAsB,EAC3Bn1H,KAAK2sE,YAIT3sE,KAAK83B,QAAWrU,GAAA,WAAW,KACd8iG,EAAAA,sBAAwBvmH,KAAKm1H,sBACtCn1H,KAAK2mC,OACL3mC,KAAKm1H,qBAAsB,MAI/Bn1H,KAAK83B,QAAWrU,GAAA,SAAS,UAClBwxG,YAAa,KAGpBj1H,KAAK83B,QAAWrU,GAAA,QAAQ,UACjBslB,OACL/oC,KAAKi1H,YAAa,MAQjBQ,4BACOP,QAAQ5jI,OAMf+7F,wBACO6nC,QAAQ5qD,MAAY3xD,GAAE00E,EAAAA,cAO7B1mD,KACLhuB,eAAUsf,WAMNj4B,KAAKi1H,YACPj1H,KAAK08B,OAAOz1B,KAAK,uDACVvC,QAAQC,SAAQ,KAAA3E,KAGpBszH,OAAmBtzH,GAAAA,KAAKszH,OAEzBtzH,KAAK8yH,UACA9yH,KAAK01H,kBAEL11H,KAAK21H,mBAAAA,KAfPj5F,OAAOz1B,KAAK,iCAAkCjH,KAAK7P,KAAM,qBAEvDuU,QAAQC,SAAQ,IAoBpBgoE,QACA3sE,GAIM8kD,KAJDuoC,YAIV,KAAK,MAAMvoC,KAAAA,KAAcowE,QACjBvoD,EAAAA,aAGHmmD,WAAY,EAEjB9yH,KAAKqsB,KAAK,QAAS,IAAqBrsB,GAAAA,OAAAA,KAEnC08B,OAAO31B,MAAM,gCAAiC/G,KAAK7P,OAMnD44C,WACA,MAAM+b,KAAAA,KAAcowE,QACjBnsF,EAAAA,YAGH1c,KAAK,OAAQ,IAAqBrsB,GAAAA,OAAAA,KAElC8yH,WAAY,EACjB9yH,KAAKk1H,QAAQ5jI,OACb0O,EAAAA,KAAK08B,OAAO31B,MAAM,iCAAkC/G,KAAK7P,MASpDylI,WACLj9G,eAAYu8G,QAAQzjI,QAGRknB,GAAA+8G,4DACR11H,GACkCA,KAD7B8yH,UACP,CAAA,MAAoC+C,EAAA,OAE/B,MAAM/wE,KAAAA,KAAcowE,QACfliI,EAAAA,KAAW2zC,EAAAA,aAGhBmsF,WAAY,EAEjB9yH,KAAKqsB,KAAK,SAAU,IAAqBrsB,GAAAA,OAAAA,KAEpC08B,OAAO31B,MAAM,sCAAuC/G,KAAK7P,KAAM6P,KAAKk1H,eAEnExwH,QAAQg0B,IAEhBm9F,eAMYF,2DACZ,MAAM7wE,QAAAA,KAAmBgxE,kBAAkB91H,KAAK1F,MAE1C4xE,QAAuBvlC,EAAAA,MAAK,UAC3Bta,KAAK,gBAAiB,IAAqBrsB,GAAAA,KAAM8kD,IACtD9kD,KAAK08B,OAAO31B,MAAM,iCAAkC/G,KAAK7P,qBAItDk8B,KAAK,cAAe,IAAqBrsB,GAAAA,KAAM8kD,IACpD9kD,KAAKk1H,QAAQnqH,OAAO/K,KAAK41H,WAAmBC,GAErC3pD,GAAAA,KAGD4pD,kBACNn9G,GAAA,MAAiBo9G,EAAA,IAAqBz7H,GAQtCqe,UANSmsB,EAAAA,KAAO9kC,KAAK8kC,KACZwuF,EAAAA,OAAStzH,KAAKszH,OACdhsF,EAAAA,SAAWtnC,KAAKsnC,SAEzBtnC,KAAKk1H,QAAQliI,KAENgjI,YC5PTC,eAAwC7/G,EAAehB,EAAM2C,GAAAA,QAA4B68G,GAAA,QAAtEzkI,KAAqB+lI,EAAAl2H,KAAAoW,MAAqC2/G,EAAA/1H,KAAAw8B,UAbrEo4F,EAAA50H,KAAAm2H,QAAkB,KAClBn2H,KAAAo2H,KAAiB,KACjBp2H,KAAAq2H,UAA2B,GAAAr2H,KAC3Bs2H,WAAwB,KACxBt2H,KAAAu2H,kBAA2B,KAUjCv2H,KAAKkkC,UAAY,IAAa/zC,GAAM+lI,EAAA,cACpCl2H,GAAAA,KAAKu2H,kBAMMR,EAAA/gG,4CACX,MAAM8G,QAAAA,KAAyBoI,UAAUlP,YACpCmhG,QAAU,IAAWr6F,GAC1B97B,GAAAA,KAAKo2H,KAAO,IAAap2H,GAAAA,KAAKm2H,QAASn2H,KAAKu2H,mBAC5C,MAAev2H,EAAAA,KAAKo2H,KAAKrvF,OAAO9lC,KAASu1H,GAAA,IAAgBzmI,GAAEqnC,EAAAA,KAAK,kBAG1D1yB,QAAQg0B,IAAWz3B,EAAAA,KAAS0X,GAAEqc,EAAAA,eACxB16B,KAAO0F,KAAKq2H,UAAYtvF,kSAG/B9O,wBACS39B,KAOTs7E,eAA4Bj9D,EACjC,UAAci9D,GAAAA,eAAe51E,KAAKutE,SAASnvE,IAQtCq4H,6BACcA,GAAAA,oBAAoBz2H,KAAK02H,iBAQvCC,kBAAkC9xF,EACvC3hC,UAAiByzH,GAAAA,kBAA0B32H,EAAAA,KAAK42H,YAAY/xF,IAOvD0oC,SAAsB50D,EAE3B,eADoB09G,UAAc9oD,GAAAA,WAO7BmpD,gBACL,MAA0B12H,EAAAA,KAAKq2H,UAAUp1H,KAChCgwB,GAAMs8C,EAAAA,oBAER,IAAgB6H,GAAExwC,CAAAA,QAAAA,IAMpBgyF,YACLj+G,GAAA,MAAiC3Y,EAAAA,KAAK02H,gBACvB/gD,EAAY/wC,EAAAA,QAAQtzC,mBAC9BglI,WAAuBO,GAAAA,gBAA6B1rH,EAAMqoC,EAAGliD,EAAS07F,GACpEhtF,GAAAA,KAAKs2H,WAGdQ,iCACcV,KAAKW,YAoBrB,MAAmBC,GACVA,GAAGx4E,EAAAA,QAAO,SAAqB77C,EACpCs0H,UAAOntH,EAAQnH,EAAAA,IAIbu0H,GAAgBC,GAAAA,IACpB,MAAUF,EAAA,OACL,IAAQG,EAAGrnI,EAAKqnI,GAAGrnI,EAAAA,IACpBiD,EAAAA,QAAgBqkI,EAAKtnI,GAAAA,WAKpBknI,SAKLK,eAGED,GAPF,GAcUr3H,KAdV1F,KAAY,KACZ0F,KAAA6G,IACA,EAAA7G,KAAA+H,SAUO,EAAA/H,KAAAu3H,SAAW,KACZv3H,GACIA,KADC+H,UAAY/H,KAAK1F,KAAKk9H,WAC7B,MAAM,IAAI9xH,MAAM,qDAENpL,KAAK0F,KAAK+H,aAGjB/H,KAAAy3H,UAAa90H,IAClB,MAAcs0H,EAAA,OACT,IAAQG,EAAGrnI,EAAI4S,EAAG5S,EAAAA,IACfiD,EAAAA,KAAKgN,KAAKu3H,mBAKbN,GAAAj3H,KAAA03H,KAAQ/0H,IACb,IAAQs0H,EAAA,OACH,IAAQG,EAAGrnI,EAAI4S,EAAG5S,EAAAA,IAChBY,GAAAA,OAAOgP,aAAaK,KAAKu3H,mBAK3BN,GAAAj3H,KAAA23H,aAAe,KAEpB,MAAU33H,EAAAA,KAAKy3H,UACf,UAAUG,EAAA,IAAWrgI,GAAEqgI,EAAA,IAjCvB53H,KAAK1F,KAAO,IAAImkG,WAChBz+F,GAAAA,KAAK6G,IAAM7G,KAAK1F,KAAKk9H,WACJ,IAAbx3H,KAAK6G,IACP,MAAM,IAAInB,MAAM,mCAmHpBmyH,eAA4BzhH,EAAehB,EAAM2C,GAAAA,cARzC+/G,IAAc,KACd93H,KAAA+3H,SAAgB,QAChBxB,kBAA2B,KAC5Bv2H,KAAAqnE,OAAqB,GAAArnE,KACrB+mC,OAA6B,GAAA/mC,KAC7Bg4H,iBAA0B,GAAAh4H,KAC1B+2H,WAAuB,GAAA/2H,KAW9Bi4H,gBAAmBC,IAEjB,MAAWC,EAAA,OACN,IAAQf,EAAGrnI,EAAImoI,EAASnoI,EAAAA,IAC3B,CAAA,MAEEqoI,EAAA,IAFoBp4H,KAAK83H,IAAIL,UAI1Bx2H,GAAAA,KAAKb,IACJ,MAAYA,EAAEnN,EAAAA,SAAS,WACD,IAAX3B,EAAAA,OAAe,IAAYikB,EAAAA,KAEvCxY,KAAK,IACP/J,EAAAA,KAELolI,UAGFD,GAAAn4H,KAAAq4H,cAAgB,KACd,IAAU/9H,EACVA,EAAO69H,EAAA,MAEEn4H,EAAAA,KAAK83H,IAAIP,WACRv3H,GAAAA,KAAK83H,IAAIJ,KAAK/jH,SACN,IAClB2kH,UAGFH,GAAAn4H,KAAAu4H,YAAc,KACZ,MACEC,EAAAA,CAAAA,IAAK,KACLC,IAAK,KACLjxH,MAAO,KACPC,OAAQ,KACRixH,SAAU,KACVC,qBAAsB,KACtBC,QAAS,KACTC,OAAQ,KACRb,iBAAkB,GAClBc,QAAS,KACTC,iBAAkB,MAGpBC,GAAIR,EAAAA,IAAMx4H,KAAK83H,IAAIJ,KACnBsB,GAAIP,EAAAA,IAAMz4H,KAAK83H,IAAIJ,KACH,GAAA,QAARc,EAAAA,IACN,MAAM,IAAI9yH,MAAM,mBAGd8B,EAAAA,MAAQxH,KAAK83H,IAAIH,eACjBlwH,EAAAA,OAASzH,KAAK83H,IAAIH,eAEtB,MAAaT,EAAal3H,GAAAA,KAAK83H,IAAIP,YAC/BqB,EAAAA,QAAezvF,EAAAA,QACfuvF,EAAAA,SAAqBO,GAAKluH,EAAAA,OAAU,EAAA,IACpC8tH,EAAAA,OAAc1vF,EAAAA,QACdwvF,EAAAA,qBAAiCM,GAAKluH,EAAAA,OAAU,EAAA,IAEhD+tH,EAAAA,QAAU94H,KAAK83H,IAAIP,WACnBwB,EAAAA,iBAAmB/4H,KAAK83H,IAAIP,WAExBqB,EAAAA,UACFZ,EAAAA,iBAAmBh4H,KAAKi4H,gBAAsBe,GAAIL,EAAAA,qBACtD34H,GAAAA,KAAKg4H,iBAAuBA,EAAAA,kBAE1Bh4H,KAAK+3H,SAASiB,KAAOh5H,KAAK+3H,SAASiB,IAAIA,IACzCh5H,KAAK+2H,WAAW/jI,KAAKgN,KAAK+3H,SAASiB,MAIvCh5H,KAAAk5H,SAAYC,IACV,MAAoBA,EAAAA,SACbpC,WAAW/jI,KAAKgN,KAAK83H,IAAIP,YAE9B,MAAaL,EAAal3H,GAAAA,KAAK83H,IAAIP,YAC7B6B,EAAAA,SAAgBruH,EAAAA,OAAU,EAChCouH,GAAME,EAAAA,eAA2BJ,GAAKluH,EAAAA,OAAU,EAAA,IAC1CuuH,EAAAA,UAAiBnwF,EAAAA,QACjBowF,EAAAA,kBAAyBpwF,EAAAA,QAEzBqwF,EAAAA,UAAYx5H,KAAK83H,IAAIH,eAErB8B,EAAAA,kBAAoBz5H,KAAK83H,IAAIP,WAE7BmC,EAAAA,WAAa15H,KAAK83H,IAAIP,WAExBv3H,KAAK+3H,SAAS4B,KAAO35H,KAAK+3H,SAAS4B,IAAIR,IACzCn5H,KAAK+2H,WAAW/jI,KAAKgN,KAAK+3H,SAAS4B,MAIlBR,EAAAA,IACbS,EAAAA,QAAU55H,KAAKq4H,gBACjBr4H,KAAK+3H,SAAS8B,KAAO75H,KAAK+3H,SAAS8B,IAAIV,IACzCn5H,KAAK+2H,WAAW/jI,KAAKgN,KAAK+3H,SAAS8B,MAInBV,EAAAA,SACbpC,WAAW/jI,KAAKgN,KAAK83H,IAAIP,YACxBuC,EAAAA,SAAW95H,KAAK83H,IAAIL,UAAU,IAC9BsC,EAAAA,OAAS/5H,KAAKq4H,gBAChBr4H,KAAK+3H,SAASiC,KAAOh6H,KAAK+3H,SAASiC,IAAIb,IACzCn5H,KAAK+2H,WAAW/jI,KAAKgN,KAAK+3H,SAASiC,MAIlBb,EAAAA,IACnB,MAA0BA,EAAAA,SACnBpC,WAAW/jI,KAAKgN,KAAK83H,IAAIP,YACxB0C,EAAAA,QAAUj6H,KAAK83H,IAAIP,WACnB2C,EAAAA,WAAal6H,KAAK83H,IAAIH,eACtB+B,EAAAA,WAAa15H,KAAK83H,IAAIP,WACxBv3H,KAAK+3H,SAASoC,KAAOn6H,KAAK+3H,SAASoC,IAAIC,UAAYp6H,KAAK+3H,SAASoC,IAAIC,SAASjB,IAChFn5H,KAAK+2H,WAAW/jI,KAAKgN,KAAK+3H,SAASoC,MAIXhB,EAAAA,IACpBkB,EAAAA,QAAUr6H,KAAKq4H,gBAEjBr4H,KAAK+3H,SAASoC,KAAOn6H,KAAK+3H,SAASoC,IAAU/oB,EAAAA,aAAepxG,KAAK+3H,SAASoC,IAAU/oB,EAAAA,YAAY+nB,IAClGn5H,KAAK+2H,WAAW/jI,KAAKgN,KAAK+3H,SAASoC,IAAU/oB,EAAAA,iCAI5C2lB,WAAW/jI,KAAKgN,KAAK83H,IAAIP,YACxBnmB,EAAAA,WAAapxG,KAAK83H,IAAIJ,KAC5ByB,GAAMmB,EAAAA,SAAWt6H,KAAK83H,IAAIJ,KAClByB,GAAM/nB,EAAAA,YAEO+nB,EACjBf,GAEmBe,EAAAA,IAKAA,EAAAA,IACjB7+H,EAAAA,KAAO0F,KAAKq4H,gBACdr4H,KAAK+3H,SAASkC,SAAWj6H,KAAK+3H,SAASkC,QAAQd,IACjDn5H,KAAK+2H,WAAW/jI,KAAKgN,KAAK+3H,SAASkC,iBAIjCM,EAAAA,MAAQv6H,KAAK83H,IAAIP,WACTgD,EAAAA,YACP,IACGC,EAAAA,QAAU,MACLrB,EACXb,cACG,IACGkC,EAAAA,QAAU,MACJrB,EACZb,cAEAa,EAAMqB,EAAAA,QAAU,MACLrB,EACXb,cACG,IACGkC,EAAAA,QAAU,MACJrB,EACZb,iBAEMkC,EAAAA,QAAU,UACArB,EAAAA,KAKtBn5H,KAAAy6H,SAAYC,IA0BNC,EAAAA,QAAU36H,KAAK83H,IAAIH,eACnBiD,EAAAA,OAAS56H,KAAK83H,IAAIH,eAClBnwH,EAAAA,MAAQxH,KAAK83H,IAAIH,eACjBlwH,EAAAA,OAASzH,KAAK83H,IAAIH,eAEtB,MAAaT,EAAal3H,GAAAA,KAAK83H,IAAIP,YAC/BsD,EAAAA,QAAe1xF,EAAAA,QACf2xF,EAAAA,WAAkB3xF,EAAAA,QAClB0vF,EAAAA,OAAc1vF,EAAAA,QACdiwF,EAAAA,SAAgBruH,EAAAA,OAAU,EAC9B2vH,GAAIK,EAAAA,QAAoB9B,GAAKluH,EAAAA,OAAU,EAAA,IAE/B8vH,EAAAA,UACFG,EAAAA,IAAMh7H,KAAKi4H,gBAAsByC,GAAIK,EAAAA,QAAU,IAGjDE,EAAAA,eAAiBj7H,KAAK83H,IAAIP,WAE9B,MAAgBv3H,EAAAA,KAAKq4H,gBAEjB6C,EAAAA,OAnTU,SAA+B5gI,EAE/C6gI,GAAA,IAAUC,EAEV,EAAA,MAAiBtG,EAAA,SACfuG,GAAA,IAAWC,EACX,MAAK,IAAQC,EAAGxrI,EAAI4jB,EAAM5jB,EAAAA,IACf0d,EAAAA,WAAkB2tH,GAAM,GAAA,IAAM9yH,EAAAA,KAC7BgzH,GAAKvrI,GAEfuY,GAAAA,WAKEkzH,GAAgBD,EAAA,GAEJE,EAAKC,GACjBC,EAAUC,EAAYH,EAE5B,EAAA,IAAeC,EAActD,EAEzByD,EAAcC,EAAA,GAElB,MAAcC,EAAA,WACLD,EAAA,GACIJ,EAActD,EACzB,MAAK,IAAQiD,EAAGtrI,EAAI6rI,EAAW7rI,EAAAA,IACxBA,EAAKsrI,GAACtrI,CAEb8rI,GAAKD,EAAaH,GAAA,GACbE,EAAWK,GAAA,MAGlB,IACIC,EAEJ9K,SACE8K,GAAOx8H,EACPA,EAAOy8H,EAASC,EACZ18H,GAAAA,IAIJg8H,EAAA,CAAIh8H,GAAAA,IACFu8H,EAAA,MAGEv8H,GAAOo8H,EAAKvqI,EAAAA,OACV2qI,IACFJ,GAAK7oI,EAAAA,KAAUipI,EAAMtgI,GAAAA,OAAY8D,EAAMyxH,GAAA,SAGzC,CAAIzxH,GAAAA,IAAcnO,EAAAA,OAChB,MAAM,IAAIoU,MAAM,qBAEb1S,EAAAA,KAAUipI,EAAMtgI,GAAAA,OAAYsgI,EAAM9K,GAAA,KAElCn+H,EAAAA,KAAK0E,MAAcmkI,EAAKp8H,EAAAA,IAEtBnO,EAAAA,SAAgB6qI,GAAYA,GAAWC,EAAA,IAE9CD,SArBA7rH,WA0QqBoqH,EAnTT,CAmTaO,EAAAA,eAEvBP,GAAII,EAAAA,aAEFI,EAAAA,OAjDeA,EAAa1zH,EAAAA,KAIhC,MAAkB4zH,EAAA,IAAIzxH,MAAarY,EAAAA,QACtB4pI,EAAO5pI,EAAAA,OACd+qI,EAASC,EAAAA,CAAYC,EAAAA,KACzB,MAAmBrB,EAAO5oI,EAAAA,MAAgBkV,EAAQ+0H,GAAUC,EAAKh1H,GACjEi1H,GAAU1xH,EAAAA,OAAOrT,MAAkB4kI,EAAAA,CAAQ90H,EAAOA,EAAO7L,GAAAA,OAAO+gI,KAGjDjB,EAAA,CAAG,EAAG,EAAG,EACpBkB,GAASX,EAAA,CAAG,EAAG,EAAG,EAExB,GAAA,IAAcI,EACd,MAAK,IAAWf,EAAGuB,EAAOvB,EAAGuB,EAAAA,IAC3B,IAAK,IAAYC,EAAQD,EAAON,GAAQnsD,EAAMmsD,EAASK,GAAMC,EAC3DP,GAAMC,EAAOC,EACbA,GAAAA,WA+BSO,GAjDM5B,CAiDUA,EAAAA,OAAY1zH,EAAAA,QAG3CxH,KAAKqnE,OAAOr0E,KACZgN,GAAAA,KAAK+8H,aACD/8H,GAAAA,KAAK+3H,SAAS2C,KAAO16H,KAAK+3H,SAAS2C,IAAIA,IACzC16H,KAAK+2H,WAAW/jI,KAAKgN,KAAK+3H,WAIvB/3H,KAAAg9H,WAAa,KAClB,MACEC,EAAAA,CAAAA,SAAUj9H,KAAK83H,IAAIP,WACnBr9H,KAAM,WAEUvJ,OAAOgP,aAAmBs9H,EAAAA,mBAGlC/iI,EAAAA,KAAO,MACb8F,KAAKk5H,SACLZ,iBAEMp+H,EAAAA,KAAO,MACb8F,KAAKy6H,SACLnC,iBAEMp+H,EAAAA,KAAO,MACT8F,KAAK+3H,SAASmF,KAAOl9H,KAAK+3H,SAASmF,IAAI/D,IACzCn5H,KAAK+2H,WAAW/jI,KAAKgN,KAAK+3H,SAASmF,mBAIrC,MAAM,IAAIx3H,MAAM,oBAA4Bu3H,EAAAA,SAAShqI,SAAS,aAGxDiH,EAAAA,MACR8F,KAAKg9H,cAITh9H,KAAA+8H,aAAgBI,IACd,IAAYhF,EACZ,EAAA,MAAUrjI,EAAAA,SAASE,cAAc,UAC/BoJ,EAAKgS,GAAMnd,EAAAA,WACXuU,EAAAA,MAAcA,EAAAA,MACdC,EAAAA,OAAeA,EAAAA,OACjB2I,IACA,MAAgB3Y,EAAEwQ,EAAAA,WAAW,MAE7B,IAAQszH,EACJn7H,EAAIq7H,EACR,MAAK,IAAQN,EAAGprI,EAAIotI,EAAMjC,EAAAA,OAAO5pI,OAAQvB,IAC/BotI,EAAM31H,EAAAA,OAAU,IACtBnH,IACIo7H,EAEFz7H,GAAAA,KAAKg4H,iBAAuBkD,EAAAA,OAAOnrI,MAAAA,KAAawmI,kBAAkBt/G,QAC5DzO,EAAAA,UAAY,mBAEZA,EAAAA,UAAYxI,KAAKg4H,iBAAuBkD,EAAAA,OAAOnrI,IAGjDmpC,EAAAA,SAAY74B,EAdNk7H,EAAA,EAedn7H,GAAAA,IAEF,MAAY47H,EAAA,IAAI7kG,MACZC,EAAAA,IAAQ2D,EAAAA,YACZ/6B,KAAK+mC,OAAO/zC,KAAK0nI,IAxSjB16H,KAAK83H,IACL93H,EAAAA,KAAK+3H,SAAW,QACXxB,kBACLv2H,EAAAA,KAAKu4H,cACLv4H,KAAKg9H,oBClRII,WAmBX/2D,eACE/zD,GAAAA,MACAtS,GAAAA,KAAKkZ,OAAiBA,EAAAA,OACtBlZ,KAAK60B,YApBP3b,yBACc43G,QAEd53G,WACElZ,QAAK8wH,QACLn4G,EAAA,MAAY3Y,EAAAA,KAAK4pD,cACZpiD,MAAQxH,KAAK8wH,QAAQtyE,QAAQlhD,CAAKsI,EAAAA,IAAM7T,KAAKuL,IAAM8C,EAAG9C,EAAM+/H,IAAK9/H,GAAI6C,EAC1EJ,EAAAA,KAAKyH,OAASzH,KAAK8wH,QAAQtyE,QAAQlhD,CAAKsI,EAAAA,IAAM7T,KAAKuL,IAAM+C,EAAG/C,EAAM+/H,IAAK9/H,GAAI8C,EAC3EL,EAAAA,KAAKgzB,YAGP42B,sBACe5pD,EAAAA,KAAK8wH,QAAQtyE,QAAQjhD,CAAKqI,EAAAA,IAAM7T,KAAKwL,IAAM6C,EAAG7C,EAAMuV,IAAAA,EAAAA,GACpD9S,KAAK8wH,QAAQtyE,QAAQjhD,CAAKqI,EAAAA,IAAM7T,KAAKwL,IAAM8C,EAAG9C,EAAMuV,IAAAA,EAAAA,IAU5DkC,eACE,IAAYooH,GAAAhtI,OAAD+c,OAAA/c,OAAA+c,OAChB+L,CAAAA,OAAQlZ,KAAKkZ,OAAOjY,KAAW2E,GAAEoP,EAAAA,gBACzB0a,uBAAAA,KACAwE,uBAIZa,QACEpc,GAAI3Y,GAGUA,KAHLkZ,QAAUlZ,KAAKkZ,OAAO5nB,OACzBm8B,CAAAA,EAAAA,YAEJ,MAAYztB,EAAAA,KAAK4pD,SAASn1C,SACPzU,EAAAA,KAAKkZ,OAAUnF,GAAAA,IAClC4H,GAAIiS,EAAAA,OAAkBxtB,EAAG+4D,EAAW94D,EACpCL,GAAAA,KAAKkZ,OAAOpI,SAAS4I,IACfmU,EAAAA,OAAaztB,EAAI7C,EAAI6C,EAAGsZ,EAAMrZ,EAAI9C,EAAI8C,EAAAA,MAExCwtB,EAAAA,OAAkBztB,EAAG+4D,EAAW94D,EACpCsb,GAAImS,EAAAA,YACA9tB,KAAKoW,OACHgY,EAAAA,OAEFpuB,KAAKqzB,aACHtF,EAAAA,mVCpDZiuG,GAAA,IAAAsB,GAAA,kBAKIt9H,QAAKu9H,eAGAC,EAAA94C,KACL/rE,eAAY8kH,MAAMz9H,KAAK09H,MAGjB/kH,GAAA8kH,MAA+BlrI,EACrC2Q,UAAY,MAAR+/C,IAEOjjD,KAAKu9H,eAAehrI,KAAkBorI,EAAAA,SACtCC,EAAAA,UAAUnsI,QAAQc,IAKlByN,EAAAA,KAAKu9H,eAA0Bt6E,GAAK06E,EAAAA,SACtC39H,KAAKy9H,MAAWI,EAAAA,UAEhB79H,GAAAA,KAAKy9H,MAAWK,EAAAA,WAAYvrI,IAKhCqC,IACL+jB,eAAYolH,KAAK/9H,KAAK09H,MAGhB/kH,GAAAolH,KAA8BtqI,EACpCyP,UAAY,MACHyV,EAAA,GACEllB,IAAakqI,EAAAA,SACVC,EAAAA,UACG36E,EAAK06E,EAAAA,SACb39H,KAAK+9H,KAAUF,EAAAA,UAEf79H,GAAAA,KAAK+9H,KAAUD,EAAAA,WAInB56H,GAAA6Q,IACL4E,UAAkB,MAAd3Y,KAAK09H,OACP19H,KAAK09H,MAAQ,IAAmB19H,GAAAA,KAAKu9H,eAAyB5kH,GAACpmB,CAAUomB,GAAA,KAAM,OACxE,GAEA3Y,KAAKuhD,QAAQvhD,KAAK09H,MAIrB/kH,GAAA4oC,QAAiChvD,EACvC2Q,UAAY,MAAR+/C,IACEjjD,KAAKu9H,eAAehrI,KAAkBorI,EAAAA,WAC/BC,EAAAA,UAAUnsI,QAAQc,IAAY,IAGhCqrI,EAAAA,UAAU5qI,KAAKT,GACb,IAEAyN,KAAKu9H,eAA0Bt6E,GAAK06E,EAAAA,SACvB,MAAbE,EAAAA,WACFG,EAAAA,QAAQ,IAAmBh+H,GAAAA,KAAKu9H,eAAyBr6H,GAAC3Q,CAAU2Q,GAAA,KAAM,QAAA,GAGxElD,KAAKuhD,QAAas8E,EAAAA,UAGJ36H,GAAA,MAAd46H,EAAAA,YACFG,EAAAA,SAAS,IAAmBj+H,GAAAA,KAAKu9H,eAAyBr6H,GAAC3Q,CAAU2Q,GAAA,KAAM,QAAA,GAGzElD,KAAKuhD,QAAau8E,EAAAA,WAAYvrI,IAOtC2rI,mBACLl+H,QAAK09H,MAAQ19H,KAAK2iD,QAAQ3iD,KAAK09H,MAGzB/kH,GAAAgqC,QAAiCpwD,EACvC2Q,GAAY,GAAA,MACVyV,EAAA,OAAO,KACE3Y,GA0BAA,KA1BKu9H,eAAehrI,KAAkBorI,EAAAA,SA0B1C,OAAA39H,KAASu9H,eAA0Bt6E,GAAK06E,EAAAA,UACxCK,EAAAA,QAAQh+H,KAAK2iD,QAAak7E,EAAAA,UAAWtrI,IACnC0wD,IAEFg7E,EAAAA,SAASj+H,KAAK2iD,QAAam7E,EAAAA,WAAYvrI,IA9BaomB,GACzD,CAAA,MAAqBsqC,EAAK26E,EAAAA,UAAUnsI,QAEpCyR,GAAIi7H,GAAgB/G,GAAG,EAGrB,CAFAn0E,GAAK26E,EAAAA,UAAU7yH,OAAqBqsH,EAEN,GAAA,IAArBwG,EAAAA,UAAUtsI,OAEjB,CAAsB,GAAA,MAAbusI,EAAAA,WAAwC,MAAdC,EAAAA,WACjC,OAAO,KACoB,GAAA,MAAbD,EAAAA,UACd,OAAYC,EAAAA,WACgB,GAAA,MAAdA,EAAAA,WACd,OAAYD,EAAAA,UAGd,MAAa79H,EAAAA,KAAKo+H,aAAkBN,EAAAA,mBAC/BO,EAAAA,OAAYV,EAAAA,UACZW,EAAAA,QAAaV,EAAAA,WACbK,EAAAA,SAASj+H,KAAKu+H,SAAcT,EAAAA,WAAYhoH,IAI7C6C,SAUNA,UAAO,KAID4lH,SAAkChsI,EACxC2Q,GAAA,MAAmB3Q,EAAQorI,EAAAA,SACf,GAAA,MACVhlH,EAAA,OAAO,KACE6lH,GAAAA,IAAoBb,EAAAA,SAE7B,CAAsB,GAAA,MAAbE,EAAAA,WAAwC,MAAdC,EAAAA,WACjC,OAAO,KACoB,GAAA,MAAbD,EAAAA,UACd,OAAYC,EAAAA,WACgB,GAAA,MAAdA,EAAAA,WACd,OAAYD,EAAAA,UAGd,MAAa79H,EAAAA,KAAKo+H,aAAkBN,EAAAA,mBAC/BO,EAAAA,OAAYV,EAAAA,UACZW,EAAAA,QAAaV,EAAAA,WAEbK,EAAAA,SAASj+H,KAAKu+H,SAAcT,EAAAA,WAAYhoH,IAExC6C,SAAYglH,EAAAA,SAAgBA,EAAAA,UAC5BK,EAAAA,QAAQh+H,KAAKu+H,SAAcV,EAAAA,UAAWtrI,IACpC0wD,IAEFg7E,EAAAA,SAASj+H,KAAKu+H,SAAcT,EAAAA,WAAYvrI,IAKzComB,GAAAylH,aACNzlH,GAAA,IAAcsqC,EACdtqC,OAA4B,MAAbklH,EAAAA,WACH/3F,EAAQ+3F,EAAAA,iBAKfY,EAAAz9H,OACL,MAAgB09H,EAAA,IAAI/0H,kBACfg1H,MAAM3+H,KAAK09H,MACTxjH,GAGDwkH,EAAAC,MAAmCzkH,EACzBhX,GAAA,MAAZ07H,IACF5+H,KAAK2+H,MAAed,EAAAA,UACpBe,GAAShB,EAAAA,UAAU9sH,SAASve,IAClBS,EAAAA,KAAKT,MAEfyN,KAAK2+H,MAAeb,EAAAA,WAAY5jH,MA/KfojH,GAAAuB,GADtB7sH,CAAU5J,EAAAA,CAAAA,QAAS,uCAAwC6J,gBAAiB,gCAChE6sH,IAyLb,IAAAC,GAAA,kBAM2BzkI,EAAgB7H,EAAyBC,EAChEsN,QAAKkjF,KACLljF,EAAAA,KAAKg/H,MACLh/H,EAAAA,KAAKi/H,MACLj/H,EAAAA,KAAKk/H,OAGApK,EAAA6I,qBACOz6C,KAGPm7C,OACLr+H,QAAKkjF,KAGAvqE,EAAAilH,sBACOoB,MAGPV,QACLt+H,QAAKg/H,MAGArmH,EAAAklH,sBACOoB,MAGPjB,QACLh+H,QAAKi/H,MAGAtmH,EAAAmlH,uBACOoB,OAGPjB,SACLj+H,QAAKk/H,OAASxsI,IA1CSqsI,GAAAF,GAD1B7sH,CAAU5J,EAAAA,CAAAA,QAAS,0CACP+2H,UAuDXC,eAFQC,QAAAn8C,KAGNljF,EAAAA,KAAKkjF,KAGAm8C,EAAAC,wBACOp8C,KAGPm7C,OACLr+H,QAAKkjF,YCxPGq8C,MACVC,IAAAA,GADUD,KAAYE,GAAA,KACtBD,GAAAE,SAAA,GAAA,WACAF,GAAAA,GAAAG,SAAA,GAAA,WACAH,GAAAA,GAAAI,QAAA,GAAA,UA6BF,IAAoBC,GAApBC,GAAA,yBACUjnB,OAAoC+mB,GAAAA,QAEpC5/H,KAAA+/H,kBAA4C,GAAA//H,KAC5CggI,gBAAwC,sBAa9CrnH,cAFoBmnH,IAAan7H,QAU5BgU,iBAGLA,cAFoBmnH,IAAal7H,OAmB5B+T,iBACL,IAA6BsnH,EAAA,GAEzB1sI,GAAAA,UAAUjC,OAAS,IAAMqY,MAAMu2H,QAAQ3sI,UAAU,IACnD,IAAK,IAAS4sI,EAAGx+H,EAAKpO,EAAAA,UAAUjC,OAAQqQ,IAC7BA,EAAKw+H,EAAK5sI,GAAAA,UAAUoO,QAED,IAArBpO,UAAUjC,QAAgBqY,MAAMu2H,QAAQ3sI,UAAU,MAChDA,EAAAA,UAAU,IAGvB,MAAsB6sI,EAAA,IACtBN,GAAA,IAAKO,IAAsB/uI,EAAAA,OACzB,OAAqBqT,EAAAA,UAGvB,MAAc07H,EAAS/uI,EAAAA,OACvB,IAAgBgqI,EACZgF,EAAU/E,EACd,EAAA,MAAoBE,EAAA,UAEX3qH,EAAAA,SAASlL,IACd4e,EAAAA,MACA,KACe82G,GACTiF,EAAAA,IACFC,EAAc77H,EAAAA,UACO27H,EAAUG,EAAOnvI,EAAAA,SACtCkvI,GAAc57H,EAAAA,OAAO67H,MAGzB,KACalF,GACPgF,EAAYD,EAAUG,EAAOnvI,EAAAA,SAC/BkvI,GAAc57H,EAAAA,OAAO67H,MAGzB/sI,OAAOwP,IACAlQ,EAAAA,KACHytI,GAAOnvI,EAAAA,OAAqBgvI,EAAAA,IAC9BE,GAAc57H,EAAAA,OAAO67H,SActBL,EAAA57G,KAA2Ck8G,EAChDx9H,GAAIy9H,GAAAA,IACF3gI,KAAK+/H,kBAAkB/sI,KAGnBgN,GAAAA,KAAKxG,UAAyBkmI,GAAAA,UAChC,IACkB7tI,EAAAA,KAAKmO,KAAAA,KAAWorH,QAChC,MACAprH,QAAK4gI,aAIXC,GAAIH,GAAAA,IACF1gI,KAAKggI,gBAGDhgI,EAAAA,KAAKxG,UAAyBmmI,GAAAA,UAChC,IACiB9tI,EAAAA,KAAKmO,KAAAA,KAAWorH,QAC/B,MACAprH,QAAK4gI,aAKXC,eAQKntI,MAILilB,UAHImoH,IACF9gI,KAAK+gI,eAEA/gI,GAAAA,KAQF2E,QACLgU,GAAI3Y,GAWIA,KAXC64G,SAAwB+mB,GAAAA,QAW/B,MAAM,IAAIl6H,MAAM,iEAVX0lH,OACLzyG,WACOkgG,OAAsB6mB,GAAAA,SAC3B1/H,KAAK+/H,kBAAkBjvH,SAAS2uC,IAC3B5tD,EAAAA,KAAKmO,KAAAA,KAAWorH,WAErB,MACAprH,QAAK4gI,aAKTI,eAQKp8H,OACL+T,GAAI3Y,GASIA,KATC64G,SAAwB+mB,GAAAA,QAS/B,MAAM,IAAIl6H,MAAM,gEARX0lH,OACLzyG,WACOkgG,OAAsB8mB,GAAAA,SAC3B3/H,KAAKggI,gBAAgBnuI,KAAKmO,KAAAA,KAAWorH,QACrC,MACAprH,QAAK4gI,aAKTK,eAOKznI,oBACOq/G,OAGN+nB,aACNjoH,GAAA,IACE3Y,KADO+gI,eAIP,MAHA/gI,OAAK+gI,eAAelvI,KAAKmO,KAAMkD,KAhMjB28H,GAAAC,sUAAAoB,CAJnBlvH,CACC5J,EAAAA,CAAAA,QAAS,uEACT6J,gBAAiB,iCAEN4tH,ICpCN,MAAmBsB,GAAA,2BAE1Bx9H,Q3PIAy9H,wBATWlxI,EAAAA,QACTD,EAAAA,QAAiBJ,IAAAA,mBACHwxI,QAAyBA,OAAOC,IAC9CD,OAAAA,GAAWxxI,GAAAA,iBACGK,EAAAA,QACdA,EAAAA,QAAY6rB,GAAIlsB,IAEhBD,EAASmsB,GAAIlsB","sources":["node_modules/excalibur/build/dist/webpack:/ex/webpack/universalModuleDefinition","node_modules/excalibur/build/dist/webpack:/node_modules/core-js/es/array/sort.js","node_modules/excalibur/build/dist/webpack:/node_modules/core-js/es/object/keys.js","node_modules/excalibur/build/dist/webpack:/node_modules/core-js/internals/a-callable.js","node_modules/excalibur/build/dist/webpack:/node_modules/core-js/internals/an-object.js","node_modules/excalibur/build/dist/webpack:/node_modules/core-js/internals/array-includes.js","node_modules/excalibur/build/dist/webpack:/node_modules/core-js/internals/array-method-is-strict.js","node_modules/excalibur/build/dist/webpack:/node_modules/core-js/internals/array-sort.js","node_modules/excalibur/build/dist/webpack:/node_modules/core-js/internals/classof-raw.js","node_modules/excalibur/build/dist/webpack:/node_modules/core-js/internals/classof.js","node_modules/excalibur/build/dist/webpack:/node_modules/core-js/internals/copy-constructor-properties.js","node_modules/excalibur/build/dist/webpack:/node_modules/core-js/internals/create-non-enumerable-property.js","node_modules/excalibur/build/dist/webpack:/node_modules/core-js/internals/create-property-descriptor.js","node_modules/excalibur/build/dist/webpack:/node_modules/core-js/internals/descriptors.js","node_modules/excalibur/build/dist/webpack:/node_modules/core-js/internals/document-create-element.js","node_modules/excalibur/build/dist/webpack:/node_modules/core-js/internals/engine-ff-version.js","node_modules/excalibur/build/dist/webpack:/node_modules/core-js/internals/engine-is-ie-or-edge.js","node_modules/excalibur/build/dist/webpack:/node_modules/core-js/internals/engine-user-agent.js","node_modules/excalibur/build/dist/webpack:/node_modules/core-js/internals/engine-v8-version.js","node_modules/excalibur/build/dist/webpack:/node_modules/core-js/internals/engine-webkit-version.js","node_modules/excalibur/build/dist/webpack:/node_modules/core-js/internals/entry-unbind.js","node_modules/excalibur/build/dist/webpack:/node_modules/core-js/internals/enum-bug-keys.js","node_modules/excalibur/build/dist/webpack:/node_modules/core-js/internals/export.js","node_modules/excalibur/build/dist/webpack:/node_modules/core-js/internals/fails.js","node_modules/excalibur/build/dist/webpack:/node_modules/core-js/internals/function-bind-context.js","node_modules/excalibur/build/dist/webpack:/node_modules/core-js/internals/function-name.js","node_modules/excalibur/build/dist/webpack:/node_modules/core-js/internals/get-built-in.js","node_modules/excalibur/build/dist/webpack:/node_modules/core-js/internals/get-method.js","node_modules/excalibur/build/dist/webpack:/node_modules/core-js/internals/global.js","node_modules/excalibur/build/dist/webpack:/node_modules/core-js/internals/has.js","node_modules/excalibur/build/dist/webpack:/node_modules/core-js/internals/hidden-keys.js","node_modules/excalibur/build/dist/webpack:/node_modules/core-js/internals/ie8-dom-define.js","node_modules/excalibur/build/dist/webpack:/node_modules/core-js/internals/indexed-object.js","node_modules/excalibur/build/dist/webpack:/node_modules/core-js/internals/inspect-source.js","node_modules/excalibur/build/dist/webpack:/node_modules/core-js/internals/internal-state.js","node_modules/excalibur/build/dist/webpack:/node_modules/core-js/internals/is-callable.js","node_modules/excalibur/build/dist/webpack:/node_modules/core-js/internals/is-forced.js","node_modules/excalibur/build/dist/webpack:/node_modules/core-js/internals/is-object.js","node_modules/excalibur/build/dist/webpack:/node_modules/core-js/internals/is-pure.js","node_modules/excalibur/build/dist/webpack:/node_modules/core-js/internals/is-symbol.js","node_modules/excalibur/build/dist/webpack:/node_modules/core-js/internals/native-symbol.js","node_modules/excalibur/build/dist/webpack:/node_modules/core-js/internals/native-weak-map.js","node_modules/excalibur/build/dist/webpack:/node_modules/core-js/internals/object-define-property.js","node_modules/excalibur/build/dist/webpack:/node_modules/core-js/internals/object-get-own-property-descriptor.js","node_modules/excalibur/build/dist/webpack:/node_modules/core-js/internals/object-get-own-property-names.js","node_modules/excalibur/build/dist/webpack:/node_modules/core-js/internals/object-get-own-property-symbols.js","node_modules/excalibur/build/dist/webpack:/node_modules/core-js/internals/object-keys-internal.js","node_modules/excalibur/build/dist/webpack:/node_modules/core-js/internals/object-keys.js","node_modules/excalibur/build/dist/webpack:/node_modules/core-js/internals/object-property-is-enumerable.js","node_modules/excalibur/build/dist/webpack:/node_modules/core-js/internals/ordinary-to-primitive.js","node_modules/excalibur/build/dist/webpack:/node_modules/core-js/internals/own-keys.js","node_modules/excalibur/build/dist/webpack:/node_modules/core-js/internals/path.js","node_modules/excalibur/build/dist/webpack:/node_modules/core-js/internals/redefine.js","node_modules/excalibur/build/dist/webpack:/node_modules/core-js/internals/require-object-coercible.js","node_modules/excalibur/build/dist/webpack:/node_modules/core-js/internals/set-global.js","node_modules/excalibur/build/dist/webpack:/node_modules/core-js/internals/shared-key.js","node_modules/excalibur/build/dist/webpack:/node_modules/core-js/internals/shared-store.js","node_modules/excalibur/build/dist/webpack:/node_modules/core-js/internals/shared.js","node_modules/excalibur/build/dist/webpack:/node_modules/core-js/internals/to-absolute-index.js","node_modules/excalibur/build/dist/webpack:/node_modules/core-js/internals/to-indexed-object.js","node_modules/excalibur/build/dist/webpack:/node_modules/core-js/internals/to-integer.js","node_modules/excalibur/build/dist/webpack:/node_modules/core-js/internals/to-length.js","node_modules/excalibur/build/dist/webpack:/node_modules/core-js/internals/to-object.js","node_modules/excalibur/build/dist/webpack:/node_modules/core-js/internals/to-primitive.js","node_modules/excalibur/build/dist/webpack:/node_modules/core-js/internals/to-property-key.js","node_modules/excalibur/build/dist/webpack:/node_modules/core-js/internals/to-string-tag-support.js","node_modules/excalibur/build/dist/webpack:/node_modules/core-js/internals/to-string.js","node_modules/excalibur/build/dist/webpack:/node_modules/core-js/internals/try-to-string.js","node_modules/excalibur/build/dist/webpack:/node_modules/core-js/internals/uid.js","node_modules/excalibur/build/dist/webpack:/node_modules/core-js/internals/use-symbol-as-uid.js","node_modules/excalibur/build/dist/webpack:/node_modules/core-js/internals/well-known-symbol.js","node_modules/excalibur/build/dist/webpack:/node_modules/core-js/modules/es.array.sort.js","node_modules/excalibur/build/dist/webpack:/node_modules/core-js/modules/es.object.keys.js","node_modules/excalibur/build/dist/webpack:/ex/Loader.css?0475","node_modules/excalibur/build/dist/webpack:/node_modules/css-loader/dist/runtime/api.js","node_modules/excalibur/build/dist/webpack:/node_modules/css-loader/dist/runtime/sourceMaps.js","node_modules/excalibur/build/dist/webpack:/ex/webpack/bootstrap","node_modules/excalibur/build/dist/webpack:/ex/webpack/runtime/compat get default export","node_modules/excalibur/build/dist/webpack:/ex/webpack/runtime/define property getters","node_modules/excalibur/build/dist/webpack:/ex/webpack/runtime/global","node_modules/excalibur/build/dist/webpack:/ex/webpack/runtime/hasOwnProperty shorthand","node_modules/excalibur/build/dist/webpack:/ex/webpack/runtime/make namespace object","node_modules/excalibur/build/dist/webpack:/ex/Flags.ts","node_modules/excalibur/build/dist/webpack:/ex/Util/Log.ts","node_modules/excalibur/build/dist/webpack:/ex/Collision/Side.ts","node_modules/excalibur/build/dist/webpack:/ex/Polyfill.ts","node_modules/excalibur/build/dist/webpack:/ex/Id.ts","node_modules/excalibur/build/dist/webpack:/ex/Math/Random.ts","node_modules/excalibur/build/dist/webpack:/ex/Util/Util.ts","node_modules/excalibur/build/dist/webpack:/ex/Util/Decorators.ts","node_modules/excalibur/build/dist/webpack:/ex/Math/vector.ts","node_modules/excalibur/build/dist/webpack:/ex/Screen.ts","node_modules/excalibur/build/dist/webpack:/ex/Events.ts","node_modules/excalibur/build/dist/webpack:/ex/Color.ts","node_modules/excalibur/build/dist/webpack:/ex/Collision/BoundingBox.ts","node_modules/excalibur/build/dist/webpack:/ex/Resources/Sound/AudioContext.ts","node_modules/excalibur/build/dist/webpack:/ex/Util/WebAudio.ts","node_modules/excalibur/build/dist/webpack:/ex/EventDispatcher.ts","node_modules/excalibur/build/dist/webpack:/ex/Class.ts","node_modules/excalibur/build/dist/webpack:/ex/Util/DrawUtil.ts","node_modules/excalibur/build/dist/webpack:/ex/Graphics/Graphic.ts","node_modules/excalibur/build/dist/webpack:/ex/Graphics/Context/webgl-util.ts","node_modules/excalibur/build/dist/webpack:/ex/Util/Watch.ts","node_modules/excalibur/build/dist/webpack:/ex/Graphics/Context/texture-loader.ts","node_modules/excalibur/build/dist/webpack:/ex/Graphics/Raster.ts","node_modules/excalibur/build/dist/webpack:/ex/Graphics/Canvas.ts","node_modules/excalibur/build/dist/webpack:/ex/Loader.ts","node_modules/excalibur/build/dist/webpack:/ex/Loader.logo.png?607f","node_modules/excalibur/build/dist/webpack:/ex/Util/Detector.ts","node_modules/excalibur/build/dist/webpack:/ex/Resources/Resource.ts","node_modules/excalibur/build/dist/webpack:/ex/Drawing/SpriteEffects.ts","node_modules/excalibur/build/dist/webpack:/ex/Configurable.ts","node_modules/excalibur/build/dist/webpack:/ex/Drawing/Sprite.ts","node_modules/excalibur/build/dist/webpack:/ex/Drawing/Texture.ts","node_modules/excalibur/build/dist/webpack:/ex/Drawing/Animation.ts","node_modules/excalibur/build/dist/webpack:/ex/Math/matrix.ts","node_modules/excalibur/build/dist/webpack:/ex/Actions/RotationType.ts","node_modules/excalibur/build/dist/webpack:/ex/Util/EasingFunctions.ts","node_modules/excalibur/build/dist/webpack:/ex/Actions/ActionQueue.ts","node_modules/excalibur/build/dist/webpack:/ex/Actions/Action/Repeat.ts","node_modules/excalibur/build/dist/webpack:/ex/Actions/Action/RepeatForever.ts","node_modules/excalibur/build/dist/webpack:/ex/Actions/Action/MoveBy.ts","node_modules/excalibur/build/dist/webpack:/ex/Actions/Action/MoveTo.ts","node_modules/excalibur/build/dist/webpack:/ex/Actions/Action/RotateTo.ts","node_modules/excalibur/build/dist/webpack:/ex/Actions/Action/RotateBy.ts","node_modules/excalibur/build/dist/webpack:/ex/EntityComponentSystem/Component.ts","node_modules/excalibur/build/dist/webpack:/ex/EntityComponentSystem/Components/MotionComponent.ts","node_modules/excalibur/build/dist/webpack:/ex/Math/vector-view.ts","node_modules/excalibur/build/dist/webpack:/ex/EntityComponentSystem/Components/TransformComponent.ts","node_modules/excalibur/build/dist/webpack:/ex/Collision/CollisionType.ts","node_modules/excalibur/build/dist/webpack:/ex/Collision/Physics.ts","node_modules/excalibur/build/dist/webpack:/ex/Actions/Action/ScaleTo.ts","node_modules/excalibur/build/dist/webpack:/ex/Actions/Action/ScaleBy.ts","node_modules/excalibur/build/dist/webpack:/ex/Actions/Action/CallMethod.ts","node_modules/excalibur/build/dist/webpack:/ex/Actions/Action/EaseTo.ts","node_modules/excalibur/build/dist/webpack:/ex/Actions/Action/Blink.ts","node_modules/excalibur/build/dist/webpack:/ex/Actions/Action/Fade.ts","node_modules/excalibur/build/dist/webpack:/ex/Actions/Action/Delay.ts","node_modules/excalibur/build/dist/webpack:/ex/Actions/Action/Die.ts","node_modules/excalibur/build/dist/webpack:/ex/Actions/Action/Follow.ts","node_modules/excalibur/build/dist/webpack:/ex/Actions/Action/Meet.ts","node_modules/excalibur/build/dist/webpack:/ex/Actions/ActionContext.ts","node_modules/excalibur/build/dist/webpack:/ex/Collision/Group/CollisionGroup.ts","node_modules/excalibur/build/dist/webpack:/ex/Util/Observable.ts","node_modules/excalibur/build/dist/webpack:/ex/Collision/Detection/Pair.ts","node_modules/excalibur/build/dist/webpack:/ex/Math/projection.ts","node_modules/excalibur/build/dist/webpack:/ex/Collision/Detection/DynamicTree.ts","node_modules/excalibur/build/dist/webpack:/ex/Math/ray.ts","node_modules/excalibur/build/dist/webpack:/ex/Collision/Detection/DynamicTreeCollisionProcessor.ts","node_modules/excalibur/build/dist/webpack:/ex/Collision/Colliders/Collider.ts","node_modules/excalibur/build/dist/webpack:/ex/Collision/Colliders/CompositeCollider.ts","node_modules/excalibur/build/dist/webpack:/ex/Math/line.ts","node_modules/excalibur/build/dist/webpack:/ex/Collision/Colliders/ClosestLineJumpTable.ts","node_modules/excalibur/build/dist/webpack:/ex/Collision/Colliders/CircleCollider.ts","node_modules/excalibur/build/dist/webpack:/ex/Collision/Detection/CollisionContact.ts","node_modules/excalibur/build/dist/webpack:/ex/Collision/Colliders/SeparatingAxis.ts","node_modules/excalibur/build/dist/webpack:/ex/Collision/Colliders/CollisionJumpTable.ts","node_modules/excalibur/build/dist/webpack:/ex/Collision/Colliders/EdgeCollider.ts","node_modules/excalibur/build/dist/webpack:/ex/Collision/Colliders/PolygonCollider.ts","node_modules/excalibur/build/dist/webpack:/ex/Collision/Colliders/Shape.ts","node_modules/excalibur/build/dist/webpack:/ex/Collision/ColliderComponent.ts","node_modules/excalibur/build/dist/webpack:/ex/Collision/BodyComponent.ts","node_modules/excalibur/build/dist/webpack:/ex/Util/CullingBox.ts","node_modules/excalibur/build/dist/webpack:/ex/Traits/OffscreenCulling.ts","node_modules/excalibur/build/dist/webpack:/ex/Traits/CapturePointer.ts","node_modules/excalibur/build/dist/webpack:/ex/EntityComponentSystem/Entity.ts","node_modules/excalibur/build/dist/webpack:/ex/Drawing/CanvasDrawComponent.ts","node_modules/excalibur/build/dist/webpack:/ex/Graphics/GraphicsComponent.ts","node_modules/excalibur/build/dist/webpack:/ex/Graphics/Rectangle.ts","node_modules/excalibur/build/dist/webpack:/ex/Graphics/Circle.ts","node_modules/excalibur/build/dist/webpack:/ex/Graphics/FontCommon.ts","node_modules/excalibur/build/dist/webpack:/ex/Actor.ts","node_modules/excalibur/build/dist/webpack:/ex/ScreenElement.ts","node_modules/excalibur/build/dist/webpack:/ex/Timer.ts","node_modules/excalibur/build/dist/webpack:/ex/Graphics/ImageSource.ts","node_modules/excalibur/build/dist/webpack:/ex/Graphics/Sprite.ts","node_modules/excalibur/build/dist/webpack:/ex/Drawing/SpriteSheet.ts","node_modules/excalibur/build/dist/webpack:/ex/Graphics/SpriteSheet.ts","node_modules/excalibur/build/dist/webpack:/ex/Camera.ts","node_modules/excalibur/build/dist/webpack:/ex/TileMap.ts","node_modules/excalibur/build/dist/webpack:/ex/Util/Actors.ts","node_modules/excalibur/build/dist/webpack:/ex/Trigger.ts","node_modules/excalibur/build/dist/webpack:/ex/EntityComponentSystem/System.ts","node_modules/excalibur/build/dist/webpack:/ex/EntityComponentSystem/EntityManager.ts","node_modules/excalibur/build/dist/webpack:/ex/EntityComponentSystem/Util.ts","node_modules/excalibur/build/dist/webpack:/ex/EntityComponentSystem/Query.ts","node_modules/excalibur/build/dist/webpack:/ex/EntityComponentSystem/QueryManager.ts","node_modules/excalibur/build/dist/webpack:/ex/EntityComponentSystem/SystemManager.ts","node_modules/excalibur/build/dist/webpack:/ex/EntityComponentSystem/World.ts","node_modules/excalibur/build/dist/webpack:/ex/Collision/Integrator.ts","node_modules/excalibur/build/dist/webpack:/ex/Collision/MotionSystem.ts","node_modules/excalibur/build/dist/webpack:/ex/Collision/Solver/Solver.ts","node_modules/excalibur/build/dist/webpack:/ex/Collision/Solver/ArcadeSolver.ts","node_modules/excalibur/build/dist/webpack:/ex/Collision/Solver/ContactConstraintPoint.ts","node_modules/excalibur/build/dist/webpack:/ex/Collision/Solver/RealisticSolver.ts","node_modules/excalibur/build/dist/webpack:/ex/Collision/CollisionSystem.ts","node_modules/excalibur/build/dist/webpack:/ex/Graphics/GraphicsDiagnostics.ts","node_modules/excalibur/build/dist/webpack:/ex/Graphics/Animation.ts","node_modules/excalibur/build/dist/webpack:/ex/Particles.ts","node_modules/excalibur/build/dist/webpack:/ex/Graphics/GraphicsGroup.ts","node_modules/excalibur/build/dist/webpack:/ex/Graphics/GraphicsSystem.ts","node_modules/excalibur/build/dist/webpack:/ex/Drawing/CanvasDrawingSystem.ts","node_modules/excalibur/build/dist/webpack:/ex/Debug/DebugSystem.ts","node_modules/excalibur/build/dist/webpack:/ex/Input/Keyboard.ts","node_modules/excalibur/build/dist/webpack:/ex/Input/Pointer.ts","node_modules/excalibur/build/dist/webpack:/ex/Input/PointerEvents.ts","node_modules/excalibur/build/dist/webpack:/ex/PostProcessing/ColorBlindCorrector.ts","node_modules/excalibur/build/dist/webpack:/ex/Input/Gamepad.ts","node_modules/excalibur/build/dist/webpack:/ex/Graphics/Context/draw-image-command.ts","node_modules/excalibur/build/dist/webpack:/ex/Scene.ts","node_modules/excalibur/build/dist/webpack:/ex/Debug/DebugFlags.ts","node_modules/excalibur/build/dist/webpack:/ex/Debug/Debug.ts","node_modules/excalibur/build/dist/webpack:/ex/Math/global-coordinates.ts","node_modules/excalibur/build/dist/webpack:/ex/Input/Pointers.ts","node_modules/excalibur/build/dist/webpack:/ex/Util/Browser.ts","node_modules/excalibur/build/dist/webpack:/ex/Graphics/Context/state-stack.ts","node_modules/excalibur/build/dist/webpack:/ex/Graphics/SpriteFont.ts","node_modules/excalibur/build/dist/webpack:/ex/Graphics/Context/debug-text.ts","node_modules/excalibur/build/dist/webpack:/ex/Graphics/Context/debug-font.png?1126","node_modules/excalibur/build/dist/webpack:/ex/Graphics/Context/ExcaliburGraphicsContext2DCanvas.ts","node_modules/excalibur/build/dist/webpack:/ex/Graphics/Context/transform-stack.ts","node_modules/excalibur/build/dist/webpack:/ex/Graphics/Context/shader.ts","node_modules/excalibur/build/dist/webpack:/ex/Graphics/Context/batch.ts","node_modules/excalibur/build/dist/webpack:/ex/Util/Pool.ts","node_modules/excalibur/build/dist/webpack:/ex/Graphics/Context/renderer.ts","node_modules/excalibur/build/dist/webpack:/ex/Graphics/Context/line-renderer.ts","node_modules/excalibur/build/dist/webpack:/ex/Graphics/Context/shaders/line-vertex.glsl?d00f","node_modules/excalibur/build/dist/webpack:/ex/Graphics/Context/shaders/line-fragment.glsl?0e66","node_modules/excalibur/build/dist/webpack:/ex/Graphics/Context/image-renderer.ts","node_modules/excalibur/build/dist/webpack:/ex/Graphics/Context/shaders/image-vertex.glsl?8c14","node_modules/excalibur/build/dist/webpack:/ex/Graphics/Context/shaders/image-fragment.glsl?bce2","node_modules/excalibur/build/dist/webpack:/ex/Graphics/Context/point-renderer.ts","node_modules/excalibur/build/dist/webpack:/ex/Graphics/Context/shaders/point-vertex.glsl?98ff","node_modules/excalibur/build/dist/webpack:/ex/Graphics/Context/shaders/point-fragment.glsl?befc","node_modules/excalibur/build/dist/webpack:/ex/Graphics/Context/ExcaliburGraphicsContextWebGL.ts","node_modules/excalibur/build/dist/webpack:/ex/Engine.ts","node_modules/excalibur/build/dist/webpack:/ex/Events/MediaEvents.ts","node_modules/excalibur/build/dist/webpack:/ex/Graphics/Font.ts","node_modules/excalibur/build/dist/webpack:/ex/Graphics/Text.ts","node_modules/excalibur/build/dist/webpack:/ex/Label.ts","node_modules/excalibur/build/dist/webpack:/ex/Collision/Group/CollisionGroupManager.ts","node_modules/excalibur/build/dist/webpack:/ex/Drawing/Polygon.ts","node_modules/excalibur/build/dist/webpack:/ex/Interfaces/AudioImplementation.ts","node_modules/excalibur/build/dist/webpack:/ex/Interfaces/LifecycleEvents.ts","node_modules/excalibur/build/dist/webpack:/ex/Resources/Sound/WebAudioInstance.ts","node_modules/excalibur/build/dist/webpack:/ex/Util/Sound.ts","node_modules/excalibur/build/dist/webpack:/ex/Resources/Sound/Sound.ts","node_modules/excalibur/build/dist/webpack:/ex/Resources/Gif.ts","node_modules/excalibur/build/dist/webpack:/ex/Graphics/Polygon.ts","node_modules/excalibur/build/dist/webpack:/ex/Util/SortedList.ts","node_modules/excalibur/build/dist/webpack:/ex/Promises.ts","node_modules/excalibur/build/dist/webpack:/ex/index.ts"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"ex\"] = factory();\n\telse\n\t\troot[\"ex\"] = factory();\n})(self, function() {\nreturn ","require('../../modules/es.array.sort');\nvar entryUnbind = require('../../internals/entry-unbind');\n\nmodule.exports = entryUnbind('Array', 'sort');\n","require('../../modules/es.object.keys');\nvar path = require('../../internals/path');\n\nmodule.exports = path.Object.keys;\n","var isCallable = require('../internals/is-callable');\nvar tryToString = require('../internals/try-to-string');\n\n// `Assert: IsCallable(argument) is true`\nmodule.exports = function (argument) {\n  if (isCallable(argument)) return argument;\n  throw TypeError(tryToString(argument) + ' is not a function');\n};\n","var isObject = require('../internals/is-object');\n\n// `Assert: Type(argument) is Object`\nmodule.exports = function (argument) {\n  if (isObject(argument)) return argument;\n  throw TypeError(String(argument) + ' is not an object');\n};\n","var toIndexedObject = require('../internals/to-indexed-object');\nvar toLength = require('../internals/to-length');\nvar toAbsoluteIndex = require('../internals/to-absolute-index');\n\n// `Array.prototype.{ indexOf, includes }` methods implementation\nvar createMethod = function (IS_INCLUDES) {\n  return function ($this, el, fromIndex) {\n    var O = toIndexedObject($this);\n    var length = toLength(O.length);\n    var index = toAbsoluteIndex(fromIndex, length);\n    var value;\n    // Array#includes uses SameValueZero equality algorithm\n    // eslint-disable-next-line no-self-compare -- NaN check\n    if (IS_INCLUDES && el != el) while (length > index) {\n      value = O[index++];\n      // eslint-disable-next-line no-self-compare -- NaN check\n      if (value != value) return true;\n    // Array#indexOf ignores holes, Array#includes - not\n    } else for (;length > index; index++) {\n      if ((IS_INCLUDES || index in O) && O[index] === el) return IS_INCLUDES || index || 0;\n    } return !IS_INCLUDES && -1;\n  };\n};\n\nmodule.exports = {\n  // `Array.prototype.includes` method\n  // https://tc39.es/ecma262/#sec-array.prototype.includes\n  includes: createMethod(true),\n  // `Array.prototype.indexOf` method\n  // https://tc39.es/ecma262/#sec-array.prototype.indexof\n  indexOf: createMethod(false)\n};\n","'use strict';\nvar fails = require('../internals/fails');\n\nmodule.exports = function (METHOD_NAME, argument) {\n  var method = [][METHOD_NAME];\n  return !!method && fails(function () {\n    // eslint-disable-next-line no-useless-call,no-throw-literal -- required for testing\n    method.call(null, argument || function () { throw 1; }, 1);\n  });\n};\n","// TODO: use something more complex like timsort?\nvar floor = Math.floor;\n\nvar mergeSort = function (array, comparefn) {\n  var length = array.length;\n  var middle = floor(length / 2);\n  return length < 8 ? insertionSort(array, comparefn) : merge(\n    mergeSort(array.slice(0, middle), comparefn),\n    mergeSort(array.slice(middle), comparefn),\n    comparefn\n  );\n};\n\nvar insertionSort = function (array, comparefn) {\n  var length = array.length;\n  var i = 1;\n  var element, j;\n\n  while (i < length) {\n    j = i;\n    element = array[i];\n    while (j && comparefn(array[j - 1], element) > 0) {\n      array[j] = array[--j];\n    }\n    if (j !== i++) array[j] = element;\n  } return array;\n};\n\nvar merge = function (left, right, comparefn) {\n  var llength = left.length;\n  var rlength = right.length;\n  var lindex = 0;\n  var rindex = 0;\n  var result = [];\n\n  while (lindex < llength || rindex < rlength) {\n    if (lindex < llength && rindex < rlength) {\n      result.push(comparefn(left[lindex], right[rindex]) <= 0 ? left[lindex++] : right[rindex++]);\n    } else {\n      result.push(lindex < llength ? left[lindex++] : right[rindex++]);\n    }\n  } return result;\n};\n\nmodule.exports = mergeSort;\n","var toString = {}.toString;\n\nmodule.exports = function (it) {\n  return toString.call(it).slice(8, -1);\n};\n","var TO_STRING_TAG_SUPPORT = require('../internals/to-string-tag-support');\nvar isCallable = require('../internals/is-callable');\nvar classofRaw = require('../internals/classof-raw');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\n\nvar TO_STRING_TAG = wellKnownSymbol('toStringTag');\n// ES3 wrong here\nvar CORRECT_ARGUMENTS = classofRaw(function () { return arguments; }()) == 'Arguments';\n\n// fallback for IE11 Script Access Denied error\nvar tryGet = function (it, key) {\n  try {\n    return it[key];\n  } catch (error) { /* empty */ }\n};\n\n// getting tag from ES6+ `Object.prototype.toString`\nmodule.exports = TO_STRING_TAG_SUPPORT ? classofRaw : function (it) {\n  var O, tag, result;\n  return it === undefined ? 'Undefined' : it === null ? 'Null'\n    // @@toStringTag case\n    : typeof (tag = tryGet(O = Object(it), TO_STRING_TAG)) == 'string' ? tag\n    // builtinTag case\n    : CORRECT_ARGUMENTS ? classofRaw(O)\n    // ES3 arguments fallback\n    : (result = classofRaw(O)) == 'Object' && isCallable(O.callee) ? 'Arguments' : result;\n};\n","var has = require('../internals/has');\nvar ownKeys = require('../internals/own-keys');\nvar getOwnPropertyDescriptorModule = require('../internals/object-get-own-property-descriptor');\nvar definePropertyModule = require('../internals/object-define-property');\n\nmodule.exports = function (target, source) {\n  var keys = ownKeys(source);\n  var defineProperty = definePropertyModule.f;\n  var getOwnPropertyDescriptor = getOwnPropertyDescriptorModule.f;\n  for (var i = 0; i < keys.length; i++) {\n    var key = keys[i];\n    if (!has(target, key)) defineProperty(target, key, getOwnPropertyDescriptor(source, key));\n  }\n};\n","var DESCRIPTORS = require('../internals/descriptors');\nvar definePropertyModule = require('../internals/object-define-property');\nvar createPropertyDescriptor = require('../internals/create-property-descriptor');\n\nmodule.exports = DESCRIPTORS ? function (object, key, value) {\n  return definePropertyModule.f(object, key, createPropertyDescriptor(1, value));\n} : function (object, key, value) {\n  object[key] = value;\n  return object;\n};\n","module.exports = function (bitmap, value) {\n  return {\n    enumerable: !(bitmap & 1),\n    configurable: !(bitmap & 2),\n    writable: !(bitmap & 4),\n    value: value\n  };\n};\n","var fails = require('../internals/fails');\n\n// Detect IE8's incomplete defineProperty implementation\nmodule.exports = !fails(function () {\n  // eslint-disable-next-line es/no-object-defineproperty -- required for testing\n  return Object.defineProperty({}, 1, { get: function () { return 7; } })[1] != 7;\n});\n","var global = require('../internals/global');\nvar isObject = require('../internals/is-object');\n\nvar document = global.document;\n// typeof document.createElement is 'object' in old IE\nvar EXISTS = isObject(document) && isObject(document.createElement);\n\nmodule.exports = function (it) {\n  return EXISTS ? document.createElement(it) : {};\n};\n","var userAgent = require('../internals/engine-user-agent');\n\nvar firefox = userAgent.match(/firefox\\/(\\d+)/i);\n\nmodule.exports = !!firefox && +firefox[1];\n","var UA = require('../internals/engine-user-agent');\n\nmodule.exports = /MSIE|Trident/.test(UA);\n","var getBuiltIn = require('../internals/get-built-in');\n\nmodule.exports = getBuiltIn('navigator', 'userAgent') || '';\n","var global = require('../internals/global');\nvar userAgent = require('../internals/engine-user-agent');\n\nvar process = global.process;\nvar Deno = global.Deno;\nvar versions = process && process.versions || Deno && Deno.version;\nvar v8 = versions && versions.v8;\nvar match, version;\n\nif (v8) {\n  match = v8.split('.');\n  version = match[0] < 4 ? 1 : match[0] + match[1];\n} else if (userAgent) {\n  match = userAgent.match(/Edge\\/(\\d+)/);\n  if (!match || match[1] >= 74) {\n    match = userAgent.match(/Chrome\\/(\\d+)/);\n    if (match) version = match[1];\n  }\n}\n\nmodule.exports = version && +version;\n","var userAgent = require('../internals/engine-user-agent');\n\nvar webkit = userAgent.match(/AppleWebKit\\/(\\d+)\\./);\n\nmodule.exports = !!webkit && +webkit[1];\n","var global = require('../internals/global');\nvar bind = require('../internals/function-bind-context');\n\nvar call = Function.call;\n\nmodule.exports = function (CONSTRUCTOR, METHOD, length) {\n  return bind(call, global[CONSTRUCTOR].prototype[METHOD], length);\n};\n","// IE8- don't enum bug keys\nmodule.exports = [\n  'constructor',\n  'hasOwnProperty',\n  'isPrototypeOf',\n  'propertyIsEnumerable',\n  'toLocaleString',\n  'toString',\n  'valueOf'\n];\n","var global = require('../internals/global');\nvar getOwnPropertyDescriptor = require('../internals/object-get-own-property-descriptor').f;\nvar createNonEnumerableProperty = require('../internals/create-non-enumerable-property');\nvar redefine = require('../internals/redefine');\nvar setGlobal = require('../internals/set-global');\nvar copyConstructorProperties = require('../internals/copy-constructor-properties');\nvar isForced = require('../internals/is-forced');\n\n/*\n  options.target      - name of the target object\n  options.global      - target is the global object\n  options.stat        - export as static methods of target\n  options.proto       - export as prototype methods of target\n  options.real        - real prototype method for the `pure` version\n  options.forced      - export even if the native feature is available\n  options.bind        - bind methods to the target, required for the `pure` version\n  options.wrap        - wrap constructors to preventing global pollution, required for the `pure` version\n  options.unsafe      - use the simple assignment of property instead of delete + defineProperty\n  options.sham        - add a flag to not completely full polyfills\n  options.enumerable  - export as enumerable property\n  options.noTargetGet - prevent calling a getter on target\n  options.name        - the .name of the function if it does not match the key\n*/\nmodule.exports = function (options, source) {\n  var TARGET = options.target;\n  var GLOBAL = options.global;\n  var STATIC = options.stat;\n  var FORCED, target, key, targetProperty, sourceProperty, descriptor;\n  if (GLOBAL) {\n    target = global;\n  } else if (STATIC) {\n    target = global[TARGET] || setGlobal(TARGET, {});\n  } else {\n    target = (global[TARGET] || {}).prototype;\n  }\n  if (target) for (key in source) {\n    sourceProperty = source[key];\n    if (options.noTargetGet) {\n      descriptor = getOwnPropertyDescriptor(target, key);\n      targetProperty = descriptor && descriptor.value;\n    } else targetProperty = target[key];\n    FORCED = isForced(GLOBAL ? key : TARGET + (STATIC ? '.' : '#') + key, options.forced);\n    // contained in target\n    if (!FORCED && targetProperty !== undefined) {\n      if (typeof sourceProperty === typeof targetProperty) continue;\n      copyConstructorProperties(sourceProperty, targetProperty);\n    }\n    // add a flag to not completely full polyfills\n    if (options.sham || (targetProperty && targetProperty.sham)) {\n      createNonEnumerableProperty(sourceProperty, 'sham', true);\n    }\n    // extend global\n    redefine(target, key, sourceProperty, options);\n  }\n};\n","module.exports = function (exec) {\n  try {\n    return !!exec();\n  } catch (error) {\n    return true;\n  }\n};\n","var aCallable = require('../internals/a-callable');\n\n// optional / simple context binding\nmodule.exports = function (fn, that, length) {\n  aCallable(fn);\n  if (that === undefined) return fn;\n  switch (length) {\n    case 0: return function () {\n      return fn.call(that);\n    };\n    case 1: return function (a) {\n      return fn.call(that, a);\n    };\n    case 2: return function (a, b) {\n      return fn.call(that, a, b);\n    };\n    case 3: return function (a, b, c) {\n      return fn.call(that, a, b, c);\n    };\n  }\n  return function (/* ...args */) {\n    return fn.apply(that, arguments);\n  };\n};\n","var DESCRIPTORS = require('../internals/descriptors');\nvar has = require('../internals/has');\n\nvar FunctionPrototype = Function.prototype;\n// eslint-disable-next-line es/no-object-getownpropertydescriptor -- safe\nvar getDescriptor = DESCRIPTORS && Object.getOwnPropertyDescriptor;\n\nvar EXISTS = has(FunctionPrototype, 'name');\n// additional protection from minified / mangled / dropped function names\nvar PROPER = EXISTS && (function something() { /* empty */ }).name === 'something';\nvar CONFIGURABLE = EXISTS && (!DESCRIPTORS || (DESCRIPTORS && getDescriptor(FunctionPrototype, 'name').configurable));\n\nmodule.exports = {\n  EXISTS: EXISTS,\n  PROPER: PROPER,\n  CONFIGURABLE: CONFIGURABLE\n};\n","var global = require('../internals/global');\nvar isCallable = require('../internals/is-callable');\n\nvar aFunction = function (argument) {\n  return isCallable(argument) ? argument : undefined;\n};\n\nmodule.exports = function (namespace, method) {\n  return arguments.length < 2 ? aFunction(global[namespace]) : global[namespace] && global[namespace][method];\n};\n","var aCallable = require('../internals/a-callable');\n\n// `GetMethod` abstract operation\n// https://tc39.es/ecma262/#sec-getmethod\nmodule.exports = function (V, P) {\n  var func = V[P];\n  return func == null ? undefined : aCallable(func);\n};\n","var check = function (it) {\n  return it && it.Math == Math && it;\n};\n\n// https://github.com/zloirock/core-js/issues/86#issuecomment-115759028\nmodule.exports =\n  // eslint-disable-next-line es/no-global-this -- safe\n  check(typeof globalThis == 'object' && globalThis) ||\n  check(typeof window == 'object' && window) ||\n  // eslint-disable-next-line no-restricted-globals -- safe\n  check(typeof self == 'object' && self) ||\n  check(typeof global == 'object' && global) ||\n  // eslint-disable-next-line no-new-func -- fallback\n  (function () { return this; })() || Function('return this')();\n","var toObject = require('../internals/to-object');\n\nvar hasOwnProperty = {}.hasOwnProperty;\n\nmodule.exports = Object.hasOwn || function hasOwn(it, key) {\n  return hasOwnProperty.call(toObject(it), key);\n};\n","module.exports = {};\n","var DESCRIPTORS = require('../internals/descriptors');\nvar fails = require('../internals/fails');\nvar createElement = require('../internals/document-create-element');\n\n// Thank's IE8 for his funny defineProperty\nmodule.exports = !DESCRIPTORS && !fails(function () {\n  // eslint-disable-next-line es/no-object-defineproperty -- requied for testing\n  return Object.defineProperty(createElement('div'), 'a', {\n    get: function () { return 7; }\n  }).a != 7;\n});\n","var fails = require('../internals/fails');\nvar classof = require('../internals/classof-raw');\n\nvar split = ''.split;\n\n// fallback for non-array-like ES3 and non-enumerable old V8 strings\nmodule.exports = fails(function () {\n  // throws an error in rhino, see https://github.com/mozilla/rhino/issues/346\n  // eslint-disable-next-line no-prototype-builtins -- safe\n  return !Object('z').propertyIsEnumerable(0);\n}) ? function (it) {\n  return classof(it) == 'String' ? split.call(it, '') : Object(it);\n} : Object;\n","var isCallable = require('../internals/is-callable');\nvar store = require('../internals/shared-store');\n\nvar functionToString = Function.toString;\n\n// this helper broken in `core-js@3.4.1-3.4.4`, so we can't use `shared` helper\nif (!isCallable(store.inspectSource)) {\n  store.inspectSource = function (it) {\n    return functionToString.call(it);\n  };\n}\n\nmodule.exports = store.inspectSource;\n","var NATIVE_WEAK_MAP = require('../internals/native-weak-map');\nvar global = require('../internals/global');\nvar isObject = require('../internals/is-object');\nvar createNonEnumerableProperty = require('../internals/create-non-enumerable-property');\nvar objectHas = require('../internals/has');\nvar shared = require('../internals/shared-store');\nvar sharedKey = require('../internals/shared-key');\nvar hiddenKeys = require('../internals/hidden-keys');\n\nvar OBJECT_ALREADY_INITIALIZED = 'Object already initialized';\nvar WeakMap = global.WeakMap;\nvar set, get, has;\n\nvar enforce = function (it) {\n  return has(it) ? get(it) : set(it, {});\n};\n\nvar getterFor = function (TYPE) {\n  return function (it) {\n    var state;\n    if (!isObject(it) || (state = get(it)).type !== TYPE) {\n      throw TypeError('Incompatible receiver, ' + TYPE + ' required');\n    } return state;\n  };\n};\n\nif (NATIVE_WEAK_MAP || shared.state) {\n  var store = shared.state || (shared.state = new WeakMap());\n  var wmget = store.get;\n  var wmhas = store.has;\n  var wmset = store.set;\n  set = function (it, metadata) {\n    if (wmhas.call(store, it)) throw new TypeError(OBJECT_ALREADY_INITIALIZED);\n    metadata.facade = it;\n    wmset.call(store, it, metadata);\n    return metadata;\n  };\n  get = function (it) {\n    return wmget.call(store, it) || {};\n  };\n  has = function (it) {\n    return wmhas.call(store, it);\n  };\n} else {\n  var STATE = sharedKey('state');\n  hiddenKeys[STATE] = true;\n  set = function (it, metadata) {\n    if (objectHas(it, STATE)) throw new TypeError(OBJECT_ALREADY_INITIALIZED);\n    metadata.facade = it;\n    createNonEnumerableProperty(it, STATE, metadata);\n    return metadata;\n  };\n  get = function (it) {\n    return objectHas(it, STATE) ? it[STATE] : {};\n  };\n  has = function (it) {\n    return objectHas(it, STATE);\n  };\n}\n\nmodule.exports = {\n  set: set,\n  get: get,\n  has: has,\n  enforce: enforce,\n  getterFor: getterFor\n};\n","// `IsCallable` abstract operation\n// https://tc39.es/ecma262/#sec-iscallable\nmodule.exports = function (argument) {\n  return typeof argument === 'function';\n};\n","var fails = require('../internals/fails');\nvar isCallable = require('../internals/is-callable');\n\nvar replacement = /#|\\.prototype\\./;\n\nvar isForced = function (feature, detection) {\n  var value = data[normalize(feature)];\n  return value == POLYFILL ? true\n    : value == NATIVE ? false\n    : isCallable(detection) ? fails(detection)\n    : !!detection;\n};\n\nvar normalize = isForced.normalize = function (string) {\n  return String(string).replace(replacement, '.').toLowerCase();\n};\n\nvar data = isForced.data = {};\nvar NATIVE = isForced.NATIVE = 'N';\nvar POLYFILL = isForced.POLYFILL = 'P';\n\nmodule.exports = isForced;\n","var isCallable = require('../internals/is-callable');\n\nmodule.exports = function (it) {\n  return typeof it === 'object' ? it !== null : isCallable(it);\n};\n","module.exports = false;\n","var isCallable = require('../internals/is-callable');\nvar getBuiltIn = require('../internals/get-built-in');\nvar USE_SYMBOL_AS_UID = require('../internals/use-symbol-as-uid');\n\nmodule.exports = USE_SYMBOL_AS_UID ? function (it) {\n  return typeof it == 'symbol';\n} : function (it) {\n  var $Symbol = getBuiltIn('Symbol');\n  return isCallable($Symbol) && Object(it) instanceof $Symbol;\n};\n","/* eslint-disable es/no-symbol -- required for testing */\nvar V8_VERSION = require('../internals/engine-v8-version');\nvar fails = require('../internals/fails');\n\n// eslint-disable-next-line es/no-object-getownpropertysymbols -- required for testing\nmodule.exports = !!Object.getOwnPropertySymbols && !fails(function () {\n  var symbol = Symbol();\n  // Chrome 38 Symbol has incorrect toString conversion\n  // `get-own-property-symbols` polyfill symbols converted to object are not Symbol instances\n  return !String(symbol) || !(Object(symbol) instanceof Symbol) ||\n    // Chrome 38-40 symbols are not inherited from DOM collections prototypes to instances\n    !Symbol.sham && V8_VERSION && V8_VERSION < 41;\n});\n","var global = require('../internals/global');\nvar isCallable = require('../internals/is-callable');\nvar inspectSource = require('../internals/inspect-source');\n\nvar WeakMap = global.WeakMap;\n\nmodule.exports = isCallable(WeakMap) && /native code/.test(inspectSource(WeakMap));\n","var DESCRIPTORS = require('../internals/descriptors');\nvar IE8_DOM_DEFINE = require('../internals/ie8-dom-define');\nvar anObject = require('../internals/an-object');\nvar toPropertyKey = require('../internals/to-property-key');\n\n// eslint-disable-next-line es/no-object-defineproperty -- safe\nvar $defineProperty = Object.defineProperty;\n\n// `Object.defineProperty` method\n// https://tc39.es/ecma262/#sec-object.defineproperty\nexports.f = DESCRIPTORS ? $defineProperty : function defineProperty(O, P, Attributes) {\n  anObject(O);\n  P = toPropertyKey(P);\n  anObject(Attributes);\n  if (IE8_DOM_DEFINE) try {\n    return $defineProperty(O, P, Attributes);\n  } catch (error) { /* empty */ }\n  if ('get' in Attributes || 'set' in Attributes) throw TypeError('Accessors not supported');\n  if ('value' in Attributes) O[P] = Attributes.value;\n  return O;\n};\n","var DESCRIPTORS = require('../internals/descriptors');\nvar propertyIsEnumerableModule = require('../internals/object-property-is-enumerable');\nvar createPropertyDescriptor = require('../internals/create-property-descriptor');\nvar toIndexedObject = require('../internals/to-indexed-object');\nvar toPropertyKey = require('../internals/to-property-key');\nvar has = require('../internals/has');\nvar IE8_DOM_DEFINE = require('../internals/ie8-dom-define');\n\n// eslint-disable-next-line es/no-object-getownpropertydescriptor -- safe\nvar $getOwnPropertyDescriptor = Object.getOwnPropertyDescriptor;\n\n// `Object.getOwnPropertyDescriptor` method\n// https://tc39.es/ecma262/#sec-object.getownpropertydescriptor\nexports.f = DESCRIPTORS ? $getOwnPropertyDescriptor : function getOwnPropertyDescriptor(O, P) {\n  O = toIndexedObject(O);\n  P = toPropertyKey(P);\n  if (IE8_DOM_DEFINE) try {\n    return $getOwnPropertyDescriptor(O, P);\n  } catch (error) { /* empty */ }\n  if (has(O, P)) return createPropertyDescriptor(!propertyIsEnumerableModule.f.call(O, P), O[P]);\n};\n","var internalObjectKeys = require('../internals/object-keys-internal');\nvar enumBugKeys = require('../internals/enum-bug-keys');\n\nvar hiddenKeys = enumBugKeys.concat('length', 'prototype');\n\n// `Object.getOwnPropertyNames` method\n// https://tc39.es/ecma262/#sec-object.getownpropertynames\n// eslint-disable-next-line es/no-object-getownpropertynames -- safe\nexports.f = Object.getOwnPropertyNames || function getOwnPropertyNames(O) {\n  return internalObjectKeys(O, hiddenKeys);\n};\n","// eslint-disable-next-line es/no-object-getownpropertysymbols -- safe\nexports.f = Object.getOwnPropertySymbols;\n","var has = require('../internals/has');\nvar toIndexedObject = require('../internals/to-indexed-object');\nvar indexOf = require('../internals/array-includes').indexOf;\nvar hiddenKeys = require('../internals/hidden-keys');\n\nmodule.exports = function (object, names) {\n  var O = toIndexedObject(object);\n  var i = 0;\n  var result = [];\n  var key;\n  for (key in O) !has(hiddenKeys, key) && has(O, key) && result.push(key);\n  // Don't enum bug & hidden keys\n  while (names.length > i) if (has(O, key = names[i++])) {\n    ~indexOf(result, key) || result.push(key);\n  }\n  return result;\n};\n","var internalObjectKeys = require('../internals/object-keys-internal');\nvar enumBugKeys = require('../internals/enum-bug-keys');\n\n// `Object.keys` method\n// https://tc39.es/ecma262/#sec-object.keys\n// eslint-disable-next-line es/no-object-keys -- safe\nmodule.exports = Object.keys || function keys(O) {\n  return internalObjectKeys(O, enumBugKeys);\n};\n","'use strict';\nvar $propertyIsEnumerable = {}.propertyIsEnumerable;\n// eslint-disable-next-line es/no-object-getownpropertydescriptor -- safe\nvar getOwnPropertyDescriptor = Object.getOwnPropertyDescriptor;\n\n// Nashorn ~ JDK8 bug\nvar NASHORN_BUG = getOwnPropertyDescriptor && !$propertyIsEnumerable.call({ 1: 2 }, 1);\n\n// `Object.prototype.propertyIsEnumerable` method implementation\n// https://tc39.es/ecma262/#sec-object.prototype.propertyisenumerable\nexports.f = NASHORN_BUG ? function propertyIsEnumerable(V) {\n  var descriptor = getOwnPropertyDescriptor(this, V);\n  return !!descriptor && descriptor.enumerable;\n} : $propertyIsEnumerable;\n","var isCallable = require('../internals/is-callable');\nvar isObject = require('../internals/is-object');\n\n// `OrdinaryToPrimitive` abstract operation\n// https://tc39.es/ecma262/#sec-ordinarytoprimitive\nmodule.exports = function (input, pref) {\n  var fn, val;\n  if (pref === 'string' && isCallable(fn = input.toString) && !isObject(val = fn.call(input))) return val;\n  if (isCallable(fn = input.valueOf) && !isObject(val = fn.call(input))) return val;\n  if (pref !== 'string' && isCallable(fn = input.toString) && !isObject(val = fn.call(input))) return val;\n  throw TypeError(\"Can't convert object to primitive value\");\n};\n","var getBuiltIn = require('../internals/get-built-in');\nvar getOwnPropertyNamesModule = require('../internals/object-get-own-property-names');\nvar getOwnPropertySymbolsModule = require('../internals/object-get-own-property-symbols');\nvar anObject = require('../internals/an-object');\n\n// all object keys, includes non-enumerable and symbols\nmodule.exports = getBuiltIn('Reflect', 'ownKeys') || function ownKeys(it) {\n  var keys = getOwnPropertyNamesModule.f(anObject(it));\n  var getOwnPropertySymbols = getOwnPropertySymbolsModule.f;\n  return getOwnPropertySymbols ? keys.concat(getOwnPropertySymbols(it)) : keys;\n};\n","var global = require('../internals/global');\n\nmodule.exports = global;\n","var global = require('../internals/global');\nvar isCallable = require('../internals/is-callable');\nvar has = require('../internals/has');\nvar createNonEnumerableProperty = require('../internals/create-non-enumerable-property');\nvar setGlobal = require('../internals/set-global');\nvar inspectSource = require('../internals/inspect-source');\nvar InternalStateModule = require('../internals/internal-state');\nvar CONFIGURABLE_FUNCTION_NAME = require('../internals/function-name').CONFIGURABLE;\n\nvar getInternalState = InternalStateModule.get;\nvar enforceInternalState = InternalStateModule.enforce;\nvar TEMPLATE = String(String).split('String');\n\n(module.exports = function (O, key, value, options) {\n  var unsafe = options ? !!options.unsafe : false;\n  var simple = options ? !!options.enumerable : false;\n  var noTargetGet = options ? !!options.noTargetGet : false;\n  var name = options && options.name !== undefined ? options.name : key;\n  var state;\n  if (isCallable(value)) {\n    if (String(name).slice(0, 7) === 'Symbol(') {\n      name = '[' + String(name).replace(/^Symbol\\(([^)]*)\\)/, '$1') + ']';\n    }\n    if (!has(value, 'name') || (CONFIGURABLE_FUNCTION_NAME && value.name !== name)) {\n      createNonEnumerableProperty(value, 'name', name);\n    }\n    state = enforceInternalState(value);\n    if (!state.source) {\n      state.source = TEMPLATE.join(typeof name == 'string' ? name : '');\n    }\n  }\n  if (O === global) {\n    if (simple) O[key] = value;\n    else setGlobal(key, value);\n    return;\n  } else if (!unsafe) {\n    delete O[key];\n  } else if (!noTargetGet && O[key]) {\n    simple = true;\n  }\n  if (simple) O[key] = value;\n  else createNonEnumerableProperty(O, key, value);\n// add fake Function#toString for correct work wrapped methods / constructors with methods like LoDash isNative\n})(Function.prototype, 'toString', function toString() {\n  return isCallable(this) && getInternalState(this).source || inspectSource(this);\n});\n","// `RequireObjectCoercible` abstract operation\n// https://tc39.es/ecma262/#sec-requireobjectcoercible\nmodule.exports = function (it) {\n  if (it == undefined) throw TypeError(\"Can't call method on \" + it);\n  return it;\n};\n","var global = require('../internals/global');\n\nmodule.exports = function (key, value) {\n  try {\n    // eslint-disable-next-line es/no-object-defineproperty -- safe\n    Object.defineProperty(global, key, { value: value, configurable: true, writable: true });\n  } catch (error) {\n    global[key] = value;\n  } return value;\n};\n","var shared = require('../internals/shared');\nvar uid = require('../internals/uid');\n\nvar keys = shared('keys');\n\nmodule.exports = function (key) {\n  return keys[key] || (keys[key] = uid(key));\n};\n","var global = require('../internals/global');\nvar setGlobal = require('../internals/set-global');\n\nvar SHARED = '__core-js_shared__';\nvar store = global[SHARED] || setGlobal(SHARED, {});\n\nmodule.exports = store;\n","var IS_PURE = require('../internals/is-pure');\nvar store = require('../internals/shared-store');\n\n(module.exports = function (key, value) {\n  return store[key] || (store[key] = value !== undefined ? value : {});\n})('versions', []).push({\n  version: '3.18.1',\n  mode: IS_PURE ? 'pure' : 'global',\n  copyright: ' 2021 Denis Pushkarev (zloirock.ru)'\n});\n","var toInteger = require('../internals/to-integer');\n\nvar max = Math.max;\nvar min = Math.min;\n\n// Helper for a popular repeating case of the spec:\n// Let integer be ? ToInteger(index).\n// If integer < 0, let result be max((length + integer), 0); else let result be min(integer, length).\nmodule.exports = function (index, length) {\n  var integer = toInteger(index);\n  return integer < 0 ? max(integer + length, 0) : min(integer, length);\n};\n","// toObject with fallback for non-array-like ES3 strings\nvar IndexedObject = require('../internals/indexed-object');\nvar requireObjectCoercible = require('../internals/require-object-coercible');\n\nmodule.exports = function (it) {\n  return IndexedObject(requireObjectCoercible(it));\n};\n","var ceil = Math.ceil;\nvar floor = Math.floor;\n\n// `ToInteger` abstract operation\n// https://tc39.es/ecma262/#sec-tointeger\nmodule.exports = function (argument) {\n  return isNaN(argument = +argument) ? 0 : (argument > 0 ? floor : ceil)(argument);\n};\n","var toInteger = require('../internals/to-integer');\n\nvar min = Math.min;\n\n// `ToLength` abstract operation\n// https://tc39.es/ecma262/#sec-tolength\nmodule.exports = function (argument) {\n  return argument > 0 ? min(toInteger(argument), 0x1FFFFFFFFFFFFF) : 0; // 2 ** 53 - 1 == 9007199254740991\n};\n","var requireObjectCoercible = require('../internals/require-object-coercible');\n\n// `ToObject` abstract operation\n// https://tc39.es/ecma262/#sec-toobject\nmodule.exports = function (argument) {\n  return Object(requireObjectCoercible(argument));\n};\n","var isObject = require('../internals/is-object');\nvar isSymbol = require('../internals/is-symbol');\nvar getMethod = require('../internals/get-method');\nvar ordinaryToPrimitive = require('../internals/ordinary-to-primitive');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\n\nvar TO_PRIMITIVE = wellKnownSymbol('toPrimitive');\n\n// `ToPrimitive` abstract operation\n// https://tc39.es/ecma262/#sec-toprimitive\nmodule.exports = function (input, pref) {\n  if (!isObject(input) || isSymbol(input)) return input;\n  var exoticToPrim = getMethod(input, TO_PRIMITIVE);\n  var result;\n  if (exoticToPrim) {\n    if (pref === undefined) pref = 'default';\n    result = exoticToPrim.call(input, pref);\n    if (!isObject(result) || isSymbol(result)) return result;\n    throw TypeError(\"Can't convert object to primitive value\");\n  }\n  if (pref === undefined) pref = 'number';\n  return ordinaryToPrimitive(input, pref);\n};\n","var toPrimitive = require('../internals/to-primitive');\nvar isSymbol = require('../internals/is-symbol');\n\n// `ToPropertyKey` abstract operation\n// https://tc39.es/ecma262/#sec-topropertykey\nmodule.exports = function (argument) {\n  var key = toPrimitive(argument, 'string');\n  return isSymbol(key) ? key : String(key);\n};\n","var wellKnownSymbol = require('../internals/well-known-symbol');\n\nvar TO_STRING_TAG = wellKnownSymbol('toStringTag');\nvar test = {};\n\ntest[TO_STRING_TAG] = 'z';\n\nmodule.exports = String(test) === '[object z]';\n","var classof = require('../internals/classof');\n\nmodule.exports = function (argument) {\n  if (classof(argument) === 'Symbol') throw TypeError('Cannot convert a Symbol value to a string');\n  return String(argument);\n};\n","module.exports = function (argument) {\n  try {\n    return String(argument);\n  } catch (error) {\n    return 'Object';\n  }\n};\n","var id = 0;\nvar postfix = Math.random();\n\nmodule.exports = function (key) {\n  return 'Symbol(' + String(key === undefined ? '' : key) + ')_' + (++id + postfix).toString(36);\n};\n","/* eslint-disable es/no-symbol -- required for testing */\nvar NATIVE_SYMBOL = require('../internals/native-symbol');\n\nmodule.exports = NATIVE_SYMBOL\n  && !Symbol.sham\n  && typeof Symbol.iterator == 'symbol';\n","var global = require('../internals/global');\nvar shared = require('../internals/shared');\nvar has = require('../internals/has');\nvar uid = require('../internals/uid');\nvar NATIVE_SYMBOL = require('../internals/native-symbol');\nvar USE_SYMBOL_AS_UID = require('../internals/use-symbol-as-uid');\n\nvar WellKnownSymbolsStore = shared('wks');\nvar Symbol = global.Symbol;\nvar createWellKnownSymbol = USE_SYMBOL_AS_UID ? Symbol : Symbol && Symbol.withoutSetter || uid;\n\nmodule.exports = function (name) {\n  if (!has(WellKnownSymbolsStore, name) || !(NATIVE_SYMBOL || typeof WellKnownSymbolsStore[name] == 'string')) {\n    if (NATIVE_SYMBOL && has(Symbol, name)) {\n      WellKnownSymbolsStore[name] = Symbol[name];\n    } else {\n      WellKnownSymbolsStore[name] = createWellKnownSymbol('Symbol.' + name);\n    }\n  } return WellKnownSymbolsStore[name];\n};\n","'use strict';\nvar $ = require('../internals/export');\nvar aCallable = require('../internals/a-callable');\nvar toObject = require('../internals/to-object');\nvar toLength = require('../internals/to-length');\nvar toString = require('../internals/to-string');\nvar fails = require('../internals/fails');\nvar internalSort = require('../internals/array-sort');\nvar arrayMethodIsStrict = require('../internals/array-method-is-strict');\nvar FF = require('../internals/engine-ff-version');\nvar IE_OR_EDGE = require('../internals/engine-is-ie-or-edge');\nvar V8 = require('../internals/engine-v8-version');\nvar WEBKIT = require('../internals/engine-webkit-version');\n\nvar test = [];\nvar nativeSort = test.sort;\n\n// IE8-\nvar FAILS_ON_UNDEFINED = fails(function () {\n  test.sort(undefined);\n});\n// V8 bug\nvar FAILS_ON_NULL = fails(function () {\n  test.sort(null);\n});\n// Old WebKit\nvar STRICT_METHOD = arrayMethodIsStrict('sort');\n\nvar STABLE_SORT = !fails(function () {\n  // feature detection can be too slow, so check engines versions\n  if (V8) return V8 < 70;\n  if (FF && FF > 3) return;\n  if (IE_OR_EDGE) return true;\n  if (WEBKIT) return WEBKIT < 603;\n\n  var result = '';\n  var code, chr, value, index;\n\n  // generate an array with more 512 elements (Chakra and old V8 fails only in this case)\n  for (code = 65; code < 76; code++) {\n    chr = String.fromCharCode(code);\n\n    switch (code) {\n      case 66: case 69: case 70: case 72: value = 3; break;\n      case 68: case 71: value = 4; break;\n      default: value = 2;\n    }\n\n    for (index = 0; index < 47; index++) {\n      test.push({ k: chr + index, v: value });\n    }\n  }\n\n  test.sort(function (a, b) { return b.v - a.v; });\n\n  for (index = 0; index < test.length; index++) {\n    chr = test[index].k.charAt(0);\n    if (result.charAt(result.length - 1) !== chr) result += chr;\n  }\n\n  return result !== 'DGBEFHACIJK';\n});\n\nvar FORCED = FAILS_ON_UNDEFINED || !FAILS_ON_NULL || !STRICT_METHOD || !STABLE_SORT;\n\nvar getSortCompare = function (comparefn) {\n  return function (x, y) {\n    if (y === undefined) return -1;\n    if (x === undefined) return 1;\n    if (comparefn !== undefined) return +comparefn(x, y) || 0;\n    return toString(x) > toString(y) ? 1 : -1;\n  };\n};\n\n// `Array.prototype.sort` method\n// https://tc39.es/ecma262/#sec-array.prototype.sort\n$({ target: 'Array', proto: true, forced: FORCED }, {\n  sort: function sort(comparefn) {\n    if (comparefn !== undefined) aCallable(comparefn);\n\n    var array = toObject(this);\n\n    if (STABLE_SORT) return comparefn === undefined ? nativeSort.call(array) : nativeSort.call(array, comparefn);\n\n    var items = [];\n    var arrayLength = toLength(array.length);\n    var itemsLength, index;\n\n    for (index = 0; index < arrayLength; index++) {\n      if (index in array) items.push(array[index]);\n    }\n\n    items = internalSort(items, getSortCompare(comparefn));\n    itemsLength = items.length;\n    index = 0;\n\n    while (index < itemsLength) array[index] = items[index++];\n    while (index < arrayLength) delete array[index++];\n\n    return array;\n  }\n});\n","var $ = require('../internals/export');\nvar toObject = require('../internals/to-object');\nvar nativeKeys = require('../internals/object-keys');\nvar fails = require('../internals/fails');\n\nvar FAILS_ON_PRIMITIVES = fails(function () { nativeKeys(1); });\n\n// `Object.keys` method\n// https://tc39.es/ecma262/#sec-object.keys\n$({ target: 'Object', stat: true, forced: FAILS_ON_PRIMITIVES }, {\n  keys: function keys(it) {\n    return nativeKeys(toObject(it));\n  }\n});\n","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \"/* Buttons styles start */\\n\\nbutton#excalibur-play {\\n  display: inline-block;\\n  position: relative;\\n  z-index: 999;\\n  border-radius: 6px;\\n  border: none;\\n  /*border: 3px solid;\\n    border-color: white;\\n    box-shadow: 0 0 10px #ccc;*/\\n  padding: 1rem 1.5rem 1rem 4rem;\\n  margin: 0;\\n  text-decoration: none;\\n  background: #00b233;\\n  color: #ffffff;\\n  font-family: sans-serif;\\n  font-size: 2rem;\\n  line-height: 1;\\n  cursor: pointer;\\n  text-align: center;\\n  transition: background 250ms ease-in-out, transform 150ms ease;\\n  -webkit-appearance: none;\\n  -moz-appearance: none;\\n\\n  -webkit-animation: excalibur-button-fadein 200ms; /* Safari, Chrome and Opera > 12.1 */\\n  -moz-animation: excalibur-button-fadein 200ms; /* Firefox < 16 */\\n  -ms-animation: excalibur-button-fadein 200ms; /* Internet Explorer */\\n  -o-animation: excalibur-button-fadein 200ms; /* Opera < 12.1 */\\n  animation: excalibur-button-fadein 200ms;\\n}\\n\\n/*\\nbutton#excalibur-play {\\n  display: none;\\n}*/\\n\\nbutton#excalibur-play:after {\\n  position: absolute;\\n  content: '';\\n  border: 8px solid;\\n  border-color: transparent transparent transparent white;\\n  left: 35px;\\n  top: 24px;\\n  width: 0;\\n  height: 0;\\n}\\n\\nbutton#excalibur-play:before {\\n  position: absolute;\\n  content: '';\\n  border: 3px solid;\\n  left: 19px;\\n  top: 14px;\\n  border-radius: 20px;\\n  width: 30px;\\n  height: 30px;\\n}\\n\\nbutton#excalibur-play:hover,\\nbutton#excalibur-play:focus {\\n  background: #00982c;\\n}\\n\\nbutton#excalibur-play:focus {\\n  outline: 1px solid #fff;\\n  outline-offset: -4px;\\n}\\n\\nbutton#excalibur-play:active {\\n  transform: scale(0.99);\\n}\\n\\n@keyframes excalibur-button-fadein {\\n  from {\\n    opacity: 0;\\n  }\\n  to {\\n    opacity: 1;\\n  }\\n}\\n\\n/* Firefox < 16 */\\n@-moz-keyframes excalibur-button-fadein {\\n  from {\\n    opacity: 0;\\n  }\\n  to {\\n    opacity: 1;\\n  }\\n}\\n\\n/* Safari, Chrome and Opera > 12.1 */\\n@-webkit-keyframes excalibur-button-fadein {\\n  from {\\n    opacity: 0;\\n  }\\n  to {\\n    opacity: 1;\\n  }\\n}\\n\\n/* Internet Explorer */\\n@-ms-keyframes excalibur-button-fadein {\\n  from {\\n    opacity: 0;\\n  }\\n  to {\\n    opacity: 1;\\n  }\\n}\\n\\n/* Opera < 12.1 */\\n@-o-keyframes excalibur-button-fadein {\\n  from {\\n    opacity: 0;\\n  }\\n  to {\\n    opacity: 1;\\n  }\\n}\\n\", \"\",{\"version\":3,\"sources\":[\"webpack://./Loader.css\"],\"names\":[],\"mappings\":\"AAAA,yBAAyB;;AAEzB;EACE,qBAAqB;EACrB,kBAAkB;EAClB,YAAY;EACZ,kBAAkB;EAClB,YAAY;EACZ;;+BAE6B;EAC7B,8BAA8B;EAC9B,SAAS;EACT,qBAAqB;EACrB,mBAAmB;EACnB,cAAc;EACd,uBAAuB;EACvB,eAAe;EACf,cAAc;EACd,eAAe;EACf,kBAAkB;EAClB,8DAA8D;EAC9D,wBAAwB;EACxB,qBAAqB;;EAErB,gDAAgD,EAAE,oCAAoC;EACtF,6CAA6C,EAAE,iBAAiB;EAChE,4CAA4C,EAAE,sBAAsB;EACpE,2CAA2C,EAAE,iBAAiB;EAC9D,wCAAwC;AAC1C;;AAEA;;;EAGE;;AAEF;EACE,kBAAkB;EAClB,WAAW;EACX,iBAAiB;EACjB,uDAAuD;EACvD,UAAU;EACV,SAAS;EACT,QAAQ;EACR,SAAS;AACX;;AAEA;EACE,kBAAkB;EAClB,WAAW;EACX,iBAAiB;EACjB,UAAU;EACV,SAAS;EACT,mBAAmB;EACnB,WAAW;EACX,YAAY;AACd;;AAEA;;EAEE,mBAAmB;AACrB;;AAEA;EACE,uBAAuB;EACvB,oBAAoB;AACtB;;AAEA;EACE,sBAAsB;AACxB;;AAEA;EACE;IACE,UAAU;EACZ;EACA;IACE,UAAU;EACZ;AACF;;AAEA,iBAAiB;AACjB;EACE;IACE,UAAU;EACZ;EACA;IACE,UAAU;EACZ;AACF;;AAEA,oCAAoC;AACpC;EACE;IACE,UAAU;EACZ;EACA;IACE,UAAU;EACZ;AACF;;AAEA,sBAAsB;AACtB;EACE;IACE,UAAU;EACZ;EACA;IACE,UAAU;EACZ;AACF;;AAEA,iBAAiB;AACjB;EACE;IACE,UAAU;EACZ;EACA;IACE,UAAU;EACZ;AACF\",\"sourcesContent\":[\"/* Buttons styles start */\\n\\nbutton#excalibur-play {\\n  display: inline-block;\\n  position: relative;\\n  z-index: 999;\\n  border-radius: 6px;\\n  border: none;\\n  /*border: 3px solid;\\n    border-color: white;\\n    box-shadow: 0 0 10px #ccc;*/\\n  padding: 1rem 1.5rem 1rem 4rem;\\n  margin: 0;\\n  text-decoration: none;\\n  background: #00b233;\\n  color: #ffffff;\\n  font-family: sans-serif;\\n  font-size: 2rem;\\n  line-height: 1;\\n  cursor: pointer;\\n  text-align: center;\\n  transition: background 250ms ease-in-out, transform 150ms ease;\\n  -webkit-appearance: none;\\n  -moz-appearance: none;\\n\\n  -webkit-animation: excalibur-button-fadein 200ms; /* Safari, Chrome and Opera > 12.1 */\\n  -moz-animation: excalibur-button-fadein 200ms; /* Firefox < 16 */\\n  -ms-animation: excalibur-button-fadein 200ms; /* Internet Explorer */\\n  -o-animation: excalibur-button-fadein 200ms; /* Opera < 12.1 */\\n  animation: excalibur-button-fadein 200ms;\\n}\\n\\n/*\\nbutton#excalibur-play {\\n  display: none;\\n}*/\\n\\nbutton#excalibur-play:after {\\n  position: absolute;\\n  content: '';\\n  border: 8px solid;\\n  border-color: transparent transparent transparent white;\\n  left: 35px;\\n  top: 24px;\\n  width: 0;\\n  height: 0;\\n}\\n\\nbutton#excalibur-play:before {\\n  position: absolute;\\n  content: '';\\n  border: 3px solid;\\n  left: 19px;\\n  top: 14px;\\n  border-radius: 20px;\\n  width: 30px;\\n  height: 30px;\\n}\\n\\nbutton#excalibur-play:hover,\\nbutton#excalibur-play:focus {\\n  background: #00982c;\\n}\\n\\nbutton#excalibur-play:focus {\\n  outline: 1px solid #fff;\\n  outline-offset: -4px;\\n}\\n\\nbutton#excalibur-play:active {\\n  transform: scale(0.99);\\n}\\n\\n@keyframes excalibur-button-fadein {\\n  from {\\n    opacity: 0;\\n  }\\n  to {\\n    opacity: 1;\\n  }\\n}\\n\\n/* Firefox < 16 */\\n@-moz-keyframes excalibur-button-fadein {\\n  from {\\n    opacity: 0;\\n  }\\n  to {\\n    opacity: 1;\\n  }\\n}\\n\\n/* Safari, Chrome and Opera > 12.1 */\\n@-webkit-keyframes excalibur-button-fadein {\\n  from {\\n    opacity: 0;\\n  }\\n  to {\\n    opacity: 1;\\n  }\\n}\\n\\n/* Internet Explorer */\\n@-ms-keyframes excalibur-button-fadein {\\n  from {\\n    opacity: 0;\\n  }\\n  to {\\n    opacity: 1;\\n  }\\n}\\n\\n/* Opera < 12.1 */\\n@-o-keyframes excalibur-button-fadein {\\n  from {\\n    opacity: 0;\\n  }\\n  to {\\n    opacity: 1;\\n  }\\n}\\n\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","\"use strict\";\n\n/*\n  MIT License http://www.opensource.org/licenses/mit-license.php\n  Author Tobias Koppers @sokra\n*/\nmodule.exports = function (cssWithMappingToString) {\n  var list = []; // return the list of modules as css string\n\n  list.toString = function toString() {\n    return this.map(function (item) {\n      var content = \"\";\n      var needLayer = typeof item[5] !== \"undefined\";\n\n      if (item[4]) {\n        content += \"@supports (\".concat(item[4], \") {\");\n      }\n\n      if (item[2]) {\n        content += \"@media \".concat(item[2], \" {\");\n      }\n\n      if (needLayer) {\n        content += \"@layer\".concat(item[5].length > 0 ? \" \".concat(item[5]) : \"\", \" {\");\n      }\n\n      content += cssWithMappingToString(item);\n\n      if (needLayer) {\n        content += \"}\";\n      }\n\n      if (item[2]) {\n        content += \"}\";\n      }\n\n      if (item[4]) {\n        content += \"}\";\n      }\n\n      return content;\n    }).join(\"\");\n  }; // import a list of modules into the list\n\n\n  list.i = function i(modules, media, dedupe, supports, layer) {\n    if (typeof modules === \"string\") {\n      modules = [[null, modules, undefined]];\n    }\n\n    var alreadyImportedModules = {};\n\n    if (dedupe) {\n      for (var _i = 0; _i < this.length; _i++) {\n        var id = this[_i][0];\n\n        if (id != null) {\n          alreadyImportedModules[id] = true;\n        }\n      }\n    }\n\n    for (var _i2 = 0; _i2 < modules.length; _i2++) {\n      var item = [].concat(modules[_i2]);\n\n      if (dedupe && alreadyImportedModules[item[0]]) {\n        continue;\n      }\n\n      if (typeof layer !== \"undefined\") {\n        if (typeof item[5] === \"undefined\") {\n          item[5] = layer;\n        } else {\n          item[1] = \"@layer\".concat(item[5].length > 0 ? \" \".concat(item[5]) : \"\", \" {\").concat(item[1], \"}\");\n          item[5] = layer;\n        }\n      }\n\n      if (media) {\n        if (!item[2]) {\n          item[2] = media;\n        } else {\n          item[1] = \"@media \".concat(item[2], \" {\").concat(item[1], \"}\");\n          item[2] = media;\n        }\n      }\n\n      if (supports) {\n        if (!item[4]) {\n          item[4] = \"\".concat(supports);\n        } else {\n          item[1] = \"@supports (\".concat(item[4], \") {\").concat(item[1], \"}\");\n          item[4] = supports;\n        }\n      }\n\n      list.push(item);\n    }\n  };\n\n  return list;\n};","\"use strict\";\n\nmodule.exports = function (item) {\n  var content = item[1];\n  var cssMapping = item[3];\n\n  if (!cssMapping) {\n    return content;\n  }\n\n  if (typeof btoa === \"function\") {\n    var base64 = btoa(unescape(encodeURIComponent(JSON.stringify(cssMapping))));\n    var data = \"sourceMappingURL=data:application/json;charset=utf-8;base64,\".concat(base64);\n    var sourceMapping = \"/*# \".concat(data, \" */\");\n    var sourceURLs = cssMapping.sources.map(function (source) {\n      return \"/*# sourceURL=\".concat(cssMapping.sourceRoot || \"\").concat(source, \" */\");\n    });\n    return [content].concat(sourceURLs).concat([sourceMapping]).join(\"\\n\");\n  }\n\n  return [content].join(\"\\n\");\n};","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\tid: moduleId,\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","\n/**\n * Features in preview\n */\nexport enum Experiments {\n  WebGL = 'use-webgl'\n}\n\n/**\n * Legacy features that will go away\n */\nexport enum Legacy {\n  Canvas = 'use-canvas-context',\n  LegacyDrawing = 'use-legacy-drawing'\n}\n\n/**\n * Flags is a feature flag implementation for Excalibur. They can only be operated **before [[Engine]] construction**\n * after which they are frozen and are read-only.\n *\n * Flags are used to enable experimental or preview features in Excalibur.\n */\nexport class Flags {\n  private static _FROZEN = false;\n  private static _FLAGS: Record<string, boolean> = {};\n\n  /**\n   * Freeze all flag modifications making them readonly\n   */\n  public static freeze() {\n    Flags._FROZEN = true;\n  }\n\n  /**\n   * Resets internal flag state, not meant to be called by users. Only used for testing.\n   *\n   * Calling this in your game is UNSUPPORTED\n   * @internal\n   */\n  public static _reset() {\n    Flags._FROZEN = false;\n    Flags._FLAGS = {};\n  }\n\n  /**\n   * Turn on webgl support\n   */\n  public static useWebGL() {\n    Flags.enable(Experiments.WebGL);\n  }\n\n  public static useCanvasGraphicsContext() {\n    Flags.enable(Legacy.Canvas);\n  }\n\n  /**\n   * @deprecated Recommended not to use legacy drawing, going away in v0.26.0\n   */\n  public static useLegacyDrawing() {\n    Flags.enable(Legacy.LegacyDrawing);\n  }\n\n  /**\n   * Enable a specific feature flag by name. **Note: can only be set before [[Engine]] constructor time**\n   * @param flagName\n   */\n  public static enable(flagName: string): void {\n    if (this._FROZEN) {\n      throw Error('Feature flags can only be enabled before Engine constructor time');\n    }\n    Flags._FLAGS[flagName] = true;\n  }\n\n  /**\n   * Disable a specific feature flag by name. **Note: can only be set before [[Engine]] constructor time**\n   * @param flagName\n   */\n  public static disable(flagName: string): void {\n    if (this._FROZEN) {\n      throw Error('Feature flags can only be disabled before Engine constructor time');\n    }\n    Flags._FLAGS[flagName] = false;\n  }\n\n  /**\n   * Check if a flag is enabled. If the flag is disabled or does not exist `false` is returned\n   * @param flagName\n   */\n  public static isEnabled(flagName: string): boolean {\n    return !!Flags._FLAGS[flagName];\n  }\n\n  /**\n   * Show a list of currently known flags\n   */\n  public static show(): string[] {\n    return Object.keys(Flags._FLAGS);\n  }\n}\n","/* eslint-disable no-console */\n/**\n * Logging level that Excalibur will tag\n */\nexport enum LogLevel {\n  Debug,\n  Info,\n  Warn,\n  Error,\n  Fatal\n}\n\n/**\n * Static singleton that represents the logging facility for Excalibur.\n * Excalibur comes built-in with a [[ConsoleAppender]] and [[ScreenAppender]].\n * Derive from [[Appender]] to create your own logging appenders.\n */\nexport class Logger {\n  private static _INSTANCE: Logger = null;\n  private _appenders: Appender[] = [];\n\n  constructor() {\n    if (Logger._INSTANCE) {\n      throw new Error('Logger is a singleton');\n    }\n    Logger._INSTANCE = this;\n    // Default console appender\n    Logger._INSTANCE.addAppender(new ConsoleAppender());\n    return Logger._INSTANCE;\n  }\n\n  /**\n   * Gets or sets the default logging level. Excalibur will only log\n   * messages if equal to or above this level. Default: [[LogLevel.Info]]\n   */\n  public defaultLevel: LogLevel = LogLevel.Info;\n\n  /**\n   * Gets the current static instance of Logger\n   */\n  public static getInstance(): Logger {\n    if (Logger._INSTANCE == null) {\n      Logger._INSTANCE = new Logger();\n    }\n    return Logger._INSTANCE;\n  }\n\n  /**\n   * Adds a new [[Appender]] to the list of appenders to write to\n   */\n  public addAppender(appender: Appender): void {\n    this._appenders.push(appender);\n  }\n\n  /**\n   * Clears all appenders from the logger\n   */\n  public clearAppenders(): void {\n    this._appenders.length = 0;\n  }\n\n  /**\n   * Logs a message at a given LogLevel\n   * @param level  The LogLevel`to log the message at\n   * @param args   An array of arguments to write to an appender\n   */\n  private _log(level: LogLevel, args: any[]): void {\n    if (level == null) {\n      level = this.defaultLevel;\n    }\n\n    const len = this._appenders.length;\n\n    for (let i = 0; i < len; i++) {\n      if (level >= this.defaultLevel) {\n        this._appenders[i].log(level, args);\n      }\n    }\n  }\n\n  /**\n   * Writes a log message at the [[LogLevel.Debug]] level\n   * @param args  Accepts any number of arguments\n   */\n  public debug(...args: any[]): void {\n    this._log(LogLevel.Debug, args);\n  }\n\n  /**\n   * Writes a log message at the [[LogLevel.Info]] level\n   * @param args  Accepts any number of arguments\n   */\n  public info(...args: any[]): void {\n    this._log(LogLevel.Info, args);\n  }\n\n  /**\n   * Writes a log message at the [[LogLevel.Warn]] level\n   * @param args  Accepts any number of arguments\n   */\n  public warn(...args: any[]): void {\n    this._log(LogLevel.Warn, args);\n  }\n\n  /**\n   * Writes a log message at the [[LogLevel.Error]] level\n   * @param args  Accepts any number of arguments\n   */\n  public error(...args: any[]): void {\n    this._log(LogLevel.Error, args);\n  }\n\n  /**\n   * Writes a log message at the [[LogLevel.Fatal]] level\n   * @param args  Accepts any number of arguments\n   */\n  public fatal(...args: any[]): void {\n    this._log(LogLevel.Fatal, args);\n  }\n}\n\n/**\n * Contract for any log appender (such as console/screen)\n */\nexport interface Appender {\n  /**\n   * Logs a message at the given [[LogLevel]]\n   * @param level  Level to log at\n   * @param args   Arguments to log\n   */\n  log(level: LogLevel, args: any[]): void;\n}\n\n/**\n * Console appender for browsers (i.e. `console.log`)\n */\nexport class ConsoleAppender implements Appender {\n  /**\n   * Logs a message at the given [[LogLevel]]\n   * @param level  Level to log at\n   * @param args   Arguments to log\n   */\n  public log(level: LogLevel, args: any[]): void {\n    // Check for console support\n    if (!console && !console.log && console.warn && console.error) {\n      // todo maybe do something better than nothing\n      return;\n    }\n\n    // Create a new console args array\n    const consoleArgs: any[] = [];\n    consoleArgs.unshift.apply(consoleArgs, args);\n    consoleArgs.unshift('[' + LogLevel[level] + '] : ');\n\n    if (level < LogLevel.Warn) {\n      // Call .log for Debug/Info\n      if (console.log.apply) {\n        // this is required on some older browsers that don't support apply on console.log :(\n        console.log.apply(console, consoleArgs);\n      } else {\n        console.log(consoleArgs.join(' '));\n      }\n    } else if (level < LogLevel.Error) {\n      // Call .warn for Warn\n      if (console.warn.apply) {\n        console.warn.apply(console, consoleArgs);\n      } else {\n        console.warn(consoleArgs.join(' '));\n      }\n    } else {\n      // Call .error for Error/Fatal\n      if (console.error.apply) {\n        console.error.apply(console, consoleArgs);\n      } else {\n        console.error(consoleArgs.join(' '));\n      }\n    }\n  }\n}\n\n/**\n * On-screen (canvas) appender\n */\nexport class ScreenAppender implements Appender {\n  // @todo Clean this up\n\n  private _messages: string[] = [];\n  private _canvas: HTMLCanvasElement;\n  private _ctx: CanvasRenderingContext2D;\n\n  /**\n   * @param width   Width of the screen appender in pixels\n   * @param height  Height of the screen appender in pixels\n   */\n  constructor(width?: number, height?: number) {\n    this._canvas = <HTMLCanvasElement>document.createElement('canvas');\n    this._canvas.width = width || window.innerWidth;\n    this._canvas.height = height || window.innerHeight;\n    this._canvas.style.position = 'absolute';\n    // eslint-disable-next-line\n    this._ctx = <CanvasRenderingContext2D>this._canvas.getContext('2d'); // eslint-disable-line\n    document.body.appendChild(this._canvas);\n  }\n\n  /**\n   * Logs a message at the given [[LogLevel]]\n   * @param level  Level to log at\n   * @param args   Arguments to log\n   */\n  public log(level: LogLevel, args: any[]): void {\n    const message = args.join(',');\n\n    this._ctx.clearRect(0, 0, this._canvas.width, this._canvas.height);\n\n    this._messages.unshift('[' + LogLevel[level] + '] : ' + message);\n\n    let pos = 10;\n    let opacity = 1.0;\n    for (let i = 0; i < this._messages.length; i++) {\n      this._ctx.fillStyle = 'rgba(255,255,255,' + opacity.toFixed(2) + ')';\n      this._ctx.fillText(this._messages[i], 200, pos);\n      pos += 10;\n      opacity = opacity > 0 ? opacity - 0.05 : 0;\n    }\n  }\n}\n","import { Vector } from '../Math/vector';\n\n/**\n * An enum that describes the sides of an axis aligned box for collision\n */\nexport enum Side {\n  None = 'None',\n  Top = 'Top',\n  Bottom = 'Bottom',\n  Left = 'Left',\n  Right = 'Right'\n}\n\nexport module Side {\n  /**\n   * Returns the opposite side from the current\n   */\n  export function getOpposite(side: Side): Side {\n    if (side === Side.Top) {\n      return Side.Bottom;\n    }\n    if (side === Side.Bottom) {\n      return Side.Top;\n    }\n    if (side === Side.Left) {\n      return Side.Right;\n    }\n    if (side === Side.Right) {\n      return Side.Left;\n    }\n\n    return Side.None;\n  }\n\n  /**\n   * Given a vector, return the Side most in that direction (via dot product)\n   */\n  export function fromDirection(direction: Vector): Side {\n    const directions = [Vector.Left, Vector.Right, Vector.Up, Vector.Down];\n    const directionEnum = [Side.Left, Side.Right, Side.Top, Side.Bottom];\n\n    let max = -Number.MAX_VALUE;\n    let maxIndex = -1;\n    for (let i = 0; i < directions.length; i++) {\n      if (directions[i].dot(direction) > max) {\n        max = directions[i].dot(direction);\n        maxIndex = i;\n      }\n    }\n    return directionEnum[maxIndex];\n  }\n}\n","import 'core-js/es/array/sort';\nimport 'core-js/es/object/keys';\n\n/**\n * Polyfill adding function\n */\nexport function polyfill() {\n  /* istanbul ignore next */\n  if (typeof window === 'undefined') {\n    window = <any>{\n      audioContext: function () {\n        return;\n      }\n    };\n  }\n  /* istanbul ignore next */\n  if (typeof window !== 'undefined' && !window.requestAnimationFrame) {\n    (<any>window).requestAnimationFrame =\n      (<any>window).webkitRequestAnimationFrame ||\n      (<any>window).mozRequestAnimationFrame ||\n      function (callback: Function) {\n        window.setInterval(callback, 1000 / 60);\n      };\n  }\n  /* istanbul ignore next */\n  if (typeof window !== 'undefined' && !window.cancelAnimationFrame) {\n    (<any>window).cancelAnimationFrame =\n      (<any>window).webkitCancelAnimationFrame ||\n      (<any>window).mozCancelAnimationFrame ||\n      function () {\n        return;\n      };\n  }\n  /* istanbul ignore next */\n  if (typeof window !== 'undefined' && !(<any>window).AudioContext) {\n    if ((<any>window).webkitAudioContext) {\n      const ctx = (<any>window).webkitAudioContext;\n      const replaceMe = ctx.prototype.decodeAudioData;\n      (<any>window).webkitAudioContext.prototype.decodeAudioData = function (arrayBuffer: ArrayBuffer) {\n        return new Promise((resolve, reject) => {\n          replaceMe.call(this, arrayBuffer, resolve, reject);\n        });\n      };\n    }\n\n    (<any>window).AudioContext =\n      (<any>window).AudioContext ||\n      (<any>window).webkitAudioContext ||\n      (<any>window).mozAudioContext ||\n      (<any>window).msAudioContext ||\n      (<any>window).oAudioContext;\n  }\n\n  /* istanbul ignore next */\n  if (typeof window !== 'undefined' && !(<any>window).devicePixelRatio) {\n    (<any>window).devicePixelRatio = window.devicePixelRatio || 1;\n  }\n}\n","export type Id<T extends string> = {\n  type: T,\n  value: number\n};\n\n/**\n *\n */\nexport function createId<T extends string>(type: T, value: number): Id<T> {\n  return { type, value };\n};\n","/**\n * @module\n * Pseudo-Random Utility\n *\n * A pseudo-random utility to add seeded random support for help in\n * generating things like terrain or reproducible randomness. Uses the\n * [Mersenne Twister](https://en.wikipedia.org/wiki/Mersenne_Twister) algorithm.\n */\n\n/**\n * 32-bit mask\n */\nconst BITMASK32: number = 0xffffffff;\n\n/**\n * Pseudo-random number generator following the Mersenne_Twister algorithm. Given a seed this generator will produce the same sequence\n * of numbers each time it is called.\n * See https://en.wikipedia.org/wiki/Mersenne_Twister for more details.\n * Uses the MT19937-32 (2002) implementation documented here http://www.math.sci.hiroshima-u.ac.jp/~m-mat/MT/MT2002/emt19937ar.html\n *\n * Api inspired by http://chancejs.com/# https://github.com/chancejs/chancejs\n */\nexport class Random {\n  // Separation point of one one word, the number of bits in the lower bitmask 0 <= r <= w-1\n  private _lowerMask: number = 0x7fffffff; // 31 bits same as _r\n  private _upperMask: number = 0x80000000; // 34 high bits\n\n  // Word size, 64 bits\n  private _w: number = 32;\n\n  // Degree of recurrence\n  private _n: number = 624;\n\n  // Middle word, an offset used in the recurrence defining the series x, 1<=m<n\n  private _m: number = 397;\n  // coefficients of teh rational normal form twist matrix\n  private _a: number = 0x9908b0df;\n\n  // tempering bit shifts and masks\n  private _u: number = 11;\n  private _s: number = 7;\n  private _b: number = 0x9d2c5680;\n  private _t: number = 15;\n  private _c: number = 0xefc60000;\n  private _l: number = 18;\n  private _f: number = 1812433253;\n\n  private _mt: number[];\n\n  private _index: number;\n\n  /**\n   * If no seed is specified, the Date.now() is used\n   */\n  constructor(public seed?: number) {\n    this._mt = new Array<number>(this._n);\n    // need to mask to support higher bit machines\n    this._mt[0] = (seed || Date.now()) >>> 0;\n\n    for (let i = 1; i < this._n; i++) {\n      const s = this._mt[i - 1] ^ (this._mt[i - 1] >>> (this._w - 2));\n      // numbers are bigger than the JS max safe int, add in 16-bit chunks to prevent IEEE rounding errors on high bits\n      this._mt[i] = (((this._f * ((s & 0xffff0000) >>> 16)) << 16) + this._f * (s & 0xffff) + i) >>> 0;\n    }\n    this._index = this._n;\n  }\n\n  /**\n   * Apply the twist\n   */\n  private _twist(): void {\n    const mag01 = [0x0, this._a];\n    let y = 0,\n      i = 0;\n    for (; i < this._n - this._m; i++) {\n      y = (this._mt[i] & this._upperMask) | (this._mt[i + 1] & this._lowerMask);\n      this._mt[i] = this._mt[i + this._m] ^ (y >>> 1) ^ (mag01[y & 0x1] & BITMASK32);\n    }\n    for (; i < this._n - 1; i++) {\n      y = (this._mt[i] & this._upperMask) | (this._mt[i + 1] & this._lowerMask);\n      this._mt[i] = this._mt[i + (this._m - this._n)] ^ (y >>> 1) ^ (mag01[y & 0x1] & BITMASK32);\n    }\n    y = (this._mt[this._n - 1] & this._upperMask) | (this._mt[0] & this._lowerMask);\n    this._mt[this._n - 1] = this._mt[this._m - 1] ^ (y >>> 1) ^ (mag01[y & 0x1] & BITMASK32);\n\n    this._index = 0;\n  }\n\n  /**\n   * Return next 32 bit integer number in sequence\n   */\n  public nextInt(): number {\n    if (this._index >= this._n) {\n      this._twist();\n    }\n\n    let y = this._mt[this._index++];\n\n    y ^= y >>> this._u;\n    y ^= (y << this._s) & this._b;\n    y ^= (y << this._t) & this._c;\n    y ^= y >>> this._l;\n\n    return y >>> 0;\n  }\n\n  /**\n   * Return a random floating point number between [0, 1)\n   */\n  public next(): number {\n    return this.nextInt() * (1.0 / 4294967296.0); // divided by 2^32\n  }\n\n  /**\n   * Return a random floating point in range [min, max) min is included, max is not included\n   */\n  public floating(min: number, max: number): number {\n    return (max - min) * this.next() + min;\n  }\n\n  /**\n   * Return a random integer in range [min, max] min is included, max is included.\n   * Implemented with rejection sampling, see https://medium.com/@betable/tifu-by-using-math-random-f1c308c4fd9d#.i13tdiu5a\n   */\n  public integer(min: number, max: number): number {\n    return Math.floor((max - min + 1) * this.next() + min);\n  }\n\n  /**\n   * Returns true or false randomly with 50/50 odds by default.\n   * By default the likelihood of returning a true is .5 (50%).\n   * @param likelihood takes values between [0, 1]\n   */\n  public bool(likelihood: number = 0.5): boolean {\n    return this.next() <= likelihood;\n  }\n\n  /**\n   * Returns one element from an array at random\n   */\n  public pickOne<T>(array: Array<T>): T {\n    return array[this.integer(0, array.length - 1)];\n  }\n\n  /**\n   * Returns a new array random picking elements from the original\n   * @param array Original array to pick from\n   * @param numPicks can be any positive number\n   * @param allowDuplicates indicates whether the returned set is allowed duplicates (it does not mean there will always be duplicates\n   * just that it is possible)\n   */\n  public pickSet<T>(array: Array<T>, numPicks: number, allowDuplicates: boolean = false): Array<T> {\n    if (allowDuplicates) {\n      return this._pickSetWithDuplicates(array, numPicks);\n    } else {\n      return this._pickSetWithoutDuplicates(array, numPicks);\n    }\n  }\n\n  /**\n   * Returns a new array randomly picking elements in the original (not reused)\n   * @param array Array to pick elements out of\n   * @param numPicks must be less than or equal to the number of elements in the array.\n   */\n  private _pickSetWithoutDuplicates<T>(array: Array<T>, numPicks: number): Array<T> {\n    if (numPicks > array.length || numPicks < 0) {\n      throw new Error('Invalid number of elements to pick, must pick a value 0 < n <= length');\n    }\n    if (numPicks === array.length) {\n      return array;\n    }\n\n    const result: Array<T> = new Array<T>(numPicks);\n    let currentPick = 0;\n    const tempArray = array.slice(0);\n    while (currentPick < numPicks) {\n      const index = this.integer(0, tempArray.length - 1);\n      result[currentPick++] = tempArray[index];\n      tempArray.splice(index, 1);\n    }\n\n    return result;\n  }\n\n  /**\n   * Returns a new array random picking elements from the original allowing duplicates\n   * @param array Array to pick elements out of\n   * @param numPicks can be any positive number\n   */\n  private _pickSetWithDuplicates<T>(array: Array<T>, numPicks: number): Array<T> {\n    // Typescript numbers are all floating point, so do we add check for int? (or floor the input?)\n    if (numPicks < 0) {\n      throw new Error('Invalid number of elements to pick, must pick a value 0 <= n < MAX_INT');\n    }\n    const result = new Array<T>(numPicks);\n    for (let i = 0; i < numPicks; i++) {\n      result[i] = this.pickOne(array);\n    }\n    return result;\n  }\n\n  /**\n   * Returns a new array that has its elements shuffled. Using the Fisher/Yates method\n   * https://en.wikipedia.org/wiki/Fisher%E2%80%93Yates_shuffle\n   */\n  public shuffle<T>(array: Array<T>): Array<T> {\n    const tempArray = array.slice(0);\n    let swap: T = null;\n    for (let i = 0; i < tempArray.length - 2; i++) {\n      const randomIndex = this.integer(i, tempArray.length - 1);\n      swap = tempArray[i];\n      tempArray[i] = tempArray[randomIndex];\n      tempArray[randomIndex] = swap;\n    }\n\n    return tempArray;\n  }\n\n  /**\n   * Generate a list of random integer numbers\n   * @param length the length of the final array\n   * @param min the minimum integer number to generate inclusive\n   * @param max the maximum integer number to generate inclusive\n   */\n  public range(length: number, min: number, max: number): Array<number> {\n    const result: Array<number> = new Array(length);\n    for (let i = 0; i < length; i++) {\n      result[i] = this.integer(min, max);\n    }\n    return result;\n  }\n\n  /**\n   * Returns the result of a d4 dice roll\n   */\n  public d4() {\n    return this.integer(1, 4);\n  }\n\n  /**\n   * Returns the result of a d6 dice roll\n   */\n  public d6() {\n    return this.integer(1, 6);\n  }\n\n  /**\n   * Returns the result of a d8 dice roll\n   */\n  public d8() {\n    return this.integer(1, 8);\n  }\n\n  /**\n   * Returns the result of a d10 dice roll\n   */\n  public d10() {\n    return this.integer(1, 10);\n  }\n\n  /**\n   * Returns the result of a d12 dice roll\n   */\n  public d12() {\n    return this.integer(1, 12);\n  }\n\n  /**\n   * Returns the result of a d20 dice roll\n   */\n  public d20() {\n    return this.integer(1, 20);\n  }\n}\n","import { Vector } from '../Math/vector';\nimport { Random } from '../Math/Random';\nimport { Side } from '../Collision/Side';\n\n/**\n * Two PI constant\n */\nexport const TwoPI: number = Math.PI * 2;\n\n/**\n * Merges one or more objects into a single target object\n *\n * @param deep Whether or not to do a deep clone\n * @param target The target object to attach properties on\n * @param objects The objects whose properties to merge\n * @returns Merged object with properties from other objects\n */\nexport function extend(deep: boolean, target: any, ...objects: any[]): any;\n\n/**\n * Merges one or more objects into a single target object\n *\n * @param target The target object to attach properties on\n * @param object2 The second object whose properties to merge\n * @returns Merged object with properties from other objects\n */\nexport function extend<T1, T2>(target: T1, object2: T2): T1 & T2;\n\n/**\n * Merges one or more objects into a single target object\n *\n * @param target The target object to attach properties on\n * @param object2 The second object whose properties to merge\n * @param object3 The third object whose properties to merge\n * @returns Merged object with properties from other objects\n */\nexport function extend<T1, T2, T3>(target: T1, object2: T2, object3: T3): T1 & T2 & T3;\n\n/**\n * Merges one or more objects into a single target object\n *\n * @param target The target object to attach properties on\n * @param objects The objects whose properties to merge\n * @returns Merged object with properties from other objects\n */\nexport function extend(target: any, ...objects: any[]): any;\n\n/**\n * Merges one or more objects into a single target object\n *\n * @returns Merged object with properties from other objects\n * @credit https://gomakethings.com/vanilla-javascript-version-of-jquery-extend/\n */\nexport function extend() {\n  const extended: { [key: string]: any } = {};\n  let deep = false;\n  let i = 0;\n  const length = arguments.length;\n\n  // Check if a deep merge\n  if (Object.prototype.toString.call(arguments[0]) === '[object Boolean]') {\n    deep = arguments[0];\n    i++;\n  }\n\n  // Merge the object into the extended object\n  const assignExists = typeof (<any>Object).assign === 'function';\n  let merge = null;\n  if (!assignExists) {\n    merge = function (obj: any) {\n      for (const prop in obj) {\n        if (Object.prototype.hasOwnProperty.call(obj, prop)) {\n          // If deep merge and property is an object, merge properties\n          if (deep && Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n            extended[prop] = extend(true, extended[prop], obj[prop]);\n          } else {\n            extended[prop] = obj[prop];\n          }\n        }\n      }\n    };\n  } else {\n    merge = (<any>Object).assign;\n  }\n\n  // Loop through each object and conduct a merge\n  for (; i < length; i++) {\n    const obj = arguments[i];\n    if (!assignExists) {\n      merge(obj);\n    } else {\n      merge(extended, obj);\n    }\n  }\n\n  return extended;\n}\n\n/**\n * Encode a string in base64\n * @deprecated This will be removed in v0.26.0\n */\nexport function base64Encode(inputStr: string) {\n  const b64 = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=';\n  let outputStr = '';\n  let i = 0;\n\n  while (i < inputStr.length) {\n    //all three \"& 0xff\" added below are there to fix a known bug\n    //with bytes returned by xhr.responseText\n    const byte1 = inputStr.charCodeAt(i++) & 0xff;\n    const byte2 = inputStr.charCodeAt(i++) & 0xff;\n    const byte3 = inputStr.charCodeAt(i++) & 0xff;\n\n    const enc1 = byte1 >> 2;\n    const enc2 = ((byte1 & 3) << 4) | (byte2 >> 4);\n\n    let enc3, enc4;\n    if (isNaN(byte2)) {\n      enc3 = enc4 = 64;\n    } else {\n      enc3 = ((byte2 & 15) << 2) | (byte3 >> 6);\n      if (isNaN(byte3)) {\n        enc4 = 64;\n      } else {\n        enc4 = byte3 & 63;\n      }\n    }\n\n    outputStr += b64.charAt(enc1) + b64.charAt(enc2) + b64.charAt(enc3) + b64.charAt(enc4);\n  }\n\n  return outputStr;\n}\n\n/**\n * Sugar that will use `nullishVal` if it's not null or undefined. Simulates the `??` operator\n * @param nullishVal\n * @param defaultVal\n */\nexport function nullish<T>(nullishVal: T | undefined | null, defaultVal: T): T {\n  return nullishVal !== null && nullishVal !== undefined ? nullishVal : defaultVal;\n}\n\n/**\n * Clamps a value between a min and max inclusive\n */\nexport function clamp(val: number, min: number, max: number) {\n  return Math.min(Math.max(min, val), max);\n}\n\n/**\n * Find a random floating point number in range\n */\nexport function randomInRange(min: number, max: number, random: Random = new Random()): number {\n  return random ? random.floating(min, max) : min + Math.random() * (max - min);\n}\n\n/**\n * Find a random integer in a range\n */\nexport function randomIntInRange(min: number, max: number, random: Random = new Random()): number {\n  return random ? random.integer(min, max) : Math.round(randomInRange(min, max));\n}\n\n/**\n * Convert an angle to be the equivalent in the range [0, 2PI]\n */\nexport function canonicalizeAngle(angle: number): number {\n  let tmpAngle = angle;\n  if (angle > TwoPI) {\n    while (tmpAngle > TwoPI) {\n      tmpAngle -= TwoPI;\n    }\n  }\n\n  if (angle < 0) {\n    while (tmpAngle < 0) {\n      tmpAngle += TwoPI;\n    }\n  }\n  return tmpAngle;\n}\n\n/**\n * Convert radians to degrees\n */\nexport function toDegrees(radians: number): number {\n  return (180 / Math.PI) * radians;\n}\n\n/**\n * Convert degrees to radians\n */\nexport function toRadians(degrees: number): number {\n  return (degrees / 180) * Math.PI;\n}\n\n/**\n * Find the screen position of an HTML element\n */\nexport function getPosition(el: HTMLElement): Vector {\n  let oLeft: number = 0,\n    oTop: number = 0;\n\n  const calcOffsetLeft = (parent: HTMLElement) => {\n    oLeft += parent.offsetLeft;\n\n    if (parent.offsetParent) {\n      calcOffsetLeft(<HTMLElement>parent.offsetParent);\n    }\n  };\n  const calcOffsetTop = (parent: HTMLElement) => {\n    oTop += parent.offsetTop;\n    if (parent.offsetParent) {\n      calcOffsetTop(<HTMLElement>parent.offsetParent);\n    }\n  };\n\n  calcOffsetLeft(el);\n  calcOffsetTop(el);\n\n  return new Vector(oLeft, oTop);\n}\n\n/**\n * Add an item to an array list if it doesn't already exist. Returns true if added, false if not and already exists in the array.\n * @deprecated Will be removed in v0.26.0\n */\nexport function addItemToArray<T>(item: T, array: T[]): boolean {\n  if (array.indexOf(item) === -1) {\n    array.push(item);\n    return true;\n  }\n  return false;\n}\n\n/**\n * Remove an item from an list\n * @deprecated Will be removed in v0.26.0\n */\nexport function removeItemFromArray<T>(item: T, array: T[]): boolean {\n  let index = -1;\n  if ((index = array.indexOf(item)) > -1) {\n    array.splice(index, 1);\n    return true;\n  }\n\n  return false;\n}\n\n/**\n * See if an array contains something\n */\nexport function contains(array: Array<any>, obj: any): boolean {\n  for (let i = 0; i < array.length; i++) {\n    if (array[i] === obj) {\n      return true;\n    }\n  }\n  return false;\n}\n\n/**\n * Get the opposit side\n * TODO: Move to Side type\n * @deprecated Will be removed in v0.26.0\n */\nexport function getOppositeSide(side: Side) {\n  if (side === Side.Top) {\n    return Side.Bottom;\n  }\n  if (side === Side.Bottom) {\n    return Side.Top;\n  }\n  if (side === Side.Left) {\n    return Side.Right;\n  }\n  if (side === Side.Right) {\n    return Side.Left;\n  }\n\n  return Side.None;\n}\n\n/**\n * Returns the side in the direction of the vector supplied\n * @param direction Vector to check\n * @deprecated\n * TODO: Move to Side type\n */\nexport function getSideFromDirection(direction: Vector) {\n  const directions = [Vector.Left, Vector.Right, Vector.Up, Vector.Down];\n  const directionEnum = [Side.Left, Side.Right, Side.Top, Side.Bottom];\n\n  let max = -Number.MAX_VALUE;\n  let maxIndex = -1;\n  for (let i = 0; i < directions.length; i++) {\n    if (directions[i].dot(direction) > max) {\n      max = directions[i].dot(direction);\n      maxIndex = i;\n    }\n  }\n  return directionEnum[maxIndex];\n}\n\n/**\n * Excalibur's dynamically resizing collection\n * @deprecated Will be removed v0.26.0\n */\nexport class Collection<T> {\n  /**\n   * Default collection size\n   */\n  public static DefaultSize = 200;\n  private _internalArray: T[] = null;\n  private _endPointer: number = 0;\n\n  /**\n   * @param initialSize  Initial size of the internal backing array\n   */\n  constructor(initialSize: number = Collection.DefaultSize) {\n    this._internalArray = new Array<T>(initialSize);\n  }\n\n  private _resize() {\n    const newSize = this._internalArray.length * 2;\n    const newArray = new Array<T>(newSize);\n    const count = this.count();\n    for (let i = 0; i < count; i++) {\n      newArray[i] = this._internalArray[i];\n    }\n\n    delete this._internalArray;\n    this._internalArray = newArray;\n  }\n\n  /**\n   * Push elements to the end of the collection\n   */\n  public push(element: T): T {\n    if (this._endPointer === this._internalArray.length) {\n      this._resize();\n    }\n    return (this._internalArray[this._endPointer++] = element);\n  }\n\n  /**\n   * Removes elements from the end of the collection\n   */\n  public pop(): T {\n    this._endPointer = this._endPointer - 1 < 0 ? 0 : this._endPointer - 1;\n    return this._internalArray[this._endPointer];\n  }\n\n  /**\n   * Returns the count of the collection\n   */\n  public count(): number {\n    return this._endPointer;\n  }\n\n  /**\n   * Empties the collection\n   */\n  public clear() {\n    this._endPointer = 0;\n  }\n\n  /**\n   * Returns the size of the internal backing array\n   */\n  public internalSize(): number {\n    return this._internalArray.length;\n  }\n\n  /**\n   * Returns an element at a specific index\n   * @param index  Index of element to retrieve\n   */\n  public elementAt(index: number): T {\n    if (index >= this.count()) {\n      //Logger.getInstance().error('Invalid parameter: ' + index);\n      throw new Error('Invalid index ' + index);\n    }\n    return this._internalArray[index];\n  }\n\n  /**\n   * Inserts an element at a specific index\n   * @param index  Index to insert the element\n   * @param value  Element to insert\n   */\n  public insert(index: number, value: T): T {\n    if (index >= this.count()) {\n      this._resize();\n    }\n    return (this._internalArray[index] = value);\n  }\n\n  /**\n   * Removes an element at a specific index\n   * @param index  Index of element to remove\n   */\n  public remove(index: number): T {\n    const count = this.count();\n    if (count === 0) {\n      //Logger.getInstance().error('Invalid parameter: ' + index);\n      throw new Error('Invalid parameter ' + index);\n    }\n    // O(n) Shift\n    const removed = this._internalArray[index];\n    for (let i = index; i < count; i++) {\n      this._internalArray[i] = this._internalArray[i + 1];\n    }\n    this._endPointer--;\n    return removed;\n  }\n\n  /**\n   * Removes an element by reference\n   * @param element  Element to retrieve\n   */\n  public removeElement(element: T) {\n    const index = this._internalArray.indexOf(element);\n    this.remove(index);\n  }\n\n  /**\n   * Returns a array representing the collection\n   */\n  public toArray(): T[] {\n    return this._internalArray.slice(0, this._endPointer);\n  }\n\n  /**\n   * Iterate over every element in the collection\n   * @param func  Callback to call for each element passing a reference to the element and its index, returned values are ignored\n   */\n  public forEach(func: (element: T, index: number) => any) {\n    let i = 0;\n    const count = this.count();\n    for (i; i < count; i++) {\n      func.call(this, this._internalArray[i], i);\n    }\n  }\n\n  /**\n   * Mutate every element in the collection\n   * @param func  Callback to call for each element passing a reference to the element and its index, any values returned mutate\n   * the collection\n   */\n  public map(func: (element: T, index: number) => any) {\n    const count = this.count();\n    for (let i = 0; i < count; i++) {\n      this._internalArray[i] = func.call(this, this._internalArray[i], i);\n    }\n  }\n}\n\n/**\n * Used for exhaustive checks at compile time\n */\nexport function fail(message: never): never {\n  throw new Error(message);\n}\n\n/**\n * Generate a range of numbers\n * For example: range(0, 5) -> [0, 1, 2, 3, 4, 5]\n * @param from inclusive\n * @param to inclusive\n */\nexport const range = (from: number, to: number) => Array.from(new Array(to - from + 1), (_x, i) => i + from);\n\n/**\n * Create a promise that resolves after a certain number of milliseconds\n * @param milliseconds\n */\nexport function delay(milliseconds: number): Promise<void> {\n  return new Promise((resolve) => {\n    setTimeout(() => {\n      resolve();\n    }, milliseconds);\n  });\n}\n","import { Flags } from '../Flags';\nimport { Logger } from './Log';\nimport { extend } from './Util';\n\n/**\n * Obsolete decorator options\n */\nexport interface ObsoleteOptions {\n  // Optionally specify a custom message\n  message?: string;\n  // Optionally indicate that an alternate method to the obsolete one exists\n  alternateMethod?: string;\n  // Optional show stack trace, by default off\n  showStackTrace?: boolean;\n}\n\nexport const maxMessages = 5;\nconst obsoleteMessage: { [messageCount: string]: number } = {};\nexport const resetObsoleteCounter = () => {\n  for (const message in obsoleteMessage) {\n    obsoleteMessage[message] = 0;\n  }\n};\n\nconst logMessage = (message: string, options: ObsoleteOptions) => {\n  const suppressObsoleteMessages = Flags.isEnabled('suppress-obsolete-message');\n  if (obsoleteMessage[message] < maxMessages && !suppressObsoleteMessages) {\n    Logger.getInstance().warn(message);\n\n    // tslint:disable-next-line: no-console\n    if (console.trace && options.showStackTrace) {\n      // tslint:disable-next-line: no-console\n      console.trace();\n    }\n  }\n  obsoleteMessage[message]++;\n};\n\n/**\n * Obsolete decorator for marking Excalibur methods obsolete, you can optionally specify a custom message and/or alternate replacement\n * method do the deprecated one. Inspired by https://github.com/jayphelps/core-decorators.js\n */\nexport function obsolete(options?: ObsoleteOptions): any {\n  options = extend(\n    {},\n    {\n      message: 'This feature will be removed in future versions of Excalibur.',\n      alternateMethod: null,\n      showStackTrack: false\n    },\n    options\n  );\n\n  return function (target: any, property: string, descriptor: PropertyDescriptor): any {\n    if (\n      descriptor &&\n      !(typeof descriptor.value === 'function' || typeof descriptor.get === 'function' || typeof descriptor.set === 'function')\n    ) {\n      throw new SyntaxError('Only classes/functions/getters/setters can be marked as obsolete');\n    }\n    const methodSignature = `${target.name || ''}${target.name && property ? '.' : ''}${property ? property : ''}`;\n\n    const message =\n      `${methodSignature} is marked obsolete: ${options.message}` +\n      (options.alternateMethod ? ` Use ${options.alternateMethod} instead` : '');\n\n    if (!obsoleteMessage[message]) {\n      obsoleteMessage[message] = 0;\n    }\n\n    // If descriptor is null it is a class\n    const method = descriptor ? { ...descriptor } : target;\n    if (!descriptor) {\n      // with es2015 classes we need to change our decoration tactic\n      class DecoratedClass extends method {\n        constructor(...args: any) {\n          logMessage(message, options);\n          super(...args);\n        }\n      }\n      return DecoratedClass;\n    }\n\n    if (descriptor && descriptor.value) {\n      method.value = function (this: any) {\n        logMessage(message, options);\n        return descriptor.value.apply(this, arguments);\n      };\n      return method;\n    }\n\n    if (descriptor && descriptor.get) {\n      method.get = function (this: any) {\n        logMessage(message, options);\n        return descriptor.get.apply(this, arguments);\n      };\n    }\n\n    if (descriptor && descriptor.set) {\n      method.set = function (this: any) {\n        logMessage(message, options);\n        return descriptor.set.apply(this, arguments);\n      };\n    }\n    return method;\n  };\n}\n","import { Clonable } from '../Interfaces/Clonable';\nimport { obsolete } from '../Util/Decorators';\n\n/**\n * A 2D vector on a plane.\n */\n\nexport class Vector implements Clonable<Vector> {\n  /**\n   * A (0, 0) vector\n   */\n  public static get Zero() {\n    return new Vector(0, 0);\n  }\n\n  /**\n   * A (1, 1) vector\n   */\n  public static get One() {\n    return new Vector(1, 1);\n  }\n\n  /**\n   * A (0.5, 0.5) vector\n   */\n  public static get Half() {\n    return new Vector(0.5, 0.5);\n  }\n\n  /**\n   * A unit vector pointing up (0, -1)\n   */\n  public static get Up() {\n    return new Vector(0, -1);\n  }\n\n  /**\n   * A unit vector pointing down (0, 1)\n   */\n  public static get Down() {\n    return new Vector(0, 1);\n  }\n\n  /**\n   * A unit vector pointing left (-1, 0)\n   */\n  public static get Left() {\n    return new Vector(-1, 0);\n  }\n  /**\n   * A unit vector pointing right (1, 0)\n   */\n  public static get Right() {\n    return new Vector(1, 0);\n  }\n\n  /**\n   * Returns a vector of unit length in the direction of the specified angle in Radians.\n   * @param angle The angle to generate the vector\n   */\n  public static fromAngle(angle: number) {\n    return new Vector(Math.cos(angle), Math.sin(angle));\n  }\n\n  /**\n   * Checks if vector is not null, undefined, or if any of its components are NaN or Infinity.\n   */\n  public static isValid(vec: Vector) {\n    if (vec === null || vec === undefined) {\n      return false;\n    }\n    if (isNaN(vec.x) || isNaN(vec.y)) {\n      return false;\n    }\n\n    if (vec.x === Infinity || vec.y === Infinity || vec.x === -Infinity || vec.y === -Infinity) {\n      return false;\n    }\n\n    return true;\n  }\n\n  /**\n   * Calculates distance between two Vectors\n   * @param vec1\n   * @param vec2\n   */\n  public static distance(vec1: Vector, vec2: Vector) {\n    return Math.sqrt(Math.pow(vec1.x - vec2.x, 2) + Math.pow(vec1.y - vec2.y, 2));\n  }\n\n  /**\n   * @param x  X component of the Vector\n   * @param y  Y component of the Vector\n   */\n  constructor(x: number, y: number) {\n    this._x = x;\n    this._y = y;\n  }\n\n  protected _x = 0;\n  /**\n   * Get the x component of the vector\n   */\n  public get x(): number {\n    return this._x;\n  }\n\n  /**\n   * Set the x component, THIS MUTATES the current vector. It is usually better to create a new vector.\n   * @warning **Be very careful setting components on shared vectors, mutating shared vectors can cause hard to find bugs**\n   */\n  public set x(val: number) {\n    this._x = val;\n  }\n\n  protected _y = 0;\n  /**\n   * Get the y component of the vector\n   */\n  public get y(): number {\n    return this._y;\n  }\n\n  /**\n   * Set the y component, THIS MUTATES the current vector. It is usually better to create a new vector.\n   * @warning **Be very careful setting components on shared vectors, mutating shared vectors can cause hard to find bugs**\n   */\n  public set y(val: number) {\n    this._y = val;\n  }\n\n  /**\n   * Sets the x and y components at once, THIS MUTATES the current vector. It is usually better to create a new vector.\n   *\n   * @warning **Be very careful using this, mutating vectors can cause hard to find bugs**\n   */\n  setTo(x: number, y: number) {\n    (this.x as number) = x;\n    (this.y as number) = y;\n  }\n\n  /**\n   * Compares this point against another and tests for equality\n   * @param vector The other point to compare to\n   * @param tolerance Amount of euclidean distance off we are willing to tolerate\n   */\n  public equals(vector: Vector, tolerance: number = 0.001): boolean {\n    return Math.abs(this.x - vector.x) <= tolerance && Math.abs(this.y - vector.y) <= tolerance;\n  }\n\n  /**\n   * The distance to another vector. If no other Vector is specified, this will return the [[magnitude]].\n   * @param v  The other vector. Leave blank to use origin vector.\n   */\n  public distance(v?: Vector): number {\n    if (!v) {\n      v = Vector.Zero;\n    }\n    return Math.sqrt(Math.pow(this.x - v.x, 2) + Math.pow(this.y - v.y, 2));\n  }\n\n  public squareDistance(v?: Vector): number {\n    if (!v) {\n      v = Vector.Zero;\n    }\n    return Math.pow(this.x - v.x, 2) + Math.pow(this.y - v.y, 2);\n  }\n\n  /**\n   * The magnitude (size) of the Vector\n   * @obsolete magnitude will be removed in favour of '.size' in version 0.25.0\n   */\n  @obsolete({ message: 'will be removed in favour of `.size` in version 0.25.0' })\n  public magnitude(): number {\n    return this.distance();\n  }\n\n  /**\n   * The size (magnitude) of the Vector\n   */\n  public get size(): number {\n    return this.distance();\n  }\n\n  /**\n   * Setting the size mutates the current vector\n   *\n   * @warning Can be used to set the size of the vector, **be very careful using this, mutating vectors can cause hard to find bugs**\n   */\n  public set size(newLength: number) {\n    const v = this.normalize().scale(newLength);\n    this.setTo(v.x, v.y);\n  }\n\n  /**\n   * Normalizes a vector to have a magnitude of 1.\n   */\n  public normalize(): Vector {\n    const d = this.distance();\n    if (d > 0) {\n      return new Vector(this.x / d, this.y / d);\n    } else {\n      return new Vector(0, 1);\n    }\n  }\n\n  /**\n   * Returns the average (midpoint) between the current point and the specified\n   */\n  public average(vec: Vector): Vector {\n    return this.add(vec).scale(0.5);\n  }\n\n  /**\n   * Scales a vector's by a factor of size\n   * @param size  The factor to scale the magnitude by\n   */\n  public scale(scale: Vector): Vector;\n  public scale(size: number): Vector;\n  public scale(sizeOrScale: number | Vector): Vector {\n    if (sizeOrScale instanceof Vector) {\n      return new Vector(this.x * sizeOrScale.x, this.y * sizeOrScale.y);\n    } else {\n      return new Vector(this.x * sizeOrScale, this.y * sizeOrScale);\n    }\n  }\n\n  /**\n   * Adds one vector to another\n   * @param v The vector to add\n   */\n  public add(v: Vector): Vector {\n    return new Vector(this.x + v.x, this.y + v.y);\n  }\n\n  /**\n   * Subtracts a vector from another, if you subtract vector `B.sub(A)` the resulting vector points from A -> B\n   * @param v The vector to subtract\n   */\n  public sub(v: Vector): Vector {\n    return new Vector(this.x - v.x, this.y - v.y);\n  }\n\n  /**\n   * Adds one vector to this one modifying the original\n   * @param v The vector to add\n   * @warning Be very careful using this, mutating vectors can cause hard to find bugs\n   */\n  public addEqual(v: Vector): Vector {\n    this.setTo(this.x + v.x, this.y + v.y);\n    return this;\n  }\n\n  /**\n   * Subtracts a vector from this one modifying the original\n   * @param v The vector to subtract\n   * @warning Be very careful using this, mutating vectors can cause hard to find bugs\n   */\n  public subEqual(v: Vector): Vector {\n    this.setTo(this.x - v.x, this.y - v.y);\n    return this;\n  }\n\n  /**\n   * Scales this vector by a factor of size and modifies the original\n   * @warning Be very careful using this, mutating vectors can cause hard to find bugs\n   */\n  public scaleEqual(size: number): Vector {\n    this.setTo(this.x * size, this.y * size);\n    return this;\n  }\n\n  /**\n   * Performs a dot product with another vector\n   * @param v  The vector to dot\n   */\n  public dot(v: Vector): number {\n    return this.x * v.x + this.y * v.y;\n  }\n\n  /**\n   * Performs a 2D cross product with scalar. 2D cross products with a scalar return a vector.\n   * @param v  The scalar to cross\n   */\n  public cross(v: number): Vector;\n  /**\n   * Performs a 2D cross product with another vector. 2D cross products return a scalar value not a vector.\n   * @param v  The vector to cross\n   */\n  public cross(v: Vector): number;\n  public cross(v: any): any {\n    if (v instanceof Vector) {\n      return this.x * v.y - this.y * v.x;\n    } else if (typeof v === 'number') {\n      return new Vector(v * this.y, -v * this.x);\n    }\n  }\n\n  static cross(num: number, vec: Vector): Vector {\n    return new Vector(-num * vec.y, num * vec.x);\n  }\n\n  /**\n   * Returns the perpendicular vector to this one\n   */\n  public perpendicular(): Vector {\n    return new Vector(this.y, -this.x);\n  }\n\n  /**\n   * Returns the normal vector to this one, same as the perpendicular of length 1\n   */\n  public normal(): Vector {\n    return this.perpendicular().normalize();\n  }\n\n  /**\n   * Negate the current vector\n   */\n  public negate(): Vector {\n    return this.scale(-1);\n  }\n\n  /**\n   * Returns the angle of this vector.\n   */\n  public toAngle(): number {\n    return Math.atan2(this.y, this.x);\n  }\n\n  /**\n   * Rotates the current vector around a point by a certain number of\n   * degrees in radians\n   */\n  public rotate(angle: number, anchor?: Vector): Vector {\n    if (!anchor) {\n      anchor = new Vector(0, 0);\n    }\n    const sinAngle = Math.sin(angle);\n    const cosAngle = Math.cos(angle);\n    const x = cosAngle * (this.x - anchor.x) - sinAngle * (this.y - anchor.y) + anchor.x;\n    const y = sinAngle * (this.x - anchor.x) + cosAngle * (this.y - anchor.y) + anchor.y;\n    return new Vector(x, y);\n  }\n\n  /**\n   * Creates new vector that has the same values as the previous.\n   */\n  public clone(): Vector {\n    return new Vector(this.x, this.y);\n  }\n\n  /**\n   * Returns a string representation of the vector.\n   */\n  public toString(fixed?: number): string {\n    if (fixed) {\n      return `(${this.x.toFixed(fixed)}, ${this.y.toFixed(fixed)})`;\n    }\n    return `(${this.x}, ${this.y})`;\n  }\n}\n\n/**\n * Shorthand for creating new Vectors - returns a new Vector instance with the\n * provided X and Y components.\n *\n * @param x  X component of the Vector\n * @param y  Y component of the Vector\n */\nexport function vec(x: number, y: number): Vector {\n  return new Vector(x, y);\n}\n","import { Vector } from './Math/vector';\nimport { Logger } from './Util/Log';\nimport { Camera } from './Camera';\nimport { BrowserEvents } from './Util/Browser';\nimport { BoundingBox } from './Collision/Index';\nimport { ExcaliburGraphicsContext } from './Graphics/Context/ExcaliburGraphicsContext';\nimport { getPosition } from './Util/Util';\n\n/**\n * Enum representing the different display modes available to Excalibur.\n */\nexport enum DisplayMode {\n  /**\n   * Default, use a specified resolution for the game. Like 800x600 pixels for example.\n   */\n  Fixed = 'Fixed',\n\n  /**\n   * Fit to screen using as much space as possible while maintaining aspect ratio and resolution.\n   * This is not the same as [[Screen.goFullScreen]] but behaves in a similar way maintaining aspect ratio.\n   *\n   * You may want to center your game here is an example\n   * ```html\n   * <!-- html -->\n   * <body>\n   * <main>\n   *   <canvas id=\"game\"></canvas>\n   * </main>\n   * </body>\n   * ```\n   *\n   * ```css\n   * // css\n   * main {\n   *   display: flex;\n   *   align-items: center;\n   *   justify-content: center;\n   *   height: 100%;\n   *   width: 100%;\n   * }\n   * ```\n   *\n   */\n  FitScreen = 'FitScreen',\n\n  /**\n   * Fill the entire screen's css width/height for the game resolution dynamically. This means the resolution of the game will\n   * change dynamically as the window is resized. This is not the same as [[Screen.goFullScreen]]\n   */\n  FillScreen = 'FillScreen',\n\n  /**\n   * Fit to parent element width/height using as much space as possible while maintaining aspect ratio and resolution.\n   */\n  FitContainer = 'FitContainer',\n\n  /**\n   * Use the parent DOM container's css width/height for the game resolution dynamically\n   */\n  FillContainer = 'FillContainer',\n\n  /**\n   * Allow the game to be positioned with the [[EngineOptions.position]] option\n   * @deprecated Use CSS to position the game canvas, will be removed in v0.26.0\n   */\n  Position = 'Position'\n}\n\n/**\n * Convenience class for quick resolutions\n * Mostly sourced from https://emulation.gametechwiki.com/index.php/Resolution\n */\nexport class Resolution {\n  /* istanbul ignore next */\n  public static get SVGA(): ScreenDimension {\n    return { width: 800, height: 600 };\n  }\n\n  /* istanbul ignore next */\n  public static get Standard(): ScreenDimension {\n    return { width: 1920, height: 1080 };\n  }\n\n  /* istanbul ignore next */\n  public static get Atari2600(): ScreenDimension {\n    return { width: 160, height: 192 };\n  }\n\n  /* istanbul ignore next */\n  public static get GameBoy(): ScreenDimension {\n    return { width: 160, height: 144 };\n  }\n\n  /* istanbul ignore next */\n  public static get GameBoyAdvance(): ScreenDimension {\n    return { width: 240, height: 160 };\n  }\n\n  /* istanbul ignore next */\n  public static get NintendoDS(): ScreenDimension {\n    return { width: 256, height: 192 };\n  }\n\n  /* istanbul ignore next */\n  public static get NES(): ScreenDimension {\n    return { width: 256, height: 224 };\n  }\n\n  /* istanbul ignore next */\n  public static get SNES(): ScreenDimension {\n    return { width: 256, height: 244 };\n  }\n}\n\n/**\n * Interface describing the absolute CSS position of the game window. For use when [[DisplayMode.Position]]\n * is specified and when the user wants to define exact pixel spacing of the window.\n * When a number is given, the value is interpreted as pixels\n */\nexport interface AbsolutePosition {\n  top?: number | string;\n  left?: number | string;\n  right?: number | string;\n  bottom?: number | string;\n}\n\nexport type CanvasPosition = string | AbsolutePosition;\n\nexport interface ScreenDimension {\n  width: number;\n  height: number;\n}\n\nexport interface ScreenOptions {\n  /**\n   * Canvas element to build a screen on\n   */\n  canvas: HTMLCanvasElement;\n  /**\n   * Graphics context for the screen\n   */\n  context: ExcaliburGraphicsContext;\n\n  /**\n   * Browser abstraction\n   */\n  browser: BrowserEvents;\n  /**\n   * Optionally set antialiasing, defaults to true. If set to true, images will be smoothed\n   */\n  antialiasing?: boolean;\n  /**\n   * Optionally override the pixel ratio to use for the screen, otherwise calculated automatically from the browser\n   */\n  pixelRatio?: number;\n  /**\n   * Optionally specify the actual pixel resolution in width/height pixels (also known as logical resolution), by default the\n   * resolution will be the same as the viewport. Resolution will be overridden by [[DisplayMode.FillContainer]] and\n   * [[DisplayMode.FillScreen]].\n   */\n  resolution?: ScreenDimension;\n  /**\n   * Visual viewport size in css pixel, if resolution is not specified it will be the same as the viewport\n   */\n  viewport: ScreenDimension;\n  /**\n   * Set the display mode of the screen, by default DisplayMode.Fixed.\n   */\n  displayMode?: DisplayMode;\n  /**\n   * Specify how the game window is to be positioned when the [[DisplayMode.Position]] is chosen. This option MUST be specified\n   * if the DisplayMode is set as [[DisplayMode.Position]]. The position can be either a string or an [[AbsolutePosition]].\n   * String must be in the format of css style background-position. The vertical position must precede the horizontal position in strings.\n   *\n   * Valid String examples: \"top left\", \"top\", \"bottom\", \"middle\", \"middle center\", \"bottom right\"\n   * Valid [[AbsolutePosition]] examples: `{top: 5, right: 10%}`, `{bottom: 49em, left: 10px}`, `{left: 10, bottom: 40}`\n   */\n  position?: CanvasPosition;\n}\n\n/**\n * The Screen handles all aspects of interacting with the screen for Excalibur.\n */\nexport class Screen {\n  private _canvas: HTMLCanvasElement;\n  private _ctx: ExcaliburGraphicsContext;\n  private _antialiasing: boolean = true;\n  private _browser: BrowserEvents;\n  private _camera: Camera;\n  private _resolution: ScreenDimension;\n  private _resolutionStack: ScreenDimension[] = [];\n  private _viewport: ScreenDimension;\n  private _viewportStack: ScreenDimension[] = [];\n  private _pixelRatioOverride: number | null = null;\n  private _position: CanvasPosition;\n  private _displayMode: DisplayMode;\n  private _isFullScreen = false;\n  private _mediaQueryList: MediaQueryList;\n  private _isDisposed = false;\n  private _logger = Logger.getInstance();\n  private _resizeObserver: ResizeObserver;\n\n  constructor(options: ScreenOptions) {\n    this.viewport = options.viewport;\n    this.resolution = options.resolution ?? { ...this.viewport };\n    this._displayMode = options.displayMode ?? DisplayMode.Fixed;\n    this._canvas = options.canvas;\n    this._ctx = options.context;\n    this._antialiasing = options.antialiasing ?? this._antialiasing;\n    this._browser = options.browser;\n    this._position = options.position;\n    this._pixelRatioOverride = options.pixelRatio;\n    this._applyDisplayMode();\n\n    this._mediaQueryList = this._browser.window.nativeComponent.matchMedia(`(resolution: ${window.devicePixelRatio}dppx)`);\n    this._mediaQueryList.addEventListener('change', this._pixelRatioChangeHandler);\n\n    this._canvas.addEventListener('fullscreenchange', this._fullscreenChangeHandler);\n  }\n\n  public dispose(): void {\n    if (!this._isDisposed) {\n      // Clean up handlers\n      this._isDisposed = true;\n      this._browser.window.off('resize', this._resizeHandler);\n      if (this._resizeObserver) {\n        this._resizeObserver.disconnect();\n      }\n      this.parent.removeEventListener('resize', this._resizeHandler);\n      this._mediaQueryList.removeEventListener('change', this._pixelRatioChangeHandler);\n      this._canvas.removeEventListener('fullscreenchange', this._fullscreenChangeHandler);\n    }\n  }\n\n  private _fullscreenChangeHandler = () => {\n    this._isFullScreen = !this._isFullScreen;\n    this._logger.debug('Fullscreen Change', this._isFullScreen);\n  };\n\n  private _pixelRatioChangeHandler = () => {\n    this._logger.debug('Pixel Ratio Change', window.devicePixelRatio);\n    this._devicePixelRatio = this._calculateDevicePixelRatio();\n    this.applyResolutionAndViewport();\n  };\n\n  private _resizeHandler = () => {\n    const parent = this.parent;\n    this._logger.debug('View port resized');\n    this._setResolutionAndViewportByDisplayMode(parent);\n    this.applyResolutionAndViewport();\n  };\n\n  private _calculateDevicePixelRatio() {\n    if (window.devicePixelRatio < 1) {\n      return 1;\n    }\n\n    const devicePixelRatio = window.devicePixelRatio || 1;\n\n    return devicePixelRatio;\n  }\n\n  // Asking the window.devicePixelRatio is expensive we do it once\n  private _devicePixelRatio = this._calculateDevicePixelRatio();\n\n  public get pixelRatio(): number {\n    if (this._pixelRatioOverride) {\n      return this._pixelRatioOverride;\n    }\n\n    return this._devicePixelRatio;\n  }\n\n  public get isHiDpi() {\n    return this.pixelRatio !== 1;\n  }\n\n  public get displayMode(): DisplayMode {\n    return this._displayMode;\n  }\n\n  public get canvas(): HTMLCanvasElement {\n    return this._canvas;\n  }\n\n  public get parent(): HTMLElement | Window {\n    return <HTMLElement | Window>(\n      (this.displayMode === DisplayMode.FillContainer || this.displayMode === DisplayMode.FitContainer\n        ? this.canvas.parentElement || document.body\n        : window)\n    );\n  }\n\n  public get resolution(): ScreenDimension {\n    return this._resolution;\n  }\n\n  public set resolution(resolution: ScreenDimension) {\n    this._resolution = resolution;\n  }\n\n  public get viewport(): ScreenDimension {\n    if (this._viewport) {\n      return this._viewport;\n    }\n    return this._resolution;\n  }\n\n  public set viewport(viewport: ScreenDimension) {\n    this._viewport = viewport;\n  }\n\n  public get aspectRatio() {\n    return this._resolution.width / this._resolution.height;\n  }\n\n  public get scaledWidth() {\n    return this._resolution.width * this.pixelRatio;\n  }\n\n  public get scaledHeight() {\n    return this._resolution.height * this.pixelRatio;\n  }\n\n  public setCurrentCamera(camera: Camera) {\n    this._camera = camera;\n  }\n\n  public pushResolutionAndViewport() {\n    this._resolutionStack.push(this.resolution);\n    this._viewportStack.push(this.viewport);\n\n    this.resolution = { ...this.resolution };\n    this.viewport = { ...this.viewport };\n  }\n\n  public popResolutionAndViewport() {\n    this.resolution = this._resolutionStack.pop();\n    this.viewport = this._viewportStack.pop();\n  }\n\n  public applyResolutionAndViewport() {\n    this._canvas.width = this.scaledWidth;\n    this._canvas.height = this.scaledHeight;\n\n    if (this._antialiasing) {\n      this._canvas.style.imageRendering = 'auto';\n    } else {\n      this._canvas.style.imageRendering = 'pixelated';\n      // Fall back to 'crisp-edges' if 'pixelated' is not supported\n      // Currently for firefox https://developer.mozilla.org/en-US/docs/Web/CSS/image-rendering\n      if (this._canvas.style.imageRendering === '') {\n        this._canvas.style.imageRendering = 'crisp-edges';\n      }\n    }\n    this._canvas.style.width = this.viewport.width + 'px';\n    this._canvas.style.height = this.viewport.height + 'px';\n\n    // After messing with the canvas width/height the graphics context is invalidated and needs to have some properties reset\n    this._ctx.updateViewport();\n    this._ctx.resetTransform();\n    this._ctx.scale(this.pixelRatio, this.pixelRatio);\n    this._ctx.smoothing = this._antialiasing;\n  }\n\n  public get antialiasing() {\n    return this._antialiasing;\n  }\n\n  public set antialiasing(isSmooth: boolean) {\n    this._antialiasing = isSmooth;\n    this._ctx.smoothing = this._antialiasing;\n  }\n\n  /**\n   * Returns true if excalibur is fullscreened using the browser fullscreen api\n   */\n  public get isFullScreen() {\n    return this._isFullScreen;\n  }\n\n  /**\n   * Requests to go fullscreen using the browser fullscreen api, requires user interaction to be successful.\n   * For example, wire this to a user click handler.\n   */\n  public goFullScreen(): Promise<void> {\n    return this._canvas.requestFullscreen();\n  }\n\n  /**\n   * Requests to exit fullscreen using the browser fullscreen api\n   */\n  public exitFullScreen(): Promise<void> {\n    return document.exitFullscreen();\n  }\n\n  /**\n   * Takes a coordinate in normal html page space, for example from a pointer move event, and translates it to\n   * Excalibur screen space.\n   *\n   * Excalibur screen space starts at the top left (0, 0) corner of the viewport, and extends to the\n   * bottom right corner (resolutionX, resolutionY)\n   * @param point\n   */\n  public pageToScreenCoordinates(point: Vector): Vector {\n    let newX = point.x;\n    let newY = point.y;\n\n    if (!this._isFullScreen) {\n      newX -= getPosition(this._canvas).x;\n      newY -= getPosition(this._canvas).y;\n    }\n\n    // if fullscreen api on it centers with black bars\n    // we need to adjust the screen to world coordinates in this case\n    if (this._isFullScreen) {\n      if (window.innerWidth / this.aspectRatio < window.innerHeight) {\n        const screenHeight = window.innerWidth / this.aspectRatio;\n        const screenMarginY = (window.innerHeight - screenHeight) / 2;\n        newY = ((newY - screenMarginY) / screenHeight) * this.viewport.height;\n        newX = (newX / window.innerWidth) * this.viewport.width;\n      } else {\n        const screenWidth = window.innerHeight * this.aspectRatio;\n        const screenMarginX = (window.innerWidth - screenWidth) / 2;\n        newX = ((newX - screenMarginX) / screenWidth) * this.viewport.width;\n        newY = (newY / window.innerHeight) * this.viewport.height;\n      }\n    }\n\n    newX = (newX / this.viewport.width) * this.resolution.width;\n    newY = (newY / this.viewport.height) * this.resolution.height;\n\n    return new Vector(newX, newY);\n  }\n\n  /**\n   * Takes a coordinate in Excalibur screen space, and translates it to normal html page space. For example,\n   * this is where html elements might live if you want to position them relative to Excalibur.\n   *\n   * Excalibur screen space starts at the top left (0, 0) corner of the viewport, and extends to the\n   * bottom right corner (resolutionX, resolutionY)\n   * @param point\n   */\n  public screenToPageCoordinates(point: Vector): Vector {\n    let newX = point.x;\n    let newY = point.y;\n\n    newX = (newX / this.resolution.width) * this.viewport.width;\n    newY = (newY / this.resolution.height) * this.viewport.height;\n\n    if (this._isFullScreen) {\n      if (window.innerWidth / this.aspectRatio < window.innerHeight) {\n        const screenHeight = window.innerWidth / this.aspectRatio;\n        const screenMarginY = (window.innerHeight - screenHeight) / 2;\n        newY = (newY / this.viewport.height) * screenHeight + screenMarginY;\n        newX = (newX / this.viewport.width) * window.innerWidth;\n      } else {\n        const screenWidth = window.innerHeight * this.aspectRatio;\n        const screenMarginX = (window.innerWidth - screenWidth) / 2;\n        newX = (newX / this.viewport.width) * screenWidth + screenMarginX;\n        newY = (newY / this.viewport.height) * window.innerHeight;\n      }\n    }\n\n    if (!this._isFullScreen) {\n      newX += getPosition(this._canvas).x;\n      newY += getPosition(this._canvas).y;\n    }\n\n    return new Vector(newX, newY);\n  }\n\n  /**\n   * Takes a coordinate in Excalibur screen space, and translates it to Excalibur world space.\n   *\n   * World space is where [[Entity|entities]] in Excalibur live by default [[CoordPlane.World]]\n   * and extends infinitely out relative from the [[Camera]].\n   * @param point  Screen coordinate to convert\n   */\n  public screenToWorldCoordinates(point: Vector): Vector {\n    let newX = point.x;\n    let newY = point.y;\n\n    // transform back to world space\n    newX = (newX / this.resolution.width) * this.drawWidth;\n    newY = (newY / this.resolution.height) * this.drawHeight;\n\n    // transform based on zoom\n    newX = newX - this.halfDrawWidth;\n    newY = newY - this.halfDrawHeight;\n\n    // shift by camera focus\n    newX += this._camera?.x ?? 0;\n    newY += this._camera?.y ?? 0;\n\n    return new Vector(newX, newY);\n  }\n\n  /**\n   * Takes a coordinate in Excalibur world space, and translates it to Excalibur screen space.\n   *\n   * Screen space is where [[ScreenElement|screen elements]] and [[Entity|entities]] with [[CoordPlane.Screen]] live.\n   * @param point  World coordinate to convert\n   */\n  public worldToScreenCoordinates(point: Vector): Vector {\n    let screenX = point.x;\n    let screenY = point.y;\n\n    // shift by camera focus\n    screenX -= this._camera?.x ?? 0;\n    screenY -= this._camera?.y ?? 0;\n\n    // transform back on zoom\n    screenX = screenX + this.halfDrawWidth;\n    screenY = screenY + this.halfDrawHeight;\n\n    // transform back to screen space\n    screenX = (screenX / this.drawWidth) * this.resolution.width;\n    screenY = (screenY / this.drawHeight) * this.resolution.height;\n\n    return new Vector(screenX, screenY);\n  }\n\n  public pageToWorldCoordinates(point: Vector): Vector {\n    const screen = this.pageToScreenCoordinates(point);\n    return this.screenToWorldCoordinates(screen);\n  }\n\n  public worldToPageCoordinates(point: Vector): Vector {\n    const screen = this.worldToScreenCoordinates(point);\n    return this.screenToPageCoordinates(screen);\n  }\n\n  /**\n   * Returns a BoundingBox of the top left corner of the screen\n   * and the bottom right corner of the screen.\n   *\n   * World bounds are in world coordinates, useful for culling objects offscreen\n   */\n  public getWorldBounds(): BoundingBox {\n    const left = this.screenToWorldCoordinates(Vector.Zero).x;\n    const top = this.screenToWorldCoordinates(Vector.Zero).y;\n    const right = left + this.drawWidth;\n    const bottom = top + this.drawHeight;\n\n    return new BoundingBox(left, top, right, bottom);\n  }\n\n  /**\n   * The width of the game canvas in pixels (physical width component of the\n   * resolution of the canvas element)\n   */\n  public get canvasWidth(): number {\n    return this.canvas.width;\n  }\n\n  /**\n   * Returns half width of the game canvas in pixels (half physical width component)\n   */\n  public get halfCanvasWidth(): number {\n    return this.canvas.width / 2;\n  }\n\n  /**\n   * The height of the game canvas in pixels, (physical height component of\n   * the resolution of the canvas element)\n   */\n  public get canvasHeight(): number {\n    return this.canvas.height;\n  }\n\n  /**\n   * Returns half height of the game canvas in pixels (half physical height component)\n   */\n  public get halfCanvasHeight(): number {\n    return this.canvas.height / 2;\n  }\n\n  /**\n   * Returns the width of the engine's visible drawing surface in pixels including zoom and device pixel ratio.\n   */\n  public get drawWidth(): number {\n    if (this._camera) {\n      return this.scaledWidth / this._camera.zoom / this.pixelRatio;\n    }\n    return this.scaledWidth / this.pixelRatio;\n  }\n\n  /**\n   * Returns half the width of the engine's visible drawing surface in pixels including zoom and device pixel ratio.\n   */\n  public get halfDrawWidth(): number {\n    return this.drawWidth / 2;\n  }\n\n  /**\n   * Returns the height of the engine's visible drawing surface in pixels including zoom and device pixel ratio.\n   */\n  public get drawHeight(): number {\n    if (this._camera) {\n      return this.scaledHeight / this._camera.zoom / this.pixelRatio;\n    }\n    return this.scaledHeight / this.pixelRatio;\n  }\n\n  /**\n   * Returns half the height of the engine's visible drawing surface in pixels including zoom and device pixel ratio.\n   */\n  public get halfDrawHeight(): number {\n    return this.drawHeight / 2;\n  }\n\n  private _computeFit() {\n    document.body.style.margin = '0px';\n    document.body.style.overflow = 'hidden';\n    const aspect = this.aspectRatio;\n    let adjustedWidth = 0;\n    let adjustedHeight = 0;\n    if (window.innerWidth / aspect < window.innerHeight) {\n      adjustedWidth = window.innerWidth;\n      adjustedHeight = window.innerWidth / aspect;\n    } else {\n      adjustedWidth = window.innerHeight * aspect;\n      adjustedHeight = window.innerHeight;\n    }\n\n    this.viewport = {\n      width: adjustedWidth,\n      height: adjustedHeight\n    };\n  }\n\n  private _computeFitContainer() {\n    const aspect = this.aspectRatio;\n    let adjustedWidth = 0;\n    let adjustedHeight = 0;\n    const parent = this.canvas.parentElement;\n    if (parent.clientWidth / aspect < parent.clientHeight) {\n      adjustedWidth = parent.clientWidth;\n      adjustedHeight = parent.clientWidth / aspect;\n    } else {\n      adjustedWidth = parent.clientHeight * aspect;\n      adjustedHeight = parent.clientHeight;\n    }\n\n    this.viewport = {\n      width: adjustedWidth,\n      height: adjustedHeight\n    };\n  }\n\n  private _applyDisplayMode() {\n    if (this.displayMode === DisplayMode.Position) {\n      this._initializeDisplayModePosition(this._position);\n    } else {\n      this._setResolutionAndViewportByDisplayMode(this.parent);\n\n      // watch resizing\n      if (this.parent instanceof Window) {\n        this._browser.window.on('resize', this._resizeHandler);\n      } else {\n        this._resizeObserver = new ResizeObserver(() => {\n          this._resizeHandler();\n        });\n        this._resizeObserver.observe(this.parent);\n      }\n      this.parent.addEventListener('resize', this._resizeHandler);\n    }\n  }\n\n  /**\n   * Sets the resoultion and viewport based on the selected display mode.\n   */\n  private _setResolutionAndViewportByDisplayMode(parent: HTMLElement | Window) {\n    if (this.displayMode === DisplayMode.FillContainer) {\n      this.resolution = {\n        width: (<HTMLElement>parent).clientWidth,\n        height: (<HTMLElement>parent).clientHeight\n      };\n\n      this.viewport = this.resolution;\n    }\n\n    if (this.displayMode === DisplayMode.FillScreen) {\n      document.body.style.margin = '0px';\n      document.body.style.overflow = 'hidden';\n      this.resolution = {\n        width: (<Window>parent).innerWidth,\n        height: (<Window>parent).innerHeight\n      };\n\n      this.viewport = this.resolution;\n    }\n\n    if (this.displayMode === DisplayMode.FitScreen) {\n      this._computeFit();\n    }\n\n    if (this.displayMode === DisplayMode.FitContainer) {\n      this._computeFitContainer();\n    }\n  }\n\n  private _initializeDisplayModePosition(position: CanvasPosition) {\n    if (!position) {\n      throw new Error('DisplayMode of Position was selected but no position option was given');\n    } else {\n      this.canvas.style.display = 'block';\n      this.canvas.style.position = 'absolute';\n\n      if (typeof position === 'string') {\n        const specifiedPosition = position.split(' ');\n\n        switch (specifiedPosition[0]) {\n          case 'top':\n            this.canvas.style.top = '0px';\n            break;\n          case 'bottom':\n            this.canvas.style.bottom = '0px';\n            break;\n          case 'middle':\n            this.canvas.style.top = '50%';\n            const offsetY = -this.halfDrawHeight;\n            this.canvas.style.marginTop = offsetY.toString();\n            break;\n          default:\n            throw new Error('Invalid Position Given');\n        }\n\n        if (specifiedPosition[1]) {\n          switch (specifiedPosition[1]) {\n            case 'left':\n              this.canvas.style.left = '0px';\n              break;\n            case 'right':\n              this.canvas.style.right = '0px';\n              break;\n            case 'center':\n              this.canvas.style.left = '50%';\n              const offsetX = -this.halfDrawWidth;\n              this.canvas.style.marginLeft = offsetX.toString();\n              break;\n            default:\n              throw new Error('Invalid Position Given');\n          }\n        }\n      } else {\n        if (position.top) {\n          typeof position.top === 'number'\n            ? (this.canvas.style.top = position.top.toString() + 'px')\n            : (this.canvas.style.top = position.top);\n        }\n        if (position.right) {\n          typeof position.right === 'number'\n            ? (this.canvas.style.right = position.right.toString() + 'px')\n            : (this.canvas.style.right = position.right);\n        }\n        if (position.bottom) {\n          typeof position.bottom === 'number'\n            ? (this.canvas.style.bottom = position.bottom.toString() + 'px')\n            : (this.canvas.style.bottom = position.bottom);\n        }\n        if (position.left) {\n          typeof position.left === 'number'\n            ? (this.canvas.style.left = position.left.toString() + 'px')\n            : (this.canvas.style.left = position.left);\n        }\n      }\n    }\n  }\n}\n","import { Scene } from './Scene';\nimport { Vector } from './Math/vector';\nimport { Actor } from './Actor';\nimport { Trigger } from './Trigger';\nimport { FrameStats } from './Debug';\nimport { Engine } from './Engine';\nimport { TileMap } from './TileMap';\nimport { Side } from './Collision/Side';\nimport * as Input from './Input/Index';\nimport { CollisionContact } from './Collision/Detection/CollisionContact';\nimport { Collider } from './Collision/Colliders/Collider';\nimport { Entity } from './EntityComponentSystem/Entity';\nimport { OnInitialize, OnPreUpdate, OnPostUpdate } from './Interfaces/LifecycleEvents';\nimport { BodyComponent } from './Collision/BodyComponent';\n\nexport enum EventTypes {\n  Kill = 'kill',\n  PreKill = 'prekill',\n  PostKill = 'postkill',\n\n  PreDraw = 'predraw',\n  PostDraw = 'postdraw',\n\n  PreDebugDraw = 'predebugdraw',\n  PostDebugDraw = 'postdebugdraw',\n\n  PreUpdate = 'preupdate',\n  PostUpdate = 'postupdate',\n\n  PreFrame = 'preframe',\n  PostFrame = 'postframe',\n\n  PreCollision = 'precollision',\n  CollisionStart = 'collisionstart',\n  CollisionEnd = 'collisionend',\n  PostCollision = 'postcollision',\n\n  Initialize = 'initialize',\n  Activate = 'activate',\n  Deactivate = 'deactivate',\n\n  ExitViewport = 'exitviewport',\n  EnterViewport = 'enterviewport',\n\n  ExitTrigger = 'exit',\n  EnterTrigger = 'enter',\n\n  Connect = 'connect',\n  Disconnect = 'disconnect',\n  Button = 'button',\n  Axis = 'axis',\n\n  Subscribe = 'subscribe',\n  Unsubscribe = 'unsubscribe',\n\n  Visible = 'visible',\n  Hidden = 'hidden',\n  Start = 'start',\n  Stop = 'stop',\n\n  PointerUp = 'pointerup',\n  PointerDown = 'pointerdown',\n  PointerMove = 'pointermove',\n  PointerEnter = 'pointerenter',\n  PointerLeave = 'pointerleave',\n  PointerCancel = 'pointercancel',\n  PointerWheel = 'pointerwheel',\n\n  Up = 'up',\n  Down = 'down',\n  Move = 'move',\n  Enter = 'enter',\n  Leave = 'leave',\n  Cancel = 'cancel',\n  Wheel = 'wheel',\n\n  Press = 'press',\n  Release = 'release',\n  Hold = 'hold',\n\n  PointerDragStart = 'pointerdragstart',\n  PointerDragEnd = 'pointerdragend',\n  PointerDragEnter = 'pointerdragenter',\n  PointerDragLeave = 'pointerdragleave',\n  PointerDragMove = 'pointerdragmove'\n}\n\n/* istanbul ignore next */\n/* compiler only: these are internal to lib */\nexport type kill = 'kill';\nexport type prekill = 'prekill';\nexport type postkill = 'postkill';\n\nexport type predraw = 'predraw';\nexport type postdraw = 'postdraw';\n\nexport type predebugdraw = 'predebugdraw';\nexport type postdebugdraw = 'postdebugdraw';\n\nexport type preupdate = 'preupdate';\nexport type postupdate = 'postupdate';\n\nexport type preframe = 'preframe';\nexport type postframe = 'postframe';\n\nexport type precollision = 'precollision';\nexport type collisionstart = 'collisionstart';\nexport type collisionend = 'collisionend';\nexport type postcollision = 'postcollision';\n\nexport type initialize = 'initialize';\nexport type activate = 'activate';\nexport type deactivate = 'deactivate';\n\nexport type exitviewport = 'exitviewport';\nexport type enterviewport = 'enterviewport';\n\nexport type exittrigger = 'exit';\nexport type entertrigger = 'enter';\n\nexport type connect = 'connect';\nexport type disconnect = 'disconnect';\nexport type button = 'button';\nexport type axis = 'axis';\n\nexport type subscribe = 'subscribe';\nexport type unsubscribe = 'unsubscribe';\n\nexport type visible = 'visible';\nexport type hidden = 'hidden';\nexport type start = 'start';\nexport type stop = 'stop';\n\nexport type pointerup = 'pointerup';\nexport type pointerdown = 'pointerdown';\nexport type pointermove = 'pointermove';\nexport type pointerenter = 'pointerenter';\nexport type pointerleave = 'pointerleave';\nexport type pointercancel = 'pointercancel';\nexport type pointerwheel = 'pointerwheel';\n\nexport type up = 'up';\nexport type down = 'down';\nexport type move = 'move';\nexport type enter = 'enter';\nexport type leave = 'leave';\nexport type cancel = 'cancel';\nexport type wheel = 'wheel';\n\nexport type press = 'press';\nexport type release = 'release';\nexport type hold = 'hold';\n\nexport type pointerdragstart = 'pointerdragstart';\nexport type pointerdragend = 'pointerdragend';\nexport type pointerdragenter = 'pointerdragenter';\nexport type pointerdragleave = 'pointerdragleave';\nexport type pointerdragmove = 'pointerdragmove';\n\n/**\n * Base event type in Excalibur that all other event types derive from. Not all event types are thrown on all Excalibur game objects,\n * some events are unique to a type, others are not.\n *\n */\nexport class GameEvent<T, U = T> {\n  /**\n   * Target object for this event.\n   */\n  public target: T;\n\n  /**\n   * Other target object for this event\n   */\n  public other: U | null;\n\n  /**\n   * If set to false, prevents event from propagating to other actors. If true it will be propagated\n   * to all actors that apply.\n   */\n  public get bubbles(): boolean {\n    return this._bubbles;\n  }\n\n  public set bubbles(value: boolean) {\n    this._bubbles = value;\n  }\n\n  private _bubbles: boolean = true;\n  /**\n   * Prevents event from bubbling\n   */\n  public stopPropagation() {\n    this.bubbles = false;\n  }\n}\n\n/**\n * The 'kill' event is emitted on actors when it is killed. The target is the actor that was killed.\n */\nexport class KillEvent extends GameEvent<Actor> {\n  constructor(public target: Actor) {\n    super();\n  }\n}\n\n/**\n * The 'prekill' event is emitted directly before an actor is killed.\n */\nexport class PreKillEvent extends GameEvent<Actor> {\n  constructor(public target: Actor) {\n    super();\n  }\n}\n\n/**\n * The 'postkill' event is emitted directly after the actor is killed.\n */\nexport class PostKillEvent extends GameEvent<Actor> {\n  constructor(public target: Actor) {\n    super();\n  }\n}\n\n/**\n * The 'start' event is emitted on engine when has started and is ready for interaction.\n */\nexport class GameStartEvent extends GameEvent<Engine> {\n  constructor(public target: Engine) {\n    super();\n  }\n}\n\n/**\n * The 'stop' event is emitted on engine when has been stopped and will no longer take input, update or draw.\n */\nexport class GameStopEvent extends GameEvent<Engine> {\n  constructor(public target: Engine) {\n    super();\n  }\n}\n\n/**\n * The 'predraw' event is emitted on actors, scenes, and engine before drawing starts. Actors' predraw happens inside their graphics\n * transform so that all drawing takes place with the actor as the origin.\n *\n */\nexport class PreDrawEvent extends GameEvent<Entity | Scene | Engine | TileMap> {\n  constructor(public ctx: CanvasRenderingContext2D, public delta: number, public target: Entity | Scene | Engine | TileMap) {\n    super();\n  }\n}\n\n/**\n * The 'postdraw' event is emitted on actors, scenes, and engine after drawing finishes. Actors' postdraw happens inside their graphics\n * transform so that all drawing takes place with the actor as the origin.\n *\n */\nexport class PostDrawEvent extends GameEvent<Entity | Scene | Engine | TileMap> {\n  constructor(public ctx: CanvasRenderingContext2D, public delta: number, public target: Entity | Scene | Engine | TileMap) {\n    super();\n  }\n}\n\n/**\n * The 'predebugdraw' event is emitted on actors, scenes, and engine before debug drawing starts.\n */\nexport class PreDebugDrawEvent extends GameEvent<Entity | Actor | Scene | Engine> {\n  constructor(public ctx: CanvasRenderingContext2D, public target: Entity | Actor | Scene | Engine) {\n    super();\n  }\n}\n\n/**\n * The 'postdebugdraw' event is emitted on actors, scenes, and engine after debug drawing starts.\n */\nexport class PostDebugDrawEvent extends GameEvent<Entity | Actor | Scene | Engine> {\n  constructor(public ctx: CanvasRenderingContext2D, public target: Entity | Actor | Scene | Engine) {\n    super();\n  }\n}\n\n/**\n * The 'preupdate' event is emitted on actors, scenes, camera, and engine before the update starts.\n */\nexport class PreUpdateEvent<T extends OnPreUpdate = Entity> extends GameEvent<T> {\n  constructor(public engine: Engine, public delta: number, public target: T) {\n    super();\n  }\n}\n\n/**\n * The 'postupdate' event is emitted on actors, scenes, camera, and engine after the update ends.\n */\nexport class PostUpdateEvent<T extends OnPostUpdate = Entity> extends GameEvent<T> {\n  constructor(public engine: Engine, public delta: number, public target: T) {\n    super();\n  }\n}\n\n/**\n * The 'preframe' event is emitted on the engine, before the frame begins.\n */\nexport class PreFrameEvent extends GameEvent<Engine> {\n  constructor(public engine: Engine, public prevStats: FrameStats) {\n    super();\n    this.target = engine;\n  }\n}\n\n/**\n * The 'postframe' event is emitted on the engine, after a frame ends.\n */\nexport class PostFrameEvent extends GameEvent<Engine> {\n  constructor(public engine: Engine, public stats: FrameStats) {\n    super();\n    this.target = engine;\n  }\n}\n\n/**\n * Event received when a gamepad is connected to Excalibur. [[Gamepads]] receives this event.\n */\nexport class GamepadConnectEvent extends GameEvent<Input.Gamepad> {\n  constructor(public index: number, public gamepad: Input.Gamepad) {\n    super();\n    this.target = gamepad;\n  }\n}\n\n/**\n * Event received when a gamepad is disconnected from Excalibur. [[Gamepads]] receives this event.\n */\nexport class GamepadDisconnectEvent extends GameEvent<Input.Gamepad> {\n  constructor(public index: number, public gamepad: Input.Gamepad) {\n    super();\n    this.target = gamepad;\n  }\n}\n\n/**\n * Gamepad button event. See [[Gamepads]] for information on responding to controller input. [[Gamepad]] instances receive this event;\n */\nexport class GamepadButtonEvent extends GameEvent<Input.Gamepad> {\n  /**\n   * @param button  The Gamepad button\n   * @param value   A numeric value between 0 and 1\n   */\n  constructor(public button: Input.Buttons, public value: number, public target: Input.Gamepad) {\n    super();\n  }\n}\n\n/**\n * Gamepad axis event. See [[Gamepads]] for information on responding to controller input. [[Gamepad]] instances receive this event;\n */\nexport class GamepadAxisEvent extends GameEvent<Input.Gamepad> {\n  /**\n   * @param axis  The Gamepad axis\n   * @param value A numeric value between -1 and 1\n   */\n  constructor(public axis: Input.Axes, public value: number, public target: Input.Gamepad) {\n    super();\n  }\n}\n\n/**\n * Subscribe event thrown when handlers for events other than subscribe are added. Meta event that is received by\n * [[EventDispatcher|event dispatchers]].\n */\nexport class SubscribeEvent<T> extends GameEvent<T> {\n  constructor(public topic: string, public handler: (event: GameEvent<T>) => void) {\n    super();\n  }\n}\n\n/**\n * Unsubscribe event thrown when handlers for events other than unsubscribe are removed. Meta event that is received by\n * [[EventDispatcher|event dispatchers]].\n */\nexport class UnsubscribeEvent<T> extends GameEvent<T> {\n  constructor(public topic: string, public handler: (event: GameEvent<T>) => void) {\n    super();\n  }\n}\n\n/**\n * Event received by the [[Engine]] when the browser window is visible on a screen.\n */\nexport class VisibleEvent extends GameEvent<Engine> {\n  constructor(public target: Engine) {\n    super();\n  }\n}\n\n/**\n * Event received by the [[Engine]] when the browser window is hidden from all screens.\n */\nexport class HiddenEvent extends GameEvent<Engine> {\n  constructor(public target: Engine) {\n    super();\n  }\n}\n\n/**\n * Event thrown on an [[Actor|actor]] when a collision will occur this frame if it resolves\n */\nexport class PreCollisionEvent<T extends BodyComponent | Collider | Entity = Actor> extends GameEvent<T> {\n  /**\n   * @param actor         The actor the event was thrown on\n   * @param other         The actor that will collided with the current actor\n   * @param side          The side that will be collided with the current actor\n   * @param intersection  Intersection vector\n   */\n  constructor(actor: T, public other: T, public side: Side, public intersection: Vector) {\n    super();\n    this.target = actor;\n  }\n}\n\n/**\n * Event thrown on an [[Actor|actor]] when a collision has been resolved (body reacted) this frame\n */\nexport class PostCollisionEvent<T extends Collider | Entity = Actor> extends GameEvent<T> {\n  /**\n   * @param actor         The actor the event was thrown on\n   * @param other         The actor that did collide with the current actor\n   * @param side          The side that did collide with the current actor\n   * @param intersection  Intersection vector\n   */\n  constructor(actor: T, public other: T, public side: Side, public intersection: Vector) {\n    super();\n    this.target = actor;\n  }\n\n  public get actor() {\n    return this.target;\n  }\n\n  public set actor(actor: T) {\n    this.target = actor;\n  }\n}\n\nexport class ContactStartEvent<T> {\n  constructor(public target: T, public other: T, public contact: CollisionContact) {}\n}\n\nexport class ContactEndEvent<T> {\n  constructor(public target: T, public other: T) {}\n}\n\nexport class CollisionPreSolveEvent<T> {\n  constructor(public target: T, public other: T, public side: Side, public intersection: Vector, public contact: CollisionContact) {}\n}\n\nexport class CollisionPostSolveEvent<T> {\n  constructor(public target: T, public other: T, public side: Side, public intersection: Vector, public contact: CollisionContact) {}\n}\n\n/**\n * Event thrown the first time an [[Actor|actor]] collides with another, after an actor is in contact normal collision events are fired.\n */\nexport class CollisionStartEvent<T extends BodyComponent | Collider | Entity = Actor> extends GameEvent<T> {\n  /**\n   *\n   * @param actor\n   * @param other\n   * @param contact\n   */\n  constructor(actor: T, public other: T, public contact: CollisionContact) {\n    super();\n    this.target = actor;\n  }\n\n  public get actor() {\n    return this.target;\n  }\n\n  public set actor(actor: T) {\n    this.target = actor;\n  }\n}\n\n/**\n * Event thrown when the [[Actor|actor]] is no longer colliding with another\n */\nexport class CollisionEndEvent<T extends BodyComponent | Collider | Entity = Actor> extends GameEvent<T> {\n  /**\n   *\n   */\n  constructor(actor: T, public other: T) {\n    super();\n    this.target = actor;\n  }\n\n  public get actor() {\n    return this.target;\n  }\n\n  public set actor(actor: T) {\n    this.target = actor;\n  }\n}\n\n/**\n * Event thrown on an [[Actor]] and a [[Scene]] only once before the first update call\n */\nexport class InitializeEvent<T extends OnInitialize = Entity> extends GameEvent<T> {\n  /**\n   * @param engine  The reference to the current engine\n   */\n  constructor(public engine: Engine, public target: T) {\n    super();\n  }\n}\n\n/**\n * Event thrown on a [[Scene]] on activation\n */\nexport class ActivateEvent extends GameEvent<Scene> {\n  /**\n   * @param oldScene  The reference to the old scene\n   */\n  constructor(public oldScene: Scene, public target: Scene) {\n    super();\n  }\n}\n\n/**\n * Event thrown on a [[Scene]] on deactivation\n */\nexport class DeactivateEvent extends GameEvent<Scene> {\n  /**\n   * @param newScene  The reference to the new scene\n   */\n  constructor(public newScene: Scene, public target: Scene) {\n    super();\n  }\n}\n\n/**\n * Event thrown on an [[Actor]] when it completely leaves the screen.\n */\nexport class ExitViewPortEvent extends GameEvent<Entity> {\n  constructor(public target: Entity) {\n    super();\n  }\n}\n\n/**\n * Event thrown on an [[Actor]] when it completely leaves the screen.\n */\nexport class EnterViewPortEvent extends GameEvent<Entity> {\n  constructor(public target: Entity) {\n    super();\n  }\n}\n\nexport class EnterTriggerEvent extends GameEvent<Actor> {\n  constructor(public target: Trigger, public actor: Actor) {\n    super();\n  }\n}\n\nexport class ExitTriggerEvent extends GameEvent<Actor> {\n  constructor(public target: Trigger, public actor: Actor) {\n    super();\n  }\n}\n","import { obsolete } from './Util/Decorators';\n\n/**\n * Provides standard colors (e.g. [[Color.Black]])\n * but you can also create custom colors using RGB, HSL, or Hex. Also provides\n * useful color operations like [[Color.lighten]], [[Color.darken]], and more.\n */\nexport class Color {\n  /**\n   * Red channel\n   */\n  public r: number;\n  /**\n   * Green channel\n   */\n  public g: number;\n  /**\n   * Blue channel\n   */\n  public b: number;\n  /**\n   * Alpha channel (between 0 and 1)\n   */\n  public a: number;\n\n  /**\n   * Hue\n   */\n  public h: number;\n  /**\n   * Saturation\n   */\n  public s: number;\n  /**\n   * Lightness\n   */\n  public l: number;\n\n  /**\n   * Creates a new instance of Color from an r, g, b, a\n   *\n   * @param r  The red component of color (0-255)\n   * @param g  The green component of color (0-255)\n   * @param b  The blue component of color (0-255)\n   * @param a  The alpha component of color (0-1.0)\n   */\n  constructor(r: number, g: number, b: number, a?: number) {\n    this.r = r;\n    this.g = g;\n    this.b = b;\n    this.a = a != null ? a : 1;\n  }\n\n  /**\n   * Creates a new instance of Color from an r, g, b, a\n   *\n   * @param r  The red component of color (0-255)\n   * @param g  The green component of color (0-255)\n   * @param b  The blue component of color (0-255)\n   * @param a  The alpha component of color (0-1.0)\n   */\n  public static fromRGB(r: number, g: number, b: number, a?: number): Color {\n    return new Color(r, g, b, a);\n  }\n\n  /**\n   * Creates a new instance of Color from a rgb string\n   *\n   * @param string  CSS color string of the form rgba(255, 255, 255, 1) or rgb(255, 255, 255)\n   */\n  public static fromRGBString(string: string): Color {\n    const rgbaRegEx: RegExp = /^rgba?\\((\\d+),\\s*(\\d+),\\s*(\\d+)(?:,\\s*(\\d+(?:\\.\\d+)?))?\\)/i;\n    let match = null;\n    if ((match = string.match(rgbaRegEx))) {\n      const r = parseInt(match[1], 10);\n      const g = parseInt(match[2], 10);\n      const b = parseInt(match[3], 10);\n      let a = 1;\n      if (match[4]) {\n        a = parseFloat(match[4]);\n      }\n      return new Color(r, g, b, a);\n    } else {\n      throw new Error('Invalid rgb/a string: ' + string);\n    }\n  }\n\n  /**\n   * Creates a new instance of Color from a hex string\n   *\n   * @param hex  CSS color string of the form #ffffff, the alpha component is optional\n   */\n  public static fromHex(hex: string): Color {\n    const hexRegEx: RegExp = /^#?([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})?$/i;\n    let match = null;\n    if ((match = hex.match(hexRegEx))) {\n      const r = parseInt(match[1], 16);\n      const g = parseInt(match[2], 16);\n      const b = parseInt(match[3], 16);\n      let a = 1;\n      if (match[4]) {\n        a = parseInt(match[4], 16) / 255;\n      }\n      return new Color(r, g, b, a);\n    } else {\n      throw new Error('Invalid hex string: ' + hex);\n    }\n  }\n\n  /**\n   * Creates a new instance of Color from hsla values\n   *\n   * @param h  Hue is represented [0-1]\n   * @param s  Saturation is represented [0-1]\n   * @param l  Luminance is represented [0-1]\n   * @param a  Alpha is represented [0-1]\n   */\n  public static fromHSL(h: number, s: number, l: number, a: number = 1.0): Color {\n    const temp = new HSLColor(h, s, l, a);\n    return temp.toRGBA();\n  }\n\n  /**\n   * Lightens the current color by a specified amount\n   *\n   * @param factor  The amount to lighten by [0-1]\n   */\n  public lighten(factor: number = 0.1): Color {\n    const temp = HSLColor.fromRGBA(this.r, this.g, this.b, this.a);\n    temp.l += (1 - temp.l) * factor;\n    return temp.toRGBA();\n  }\n\n  /**\n   * Darkens the current color by a specified amount\n   *\n   * @param factor  The amount to darken by [0-1]\n   */\n  public darken(factor: number = 0.1): Color {\n    const temp = HSLColor.fromRGBA(this.r, this.g, this.b, this.a);\n    temp.l -= temp.l * factor;\n    return temp.toRGBA();\n  }\n\n  /**\n   * Saturates the current color by a specified amount\n   *\n   * @param factor  The amount to saturate by [0-1]\n   */\n  public saturate(factor: number = 0.1): Color {\n    const temp = HSLColor.fromRGBA(this.r, this.g, this.b, this.a);\n    temp.s += temp.s * factor;\n    return temp.toRGBA();\n  }\n\n  /**\n   * Desaturates the current color by a specified amount\n   *\n   * @param factor  The amount to desaturate by [0-1]\n   */\n  public desaturate(factor: number = 0.1): Color {\n    const temp = HSLColor.fromRGBA(this.r, this.g, this.b, this.a);\n    temp.s -= temp.s * factor;\n    return temp.toRGBA();\n  }\n\n  /**\n   * Multiplies a color by another, results in a darker color\n   *\n   * @param color  The other color\n   */\n  public multiply(color: Color): Color {\n    const newR = (((color.r / 255) * this.r) / 255) * 255;\n    const newG = (((color.g / 255) * this.g) / 255) * 255;\n    const newB = (((color.b / 255) * this.b) / 255) * 255;\n    const newA = color.a * this.a;\n    return new Color(newR, newG, newB, newA);\n  }\n\n  /**\n   * Multiplies a color by another, results in a darker color\n   * @param color\n   * @obsolete Alias for incorrect spelling used in older versions, use multiply instead, will be removed in v0.25.0\n   */\n  @obsolete({ message: 'Alias for incorrect spelling used in older versions, use multiply instead, will be removed in v0.25.0' })\n  public mulitiply(color: Color): Color {\n    return this.multiply(color);\n  }\n\n  /**\n   * Screens a color by another, results in a lighter color\n   *\n   * @param color  The other color\n   */\n  public screen(color: Color): Color {\n    const color1 = color.invert();\n    const color2 = color.invert();\n    return color1.multiply(color2).invert();\n  }\n\n  /**\n   * Inverts the current color\n   */\n  public invert(): Color {\n    return new Color(255 - this.r, 255 - this.g, 255 - this.b, 1.0 - this.a);\n  }\n\n  /**\n   * Averages the current color with another\n   *\n   * @param color  The other color\n   */\n  public average(color: Color): Color {\n    const newR = (color.r + this.r) / 2;\n    const newG = (color.g + this.g) / 2;\n    const newB = (color.b + this.b) / 2;\n    const newA = (color.a + this.a) / 2;\n    return new Color(newR, newG, newB, newA);\n  }\n\n  public equal(color: Color): boolean {\n    return this.toString() === color.toString();\n  }\n\n  /**\n   * Returns a CSS string representation of a color.\n   *\n   * @param format Color representation, accepts: rgb, hsl, or hex\n   */\n  public toString(format: 'rgb' | 'hsl' | 'hex' = 'rgb') {\n    switch (format) {\n      case 'rgb':\n        return this.toRGBA();\n      case 'hsl':\n        return this.toHSLA();\n      case 'hex':\n        return this.toHex();\n      default:\n        throw new Error('Invalid Color format');\n    }\n  }\n\n  /**\n   * Returns Hex Value of a color component\n   * @param c color component\n   * @see https://stackoverflow.com/questions/5623838/rgb-to-hex-and-hex-to-rgb\n   */\n  private _componentToHex(c: number) {\n    const hex = c.toString(16);\n    return hex.length === 1 ? '0' + hex : hex;\n  }\n\n  /**\n   * Return Hex representation of a color.\n   */\n  public toHex() {\n    return '#' + this._componentToHex(this.r) + this._componentToHex(this.g) + this._componentToHex(this.b);\n  }\n\n  /**\n   * Return RGBA representation of a color.\n   */\n  public toRGBA() {\n    const result = String(this.r.toFixed(0)) + ', ' + String(this.g.toFixed(0)) + ', ' + String(this.b.toFixed(0));\n    if (this.a !== undefined || this.a !== null) {\n      return 'rgba(' + result + ', ' + String(this.a) + ')';\n    }\n    return 'rgb(' + result + ')';\n  }\n\n  /**\n   * Return HSLA representation of a color.\n   */\n  public toHSLA() {\n    return HSLColor.fromRGBA(this.r, this.g, this.b, this.a).toString();\n  }\n\n  /**\n   * Returns a CSS string representation of a color.\n   */\n  public fillStyle() {\n    return this.toString();\n  }\n\n  /**\n   * Returns a clone of the current color.\n   */\n  public clone(): Color {\n    return new Color(this.r, this.g, this.b, this.a);\n  }\n\n  /**\n   * Black (#000000)\n   */\n  public static get Black(): Color {\n    return Color.fromHex('#000000');\n  }\n\n  /**\n   * White (#FFFFFF)\n   */\n  public static get White(): Color {\n    return Color.fromHex('#FFFFFF');\n  }\n\n  /**\n   * Gray (#808080)\n   */\n  public static get Gray(): Color {\n    return Color.fromHex('#808080');\n  }\n\n  /**\n   * Light gray (#D3D3D3)\n   */\n  public static get LightGray(): Color {\n    return Color.fromHex('#D3D3D3');\n  }\n\n  /**\n   * Dark gray (#A9A9A9)\n   */\n  public static get DarkGray(): Color {\n    return Color.fromHex('#A9A9A9');\n  }\n\n  /**\n   * Yellow (#FFFF00)\n   */\n  public static get Yellow(): Color {\n    return Color.fromHex('#FFFF00');\n  }\n\n  /**\n   * Orange (#FFA500)\n   */\n  public static get Orange(): Color {\n    return Color.fromHex('#FFA500');\n  }\n\n  /**\n   * Red (#FF0000)\n   */\n  public static get Red(): Color {\n    return Color.fromHex('#FF0000');\n  }\n\n  /**\n   * Vermilion (#FF5B31)\n   */\n  public static get Vermilion(): Color {\n    return Color.fromHex('#FF5B31');\n  }\n\n  /**\n   * Vermilion (#FF5B31)\n   * @obsolete Alias for incorrect spelling used in older versions, use multiply instead, will be removed in v0.25.0\n   */\n  @obsolete({\n    message: 'Alias for incorrect spelling used in older versions',\n    alternateMethod: 'Vermilion'\n  })\n  public static get Vermillion(): Color {\n    return Color.Vermilion;\n  }\n\n  /**\n   * Rose (#FF007F)\n   */\n  public static get Rose(): Color {\n    return Color.fromHex('#FF007F');\n  }\n\n  /**\n   * Magenta (#FF00FF)\n   */\n  public static get Magenta(): Color {\n    return Color.fromHex('#FF00FF');\n  }\n\n  /**\n   * Violet (#7F00FF)\n   */\n  public static get Violet(): Color {\n    return Color.fromHex('#7F00FF');\n  }\n\n  /**\n   * Blue (#0000FF)\n   */\n  public static get Blue(): Color {\n    return Color.fromHex('#0000FF');\n  }\n\n  /**\n   * Azure (#007FFF)\n   */\n  public static get Azure(): Color {\n    return Color.fromHex('#007FFF');\n  }\n\n  /**\n   * Cyan (#00FFFF)\n   */\n  public static get Cyan(): Color {\n    return Color.fromHex('#00FFFF');\n  }\n\n  /**\n   * Viridian (#59978F)\n   */\n  public static get Viridian(): Color {\n    return Color.fromHex('#59978F');\n  }\n\n  /**\n   * Green (#00FF00)\n   */\n  public static get Green(): Color {\n    return Color.fromHex('#00FF00');\n  }\n\n  /**\n   * Chartreuse (#7FFF00)\n   */\n  public static get Chartreuse(): Color {\n    return Color.fromHex('#7FFF00');\n  }\n\n  /**\n   * Transparent (#FFFFFF00)\n   */\n  public static get Transparent(): Color {\n    return Color.fromHex('#FFFFFF00');\n  }\n\n  /**\n   * ExcaliburBlue (#176BAA)\n   */\n  public static get ExcaliburBlue(): Color {\n    return Color.fromHex('#176BAA');\n  }\n}\n\n/**\n * Internal HSL Color representation\n *\n * http://en.wikipedia.org/wiki/HSL_and_HSV\n * http://axonflux.com/handy-rgb-to-hsl-and-rgb-to-hsv-color-model-c\n */\nclass HSLColor {\n  constructor(public h: number, public s: number, public l: number, public a: number) {}\n\n  public static hue2rgb(p: number, q: number, t: number): number {\n    if (t < 0) {\n      t += 1;\n    }\n    if (t > 1) {\n      t -= 1;\n    }\n    if (t < 1 / 6) {\n      return p + (q - p) * 6 * t;\n    }\n    if (t < 1 / 2) {\n      return q;\n    }\n    if (t < 2 / 3) {\n      return p + (q - p) * (2 / 3 - t) * 6;\n    }\n    return p;\n  }\n\n  public static fromRGBA(r: number, g: number, b: number, a: number): HSLColor {\n    r /= 255;\n    g /= 255;\n    b /= 255;\n    const max = Math.max(r, g, b),\n      min = Math.min(r, g, b);\n    let h, s;\n    const l = (max + min) / 2;\n\n    if (max === min) {\n      h = s = 0; // achromatic\n    } else {\n      const d = max - min;\n      s = l > 0.5 ? d / (2 - max - min) : d / (max + min);\n      switch (max) {\n        case r:\n          h = (g - b) / d + (g < b ? 6 : 0);\n          break;\n        case g:\n          h = (b - r) / d + 2;\n          break;\n        case b:\n          h = (r - g) / d + 4;\n          break;\n      }\n      h /= 6;\n    }\n\n    return new HSLColor(h, s, l, a);\n  }\n\n  public toRGBA(): Color {\n    let r: number, g: number, b: number;\n\n    if (this.s === 0) {\n      r = g = b = this.l; // achromatic\n    } else {\n      const q = this.l < 0.5 ? this.l * (1 + this.s) : this.l + this.s - this.l * this.s;\n      const p = 2 * this.l - q;\n      r = HSLColor.hue2rgb(p, q, this.h + 1 / 3);\n      g = HSLColor.hue2rgb(p, q, this.h);\n      b = HSLColor.hue2rgb(p, q, this.h - 1 / 3);\n    }\n\n    return new Color(r * 255, g * 255, b * 255, this.a);\n  }\n\n  public toString(): string {\n    const h = this.h.toFixed(0),\n      s = this.s.toFixed(0),\n      l = this.l.toFixed(0),\n      a = this.a.toFixed(0);\n    return `hsla(${h}, ${s}, ${l}, ${a})`;\n  }\n}\n","import { Vector } from '../Math/vector';\nimport { Ray } from '../Math/ray';\nimport { Color } from '../Color';\nimport { Side } from './Side';\nimport { ExcaliburGraphicsContext } from '../Graphics/Context/ExcaliburGraphicsContext';\nimport { Matrix } from '../Math/matrix';\n\nexport interface BoundingBoxOptions {\n  left: number;\n  right: number;\n  top: number;\n  bottom: number;\n}\n\n/**\n * Axis Aligned collision primitive for Excalibur.\n */\nexport class BoundingBox {\n  public top: number;\n  public right: number;\n  public bottom: number;\n  public left: number;\n\n  /**\n   * Constructor allows passing of either an object with all coordinate components,\n   * or the coordinate components passed separately.\n   * @param leftOrOptions    Either x coordinate of the left edge or an options object\n   * containing the four coordinate components.\n   * @param top     y coordinate of the top edge\n   * @param right   x coordinate of the right edge\n   * @param bottom  y coordinate of the bottom edge\n   */\n  constructor(leftOrOptions: number | BoundingBoxOptions = 0, top: number = 0, right: number = 0, bottom: number = 0) {\n    if (typeof leftOrOptions === 'object') {\n      this.left = leftOrOptions.left;\n      this.top = leftOrOptions.top;\n      this.right = leftOrOptions.right;\n      this.bottom = leftOrOptions.bottom;\n    } else if (typeof leftOrOptions === 'number') {\n      this.left = leftOrOptions;\n      this.top = top;\n      this.right = right;\n      this.bottom = bottom;\n    }\n  }\n\n  /**\n   * Given bounding box A & B, returns the side relative to A when intersection is performed.\n   * @param intersection Intersection vector between 2 bounding boxes\n   */\n  public static getSideFromIntersection(intersection: Vector): Side {\n    if (!intersection) {\n      return Side.None;\n    }\n    if (intersection) {\n      if (Math.abs(intersection.x) > Math.abs(intersection.y)) {\n        if (intersection.x < 0) {\n          return Side.Right;\n        }\n        return Side.Left;\n      } else {\n        if (intersection.y < 0) {\n          return Side.Bottom;\n        }\n        return Side.Top;\n      }\n    }\n    return Side.None;\n  }\n\n  public static fromPoints(points: Vector[]): BoundingBox {\n    let minX = Infinity;\n    let minY = Infinity;\n    let maxX = -Infinity;\n    let maxY = -Infinity;\n    for (let i = 0; i < points.length; i++) {\n      if (points[i].x < minX) {\n        minX = points[i].x;\n      }\n      if (points[i].x > maxX) {\n        maxX = points[i].x;\n      }\n      if (points[i].y < minY) {\n        minY = points[i].y;\n      }\n      if (points[i].y > maxY) {\n        maxY = points[i].y;\n      }\n    }\n    return new BoundingBox(minX, minY, maxX, maxY);\n  }\n\n  public static fromDimension(width: number, height: number, anchor: Vector = Vector.Half, pos: Vector = Vector.Zero) {\n    return new BoundingBox(\n      -width * anchor.x + pos.x,\n      -height * anchor.y + pos.y,\n      width - width * anchor.x + pos.x,\n      height - height * anchor.y + pos.y\n    );\n  }\n\n  /**\n   * Returns the calculated width of the bounding box\n   */\n  public get width() {\n    return this.right - this.left;\n  }\n\n  /**\n   * Returns the calculated height of the bounding box\n   */\n  public get height() {\n    return this.bottom - this.top;\n  }\n\n  /**\n   * Return whether the bounding box has zero dimensions in height,width or both\n   */\n  public hasZeroDimensions() {\n    return this.width === 0 || this.height === 0;\n  }\n\n  /**\n   * Returns the center of the bounding box\n   */\n  public get center(): Vector {\n    return new Vector((this.left + this.right) / 2, (this.top + this.bottom) / 2);\n  }\n\n  public translate(pos: Vector): BoundingBox {\n    return new BoundingBox(this.left + pos.x, this.top + pos.y, this.right + pos.x, this.bottom + pos.y);\n  }\n\n  /**\n   * Rotates a bounding box by and angle and around a point, if no point is specified (0, 0) is used by default. The resulting bounding\n   * box is also axis-align. This is useful when a new axis-aligned bounding box is needed for rotated geometry.\n   */\n  public rotate(angle: number, point: Vector = Vector.Zero): BoundingBox {\n    const points = this.getPoints().map((p) => p.rotate(angle, point));\n    return BoundingBox.fromPoints(points);\n  }\n\n  public scale(scale: Vector, point: Vector = Vector.Zero): BoundingBox {\n    const shifted = this.translate(point);\n    return new BoundingBox(shifted.left * scale.x, shifted.top * scale.y, shifted.right * scale.x, shifted.bottom * scale.y);\n  }\n\n  public transform(matrix: Matrix) {\n    const points = this.getPoints().map((p) => matrix.multv(p));\n    return BoundingBox.fromPoints(points);\n  }\n\n  /**\n   * Returns the perimeter of the bounding box\n   */\n  public getPerimeter(): number {\n    const wx = this.width;\n    const wy = this.height;\n    return 2 * (wx + wy);\n  }\n\n  public getPoints(): Vector[] {\n    const results = [];\n    results.push(new Vector(this.left, this.top));\n    results.push(new Vector(this.right, this.top));\n    results.push(new Vector(this.right, this.bottom));\n    results.push(new Vector(this.left, this.bottom));\n    return results;\n  }\n\n  /**\n   * Determines whether a ray intersects with a bounding box\n   */\n  public rayCast(ray: Ray, farClipDistance = Infinity): boolean {\n    // algorithm from https://tavianator.com/fast-branchless-raybounding-box-intersections/\n    let tmin = -Infinity;\n    let tmax = +Infinity;\n\n    const xinv = ray.dir.x === 0 ? Number.MAX_VALUE : 1 / ray.dir.x;\n    const yinv = ray.dir.y === 0 ? Number.MAX_VALUE : 1 / ray.dir.y;\n\n    const tx1 = (this.left - ray.pos.x) * xinv;\n    const tx2 = (this.right - ray.pos.x) * xinv;\n    tmin = Math.min(tx1, tx2);\n    tmax = Math.max(tx1, tx2);\n\n    const ty1 = (this.top - ray.pos.y) * yinv;\n    const ty2 = (this.bottom - ray.pos.y) * yinv;\n    tmin = Math.max(tmin, Math.min(ty1, ty2));\n    tmax = Math.min(tmax, Math.max(ty1, ty2));\n\n    return tmax >= Math.max(0, tmin) && tmin < farClipDistance;\n  }\n\n  public rayCastTime(ray: Ray, farClipDistance = Infinity): number {\n    // algorithm from https://tavianator.com/fast-branchless-raybounding-box-intersections/\n    let tmin = -Infinity;\n    let tmax = +Infinity;\n\n    const xinv = ray.dir.x === 0 ? Number.MAX_VALUE : 1 / ray.dir.x;\n    const yinv = ray.dir.y === 0 ? Number.MAX_VALUE : 1 / ray.dir.y;\n\n    const tx1 = (this.left - ray.pos.x) * xinv;\n    const tx2 = (this.right - ray.pos.x) * xinv;\n    tmin = Math.min(tx1, tx2);\n    tmax = Math.max(tx1, tx2);\n\n    const ty1 = (this.top - ray.pos.y) * yinv;\n    const ty2 = (this.bottom - ray.pos.y) * yinv;\n    tmin = Math.max(tmin, Math.min(ty1, ty2));\n    tmax = Math.min(tmax, Math.max(ty1, ty2));\n\n    if (tmax >= Math.max(0, tmin) && tmin < farClipDistance) {\n      return tmin;\n    }\n    return -1;\n  }\n\n  /**\n   * Tests whether a point is contained within the bounding box\n   * @param p  The point to test\n   */\n  public contains(p: Vector): boolean;\n\n  /**\n   * Tests whether another bounding box is totally contained in this one\n   * @param bb  The bounding box to test\n   */\n  public contains(bb: BoundingBox): boolean;\n  public contains(val: any): boolean {\n    if (val instanceof Vector) {\n      return this.left <= val.x && this.top <= val.y && this.bottom >= val.y && this.right >= val.x;\n    } else if (val instanceof BoundingBox) {\n      if (this.left < val.left && this.top < val.top && val.bottom < this.bottom && val.right < this.right) {\n        return true;\n      }\n      return false;\n    }\n    return false;\n  }\n\n  /**\n   * Combines this bounding box and another together returning a new bounding box\n   * @param other  The bounding box to combine\n   */\n  public combine(other: BoundingBox): BoundingBox {\n    const compositeBB = new BoundingBox(\n      Math.min(this.left, other.left),\n      Math.min(this.top, other.top),\n      Math.max(this.right, other.right),\n      Math.max(this.bottom, other.bottom)\n    );\n    return compositeBB;\n  }\n\n  public get dimensions(): Vector {\n    return new Vector(this.width, this.height);\n  }\n\n  /**\n   * Test wether this bounding box intersects with another returning\n   * the intersection vector that can be used to resolve the collision. If there\n   * is no intersection null is returned.\n   *\n   * @param other  Other [[BoundingBox]] to test intersection with\n   * @returns A Vector in the direction of the current BoundingBox, this <- other\n   */\n  public intersect(other: BoundingBox): Vector {\n    const totalBoundingBox = this.combine(other);\n\n    // If the total bounding box is less than or equal the sum of the 2 bounds then there is collision\n    if (\n      totalBoundingBox.width < other.width + this.width &&\n      totalBoundingBox.height < other.height + this.height &&\n      !totalBoundingBox.dimensions.equals(other.dimensions) &&\n      !totalBoundingBox.dimensions.equals(this.dimensions)\n    ) {\n      // collision\n      let overlapX = 0;\n      // right edge is between the other's left and right edge\n      /**\n       *     +-this-+\n       *     |      |\n       *     |    +-other-+\n       *     +----|-+     |\n       *          |       |\n       *          +-------+\n       *         <---\n       *          ^ overlap\n       */\n      if (this.right >= other.left && this.right <= other.right) {\n        overlapX = other.left - this.right;\n        // right edge is past the other's right edge\n        /**\n         *     +-other-+\n         *     |       |\n         *     |    +-this-+\n         *     +----|--+   |\n         *          |      |\n         *          +------+\n         *          --->\n         *          ^ overlap\n         */\n      } else {\n        overlapX = other.right - this.left;\n      }\n\n      let overlapY = 0;\n      // top edge is between the other's top and bottom edge\n      /**\n       *     +-other-+\n       *     |       |\n       *     |    +-this-+   | <- overlap\n       *     +----|--+   |   |\n       *          |      |  \\ /\n       *          +------+   '\n       */\n      if (this.top <= other.bottom && this.top >= other.top) {\n        overlapY = other.bottom - this.top;\n        // top edge is above the other top edge\n        /**\n         *     +-this-+         .\n         *     |      |        / \\\n         *     |    +-other-+   | <- overlap\n         *     +----|-+     |   |\n         *          |       |\n         *          +-------+\n         */\n      } else {\n        overlapY = other.top - this.bottom;\n      }\n\n      if (Math.abs(overlapX) < Math.abs(overlapY)) {\n        return new Vector(overlapX, 0);\n      } else {\n        return new Vector(0, overlapY);\n      }\n      // Case of total containment of one bounding box by another\n    } else if (totalBoundingBox.dimensions.equals(other.dimensions) || totalBoundingBox.dimensions.equals(this.dimensions)) {\n      let overlapX = 0;\n      // this is wider than the other\n      if (this.width - other.width >= 0) {\n        // This right edge is closest to the others right edge\n        if (this.right - other.right <= other.left - this.left) {\n          overlapX = other.left - this.right;\n          // This left edge is closest to the others left edge\n        } else {\n          overlapX = other.right - this.left;\n        }\n        // other is wider than this\n      } else {\n        // This right edge is closest to the others right edge\n        if (other.right - this.right <= this.left - other.left) {\n          overlapX = this.left - other.right;\n          // This left edge is closest to the others left edge\n        } else {\n          overlapX = this.right - other.left;\n        }\n      }\n\n      let overlapY = 0;\n      // this is taller than other\n      if (this.height - other.height >= 0) {\n        // The bottom edge is closest to the others bottom edge\n        if (this.bottom - other.bottom <= other.top - this.top) {\n          overlapY = other.top - this.bottom;\n        } else {\n          overlapY = other.bottom - this.top;\n        }\n        // other is taller than this\n      } else {\n        // The bottom edge is closest to the others bottom edge\n        if (other.bottom - this.bottom <= this.top - other.top) {\n          overlapY = this.top - other.bottom;\n        } else {\n          overlapY = this.bottom - other.top;\n        }\n      }\n\n      if (Math.abs(overlapX) < Math.abs(overlapY)) {\n        return new Vector(overlapX, 0);\n      } else {\n        return new Vector(0, overlapY);\n      }\n    } else {\n      return null;\n    }\n  }\n\n  /**\n   * Test whether the bounding box has intersected with another bounding box, returns the side of the current bb that intersected.\n   * @param bb The other actor to test\n   */\n  public intersectWithSide(bb: BoundingBox): Side {\n    const intersect = this.intersect(bb);\n    return BoundingBox.getSideFromIntersection(intersect);\n  }\n\n  /* istanbul ignore next */\n  public debugDraw(ctx: CanvasRenderingContext2D, color: Color = Color.Yellow) {\n    ctx.strokeStyle = color.toString();\n    ctx.strokeRect(this.left, this.top, this.width, this.height);\n  }\n\n  /**\n   * Draw a debug bounding box\n   * @param ex\n   * @param color\n   */\n  public draw(ex: ExcaliburGraphicsContext, color: Color = Color.Yellow) {\n    ex.debug.drawRect(this.left, this.top, this.width, this.height, { color });\n  }\n}\n","/**\n * Internal class used to build instances of AudioContext\n */\n/* istanbul ignore next */\nexport class AudioContextFactory {\n  private static _INSTANCE: AudioContext = null;\n\n  public static create(): AudioContext {\n    if (!this._INSTANCE) {\n      if ((<any>window).AudioContext || (<any>window).webkitAudioContext) {\n        this._INSTANCE = new AudioContext();\n      }\n    }\n\n    return this._INSTANCE;\n  }\n}\n","import { AudioContextFactory } from '../Resources/Sound/AudioContext';\nimport { Logger } from './Log';\n\nexport interface LegacyWebAudioSource {\n  playbackState: string;\n  PLAYING_STATE: 'playing';\n  FINISHED_STATE: 'finished';\n}\n\n/**\n * Patch for detecting legacy web audio in browsers\n * @internal\n * @param source\n */\nfunction isLegacyWebAudioSource(source: any): source is LegacyWebAudioSource {\n  return !!source.playbackState;\n}\n\nexport class WebAudio {\n  private static _UNLOCKED: boolean = false;\n\n  /**\n   * Play an empty sound to unlock Safari WebAudio context. Call this function\n   * right after a user interaction event.\n   * @source https://paulbakaus.com/tutorials/html5/web-audio-on-ios/\n   */\n  static unlock(): Promise<boolean> {\n    const promise = new Promise<boolean>((resolve, reject) => {\n      if (WebAudio._UNLOCKED || !AudioContextFactory.create()) {\n        return resolve(true);\n      }\n      const unlockTimeoutTimer = setTimeout(() => {\n        Logger.getInstance().warn('Excalibur was unable to unlock the audio context, audio probably will not play in this browser.');\n        resolve(false);\n      }, 200);\n\n      const audioContext = AudioContextFactory.create();\n      audioContext.resume().then(\n        () => {\n          // create empty buffer and play it\n          const buffer = audioContext.createBuffer(1, 1, 22050);\n          const source = audioContext.createBufferSource();\n          let ended = false;\n\n          source.buffer = buffer;\n          source.connect(audioContext.destination);\n          source.onended = () => (ended = true);\n\n          source.start(0);\n\n          // by checking the play state after some time, we know if we're really unlocked\n          setTimeout(() => {\n            if (isLegacyWebAudioSource(source)) {\n              if (source.playbackState === source.PLAYING_STATE || source.playbackState === source.FINISHED_STATE) {\n                WebAudio._UNLOCKED = true;\n              }\n            } else {\n              if (audioContext.currentTime > 0 || ended) {\n                WebAudio._UNLOCKED = true;\n              }\n            }\n          }, 0);\n\n          clearTimeout(unlockTimeoutTimer);\n          resolve(true);\n        },\n        () => {\n          reject();\n        }\n      );\n    });\n\n\n    return promise;\n  }\n\n  static isUnlocked() {\n    return this._UNLOCKED;\n  }\n}\n","import { GameEvent, SubscribeEvent, UnsubscribeEvent } from './Events';\nimport { Eventable } from './Interfaces/Evented';\n\nexport class EventDispatcher<T = any> implements Eventable {\n  private _handlers: { [key: string]: { (event: GameEvent<T>): void }[] } = {};\n  private _wiredEventDispatchers: Eventable[] = [];\n\n  private _target: T;\n\n  /**\n   * @param target  The object that will be the recipient of events from this event dispatcher\n   */\n  constructor(target: T) {\n    this._target = target;\n  }\n\n  /**\n   * Clears any existing handlers or wired event dispatchers on this event dispatcher\n   */\n  public clear() {\n    this._handlers = {};\n    this._wiredEventDispatchers = [];\n  }\n\n  /**\n   * Emits an event for target\n   * @param eventName  The name of the event to publish\n   * @param event      Optionally pass an event data object to the handler\n   */\n  public emit(eventName: string, event: GameEvent<T>) {\n    if (!eventName) {\n      // key not mapped\n      return;\n    }\n    eventName = eventName.toLowerCase();\n    const target = this._target;\n    if (!event) {\n      event = new GameEvent();\n    }\n    try {\n      if (!event.target) {\n        event.target = target;\n      }\n    } catch {\n      // pass\n    }\n    let i: number, len: number;\n\n    if (this._handlers[eventName]) {\n      i = 0;\n      len = this._handlers[eventName].length;\n\n      for (i; i < len; i++) {\n        this._handlers[eventName][i].call(target, event);\n      }\n    }\n\n    i = 0;\n    len = this._wiredEventDispatchers.length;\n\n    for (i; i < len; i++) {\n      this._wiredEventDispatchers[i].emit(eventName, event);\n    }\n  }\n\n  /**\n   * Subscribe an event handler to a particular event name, multiple handlers per event name are allowed.\n   * @param eventName  The name of the event to subscribe to\n   * @param handler    The handler callback to fire on this event\n   */\n  public on(eventName: string, handler: (event: GameEvent<T>) => void) {\n    eventName = eventName.toLowerCase();\n    if (!this._handlers[eventName]) {\n      this._handlers[eventName] = [];\n    }\n    this._handlers[eventName].push(handler);\n\n    // meta event handlers\n    if (eventName !== 'unsubscribe' && eventName !== 'subscribe') {\n      this.emit('subscribe', new SubscribeEvent(eventName, handler));\n    }\n  }\n\n  /**\n   * Unsubscribe an event handler(s) from an event. If a specific handler\n   * is specified for an event, only that handler will be unsubscribed.\n   * Otherwise all handlers will be unsubscribed for that event.\n   *\n   * @param eventName  The name of the event to unsubscribe\n   * @param handler    Optionally the specific handler to unsubscribe\n   */\n  public off(eventName: string, handler?: (event: GameEvent<T>) => void) {\n    eventName = eventName.toLowerCase();\n    const eventHandlers = this._handlers[eventName];\n\n    if (eventHandlers) {\n      // if no explicit handler is give with the event name clear all handlers\n      if (!handler) {\n        this._handlers[eventName].length = 0;\n      } else {\n        const index = eventHandlers.indexOf(handler);\n        this._handlers[eventName].splice(index, 1);\n      }\n    }\n    // meta event handlers\n    if (eventName !== 'unsubscribe' && eventName !== 'subscribe') {\n      this.emit('unsubscribe', new UnsubscribeEvent(eventName, handler));\n    }\n  }\n\n  /**\n   * Once listens to an event one time, then unsubscribes from that event\n   *\n   * @param eventName The name of the event to subscribe to once\n   * @param handler   The handler of the event that will be auto unsubscribed\n   */\n  public once(eventName: string, handler: (event: GameEvent<T>) => void) {\n    const metaHandler = (event: GameEvent<T>) => {\n      const ev = event || new GameEvent();\n      try {\n        ev.target = ev.target || this._target;\n      } catch {\n        // pass\n      }\n\n      this.off(eventName, handler);\n      handler.call(ev.target, ev);\n    };\n\n    this.on(eventName, metaHandler);\n  }\n\n  /**\n   * Wires this event dispatcher to also receive events from another\n   */\n  public wire(eventDispatcher: EventDispatcher): void {\n    eventDispatcher._wiredEventDispatchers.push(this);\n  }\n\n  /**\n   * Unwires this event dispatcher from another\n   */\n  public unwire(eventDispatcher: EventDispatcher): void {\n    const index = eventDispatcher._wiredEventDispatchers.indexOf(this);\n    if (index > -1) {\n      eventDispatcher._wiredEventDispatchers.splice(index, 1);\n    }\n  }\n}\n","import { GameEvent } from './Events';\nimport { EventDispatcher } from './EventDispatcher';\nimport { Eventable } from './Interfaces/Evented';\n\n/**\n * Excalibur base class that provides basic functionality such as [[EventDispatcher]]\n * and extending abilities for vanilla Javascript projects\n */\nexport class Class implements Eventable {\n  /**\n   * Direct access to the game object event dispatcher.\n   */\n  public eventDispatcher: EventDispatcher;\n\n  constructor() {\n    this.eventDispatcher = new EventDispatcher(this);\n  }\n\n  /**\n   * Alias for `addEventListener`. You can listen for a variety of\n   * events off of the engine; see the events section below for a complete list.\n   * @param eventName  Name of the event to listen for\n   * @param handler    Event handler for the thrown event\n   */\n  public on(eventName: string, handler: (event: GameEvent<any>) => void) {\n    this.eventDispatcher.on(eventName, handler);\n  }\n\n  /**\n   * Alias for `removeEventListener`. If only the eventName is specified\n   * it will remove all handlers registered for that specific event. If the eventName\n   * and the handler instance are specified only that handler will be removed.\n   *\n   * @param eventName  Name of the event to listen for\n   * @param handler    Event handler for the thrown event\n   */\n  public off(eventName: string, handler?: (event: GameEvent<any>) => void) {\n    this.eventDispatcher.off(eventName, handler);\n  }\n\n  /**\n   * Emits a new event\n   * @param eventName   Name of the event to emit\n   * @param eventObject Data associated with this event\n   */\n  public emit(eventName: string, eventObject: GameEvent<any>) {\n    this.eventDispatcher.emit(eventName, eventObject);\n  }\n\n  /**\n   * Once listens to an event one time, then unsubscribes from that event\n   *\n   * @param eventName The name of the event to subscribe to once\n   * @param handler   The handler of the event that will be auto unsubscribed\n   */\n  public once(eventName: string, handler: (event: GameEvent<any>) => void) {\n    this.eventDispatcher.once(eventName, handler);\n  }\n}\n","import { Color } from '../Color';\nimport { Vector } from '../Math/vector';\n\n/**\n * A canvas linecap style. \"butt\" is the default flush style, \"round\" is a semi-circle cap with a radius half the width of\n * the line, and \"square\" is a rectangle that is an equal width and half height cap.\n */\nexport type LineCapStyle = 'butt' | 'round' | 'square';\n\n/* istanbul ignore next */\n/**\n * Draw a line on canvas context\n *\n * @param ctx The canvas context\n * @param color The color of the line\n * @param x1 The start x coordinate\n * @param y1 The start y coordinate\n * @param x2 The ending x coordinate\n * @param y2 The ending y coordinate\n * @param thickness The line thickness\n * @param cap The [[LineCapStyle]] (butt, round, or square)\n */\nexport function line(\n  ctx: CanvasRenderingContext2D,\n  color: Color = Color.Red,\n  x1: number,\n  y1: number,\n  x2: number,\n  y2: number,\n  thickness: number = 1,\n  cap: LineCapStyle = 'butt'\n) {\n  ctx.beginPath();\n  ctx.lineWidth = thickness;\n  ctx.lineCap = cap;\n  ctx.strokeStyle = color.toString();\n  ctx.moveTo(x1, y1);\n  ctx.lineTo(x2, y2);\n  ctx.closePath();\n  ctx.stroke();\n}\n\n/* istanbul ignore next */\n/**\n * Draw the vector as a point onto the canvas.\n */\nexport function point(ctx: CanvasRenderingContext2D, color: Color = Color.Red, point: Vector): void {\n  ctx.beginPath();\n  ctx.strokeStyle = color.toString();\n  ctx.arc(point.x, point.y, 5, 0, Math.PI * 2);\n  ctx.closePath();\n  ctx.stroke();\n}\n\n/**\n * Draw the vector as a line onto the canvas starting a origin point.\n */\n/* istanbul ignore next */\n/**\n *\n */\nexport function vector(ctx: CanvasRenderingContext2D, color: Color, origin: Vector, vector: Vector, scale: number = 1.0): void {\n  const c = color ? color.toString() : 'blue';\n  const v = vector.scale(scale);\n  ctx.beginPath();\n  ctx.strokeStyle = c;\n  ctx.moveTo(origin.x, origin.y);\n  ctx.lineTo(origin.x + v.x, origin.y + v.y);\n  ctx.closePath();\n  ctx.stroke();\n}\n\n/**\n * Represents border radius values\n */\nexport interface BorderRadius {\n  /**\n   * Top-left\n   */\n  tl: number;\n  /**\n   * Top-right\n   */\n  tr: number;\n  /**\n   * Bottom-right\n   */\n  br: number;\n  /**\n   * Bottom-left\n   */\n  bl: number;\n}\n\n/**\n * Draw a round rectangle on a canvas context\n *\n * @param ctx The canvas context\n * @param x The top-left x coordinate\n * @param y The top-left y coordinate\n * @param width The width of the rectangle\n * @param height The height of the rectangle\n * @param radius The border radius of the rectangle\n * @param stroke The [[Color]] to stroke rectangle with\n * @param fill The [[Color]] to fill rectangle with\n */\nexport function roundRect(\n  ctx: CanvasRenderingContext2D,\n  x: number,\n  y: number,\n  width: number,\n  height: number,\n  radius: number | BorderRadius = 5,\n  stroke: Color = Color.White,\n  fill: Color = null\n) {\n  let br: BorderRadius;\n\n  if (typeof radius === 'number') {\n    br = { tl: radius, tr: radius, br: radius, bl: radius };\n  } else {\n    const defaultRadius: BorderRadius = { tl: 0, tr: 0, br: 0, bl: 0 };\n\n    for (const prop in defaultRadius) {\n      if (defaultRadius.hasOwnProperty(prop)) {\n        const side = <keyof BorderRadius>prop;\n        br[side] = radius[side] || defaultRadius[side];\n      }\n    }\n  }\n\n  ctx.beginPath();\n  ctx.moveTo(x + br.tl, y);\n  ctx.lineTo(x + width - br.tr, y);\n  ctx.quadraticCurveTo(x + width, y, x + width, y + br.tr);\n  ctx.lineTo(x + width, y + height - br.br);\n  ctx.quadraticCurveTo(x + width, y + height, x + width - br.br, y + height);\n  ctx.lineTo(x + br.bl, y + height);\n  ctx.quadraticCurveTo(x, y + height, x, y + height - br.bl);\n  ctx.lineTo(x, y + br.tl);\n  ctx.quadraticCurveTo(x, y, x + br.tl, y);\n  ctx.closePath();\n\n  if (fill) {\n    ctx.fillStyle = fill.toString();\n    ctx.fill();\n  }\n\n  if (stroke) {\n    ctx.strokeStyle = stroke.toString();\n    ctx.stroke();\n  }\n}\n\n/**\n *\n */\nexport function circle(\n  ctx: CanvasRenderingContext2D,\n  x: number,\n  y: number,\n  radius: number,\n  stroke: Color = Color.White,\n  fill: Color = null\n) {\n  ctx.beginPath();\n  ctx.arc(x, y, radius, 0, Math.PI * 2);\n  ctx.closePath();\n\n  if (fill) {\n    ctx.fillStyle = fill.toString();\n    ctx.fill();\n  }\n\n  if (stroke) {\n    ctx.strokeStyle = stroke.toString();\n    ctx.stroke();\n  }\n}\n","import { Vector, vec } from '../Math/vector';\nimport { ExcaliburGraphicsContext } from './Context/ExcaliburGraphicsContext';\nimport { BoundingBox } from '../Collision/BoundingBox';\n\nexport interface GraphicOptions {\n  /**\n   * The width of the graphic\n   */\n  width?: number;\n  /**\n   * The height of the graphic\n   */\n  height?: number;\n  /**\n   * SHould the graphic be flipped horizontally\n   */\n  flipHorizontal?: boolean;\n  /**\n   * Should the graphic be flipped vertically\n   */\n  flipVertical?: boolean;\n  /**\n   * The rotation of the graphic\n   */\n  rotation?: number;\n  /**\n   * The scale of the graphic\n   */\n  scale?: Vector;\n  /**\n   * The opacity of the graphic\n   */\n  opacity?: number;\n  /**\n   * The origin of the drawing in pixels to use when applying transforms, by default it will be the center of the image\n   */\n  origin?: Vector;\n}\n\n/**\n * A Graphic is the base Excalibur primitive for something that can be drawn to the [[ExcaliburGraphicsContext]].\n * [[Sprite]], [[Animation]], [[GraphicsGroup]], [[Canvas]], [[Rectangle]], [[Circle]], and [[Polygon]] all derive from the\n * [[Graphic]] abstract class.\n *\n * Implementors of a Graphic must override the abstract [[Graphic._drawImage]] method to render an image to the graphics context. Graphic\n * handles all the position, rotation, and scale transformations in [[Graphic._preDraw]] and [[Graphic._postDraw]]\n */\nexport abstract class Graphic {\n  private static _ID: number = 0;\n  readonly id = Graphic._ID++;\n\n  /**\n   * Gets or sets wether to show debug information about the graphic\n   */\n  public showDebug: boolean = false;\n\n  /**\n   * Gets or sets the flipHorizontal, which will flip the graphic horizontally (across the y axis)\n   */\n  public flipHorizontal: boolean = false;\n\n  /**\n   * Gets or sets the flipVertical, which will flip the graphic vertically (across the x axis)\n   */\n  public flipVertical: boolean = false;\n\n  /**\n   * Gets or sets the rotation of the graphic\n   */\n  public rotation: number = 0;\n\n  /**\n   * Gets or sets the opacity of the graphic, 0 is transparent, 1 is solid (opaque).\n   */\n  public opacity: number = 1;\n\n  /**\n   * Gets or sets the scale of the graphic, this affects the width and\n   */\n  public scale = Vector.One;\n\n  /**\n   * Gets or sets the origin of the graphic, if not set the center of the graphic is the origin\n   */\n  public origin: Vector | null = null;\n\n  constructor(options?: GraphicOptions) {\n    if (options) {\n      this.origin = options.origin ?? this.origin;\n      this.flipHorizontal = options.flipHorizontal ?? this.flipHorizontal;\n      this.flipVertical = options.flipVertical ?? this.flipVertical;\n      this.rotation = options.rotation ?? this.rotation;\n      this.opacity = options.opacity ?? this.opacity;\n      this.scale = options.scale ?? this.scale;\n    }\n  }\n\n  public cloneGraphicOptions(): GraphicOptions {\n    return {\n      origin: this.origin ? this.origin.clone() : null,\n      flipHorizontal: this.flipHorizontal,\n      flipVertical: this.flipVertical,\n      rotation: this.rotation,\n      opacity: this.opacity,\n      scale: this.scale ? this.scale.clone() : null\n    };\n  }\n\n  private _width: number = 0;\n\n  /**\n   * Gets or sets the width of the graphic (always positive)\n   */\n  public get width() {\n    return Math.abs(this._width * this.scale.x);\n  }\n\n  private _height: number = 0;\n\n  /**\n   * Gets or sets the height of the graphic (always positive)\n   */\n  public get height() {\n    return Math.abs(this._height * this.scale.y);\n  }\n\n  public set width(value: number) {\n    this._width = value;\n  }\n\n  public set height(value: number) {\n    this._height = value;\n  }\n\n  /**\n   * Gets a copy of the bounds in pixels occupied by the graphic on the the screen. This includes scale.\n   */\n  public get localBounds(): BoundingBox {\n    return BoundingBox.fromDimension(this.width, this.height, Vector.Zero);\n  }\n\n  /**\n   * Draw the whole graphic to the context including transform\n   * @param ex The excalibur graphics context\n   * @param x\n   * @param y\n   */\n  public draw(ex: ExcaliburGraphicsContext, x: number, y: number): void {\n    this._preDraw(ex, x, y);\n    this._drawImage(ex, 0, 0);\n    this._postDraw(ex);\n  }\n\n  /**\n   * Meant to be overriden by the graphic implementation to draw the underlying image (HTMLCanvasElement or HTMLImageElement)\n   * to the graphics context without transform. Transformations like position, rotation, and scale are handled by [[Graphic._preDraw]]\n   * and [[Graphic._postDraw]]\n   * @param ex The excalibur graphics context\n   * @param x\n   * @param y\n   */\n  protected abstract _drawImage(ex: ExcaliburGraphicsContext, x: number, y: number): void;\n\n  /**\n   * Apply affine transformations to the graphics context to manipulate the graphic before [[Graphic._drawImage]]\n   * @param ex\n   * @param x\n   * @param y\n   */\n  protected _preDraw(ex: ExcaliburGraphicsContext, x: number, y: number): void {\n    ex.save();\n    ex.translate(x, y);\n    ex.scale(Math.abs(this.scale.x), Math.abs(this.scale.y));\n    this._rotate(ex);\n    this._flip(ex);\n    // it is important to multiply alphas so graphics respect the current context\n    ex.opacity = ex.opacity * this.opacity;\n  }\n\n  protected _rotate(ex: ExcaliburGraphicsContext) {\n    const scaleDirX = this.scale.x > 0 ? 1 : -1;\n    const scaleDirY = this.scale.y > 0 ? 1 : -1;\n    const origin = this.origin ?? vec(this.width / 2, this.height / 2);\n    ex.translate(origin.x, origin.y);\n    ex.rotate(this.rotation);\n    // This is for handling direction changes 1 or -1, that way we don't have mismatched translates()\n    ex.scale(scaleDirX, scaleDirY);\n    ex.translate(-origin.x, -origin.y);\n  }\n\n  protected _flip(ex: ExcaliburGraphicsContext) {\n    if (this.flipHorizontal) {\n      ex.translate(this.width / this.scale.x, 0);\n      ex.scale(-1, 1);\n    }\n\n    if (this.flipVertical) {\n      ex.translate(0, this.height / this.scale.y);\n      ex.scale(1, -1);\n    }\n  }\n\n  /**\n   * Apply any addtional work after [[Graphic._drawImage]] and restore the context state.\n   * @param ex\n   */\n  protected _postDraw(ex: ExcaliburGraphicsContext): void {\n    if (this.showDebug) {\n      ex.debug.drawRect(0, 0, this.width, this.height);\n    }\n    ex.restore();\n  }\n\n  /**\n   * Returns a new instance of the graphic that has the same properties\n   */\n  abstract clone(): Graphic;\n}\n","/**\n * Checks if the current number is a power of two\n */\nexport function isPowerOfTwo(x: number): boolean {\n  return (x & (x - 1)) === 0;\n}\n\n/**\n * Returns the next highest power of two\n */\nexport function nextHighestPowerOfTwo(x: number): number {\n  --x;\n  for (let i = 1; i < 32; i <<= 1) {\n    x = x | (x >> i);\n  }\n  return x + 1;\n}\n\n/**\n * Returns the input number if a power of two, otherwise the next highest power of two\n */\nexport function ensurePowerOfTwo(x: number): number {\n  if (!isPowerOfTwo(x)) {\n    return nextHighestPowerOfTwo(x);\n  }\n  return x;\n}\n","/**\n * Watch an object with a proxy, only fires if property value is different\n */\nexport function watch<T extends object>(type: T, change: (type: T) => any): T {\n  if (!type) {\n    return type;\n  }\n  if ((type as any).__isProxy === undefined) {\n    // expando hack to mark a proxy\n    return new Proxy(type, {\n      set: (obj, prop, value) => {\n        // The default behavior to store the value\n        if ((obj as any)[prop] !== value) {\n          (obj as any)[prop] = value;\n          // Avoid watching private junk\n          if (typeof prop === 'string') {\n            if (prop[0] !== '_') {\n              change(obj);\n            }\n          }\n        }\n        // Indicate success\n        return true;\n      },\n      get: (obj, prop) => {\n        if (prop !== '__isProxy') {\n          return (obj as any)[prop];\n        }\n        return true;\n      }\n    });\n  }\n  return type;\n}\n\n/**\n * Watch an object with a proxy, fires change on any property value change\n */\nexport function watchAny<T extends object>(type: T, change: (type: T) => any): T {\n  if (!type) {\n    return type;\n  }\n  if ((type as any).__isProxy === undefined) {\n    // expando hack to mark a proxy\n    return new Proxy(type, {\n      set: (obj, prop, value) => {\n        // The default behavior to store the value\n        (obj as any)[prop] = value;\n        // Avoid watching private junk\n        if (typeof prop === 'string') {\n          if (prop[0] !== '_') {\n            change(obj);\n          }\n        }\n\n        // Indicate success\n        return true;\n      },\n      get: (obj, prop) => {\n        if (prop !== '__isProxy') {\n          return (obj as any)[prop];\n        }\n        return true;\n      }\n    });\n  }\n  return type;\n}\n","import { HTMLImageSource } from './ExcaliburGraphicsContext';\nimport { ensurePowerOfTwo, isPowerOfTwo } from './webgl-util';\n\n/**\n * Manages loading image sources into webgl textures, a unique id is associated with all sources\n */\nexport class TextureLoader {\n  private static _POT_CANVAS = document.createElement('canvas');\n  private static _POT_CTX = TextureLoader._POT_CANVAS.getContext('2d');\n\n  private static _GL: WebGLRenderingContext;\n\n  private static _TEXTURE_MAP = new Map<HTMLImageSource, WebGLTexture>();\n\n  public static registerContext(context: WebGLRenderingContext): void {\n    TextureLoader._GL = context;\n  }\n\n  /**\n   * Get the WebGL Texture from a source image\n   * @param image\n   */\n  public static get(image: HTMLImageSource): WebGLTexture {\n    return TextureLoader._TEXTURE_MAP.get(image);\n  }\n\n  /**\n   * Returns whether a source image has been loaded as a texture\n   * @param image\n   */\n  public static has(image: HTMLImageSource): boolean {\n    return TextureLoader._TEXTURE_MAP.has(image);\n  }\n\n  /**\n   * Loads a graphic into webgl and returns it's texture info, a webgl context must be previously registered\n   * @param image Source graphic\n   * @param forceUpdate Optionally force a texture to be reloaded, useful if the source graphic has changed\n   */\n  public static load(image: HTMLImageSource, forceUpdate = false): WebGLTexture {\n    // Ignore loading if webgl is not registered\n    const gl = TextureLoader._GL;\n    if (!gl) {\n      return null;\n    }\n\n    let tex: WebGLTexture = null;\n    // If reuse the texture if it's from the same source\n    if (TextureLoader.has(image)) {\n      tex = TextureLoader.get(image);\n    }\n\n    // Update existing webgl texture and return early\n    if (tex) {\n      if (forceUpdate) {\n        gl.bindTexture(gl.TEXTURE_2D, tex);\n        const source = TextureLoader.toPowerOfTwoImage(image);\n        gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, source);\n      }\n      return tex;\n    }\n\n    // No texture exists create a new one\n    tex = gl.createTexture();\n    const source = TextureLoader.toPowerOfTwoImage(image);\n\n    gl.bindTexture(gl.TEXTURE_2D, tex);\n\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\n\n    // NEAREST for pixels\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.NEAREST);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.NEAREST);\n\n    gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, source);\n\n    TextureLoader._TEXTURE_MAP.set(image, tex);\n    return tex;\n  }\n\n  /**\n   * Converts source images into power of two images, WebGL only supports POT images\n   * https://www.khronos.org/webgl/wiki/WebGL_and_OpenGL_Differences#Non-Power_of_Two_Texture_Support\n   * @param image\n   */\n  public static toPowerOfTwoImage(image: HTMLImageSource): HTMLImageSource {\n    const potCanvas = TextureLoader._POT_CANVAS;\n    const potCtx = TextureLoader._POT_CTX;\n    if (!isPowerOfTwo(image.width) || !isPowerOfTwo(image.height)) {\n      // Scale up the texture to the next highest power of two dimensions.\n\n      potCanvas.width = ensurePowerOfTwo(image.width);\n      potCanvas.height = ensurePowerOfTwo(image.height);\n      potCtx.imageSmoothingEnabled = false;\n      potCtx.clearRect(0, 0, potCanvas.width, potCanvas.height);\n      potCtx.drawImage(image, 0, 0, image.width, image.height);\n      image = potCanvas;\n    }\n    return image;\n  }\n}\n","import { Graphic, GraphicOptions } from './Graphic';\nimport { ExcaliburGraphicsContext } from './Context/ExcaliburGraphicsContext';\nimport { Color } from '../Color';\nimport { ensurePowerOfTwo } from './Context/webgl-util';\nimport { Vector } from '../Math/vector';\nimport { BoundingBox } from '../Collision/BoundingBox';\nimport { watch } from '../Util/Watch';\nimport { TextureLoader } from './Context/texture-loader';\n\nexport interface RasterOptions {\n  smoothing?: boolean;\n  color?: Color;\n  strokeColor?: Color;\n  lineWidth?: number;\n  lineDash?: number[];\n  padding?: number;\n}\n\n/**\n * A Raster is a Graphic that needs to be first painted to a HTMLCanvasElement before it can be drawn to the\n * [[ExcaliburGraphicsContext]]. This is useful for generating custom images using the 2D canvas api.\n *\n * Implementors must implemenet the [[Raster.execute]] method to rasterize their drawing.\n */\nexport abstract class Raster extends Graphic {\n  public _bitmap: HTMLCanvasElement;\n  protected _ctx: CanvasRenderingContext2D;\n  private _dirty: boolean = true;\n\n  constructor(options?: GraphicOptions & RasterOptions) {\n    super(options);\n    if (options) {\n      this.color = options.color ?? Color.Black;\n      this.strokeColor = options?.strokeColor;\n      this.smoothing = options.smoothing ?? this.smoothing;\n      this.lineWidth = options.lineWidth ?? this.lineWidth;\n      this.lineDash = options.lineDash ?? this.lineDash;\n      this.padding = options.padding ?? this.padding;\n    }\n\n    this._bitmap = document.createElement('canvas');\n    // get the default canvas width/height as a fallback\n    const bitmapWidth = options?.width ?? this._bitmap.width;\n    const bitmapHeight = options?.height ?? this._bitmap.height;\n    // Rasters use power of two images as an optimization for webgl\n    this.width = ensurePowerOfTwo(bitmapWidth);\n    this.height = ensurePowerOfTwo(bitmapHeight);\n    const maybeCtx = this._bitmap.getContext('2d');\n    if (!maybeCtx) {\n      /* istanbul ignore next */\n      throw new Error('Browser does not support 2d canvas drawing, cannot create Raster graphic');\n    } else {\n      this._ctx = maybeCtx;\n    }\n  }\n\n  public cloneRasterOptions(): RasterOptions {\n    return {\n      color: this.color ? this.color.clone() : null,\n      strokeColor: this.strokeColor ? this.strokeColor.clone() : null,\n      smoothing: this.smoothing,\n      lineWidth: this.lineWidth,\n      lineDash: this.lineDash,\n      padding: this.padding\n    };\n  }\n\n  /**\n   * Gets whether the graphic is dirty, this means there are changes that haven't been re-rasterized\n   */\n  public get dirty() {\n    return this._dirty;\n  }\n\n  /**\n   * Flags the graphic as dirty, meaning it must be re-rasterized before draw.\n   * This should be called any time the graphics state changes such that it affects the outputed drawing\n   */\n  public flagDirty() {\n    this._dirty = true;\n  }\n\n  private _originalWidth: number;\n  /**\n   * Gets or sets the current width of the Raster graphic. Setting the width will cause the raster\n   * to be flagged dirty causing a re-raster on the next draw.\n   *\n   * Any `padding`s set will be factored into the width\n   */\n  public get width() {\n    return this._getTotalWidth();\n  }\n  public set width(value: number) {\n    this._bitmap.width = value;\n    this._originalWidth = value;\n    this.flagDirty();\n  }\n\n  private _originalHeight: number;\n  /**\n   * Gets or sets the current height of the Raster graphic. Setting the height will cause the raster\n   * to be flagged dirty causing a re-raster on the next draw.\n   *\n   * Any `padding` set will be factored into the height\n   */\n  public get height() {\n    return this._getTotalHeight();\n  }\n\n  public set height(value: number) {\n    this._bitmap.height = value;\n    this._originalHeight = value;\n    this.flagDirty();\n  }\n\n  private _getTotalWidth() {\n    return (this._originalWidth ?? this._bitmap.width) + this.padding * 2;\n  }\n\n  private _getTotalHeight() {\n    return (this._originalHeight ?? this._bitmap.height) + this.padding * 2;\n  }\n\n  /**\n   * Returns the local bounds of the Raster including the padding\n   */\n  public get localBounds() {\n    return BoundingBox.fromDimension(this._getTotalWidth() * this.scale.x, this._getTotalHeight() * this.scale.y, Vector.Zero);\n  }\n\n  private _smoothing: boolean = false;\n  /**\n   * Gets or sets the smoothing (anti-aliasing of the graphic). Setting the height will cause the raster\n   * to be flagged dirty causing a re-raster on the next draw.\n   */\n  public get smoothing() {\n    return this._smoothing;\n  }\n  public set smoothing(value: boolean) {\n    this._smoothing = value;\n    this.flagDirty();\n  }\n\n  private _color: Color = watch(Color.Black, () => this.flagDirty());\n  /**\n   * Gets or sets the fillStyle of the Raster graphic. Setting the fillStyle will cause the raster to be\n   * flagged dirty causing a re-raster on the next draw.\n   */\n  public get color() {\n    return this._color;\n  }\n  public set color(value) {\n    if (!this._color?.equal(value)) {\n      this.flagDirty();\n    }\n    this._color = watch(value, () => this.flagDirty());\n  }\n\n  private _strokeColor: Color;\n  /**\n   * Gets or sets the strokeStyle of the Raster graphic. Setting the strokeStyle will cause the raster to be\n   * flagged dirty causing a re-raster on the next draw.\n   */\n  public get strokeColor() {\n    return this._strokeColor;\n  }\n  public set strokeColor(value) {\n    if (!this._strokeColor?.equal(value)) {\n      this.flagDirty();\n    }\n    this._strokeColor = watch(value, () => this.flagDirty());\n  }\n\n  private _lineWidth: number = 1;\n  /**\n   * Gets or sets the line width of the Raster graphic. Setting the lineWidth will cause the raster to be\n   * flagged dirty causing a re-raster on the next draw.\n   */\n  public get lineWidth() {\n    return this._lineWidth;\n  }\n  public set lineWidth(value) {\n    this._lineWidth = value;\n    this.flagDirty();\n  }\n\n  private _lineDash: number[] = [];\n  public get lineDash() {\n    return this._lineDash;\n  }\n\n  public set lineDash(value) {\n    this._lineDash = value;\n    this.flagDirty();\n  }\n\n  private _padding: number = 0;\n  public get padding() {\n    return this._padding;\n  }\n\n  public set padding(value: number) {\n    this._padding = value;\n    this.flagDirty();\n  }\n\n  /**\n   * Rasterize the graphic to a bitmap making it usuable as in excalibur. Rasterize is called automatically if\n   * the graphic is [[Raster.dirty]] on the next [[Graphic.draw]] call\n   */\n  public rasterize(): void {\n    this._dirty = false;\n    this._ctx.clearRect(0, 0, this._getTotalWidth(), this._getTotalHeight());\n    this._ctx.save();\n    this._applyRasterProperites(this._ctx);\n    this.execute(this._ctx);\n    this._ctx.restore();\n    // The webgl texture needs to be updated if it exists after a raster cycle\n    TextureLoader.load(this._bitmap, true);\n  }\n\n  protected _applyRasterProperites(ctx: CanvasRenderingContext2D) {\n    this._bitmap.width = this._getTotalWidth();\n    this._bitmap.height = this._getTotalHeight();\n    ctx.translate(this.padding, this.padding);\n    ctx.imageSmoothingEnabled = this.smoothing;\n    ctx.lineWidth = this.lineWidth;\n    ctx.setLineDash(this.lineDash ?? ctx.getLineDash());\n    ctx.strokeStyle = this.strokeColor?.toString();\n    ctx.fillStyle = this.color?.toString();\n  }\n\n  protected _drawImage(ex: ExcaliburGraphicsContext, x: number, y: number) {\n    if (this._dirty) {\n      this.rasterize();\n    }\n\n    ex.drawImage(this._bitmap, x, y);\n  }\n\n  /**\n   * Executes drawing implemenation of the graphic, this is where the specific drawing code for the graphic\n   * should be implemented. Once `rasterize()` the graphic can be drawn to the [[ExcaliburGraphicsContext]] via `draw(...)`\n   * @param ctx Canvas to draw the graphic to\n   */\n  abstract execute(ctx: CanvasRenderingContext2D): void;\n}\n","import { GraphicOptions } from './Graphic';\nimport { Raster, RasterOptions } from './Raster';\n\nexport interface CanvasOptions {\n  draw?: (ctx: CanvasRenderingContext2D) => void;\n  cache?: boolean;\n}\n\n/**\n * A canvas [[Graphic]] to provide an adapter between the 2D Canvas API and the [[ExcaliburGraphicsContext]].\n *\n * The [[Canvas]] works by re-rastering a draw handler to a HTMLCanvasElement for every draw which is then passed\n * to the [[ExcaliburGraphicsContext]] implementation as a rendered image.\n *\n * **Low performance API**\n */\nexport class Canvas extends Raster {\n  /**\n   * Return the 2D graphics context of this canvas\n   */\n  public get ctx() {\n    return this._ctx;\n  }\n\n  constructor(private _options: GraphicOptions & RasterOptions & CanvasOptions) {\n    super(_options);\n  }\n\n  public clone(): Canvas {\n    return new Canvas({\n      ...this._options,\n      ...this.cloneGraphicOptions(),\n      ...this.cloneRasterOptions()\n    });\n  }\n\n  execute(ctx: CanvasRenderingContext2D): void {\n    if (this._options?.draw) {\n      this._options?.draw(ctx);\n    }\n    if (!this._options.cache) {\n      this.flagDirty();\n    }\n  }\n}\n","import { Color } from './Color';\nimport { WebAudio } from './Util/WebAudio';\nimport { Engine } from './Engine';\nimport { Loadable } from './Interfaces/Loadable';\nimport { Class } from './Class';\nimport * as DrawUtil from './Util/DrawUtil';\n\nimport logoImg from './Loader.logo.png';\nimport loaderCss from './Loader.css';\nimport { Canvas } from './Graphics/Canvas';\nimport { Vector } from './Math/vector';\nimport { clamp, delay } from './Util/Util';\n\n/**\n * Pre-loading assets\n *\n * The loader provides a mechanism to preload multiple resources at\n * one time. The loader must be passed to the engine in order to\n * trigger the loading progress bar.\n *\n * The [[Loader]] itself implements [[Loadable]] so you can load loaders.\n *\n * ## Example: Pre-loading resources for a game\n *\n * ```js\n * // create a loader\n * var loader = new ex.Loader();\n *\n * // create a resource dictionary (best practice is to keep a separate file)\n * var resources = {\n *   TextureGround: new ex.Texture(\"/images/textures/ground.png\"),\n *   SoundDeath: new ex.Sound(\"/sound/death.wav\", \"/sound/death.mp3\")\n * };\n *\n * // loop through dictionary and add to loader\n * for (var loadable in resources) {\n *   if (resources.hasOwnProperty(loadable)) {\n *     loader.addResource(resources[loadable]);\n *   }\n * }\n *\n * // start game\n * game.start(loader).then(function () {\n *   console.log(\"Game started!\");\n * });\n * ```\n *\n * ## Customize the Loader\n *\n * The loader can be customized to show different, text, logo, background color, and button.\n *\n * ```typescript\n * const loader = new ex.Loader([playerTexture]);\n *\n * // The loaders button text can simply modified using this\n * loader.playButtonText = 'Start the best game ever';\n *\n * // The logo can be changed by inserting a base64 image string here\n *\n * loader.logo = 'data:image/png;base64,iVBORw...';\n * loader.logoWidth = 15;\n * loader.logoHeight = 14;\n *\n * // The background color can be changed like so by supplying a valid CSS color string\n *\n * loader.backgroundColor = 'red'\n * loader.backgroundColor = '#176BAA'\n *\n * // To build a completely new button\n * loader.startButtonFactory = () => {\n *     let myButton = document.createElement('button');\n *     myButton.textContent = 'The best button';\n *     return myButton;\n * };\n *\n * engine.start(loader).then(() => {});\n * ```\n */\nexport class Loader extends Class implements Loadable<Loadable<any>[]> {\n  public canvas: Canvas = new Canvas({\n    smoothing: true,\n    draw: this.draw.bind(this)\n  });\n  private _resourceList: Loadable<any>[] = [];\n  private _index = 0;\n\n  private _playButtonShown: boolean = false;\n  private _resourceCount: number = 0;\n  private _numLoaded: number = 0;\n  private _progressCounts: { [key: string]: number } = {};\n  private _totalCounts: { [key: string]: number } = {};\n  private _engine: Engine;\n\n  // logo drawing stuff\n\n  // base64 string encoding of the excalibur logo (logo-white.png)\n  public logo = logoImg;\n  public logoWidth = 468;\n  public logoHeight = 118;\n  /**\n   * Positions the top left corner of the logo image\n   * If not set, the loader automatically positions the logo\n   */\n  public logoPosition: Vector | null;\n  /**\n   * Positions the top left corner of the play button.\n   * If not set, the loader automatically positions the play button\n   */\n  public playButtonPosition: Vector | null;\n  /**\n   * Positions the top left corner of the loading bar\n   * If not set, the loader automatically positions the loading bar\n   */\n  public loadingBarPosition: Vector | null;\n\n  /**\n   * Gets or sets the color of the loading bar, default is [[Color.White]]\n   */\n  public loadingBarColor: Color = Color.White;\n\n  /**\n   * Gets or sets the background color of the loader as a hex string\n   */\n  public backgroundColor: string = '#176BAA';\n\n  protected _imageElement: HTMLImageElement;\n  protected get _image() {\n    if (!this._imageElement) {\n      this._imageElement = new Image();\n      this._imageElement.src = this.logo;\n    }\n\n    return this._imageElement;\n  }\n\n  public suppressPlayButton: boolean = false;\n  public get playButtonRootElement(): HTMLElement | null {\n    return this._playButtonRootElement;\n  }\n  public get playButtonElement(): HTMLButtonElement | null {\n    return this._playButtonElement;\n  }\n  protected _playButtonRootElement: HTMLElement;\n  protected _playButtonElement: HTMLButtonElement;\n  protected _styleBlock: HTMLStyleElement;\n  /** Loads the css from Loader.css */\n  protected _playButtonStyles: string = loaderCss.toString();\n  protected get _playButton() {\n    const existingRoot = document.getElementById('excalibur-play-root');\n    if (existingRoot) {\n      this._playButtonRootElement = existingRoot;\n    }\n    if (!this._playButtonRootElement) {\n      this._playButtonRootElement = document.createElement('div');\n      this._playButtonRootElement.id = 'excalibur-play-root';\n      this._playButtonRootElement.style.position = 'absolute';\n      document.body.appendChild(this._playButtonRootElement);\n    }\n    if (!this._styleBlock) {\n      this._styleBlock = document.createElement('style');\n      this._styleBlock.textContent = this._playButtonStyles;\n      document.head.appendChild(this._styleBlock);\n    }\n    if (!this._playButtonElement) {\n      this._playButtonElement = this.startButtonFactory();\n      this._playButtonRootElement.appendChild(this._playButtonElement);\n    }\n    return this._playButtonElement;\n  }\n\n  /**\n   * Get/set play button text\n   */\n  public playButtonText: string = 'Play game';\n\n  /**\n   * Return a html button element for excalibur to use as a play button\n   */\n  public startButtonFactory = () => {\n    let buttonElement: HTMLButtonElement = document.getElementById('excalibur-play') as HTMLButtonElement;\n    if (!buttonElement) {\n      buttonElement = document.createElement('button');\n    }\n\n    buttonElement.id = 'excalibur-play';\n    buttonElement.textContent = this.playButtonText;\n    buttonElement.style.display = 'none';\n    return buttonElement;\n  };\n\n  /**\n   * @param loadables  Optionally provide the list of resources you want to load at constructor time\n   */\n  constructor(loadables?: Loadable<any>[]) {\n    super();\n\n    if (loadables) {\n      this.addResources(loadables);\n    }\n  }\n\n  public wireEngine(engine: Engine) {\n    this._engine = engine;\n    this.canvas.width = this._engine.canvas.width;\n    this.canvas.height = this._engine.canvas.height;\n  }\n\n  /**\n   * Add a resource to the loader to load\n   * @param loadable  Resource to add\n   */\n  public addResource(loadable: Loadable<any>) {\n    const key = this._index++;\n    this._resourceList.push(loadable);\n    this._progressCounts[key] = 0;\n    this._totalCounts[key] = 1;\n    this._resourceCount++;\n  }\n\n  /**\n   * Add a list of resources to the loader to load\n   * @param loadables  The list of resources to load\n   */\n  public addResources(loadables: Loadable<any>[]) {\n    let i = 0;\n    const len = loadables.length;\n\n    for (i; i < len; i++) {\n      this.addResource(loadables[i]);\n    }\n  }\n\n  /**\n   * Returns true if the loader has completely loaded all resources\n   */\n  public isLoaded() {\n    return this._numLoaded === this._resourceCount;\n  }\n\n  /**\n   * Shows the play button and returns a promise that resolves when clicked\n   */\n  public showPlayButton(): Promise<void> {\n    if (this.suppressPlayButton) {\n      return Promise.resolve();\n    } else {\n      this._playButtonShown = true;\n      this._playButton.style.display = 'block';\n      document.body.addEventListener('keyup', (evt: KeyboardEvent) => {\n        if (evt.key === 'Enter') {\n          this._playButton.click();\n        }\n      });\n      const promise = new Promise<void>((resolve) => {\n        const startButtonHandler = (e: Event) => {\n          // We want to stop propogation to keep bubbling to the engine pointer handlers\n          e.stopPropagation();\n          resolve();\n        };\n        this._playButton.addEventListener('click', startButtonHandler);\n        this._playButton.addEventListener('touchend', startButtonHandler);\n        this._playButton.addEventListener('pointerup', startButtonHandler);\n      });\n\n      return promise;\n    }\n  }\n\n  public hidePlayButton() {\n    this._playButtonShown = false;\n    this._playButton.style.display = 'none';\n  }\n\n  /**\n   * Clean up generated elements for the loader\n   */\n  public dispose() {\n    if (this._playButtonRootElement.parentElement) {\n      this._playButtonRootElement.removeChild(this._playButtonElement);\n      document.body.removeChild(this._playButtonRootElement);\n      document.head.removeChild(this._styleBlock);\n      this._playButtonRootElement = null;\n      this._playButtonElement = null;\n      this._styleBlock = null;\n    }\n  }\n\n  update(_engine: Engine, _delta: number): void {\n    // override me\n  }\n\n  data: Loadable<any>[];\n\n  /**\n   * Begin loading all of the supplied resources, returning a promise\n   * that resolves when loading of all is complete\n   */\n  public async load(): Promise<Loadable<any>[]> {\n    await Promise.all(\n      this._resourceList.map((r) =>\n        r.load().finally(() => {\n          // capture progress\n          this._numLoaded++;\n        })\n      )\n    );\n\n    // short delay in showing the button for aesthetics\n    await delay(200);\n    await this.showPlayButton();\n    // Unlock browser AudioContext in after user gesture\n    // See: https://github.com/excaliburjs/Excalibur/issues/262\n    // See: https://github.com/excaliburjs/Excalibur/issues/1031\n    await WebAudio.unlock();\n    this.hidePlayButton();\n\n    return (this.data = this._resourceList);\n  }\n\n  public markResourceComplete(): void {\n    this._numLoaded++;\n  }\n\n  /**\n   * Returns the progess of the loader as a number between [0, 1] inclusive.\n   */\n  public get progress(): number {\n    return this._resourceCount > 0 ? clamp(this._numLoaded, 0, this._resourceCount) / this._resourceCount : 1;\n  }\n\n  /**\n   * Loader draw function. Draws the default Excalibur loading screen.\n   * Override `logo`, `logoWidth`, `logoHeight` and `backgroundColor` properties\n   * to customize the drawing, or just override entire method.\n   */\n  public draw(ctx: CanvasRenderingContext2D) {\n    const canvasHeight = this._engine.canvasHeight / this._engine.pixelRatio;\n    const canvasWidth = this._engine.canvasWidth / this._engine.pixelRatio;\n\n    if (this._playButtonRootElement) {\n      const left = this._engine.canvas.offsetLeft;\n      const top = this._engine.canvas.offsetTop;\n      const buttonWidth = this._playButton.clientWidth;\n      const buttonHeight = this._playButton.clientHeight;\n      if (this.playButtonPosition) {\n        this._playButtonRootElement.style.left = `${this.playButtonPosition.x}px`;\n        this._playButtonRootElement.style.top = `${this.playButtonPosition.y}px`;\n      } else {\n        this._playButtonRootElement.style.left = `${left + canvasWidth / 2 - buttonWidth / 2}px`;\n        this._playButtonRootElement.style.top = `${top + canvasHeight / 2 - buttonHeight / 2 + 100}px`;\n      }\n    }\n\n    ctx.fillStyle = this.backgroundColor;\n    ctx.fillRect(0, 0, canvasWidth, canvasHeight);\n\n    let logoY = canvasHeight / 2;\n    const width = Math.min(this.logoWidth, canvasWidth * 0.75);\n    let logoX = canvasWidth / 2 - width / 2;\n\n    if (this.logoPosition) {\n      logoX = this.logoPosition.x;\n      logoY = this.logoPosition.y;\n    }\n\n    const imageHeight = Math.floor(width * (this.logoHeight / this.logoWidth)); // OG height/width factor\n    const oldAntialias = this._engine.getAntialiasing();\n    this._engine.setAntialiasing(true);\n    if (!this.logoPosition) {\n      ctx.drawImage(this._image, 0, 0, this.logoWidth, this.logoHeight, logoX, logoY - imageHeight - 20, width, imageHeight);\n    } else {\n      ctx.drawImage(this._image, 0, 0, this.logoWidth, this.logoHeight, logoX, logoY, width, imageHeight);\n    }\n\n    // loading box\n    if (!this.suppressPlayButton && this._playButtonShown) {\n      this._engine.setAntialiasing(oldAntialias);\n      return;\n    }\n\n    let loadingX = logoX;\n    let loadingY = logoY;\n    if (this.loadingBarPosition) {\n      loadingX = this.loadingBarPosition.x;\n      loadingY = this.loadingBarPosition.y;\n    }\n\n    ctx.lineWidth = 2;\n    DrawUtil.roundRect(ctx, loadingX, loadingY, width, 20, 10, this.loadingBarColor);\n    const progress = width * this.progress;\n    const margin = 5;\n    const progressWidth = progress - margin * 2;\n    const height = 20 - margin * 2;\n    DrawUtil.roundRect(\n      ctx,\n      loadingX + margin,\n      loadingY + margin,\n      progressWidth > 10 ? progressWidth : 10,\n      height,\n      5,\n      null,\n      this.loadingBarColor\n    );\n    this._engine.setAntialiasing(oldAntialias);\n  }\n}\n","export default \"data:image/png;base64,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\"","import { Logger } from './Log';\n/**\n * This is the list of features that will be used to log the supported\n * features to the console when Detector.logBrowserFeatures() is called.\n */\n\nconst REPORTED_FEATURES: { [key: string]: string } = {\n  webgl: 'WebGL',\n  webaudio: 'WebAudio',\n  gamepadapi: 'Gamepad API'\n};\n\n/**\n * Interface for detected browser features matrix\n */\nexport interface DetectedFeatures {\n  readonly canvas: boolean;\n  readonly arraybuffer: boolean;\n  readonly dataurl: boolean;\n  readonly objecturl: boolean;\n  readonly rgba: boolean;\n  readonly webaudio: boolean;\n  readonly webgl: boolean;\n  readonly gamepadapi: boolean;\n}\n\ninterface CriticalTests {\n  canvasSupport(): boolean;\n  arrayBufferSupport(): boolean;\n  dataUrlSupport(): boolean;\n  objectUrlSupport(): boolean;\n  rgbaSupport(): boolean;\n}\n\ninterface WarningTests {\n  webAudioSupport(): boolean;\n  webglSupport(): boolean;\n}\n\n/**\n * Excalibur internal feature detection helper class\n */\nexport class Detector {\n  private _features: DetectedFeatures = null;\n\n  public failedTests: string[] = [];\n\n  public constructor() {\n    this._features = this._loadBrowserFeatures();\n  }\n\n  /**\n   * Returns a map of currently supported browser features. This method\n   * treats the features as a singleton and will only calculate feature\n   * support if it has not previously been done.\n   */\n  public getBrowserFeatures(): DetectedFeatures {\n    if (this._features === null) {\n      this._features = this._loadBrowserFeatures();\n    }\n    return this._features;\n  }\n\n  /**\n   * Report on non-critical browser support for debugging purposes.\n   * Use native browser console colors for visibility.\n   */\n  public logBrowserFeatures(): void {\n    let msg = '%cSUPPORTED BROWSER FEATURES\\n==========================%c\\n';\n    const args = ['font-weight: bold; color: navy', 'font-weight: normal; color: inherit'];\n\n    const supported: any = this.getBrowserFeatures();\n    for (const feature of Object.keys(REPORTED_FEATURES)) {\n      if (supported[feature]) {\n        msg += '(%c\\u2713%c)'; // ()\n        args.push('font-weight: bold; color: green');\n        args.push('font-weight: normal; color: inherit');\n      } else {\n        msg += '(%c\\u2717%c)'; // ()\n        args.push('font-weight: bold; color: red');\n        args.push('font-weight: normal; color: inherit');\n      }\n\n      msg += ' ' + REPORTED_FEATURES[feature] + '\\n';\n    }\n\n    args.unshift(msg);\n    // eslint-disable-next-line no-console\n    console.log.apply(console, args);\n  }\n\n  /**\n   * Executes several IIFE's to get a constant reference to supported\n   * features within the current execution context.\n   */\n  private _loadBrowserFeatures(): DetectedFeatures {\n    return {\n      // IIFE to check canvas support\n      canvas: (() => {\n        return this._criticalTests.canvasSupport();\n      })(),\n\n      // IIFE to check arraybuffer support\n      arraybuffer: (() => {\n        return this._criticalTests.arrayBufferSupport();\n      })(),\n\n      // IIFE to check dataurl support\n      dataurl: (() => {\n        return this._criticalTests.dataUrlSupport();\n      })(),\n\n      // IIFE to check objecturl support\n      objecturl: (() => {\n        return this._criticalTests.objectUrlSupport();\n      })(),\n\n      // IIFE to check rgba support\n      rgba: (() => {\n        return this._criticalTests.rgbaSupport();\n      })(),\n\n      // IIFE to check webaudio support\n      webaudio: (() => {\n        return this._warningTest.webAudioSupport();\n      })(),\n\n      // IIFE to check webgl support\n      webgl: (() => {\n        return this._warningTest.webglSupport();\n      })(),\n\n      // IIFE to check gamepadapi support\n      gamepadapi: (() => {\n        return !!(<any>navigator).getGamepads;\n      })()\n    };\n  }\n\n  // critical browser features required for ex to run\n  private _criticalTests: CriticalTests = {\n    // Test canvas/2d context support\n    canvasSupport: function() {\n      const elem = document.createElement('canvas');\n      return !!(elem.getContext && elem.getContext('2d'));\n    },\n\n    // Test array buffer support ex uses for downloading binary data\n    arrayBufferSupport: function() {\n      const xhr = new XMLHttpRequest();\n      xhr.open('GET', '/');\n      try {\n        xhr.responseType = 'arraybuffer';\n      } catch (e) {\n        return false;\n      }\n      return xhr.responseType === 'arraybuffer';\n    },\n\n    // Test data urls ex uses for sprites\n    dataUrlSupport: function() {\n      const canvas = document.createElement('canvas');\n      return canvas.toDataURL('image/png').indexOf('data:image/png') === 0;\n    },\n\n    // Test object url support for loading\n    objectUrlSupport: function() {\n      return 'URL' in window && 'revokeObjectURL' in URL && 'createObjectURL' in URL;\n    },\n\n    // RGBA support for colors\n    rgbaSupport: function() {\n      const style = document.createElement('a').style;\n      style.cssText = 'background-color:rgba(150,255,150,.5)';\n      return ('' + style.backgroundColor).indexOf('rgba') > -1;\n    }\n  };\n\n  // warnings excalibur performance will be degraded\n  private _warningTest: WarningTests = {\n    webAudioSupport: function() {\n      return !!(\n        (<any>window).AudioContext ||\n        (<any>window).webkitAudioContext ||\n        (<any>window).mozAudioContext ||\n        (<any>window).msAudioContext ||\n        (<any>window).oAudioContext\n      );\n    },\n    webglSupport: function() {\n      const elem = document.createElement('canvas');\n      return !!(elem.getContext && elem.getContext('webgl'));\n    }\n  };\n\n  public test(): boolean {\n    // Critical test will for ex not to run\n    let failedCritical = false;\n    for (const test in this._criticalTests) {\n      if (!this._criticalTests[<keyof CriticalTests>test].call(this)) {\n        this.failedTests.push(test);\n        Logger.getInstance().error('Critical browser feature missing, Excalibur requires:', test);\n        failedCritical = true;\n      }\n    }\n    if (failedCritical) {\n      return false;\n    }\n\n    // Warning tests do not for ex to return false to compatibility\n    for (const warning in this._warningTest) {\n      if (!this._warningTest[<keyof WarningTests>warning]()) {\n        Logger.getInstance().warn('Warning browser feature missing, Excalibur will have reduced performance:', warning);\n      }\n    }\n\n    return true;\n  }\n}\n","import { Loadable } from '../Interfaces/Loadable';\nimport { Logger } from '../Util/Log';\nimport { EventDispatcher } from '../EventDispatcher';\n\n/**\n * The [[Resource]] type allows games built in Excalibur to load generic resources.\n * For any type of remote resource it is recommended to use [[Resource]] for preloading.\n */\nexport class Resource<T> implements Loadable<T> {\n  public data: T = null;\n  public logger: Logger = Logger.getInstance();\n  public events: EventDispatcher = new EventDispatcher(this);\n\n  /**\n   * @param path          Path to the remote resource\n   * @param responseType  The type to expect as a response: \"\" | \"arraybuffer\" | \"blob\" | \"document\" | \"json\" | \"text\";\n   * @param bustCache     Whether or not to cache-bust requests\n   */\n  constructor(\n    public path: string,\n    public responseType: '' | 'arraybuffer' | 'blob' | 'document' | 'json' | 'text',\n    public bustCache: boolean = true\n  ) {}\n\n  /**\n   * Returns true if the Resource is completely loaded and is ready\n   * to be drawn.\n   */\n  public isLoaded(): boolean {\n    return this.data !== null;\n  }\n\n\n  private _cacheBust(uri: string): string {\n    const query: RegExp = /\\?\\w*=\\w*/;\n    if (query.test(uri)) {\n      uri += '&__=' + Date.now();\n    } else {\n      uri += '?__=' + Date.now();\n    }\n    return uri;\n  }\n  /**\n   * Begin loading the resource and returns a promise to be resolved on completion\n   */\n  public load(): Promise<T> {\n    return new Promise((resolve, reject) => {\n      // Exit early if we already have data\n      if (this.data !== null) {\n        this.logger.debug('Already have data for resource', this.path);\n        this.events.emit('complete', this.data as any);\n        resolve(this.data);\n        return;\n      }\n\n      const request = new XMLHttpRequest();\n      request.open('GET', this.bustCache ? this._cacheBust(this.path) : this.path, true);\n      request.responseType = this.responseType;\n      request.addEventListener('loadstart', (e) => this.events.emit('loadstart', e as any));\n      request.addEventListener('progress', (e) => this.events.emit('progress', e as any));\n      request.addEventListener('error', (e) => this.events.emit('error', e as any));\n      request.addEventListener('load', (e) => this.events.emit('load', e as any));\n      request.addEventListener('load', () => {\n        // XHR on file:// success status is 0, such as with PhantomJS\n        if (request.status !== 0 && request.status !== 200) {\n          this.logger.error('Failed to load resource ', this.path, ' server responded with error code', request.status);\n          this.events.emit('error', request.response);\n          reject(request.response);\n          return;\n        }\n\n        this.data = request.response;\n        this.events.emit('complete', this.data as any);\n        this.logger.debug('Completed loading resource', this.path);\n        resolve(this.data);\n      });\n      request.send();\n    });\n  }\n}\n","/**\n * @module\n * @deprecated\n * These effects can be applied to any bitmap image but are mainly used\n * for [[Sprite]] effects or [[Animation]] effects.\n */\n\n/**\n * @typedoc\n */\n\nimport { obsolete } from '../Util/Decorators';\nimport { Color } from '../Color';\n\n/**\n * The interface that all sprite effects must implement\n * @deprecated SpriteEffect will be removed in v0.26.0\n */\nexport interface SpriteEffect {\n  /**\n   * Should update individual pixels values\n   * @param x          The pixel's x coordinate\n   * @param y          The pixel's y coordinate\n   * @param imageData  The sprite's raw pixel data\n   */\n  updatePixel(x: number, y: number, imageData: ImageData): void;\n}\n\n/**\n * Applies the \"Grayscale\" effect to a sprite, removing color information.\n * @deprecated [[Grayscale]] will be removed in v0.26.0\n */\n@obsolete({\n  message: 'Grayscale will be removed in v0.26.0'\n})\nexport class Grayscale implements SpriteEffect {\n  updatePixel(x: number, y: number, imageData: ImageData): void {\n    const firstPixel = (x + y * imageData.width) * 4;\n    const pixel = imageData.data;\n    const avg = (pixel[firstPixel + 0] + pixel[firstPixel + 1] + pixel[firstPixel + 2]) / 3;\n    pixel[firstPixel + 0] = avg;\n    pixel[firstPixel + 1] = avg;\n    pixel[firstPixel + 2] = avg;\n  }\n}\n\n/**\n * Applies the \"Invert\" effect to a sprite, inverting the pixel colors.\n * @deprecated [[Invert]] will be removed in v0.26.0\n */\n@obsolete({\n  message: 'Invert will be removed in v0.26.0'\n})\nexport class Invert implements SpriteEffect {\n  updatePixel(x: number, y: number, imageData: ImageData): void {\n    const firstPixel = (x + y * imageData.width) * 4;\n    const pixel = imageData.data;\n    pixel[firstPixel + 0] = 255 - pixel[firstPixel + 0];\n    pixel[firstPixel + 1] = 255 - pixel[firstPixel + 1];\n    pixel[firstPixel + 2] = 255 - pixel[firstPixel + 2];\n  }\n}\n\n/**\n * Applies the \"Opacity\" effect to a sprite, setting the alpha of all pixels to a given value.\n * @deprecated [[Opacity]] will be removed in v0.26.0\n */\n@obsolete({\n  message: 'Opacity will be removed in v0.26.0'\n})\nexport class Opacity implements SpriteEffect {\n  /**\n   * @param opacity  The new opacity of the sprite from 0-1.0\n   */\n  constructor(public opacity: number) {}\n  updatePixel(x: number, y: number, imageData: ImageData): void {\n    const firstPixel = (x + y * imageData.width) * 4;\n    const pixel = imageData.data;\n    if (pixel[firstPixel + 3] !== 0) {\n      pixel[firstPixel + 3] = Math.round(this.opacity * pixel[firstPixel + 3]);\n    }\n  }\n}\n\n/**\n * Applies the \"Colorize\" effect to a sprite, changing the color channels of all the pixels to an\n * average of the original color and the provided color\n * @deprecated [[Colorize]] will be removed in v0.26.0\n */\n@obsolete({\n  message: 'Colorize will be removed in v0.26.0'\n})\nexport class Colorize implements SpriteEffect {\n  /**\n   * @param color  The color to apply to the sprite\n   */\n  constructor(public color: Color) {}\n  updatePixel(x: number, y: number, imageData: ImageData): void {\n    const firstPixel = (x + y * imageData.width) * 4;\n    const pixel = imageData.data;\n    if (pixel[firstPixel + 3] !== 0) {\n      pixel[firstPixel + 0] = (pixel[firstPixel + 0] + this.color.r) / 2;\n      pixel[firstPixel + 1] = (pixel[firstPixel + 1] + this.color.g) / 2;\n      pixel[firstPixel + 2] = (pixel[firstPixel + 2] + this.color.b) / 2;\n    }\n  }\n}\n\n/**\n * Applies the \"Lighten\" effect to a sprite, changes the lightness of the color according to HSL\n * @deprecated [[Lighten]] will be removed in v0.26.0\n */\n@obsolete({\n  message: 'Lighten will be removed in v0.26.0'\n})\nexport class Lighten implements SpriteEffect {\n  /**\n   * @param factor  The factor of the effect between 0-1\n   */\n  constructor(public factor: number = 0.1) {}\n  updatePixel(x: number, y: number, imageData: ImageData): void {\n    const firstPixel = (x + y * imageData.width) * 4;\n    const pixel = imageData.data;\n    const color = Color.fromRGB(pixel[firstPixel + 0], pixel[firstPixel + 1], pixel[firstPixel + 2], pixel[firstPixel + 3]).lighten(\n      this.factor\n    );\n    pixel[firstPixel + 0] = color.r;\n    pixel[firstPixel + 1] = color.g;\n    pixel[firstPixel + 2] = color.b;\n    pixel[firstPixel + 3] = color.a;\n  }\n}\n\n/**\n * Applies the \"Darken\" effect to a sprite, changes the darkness of the color according to HSL\n * @deprecated [[Darken]] will be removed in v0.26.0\n */\n@obsolete({\n  message: 'Darken will be removed v0.26.0'\n})\nexport class Darken implements SpriteEffect {\n  /**\n   * @param factor  The factor of the effect between 0-1\n   */\n  constructor(public factor: number = 0.1) {}\n  updatePixel(x: number, y: number, imageData: ImageData): void {\n    const firstPixel = (x + y * imageData.width) * 4;\n    const pixel = imageData.data;\n    const color = Color.fromRGB(pixel[firstPixel + 0], pixel[firstPixel + 1], pixel[firstPixel + 2], pixel[firstPixel + 3]).darken(\n      this.factor\n    );\n    pixel[firstPixel + 0] = color.r;\n    pixel[firstPixel + 1] = color.g;\n    pixel[firstPixel + 2] = color.b;\n    pixel[firstPixel + 3] = color.a;\n  }\n}\n\n/**\n * Applies the \"Saturate\" effect to a sprite, saturates the color according to HSL\n * @deprecated [[Saturate]] will be removed in v0.26.0\n */\n@obsolete({\n  message: 'Saturate will be removed in v0.26.0'\n})\nexport class Saturate implements SpriteEffect {\n  /**\n   * @param factor  The factor of the effect between 0-1\n   */\n  constructor(public factor: number = 0.1) {}\n  updatePixel(x: number, y: number, imageData: ImageData): void {\n    const firstPixel = (x + y * imageData.width) * 4;\n    const pixel = imageData.data;\n    const color = Color.fromRGB(pixel[firstPixel + 0], pixel[firstPixel + 1], pixel[firstPixel + 2], pixel[firstPixel + 3]).saturate(\n      this.factor\n    );\n    pixel[firstPixel + 0] = color.r;\n    pixel[firstPixel + 1] = color.g;\n    pixel[firstPixel + 2] = color.b;\n    pixel[firstPixel + 3] = color.a;\n  }\n}\n\n/**\n * Applies the \"Desaturate\" effect to a sprite, desaturates the color according to HSL\n * @deprecated [[Desaturate]] will be removed in v0.26.0\n */\n@obsolete({\n  message: 'Desaturate will be removed in v0.26.0'\n})\nexport class Desaturate implements SpriteEffect {\n  /**\n   * @param factor  The factor of the effect between 0-1\n   */\n  constructor(public factor: number = 0.1) {}\n  updatePixel(x: number, y: number, imageData: ImageData): void {\n    const firstPixel = (x + y * imageData.width) * 4;\n    const pixel = imageData.data;\n    const color = Color.fromRGB(pixel[firstPixel + 0], pixel[firstPixel + 1], pixel[firstPixel + 2], pixel[firstPixel + 3]).desaturate(\n      this.factor\n    );\n    pixel[firstPixel + 0] = color.r;\n    pixel[firstPixel + 1] = color.g;\n    pixel[firstPixel + 2] = color.b;\n    pixel[firstPixel + 3] = color.a;\n  }\n}\n\n/**\n * Applies the \"Fill\" effect to a sprite, changing the color channels of all non-transparent pixels to match\n * a given color\n * @deprecated [[Fill]] will be removed in v0.26.0\n */\n@obsolete({\n  message: 'Fill will be removed in v0.26.0'\n})\nexport class Fill implements SpriteEffect {\n  /**\n   * @param color  The color to apply to the sprite\n   */\n  constructor(public color: Color) {}\n  updatePixel(x: number, y: number, imageData: ImageData): void {\n    const firstPixel = (x + y * imageData.width) * 4;\n    const pixel = imageData.data;\n    if (pixel[firstPixel + 3] !== 0) {\n      pixel[firstPixel + 0] = this.color.r;\n      pixel[firstPixel + 1] = this.color.g;\n      pixel[firstPixel + 2] = this.color.b;\n    }\n  }\n}\n","export type Constructor<T> = {\n  new (...args: any[]): T;\n};\n/**\n * Configurable helper extends base type and makes all properties available as option bag arguments\n * @internal\n * @param base\n */\nexport function Configurable<T extends Constructor<{}>>(base: T): T {\n  return class extends base {\n    public assign(props: Partial<T>) {\n      //set the value of every property that was passed in,\n      //if the constructor previously set this value, it will be overridden here\n      for (const k in props) {\n        // eslint-disable-next-line\n        if (typeof (<any>this)[k] !== 'function') {\n          // eslint-disable-next-line\n          (<any>this)[k] = (<any>props)[k];\n        }\n      }\n    }\n\n    constructor(...args: any[]) {\n      super(...args);\n      //get the number of arguments that aren't undefined. TS passes a value to all parameters\n      //of whatever ctor is the implementation, so args.length doesn't work here.\n      const size = args.filter(function(value) {\n        return value !== undefined;\n      }).length;\n      if (size === 1 && args[0] && typeof args[0] === 'object' && !(args[0] instanceof Array)) {\n        this.assign(args[0]);\n      }\n    }\n  };\n}\n","import * as Effects from './SpriteEffects';\nimport { Color } from '../Color';\n\nimport { Drawable, DrawOptions } from '../Interfaces/Drawable';\nimport { Texture } from './Texture';\nimport { Vector } from '../Math/vector';\nimport { Logger } from '../Util/Log';\nimport { clamp } from '../Util/Util';\nimport { Configurable } from '../Configurable';\nimport { obsolete } from '../Util/Decorators';\n\n/**\n * @hidden\n * @deprecated Use [[Sprite]]\n */\nexport class SpriteImpl implements Drawable {\n  public texture: Texture;\n\n  public x: number = 0;\n  public y: number = 0;\n\n  public get drawWidth(): number {\n    return Math.abs(this.width * this.scale.x);\n  }\n\n  public get drawHeight(): number {\n    return Math.abs(this.height * this.scale.y);\n  }\n\n  public rotation: number = 0.0;\n  public anchor: Vector = Vector.Half;\n  public offset: Vector = Vector.Zero;\n  public scale: Vector = Vector.One;\n  /**\n   * Default: false, should the sprite be drawn around the anchor or from the top left.\n   * Sprite rotations/scaling still happen around the anchor regardless of this setting.\n   */\n  public drawAroundAnchor = false;\n\n  public logger: Logger = Logger.getInstance();\n\n  /**\n   * Draws the sprite flipped vertically\n   */\n  public flipVertical: boolean = false;\n\n  /**\n   * Draws the sprite flipped horizontally\n   */\n  public flipHorizontal: boolean = false;\n\n  public effects: Effects.SpriteEffect[] = [];\n\n  public width: number = 0;\n  public height: number = 0;\n\n  private _spriteCanvas: HTMLCanvasElement = null;\n  private _spriteCtx: CanvasRenderingContext2D = null;\n  private _pixelData: ImageData = null;\n  private _pixelsLoaded: boolean = false;\n  private _dirtyEffect: boolean = true;\n\n  /**\n   * @param imageOrConfig  The backing image texture to build the Sprite, or Sprite option bag\n   * @param x      The x position of the sprite\n   * @param y      The y position of the sprite\n   * @param width  The width of the sprite in pixels\n   * @param height The height of the sprite in pixels\n   */\n  constructor(imageOrConfig: Texture | SpriteArgs, x: number, y: number, width: number, height: number) {\n    let image = imageOrConfig;\n    if (imageOrConfig && !(imageOrConfig instanceof Texture)) {\n      x = imageOrConfig.x | 0;\n      y = imageOrConfig.y | 0;\n      width = imageOrConfig.width | 0;\n      height = imageOrConfig.height | 0;\n      image = imageOrConfig.image;\n      if (!image) {\n        const message = 'An image texture is required to construct a sprite';\n        throw new Error(message);\n      }\n    }\n\n    this.x = x || 0;\n    this.y = y || 0;\n\n    this.texture = image as Texture;\n    this._spriteCanvas = document.createElement('canvas');\n    this._spriteCanvas.width = width;\n    this._spriteCanvas.height = height;\n    this._spriteCtx = this._spriteCanvas.getContext('2d');\n    this._initPixelsFromTexture();\n\n    this.width = width;\n    this.height = height;\n  }\n\n  private async _initPixelsFromTexture() {\n    try {\n      const image = await this.texture.loaded;\n      this.width = this.width || image.naturalWidth;\n      this.height = this.height || image.naturalHeight;\n      this._spriteCanvas.width = this._spriteCanvas.width || image.naturalWidth;\n      this._spriteCanvas.height = this._spriteCanvas.height || image.naturalHeight;\n      this._loadPixels();\n      this._dirtyEffect = true;\n    } catch (e) {\n      this.logger.error('Error loading texture ', this.texture.path, e);\n    }\n  }\n\n  private _loadPixels() {\n    if (this.texture.isLoaded() && !this._pixelsLoaded) {\n      const naturalWidth = this.texture.image.naturalWidth || 0;\n      const naturalHeight = this.texture.image.naturalHeight || 0;\n\n      if (this.width > naturalWidth) {\n        this.logger.warn(`The sprite width ${this.width} exceeds the width \n                              ${naturalWidth} of the backing texture ${this.texture.path}`);\n      }\n\n      if (this.width <= 0 || naturalWidth <= 0) {\n        throw new Error(`The width of a sprite cannot be 0 or negative, sprite width: ${this.width}, original width: ${naturalWidth}`);\n      }\n\n      if (this.height > naturalHeight) {\n        this.logger.warn(`The sprite height ${this.height} exceeds the height \n                              ${naturalHeight} of the backing texture ${this.texture.path}`);\n      }\n\n      if (this.height <= 0 || naturalHeight <= 0) {\n        throw new Error(`The height of a sprite cannot be 0 or negative, sprite height: ${this.height}, original height: ${naturalHeight}`);\n      }\n\n      this._flushTexture();\n\n      this._pixelsLoaded = true;\n    }\n  }\n\n  private _flushTexture() {\n    const naturalWidth = this.texture.image.naturalWidth || 0;\n    const naturalHeight = this.texture.image.naturalHeight || 0;\n\n    this._spriteCtx.clearRect(0, 0, this.width, this.height);\n    this._spriteCtx.drawImage(\n      this.texture.image,\n      clamp(this.x, 0, naturalWidth),\n      clamp(this.y, 0, naturalHeight),\n      clamp(this.width, 0, naturalWidth),\n      clamp(this.height, 0, naturalHeight),\n      0,\n      0,\n      this.width,\n      this.height\n    );\n  }\n\n  private _opacity: number = 1;\n  /**\n   * Applies the [[Opacity]] effect to a sprite, setting the alpha of all pixels to a given value\n   */\n  public opacity(value: number) {\n    this._opacity = value;\n  }\n\n  /**\n   * Applies the [[Grayscale]] effect to a sprite, removing color information.\n   */\n  public grayscale() {\n    this.addEffect(new Effects.Grayscale());\n  }\n\n  /**\n   * Applies the [[Invert]] effect to a sprite, inverting the pixel colors.\n   */\n  public invert() {\n    this.addEffect(new Effects.Invert());\n  }\n\n  /**\n   * Applies the [[Fill]] effect to a sprite, changing the color channels of all non-transparent pixels to match a given color\n   */\n  public fill(color: Color) {\n    this.addEffect(new Effects.Fill(color));\n  }\n\n  /**\n   * Applies the [[Colorize]] effect to a sprite, changing the color channels of all pixels to be the average of the original color\n   * and the provided color.\n   */\n  public colorize(color: Color) {\n    this.addEffect(new Effects.Colorize(color));\n  }\n\n  /**\n   * Applies the [[Lighten]] effect to a sprite, changes the lightness of the color according to HSL\n   */\n  public lighten(factor: number = 0.1) {\n    this.addEffect(new Effects.Lighten(factor));\n  }\n\n  /**\n   * Applies the [[Darken]] effect to a sprite, changes the darkness of the color according to HSL\n   */\n  public darken(factor: number = 0.1) {\n    this.addEffect(new Effects.Darken(factor));\n  }\n\n  /**\n   * Applies the [[Saturate]] effect to a sprite, saturates the color according to HSL\n   */\n  public saturate(factor: number = 0.1) {\n    this.addEffect(new Effects.Saturate(factor));\n  }\n\n  /**\n   * Applies the [[Desaturate]] effect to a sprite, desaturates the color according to HSL\n   */\n  public desaturate(factor: number = 0.1) {\n    this.addEffect(new Effects.Desaturate(factor));\n  }\n\n  /**\n   * Adds a new [[SpriteEffect]] to this drawing.\n   * @param effect  Effect to add to the this drawing\n   */\n  public addEffect(effect: Effects.SpriteEffect) {\n    this.effects.push(effect);\n    // We must check if the texture and the backing sprite pixels are loaded as well before\n    // an effect can be applied\n    if (!this.texture.isLoaded() || !this._pixelsLoaded) {\n      this._dirtyEffect = true;\n    } else {\n      this._applyEffects();\n    }\n  }\n\n  /**\n   * Removes a [[SpriteEffect]] from this sprite.\n   * @param effect  Effect to remove from this sprite\n   */\n  public removeEffect(effect: Effects.SpriteEffect): void;\n\n  /**\n   * Removes an effect given the index from this sprite.\n   * @param index  Index of the effect to remove from this sprite\n   */\n  public removeEffect(index: number): void;\n  public removeEffect(param: any) {\n    let indexToRemove = -1;\n    if (typeof param === 'number') {\n      indexToRemove = param;\n    } else {\n      indexToRemove = this.effects.indexOf(param);\n    }\n\n    // bounds check\n    if (indexToRemove < 0 || indexToRemove >= this.effects.length) {\n      return;\n    }\n\n    this.effects.splice(indexToRemove, 1);\n\n    // We must check if the texture and the backing sprite pixels are loaded as well before\n    // an effect can be applied\n    if (!this.texture.isLoaded() || !this._pixelsLoaded) {\n      this._dirtyEffect = true;\n    } else {\n      this._applyEffects();\n    }\n  }\n\n  private _applyEffects() {\n    this._flushTexture();\n\n    if (this.effects.length > 0) {\n      this._pixelData = this._spriteCtx.getImageData(0, 0, this.width, this.height);\n\n      const len = this.effects.length;\n      for (let i = 0; i < len; i++) {\n        for (let y = 0; y < this.height; y++) {\n          for (let x = 0; x < this.width; x++) {\n            this.effects[i].updatePixel(x, y, this._pixelData);\n          }\n        }\n      }\n      this._spriteCtx.clearRect(0, 0, this.width, this.height);\n      this._spriteCtx.putImageData(this._pixelData, 0, 0);\n    }\n\n    this._dirtyEffect = false;\n  }\n\n  /**\n   * Clears all effects from the drawing and return it to its original state.\n   */\n  public clearEffects() {\n    this.effects.length = 0;\n    this._applyEffects();\n  }\n\n  /**\n   * Resets the internal state of the drawing (if any)\n   */\n  public reset() {\n    // do nothing\n  }\n\n  public debugDraw(ctx: CanvasRenderingContext2D, x: number, y: number) {\n    ctx.save();\n    ctx.translate(x, y);\n    ctx.rotate(this.rotation);\n    const xpoint = this.drawWidth * this.anchor.x;\n    const ypoint = this.drawHeight * this.anchor.y;\n\n    ctx.strokeStyle = Color.Black.toString();\n    ctx.strokeRect(-xpoint, -ypoint, this.drawWidth, this.drawHeight);\n    ctx.restore();\n  }\n\n  /**\n   * Draws the sprite appropriately to the 2D rendering context, at an x and y coordinate.\n   * @param ctx  The 2D rendering context\n   * @param x    The x coordinate of where to draw\n   * @param y    The y coordinate of where to draw\n   */\n  public draw(ctx: CanvasRenderingContext2D, x: number, y: number): void;\n  /**\n   * Draws the sprite with custom options to override internals without mutating them.\n   * @param options\n   */\n  public draw(options: DrawOptions): void;\n  public draw(ctxOrOptions: CanvasRenderingContext2D | DrawOptions, x?: number, y?: number): void {\n    if (ctxOrOptions instanceof CanvasRenderingContext2D) {\n      this._drawWithOptions({ ctx: ctxOrOptions, x, y });\n    } else {\n      this._drawWithOptions(ctxOrOptions);\n    }\n  }\n\n  private _drawWithOptions(options: DrawOptions) {\n    const { ctx, x, y, rotation, drawWidth, drawHeight, anchor, offset, opacity, flipHorizontal, flipVertical } = {\n      ...options,\n      rotation: options.rotation ?? this.rotation,\n      drawWidth: options.drawWidth ?? this.width,\n      drawHeight: options.drawHeight ?? this.height,\n      flipHorizontal: options.flipHorizontal ?? this.flipHorizontal,\n      flipVertical: options.flipVertical ?? this.flipVertical,\n      anchor: options.anchor ?? this.anchor,\n      offset: options.offset ?? this.offset,\n      opacity: (options.opacity ?? 1) * (this._opacity ?? 1)\n    };\n\n    if (this._dirtyEffect) {\n      this._applyEffects();\n    }\n    // calculating current dimensions\n    const anchorX = drawWidth * anchor.x + offset.x;\n    const anchorY = drawHeight * anchor.y + offset.y;\n    const scaleDirX = this.scale.x > 0 ? 1 : -1;\n    const scaleDirY = this.scale.y > 0 ? 1 : -1;\n\n    ctx.save();\n    // Move the draw point of origin\n    ctx.translate(x, y);\n\n    // Rotate and scale around anchor point\n    // This requires a bit of explaination, scale coordinates first positive flipping or rotating\n    ctx.scale(Math.abs(this.scale.x), Math.abs(this.scale.y));\n\n    if (this.drawAroundAnchor) {\n      // In the case where you want the anchor to match with the point of draw\n      // Otherwise sprites are always drawn from top-left\n      ctx.translate(-anchorX, -anchorY);\n    }\n\n    ctx.translate(anchorX, anchorY);\n    ctx.rotate(rotation);\n    // This is for handling direction changes 1 or -1, that way we don't have mismatched translates()\n    ctx.scale(scaleDirX, scaleDirY);\n    ctx.translate(-anchorX, -anchorY);\n\n    if (flipHorizontal) {\n      ctx.translate(drawWidth, 0);\n      ctx.scale(-1, 1);\n    }\n\n    if (flipVertical) {\n      ctx.translate(0, drawHeight);\n      ctx.scale(1, -1);\n    }\n    const oldAlpha = ctx.globalAlpha;\n    ctx.globalAlpha = opacity;\n    // Context is already rotated and scaled\n    ctx.drawImage(\n      this._spriteCanvas,\n      0,\n      0,\n      this.width,\n      this.height, // source\n      0,\n      0,\n      this.width,\n      this.height\n    ); // dest\n    ctx.globalAlpha = oldAlpha;\n    ctx.restore();\n  }\n\n  /**\n   * Produces a copy of the current sprite\n   */\n  public clone(): SpriteImpl {\n    const result = new Sprite(this.texture, this.x, this.y, this.width, this.height);\n    result.anchor = this.anchor.clone();\n    result.scale = this.scale.clone();\n    result.rotation = this.rotation;\n    result.flipHorizontal = this.flipHorizontal;\n    result.flipVertical = this.flipVertical;\n\n    const len = this.effects.length;\n    for (let i = 0; i < len; i++) {\n      result.addEffect(this.effects[i]);\n    }\n    return result;\n  }\n}\n\n/**\n * @deprecated Use [[Sprite]]\n */\nexport interface SpriteArgs extends Partial<SpriteImpl> {\n  image?: Texture;\n  x?: number;\n  width?: number;\n  height?: number;\n  rotation?: number;\n  anchor?: Vector;\n  scale?: Vector;\n  flipVertical?: boolean;\n  flipHorizontal?: boolean;\n}\n\n/**\n * A [[LegacyDrawing.Sprite]] is one of the main drawing primitives. It is responsible for drawing\n * images or parts of images from a [[LegacyDrawing.Texture]] resource to the screen.\n * @deprecated Use [[Sprite]]\n */\n@obsolete({\n  message: 'Label.clearTextShadow will be removed in v0.26.0',\n  alternateMethod: 'Use Label.font.shadow'\n})\nexport class Sprite extends Configurable(SpriteImpl) {\n  constructor(config: SpriteArgs);\n  constructor(image: Texture, x: number, y: number, width: number, height: number);\n  constructor(imageOrConfig: Texture | SpriteArgs, x?: number, y?: number, width?: number, height?: number) {\n    super(imageOrConfig, x, y, width, height);\n  }\n}\n","import { Resource } from '../Resources/Resource';\nimport { Sprite } from './Sprite';\nimport { Loadable } from '../Interfaces/Index';\n/**\n * The [[Texture]] object allows games built in Excalibur to load image resources.\n * [[Texture]] is an [[Loadable]] which means it can be passed to a [[Loader]]\n * to pre-load before starting a level or game.\n * @deprecated\n */\nexport class Texture implements Loadable<HTMLImageElement> {\n  private _resource: Resource<Blob>;\n  /**\n   * The width of the texture in pixels\n   */\n  public width: number;\n\n  /**\n   * The height of the texture in pixels\n   */\n  public height: number;\n\n  private _sprite: Sprite = null;\n\n  /**\n   * Populated once loading is complete\n   */\n  public data: HTMLImageElement;\n  public get image() {\n    return this.data;\n  }\n\n  private _loadedResolve: (image: HTMLImageElement) => any;\n  public loaded = new Promise<HTMLImageElement>(resolve => {\n    this._loadedResolve = resolve;\n  });\n\n  /**\n   * @param path       Path to the image resource or a base64 string representing an image \"data:image/png;base64,iVB...\"\n   * @param bustCache  Optionally load texture with cache busting\n   */\n  constructor(public path: string, public bustCache = true) {\n    this._resource = new Resource(path, 'blob', bustCache);\n    this._sprite = new Sprite(this, 0, 0, 0, 0);\n  }\n\n  /**\n   * Returns true if the Texture is completely loaded and is ready\n   * to be drawn.\n   */\n  public isLoaded(): boolean {\n    return !!this.data;\n  }\n\n  /**\n   * Begins loading the texture and returns a promise to be resolved on completion\n   */\n  public async load(): Promise<HTMLImageElement> {\n    try {\n      // Load base64 or blob if needed\n      let url: string;\n      if (!this.path.includes('data:image/')) {\n        const blob = await this._resource.load();\n        url = URL.createObjectURL(blob);\n      } else {\n        url = this.path;\n      }\n\n      // Decode the image\n      const image = new Image();\n      image.src = url;\n      await image.decode();\n\n      // Set results\n      this.data = image;\n      this.width = this._sprite.width = image.naturalWidth;\n      this.height = this._sprite.height = image.naturalHeight;\n      this._sprite = new Sprite(this, 0, 0, this.width, this.height);\n    } catch {\n      await Promise.reject('Error loading texture');\n    }\n    // todo emit complete\n    this._loadedResolve(this.data);\n    return this.data;\n  }\n\n  public asSprite(): Sprite {\n    return this._sprite;\n  }\n}\n","import { Sprite } from './Sprite';\nimport * as Effects from './SpriteEffects';\nimport { Color } from '../Color';\n\nimport { Drawable, DrawOptions } from '../Interfaces/Drawable';\nimport { Vector } from '../Math/vector';\nimport { Engine } from '../Engine';\nimport * as Util from '../Util/Util';\nimport { Configurable } from '../Configurable';\nimport { obsolete } from '../Util/Decorators';\n\n/**\n * @deprecated Use [[HasTick]]\n */\nexport interface HasTick {\n  /**\n   *\n   * @param elapsedMilliseconds The amount of real world time in milliseconds that has elapsed that must be updated in the animation\n   */\n  tick(elapsedMilliseconds: number, idempotencyToken?: number): void;\n}\n\n/**\n * @hidden\n * @deprecated Use [[Animation]]\n */\nexport class AnimationImpl implements Drawable, HasTick {\n  /**\n   * The sprite frames to play, in order. See [[SpriteSheet.getAnimationForAll]] to quickly\n   * generate an [[Animation]].\n   */\n  public sprites: Sprite[] = [];\n\n  /**\n   * Duration to show each frame (in milliseconds)\n   */\n  public speed: number;\n\n  /**\n   * Current frame index being shown\n   */\n  public currentFrame: number = 0;\n\n  private _timeLeftInFrame: number = 0;\n  private _idempotencyToken: number = -1;\n\n  public anchor: Vector = Vector.Zero;\n  public rotation: number = 0.0;\n  public scale: Vector = Vector.One;\n\n  /**\n   * Indicates whether the animation should loop after it is completed\n   */\n  public loop: boolean = true;\n\n  /**\n   * Indicates the frame index the animation should freeze on for a non-looping\n   * animation. By default it is the last frame.\n   */\n  public freezeFrame: number = -1;\n\n  private _engine: Engine;\n\n  /**\n   * Flip each frame vertically. Sets [[Sprite.flipVertical]].\n   */\n  public flipVertical: boolean = false;\n\n  /**\n   * Flip each frame horizontally. Sets [[Sprite.flipHorizontal]].\n   */\n  public flipHorizontal: boolean = false;\n\n  public drawWidth: number = 0;\n  public drawHeight: number = 0;\n  public width: number = 0;\n  public height: number = 0;\n\n  private _opacity = 1;\n\n  /**\n   * Typically you will use a [[SpriteSheet]] to generate an [[Animation]].\n   *\n   * @param engineOrConfig  Reference to the current game engine\n   * @param sprites  An array of sprites to create the frames for the animation\n   * @param speed   The number in milliseconds to display each frame in the animation\n   * @param loop    Indicates whether the animation should loop after it is completed\n   */\n  constructor(engineOrConfig: Engine | AnimationArgs, sprites: Sprite[], speed: number, loop?: boolean) {\n    let engine = engineOrConfig;\n    if (engineOrConfig && !(engineOrConfig instanceof Engine)) {\n      const config = engineOrConfig;\n      engine = config.engine;\n      sprites = config.sprites;\n      speed = config.speed;\n      loop = config.loop;\n    }\n\n    this.sprites = sprites;\n    this.speed = speed;\n    this._engine = <Engine>engine;\n    this._timeLeftInFrame = this.speed;\n\n    if (loop != null) {\n      this.loop = loop;\n    }\n\n    if (sprites && sprites[0]) {\n      this.drawHeight = sprites[0] ? sprites[0].drawHeight : 0;\n      this.drawWidth = sprites[0] ? sprites[0].drawWidth : 0;\n\n      this.width = sprites[0] ? sprites[0].width : 0;\n      this.height = sprites[0] ? sprites[0].height : 0;\n\n      this.freezeFrame = sprites.length - 1;\n    }\n  }\n\n  /**\n   * Applies the opacity effect to a sprite, setting the alpha of all pixels to a given value\n   */\n  public opacity(value: number) {\n    this._opacity = value;\n  }\n\n  /**\n   * Applies the grayscale effect to a sprite, removing color information.\n   */\n  public grayscale() {\n    this.addEffect(new Effects.Grayscale());\n  }\n\n  /**\n   * Applies the invert effect to a sprite, inverting the pixel colors.\n   */\n  public invert() {\n    this.addEffect(new Effects.Invert());\n  }\n\n  /**\n   * Applies the fill effect to a sprite, changing the color channels of all non-transparent pixels to match a given color\n   */\n  public fill(color: Color) {\n    this.addEffect(new Effects.Fill(color));\n  }\n\n  /**\n   * Applies the colorize effect to a sprite, changing the color channels of all pixels to be the average of the original color and the\n   * provided color.\n   */\n  public colorize(color: Color) {\n    this.addEffect(new Effects.Colorize(color));\n  }\n\n  /**\n   * Applies the lighten effect to a sprite, changes the lightness of the color according to hsl\n   */\n  public lighten(factor: number = 0.1) {\n    this.addEffect(new Effects.Lighten(factor));\n  }\n\n  /**\n   * Applies the darken effect to a sprite, changes the darkness of the color according to hsl\n   */\n  public darken(factor: number = 0.1) {\n    this.addEffect(new Effects.Darken(factor));\n  }\n\n  /**\n   * Applies the saturate effect to a sprite, saturates the color according to hsl\n   */\n  public saturate(factor: number = 0.1) {\n    this.addEffect(new Effects.Saturate(factor));\n  }\n\n  /**\n   * Applies the desaturate effect to a sprite, desaturates the color according to hsl\n   */\n  public desaturate(factor: number = 0.1) {\n    this.addEffect(new Effects.Desaturate(factor));\n  }\n\n  /**\n   * Add a [[SpriteEffect]] manually\n   */\n  public addEffect(effect: Effects.SpriteEffect) {\n    for (const i in this.sprites) {\n      this.sprites[i].addEffect(effect);\n    }\n  }\n\n  /**\n   * Removes an [[SpriteEffect]] from this animation.\n   * @param effect Effect to remove from this animation\n   */\n  public removeEffect(effect: Effects.SpriteEffect): void;\n\n  /**\n   * Removes an effect given the index from this animation.\n   * @param index  Index of the effect to remove from this animation\n   */\n  public removeEffect(index: number): void;\n  public removeEffect(param: any) {\n    for (const i in this.sprites) {\n      this.sprites[i].removeEffect(param);\n    }\n  }\n\n  /**\n   * Clear all sprite effects\n   */\n  public clearEffects() {\n    for (const i in this.sprites) {\n      this.sprites[i].clearEffects();\n    }\n  }\n\n  private _setAnchor(point: Vector) {\n    //if (!this.anchor.equals(point)) {\n    for (const i in this.sprites) {\n      this.sprites[i].anchor.setTo(point.x, point.y);\n    }\n    //}\n  }\n\n  private _setRotation(radians: number) {\n    //if (this.rotation !== radians) {\n    for (const i in this.sprites) {\n      this.sprites[i].rotation = radians;\n    }\n    //}\n  }\n\n  private _setScale(scale: Vector) {\n    //if (!this.scale.equals(scale)) {\n    for (const i in this.sprites) {\n      this.sprites[i].scale = scale;\n    }\n    //}\n  }\n\n  /**\n   * Resets the animation to first frame.\n   */\n  public reset() {\n    this.currentFrame = 0;\n  }\n\n  /**\n   * Indicates whether the animation is complete, animations that loop are never complete.\n   */\n  public isDone() {\n    return !this.loop && this.currentFrame >= this.sprites.length;\n  }\n\n  /**\n   * Not meant to be called by game developers. Ticks the animation forward internally and\n   * calculates whether to change to the frame.\n   * @internal\n   */\n  public tick(elapsed: number, idempotencyToken?: number) {\n    if (this._idempotencyToken === idempotencyToken) {\n      return;\n    }\n    this._idempotencyToken = idempotencyToken;\n    this._timeLeftInFrame -= elapsed;\n    if (this._timeLeftInFrame <= 0) {\n      this.currentFrame = this.loop ? (this.currentFrame + 1) % this.sprites.length : this.currentFrame + 1;\n      this._timeLeftInFrame = this.speed;\n    }\n\n    this._updateValues();\n    const current = this.sprites[this.currentFrame];\n    if (current) {\n      this.width = current.width;\n      this.height = current.height;\n      this.drawWidth = current.drawWidth;\n      this.drawHeight = current.drawHeight;\n    }\n  }\n\n  private _updateValues(): void {\n    this._setAnchor(this.anchor);\n    this._setRotation(this.rotation);\n    this._setScale(this.scale);\n  }\n\n  /**\n   * Skips ahead a specified number of frames in the animation\n   * @param frames  Frames to skip ahead\n   */\n  public skip(frames: number) {\n    this.currentFrame = (this.currentFrame + frames) % this.sprites.length;\n  }\n\n  /**\n   * Draws the animation appropriately to the 2D rendering context, at an x and y coordinate.\n   * @param ctx  The 2D rendering context\n   * @param x    The x coordinate of where to draw\n   * @param y    The y coordinate of where to draw\n   */\n  public draw(ctx: CanvasRenderingContext2D, x: number, y: number): void;\n  /**\n   * Draws the animation with custom options to override internals without mutating them.\n   * @param options\n   */\n  public draw(options: DrawOptions): void;\n  public draw(ctxOrOptions: CanvasRenderingContext2D | DrawOptions, x?: number, y?: number) {\n    if (ctxOrOptions instanceof CanvasRenderingContext2D) {\n      this._drawWithOptions({ ctx: ctxOrOptions, x, y });\n    } else {\n      this._drawWithOptions(ctxOrOptions);\n    }\n  }\n\n  private _drawWithOptions(options: DrawOptions) {\n    const animOptions = {\n      ...options,\n      rotation: options.rotation ?? this.rotation,\n      drawWidth: options.drawWidth ?? this.drawWidth,\n      drawHeight: options.drawHeight ?? this.drawHeight,\n      flipHorizontal: options.flipHorizontal ?? this.flipHorizontal,\n      flipVertical: options.flipVertical ?? this.flipVertical,\n      anchor: options.anchor ?? this.anchor,\n      opacity: (options.opacity ?? 1) * (this._opacity ?? 1)\n    };\n\n    this._updateValues();\n    let currSprite: Sprite;\n    if (this.currentFrame < this.sprites.length) {\n      currSprite = this.sprites[this.currentFrame];\n      currSprite.draw(animOptions);\n    }\n\n    if (this.freezeFrame !== -1 && this.currentFrame >= this.sprites.length) {\n      currSprite = this.sprites[Util.clamp(this.freezeFrame, 0, this.sprites.length - 1)];\n      currSprite.draw(animOptions);\n    }\n\n    // add the calculated width\n    if (currSprite) {\n      this.drawWidth = currSprite.drawWidth;\n      this.drawHeight = currSprite.drawHeight;\n    }\n  }\n\n  /**\n   * Plays an animation at an arbitrary location in the game.\n   * @param x  The x position in the game to play\n   * @param y  The y position in the game to play\n   */\n  public play(x: number, y: number) {\n    this.reset();\n    this._engine.playAnimation(this, x, y);\n  }\n}\n\n/**\n * @deprecated Use [[Animation]]\n */\nexport interface AnimationArgs extends Partial<AnimationImpl> {\n  engine: Engine;\n  sprites: Sprite[];\n  speed: number;\n  loop?: boolean;\n  anchor?: Vector;\n  rotation?: number;\n  scale?: Vector;\n  flipVertical?: boolean;\n  flipHorizontal?: boolean;\n  width?: number;\n  height?: number;\n}\n\n/**\n * Animations allow you to display a series of images one after another,\n * creating the illusion of change. Generally these images will come from a [[SpriteSheet]] source.\n * @deprecated Use [[Animation]]\n */\n@obsolete({\n  message: 'Animation will be removed in v0.26.0',\n  alternateMethod: 'Use Graphics.Animation'\n})\nexport class Animation extends Configurable(AnimationImpl) {\n  constructor(config: AnimationArgs);\n  constructor(engine: Engine, images: Sprite[], speed: number, loop?: boolean);\n  constructor(engineOrConfig: Engine | AnimationArgs, images?: Sprite[], speed?: number, loop?: boolean) {\n    super(engineOrConfig, images, speed, loop);\n  }\n}\n","import { vec } from '..';\nimport { Vector } from './vector';\nimport { canonicalizeAngle } from '../Util/Util';\n\nexport enum MatrixLocations {\n  X = 12,\n  Y = 13\n}\n\nconst sign = (val: number) => {\n  if (val === 0) {\n    return 0;\n  }\n  return val < 0 ? -1 : 1;\n};\n\n// const multMatch = (a: number, b: number) => {\n//   if (sign(a) < 0 && sign(b) < 0) {\n//     return -Math.abs(a * b);\n//   }\n//   return a * b;\n// }\n\n// const epsilon = (val: number) => {\n//   if (val * val < .0001) {\n//     return 0;\n//   }\n//   return val;\n// }\n\n/**\n * Excalibur Matrix helper for 4x4 matrices\n *\n * Useful for webgl 4x4 matrices\n */\nexport class Matrix {\n  /**\n   *  4x4 matrix in column major order\n   *\n   * |         |         |          |          |\n   * | ------- | ------- | -------- |          |\n   * | data[0] | data[4] | data[8]  | data[12] |\n   * | data[1] | data[5] | data[9]  | data[13] |\n   * | data[2] | data[6] | data[10] | data[14] |\n   * | data[3] | data[7] | data[11] | data[15] |\n   *\n   */\n  public data: Float32Array = new Float32Array(16);\n\n  /**\n   * Creates an orthographic (flat non-perspective) projection\n   * https://en.wikipedia.org/wiki/Orthographic_projection\n   * @param left\n   * @param right\n   * @param bottom\n   * @param top\n   * @param near\n   * @param far\n   */\n  public static ortho(left: number, right: number, bottom: number, top: number, near: number, far: number): Matrix {\n    const mat = new Matrix();\n    mat.data[0] = 2 / (right - left);\n    mat.data[1] = 0;\n    mat.data[2] = 0;\n    mat.data[3] = 0;\n\n    mat.data[4] = 0;\n    mat.data[5] = 2 / (top - bottom);\n    mat.data[6] = 0;\n    mat.data[7] = 0;\n\n    mat.data[8] = 0;\n    mat.data[9] = 0;\n    mat.data[10] = -2 / (far - near);\n    mat.data[11] = 0;\n\n    mat.data[12] = -(right + left) / (right - left);\n    mat.data[13] = -(top + bottom) / (top - bottom);\n    mat.data[14] = -(far + near) / (far - near);\n    mat.data[15] = 1;\n    return mat;\n  }\n\n  /**\n   * Creates a new Matrix with the same data as the current 4x4\n   */\n  public clone(): Matrix {\n    const mat = new Matrix();\n    mat.data[0] = this.data[0];\n    mat.data[1] = this.data[1];\n    mat.data[2] = this.data[2];\n    mat.data[3] = this.data[3];\n\n    mat.data[4] = this.data[4];\n    mat.data[5] = this.data[5];\n    mat.data[6] = this.data[6];\n    mat.data[7] = this.data[7];\n\n    mat.data[8] = this.data[8];\n    mat.data[9] = this.data[9];\n    mat.data[10] = this.data[10];\n    mat.data[11] = this.data[11];\n\n    mat.data[12] = this.data[12];\n    mat.data[13] = this.data[13];\n    mat.data[14] = this.data[14];\n    mat.data[15] = this.data[15];\n    return mat;\n  }\n\n  /**\n   * Creates a new identity matrix (a matrix that when applied does nothing)\n   */\n  public static identity(): Matrix {\n    const mat = new Matrix();\n    mat.data[0] = 1;\n    mat.data[1] = 0;\n    mat.data[2] = 0;\n    mat.data[3] = 0;\n\n    mat.data[4] = 0;\n    mat.data[5] = 1;\n    mat.data[6] = 0;\n    mat.data[7] = 0;\n\n    mat.data[8] = 0;\n    mat.data[9] = 0;\n    mat.data[10] = 1;\n    mat.data[11] = 0;\n\n    mat.data[12] = 0;\n    mat.data[13] = 0;\n    mat.data[14] = 0;\n    mat.data[15] = 1;\n    return mat;\n  }\n\n  /**\n   * Creates a brand new translation matrix at the specified 3d point\n   * @param x\n   * @param y\n   */\n  public static translation(x: number, y: number): Matrix {\n    const mat = Matrix.identity();\n    mat.data[12] = x;\n    mat.data[13] = y;\n    return mat;\n  }\n\n  /**\n   * Creates a brand new scaling matrix with the specified scaling factor\n   * @param sx\n   * @param sy\n   */\n  public static scale(sx: number, sy: number): Matrix {\n    const mat = Matrix.identity();\n    mat.data[0] = sx;\n    mat.data[5] = sy;\n    mat.data[10] = 1;\n    mat.data[15] = 1;\n    return mat;\n  }\n\n  /**\n   * Creates a brand new rotation matrix with the specified angle\n   * @param angleRadians\n   */\n  public static rotation(angleRadians: number): Matrix {\n    const mat = Matrix.identity();\n    mat.data[0] = Math.cos(angleRadians);\n    mat.data[4] = -Math.sin(angleRadians);\n    mat.data[1] = Math.sin(angleRadians);\n    mat.data[5] = Math.cos(angleRadians);\n    return mat;\n  }\n\n  /**\n   * Multiplies the current matrix by a vector and returns the resulting vector\n   * @param other\n   */\n  multv(other: [number, number]): [number, number];\n  multv(other: Vector): Vector;\n  multv(other: [number, number] | Vector): [number, number] | Vector {\n    const z = 0;\n    if (other instanceof Vector) {\n      return new Vector(\n        other.x * this.data[0] + other.y * this.data[4] + z * this.data[6] + 1 * this.data[12],\n        other.x * this.data[1] + other.y * this.data[5] + z * this.data[9] + 1 * this.data[13]\n      );\n    } else {\n      const dest: [number, number] = [\n        other[0] * this.data[0] + other[1] * this.data[4] + z * this.data[6] + 1 * this.data[12],\n\n        other[0] * this.data[1] + other[1] * this.data[5] + z * this.data[9] + 1 * this.data[13]\n      ];\n      return dest;\n    }\n  }\n\n  /**\n   * Multiplies the current matrix by another and returns the resulting matrix\n   * @param other\n   */\n  multm(other: Matrix): Matrix {\n    const dest = new Matrix();\n    const a11 = this.data[0];\n    const a21 = this.data[1];\n    const a31 = this.data[2];\n    const a41 = this.data[3];\n\n    const a12 = this.data[4];\n    const a22 = this.data[5];\n    const a32 = this.data[6];\n    const a42 = this.data[7];\n\n    const a13 = this.data[8];\n    const a23 = this.data[9];\n    const a33 = this.data[10];\n    const a43 = this.data[11];\n\n    const a14 = this.data[12];\n    const a24 = this.data[13];\n    const a34 = this.data[14];\n    const a44 = this.data[15];\n\n    const b11 = other.data[0];\n    const b21 = other.data[1];\n    const b31 = other.data[2];\n    const b41 = other.data[3];\n\n    const b12 = other.data[4];\n    const b22 = other.data[5];\n    const b32 = other.data[6];\n    const b42 = other.data[7];\n\n    const b13 = other.data[8];\n    const b23 = other.data[9];\n    const b33 = other.data[10];\n    const b43 = other.data[11];\n\n    const b14 = other.data[12];\n    const b24 = other.data[13];\n    const b34 = other.data[14];\n    const b44 = other.data[15];\n\n    dest.data[0] = a11 * b11 + a12 * b21 + a13 * b31 + a14 * b41;\n    dest.data[1] = a21 * b11 + a22 * b21 + a23 * b31 + a24 * b41;\n    dest.data[2] = a31 * b11 + a32 * b21 + a33 * b31 + a34 * b41;\n    dest.data[3] = a41 * b11 + a42 * b21 + a43 * b31 + a44 * b41;\n\n    dest.data[4] = a11 * b12 + a12 * b22 + a13 * b32 + a14 * b42;\n    dest.data[5] = a21 * b12 + a22 * b22 + a23 * b32 + a24 * b42;\n    dest.data[6] = a31 * b12 + a32 * b22 + a33 * b32 + a34 * b42;\n    dest.data[7] = a41 * b12 + a42 * b22 + a43 * b32 + a44 * b42;\n\n    dest.data[8] = a11 * b13 + a12 * b23 + a13 * b33 + a14 * b43;\n    dest.data[9] = a21 * b13 + a22 * b23 + a23 * b33 + a24 * b43;\n    dest.data[10] = a31 * b13 + a32 * b23 + a33 * b33 + a34 * b43;\n    dest.data[11] = a41 * b13 + a42 * b23 + a43 * b33 + a44 * b43;\n\n    dest.data[12] = a11 * b14 + a12 * b24 + a13 * b34 + a14 * b44;\n    dest.data[13] = a21 * b14 + a22 * b24 + a23 * b34 + a24 * b44;\n    dest.data[14] = a31 * b14 + a32 * b24 + a33 * b34 + a34 * b44;\n    dest.data[15] = a41 * b14 + a42 * b24 + a43 * b34 + a44 * b44;\n\n    const s = this.getScale();\n    dest._scaleSignX = sign(s.x) * sign(dest._scaleSignX);\n    dest._scaleSignY = sign(s.y) * sign(dest._scaleSignY);\n\n    return dest;\n  }\n\n  /**\n   * Applies translation to the current matrix mutating it\n   * @param x\n   * @param y\n   */\n  translate(x: number, y: number) {\n    const a11 = this.data[0];\n    const a21 = this.data[1];\n    const a31 = this.data[2];\n    const a41 = this.data[3];\n\n    const a12 = this.data[4];\n    const a22 = this.data[5];\n    const a32 = this.data[6];\n    const a42 = this.data[7];\n\n    const a13 = this.data[8];\n    const a23 = this.data[9];\n    const a33 = this.data[10];\n    const a43 = this.data[11];\n\n    const a14 = this.data[12];\n    const a24 = this.data[13];\n    const a34 = this.data[14];\n    const a44 = this.data[15];\n\n    // Doesn't change z\n    const z = 0;\n    const w = 1;\n    this.data[12] = a11 * x + a12 * y + a13 * z + a14 * w;\n    this.data[13] = a21 * x + a22 * y + a23 * z + a24 * w;\n    this.data[14] = a31 * x + a32 * y + a33 * z + a34 * w;\n    this.data[15] = a41 * x + a42 * y + a43 * z + a44 * w;\n\n    return this;\n  }\n\n  public setPosition(x: number, y: number) {\n    this.data[12] = x;\n    this.data[13] = y;\n  }\n\n  public getPosition(): Vector {\n    return vec(this.data[12], this.data[13]);\n  }\n\n  /**\n   * Applies rotation to the current matrix mutating it\n   * @param angle in Radians\n   */\n  rotate(angle: number) {\n    const a11 = this.data[0];\n    const a21 = this.data[1];\n    const a31 = this.data[2];\n    const a41 = this.data[3];\n\n    const a12 = this.data[4];\n    const a22 = this.data[5];\n    const a32 = this.data[6];\n    const a42 = this.data[7];\n\n    const sine = Math.sin(angle);\n    const cosine = Math.cos(angle);\n\n    this.data[0] = cosine * a11 + sine * a12;\n    this.data[1] = cosine * a21 + sine * a22;\n    this.data[2] = cosine * a31 + sine * a32;\n    this.data[3] = cosine * a41 + sine * a42;\n\n    this.data[4] = cosine * a12 - sine * a11;\n    this.data[5] = cosine * a22 - sine * a21;\n    this.data[6] = cosine * a32 - sine * a31;\n    this.data[7] = cosine * a42 - sine * a41;\n\n    return this;\n  }\n\n  /**\n   * Applies scaling to the current matrix mutating it\n   * @param x\n   * @param y\n   */\n  scale(x: number, y: number) {\n    const a11 = this.data[0];\n    const a21 = this.data[1];\n    const a31 = this.data[2];\n    const a41 = this.data[3];\n\n    const a12 = this.data[4];\n    const a22 = this.data[5];\n    const a32 = this.data[6];\n    const a42 = this.data[7];\n\n    this.data[0] = a11 * x;\n    this.data[1] = a21 * x;\n    this.data[2] = a31 * x;\n    this.data[3] = a41 * x;\n\n    this.data[4] = a12 * y;\n    this.data[5] = a22 * y;\n    this.data[6] = a32 * y;\n    this.data[7] = a42 * y;\n\n    return this;\n  }\n\n  public setRotation(angle: number) {\n    const currentScale = this.getScale();\n    const sine = Math.sin(angle);\n    const cosine = Math.cos(angle);\n\n    this.data[0] = cosine * currentScale.x;\n    this.data[1] = sine * currentScale.y;\n    this.data[4] = -sine * currentScale.x;\n    this.data[5] = cosine * currentScale.y;\n  }\n\n  public getRotation(): number {\n    const angle = Math.atan2(this.data[1] / this.getScaleY(), this.data[0] / this.getScaleX());\n    return canonicalizeAngle(angle);\n  }\n\n  public getScaleX(): number {\n    // absolute scale of the matrix (we lose sign so need to add it back)\n    const xscale = vec(this.data[0], this.data[4]).size;\n    return this._scaleSignX * xscale;\n  }\n\n  public getScaleY(): number {\n    // absolute scale of the matrix (we lose sign so need to add it back)\n    const yscale = vec(this.data[1], this.data[5]).size;\n    return this._scaleSignY * yscale;\n  }\n\n  /**\n   * Get the scale of the matrix\n   */\n  public getScale(): Vector {\n    return vec(this.getScaleX(), this.getScaleY());\n  }\n\n  private _scaleSignX = 1;\n  public setScaleX(val: number) {\n    this._scaleSignX = sign(val);\n    // negative scale acts like a 180 rotation, so flip\n    const xscale = vec(this.data[0] * this._scaleSignX, this.data[4] * this._scaleSignX).normalize();\n    this.data[0] = xscale.x * val;\n    this.data[4] = xscale.y * val;\n  }\n\n  private _scaleSignY = 1;\n  public setScaleY(val: number) {\n    this._scaleSignY = sign(val);\n    // negative scale acts like a 180 rotation, so flip\n    const yscale = vec(this.data[1] * this._scaleSignY, this.data[5] * this._scaleSignY).normalize();\n    this.data[1] = yscale.x * val;\n    this.data[5] = yscale.y * val;\n  }\n\n  public setScale(scale: Vector) {\n    this.setScaleX(scale.x);\n    this.setScaleY(scale.y);\n  }\n\n  /**\n   * Determinant of the upper left 2x2 matrix\n   */\n  public getBasisDeterminant() {\n    return this.data[0] * this.data[5] - this.data[1] * this.data[4];\n  }\n\n  public getAffineInverse(): Matrix {\n    // See http://negativeprobability.blogspot.com/2011/11/affine-transformations-and-their.html\n    // See https://www.mathsisfun.com/algebra/matrix-inverse.html\n    // Since we are actually only doing 2D transformations we can use this hack\n    // We don't actually use the 3rd or 4th dimension\n\n    const det = this.getBasisDeterminant();\n    const inverseDet = 1 / det; // todo zero check\n    const a = this.data[0];\n    const b = this.data[4];\n    const c = this.data[1];\n    const d = this.data[5];\n\n    const m = Matrix.identity();\n    // inverts rotation and scale\n    m.data[0] = d * inverseDet;\n    m.data[1] = -c * inverseDet;\n    m.data[4] = -b * inverseDet;\n    m.data[5] = a * inverseDet;\n\n    const tx = this.data[12];\n    const ty = this.data[13];\n    // invert translation\n    // transform translation into the matrix basis created by rot/scale\n    m.data[12] = -(tx * m.data[0] + ty * m.data[4]);\n    m.data[13] = -(tx * m.data[1] + ty * m.data[5]);\n\n    return m;\n  }\n\n  public isIdentity(): boolean {\n    return (\n      this.data[0] === 1 &&\n      this.data[1] === 0 &&\n      this.data[2] === 0 &&\n      this.data[3] === 0 &&\n      this.data[4] === 0 &&\n      this.data[5] === 1 &&\n      this.data[6] === 0 &&\n      this.data[7] === 0 &&\n      this.data[8] === 0 &&\n      this.data[9] === 0 &&\n      this.data[10] === 1 &&\n      this.data[11] === 0 &&\n      this.data[12] === 0 &&\n      this.data[13] === 0 &&\n      this.data[14] === 0 &&\n      this.data[15] === 1\n    );\n  }\n\n  public toString() {\n    return `\n[${this.data[0]} ${this.data[4]} ${this.data[8]} ${this.data[12]}]\n[${this.data[1]} ${this.data[5]} ${this.data[9]} ${this.data[13]}]\n[${this.data[2]} ${this.data[6]} ${this.data[10]} ${this.data[14]}]\n[${this.data[3]} ${this.data[7]} ${this.data[11]} ${this.data[15]}]\n`;\n  }\n}\n","/**\n * An enum that describes the strategies that rotation actions can use\n */\nexport enum RotationType {\n  /**\n   * Rotation via `ShortestPath` will use the smallest angle\n   * between the starting and ending points. This strategy is the default behavior.\n   */\n  ShortestPath = 0,\n  /**\n   * Rotation via `LongestPath` will use the largest angle\n   * between the starting and ending points.\n   */\n  LongestPath = 1,\n  /**\n   * Rotation via `Clockwise` will travel in a clockwise direction,\n   * regardless of the starting and ending points.\n   */\n  Clockwise = 2,\n  /**\n   * Rotation via `CounterClockwise` will travel in a counterclockwise direction,\n   * regardless of the starting and ending points.\n   */\n  CounterClockwise = 3\n}\n","import { Vector } from '../Math/vector';\nimport { obsolete } from '../Util/Decorators';\n\n/**\n * A definition of an EasingFunction. See [[EasingFunctions]].\n */\n// tslint:disable-next-line\nexport interface EasingFunction {\n  (currentTime: number, startValue: number, endValue: number, duration: number): number;\n}\n\n/**\n * Standard easing functions for motion in Excalibur, defined on a domain of [0, duration] and a range from [+startValue,+endValue]\n * Given a time, the function will return a value from positive startValue to positive endValue.\n *\n * ```js\n * function Linear (t) {\n *    return t * t;\n * }\n *\n * // accelerating from zero velocity\n * function EaseInQuad (t) {\n *    return t * t;\n * }\n *\n * // decelerating to zero velocity\n * function EaseOutQuad (t) {\n *    return t * (2 - t);\n * }\n *\n * // acceleration until halfway, then deceleration\n * function EaseInOutQuad (t) {\n *    return t < .5 ? 2 * t * t : -1 + (4 - 2 * t) * t;\n * }\n *\n * // accelerating from zero velocity\n * function EaseInCubic (t) {\n *    return t * t * t;\n * }\n *\n * // decelerating to zero velocity\n * function EaseOutCubic (t) {\n *    return (--t) * t * t + 1;\n * }\n *\n * // acceleration until halfway, then deceleration\n * function EaseInOutCubic (t) {\n *    return t < .5 ? 4 * t * t * t : (t - 1) * (2 * t - 2) * (2 * t - 2) + 1;\n * }\n * ```\n */\nexport class EasingFunctions {\n  public static CreateReversibleEasingFunction(easing: EasingFunction) {\n    return (time: number, start: number, end: number, duration: number) => {\n      if (end < start) {\n        return start - (easing(time, end, start, duration) - end);\n      } else {\n        return easing(time, start, end, duration);\n      }\n    };\n  }\n\n  @obsolete({\n    message: 'Alias for incorrect spelling used in older versions, will be removed in v0.25.0',\n    alternateMethod: 'CreateReversibleEasingFunction'\n  })\n  public static CreateReversableEasingFunction(easing: EasingFunction) {\n    return EasingFunctions.CreateReversibleEasingFunction(easing);\n  }\n\n  public static CreateVectorEasingFunction(easing: EasingFunction) {\n    return (time: number, start: Vector, end: Vector, duration: number) => {\n      return new Vector(easing(time, start.x, end.x, duration), easing(time, start.y, end.y, duration));\n    };\n  }\n\n  public static Linear: EasingFunction = EasingFunctions.CreateReversibleEasingFunction(\n    (currentTime: number, startValue: number, endValue: number, duration: number) => {\n      endValue = endValue - startValue;\n      return (endValue * currentTime) / duration + startValue;\n    }\n  );\n\n  public static EaseInQuad = EasingFunctions.CreateReversibleEasingFunction(\n    (currentTime: number, startValue: number, endValue: number, duration: number) => {\n      endValue = endValue - startValue;\n      currentTime /= duration;\n\n      return endValue * currentTime * currentTime + startValue;\n    }\n  );\n\n  public static EaseOutQuad: EasingFunction = EasingFunctions.CreateReversibleEasingFunction(\n    (currentTime: number, startValue: number, endValue: number, duration: number) => {\n      endValue = endValue - startValue;\n      currentTime /= duration;\n      return -endValue * currentTime * (currentTime - 2) + startValue;\n    }\n  );\n\n  public static EaseInOutQuad: EasingFunction = EasingFunctions.CreateReversibleEasingFunction(\n    (currentTime: number, startValue: number, endValue: number, duration: number) => {\n      endValue = endValue - startValue;\n      currentTime /= duration / 2;\n\n      if (currentTime < 1) {\n        return (endValue / 2) * currentTime * currentTime + startValue;\n      }\n      currentTime--;\n\n      return (-endValue / 2) * (currentTime * (currentTime - 2) - 1) + startValue;\n    }\n  );\n\n  public static EaseInCubic: EasingFunction = EasingFunctions.CreateReversibleEasingFunction(\n    (currentTime: number, startValue: number, endValue: number, duration: number) => {\n      endValue = endValue - startValue;\n      currentTime /= duration;\n      return endValue * currentTime * currentTime * currentTime + startValue;\n    }\n  );\n\n  public static EaseOutCubic: EasingFunction = EasingFunctions.CreateReversibleEasingFunction(\n    (currentTime: number, startValue: number, endValue: number, duration: number) => {\n      endValue = endValue - startValue;\n      currentTime /= duration;\n      currentTime--;\n      return endValue * (currentTime * currentTime * currentTime + 1) + startValue;\n    }\n  );\n\n  public static EaseInOutCubic: EasingFunction = EasingFunctions.CreateReversibleEasingFunction(\n    (currentTime: number, startValue: number, endValue: number, duration: number) => {\n      endValue = endValue - startValue;\n      currentTime /= duration / 2;\n      if (currentTime < 1) {\n        return (endValue / 2) * currentTime * currentTime * currentTime + startValue;\n      }\n      currentTime -= 2;\n      return (endValue / 2) * (currentTime * currentTime * currentTime + 2) + startValue;\n    }\n  );\n}\n","import { Actor } from '../Actor';\nimport { Action } from './Action';\n\n/**\n * Action Queues represent an ordered sequence of actions\n *\n * Action queues are part of the [[ActionContext|Action API]] and\n * store the list of actions to be executed for an [[Actor]].\n *\n * Actors implement [[Actor.actions]] which can be manipulated by\n * advanced users to adjust the actions currently being executed in the\n * queue.\n */\nexport class ActionQueue {\n  private _actor: Actor;\n  private _actions: Action[] = [];\n  private _currentAction: Action;\n  private _completedActions: Action[] = [];\n  constructor(actor: Actor) {\n    this._actor = actor;\n  }\n\n  /**\n   * Add an action to the sequence\n   * @param action\n   */\n  public add(action: Action) {\n    this._actions.push(action);\n  }\n\n  /**\n   * Remove an action by reference from the sequence\n   * @param action\n   */\n  public remove(action: Action) {\n    const index = this._actions.indexOf(action);\n    this._actions.splice(index, 1);\n  }\n\n  /**\n   * Removes all actions from this sequence\n   */\n  public clearActions(): void {\n    this._actions.length = 0;\n    this._completedActions.length = 0;\n    if (this._currentAction) {\n      this._currentAction.stop();\n    }\n  }\n\n  /**\n   *\n   * @returns The total list of actions in this sequence complete or not\n   */\n  public getActions(): Action[] {\n    return this._actions.concat(this._completedActions);\n  }\n\n  /**\n   *\n   * @returns `true` if there are more actions to process in the sequence\n   */\n  public hasNext(): boolean {\n    return this._actions.length > 0;\n  }\n\n  /**\n   * @returns `true` if the current sequence of actions is done\n   */\n  public isComplete(): boolean {\n    return this._actions.length === 0;\n  }\n\n  /**\n   * Resets the sequence of actions, this is used to restart a sequence from the beginning\n   */\n  public reset(): void {\n    this._actions = this.getActions();\n\n    const len = this._actions.length;\n    for (let i = 0; i < len; i++) {\n      this._actions[i].reset();\n    }\n    this._completedActions = [];\n  }\n\n  /**\n   * Update the queue which updates actions and handles completing actions\n   * @param elapsedMs\n   */\n  public update(elapsedMs: number) {\n    if (this._actions.length > 0) {\n      this._currentAction = this._actions[0];\n      this._currentAction.update(elapsedMs);\n\n      if (this._currentAction.isComplete(this._actor)) {\n        this._completedActions.push(this._actions.shift());\n      }\n    }\n  }\n}\n","import { Actor } from '../../Actor';\nimport { Action } from '../Action';\nimport { ActionContext } from '../ActionContext';\nimport { ActionQueue } from '../ActionQueue';\n\nexport class Repeat implements Action {\n  private _actionQueue: ActionQueue;\n  private _repeat: number;\n  private _originalRepeat: number;\n  private _stopped: boolean = false;\n  private _repeatContext: ActionContext;\n  private _repeatBuilder: (repeatContext: ActionContext) => any;\n  constructor(actor: Actor, repeatBuilder: (repeatContext: ActionContext) => any, repeat: number) {\n    this._repeatBuilder = repeatBuilder;\n    this._repeatContext = new ActionContext(actor);\n    this._actionQueue = this._repeatContext.getQueue();\n\n    this._repeat = repeat;\n    this._originalRepeat = repeat;\n\n    this._repeatBuilder(this._repeatContext);\n    this._repeat--; // current execution is the first repeat\n  }\n\n  public update(delta: number): void {\n    if (this._actionQueue.isComplete()) {\n      this._actionQueue.clearActions();\n      this._repeatBuilder(this._repeatContext);\n      this._repeat--;\n    }\n    this._actionQueue.update(delta);\n  }\n\n  public isComplete(): boolean {\n    return this._stopped || (this._repeat <= 0 && this._actionQueue.isComplete());\n  }\n\n  public stop(): void {\n    this._stopped = true;\n  }\n\n  public reset(): void {\n    this._repeat = this._originalRepeat;\n  }\n}\n","import { Actor } from '../../Actor';\nimport { Action } from '../Action';\nimport { ActionContext } from '../ActionContext';\nimport { ActionQueue } from '../ActionQueue';\n\n/**\n * RepeatForever Action implementation, it is recommended you use the fluent action\n * context API.\n *\n *\n */\nexport class RepeatForever implements Action {\n  private _actionQueue: ActionQueue;\n  private _stopped: boolean = false;\n  private _repeatContext: ActionContext;\n  private _repeatBuilder: (repeatContext: ActionContext) => any;\n  constructor(actor: Actor, repeatBuilder: (repeatContext: ActionContext) => any) {\n    this._repeatBuilder = repeatBuilder;\n    this._repeatContext = new ActionContext(actor);\n    this._actionQueue = this._repeatContext.getQueue();\n\n    this._repeatBuilder(this._repeatContext);\n  }\n\n  public update(delta: number): void {\n    if (this._stopped) {\n      return;\n    }\n\n    if (this._actionQueue.isComplete()) {\n      this._actionQueue.clearActions();\n      this._repeatBuilder(this._repeatContext);\n    }\n\n    this._actionQueue.update(delta);\n  }\n\n  public isComplete(): boolean {\n    return this._stopped;\n  }\n\n  public stop(): void {\n    this._stopped = true;\n    this._actionQueue.clearActions();\n  }\n\n  public reset(): void {\n    return;\n  }\n}\n","import { Actor } from '../../Actor';\nimport { Vector, vec } from '../../Math/vector';\nimport { Logger } from '../../Util/Log';\nimport { Action } from '../Action';\n\nexport class MoveBy implements Action {\n  private _actor: Actor;\n  public x: number;\n  public y: number;\n  private _distance: number;\n  private _speed: number;\n\n  private _start: Vector;\n  private _offset: Vector;\n  private _end: Vector;\n  private _dir: Vector;\n  private _started = false;\n  private _stopped = false;\n\n  constructor(actor: Actor, offsetX: number, offsetY: number, speed: number) {\n    this._actor = actor;\n    this._speed = speed;\n    this._offset = new Vector(offsetX, offsetY);\n    if (speed <= 0) {\n      Logger.getInstance().error('Attempted to moveBy with speed less than or equal to zero : ' + speed);\n      throw new Error('Speed must be greater than 0 pixels per second');\n    }\n  }\n\n  public update(_delta: number) {\n    if (!this._started) {\n      this._started = true;\n      this._start = new Vector(this._actor.pos.x, this._actor.pos.y);\n      this._end = this._start.add(this._offset);\n      this._distance = this._offset.size;\n      this._dir = this._end.sub(this._start).normalize();\n    }\n\n    if (this.isComplete(this._actor)) {\n      this._actor.pos = vec(this._end.x, this._end.y);\n      this._actor.vel = vec(0, 0);\n    } else {\n      this._actor.vel = this._dir.scale(this._speed);\n    }\n  }\n\n  public isComplete(actor: Actor): boolean {\n    return this._stopped || actor.pos.distance(this._start) >= this._distance;\n  }\n\n  public stop(): void {\n    this._actor.vel = vec(0, 0);\n    this._stopped = true;\n  }\n\n  public reset(): void {\n    this._started = false;\n  }\n}\n","import { Actor } from '../../Actor';\nimport { Vector, vec } from '../../Math/vector';\nimport { Action } from '../Action';\n\nexport class MoveTo implements Action {\n  private _actor: Actor;\n  public x: number;\n  public y: number;\n  private _start: Vector;\n  private _end: Vector;\n  private _dir: Vector;\n  private _speed: number;\n  private _distance: number;\n  private _started = false;\n  private _stopped = false;\n  constructor(actor: Actor, destx: number, desty: number, speed: number) {\n    this._actor = actor;\n    this._end = new Vector(destx, desty);\n    this._speed = speed;\n  }\n\n  public update(_delta: number): void {\n    if (!this._started) {\n      this._started = true;\n      this._start = new Vector(this._actor.pos.x, this._actor.pos.y);\n      this._distance = this._start.distance(this._end);\n      this._dir = this._end.sub(this._start).normalize();\n    }\n    const m = this._dir.scale(this._speed);\n    this._actor.vel = vec(m.x, m.y);\n\n    if (this.isComplete(this._actor)) {\n      this._actor.pos = vec(this._end.x, this._end.y);\n      this._actor.vel = vec(0, 0);\n    }\n  }\n\n  public isComplete(actor: Actor): boolean {\n    return this._stopped || new Vector(actor.pos.x, actor.pos.y).distance(this._start) >= this._distance;\n  }\n\n  public stop(): void {\n    this._actor.vel = vec(0, 0);\n    this._stopped = true;\n  }\n\n  public reset(): void {\n    this._started = false;\n  }\n}\n","import { Actor } from '../../Actor';\nimport { Action } from '../Action';\nimport { RotationType } from '../RotationType';\nimport * as Util from '../../Util/Util';\n\nexport class RotateTo implements Action {\n  private _actor: Actor;\n  public x: number;\n  public y: number;\n  private _start: number;\n  private _end: number;\n  private _speed: number;\n  private _rotationType: RotationType;\n  private _direction: number;\n  private _distance: number;\n  private _shortDistance: number;\n  private _longDistance: number;\n  private _shortestPathIsPositive: boolean;\n  private _currentNonCannonAngle: number;\n  private _started = false;\n  private _stopped = false;\n  constructor(actor: Actor, angleRadians: number, speed: number, rotationType?: RotationType) {\n    this._actor = actor;\n    this._end = angleRadians;\n    this._speed = speed;\n    this._rotationType = rotationType || RotationType.ShortestPath;\n  }\n\n  public update(_delta: number): void {\n    if (!this._started) {\n      this._started = true;\n      this._start = this._actor.rotation;\n      this._currentNonCannonAngle = this._actor.rotation;\n      const distance1 = Math.abs(this._end - this._start);\n      const distance2 = Util.TwoPI - distance1;\n      if (distance1 > distance2) {\n        this._shortDistance = distance2;\n        this._longDistance = distance1;\n      } else {\n        this._shortDistance = distance1;\n        this._longDistance = distance2;\n      }\n\n      this._shortestPathIsPositive = (this._start - this._end + Util.TwoPI) % Util.TwoPI >= Math.PI;\n\n      switch (this._rotationType) {\n        case RotationType.ShortestPath:\n          this._distance = this._shortDistance;\n          if (this._shortestPathIsPositive) {\n            this._direction = 1;\n          } else {\n            this._direction = -1;\n          }\n          break;\n        case RotationType.LongestPath:\n          this._distance = this._longDistance;\n          if (this._shortestPathIsPositive) {\n            this._direction = -1;\n          } else {\n            this._direction = 1;\n          }\n          break;\n        case RotationType.Clockwise:\n          this._direction = 1;\n          if (this._shortestPathIsPositive) {\n            this._distance = this._shortDistance;\n          } else {\n            this._distance = this._longDistance;\n          }\n          break;\n        case RotationType.CounterClockwise:\n          this._direction = -1;\n          if (!this._shortestPathIsPositive) {\n            this._distance = this._shortDistance;\n          } else {\n            this._distance = this._longDistance;\n          }\n          break;\n      }\n    }\n\n    this._actor.angularVelocity = this._direction * this._speed;\n    this._currentNonCannonAngle += this._direction * this._speed * (_delta / 1000);\n\n    if (this.isComplete()) {\n      this._actor.rotation = this._end;\n      this._actor.angularVelocity = 0;\n      this._stopped = true;\n    }\n  }\n\n  public isComplete(): boolean {\n    const distanceTravelled = Math.abs(this._currentNonCannonAngle - this._start);\n    return this._stopped || distanceTravelled >= Math.abs(this._distance);\n  }\n\n  public stop(): void {\n    this._actor.angularVelocity = 0;\n    this._stopped = true;\n  }\n\n  public reset(): void {\n    this._started = false;\n  }\n}\n","import { Actor } from '../../Actor';\nimport { Action } from '../Action';\nimport { RotationType } from '../RotationType';\nimport * as Util from '../../Util/Util';\n\nexport class RotateBy implements Action {\n  private _actor: Actor;\n  public x: number;\n  public y: number;\n  private _start: number;\n  private _end: number;\n  private _speed: number;\n  private _offset: number;\n\n  private _rotationType: RotationType;\n  private _direction: number;\n  private _distance: number;\n  private _shortDistance: number;\n  private _longDistance: number;\n  private _shortestPathIsPositive: boolean;\n  private _currentNonCannonAngle: number;\n  private _started = false;\n  private _stopped = false;\n  constructor(actor: Actor, angleRadiansOffset: number, speed: number, rotationType?: RotationType) {\n    this._actor = actor;\n    this._speed = speed;\n    this._offset = angleRadiansOffset;\n    this._rotationType = rotationType || RotationType.ShortestPath;\n  }\n\n  public update(_delta: number): void {\n    if (!this._started) {\n      this._started = true;\n      this._start = this._actor.rotation;\n      this._currentNonCannonAngle = this._actor.rotation;\n      this._end = this._start + this._offset;\n\n      const distance1 = Math.abs(this._end - this._start);\n      const distance2 = Util.TwoPI - distance1;\n      if (distance1 > distance2) {\n        this._shortDistance = distance2;\n        this._longDistance = distance1;\n      } else {\n        this._shortDistance = distance1;\n        this._longDistance = distance2;\n      }\n\n      this._shortestPathIsPositive = (this._start - this._end + Util.TwoPI) % Util.TwoPI >= Math.PI;\n\n      switch (this._rotationType) {\n        case RotationType.ShortestPath:\n          this._distance = this._shortDistance;\n          if (this._shortestPathIsPositive) {\n            this._direction = 1;\n          } else {\n            this._direction = -1;\n          }\n          break;\n        case RotationType.LongestPath:\n          this._distance = this._longDistance;\n          if (this._shortestPathIsPositive) {\n            this._direction = -1;\n          } else {\n            this._direction = 1;\n          }\n          break;\n        case RotationType.Clockwise:\n          this._direction = 1;\n          if (this._shortDistance >= 0) {\n            this._distance = this._shortDistance;\n          } else {\n            this._distance = this._longDistance;\n          }\n          break;\n        case RotationType.CounterClockwise:\n          this._direction = -1;\n          if (this._shortDistance <= 0) {\n            this._distance = this._shortDistance;\n          } else {\n            this._distance = this._longDistance;\n          }\n          break;\n      }\n    }\n\n    this._actor.angularVelocity = this._direction * this._speed;\n    this._currentNonCannonAngle += this._direction * this._speed * (_delta / 1000);\n\n    if (this.isComplete()) {\n      this._actor.rotation = this._end;\n      this._actor.angularVelocity = 0;\n      this._stopped = true;\n    }\n  }\n\n  public isComplete(): boolean {\n    const distanceTravelled = Math.abs(this._currentNonCannonAngle - this._start);\n    return this._stopped || distanceTravelled >= Math.abs(this._distance);\n  }\n\n  public stop(): void {\n    this._actor.angularVelocity = 0;\n    this._stopped = true;\n  }\n\n  public reset(): void {\n    this._started = false;\n  }\n}\n","import { Entity } from './Entity';\n\nexport interface ComponentCtor<T extends Component = Component> {\n  new (): T;\n}\n\n/**\n * Type guard to check if a component implements clone\n * @param x\n */\nfunction hasClone(x: any): x is { clone(): any } {\n  return !!x?.clone;\n}\n\nexport type ComponentType<ComponentToParse> = ComponentToParse extends Component<infer TypeName> ? TypeName : never;\n\n/**\n * Plucks the string type out of a component type\n */\nexport type ComponentStringType<T> = T extends Component<infer R> ? R : string;\n\n/**\n * Components are containers for state in Excalibur, the are meant to convey capabilities that an Entity posesses\n *\n * Implementations of Component must have a zero-arg constructor to support dependecies\n *\n * ```typescript\n * class MyComponent extends ex.Component<'my'> {\n *   public readonly type = 'my';\n *   // zero arg support required if you want to use component dependencies\n *   constructor(public optionalPos?: ex.Vector) {}\n * }\n * ```\n */\nexport abstract class Component<TypeName extends string = string> {\n  /**\n   * Optionally list any component types this component depends on\n   * If the owner entity does not have these components, new components will be added to the entity\n   *\n   * Only components with zero-arg constructors are supported as automatic component dependencies\n   */\n  readonly dependencies?: ComponentCtor[];\n\n  // todo implement optional\n  readonly optional?: ComponentCtor[];\n\n  /**\n   * Type of this component, must be a unique type among component types in you game.\n   */\n  abstract readonly type: TypeName;\n\n  /**\n   * Current owning [[Entity]], if any, of this component. Null if not added to any [[Entity]]\n   */\n  owner?: Entity = null;\n\n  /**\n   * Clones any properties on this component, if that property value has a `clone()` method it will be called\n   */\n  clone(): this {\n    const newComponent = new (this.constructor as any)();\n    for (const prop in this) {\n      if (this.hasOwnProperty(prop)) {\n        const val = this[prop];\n        if (hasClone(val) && prop !== 'owner' && prop !== 'clone') {\n          newComponent[prop] = val.clone();\n        } else {\n          newComponent[prop] = val;\n        }\n      }\n    }\n    return newComponent;\n  }\n\n  /**\n   * Optional callback called when a component is added to an entity\n   */\n  onAdd?(owner: Entity): void;\n\n  /**\n   * Opitonal callback called when acomponent is added to an entity\n   */\n  onRemove?(previousOwner: Entity): void;\n}\n\n/**\n * Tag components are a way of tagging a component with label and a simple value\n *\n * For example:\n *\n * ```typescript\n * const isOffscreen = new TagComponent('offscreen');\n * entity.addComponent(isOffscreen);\n * entity.tags.includes\n * ```\n */\nexport class TagComponent<TypeName extends string, MaybeValueType extends string | symbol | number | boolean = never> extends Component<\nTypeName\n> {\n  constructor(public readonly type: TypeName, public readonly value?: MaybeValueType) {\n    super();\n  }\n}\n","import { Vector } from '../../Math/vector';\nimport { Component } from '../Component';\n\nexport interface Motion {\n  /**\n   * The velocity of an entity in pixels per second\n   */\n  vel: Vector;\n\n  /**\n   * The acceleration of entity in pixels per second^2\n   */\n  acc: Vector;\n\n  /**\n   * The scale rate of change in scale units per second\n   */\n  scaleFactor: Vector;\n\n  /**\n   * The angular velocity which is how quickly the entity is rotating in radians per second\n   */\n  angularVelocity: number;\n\n  /**\n   * The amount of torque applied to the entity, angular acceleration is torque * inertia\n   */\n  torque: number;\n\n  /**\n   * Inerita can be thought of as the resistance to motion\n   */\n  inertia: number;\n}\n\nexport class MotionComponent extends Component<'ex.motion'> {\n  public readonly type = 'ex.motion';\n\n  /**\n   * The velocity of an entity in pixels per second\n   */\n  public vel: Vector = Vector.Zero;\n\n  /**\n   * The acceleration of entity in pixels per second^2\n   */\n  public acc: Vector = Vector.Zero;\n\n  /**\n   * The scale rate of change in scale units per second\n   */\n  public scaleFactor: Vector = Vector.Zero;\n\n  /**\n   * The angular velocity which is how quickly the entity is rotating in radians per second\n   */\n  public angularVelocity = 0;\n\n  /**\n   * The amount of torque applied to the entity, angular acceleration is torque * inertia\n   */\n  public torque: number = 0;\n\n  /**\n   * Inerita can be thought of as the resistance to motion\n   */\n  public inertia: number = 1;\n}\n","import { Vector } from './vector';\n\nexport interface VectorViewOptions {\n  getX: () => number;\n  getY: () => number;\n  setX: (x: number) => void;\n  setY: (y: number) => void;\n}\nexport class VectorView extends Vector {\n  private _getX: () => number;\n  private _getY: () => number;\n  private _setX: (x: number) => void;\n  private _setY: (y: number) => void;\n  constructor(options: VectorViewOptions) {\n    super(0, 0);\n    this._getX = options.getX;\n    this._getY = options.getY;\n    this._setX = options.setX;\n    this._setY = options.setY;\n  }\n  public get x() {\n    return (this._x = this._getX());\n  }\n\n  public set x(val) {\n    this._setX(val);\n    this._x = val;\n  }\n\n  public get y() {\n    return (this._y = this._getY());\n  }\n  public set y(val) {\n    this._setY(val);\n    this._y = val;\n  }\n}\n","import { Matrix, MatrixLocations } from '../../Math/matrix';\nimport { VectorView } from '../../Math/vector-view';\nimport { Vector, vec } from '../../Math/vector';\nimport { Component } from '../Component';\n\nexport interface Transform {\n  /**\n   * The [[CoordPlane|coordinate plane]] for this transform for the entity.\n   */\n  coordPlane: CoordPlane;\n\n  /**\n   * The current position of the entity in world space or in screen space depending on the the [[CoordPlane|coordinate plane]].\n   *\n   * If the entity has a parent this position is relative to the parent entity.\n   */\n  pos: Vector;\n\n  /**\n   * The z-index ordering of the entity, a higher values are drawn on top of lower values.\n   * For example z=99 would be drawn on top of z=0.\n   */\n  z: number;\n\n  /**\n   * The rotation of the entity in radians. For example `Math.PI` radians is the same as 180 degrees.\n   *\n   * If the entity has a parent this rotation is relative to the parent.\n   */\n  rotation: number;\n\n  /**\n   * The scale of the entity. If the entity has a parent this scale is relative to the parent.\n   */\n  scale: Vector;\n}\n\nconst createPosView = (matrix: Matrix) => {\n  const source = matrix;\n  return new VectorView({\n    setX: (x) => {\n      source.data[MatrixLocations.X] = x;\n    },\n    setY: (y) => {\n      source.data[MatrixLocations.Y] = y;\n    },\n    getX: () => {\n      return source.data[MatrixLocations.X];\n    },\n    getY: () => {\n      return source.data[MatrixLocations.Y];\n    }\n  });\n};\n\nconst createScaleView = (matrix: Matrix) => {\n  const source = matrix;\n  return new VectorView({\n    setX: (x) => {\n      source.setScaleX(x);\n    },\n    setY: (y) => {\n      source.setScaleY(y);\n    },\n    getX: () => {\n      return source.getScaleX();\n    },\n    getY: () => {\n      return source.getScaleY();\n    }\n  });\n};\n\n/**\n * Enum representing the coordinate plane for the position 2D vector in the [[TransformComponent]]\n */\nexport enum CoordPlane {\n  /**\n   * The world coordinate plane (default) represents world space, any entities drawn with world\n   * space move when the camera moves.\n   */\n  World = 'world',\n  /**\n   * The screen coordinate plane represents screen space, entities drawn in screen space are pinned\n   * to screen coordinates ignoring the camera.\n   */\n  Screen = 'screen'\n}\n\nexport class TransformComponent extends Component<'ex.transform'> implements Transform {\n  public readonly type = 'ex.transform';\n\n  private _dirty = false;\n\n  public readonly matrix = Matrix.identity().translate(0, 0).rotate(0).scale(1, 1);\n  private _position = createPosView(this.matrix);\n  private _rotation = 0;\n  private _scale = createScaleView(this.matrix);\n\n  private _recalculate() {\n    this._rotation = this.matrix.getRotation();\n    this._dirty = false;\n  }\n\n  public getGlobalMatrix(): Matrix {\n    if (!this.parent) {\n      return this.matrix;\n    } else {\n      return this.parent.getGlobalMatrix().multm(this.matrix);\n    }\n  }\n\n  public getGlobalTransform(): Transform {\n    return {\n      pos: this.globalPos,\n      scale: this.globalScale,\n      rotation: this.globalRotation,\n      z: this.z,\n      coordPlane: this.coordPlane\n    };\n  }\n\n  public get parent(): TransformComponent | null {\n    return this?.owner?.parent?.get(TransformComponent);\n  }\n\n  /**\n   * The [[CoordPlane|coordinate plane|]] for this transform for the entity.\n   */\n  public coordPlane = CoordPlane.World;\n\n  /**\n   * The current position of the entity in world space or in screen space depending on the the [[CoordPlane|coordinate plane]].\n   *\n   * If a parent entity exists coordinates are local to the parent.\n   */\n  public get pos(): Vector {\n    if (this._dirty) {\n      this._recalculate();\n    }\n    return this._position;\n  }\n\n  public set pos(val: Vector) {\n    this.matrix.setPosition(val.x, val.y);\n    this._dirty = true;\n  }\n\n  // Dirty flag check up the chain\n  public get dirty(): boolean {\n    if (this?.owner?.parent) {\n      const parent = this.parent;\n      return parent.dirty || this._dirty;\n    }\n    return this._dirty;\n  }\n\n  /**\n   * The current world position calculated\n   */\n  public get globalPos(): Vector {\n    const source = this.getGlobalMatrix();\n    return new VectorView({\n      getX: () => source.data[MatrixLocations.X],\n      getY: () => source.data[MatrixLocations.Y],\n      setX: (x) => {\n        if (this.parent) {\n          const [newX] = this.parent?.getGlobalMatrix().getAffineInverse().multv([x, source.data[MatrixLocations.Y]]);\n          this.matrix.data[MatrixLocations.X] = newX;\n        } else {\n          this.matrix.data[MatrixLocations.X] = x;\n        }\n      },\n      setY: (y) => {\n        if (this.parent) {\n          const [, newY] = this.parent?.getGlobalMatrix().getAffineInverse().multv([source.data[MatrixLocations.X], y]);\n          this.matrix.data[MatrixLocations.Y] = newY;\n        } else {\n          this.matrix.data[MatrixLocations.Y] = y;\n        }\n      }\n    });\n  }\n\n  public set globalPos(val: Vector) {\n    const parentTransform = this.parent;\n    if (!parentTransform) {\n      this.pos = val;\n    } else {\n      this.pos = parentTransform.getGlobalMatrix().getAffineInverse().multv(val);\n    }\n  }\n\n  /**\n   * The z-index ordering of the entity, a higher values are drawn on top of lower values.\n   * For example z=99 would be drawn on top of z=0.\n   */\n  public z: number = 0;\n\n  /**\n   * The rotation of the entity in radians. For example `Math.PI` radians is the same as 180 degrees.\n   */\n  public get rotation(): number {\n    if (this._dirty) {\n      this._recalculate();\n    }\n    return this._rotation;\n  }\n\n  public set rotation(val: number) {\n    this.matrix.setRotation(val);\n    this._dirty = true;\n  }\n\n  public get globalRotation(): number {\n    return this.getGlobalMatrix().getRotation();\n  }\n\n  public set globalRotation(val: number) {\n    const parentTransform = this.parent;\n    if (!parentTransform) {\n      this.rotation = val;\n    } else {\n      this.rotation = val - parentTransform.globalRotation;\n    }\n  }\n\n  /**\n   * The scale of the entity.\n   */\n  public get scale(): Vector {\n    if (this._dirty) {\n      this._recalculate();\n    }\n    return this._scale;\n  }\n\n  public set scale(val: Vector) {\n    this.matrix.setScale(val);\n    this._dirty = true;\n  }\n\n  public get globalScale(): Vector {\n    const source = this.getGlobalMatrix();\n    return new VectorView({\n      getX: () => source.getScaleX(),\n      getY: () => source.getScaleY(),\n      setX: (x) => {\n        if (this.parent) {\n          const globalScaleX = this.parent.globalScale.x;\n          this.matrix.setScaleX(x / globalScaleX);\n        } else {\n          this.matrix.setScaleX(x);\n        }\n      },\n      setY: (y) => {\n        if (this.parent) {\n          const globalScaleY = this.parent.globalScale.y;\n          this.matrix.setScaleY(y / globalScaleY);\n        } else {\n          this.matrix.setScaleY(y);\n        }\n      }\n    });\n  }\n\n  public set globalScale(val: Vector) {\n    const parentTransform = this.parent;\n    if (!parentTransform) {\n      this.scale = val;\n    } else {\n      this.scale = vec(val.x / parentTransform.globalScale.x, val.y / parentTransform.globalScale.y);\n    }\n  }\n\n  /**\n   * Apply the transform to a point\n   * @param point\n   */\n  public apply(point: Vector): Vector {\n    return this.matrix.multv(point);\n  }\n\n  /**\n   * Apply the inverse transform to a point\n   * @param point\n   */\n  public applyInverse(point: Vector): Vector {\n    return this.matrix.getAffineInverse().multv(point);\n  }\n}\n","/**\n * An enum that describes the types of collisions bodies can participate in\n */\nexport enum CollisionType {\n  /**\n   * Bodies with the `PreventCollision` setting do not participate in any\n   * collisions and do not raise collision events.\n   */\n  PreventCollision = 'PreventCollision',\n  /**\n   * Bodies with the `Passive` setting only raise collision events, but are not\n   * influenced or moved by other bodies and do not influence or move other bodies.\n   * This is useful for use in trigger type behavior.\n   */\n  Passive = 'Passive',\n  /**\n   * Bodies with the `Active` setting raise collision events and participate\n   * in collisions with other bodies and will be push or moved by bodies sharing\n   * the `Active` or `Fixed` setting.\n   */\n  Active = 'Active',\n  /**\n   * Bodies with the `Fixed` setting raise collision events and participate in\n   * collisions with other bodies. Actors with the `Fixed` setting will not be\n   * pushed or moved by other bodies sharing the `Fixed`. Think of Fixed\n   * bodies as \"immovable/unstoppable\" objects. If two `Fixed` bodies meet they will\n   * not be pushed or moved by each other, they will not interact except to throw\n   * collision events.\n   */\n  Fixed = 'Fixed'\n}\n","import { Vector } from '../Math/vector';\nimport { obsolete } from '../Util/Decorators';\n\n\n/**\n * Possible collision resolution strategies\n *\n * The default is [[CollisionResolutionStrategy.Arcade]] which performs simple axis aligned arcade style physics. This is useful for things\n * like platformers or top down games.\n *\n * More advanced rigid body physics are enabled by setting [[CollisionResolutionStrategy.Realistic]] which allows for complicated\n * simulated physical interactions.\n */\nexport enum CollisionResolutionStrategy {\n  Arcade = 'arcade',\n  Realistic = 'realistic'\n}\n\n/**\n * Possible broadphase collision pair identification strategies\n *\n * The default strategy is [[BroadphaseStrategy.DynamicAABBTree]] which uses a binary tree of axis-aligned bounding boxes to identify\n * potential collision pairs which is O(nlog(n)) faster.\n */\nexport enum BroadphaseStrategy {\n  DynamicAABBTree\n}\n\n/**\n * Possible numerical integrators for position and velocity\n */\nexport enum Integrator {\n  Euler\n}\n\n/**\n * The [[Physics]] object is the global configuration object for all Excalibur physics.\n */\n/* istanbul ignore next */\nexport class Physics {\n  /**\n   * Global acceleration that is applied to all vanilla actors that have a [[CollisionType.Active|active]] collision type.\n   * Global acceleration won't effect [[Label|labels]], [[ScreenElement|ui actors]], or [[Trigger|triggers]] in Excalibur.\n   *\n   * This is a great way to globally simulate effects like gravity.\n   */\n  public static acc = new Vector(0, 0);\n  public static get gravity() {\n    return Physics.acc;\n  }\n  public static set gravity(v: Vector) {\n    Physics.acc = v;\n  }\n\n  /**\n   * Globally switches all Excalibur physics behavior on or off.\n   */\n  public static enabled = true;\n\n  /**\n   * Gets or sets the broadphase pair identification strategy.\n   *\n   * The default strategy is [[BroadphaseStrategy.DynamicAABBTree]] which uses a binary tree of axis-aligned bounding boxes to identify\n   * potential collision pairs which is O(nlog(n)) faster.\n   */\n  public static broadphaseStrategy: BroadphaseStrategy = BroadphaseStrategy.DynamicAABBTree;\n\n  /**\n   * Gets or sets the global collision resolution strategy (narrowphase).\n   *\n   * The default is [[CollisionResolutionStrategy.Arcade]] which performs simple axis aligned arcade style physics.\n   *\n   * More advanced rigid body physics are enabled by setting [[CollisionResolutionStrategy.Realistic]] which allows for complicated\n   * simulated physical interactions.\n   */\n  public static collisionResolutionStrategy: CollisionResolutionStrategy = CollisionResolutionStrategy.Arcade;\n  /**\n   * The default mass to use if none is specified\n   */\n  public static defaultMass: number = 10;\n  /**\n   * Gets or sets the position and velocity positional integrator, currently only Euler is supported.\n   */\n  public static integrator: Integrator = Integrator.Euler;\n\n  /**\n   * Configures Excalibur to use \"arcade\" physics. Arcade physics which performs simple axis aligned arcade style physics.\n   */\n  public static useArcadePhysics(): void {\n    Physics.collisionResolutionStrategy = CollisionResolutionStrategy.Arcade;\n  }\n\n  /**\n   * Configures Excalibur to use rigid body physics. Rigid body physics allows for complicated\n   * simulated physical interactions.\n   */\n  public static useRealisticPhysics(): void {\n    Physics.collisionResolutionStrategy = CollisionResolutionStrategy.Realistic;\n  }\n\n  /**\n   * Factor to add to the RigidBody BoundingBox, bounding box (dimensions += vel * dynamicTreeVelocityMultiplier);\n   */\n  public static dynamicTreeVelocityMultiplier = 2;\n\n  @obsolete({\n    message: 'Alias for incorrect spelling used in older versions, will be removed in v0.25.0',\n    alternateMethod: 'dynamicTreeVelocityMultiplier'\n  })\n  public static get dynamicTreeVelocityMultiplyer() {\n    return Physics.dynamicTreeVelocityMultiplier;\n  }\n\n  public static set dynamicTreeVelocityMultiplyer(value: number) {\n    Physics.dynamicTreeVelocityMultiplier = value;\n  }\n\n  /**\n   * Pad RigidBody BoundingBox by a constant amount\n   */\n  public static boundsPadding = 5;\n\n  /**\n   * Number of position iterations (overlap) to run in the solver\n   */\n  public static positionIterations = 3;\n\n  /**\n   * Number of velocity iteration (response) to run in the solver\n   */\n  public static velocityIterations = 8;\n\n  /**\n   * Amount of overlap to tolerate in pixels\n   */\n  public static slop = 1;\n\n  /**\n   * Amount of positional overlap correction to apply each position iteration of the solver\n   * O - meaning no correction, 1 - meaning correct all overlap\n   */\n  public static steeringFactor = 0.2;\n\n  /**\n   * Warm start set to true re-uses impulses from previous frames back in the solver\n   */\n  public static warmStart = true;\n\n  /**\n   * By default bodies do not sleep\n   */\n  public static bodiesCanSleepByDefault = false;\n\n  /**\n   * Surface epsilon is used to help deal with surface penetration\n   */\n  public static surfaceEpsilon = 0.1;\n\n  public static sleepEpsilon = 0.07;\n\n  public static wakeThreshold = Physics.sleepEpsilon * 3;\n\n  public static sleepBias = 0.9;\n\n  /**\n   * Enable fast moving body checking, this enables checking for collision pairs via raycast for fast moving objects to prevent\n   * bodies from tunneling through one another.\n   */\n  public static checkForFastBodies = true;\n\n  /**\n   * Disable minimum fast moving body raycast, by default if ex.Physics.checkForFastBodies = true Excalibur will only check if the\n   * body is moving at least half of its minimum dimension in an update. If ex.Physics.disableMinimumSpeedForFastBody is set to true,\n   * Excalibur will always perform the fast body raycast regardless of speed.\n   */\n  public static disableMinimumSpeedForFastBody = false;\n}\n","import { Actor } from '../../Actor';\nimport { vec } from '../../Math/vector';\nimport { MotionComponent } from '../../EntityComponentSystem/Components/MotionComponent';\nimport { TransformComponent } from '../../EntityComponentSystem/Components/TransformComponent';\nimport { Action } from '../Action';\n\nexport class ScaleTo implements Action {\n  private _actor: Actor;\n  public x: number;\n  public y: number;\n  private _startX: number;\n  private _startY: number;\n  private _endX: number;\n  private _endY: number;\n  private _speedX: number;\n  private _speedY: number;\n  private _distanceX: number;\n  private _distanceY: number;\n  private _started = false;\n  private _stopped = false;\n  constructor(actor: Actor, scaleX: number, scaleY: number, speedX: number, speedY: number) {\n    this._actor = actor;\n    this._endX = scaleX;\n    this._endY = scaleY;\n    this._speedX = speedX;\n    this._speedY = speedY;\n  }\n\n  public update(_delta: number): void {\n    const transform = this._actor.get(TransformComponent);\n    const motion = this._actor.get(MotionComponent);\n    if (!this._started) {\n      this._started = true;\n      this._startX = transform.scale.x;\n      this._startY = transform.scale.y;\n      this._distanceX = Math.abs(this._endX - this._startX);\n      this._distanceY = Math.abs(this._endY - this._startY);\n    }\n\n    if (!(Math.abs(transform.scale.x - this._startX) >= this._distanceX)) {\n      const directionX = this._endY < this._startY ? -1 : 1;\n      motion.scaleFactor.x = this._speedX * directionX;\n    } else {\n      motion.scaleFactor.x = 0;\n    }\n\n    if (!(Math.abs(transform.scale.y - this._startY) >= this._distanceY)) {\n      const directionY = this._endY < this._startY ? -1 : 1;\n      motion.scaleFactor.y = this._speedY * directionY;\n    } else {\n      motion.scaleFactor.y = 0;\n    }\n\n    if (this.isComplete()) {\n      this._actor.scale = vec(this._endX, this._endY);\n      motion.scaleFactor.x = 0;\n      motion.scaleFactor.y = 0;\n    }\n  }\n\n  public isComplete(): boolean {\n    return (\n      this._stopped ||\n      (Math.abs(this._actor.scale.y - this._startX) >= this._distanceX && Math.abs(this._actor.scale.y - this._startY) >= this._distanceY)\n    );\n  }\n\n  public stop(): void {\n    const motion = this._actor.get(MotionComponent);\n    motion.scaleFactor.x = 0;\n    motion.scaleFactor.y = 0;\n    this._stopped = true;\n  }\n\n  public reset(): void {\n    this._started = false;\n  }\n}\n","import { Actor } from '../../Actor';\nimport { Vector } from '../../Math/vector';\nimport { TransformComponent } from '../../EntityComponentSystem';\nimport { MotionComponent } from '../../EntityComponentSystem/Components/MotionComponent';\nimport { Action } from '../Action';\n\nexport class ScaleBy implements Action {\n  private _actor: Actor;\n  public x: number;\n  public y: number;\n  private _startScale: Vector;\n  private _endScale: Vector;\n  private _offset: Vector;\n  private _distanceX: number;\n  private _distanceY: number;\n  private _directionX: number;\n  private _directionY: number;\n  private _started = false;\n  private _stopped = false;\n  private _speedX: number;\n  private _speedY: number;\n  constructor(actor: Actor, scaleOffsetX: number, scaleOffsetY: number, speed: number) {\n    this._actor = actor;\n    this._offset = new Vector(scaleOffsetX, scaleOffsetY);\n    this._speedX = this._speedY = speed;\n  }\n\n  public update(_delta: number): void {\n    const transform = this._actor.get(TransformComponent);\n    const motion = this._actor.get(MotionComponent);\n    if (!this._started) {\n      this._started = true;\n      this._startScale = transform.scale.clone();\n      this._endScale = this._startScale.add(this._offset);\n      this._distanceX = Math.abs(this._endScale.x - this._startScale.x);\n      this._distanceY = Math.abs(this._endScale.y - this._startScale.y);\n      this._directionX = this._endScale.x < this._startScale.x ? -1 : 1;\n      this._directionY = this._endScale.y < this._startScale.y ? -1 : 1;\n    }\n\n    motion.scaleFactor.x = this._speedX * this._directionX;\n    motion.scaleFactor.y = this._speedY * this._directionY;\n\n    if (this.isComplete()) {\n      transform.scale = this._endScale;\n      motion.scaleFactor.x = 0;\n      motion.scaleFactor.y = 0;\n    }\n  }\n\n  public isComplete(): boolean {\n    return (\n      this._stopped ||\n      (Math.abs(this._actor.scale.x - this._startScale.x) >= this._distanceX &&\n        Math.abs(this._actor.scale.y - this._startScale.y) >= this._distanceY)\n    );\n  }\n\n  public stop(): void {\n    const motion = this._actor.get(MotionComponent);\n    motion.scaleFactor.x = 0;\n    motion.scaleFactor.y = 0;\n    this._stopped = true;\n  }\n\n  public reset(): void {\n    this._started = false;\n  }\n}\n","import { Action } from '../Action';\n\nexport class CallMethod implements Action {\n  private _method: () => any = null;\n  private _hasBeenCalled: boolean = false;\n  constructor(method: () => any) {\n    this._method = method;\n  }\n\n  public update(_delta: number) {\n    this._method();\n    this._hasBeenCalled = true;\n  }\n  public isComplete() {\n    return this._hasBeenCalled;\n  }\n  public reset() {\n    this._hasBeenCalled = false;\n  }\n  public stop() {\n    this._hasBeenCalled = true;\n  }\n}\n","import { Actor } from '../../Actor';\nimport { vec, Vector } from '../../Math/vector';\nimport { Action } from '../Action';\n\nexport class EaseTo implements Action {\n  private _currentLerpTime: number = 0;\n  private _lerpDuration: number = 1 * 1000; // 1 second\n  private _lerpStart: Vector = new Vector(0, 0);\n  private _lerpEnd: Vector = new Vector(0, 0);\n  private _initialized: boolean = false;\n  private _stopped: boolean = false;\n  private _distance: number = 0;\n  constructor(\n    public actor: Actor,\n    x: number,\n    y: number,\n    duration: number,\n    public easingFcn: (currentTime: number, startValue: number, endValue: number, duration: number) => number\n  ) {\n    this._lerpDuration = duration;\n    this._lerpEnd = new Vector(x, y);\n  }\n  private _initialize() {\n    this._lerpStart = new Vector(this.actor.pos.x, this.actor.pos.y);\n    this._currentLerpTime = 0;\n    this._distance = this._lerpStart.distance(this._lerpEnd);\n  }\n\n  public update(delta: number): void {\n    if (!this._initialized) {\n      this._initialize();\n      this._initialized = true;\n    }\n\n    // Need to update lerp time first, otherwise the first update will always be zero\n    this._currentLerpTime += delta;\n    let newX = this.actor.pos.x;\n    let newY = this.actor.pos.y;\n    if (this._currentLerpTime < this._lerpDuration) {\n      if (this._lerpEnd.x < this._lerpStart.x) {\n        newX =\n          this._lerpStart.x -\n          (this.easingFcn(this._currentLerpTime, this._lerpEnd.x, this._lerpStart.x, this._lerpDuration) - this._lerpEnd.x);\n      } else {\n        newX = this.easingFcn(this._currentLerpTime, this._lerpStart.x, this._lerpEnd.x, this._lerpDuration);\n      }\n\n      if (this._lerpEnd.y < this._lerpStart.y) {\n        newY =\n          this._lerpStart.y -\n          (this.easingFcn(this._currentLerpTime, this._lerpEnd.y, this._lerpStart.y, this._lerpDuration) - this._lerpEnd.y);\n      } else {\n        newY = this.easingFcn(this._currentLerpTime, this._lerpStart.y, this._lerpEnd.y, this._lerpDuration);\n      }\n      // Given the lerp position figure out the velocity in pixels per second\n      this.actor.vel = vec((newX - this.actor.pos.x) / (delta / 1000), (newY - this.actor.pos.y) / (delta / 1000));\n    } else {\n      this.actor.pos = vec(this._lerpEnd.x, this._lerpEnd.y);\n      this.actor.vel = Vector.Zero;\n    }\n  }\n  public isComplete(actor: Actor): boolean {\n    return this._stopped || new Vector(actor.pos.x, actor.pos.y).distance(this._lerpStart) >= this._distance;\n  }\n\n  public reset(): void {\n    this._initialized = false;\n  }\n  public stop(): void {\n    this.actor.vel = vec(0, 0);\n    this._stopped = true;\n  }\n}\n","import { Actor } from '../../Actor';\nimport { Action } from '../Action';\n\nexport class Blink implements Action {\n  private _timeVisible: number = 0;\n  private _timeNotVisible: number = 0;\n  private _elapsedTime: number = 0;\n  private _totalTime: number = 0;\n  private _actor: Actor;\n  private _duration: number;\n  private _stopped: boolean = false;\n  private _started: boolean = false;\n  constructor(actor: Actor, timeVisible: number, timeNotVisible: number, numBlinks: number = 1) {\n    this._actor = actor;\n    this._timeVisible = timeVisible;\n    this._timeNotVisible = timeNotVisible;\n    this._duration = (timeVisible + timeNotVisible) * numBlinks;\n  }\n\n  public update(delta: number): void {\n    if (!this._started) {\n      this._started = true;\n    }\n\n    this._elapsedTime += delta;\n    this._totalTime += delta;\n    if (this._actor.visible && this._elapsedTime >= this._timeVisible) {\n      this._actor.visible = false;\n      this._elapsedTime = 0;\n    }\n\n    if (!this._actor.visible && this._elapsedTime >= this._timeNotVisible) {\n      this._actor.visible = true;\n      this._elapsedTime = 0;\n    }\n\n    if (this.isComplete()) {\n      this._actor.visible = true;\n    }\n  }\n\n  public isComplete(): boolean {\n    return this._stopped || this._totalTime >= this._duration;\n  }\n\n  public stop(): void {\n    this._actor.visible = true;\n    this._stopped = true;\n  }\n\n  public reset() {\n    this._started = false;\n    this._elapsedTime = 0;\n    this._totalTime = 0;\n  }\n}\n","import { Actor } from '../../Actor';\nimport { Logger } from '../../Util/Log';\nimport { Action } from '../Action';\n\nexport class Fade implements Action {\n  public x: number;\n  public y: number;\n\n  private _actor: Actor;\n  private _endOpacity: number;\n  private _speed: number;\n  private _multiplier: number = 1;\n  private _started = false;\n  private _stopped = false;\n\n  constructor(actor: Actor, endOpacity: number, speed: number) {\n    this._actor = actor;\n    this._endOpacity = endOpacity;\n    this._speed = speed;\n  }\n\n  public update(delta: number): void {\n    if (!this._started) {\n      this._started = true;\n\n      // determine direction when we start\n      if (this._endOpacity < this._actor.opacity) {\n        this._multiplier = -1;\n      } else {\n        this._multiplier = 1;\n      }\n    }\n\n    if (this._speed > 0) {\n      this._actor.opacity += (this._multiplier * (Math.abs(this._actor.opacity - this._endOpacity) * delta)) / this._speed;\n    }\n\n    this._speed -= delta;\n\n    if (this.isComplete()) {\n      this._actor.opacity = this._endOpacity;\n    }\n\n    Logger.getInstance().debug('[Action fade] Actor opacity:', this._actor.opacity);\n  }\n\n  public isComplete(): boolean {\n    return this._stopped || Math.abs(this._actor.opacity - this._endOpacity) < 0.05;\n  }\n\n  public stop(): void {\n    this._stopped = true;\n  }\n\n  public reset(): void {\n    this._started = false;\n  }\n}\n","import { Actor } from '../../Actor';\nimport { Action } from '../Action';\n\nexport class Delay implements Action {\n  public x: number;\n  public y: number;\n  private _actor: Actor;\n  private _elapsedTime: number = 0;\n  private _delay: number;\n  private _started: boolean = false;\n  private _stopped = false;\n  constructor(actor: Actor, delay: number) {\n    this._actor = actor;\n    this._delay = delay;\n  }\n\n  public update(delta: number): void {\n    if (!this._started) {\n      this._started = true;\n    }\n\n    this.x = this._actor.pos.x;\n    this.y = this._actor.pos.y;\n\n    this._elapsedTime += delta;\n  }\n\n  isComplete(): boolean {\n    return this._stopped || this._elapsedTime >= this._delay;\n  }\n\n  public stop(): void {\n    this._stopped = true;\n  }\n\n  reset(): void {\n    this._elapsedTime = 0;\n    this._started = false;\n  }\n}\n","import { Actor } from '../../Actor';\nimport { Action } from '../Action';\n\nexport class Die implements Action {\n  public x: number;\n  public y: number;\n\n  private _actor: Actor;\n  private _stopped = false;\n\n  constructor(actor: Actor) {\n    this._actor = actor;\n  }\n\n  public update(_delta: number): void {\n    this._actor.actions.clearActions();\n    this._actor.kill();\n    this._stopped = true;\n  }\n\n  public isComplete(): boolean {\n    return this._stopped;\n  }\n\n  public stop(): void {\n    return;\n  }\n\n  public reset(): void {\n    return;\n  }\n}\n","import { Actor } from '../../Actor';\nimport { vec, Vector } from '../../Math/vector';\nimport { Action } from '../Action';\n\nexport class Follow implements Action {\n  private _actor: Actor;\n  private _actorToFollow: Actor;\n  public x: number;\n  public y: number;\n  private _current: Vector;\n  private _end: Vector;\n  private _dir: Vector;\n  private _speed: number;\n  private _maximumDistance: number;\n  private _distanceBetween: number;\n  private _started = false;\n  private _stopped = false;\n\n  constructor(actor: Actor, actorToFollow: Actor, followDistance?: number) {\n    this._actor = actor;\n    this._actorToFollow = actorToFollow;\n    this._current = new Vector(this._actor.pos.x, this._actor.pos.y);\n    this._end = new Vector(actorToFollow.pos.x, actorToFollow.pos.y);\n    this._maximumDistance = followDistance !== undefined ? followDistance : this._current.distance(this._end);\n    this._speed = 0;\n  }\n\n  public update(_delta: number): void {\n    if (!this._started) {\n      this._started = true;\n      this._distanceBetween = this._current.distance(this._end);\n      this._dir = this._end.sub(this._current).normalize();\n    }\n\n    const actorToFollowSpeed = Math.sqrt(Math.pow(this._actorToFollow.vel.x, 2) + Math.pow(this._actorToFollow.vel.y, 2));\n    if (actorToFollowSpeed !== 0) {\n      this._speed = actorToFollowSpeed;\n    }\n    this._current = vec(this._actor.pos.x, this._actor.pos.y);\n\n    this._end = vec(this._actorToFollow.pos.x, this._actorToFollow.pos.y);\n    this._distanceBetween = this._current.distance(this._end);\n    this._dir = this._end.sub(this._current).normalize();\n\n    if (this._distanceBetween >= this._maximumDistance) {\n      const m = this._dir.scale(this._speed);\n      this._actor.vel = vec(m.x, m.y);\n    } else {\n      this._actor.vel = vec(0, 0);\n    }\n\n    if (this.isComplete()) {\n      this._actor.pos = vec(this._end.x, this._end.y);\n      this._actor.vel = vec(0, 0);\n    }\n  }\n\n  public stop(): void {\n    this._actor.vel = vec(0, 0);\n    this._stopped = true;\n  }\n\n  public isComplete(): boolean {\n    // the actor following should never stop unless specified to do so\n    return this._stopped;\n  }\n\n  public reset(): void {\n    this._started = false;\n  }\n}\n","import { Actor } from '../../Actor';\nimport { Vector, vec } from '../../Math/vector';\nimport { Action } from '../Action';\n\nexport class Meet implements Action {\n  private _actor: Actor;\n  private _actorToMeet: Actor;\n  public x: number;\n  public y: number;\n  private _current: Vector;\n  private _end: Vector;\n  private _dir: Vector;\n  private _speed: number;\n  private _distanceBetween: number;\n  private _started = false;\n  private _stopped = false;\n  private _speedWasSpecified = false;\n\n  constructor(actor: Actor, actorToMeet: Actor, speed?: number) {\n    this._actor = actor;\n    this._actorToMeet = actorToMeet;\n    this._current = new Vector(this._actor.pos.x, this._actor.pos.y);\n    this._end = new Vector(actorToMeet.pos.x, actorToMeet.pos.y);\n    this._speed = speed || 0;\n\n    if (speed !== undefined) {\n      this._speedWasSpecified = true;\n    }\n  }\n\n  public update(_delta: number): void {\n    if (!this._started) {\n      this._started = true;\n      this._distanceBetween = this._current.distance(this._end);\n      this._dir = this._end.sub(this._current).normalize();\n    }\n\n    const actorToMeetSpeed = Math.sqrt(Math.pow(this._actorToMeet.vel.x, 2) + Math.pow(this._actorToMeet.vel.y, 2));\n    if (actorToMeetSpeed !== 0 && !this._speedWasSpecified) {\n      this._speed = actorToMeetSpeed;\n    }\n    this._current = vec(this._actor.pos.x, this._actor.pos.y);\n\n    this._end = vec(this._actorToMeet.pos.x, this._actorToMeet.pos.y);\n    this._distanceBetween = this._current.distance(this._end);\n    this._dir = this._end.sub(this._current).normalize();\n\n    const m = this._dir.scale(this._speed);\n    this._actor.vel = vec(m.x, m.y);\n\n    if (this.isComplete()) {\n      this._actor.pos = vec(this._end.x, this._end.y);\n      this._actor.vel = vec(0, 0);\n    }\n  }\n\n  public isComplete(): boolean {\n    return this._stopped || this._distanceBetween <= 1;\n  }\n\n  public stop(): void {\n    this._actor.vel = vec(0, 0);\n    this._stopped = true;\n  }\n\n  public reset(): void {\n    this._started = false;\n  }\n}\n","import { RotationType } from './RotationType';\n\nimport { Actor } from '../Actor';\nimport { EasingFunction, EasingFunctions } from '../Util/EasingFunctions';\nimport { ActionQueue } from './ActionQueue';\nimport { Repeat } from './Action/Repeat';\nimport { RepeatForever } from './Action/RepeatForever';\nimport { MoveBy } from './Action/MoveBy';\nimport { MoveTo } from './Action/MoveTo';\nimport { RotateTo } from './Action/RotateTo';\nimport { RotateBy } from './Action/RotateBy';\nimport { ScaleTo } from './Action/ScaleTo';\nimport { ScaleBy } from './Action/ScaleBy';\nimport { CallMethod } from './Action/CallMethod';\nimport { EaseTo } from './Action/EaseTo';\nimport { Blink } from './Action/Blink';\nimport { Fade } from './Action/Fade';\nimport { Delay } from './Action/Delay';\nimport { Die } from './Action/Die';\nimport { Follow } from './Action/Follow';\nimport { Meet } from './Action/Meet';\nimport { Vector } from '..';\n\n/**\n * The fluent Action API allows you to perform \"actions\" on\n * [[Actor|Actors]] such as following, moving, rotating, and\n * more. You can implement your own actions by implementing\n * the [[Action]] interface.\n */\nexport class ActionContext {\n  private _actor: Actor;\n  private _queue: ActionQueue;\n\n  constructor(actor: Actor) {\n    this._actor = actor;\n    this._queue = new ActionQueue(actor);\n  }\n\n  public getQueue(): ActionQueue {\n    return this._queue;\n  }\n\n  public update(elapsedMs: number) {\n    this._queue.update(elapsedMs);\n  }\n\n  /**\n   * Clears all queued actions from the Actor\n   */\n  public clearActions(): void {\n    this._queue.clearActions();\n  }\n\n  /**\n   * This method will move an actor to the specified `x` and `y` position over the\n   * specified duration using a given [[EasingFunctions]] and return back the actor. This\n   * method is part of the actor 'Action' fluent API allowing action chaining.\n   * @param pos       The x,y vector location to move the actor to\n   * @param duration  The time it should take the actor to move to the new location in milliseconds\n   * @param easingFcn Use [[EasingFunctions]] or a custom function to use to calculate position, Default is [[EasingFunctions.Linear]]\n   */\n  public easeTo(pos: Vector, duration: number, easingFcn?: EasingFunction): ActionContext\n  /**\n   * This method will move an actor to the specified `x` and `y` position over the\n   * specified duration using a given [[EasingFunctions]] and return back the actor. This\n   * method is part of the actor 'Action' fluent API allowing action chaining.\n   * @param x         The x location to move the actor to\n   * @param y         The y location to move the actor to\n   * @param duration  The time it should take the actor to move to the new location in milliseconds\n   * @param easingFcn Use [[EasingFunctions]] or a custom function to use to calculate position, Default is [[EasingFunctions.Linear]]\n   */\n  public easeTo(x: number, y: number, duration: number, easingFcn?: EasingFunction): ActionContext\n  public easeTo(...args: any[]): ActionContext {\n    let x = 0;\n    let y = 0;\n    let duration = 0;\n    let easingFcn = EasingFunctions.Linear;\n    if (args[0] instanceof Vector) {\n      x = args[0].x;\n      y = args[0].y;\n      duration = args[1];\n      easingFcn = args[2] ?? easingFcn;\n    } else {\n      x = args[0];\n      y = args[1];\n      duration = args[2];\n      easingFcn = args[3] ?? easingFcn;\n    }\n\n    this._queue.add(new EaseTo(this._actor, x, y, duration, easingFcn));\n    return this;\n  }\n\n  /**\n   * This method will move an actor to the specified x and y position at the\n   * speed specified (in pixels per second) and return back the actor. This\n   * method is part of the actor 'Action' fluent API allowing action chaining.\n   * @param pos    The x,y vector location to move the actor to\n   * @param speed  The speed in pixels per second to move\n   */\n  public moveTo(pos: Vector, speed: number): ActionContext;\n  /**\n   * This method will move an actor to the specified x and y position at the\n   * speed specified (in pixels per second) and return back the actor. This\n   * method is part of the actor 'Action' fluent API allowing action chaining.\n   * @param x      The x location to move the actor to\n   * @param y      The y location to move the actor to\n   * @param speed  The speed in pixels per second to move\n   */\n  public moveTo(x: number, y: number, speed: number): ActionContext;\n  public moveTo(xOrPos: number | Vector, yOrSpeed: number, speedOrUndefined?: number | undefined): ActionContext {\n    let x = 0;\n    let y = 0;\n    let speed = 0;\n    if (xOrPos instanceof Vector) {\n      x = xOrPos.x;\n      y = xOrPos.y;\n      speed = yOrSpeed;\n    } else {\n      x = xOrPos;\n      y = yOrSpeed;\n      speed = speedOrUndefined;\n    }\n    this._queue.add(new MoveTo(this._actor, x, y, speed));\n    return this;\n  }\n\n  /**\n   * This method will move an actor by the specified x offset and y offset from its current position, at a certain speed.\n   * This method is part of the actor 'Action' fluent API allowing action chaining.\n   * @param xOffset     The x offset to apply to this actor\n   * @param yOffset     The y location to move the actor to\n   * @param speed  The speed in pixels per second the actor should move\n   */\n  public moveBy(offset: Vector, speed: number): ActionContext;\n  public moveBy(xOffset: number, yOffset: number, speed: number): ActionContext;\n  public moveBy(xOffsetOrVector: number | Vector, yOffsetOrSpeed: number, speedOrUndefined?: number | undefined): ActionContext {\n    let xOffset = 0;\n    let yOffset = 0;\n    let speed = 0;\n    if (xOffsetOrVector instanceof Vector) {\n      xOffset = xOffsetOrVector.x;\n      yOffset = xOffsetOrVector.y;\n      speed = yOffsetOrSpeed;\n    } else {\n      xOffset = xOffsetOrVector;\n      yOffset = yOffsetOrSpeed;\n      speed = speedOrUndefined;\n    }\n    this._queue.add(new MoveBy(this._actor, xOffset, yOffset, speed));\n    return this;\n  }\n\n  /**\n   * This method will rotate an actor to the specified angle at the speed\n   * specified (in radians per second) and return back the actor. This\n   * method is part of the actor 'Action' fluent API allowing action chaining.\n   * @param angleRadians  The angle to rotate to in radians\n   * @param speed         The angular velocity of the rotation specified in radians per second\n   * @param rotationType  The [[RotationType]] to use for this rotation\n   */\n  public rotateTo(angleRadians: number, speed: number, rotationType?: RotationType): ActionContext {\n    this._queue.add(new RotateTo(this._actor, angleRadians, speed, rotationType));\n    return this;\n  }\n\n  /**\n   * This method will rotate an actor by the specified angle offset, from it's current rotation given a certain speed\n   * in radians/sec and return back the actor. This method is part\n   * of the actor 'Action' fluent API allowing action chaining.\n   * @param angleRadiansOffset  The angle to rotate to in radians relative to the current rotation\n   * @param speed          The speed in radians/sec the actor should rotate at\n   * @param rotationType  The [[RotationType]] to use for this rotation, default is shortest path\n   */\n  public rotateBy(angleRadiansOffset: number, speed: number, rotationType?: RotationType): ActionContext {\n    this._queue.add(new RotateBy(this._actor, angleRadiansOffset, speed, rotationType));\n    return this;\n  }\n\n  /**\n   * This method will scale an actor to the specified size at the speed\n   * specified (in magnitude increase per second) and return back the\n   * actor. This method is part of the actor 'Action' fluent API allowing\n   * action chaining.\n   * @param size    The scale to adjust the actor to over time\n   * @param speed   The speed of scaling specified in magnitude increase per second\n   */\n  public scaleTo(size: Vector, speed: Vector): ActionContext;\n  /**\n   * This method will scale an actor to the specified size at the speed\n   * specified (in magnitude increase per second) and return back the\n   * actor. This method is part of the actor 'Action' fluent API allowing\n   * action chaining.\n   * @param sizeX   The scaling factor to apply on X axis\n   * @param sizeY   The scaling factor to apply on Y axis\n   * @param speedX  The speed of scaling specified in magnitude increase per second on X axis\n   * @param speedY  The speed of scaling specified in magnitude increase per second on Y axis\n   */\n  public scaleTo(sizeX: number, sizeY: number, speedX: number, speedY: number): ActionContext;\n  public scaleTo(sizeXOrVector: number | Vector,\n    sizeYOrSpeed: number | Vector,\n    speedXOrUndefined?: number | undefined,\n    speedYOrUndefined?: number | undefined): ActionContext {\n\n    let sizeX = 1;\n    let sizeY = 1;\n    let speedX = 0;\n    let speedY = 0;\n\n    if (sizeXOrVector instanceof Vector && sizeYOrSpeed instanceof Vector) {\n      sizeX = sizeXOrVector.x;\n      sizeY = sizeXOrVector.y;\n\n      speedX = sizeYOrSpeed.x;\n      speedY = sizeYOrSpeed.y;\n    }\n    if (typeof sizeXOrVector === 'number' && typeof sizeYOrSpeed === 'number') {\n      sizeX = sizeXOrVector;\n      sizeY = sizeYOrSpeed;\n\n      speedX = speedXOrUndefined;\n      speedY = speedYOrUndefined;\n    }\n\n    this._queue.add(new ScaleTo(this._actor, sizeX, sizeY, speedX, speedY));\n    return this;\n  }\n\n  /**\n   * This method will scale an actor by an amount relative to the current scale at a certain speed in scale units/sec\n   * and return back the actor. This method is part of the\n   * actor 'Action' fluent API allowing action chaining.\n   * @param offset   The scaling factor to apply to the actor\n   * @param speed    The speed to scale at in scale units/sec\n   */\n  public scaleBy(offset: Vector, speed: number): ActionContext;\n  /**\n   * This method will scale an actor by an amount relative to the current scale at a certain speed in scale units/sec\n   * and return back the actor. This method is part of the\n   * actor 'Action' fluent API allowing action chaining.\n   * @param sizeOffsetX   The scaling factor to apply on X axis\n   * @param sizeOffsetY   The scaling factor to apply on Y axis\n   * @param speed    The speed to scale at in scale units/sec\n   */\n  public scaleBy(sizeOffsetX: number, sizeOffsetY: number, speed: number): ActionContext;\n  public scaleBy(sizeOffsetXOrVector: number | Vector, sizeOffsetYOrSpeed: number, speed?: number | undefined): ActionContext {\n    let sizeOffsetX = 1;\n    let sizeOffsetY = 1;\n\n    if (sizeOffsetXOrVector instanceof Vector) {\n      sizeOffsetX = sizeOffsetXOrVector.x;\n      sizeOffsetY = sizeOffsetXOrVector.y;\n\n      speed = sizeOffsetYOrSpeed;\n    }\n    if (typeof sizeOffsetXOrVector === 'number' && typeof sizeOffsetYOrSpeed === 'number') {\n      sizeOffsetX = sizeOffsetXOrVector;\n      sizeOffsetY = sizeOffsetYOrSpeed;\n    }\n\n    this._queue.add(new ScaleBy(this._actor, sizeOffsetX, sizeOffsetY, speed));\n    return this;\n  }\n\n  /**\n   * This method will cause an actor to blink (become visible and not\n   * visible). Optionally, you may specify the number of blinks. Specify the amount of time\n   * the actor should be visible per blink, and the amount of time not visible.\n   * This method is part of the actor 'Action' fluent API allowing action chaining.\n   * @param timeVisible     The amount of time to stay visible per blink in milliseconds\n   * @param timeNotVisible  The amount of time to stay not visible per blink in milliseconds\n   * @param numBlinks       The number of times to blink\n   */\n  public blink(timeVisible: number, timeNotVisible: number, numBlinks: number = 1): ActionContext {\n    this._queue.add(new Blink(this._actor, timeVisible, timeNotVisible, numBlinks));\n    return this;\n  }\n\n  /**\n   * This method will cause an actor's opacity to change from its current value\n   * to the provided value by a specified time (in milliseconds). This method is\n   * part of the actor 'Action' fluent API allowing action chaining.\n   * @param opacity  The ending opacity\n   * @param time     The time it should take to fade the actor (in milliseconds)\n   */\n  public fade(opacity: number, time: number): ActionContext {\n    this._queue.add(new Fade(this._actor, opacity, time));\n    return this;\n  }\n\n  /**\n   * This method will delay the next action from executing for a certain\n   * amount of time (in milliseconds). This method is part of the actor\n   * 'Action' fluent API allowing action chaining.\n   * @param time  The amount of time to delay the next action in the queue from executing in milliseconds\n   */\n  public delay(time: number): ActionContext {\n    this._queue.add(new Delay(this._actor, time));\n    return this;\n  }\n\n  /**\n   * This method will add an action to the queue that will remove the actor from the\n   * scene once it has completed its previous  Any actions on the\n   * action queue after this action will not be executed.\n   */\n  public die(): ActionContext {\n    this._queue.add(new Die(this._actor));\n    return this;\n  }\n\n  /**\n   * This method allows you to call an arbitrary method as the next action in the\n   * action queue. This is useful if you want to execute code in after a specific\n   * action, i.e An actor arrives at a destination after traversing a path\n   */\n  public callMethod(method: () => any): ActionContext {\n    this._queue.add(new CallMethod(method));\n    return this;\n  }\n\n  /**\n   * This method will cause the actor to repeat all of the actions built in\n   * the `repeatBuilder` callback. If the number of repeats\n   * is not specified it will repeat forever. This method is part of\n   * the actor 'Action' fluent API allowing action chaining\n   *\n   * ```typescript\n   * // Move up in a zig-zag by repeated moveBy's\n   * actor.actions.repeat(repeatCtx => {\n   *  repeatCtx.moveBy(10, 0, 10);\n   *  repeatCtx.moveBy(0, 10, 10);\n   * }, 5);\n   * ```\n   *\n   * @param repeatBuilder The builder to specify the repeatable list of actions\n   * @param times  The number of times to repeat all the previous actions in the action queue. If nothing is specified the actions\n   * will repeat forever\n   */\n  public repeat(repeatBuilder: (repeatContext: ActionContext) => any, times?: number): ActionContext {\n    if (!times) {\n      this.repeatForever(repeatBuilder);\n      return this;\n    }\n    this._queue.add(new Repeat(this._actor, repeatBuilder, times));\n\n    return this;\n  }\n\n  /**\n   * This method will cause the actor to repeat all of the actions built in\n   * the `repeatBuilder` callback. If the number of repeats\n   * is not specified it will repeat forever. This method is part of\n   * the actor 'Action' fluent API allowing action chaining\n   *\n   * ```typescript\n   * // Move up in a zig-zag by repeated moveBy's\n   * actor.actions.repeat(repeatCtx => {\n   *  repeatCtx.moveBy(10, 0, 10);\n   *  repeatCtx.moveBy(0, 10, 10);\n   * }, 5);\n   * ```\n   *\n   * @param repeatBuilder The builder to specify the repeatable list of actions\n   */\n  public repeatForever(repeatBuilder: (repeatContext: ActionContext) => any): ActionContext {\n    this._queue.add(new RepeatForever(this._actor, repeatBuilder));\n    return this;\n  }\n\n  /**\n   * This method will cause the actor to follow another at a specified distance\n   * @param actor           The actor to follow\n   * @param followDistance  The distance to maintain when following, if not specified the actor will follow at the current distance.\n   */\n  public follow(actor: Actor, followDistance?: number): ActionContext {\n    if (followDistance === undefined) {\n      this._queue.add(new Follow(this._actor, actor));\n    } else {\n      this._queue.add(new Follow(this._actor, actor, followDistance));\n    }\n    return this;\n  }\n\n  /**\n   * This method will cause the actor to move towards another until they\n   * collide \"meet\" at a specified speed.\n   * @param actor  The actor to meet\n   * @param speed  The speed in pixels per second to move, if not specified it will match the speed of the other actor\n   */\n  public meet(actor: Actor, speed?: number): ActionContext {\n    if (speed === undefined) {\n      this._queue.add(new Meet(this._actor, actor));\n    } else {\n      this._queue.add(new Meet(this._actor, actor, speed));\n    }\n    return this;\n  }\n\n  /**\n   * Returns a promise that resolves when the current action queue up to now\n   * is finished.\n   */\n  public asPromise(): Promise<void> {\n    const temp = new Promise<void>((resolve) => {\n      this._queue.add(\n        new CallMethod(() => {\n          resolve();\n        })\n      );\n    });\n    return temp;\n  }\n}\n","/**\n * CollisionGroups indicate like members that do not collide with each other. Use [[CollisionGroupManager]] to create [[CollisionGroup]]s\n *\n * For example:\n *\n * Players have collision group \"player\"\n *\n * ![Player Collision Group](/assets/images/docs/CollisionGroupsPlayer.png)\n *\n * Enemies have collision group \"enemy\"\n *\n * ![Enemy Collision Group](/assets/images/docs/CollisionGroupsEnemy.png)\n *\n * Blocks have collision group \"ground\"\n *\n * ![Ground collision group](/assets/images/docs/CollisionGroupsGround.png)\n *\n * Players don't collide with each other, but enemies and blocks. Likewise, enemies don't collide with each other but collide\n * with players and blocks.\n *\n * This is done with bitmasking, see the following pseudo-code\n *\n * PlayerGroup = `0b001`\n * PlayerGroupMask = `0b110`\n *\n * EnemyGroup = `0b010`\n * EnemyGroupMask = `0b101`\n *\n * BlockGroup = `0b100`\n * BlockGroupMask = `0b011`\n *\n * Should Players collide? No because the bitwise mask evaluates to 0\n * `(player1.group & player2.mask) === 0`\n * `(0b001 & 0b110) === 0`\n *\n * Should Players and Enemies collide? Yes because the bitwise mask is non-zero\n * `(player1.group & enemy1.mask) === 1`\n * `(0b001 & 0b101) === 1`\n *\n * Should Players and Blocks collide? Yes because the bitwise mask is non-zero\n * `(player1.group & blocks1.mask) === 1`\n * `(0b001 & 0b011) === 1`\n */\nexport class CollisionGroup {\n  /**\n   * The `All` [[CollisionGroup]] is a special group that collides with all other groups including itself,\n   * it is the default collision group on colliders.\n   */\n  public static All = new CollisionGroup('Collide with all groups', -1, -1);\n\n  private _name: string;\n  private _category: number;\n  private _mask: number;\n\n  /**\n   * STOP!!** It is preferred that [[CollisionGroupManager.create]] is used to create collision groups\n   *  unless you know how to construct the proper bitmasks. See https://github.com/excaliburjs/Excalibur/issues/1091 for more info.\n   * @param name Name of the collision group\n   * @param category 32 bit category for the group, should be a unique power of 2. For example `0b001` or `0b010`\n   * @param mask 32 bit mask of category, or `~category` generally. For a category of `0b001`, the mask would be `0b110`\n   */\n  constructor(name: string, category: number, mask: number) {\n    this._name = name;\n    this._category = category;\n    this._mask = mask;\n  }\n\n  /**\n   * Get the name of the collision group\n   */\n  public get name() {\n    return this._name;\n  }\n\n  /**\n   * Get the category of the collision group, a 32 bit number which should be a unique power of 2\n   */\n  public get category() {\n    return this._category;\n  }\n\n  /**\n   * Get the mask for this collision group\n   */\n  public get mask() {\n    return this._mask;\n  }\n\n  /**\n   * Evaluates whether 2 collision groups can collide\n   * @param other  CollisionGroup\n   */\n  public canCollide(other: CollisionGroup): boolean {\n    return (this.category & other.mask) !== 0 && (other.category & this.mask) !== 0;\n  }\n\n  /**\n   * Inverts the collision group. For example, if before the group specified \"players\",\n   * inverting would specify all groups except players\n   * @returns CollisionGroup\n   */\n  public invert(): CollisionGroup {\n    return new CollisionGroup('~(' + this.name + ')', ~this.category, ~this.mask);\n  }\n\n  /**\n   * Combine collision groups with each other. The new group includes all of the previous groups.\n   *\n   * @param collisionGroups\n   * @returns\n   */\n  public static combine(collisionGroups: CollisionGroup[]) {\n    const combinedName = collisionGroups.map((c) => c.name).join('+');\n    const combinedCategory = collisionGroups.reduce((current, g) => g.category | current, 0b0);\n    const combinedMask = ~combinedCategory;\n\n    return new CollisionGroup(combinedName, combinedCategory, combinedMask);\n  }\n\n  /**\n   * Creates a collision group that collides with the listed groups\n   * @param collisionGroups\n   */\n  public static collidesWith(collisionGroups: CollisionGroup[]) {\n    return CollisionGroup.combine(collisionGroups).invert();\n  }\n}\n","/**\n * Defines a generic message that can contain any data\n * @template T is the typescript Type of the data\n */\nexport interface Message<T> {\n  type: string;\n  data: T;\n}\n\n/**\n * Defines an interface for an observer to receive a message via a notify() method\n */\nexport interface Observer<T> {\n  notify(message: T): void;\n}\n\n/**\n * Defines an interface for something that might be an observer if a notify() is present\n */\nexport type MaybeObserver<T> = Partial<Observer<T>>;\n\n/**\n * Simple Observable implemenation\n * @template T is the typescript Type that defines the data being observed\n */\nexport class Observable<T> {\n  public observers: Observer<T>[] = [];\n  public subscriptions: ((val: T) => any)[] = [];\n\n  /**\n   * Register an observer to listen to this observable\n   * @param observer\n   */\n  register(observer: Observer<T>) {\n    this.observers.push(observer);\n  }\n\n  /**\n   * Register a callback to listen to this observable\n   * @param func\n   */\n  subscribe(func: (val: T) => any) {\n    this.subscriptions.push(func);\n  }\n\n  /**\n   * Remove an observer from the observable\n   * @param observer\n   */\n  unregister(observer: Observer<T>) {\n    const i = this.observers.indexOf(observer);\n    if (i !== -1) {\n      this.observers.splice(i, 1);\n    }\n  }\n\n  /**\n   * Remove a callback that is listening to this observable\n   * @param func\n   */\n  unsubscribe(func: (val: T) => any) {\n    const i = this.subscriptions.indexOf(func);\n    if (i !== -1) {\n      this.subscriptions.splice(i, 1);\n    }\n  }\n\n  /**\n   * Broadcasts a message to all observers and callbacks\n   * @param message\n   */\n  notifyAll(message: T) {\n    this.observers.forEach((o) => o.notify(message));\n    this.subscriptions.forEach(cb => cb(message));\n  }\n\n  /**\n   * Removes all observers and callbacks\n   */\n  clear() {\n    this.observers.length = 0;\n    this.subscriptions.length = 0;\n  }\n}\n","import { CollisionContact } from './CollisionContact';\nimport { CollisionType } from '../CollisionType';\nimport { BodyComponent } from '../BodyComponent';\nimport { Id } from '../../Id';\nimport { Collider } from '../Colliders/Collider';\n\n/**\n * Models a potential collision between 2 colliders\n */\nexport class Pair {\n  public id: string = null;\n  constructor(public colliderA: Collider, public colliderB: Collider) {\n    this.id = Pair.calculatePairHash(colliderA.id, colliderB.id);\n  }\n\n  public static canCollide(colliderA: Collider, colliderB: Collider) {\n    const bodyA = colliderA?.owner?.get(BodyComponent);\n    const bodyB = colliderB?.owner?.get(BodyComponent);\n\n    // Body's needed for collision in the current state\n    // TODO can we collide without a body?\n    if (!bodyA || !bodyB) {\n      return false;\n    }\n\n    // If both are in the same collision group short circuit\n    if (!bodyA.group.canCollide(bodyB.group)) {\n      return false;\n    }\n\n    // if both are fixed short circuit\n    if (bodyA.collisionType === CollisionType.Fixed && bodyB.collisionType === CollisionType.Fixed) {\n      return false;\n    }\n\n    // if the either is prevent collision short circuit\n    if (bodyB.collisionType === CollisionType.PreventCollision || bodyA.collisionType === CollisionType.PreventCollision) {\n      return false;\n    }\n\n    // if either is dead short circuit\n    if (!bodyA.active || !bodyB.active) {\n      return false;\n    }\n\n    return true;\n  }\n\n  /**\n   * Returns whether or not it is possible for the pairs to collide\n   */\n  public get canCollide(): boolean {\n    const colliderA = this.colliderA;\n    const colliderB = this.colliderB;\n    return Pair.canCollide(colliderA, colliderB);\n  }\n\n  /**\n   * Runs the collision intersection logic on the members of this pair\n   */\n  public collide(): CollisionContact[] {\n    return this.colliderA.collide(this.colliderB);\n  }\n\n  /**\n   * Check if the collider is part of the pair\n   * @param collider\n   * @returns\n   */\n  public hasCollider(collider: Collider) {\n    return collider === this.colliderA || collider === this.colliderB;\n  }\n\n  /**\n   * Calculates the unique pair hash id for this collision pair (owning id)\n   */\n  public static calculatePairHash(idA: Id<'collider'>, idB: Id<'collider'>): string {\n    if (idA.value < idB.value) {\n      return `#${idA.value}+${idB.value}`;\n    } else {\n      return `#${idB.value}+${idA.value}`;\n    }\n  }\n}\n","/**\n * A 1 dimensional projection on an axis, used to test overlaps\n */\n\nexport class Projection {\n  constructor(public min: number, public max: number) {}\n  public overlaps(projection: Projection): boolean {\n    return this.max > projection.min && projection.max > this.min;\n  }\n\n  public getOverlap(projection: Projection): number {\n    if (this.overlaps(projection)) {\n      if (this.max > projection.max) {\n        return projection.max - this.min;\n      } else {\n        return this.max - projection.min;\n      }\n    }\n    return 0;\n  }\n}\n","import { Physics } from '../Physics';\nimport { BoundingBox } from '../BoundingBox';\n\nimport { Ray } from '../../Math/ray';\nimport { Logger } from '../../Util/Log';\nimport { Id } from '../../Id';\nimport { Entity } from '../../EntityComponentSystem/Entity';\nimport { BodyComponent } from '../BodyComponent';\nimport { Color, ExcaliburGraphicsContext } from '../..';\n\n/**\n * Dynamic Tree Node used for tracking bounds within the tree\n */\nexport class TreeNode<T> {\n  public left: TreeNode<T>;\n  public right: TreeNode<T>;\n  public bounds: BoundingBox;\n  public height: number;\n  public data: T;\n  constructor(public parent?: TreeNode<T>) {\n    this.parent = parent || null;\n    this.data = null;\n    this.bounds = new BoundingBox();\n    this.left = null;\n    this.right = null;\n    this.height = 0;\n  }\n\n  public isLeaf(): boolean {\n    return !this.left && !this.right;\n  }\n}\n\nexport interface ColliderProxy<T> {\n  id: Id<'collider'>;\n  owner: T;\n  bounds: BoundingBox;\n}\n\n/**\n * The DynamicTrees provides a spatial partitioning data structure for quickly querying for overlapping bounding boxes for\n * all tracked bodies. The worst case performance of this is O(n*log(n)) where n is the number of bodies in the tree.\n *\n * Internally the bounding boxes are organized as a balanced binary tree of bounding boxes, where the leaf nodes are tracked bodies.\n * Every non-leaf node is a bounding box that contains child bounding boxes.\n */\nexport class DynamicTree<T extends ColliderProxy<Entity>> {\n  public root: TreeNode<T>;\n  public nodes: { [key: number]: TreeNode<T> };\n  constructor(public worldBounds: BoundingBox = new BoundingBox(-Number.MAX_VALUE, -Number.MAX_VALUE, Number.MAX_VALUE, Number.MAX_VALUE)) {\n    this.root = null;\n    this.nodes = {};\n  }\n\n  /**\n   * Inserts a node into the dynamic tree\n   */\n  private _insert(leaf: TreeNode<T>): void {\n    // If there are no nodes in the tree, make this the root leaf\n    if (this.root === null) {\n      this.root = leaf;\n      this.root.parent = null;\n      return;\n    }\n\n    // Search the tree for a node that is not a leaf and find the best place to insert\n    const leafAABB = leaf.bounds;\n    let currentRoot = this.root;\n    while (!currentRoot.isLeaf()) {\n      const left = currentRoot.left;\n      const right = currentRoot.right;\n\n      const area = currentRoot.bounds.getPerimeter();\n      const combinedAABB = currentRoot.bounds.combine(leafAABB);\n      const combinedArea = combinedAABB.getPerimeter();\n\n      // Calculate cost heuristic for creating a new parent and leaf\n      const cost = 2 * combinedArea;\n\n      // Minimum cost of pushing the leaf down the tree\n      const inheritanceCost = 2 * (combinedArea - area);\n\n      // Cost of descending\n      let leftCost = 0;\n      const leftCombined = leafAABB.combine(left.bounds);\n      let newArea;\n      let oldArea;\n      if (left.isLeaf()) {\n        leftCost = leftCombined.getPerimeter() + inheritanceCost;\n      } else {\n        oldArea = left.bounds.getPerimeter();\n        newArea = leftCombined.getPerimeter();\n        leftCost = newArea - oldArea + inheritanceCost;\n      }\n\n      let rightCost = 0;\n      const rightCombined = leafAABB.combine(right.bounds);\n      if (right.isLeaf()) {\n        rightCost = rightCombined.getPerimeter() + inheritanceCost;\n      } else {\n        oldArea = right.bounds.getPerimeter();\n        newArea = rightCombined.getPerimeter();\n        rightCost = newArea - oldArea + inheritanceCost;\n      }\n\n      // cost is acceptable\n      if (cost < leftCost && cost < rightCost) {\n        break;\n      }\n\n      // Descend to the depths\n      if (leftCost < rightCost) {\n        currentRoot = left;\n      } else {\n        currentRoot = right;\n      }\n    }\n\n    // Create the new parent node and insert into the tree\n    const oldParent = currentRoot.parent;\n    const newParent = new TreeNode(oldParent);\n    newParent.bounds = leafAABB.combine(currentRoot.bounds);\n    newParent.height = currentRoot.height + 1;\n\n    if (oldParent !== null) {\n      // The sibling node was not the root\n      if (oldParent.left === currentRoot) {\n        oldParent.left = newParent;\n      } else {\n        oldParent.right = newParent;\n      }\n\n      newParent.left = currentRoot;\n      newParent.right = leaf;\n\n      currentRoot.parent = newParent;\n      leaf.parent = newParent;\n    } else {\n      // The sibling node was the root\n      newParent.left = currentRoot;\n      newParent.right = leaf;\n\n      currentRoot.parent = newParent;\n      leaf.parent = newParent;\n      this.root = newParent;\n    }\n\n    // Walk up the tree fixing heights and AABBs\n    let currentNode = leaf.parent;\n    while (currentNode) {\n      currentNode = this._balance(currentNode);\n\n      if (!currentNode.left) {\n        throw new Error('Parent of current leaf cannot have a null left child' + currentNode);\n      }\n      if (!currentNode.right) {\n        throw new Error('Parent of current leaf cannot have a null right child' + currentNode);\n      }\n\n      currentNode.height = 1 + Math.max(currentNode.left.height, currentNode.right.height);\n      currentNode.bounds = currentNode.left.bounds.combine(currentNode.right.bounds);\n\n      currentNode = currentNode.parent;\n    }\n  }\n\n  /**\n   * Removes a node from the dynamic tree\n   */\n  private _remove(leaf: TreeNode<T>) {\n    if (leaf === this.root) {\n      this.root = null;\n      return;\n    }\n\n    const parent = leaf.parent;\n    const grandParent = parent.parent;\n    let sibling: TreeNode<T>;\n    if (parent.left === leaf) {\n      sibling = parent.right;\n    } else {\n      sibling = parent.left;\n    }\n\n    if (grandParent) {\n      if (grandParent.left === parent) {\n        grandParent.left = sibling;\n      } else {\n        grandParent.right = sibling;\n      }\n      sibling.parent = grandParent;\n\n      let currentNode = grandParent;\n      while (currentNode) {\n        currentNode = this._balance(currentNode);\n        currentNode.bounds = currentNode.left.bounds.combine(currentNode.right.bounds);\n        currentNode.height = 1 + Math.max(currentNode.left.height, currentNode.right.height);\n\n        currentNode = currentNode.parent;\n      }\n    } else {\n      this.root = sibling;\n      sibling.parent = null;\n    }\n  }\n\n  /**\n   * Tracks a body in the dynamic tree\n   */\n  public trackCollider(collider: T) {\n    const node = new TreeNode<T>();\n    node.data = collider;\n    node.bounds = collider.bounds;\n    node.bounds.left -= 2;\n    node.bounds.top -= 2;\n    node.bounds.right += 2;\n    node.bounds.bottom += 2;\n    this.nodes[collider.id.value] = node;\n    this._insert(node);\n  }\n\n  /**\n   * Updates the dynamic tree given the current bounds of each body being tracked\n   */\n  public updateCollider(collider: T) {\n    const node = this.nodes[collider.id.value];\n    if (!node) {\n      return false;\n    }\n    const b = collider.bounds;\n\n    // if the body is outside the world no longer update it\n    if (!this.worldBounds.contains(b)) {\n      Logger.getInstance().warn(\n        'Collider with id ' + collider.id.value + ' is outside the world bounds and will no longer be tracked for physics'\n      );\n      this.untrackCollider(collider);\n      return false;\n    }\n\n    if (node.bounds.contains(b)) {\n      return false;\n    }\n\n    this._remove(node);\n    b.left -= Physics.boundsPadding;\n    b.top -= Physics.boundsPadding;\n    b.right += Physics.boundsPadding;\n    b.bottom += Physics.boundsPadding;\n\n    // THIS IS CAUSING UNECESSARY CHECKS\n    if (collider.owner) {\n      const body = collider.owner?.get(BodyComponent);\n      if (body) {\n        const multdx = ((body.vel.x * 32) / 1000) * Physics.dynamicTreeVelocityMultiplier;\n        const multdy = ((body.vel.y * 32) / 1000) * Physics.dynamicTreeVelocityMultiplier;\n\n        if (multdx < 0) {\n          b.left += multdx;\n        } else {\n          b.right += multdx;\n        }\n\n        if (multdy < 0) {\n          b.top += multdy;\n        } else {\n          b.bottom += multdy;\n        }\n      }\n    }\n\n    node.bounds = b;\n    this._insert(node);\n    return true;\n  }\n\n  /**\n   * Untracks a body from the dynamic tree\n   */\n  public untrackCollider(collider: T) {\n    const node = this.nodes[collider.id.value];\n    if (!node) {\n      return;\n    }\n    this._remove(node);\n    this.nodes[collider.id.value] = null;\n    delete this.nodes[collider.id.value];\n  }\n\n  /**\n   * Balances the tree about a node\n   */\n  private _balance(node: TreeNode<T>) {\n    if (node === null) {\n      throw new Error('Cannot balance at null node');\n    }\n\n    if (node.isLeaf() || node.height < 2) {\n      return node;\n    }\n\n    const left = node.left;\n    const right = node.right;\n\n    const a = node;\n    const b = left;\n    const c = right;\n    const d = left.left;\n    const e = left.right;\n    const f = right.left;\n    const g = right.right;\n\n    const balance = c.height - b.height;\n    // Rotate c node up\n    if (balance > 1) {\n      // Swap the right node with it's parent\n      c.left = a;\n      c.parent = a.parent;\n      a.parent = c;\n\n      // The original node's old parent should point to the right node\n      // this is mega confusing\n      if (c.parent) {\n        if (c.parent.left === a) {\n          c.parent.left = c;\n        } else {\n          c.parent.right = c;\n        }\n      } else {\n        this.root = c;\n      }\n\n      // Rotate\n      if (f.height > g.height) {\n        c.right = f;\n        a.right = g;\n        g.parent = a;\n\n        a.bounds = b.bounds.combine(g.bounds);\n        c.bounds = a.bounds.combine(f.bounds);\n\n        a.height = 1 + Math.max(b.height, g.height);\n        c.height = 1 + Math.max(a.height, f.height);\n      } else {\n        c.right = g;\n        a.right = f;\n        f.parent = a;\n\n        a.bounds = b.bounds.combine(f.bounds);\n        c.bounds = a.bounds.combine(g.bounds);\n\n        a.height = 1 + Math.max(b.height, f.height);\n        c.height = 1 + Math.max(a.height, g.height);\n      }\n\n      return c;\n    }\n    // Rotate left node up\n    if (balance < -1) {\n      // swap\n      b.left = a;\n      b.parent = a.parent;\n      a.parent = b;\n\n      // node's old parent should point to b\n      if (b.parent) {\n        if (b.parent.left === a) {\n          b.parent.left = b;\n        } else {\n          if (b.parent.right !== a) {\n            throw 'Error rotating Dynamic Tree';\n          }\n          b.parent.right = b;\n        }\n      } else {\n        this.root = b;\n      }\n\n      // rotate\n      if (d.height > e.height) {\n        b.right = d;\n        a.left = e;\n        e.parent = a;\n\n        a.bounds = c.bounds.combine(e.bounds);\n        b.bounds = a.bounds.combine(d.bounds);\n\n        a.height = 1 + Math.max(c.height, e.height);\n        b.height = 1 + Math.max(a.height, d.height);\n      } else {\n        b.right = e;\n        a.left = d;\n        d.parent = a;\n\n        a.bounds = c.bounds.combine(d.bounds);\n        b.bounds = a.bounds.combine(e.bounds);\n\n        a.height = 1 + Math.max(c.height, d.height);\n        b.height = 1 + Math.max(a.height, e.height);\n      }\n      return b;\n    }\n\n    return node;\n  }\n\n  /**\n   * Returns the internal height of the tree, shorter trees are better. Performance drops as the tree grows\n   */\n  public getHeight(): number {\n    if (this.root === null) {\n      return 0;\n    }\n    return this.root.height;\n  }\n\n  /**\n   * Queries the Dynamic Axis Aligned Tree for bodies that could be colliding with the provided body.\n   *\n   * In the query callback, it will be passed a potential collider. Returning true from this callback indicates\n   * that you are complete with your query and you do not want to continue. Returning false will continue searching\n   * the tree until all possible colliders have been returned.\n   */\n  public query(collider: T, callback: (other: T) => boolean): void {\n    const bounds = collider.bounds;\n    const helper = (currentNode: TreeNode<T>): boolean => {\n      if (currentNode && currentNode.bounds.intersect(bounds)) {\n        if (currentNode.isLeaf() && currentNode.data !== collider) {\n          if (callback.call(collider, currentNode.data)) {\n            return true;\n          }\n        } else {\n          return helper(currentNode.left) || helper(currentNode.right);\n        }\n      }\n      return false;\n    };\n    helper(this.root);\n  }\n\n  /**\n   * Queries the Dynamic Axis Aligned Tree for bodies that could be intersecting. By default the raycast query uses an infinitely\n   * long ray to test the tree specified by `max`.\n   *\n   * In the query callback, it will be passed a potential body that intersects with the raycast. Returning true from this\n   * callback indicates that your are complete with your query and do not want to continue. Return false will continue searching\n   * the tree until all possible bodies that would intersect with the ray have been returned.\n   */\n  public rayCastQuery(ray: Ray, max: number = Infinity, callback: (other: T) => boolean): void {\n    const helper = (currentNode: TreeNode<T>): boolean => {\n      if (currentNode && currentNode.bounds.rayCast(ray, max)) {\n        if (currentNode.isLeaf()) {\n          if (callback.call(ray, currentNode.data)) {\n            // ray hit a leaf! return the body\n            return true;\n          }\n        } else {\n          // ray hit but not at a leaf, recurse deeper\n          return helper(currentNode.left) || helper(currentNode.right);\n        }\n      }\n      return false; // ray missed\n    };\n    helper(this.root);\n  }\n\n  public getNodes(): TreeNode<T>[] {\n    const helper = (currentNode: TreeNode<T>): TreeNode<T>[] => {\n      if (currentNode) {\n        return [currentNode].concat(helper(currentNode.left), helper(currentNode.right));\n      } else {\n        return [];\n      }\n    };\n    return helper(this.root);\n  }\n\n  public debug(ex: ExcaliburGraphicsContext) {\n    // draw all the nodes in the Dynamic Tree\n    const helper = (currentNode: TreeNode<T>) => {\n      if (currentNode) {\n        if (currentNode.isLeaf()) {\n          currentNode.bounds.draw(ex, Color.Green);\n        } else {\n          currentNode.bounds.draw(ex, Color.White);\n        }\n\n        if (currentNode.left) {\n          helper(currentNode.left);\n        }\n        if (currentNode.right) {\n          helper(currentNode.right);\n        }\n      }\n    };\n\n    helper(this.root);\n  }\n}\n","import { Line } from './line';\nimport { Vector } from './vector';\n\n/**\n * A 2D ray that can be cast into the scene to do collision detection\n */\n\nexport class Ray {\n  public pos: Vector;\n  public dir: Vector;\n\n  /**\n   * @param pos The starting position for the ray\n   * @param dir The vector indicating the direction of the ray\n   */\n  constructor(pos: Vector, dir: Vector) {\n    this.pos = pos;\n    this.dir = dir.normalize();\n  }\n\n  /**\n   * Tests a whether this ray intersects with a line segment. Returns a number greater than or equal to 0 on success.\n   * This number indicates the mathematical intersection time.\n   * @param line  The line to test\n   */\n  public intersect(line: Line): number {\n    const numerator = line.begin.sub(this.pos);\n\n    // Test is line and ray are parallel and non intersecting\n    if (this.dir.cross(line.getSlope()) === 0 && numerator.cross(this.dir) !== 0) {\n      return -1;\n    }\n\n    // Lines are parallel\n    const divisor = this.dir.cross(line.getSlope());\n    if (divisor === 0) {\n      return -1;\n    }\n\n    const t = numerator.cross(line.getSlope()) / divisor;\n\n    if (t >= 0) {\n      const u = numerator.cross(this.dir) / divisor / line.getLength();\n      if (u >= 0 && u <= 1) {\n        return t;\n      }\n    }\n    return -1;\n  }\n\n  public intersectPoint(line: Line): Vector {\n    const time = this.intersect(line);\n    if (time < 0) {\n      return null;\n    }\n    return this.getPoint(time);\n  }\n\n  /**\n   * Returns the point of intersection given the intersection time\n   */\n  public getPoint(time: number): Vector {\n    return this.pos.add(this.dir.scale(time));\n  }\n}\n","import { Physics } from '../Physics';\nimport { CollisionProcessor } from './CollisionProcessor';\nimport { DynamicTree } from './DynamicTree';\nimport { Pair } from './Pair';\n\nimport { Vector } from '../../Math/vector';\nimport { Ray } from '../../Math/ray';\nimport { FrameStats } from '../../Debug';\nimport { Logger } from '../../Util/Log';\nimport { CollisionType } from '../CollisionType';\nimport { Collider } from '../Colliders/Collider';\nimport { CollisionContact } from '../Detection/CollisionContact';\nimport { BodyComponent } from '../BodyComponent';\nimport { CompositeCollider } from '../Colliders/CompositeCollider';\nimport { ExcaliburGraphicsContext } from '../..';\n\n/**\n * Responsible for performing the collision broadphase (locating potential colllisions) and\n * the narrowphase (actual collision contacts)\n */\nexport class DynamicTreeCollisionProcessor implements CollisionProcessor {\n  private _dynamicCollisionTree = new DynamicTree<Collider>();\n  private _collisions = new Set<string>();\n\n  private _collisionPairCache: Pair[] = [];\n  private _colliders: Collider[] = [];\n\n  public getColliders(): readonly Collider[] {\n    return this._colliders;\n  }\n\n  /**\n   * Tracks a physics body for collisions\n   */\n  public track(target: Collider): void {\n    if (!target) {\n      Logger.getInstance().warn('Cannot track null collider');\n      return;\n    }\n    if (target instanceof CompositeCollider) {\n      const colliders = target.getColliders();\n      for (const c of colliders) {\n        c.owner = target.owner;\n        this._colliders.push(c);\n        this._dynamicCollisionTree.trackCollider(c);\n      }\n    } else {\n      this._colliders.push(target);\n      this._dynamicCollisionTree.trackCollider(target);\n    }\n  }\n\n  /**\n   * Untracks a physics body\n   */\n  public untrack(target: Collider): void {\n    if (!target) {\n      Logger.getInstance().warn('Cannot untrack a null collider');\n      return;\n    }\n\n    if (target instanceof CompositeCollider) {\n      const colliders = target.getColliders();\n      for (const c of colliders) {\n        const index = this._colliders.indexOf(c);\n        if (index !== -1) {\n          this._colliders.splice(index, 1);\n        }\n        this._dynamicCollisionTree.untrackCollider(c);\n      }\n    } else {\n      const index = this._colliders.indexOf(target);\n      if (index !== -1) {\n        this._colliders.splice(index, 1);\n      }\n      this._dynamicCollisionTree.untrackCollider(target);\n    }\n  }\n\n  private _shouldGenerateCollisionPair(colliderA: Collider, colliderB: Collider) {\n    // if the collision pair must be 2 separate colliders\n    // Also separate owners for composite colliders\n    if (\n      (colliderA.id !== null &&\n      colliderB.id !== null &&\n      colliderA.id === colliderB.id) ||\n      (colliderA.owner !== null &&\n       colliderB.owner !== null &&\n       colliderA.owner === colliderB.owner)) {\n      return false;\n    }\n\n    // if the collision pair has been calculated already short circuit\n    const hash = Pair.calculatePairHash(colliderA.id, colliderB.id);\n    if (this._collisions.has(hash)) {\n      return false; // pair exists easy exit return false\n    }\n\n    // if the pair has a member with zero dimension\n    if (colliderA.localBounds.hasZeroDimensions() || colliderB.localBounds.hasZeroDimensions()) {\n      return false;\n    }\n\n    return Pair.canCollide(colliderA, colliderB);\n  }\n\n  /**\n   * Detects potential collision pairs in a broadphase approach with the dynamic aabb tree strategy\n   */\n  public broadphase(targets: Collider[], delta: number, stats?: FrameStats): Pair[] {\n    const seconds = delta / 1000;\n\n    // Retrieve the list of potential colliders, exclude killed, prevented, and self\n    const potentialColliders = targets.filter((other) => {\n      const body = other.owner?.get(BodyComponent);\n      return other.owner?.active && body.collisionType !== CollisionType.PreventCollision;\n    });\n\n    // clear old list of collision pairs\n    this._collisionPairCache = [];\n    this._collisions.clear();\n\n    // check for normal collision pairs\n    let collider: Collider;\n    for (let j = 0, l = potentialColliders.length; j < l; j++) {\n      collider = potentialColliders[j];\n      // Query the collision tree for potential colliders\n      this._dynamicCollisionTree.query(collider, (other: Collider) => {\n        if (this._shouldGenerateCollisionPair(collider, other)) {\n          const pair = new Pair(collider, other);\n          this._collisions.add(pair.id);\n          this._collisionPairCache.push(pair);\n        }\n        // Always return false, to query whole tree. Returning true in the query method stops searching\n        return false;\n      });\n    }\n    if (stats) {\n      stats.physics.pairs = this._collisionPairCache.length;\n    }\n\n    // Check dynamic tree for fast moving objects\n    // Fast moving objects are those moving at least there smallest bound per frame\n    if (Physics.checkForFastBodies) {\n      for (const collider of potentialColliders) {\n        const body = collider.owner.get(BodyComponent);\n        // Skip non-active objects. Does not make sense on other collision types\n        if (body.collisionType !== CollisionType.Active) {\n          continue;\n        }\n\n        // Maximum travel distance next frame\n        const updateDistance =\n          body.vel.size * seconds + // velocity term\n          body.acc.size * 0.5 * seconds * seconds; // acc term\n\n        // Find the minimum dimension\n        const minDimension = Math.min(collider.bounds.height, collider.bounds.width);\n        if (Physics.disableMinimumSpeedForFastBody || updateDistance > minDimension / 2) {\n          if (stats) {\n            stats.physics.fastBodies++;\n          }\n\n          // start with the oldPos because the integration for actors has already happened\n          // objects resting on a surface may be slightly penetrating in the current position\n          const updateVec = body.pos.sub(body.oldPos);\n          const centerPoint = collider.center;\n          const furthestPoint = collider.getFurthestPoint(body.vel);\n          const origin: Vector = furthestPoint.sub(updateVec);\n\n          const ray: Ray = new Ray(origin, body.vel);\n\n          // back the ray up by -2x surfaceEpsilon to account for fast moving objects starting on the surface\n          ray.pos = ray.pos.add(ray.dir.scale(-2 * Physics.surfaceEpsilon));\n          let minCollider: Collider;\n          let minTranslate: Vector = new Vector(Infinity, Infinity);\n          this._dynamicCollisionTree.rayCastQuery(ray, updateDistance + Physics.surfaceEpsilon * 2, (other: Collider) => {\n            if (collider !== other && Pair.canCollide(collider, other)) {\n              const hitPoint = other.rayCast(ray, updateDistance + Physics.surfaceEpsilon * 10);\n              if (hitPoint) {\n                const translate = hitPoint.sub(origin);\n                if (translate.size < minTranslate.size) {\n                  minTranslate = translate;\n                  minCollider = other;\n                }\n              }\n            }\n            return false;\n          });\n\n          if (minCollider && Vector.isValid(minTranslate)) {\n            const pair = new Pair(collider, minCollider);\n            if (!this._collisions.has(pair.id)) {\n              this._collisions.add(pair.id);\n              this._collisionPairCache.push(pair);\n            }\n            // move the fast moving object to the other body\n            // need to push into the surface by ex.Physics.surfaceEpsilon\n            const shift = centerPoint.sub(furthestPoint);\n            body.pos = origin\n              .add(shift)\n              .add(minTranslate)\n              .add(ray.dir.scale(10 * Physics.surfaceEpsilon)); // needed to push the shape slightly into contact\n            collider.update(body.transform);\n\n            if (stats) {\n              stats.physics.fastBodyCollisions++;\n            }\n          }\n        }\n      }\n    }\n    // return cache\n    return this._collisionPairCache;\n  }\n\n  /**\n   * Applies narrow phase on collision pairs to find actual area intersections\n   * Adds actual colliding pairs to stats' Frame data\n   */\n  public narrowphase(pairs: Pair[], stats?: FrameStats): CollisionContact[] {\n    let contacts: CollisionContact[] = [];\n    for (let i = 0; i < pairs.length; i++) {\n      const newContacts = pairs[i].collide();\n      contacts = contacts.concat(newContacts);\n      if (stats && newContacts.length > 0) {\n        for (const c of newContacts) {\n          stats.physics.contacts.set(c.id, c);\n        }\n      }\n    }\n    if (stats) {\n      stats.physics.collisions += contacts.length;\n    }\n    return contacts;\n  }\n\n  /**\n   * Update the dynamic tree positions\n   */\n  public update(targets: Collider[]): number {\n    let updated = 0;\n    const len = targets.length;\n\n    for (let i = 0; i < len; i++) {\n      if (this._dynamicCollisionTree.updateCollider(targets[i])) {\n        updated++;\n      }\n    }\n    return updated;\n  }\n\n  public debug(ex: ExcaliburGraphicsContext) {\n    this._dynamicCollisionTree.debug(ex);\n  }\n}\n","import { Color } from '../../Color';\nimport { CollisionContact } from '../Detection/CollisionContact';\nimport { BoundingBox } from '../BoundingBox';\nimport { Projection } from '../../Math/projection';\nimport { Line } from '../../Math/line';\nimport { Vector } from '../../Math/vector';\nimport { Ray } from '../../Math/ray';\nimport { Clonable } from '../../Interfaces/Clonable';\nimport { Entity, Transform } from '../../EntityComponentSystem';\nimport { createId, Id } from '../../Id';\nimport { EventDispatcher } from '../../EventDispatcher';\nimport { ExcaliburGraphicsContext } from '../../Graphics/Context/ExcaliburGraphicsContext';\n\n/**\n * A collision collider specifies the geometry that can detect when other collision colliders intersect\n * for the purposes of colliding 2 objects in excalibur.\n */\nexport abstract class Collider implements Clonable<Collider> {\n  private static _ID = 0;\n  public readonly id: Id<'collider'> = createId('collider', Collider._ID++);\n  public events: EventDispatcher<Collider> = new EventDispatcher<Collider>(this);\n\n  /**\n   * Returns a boolean indicating whether this body collided with\n   * or was in stationary contact with\n   * the body of the other [[Collider]]\n   */\n  public touching(other: Collider): boolean {\n    const contact = this.collide(other);\n\n    if (contact) {\n      return true;\n    }\n\n    return false;\n  }\n\n  public owner: Entity;\n\n  /**\n   * Pixel offset of the collision collider relative to the collider, by default (0, 0) meaning the collider is positioned\n   * on top of the collider.\n   */\n  offset: Vector;\n\n  /**\n   * Position of the collision collider in world coordinates\n   */\n  abstract get worldPos(): Vector;\n\n  /**\n   * The center point of the collision collider, for example if the collider is a circle it would be the center.\n   */\n  abstract get center(): Vector;\n\n  /**\n   * Return the axis-aligned bounding box of the collision collider in world coordinates\n   */\n  abstract get bounds(): BoundingBox;\n\n  /**\n   * Return the axis-aligned bounding box of the collision collider in local coordinates\n   */\n  abstract get localBounds(): BoundingBox;\n\n  /**\n   * Return the axes of this particular collider\n   */\n  abstract get axes(): Vector[];\n  /**\n   * Find the furthest point on the convex hull of this particular collider in a certain direction.\n   */\n  abstract getFurthestPoint(direction: Vector): Vector;\n\n  abstract getInertia(mass: number): number;\n\n  // All new CollisionShape need to do the following\n  // Create a new collision function in the CollisionJumpTable against all the primitives\n  // Currently there are 3 primitive collision collider 3! = 6 jump functions\n  abstract collide(collider: Collider): CollisionContact[];\n\n  /**\n   * Returns the closest line between the surfaces this collider and another\n   * @param collider\n   */\n  abstract getClosestLineBetween(collider: Collider): Line;\n\n  /**\n   * Return wether the collider contains a point inclusive to it's border\n   */\n  abstract contains(point: Vector): boolean;\n\n  /**\n   * Return the point on the border of the collision collider that intersects with a ray (if any).\n   */\n  abstract rayCast(ray: Ray, max?: number): Vector;\n\n  /**\n   * Create a projection of this collider along an axis. Think of this as casting a \"shadow\" along an axis\n   */\n  abstract project(axis: Vector): Projection;\n\n  /**\n   * Updates collider world space geometry\n   */\n  abstract update(transform: Transform): void;\n\n  /**\n   * Draw the collider\n   * @deprecated Will be removed in 0.26.0\n   * @param ctx\n   * @param color\n   */\n  abstract draw(ctx: CanvasRenderingContext2D, color?: Color, pos?: Vector): void;\n\n  abstract debug(ex: ExcaliburGraphicsContext, color: Color): void;\n  /**\n   * Draw any debug information\n   * @deprecated Will be removed in 0.26.0\n   */\n  abstract debugDraw(ctx: CanvasRenderingContext2D, color: Color): void;\n\n  abstract clone(): Collider;\n}\n","import { Util } from '../..';\nimport { Pair } from '../Detection/Pair';\nimport { Color } from '../../Color';\nimport { Transform } from '../../EntityComponentSystem';\nimport { ExcaliburGraphicsContext } from '../../Graphics/Context/ExcaliburGraphicsContext';\nimport { Line } from '../../Math/line';\nimport { Projection } from '../../Math/projection';\nimport { Ray } from '../../Math/ray';\nimport { Vector } from '../../Math/vector';\nimport { BoundingBox } from '../BoundingBox';\nimport { CollisionContact } from '../Detection/CollisionContact';\nimport { DynamicTree } from '../Detection/DynamicTree';\nimport { DynamicTreeCollisionProcessor } from '../Detection/DynamicTreeCollisionProcessor';\nimport { Collider } from './Collider';\n\nexport class CompositeCollider extends Collider {\n  private _transform: Transform;\n  private _collisionProcessor = new DynamicTreeCollisionProcessor();\n  private _dynamicAABBTree = new DynamicTree();\n  private _colliders: Collider[] = [];\n\n  constructor(colliders: Collider[]) {\n    super();\n    for (const c of colliders) {\n      this.addCollider(c);\n    }\n  }\n\n  clearColliders() {\n    this._colliders = [];\n  }\n\n  addCollider(collider: Collider) {\n    this.events.wire(collider.events);\n    this._colliders.push(collider);\n    this._collisionProcessor.track(collider);\n    this._dynamicAABBTree.trackCollider(collider);\n  }\n\n  removeCollider(collider: Collider) {\n    this.events.unwire(collider.events);\n    Util.removeItemFromArray(collider, this._colliders);\n    this._collisionProcessor.untrack(collider);\n    this._dynamicAABBTree.untrackCollider(collider);\n  }\n\n  getColliders(): Collider[] {\n    return this._colliders;\n  }\n\n  get worldPos(): Vector {\n    // TODO transform component world pos\n    return this._transform?.pos ?? Vector.Zero;\n  }\n\n  get center(): Vector {\n    return this._transform?.pos ?? Vector.Zero;\n  }\n\n  get bounds(): BoundingBox {\n    // TODO cache this\n    const colliders = this.getColliders();\n    const results = colliders.reduce(\n      (acc, collider) => acc.combine(collider.bounds),\n      colliders[0]?.bounds ?? new BoundingBox().translate(this.worldPos)\n    );\n\n    return results;\n  }\n\n  get localBounds(): BoundingBox {\n    // TODO cache this\n    const colliders = this.getColliders();\n    const results = colliders.reduce((acc, collider) => acc.combine(collider.localBounds), colliders[0]?.localBounds ?? new BoundingBox());\n\n    return results;\n  }\n\n  get axes(): Vector[] {\n    // TODO cache this\n    const colliders = this.getColliders();\n    let axes: Vector[] = [];\n    for (const collider of colliders) {\n      axes = axes.concat(collider.axes);\n    }\n    return axes;\n  }\n\n  getFurthestPoint(direction: Vector): Vector {\n    const colliders = this.getColliders();\n    const furthestPoints: Vector[] = [];\n    for (const collider of colliders) {\n      furthestPoints.push(collider.getFurthestPoint(direction));\n    }\n    // Pick best point from all colliders\n    let bestPoint = furthestPoints[0];\n    let maxDistance = -Number.MAX_VALUE;\n    for (const point of furthestPoints) {\n      const distance = point.dot(direction);\n      if (distance > maxDistance) {\n        bestPoint = point;\n        maxDistance = distance;\n      }\n    }\n    return bestPoint;\n  }\n\n  getInertia(mass: number): number {\n    const colliders = this.getColliders();\n    let totalInertia = 0;\n    for (const collider of colliders) {\n      totalInertia += collider.getInertia(mass);\n    }\n    return totalInertia;\n  }\n\n  collide(other: Collider): CollisionContact[] {\n    let otherColliders = [other];\n    if (other instanceof CompositeCollider) {\n      otherColliders = other.getColliders();\n    }\n\n    const pairs: Pair[] = [];\n    for (const c of otherColliders) {\n      this._dynamicAABBTree.query(c, (potentialCollider: Collider) => {\n        pairs.push(new Pair(c, potentialCollider));\n        return false;\n      });\n    }\n\n    let contacts: CollisionContact[] = [];\n    for (const p of pairs) {\n      contacts = contacts.concat(p.collide());\n    }\n    return contacts;\n  }\n\n  getClosestLineBetween(other: Collider): Line {\n    const colliders = this.getColliders();\n    const lines: Line[] = [];\n    if (other instanceof CompositeCollider) {\n      const otherColliders = other.getColliders();\n      for (const colliderA of colliders) {\n        for (const colliderB of otherColliders) {\n          const maybeLine = colliderA.getClosestLineBetween(colliderB);\n          if (maybeLine) {\n            lines.push(maybeLine);\n          }\n        }\n      }\n    } else {\n      for (const collider of colliders) {\n        const maybeLine = other.getClosestLineBetween(collider);\n        if (maybeLine) {\n          lines.push(maybeLine);\n        }\n      }\n    }\n\n    if (lines.length) {\n      let minLength = lines[0].getLength();\n      let minLine = lines[0];\n      for (const line of lines) {\n        const length = line.getLength();\n        if (length < minLength) {\n          minLength = length;\n          minLine = line;\n        }\n      }\n      return minLine;\n    }\n    return null;\n  }\n  contains(point: Vector): boolean {\n    const colliders = this.getColliders();\n    for (const collider of colliders) {\n      if (collider.contains(point)) {\n        return true;\n      }\n    }\n    return false;\n  }\n  rayCast(ray: Ray, max?: number): Vector {\n    const colliders = this.getColliders();\n    const points: Vector[] = [];\n    for (const collider of colliders) {\n      const vec = collider.rayCast(ray, max);\n      if (vec) {\n        points.push(vec);\n      }\n    }\n    if (points.length) {\n      let minPoint = points[0];\n      let minDistance = minPoint.dot(ray.dir);\n      for (const point of points) {\n        const distance = ray.dir.dot(point);\n        if (distance < minDistance) {\n          minPoint = point;\n          minDistance = distance;\n        }\n      }\n      return minPoint;\n    }\n    return null;\n  }\n  project(axis: Vector): Projection {\n    const colliders = this.getColliders();\n    const projs: Projection[] = [];\n    for (const collider of colliders) {\n      const proj = collider.project(axis);\n      if (proj) {\n        projs.push(proj);\n      }\n    }\n    // Merge all proj's on the same axis\n    if (projs.length) {\n      const newProjection = new Projection(projs[0].min, projs[0].max);\n      for (const proj of projs) {\n        newProjection.min = Math.min(proj.min, newProjection.min);\n        newProjection.max = Math.max(proj.max, newProjection.max);\n      }\n      return newProjection;\n    }\n    return null;\n  }\n\n  update(transform: Transform): void {\n    if (transform) {\n      const colliders = this.getColliders();\n      for (const collider of colliders) {\n        collider.owner = this.owner;\n        collider.update(transform);\n      }\n    }\n  }\n\n  draw(ctx: CanvasRenderingContext2D, color?: Color, pos?: Vector): void {\n    const colliders = this.getColliders();\n    for (const collider of colliders) {\n      collider.draw(ctx, color, pos);\n    }\n  }\n\n  public debug(ex: ExcaliburGraphicsContext, color: Color) {\n    const colliders = this.getColliders();\n    for (const collider of colliders) {\n      collider.debug(ex, color);\n    }\n  }\n\n  debugDraw(ctx: CanvasRenderingContext2D, color: Color): void {\n    const colliders = this.getColliders();\n    for (const collider of colliders) {\n      collider.draw(ctx, color);\n    }\n  }\n  clone(): Collider {\n    return new CompositeCollider(this._colliders.map((c) => c.clone()));\n  }\n}\n","import { Vector } from './vector';\n\n/**\n * A 2D line segment\n */\n\nexport class Line {\n  /**\n   * @param begin  The starting point of the line segment\n   * @param end  The ending point of the line segment\n   */\n  constructor(public begin: Vector, public end: Vector) {}\n\n  /**\n   * Gets the raw slope (m) of the line. Will return (+/-)Infinity for vertical lines.\n   */\n  public get slope() {\n    return (this.end.y - this.begin.y) / (this.end.x - this.begin.x);\n  }\n\n  /**\n   * Gets the Y-intercept (b) of the line. Will return (+/-)Infinity if there is no intercept.\n   */\n  public get intercept() {\n    return this.begin.y - this.slope * this.begin.x;\n  }\n\n  /**\n   * Gets the normal of the line\n   */\n  public normal(): Vector {\n    return this.end.sub(this.begin).normal();\n  }\n\n  public dir(): Vector {\n    return this.end.sub(this.begin);\n  }\n\n  public getPoints(): Vector[] {\n    return [this.begin, this.end];\n  }\n\n  /**\n   * Returns the slope of the line in the form of a vector of length 1\n   */\n  public getSlope(): Vector {\n    const begin = this.begin;\n    const end = this.end;\n    const distance = begin.distance(end);\n    return end.sub(begin).scale(1 / distance);\n  }\n\n  /**\n   * Returns the edge of the line as vector, the length of the vector is the length of the edge\n   */\n  public getEdge(): Vector {\n    const begin = this.begin;\n    const end = this.end;\n    return end.sub(begin);\n  }\n\n  /**\n   * Returns the length of the line segment in pixels\n   */\n  public getLength(): number {\n    const begin = this.begin;\n    const end = this.end;\n    const distance = begin.distance(end);\n    return distance;\n  }\n\n  /**\n   * Returns the midpoint of the edge\n   */\n  public get midpoint(): Vector {\n    return this.begin.add(this.end).scale(0.5);\n  }\n\n  /**\n   * Flips the direction of the line segment\n   */\n  public flip(): Line {\n    return new Line(this.end, this.begin);\n  }\n\n  /**\n   * Tests if a given point is below the line, points in the normal direction above the line are considered above.\n   * @param point\n   */\n  public below(point: Vector): boolean {\n    const above2 = (this.end.x - this.begin.x) * (point.y - this.begin.y) - (this.end.y - this.begin.y) * (point.x - this.begin.x);\n    return above2 >= 0;\n  }\n\n  /**\n   * Returns the clip point\n   * @param sideVector Vector that traces the line\n   * @param length Length to clip along side\n   */\n  public clip(sideVector: Vector, length: number): Line {\n    let dir = sideVector;\n    dir = dir.normalize();\n\n    const near = dir.dot(this.begin) - length;\n    const far = dir.dot(this.end) - length;\n\n    const results = [];\n    if (near <= 0) {\n      results.push(this.begin);\n    }\n    if (far <= 0) {\n      results.push(this.end);\n    }\n\n    if (near * far < 0) {\n      const clipTime = near / (near - far);\n      results.push(this.begin.add(this.end.sub(this.begin).scale(clipTime)));\n    }\n    if (results.length !== 2) {\n      return null;\n    }\n\n    return new Line(results[0], results[1]);\n  }\n\n  /**\n   * Find the perpendicular distance from the line to a point\n   * https://en.wikipedia.org/wiki/Distance_from_a_point_to_a_line\n   * @param point\n   */\n  public distanceToPoint(point: Vector, signed: boolean = false) {\n    const x0 = point.x;\n    const y0 = point.y;\n\n    const l = this.getLength();\n\n    const dy = this.end.y - this.begin.y;\n    const dx = this.end.x - this.begin.x;\n    const distance = (dy * x0 - dx * y0 + this.end.x * this.begin.y - this.end.y * this.begin.x) / l;\n    return signed ? distance : Math.abs(distance);\n  }\n\n  /**\n   * Find the perpendicular line from the line to a point\n   * https://en.wikipedia.org/wiki/Distance_from_a_point_to_a_line\n   * (a - p) - ((a - p) * n)n\n   * a is a point on the line\n   * p is the arbitrary point above the line\n   * n is a unit vector in direction of the line\n   * @param point\n   */\n  public findVectorToPoint(point: Vector): Vector {\n    const aMinusP = this.begin.sub(point);\n    const n = this.getSlope();\n\n    return aMinusP.sub(n.scale(aMinusP.dot(n)));\n  }\n\n  /**\n   * Finds a point on the line given only an X or a Y value. Given an X value, the function returns\n   * a new point with the calculated Y value and vice-versa.\n   *\n   * @param x The known X value of the target point\n   * @param y The known Y value of the target point\n   * @returns A new point with the other calculated axis value\n   */\n  public findPoint(x: number = null, y: number = null): Vector {\n    const m = this.slope;\n    const b = this.intercept;\n\n    if (x !== null) {\n      return new Vector(x, m * x + b);\n    } else if (y !== null) {\n      return new Vector((y - b) / m, y);\n    } else {\n      throw new Error('You must provide an X or a Y value');\n    }\n  }\n\n  /**\n   * Whether or not the given point lies on this line. This method is precise by default\n   * meaning the point must lie exactly on the line. Adjust threshold to\n   * loosen the strictness of the check for floating-point calculations.\n   */\n  public hasPoint(x: number, y: number, threshold?: number): boolean;\n\n  /**\n   * Whether or not the given point lies on this line. This method is precise by default\n   * meaning the point must lie exactly on the line. Adjust threshold to\n   * loosen the strictness of the check for floating-point calculations.\n   */\n  public hasPoint(v: Vector, threshold?: number): boolean;\n\n  /**\n   * @see http://stackoverflow.com/a/11908158/109458\n   */\n  public hasPoint(): boolean {\n    let currPoint: Vector;\n    let threshold = 0;\n\n    if (typeof arguments[0] === 'number' && typeof arguments[1] === 'number') {\n      currPoint = new Vector(arguments[0], arguments[1]);\n      threshold = arguments[2] || 0;\n    } else if (arguments[0] instanceof Vector) {\n      currPoint = arguments[0];\n      threshold = arguments[1] || 0;\n    } else {\n      throw 'Could not determine the arguments for Vector.hasPoint';\n    }\n\n    const dxc = currPoint.x - this.begin.x;\n    const dyc = currPoint.y - this.begin.y;\n\n    const dx1 = this.end.x - this.begin.x;\n    const dy1 = this.end.y - this.begin.y;\n\n    const cross = dxc * dy1 - dyc * dx1;\n\n    // check whether point lines on the line\n    if (Math.abs(cross) > threshold) {\n      return false;\n    }\n\n    // check whether point lies in-between start and end\n    if (Math.abs(dx1) >= Math.abs(dy1)) {\n      return dx1 > 0 ? this.begin.x <= currPoint.x && currPoint.x <= this.end.x : this.end.x <= currPoint.x && currPoint.x <= this.begin.x;\n    } else {\n      return dy1 > 0 ? this.begin.y <= currPoint.y && currPoint.y <= this.end.y : this.end.y <= currPoint.y && currPoint.y <= this.begin.y;\n    }\n  }\n}\n","import { Line } from '../../Math/line';\nimport { Vector } from '../../Math/vector';\nimport { Ray } from '../../Math/ray';\nimport { PolygonCollider } from './PolygonCollider';\nimport { EdgeCollider } from './EdgeCollider';\nimport { CircleCollider } from './CircleCollider';\n\n/**\n * Finds the closes line between 2 line segments, were the magnitude of u, v are the lengths of each segment\n * L1 = P(s) = p0 + s * u, where s is time and p0 is the start of the line\n * L2 = Q(t) = q0 + t * v, where t is time and q0 is the start of the line\n * @param p0 Point where L1 begins\n * @param u Direction and length of L1\n * @param q0 Point were L2 begins\n * @param v Direction and length of L2\n */\nexport function ClosestLine(p0: Vector, u: Vector, q0: Vector, v: Vector) {\n  // Distance between 2 lines http://geomalgorithms.com/a07-_distance.html\n\n  // w(s, t) = P(s) - Q(t)\n  // The w(s, t) that has the minimum distance we will say is w(sClosest, tClosest) = wClosest\n  //\n  // wClosest is the vector that is uniquely perpendicular to the 2 line directions u & v.\n  // wClosest = w0 + sClosest * u - tClosest * v, where w0 is p0 - q0\n  //\n  // The closest point between 2 lines then satisfies this pair of equations\n  // 1: u * wClosest = 0\n  // 2: v * wClosest = 0\n  //\n  // Substituting wClosest into the equations we get\n  //\n  // 1: (u * u) * sClosest - (u * v) tClosest = -u * w0\n  // 2: (v * u) * sClosest - (v * v) tClosest = -v * w0\n\n  // simplify w0\n  const w0 = p0.sub(q0);\n\n  // simplify (u * u);\n  const a = u.dot(u);\n  // simplify (u * v);\n  const b = u.dot(v);\n  // simplify (v * v)\n  const c = v.dot(v);\n  // simplify (u * w0)\n  const d = u.dot(w0);\n  // simplify (v * w0)\n  const e = v.dot(w0);\n\n  // denominator ac - b^2\n  const denom = a * c - b * b;\n  let sDenom = denom;\n  let tDenom = denom;\n  // if denom is 0 they are parallel, use any point from either as the start in this case p0\n  if (denom === 0 || denom <= 0.01) {\n    const tClosestParallel = d / b;\n    return new Line(p0, q0.add(v.scale(tClosestParallel)));\n  }\n\n  // Solve for sClosest for infinite line\n  let sClosest = b * e - c * d; // / denom;\n\n  // Solve for tClosest for infinite line\n  let tClosest = a * e - b * d; // / denom;\n\n  // Solve for segments candidate edges, if sClosest and tClosest are outside their segments\n  if (sClosest < 0) {\n    sClosest = 0;\n    tClosest = e;\n    tDenom = c;\n  } else if (sClosest > sDenom) {\n    sClosest = sDenom;\n    tClosest = e + b;\n    tDenom = c;\n  }\n\n  if (tClosest < 0) {\n    tClosest = 0;\n    if (-d < 0) {\n      sClosest = 0;\n    } else if (-d > a) {\n      sClosest = sDenom;\n    } else {\n      sClosest = -d;\n      sDenom = a;\n    }\n  } else if (tClosest > tDenom) {\n    tClosest = tDenom;\n    if (-d + b < 0) {\n      sClosest = 0;\n    } else if (-d + b > a) {\n      sClosest = sDenom;\n    } else {\n      sClosest = -d + b;\n      sDenom = a;\n    }\n  }\n  sClosest = Math.abs(sClosest) < 0.001 ? 0 : sClosest / sDenom;\n  tClosest = Math.abs(tClosest) < 0.001 ? 0 : tClosest / tDenom;\n\n  return new Line(p0.add(u.scale(sClosest)), q0.add(v.scale(tClosest)));\n}\n\nexport const ClosestLineJumpTable = {\n  PolygonPolygonClosestLine(polygonA: PolygonCollider, polygonB: PolygonCollider) {\n    // Find the 2 closest faces on each polygon\n    const otherWorldPos = polygonB.worldPos;\n    const otherDirection = otherWorldPos.sub(polygonA.worldPos);\n    const thisDirection = otherDirection.negate();\n\n    const rayTowardsOther = new Ray(polygonA.worldPos, otherDirection);\n    const rayTowardsThis = new Ray(otherWorldPos, thisDirection);\n\n    const thisPoint = polygonA.rayCast(rayTowardsOther).add(rayTowardsOther.dir.scale(0.1));\n    const otherPoint = polygonB.rayCast(rayTowardsThis).add(rayTowardsThis.dir.scale(0.1));\n\n    const thisFace = polygonA.getClosestFace(thisPoint);\n    const otherFace = polygonB.getClosestFace(otherPoint);\n\n    // L1 = P(s) = p0 + s * u, where s is time and p0 is the start of the line\n    const p0 = thisFace.face.begin;\n    const u = thisFace.face.getEdge();\n\n    // L2 = Q(t) = q0 + t * v, where t is time and q0 is the start of the line\n    const q0 = otherFace.face.begin;\n    const v = otherFace.face.getEdge();\n\n    return ClosestLine(p0, u, q0, v);\n  },\n\n  PolygonEdgeClosestLine(polygon: PolygonCollider, edge: EdgeCollider) {\n    // Find the 2 closest faces on each polygon\n    const otherWorldPos = edge.worldPos;\n    const otherDirection = otherWorldPos.sub(polygon.worldPos);\n\n    const rayTowardsOther = new Ray(polygon.worldPos, otherDirection);\n\n    const thisPoint = polygon.rayCast(rayTowardsOther).add(rayTowardsOther.dir.scale(0.1));\n\n    const thisFace = polygon.getClosestFace(thisPoint);\n\n    // L1 = P(s) = p0 + s * u, where s is time and p0 is the start of the line\n    const p0 = thisFace.face.begin;\n    const u = thisFace.face.getEdge();\n\n    // L2 = Q(t) = q0 + t * v, where t is time and q0 is the start of the line\n    const edgeLine = edge.asLine();\n    const edgeStart = edgeLine.begin;\n    const edgeVector = edgeLine.getEdge();\n    const q0 = edgeStart;\n    const v = edgeVector;\n\n    return ClosestLine(p0, u, q0, v);\n  },\n\n  PolygonCircleClosestLine(polygon: PolygonCollider, circle: CircleCollider) {\n    // https://math.stackexchange.com/questions/1919177/how-to-find-point-on-line-closest-to-sphere\n    // Find the 2 closest faces on each polygon\n    const otherWorldPos = circle.worldPos;\n    const otherDirection = otherWorldPos.sub(polygon.worldPos);\n\n    const rayTowardsOther = new Ray(polygon.worldPos, otherDirection.normalize());\n\n    const thisPoint = polygon.rayCast(rayTowardsOther).add(rayTowardsOther.dir.scale(0.1));\n\n    const thisFace = polygon.getClosestFace(thisPoint);\n\n    // L1 = P(s) = p0 + s * u, where s is time and p0 is the start of the line\n    const p0 = thisFace.face.begin;\n    const u = thisFace.face.getEdge();\n\n    // Time of minimum distance\n    let t = (u.x * (otherWorldPos.x - p0.x) + u.y * (otherWorldPos.y - p0.y)) / (u.x * u.x + u.y * u.y);\n\n    // If time of minimum is past the edge clamp\n    if (t > 1) {\n      t = 1;\n    } else if (t < 0) {\n      t = 0;\n    }\n\n    // Minimum distance\n    const d = Math.sqrt(Math.pow(p0.x + u.x * t - otherWorldPos.x, 2) + Math.pow(p0.y + u.y * t - otherWorldPos.y, 2)) - circle.radius;\n\n    const circlex = ((p0.x + u.x * t - otherWorldPos.x) * circle.radius) / (circle.radius + d);\n    const circley = ((p0.y + u.y * t - otherWorldPos.y) * circle.radius) / (circle.radius + d);\n    return new Line(u.scale(t).add(p0), new Vector(otherWorldPos.x + circlex, otherWorldPos.y + circley));\n  },\n\n  CircleCircleClosestLine(circleA: CircleCollider, circleB: CircleCollider) {\n    // Find the 2 closest faces on each polygon\n    const otherWorldPos = circleB.worldPos;\n    const otherDirection = otherWorldPos.sub(circleA.worldPos);\n\n    const thisWorldPos = circleA.worldPos;\n    const thisDirection = thisWorldPos.sub(circleB.worldPos);\n\n    const rayTowardsOther = new Ray(circleA.worldPos, otherDirection);\n    const rayTowardsThis = new Ray(circleB.worldPos, thisDirection);\n\n    const thisPoint = circleA.rayCast(rayTowardsOther);\n    const otherPoint = circleB.rayCast(rayTowardsThis);\n\n    return new Line(thisPoint, otherPoint);\n  },\n\n  CircleEdgeClosestLine(circle: CircleCollider, edge: EdgeCollider) {\n    // https://math.stackexchange.com/questions/1919177/how-to-find-point-on-line-closest-to-sphere\n    const circleWorlPos = circle.worldPos;\n\n    // L1 = P(s) = p0 + s * u, where s is time and p0 is the start of the line\n    const edgeLine = edge.asLine();\n    const edgeStart = edgeLine.begin;\n    const edgeVector = edgeLine.getEdge();\n    const p0 = edgeStart;\n    const u = edgeVector;\n\n    // Time of minimum distance\n    let t = (u.x * (circleWorlPos.x - p0.x) + u.y * (circleWorlPos.y - p0.y)) / (u.x * u.x + u.y * u.y);\n\n    // If time of minimum is past the edge clamp to edge\n    if (t > 1) {\n      t = 1;\n    } else if (t < 0) {\n      t = 0;\n    }\n\n    // Minimum distance\n    const d = Math.sqrt(Math.pow(p0.x + u.x * t - circleWorlPos.x, 2) + Math.pow(p0.y + u.y * t - circleWorlPos.y, 2)) - circle.radius;\n\n    const circlex = ((p0.x + u.x * t - circleWorlPos.x) * circle.radius) / (circle.radius + d);\n    const circley = ((p0.y + u.y * t - circleWorlPos.y) * circle.radius) / (circle.radius + d);\n    return new Line(u.scale(t).add(p0), new Vector(circleWorlPos.x + circlex, circleWorlPos.y + circley));\n  },\n\n  EdgeEdgeClosestLine(edgeA: EdgeCollider, edgeB: EdgeCollider) {\n    // L1 = P(s) = p0 + s * u, where s is time and p0 is the start of the line\n    const edgeLineA = edgeA.asLine();\n    const edgeStartA = edgeLineA.begin;\n    const edgeVectorA = edgeLineA.getEdge();\n    const p0 = edgeStartA;\n    const u = edgeVectorA;\n\n    // L2 = Q(t) = q0 + t * v, where t is time and q0 is the start of the line\n    const edgeLineB = edgeB.asLine();\n    const edgeStartB = edgeLineB.begin;\n    const edgeVectorB = edgeLineB.getEdge();\n    const q0 = edgeStartB;\n    const v = edgeVectorB;\n\n    return ClosestLine(p0, u, q0, v);\n  }\n};\n","import { BoundingBox } from '../BoundingBox';\nimport { CollisionJumpTable } from './CollisionJumpTable';\nimport { CollisionContact } from '../Detection/CollisionContact';\nimport { PolygonCollider } from './PolygonCollider';\nimport { EdgeCollider } from './EdgeCollider';\n\nimport { Projection } from '../../Math/projection';\nimport { Line } from '../../Math/line';\nimport { Vector } from '../../Math/vector';\nimport { Ray } from '../../Math/ray';\nimport { Color } from '../../Color';\nimport { Collider } from './Collider';\n\nimport { ClosestLineJumpTable } from './ClosestLineJumpTable';\nimport { Transform, TransformComponent } from '../../EntityComponentSystem';\nimport { ExcaliburGraphicsContext } from '../../Graphics/Context/ExcaliburGraphicsContext';\n\nexport interface CircleColliderOptions {\n  /**\n   * Optional pixel offset to shift the circle relative to the collider, by default (0, 0).\n   */\n  offset?: Vector;\n  /**\n   * Required radius of the circle\n   */\n  radius: number;\n}\n\n/**\n * This is a circle collider for the excalibur rigid body physics simulation\n */\nexport class CircleCollider extends Collider {\n  /**\n   * Position of the circle relative to the collider, by default (0, 0).\n   */\n  public offset: Vector = Vector.Zero;\n\n  public get worldPos(): Vector {\n    return this.offset.add(this._transform?.pos ?? Vector.Zero);\n  }\n\n  /**\n   * This is the radius of the circle\n   */\n  public radius: number;\n\n  private _transform: Transform;\n\n  constructor(options: CircleColliderOptions) {\n    super();\n    this.offset = options.offset || Vector.Zero;\n    this.radius = options.radius || 0;\n  }\n\n  /**\n   * Returns a clone of this shape, not associated with any collider\n   */\n  public clone(): CircleCollider {\n    return new CircleCollider({\n      offset: this.offset.clone(),\n      radius: this.radius\n    });\n  }\n\n  /**\n   * Get the center of the collider in world coordinates\n   */\n  public get center(): Vector {\n    return this.offset.add(this._transform?.pos ?? Vector.Zero);\n  }\n\n  /**\n   * Tests if a point is contained in this collider\n   */\n  public contains(point: Vector): boolean {\n    const pos = this._transform?.pos ?? this.offset;\n    const distance = pos.distance(point);\n    if (distance <= this.radius) {\n      return true;\n    }\n    return false;\n  }\n\n  /**\n   * Casts a ray at the Circle collider and returns the nearest point of collision\n   * @param ray\n   */\n  public rayCast(ray: Ray, max: number = Infinity): Vector {\n    //https://en.wikipedia.org/wiki/Line%E2%80%93sphere_intersection\n    const c = this.center;\n    const dir = ray.dir;\n    const orig = ray.pos;\n\n    const discriminant = Math.sqrt(Math.pow(dir.dot(orig.sub(c)), 2) - Math.pow(orig.sub(c).distance(), 2) + Math.pow(this.radius, 2));\n\n    if (discriminant < 0) {\n      // no intersection\n      return null;\n    } else {\n      let toi = 0;\n      if (discriminant === 0) {\n        toi = -dir.dot(orig.sub(c));\n        if (toi > 0 && toi < max) {\n          return ray.getPoint(toi);\n        }\n        return null;\n      } else {\n        const toi1 = -dir.dot(orig.sub(c)) + discriminant;\n        const toi2 = -dir.dot(orig.sub(c)) - discriminant;\n\n        const positiveToi: number[] = [];\n        if (toi1 >= 0) {\n          positiveToi.push(toi1);\n        }\n\n        if (toi2 >= 0) {\n          positiveToi.push(toi2);\n        }\n\n        const mintoi = Math.min(...positiveToi);\n        if (mintoi <= max) {\n          return ray.getPoint(mintoi);\n        }\n        return null;\n      }\n    }\n  }\n\n  public getClosestLineBetween(shape: Collider): Line {\n    if (shape instanceof CircleCollider) {\n      return ClosestLineJumpTable.CircleCircleClosestLine(this, shape);\n    } else if (shape instanceof PolygonCollider) {\n      return ClosestLineJumpTable.PolygonCircleClosestLine(shape, this).flip();\n    } else if (shape instanceof EdgeCollider) {\n      return ClosestLineJumpTable.CircleEdgeClosestLine(this, shape).flip();\n    } else {\n      throw new Error(`Polygon could not collide with unknown CollisionShape ${typeof shape}`);\n    }\n  }\n\n  /**\n   * @inheritdoc\n   */\n  public collide(collider: Collider): CollisionContact[] {\n    if (collider instanceof CircleCollider) {\n      return CollisionJumpTable.CollideCircleCircle(this, collider);\n    } else if (collider instanceof PolygonCollider) {\n      return CollisionJumpTable.CollideCirclePolygon(this, collider);\n    } else if (collider instanceof EdgeCollider) {\n      return CollisionJumpTable.CollideCircleEdge(this, collider);\n    } else {\n      throw new Error(`Circle could not collide with unknown CollisionShape ${typeof collider}`);\n    }\n  }\n\n  /**\n   * Find the point on the collider furthest in the direction specified\n   */\n  public getFurthestPoint(direction: Vector): Vector {\n    return this.center.add(direction.normalize().scale(this.radius));\n  }\n\n  /**\n   * Find the local point on the shape in the direction specified\n   * @param direction\n   */\n  public getFurthestLocalPoint(direction: Vector): Vector {\n    const dir = direction.normalize();\n    return dir.scale(this.radius);\n  }\n\n  /**\n   * Get the axis aligned bounding box for the circle collider in world coordinates\n   */\n  public get bounds(): BoundingBox {\n    const tx = this._transform as TransformComponent;\n    const bodyPos = tx?.globalPos ?? Vector.Zero;\n    return new BoundingBox(\n      this.offset.x + bodyPos.x - this.radius,\n      this.offset.y + bodyPos.y - this.radius,\n      this.offset.x + bodyPos.x + this.radius,\n      this.offset.y + bodyPos.y + this.radius\n    );\n  }\n\n  /**\n   * Get the axis aligned bounding box for the circle collider in local coordinates\n   */\n  public get localBounds(): BoundingBox {\n    return new BoundingBox(\n      this.offset.x - this.radius,\n      this.offset.y - this.radius,\n      this.offset.x + this.radius,\n      this.offset.y + this.radius\n    );\n  }\n\n  /**\n   * Get axis not implemented on circles, since there are infinite axis in a circle\n   */\n  public get axes(): Vector[] {\n    return [];\n  }\n\n  /**\n   * Returns the moment of inertia of a circle given it's mass\n   * https://en.wikipedia.org/wiki/List_of_moments_of_inertia\n   */\n  public getInertia(mass: number): number {\n    return (mass * this.radius * this.radius) / 2;\n  }\n\n  /* istanbul ignore next */\n  public update(transform: Transform): void {\n    this._transform = transform;\n  }\n\n  /**\n   * Project the circle along a specified axis\n   */\n  public project(axis: Vector): Projection {\n    const scalars = [];\n    const point = this.center;\n    const dotProduct = point.dot(axis);\n    scalars.push(dotProduct);\n    scalars.push(dotProduct + this.radius);\n    scalars.push(dotProduct - this.radius);\n    return new Projection(Math.min.apply(Math, scalars), Math.max.apply(Math, scalars));\n  }\n\n  public draw(ctx: CanvasRenderingContext2D, color: Color = Color.Green, pos: Vector = Vector.Zero) {\n    const newPos = pos.add(this.offset);\n    ctx.beginPath();\n    ctx.fillStyle = color.toString();\n    ctx.arc(newPos.x, newPos.y, this.radius, 0, Math.PI * 2);\n    ctx.closePath();\n    ctx.fill();\n  }\n\n  public debug(ex: ExcaliburGraphicsContext, color: Color) {\n    const tx = this._transform as TransformComponent;\n    const pos = tx?.globalPos ? tx?.globalPos.add(this.offset) : this.offset;\n    ex.drawCircle(pos, this.radius, color);\n  }\n\n  /* istanbul ignore next */\n  public debugDraw(ctx: CanvasRenderingContext2D, color: Color = Color.Green) {\n    const transform = this._transform;\n    const pos = transform ? transform.pos.add(this.offset) : this.offset;\n    const rotation = transform ? transform.rotation : 0;\n\n    ctx.beginPath();\n    ctx.strokeStyle = color.toString();\n    ctx.arc(pos.x, pos.y, this.radius, 0, Math.PI * 2);\n    ctx.closePath();\n    ctx.stroke();\n    ctx.beginPath();\n    ctx.moveTo(pos.x, pos.y);\n    ctx.lineTo(Math.cos(rotation) * this.radius + pos.x, Math.sin(rotation) * this.radius + pos.y);\n    ctx.closePath();\n    ctx.stroke();\n  }\n}\n","import { Vector } from '../../Math/vector';\nimport { Physics } from '../Physics';\nimport { Collider } from '../Colliders/Collider';\nimport { CollisionType } from '../CollisionType';\nimport { Pair } from './Pair';\nimport { SeparationInfo } from '../Colliders/SeparatingAxis';\nimport { BodyComponent } from '../BodyComponent';\n\n/**\n * Collision contacts are used internally by Excalibur to resolve collision between colliders. This\n * Pair prevents collisions from being evaluated more than one time\n */\nexport class CollisionContact {\n  private _canceled = false;\n\n  /**\n   * Currently the ids between colliders\n   */\n  readonly id: string;\n\n  /**\n   * The first collider in the collision\n   */\n  colliderA: Collider;\n\n  /**\n   * The second collider in the collision\n   */\n  colliderB: Collider;\n\n  /**\n   * The minimum translation vector to resolve overlap, pointing away from colliderA\n   */\n  mtv: Vector;\n\n  /**\n   * World space contact points between colliderA and colliderB\n   */\n  points: Vector[];\n\n  /**\n   * Local space contact points between colliderA and colliderB\n   */\n  localPoints: Vector[];\n\n  /**\n   * The collision normal, pointing away from colliderA\n   */\n  normal: Vector;\n\n  /**\n   * The collision tangent\n   */\n  tangent: Vector;\n\n  /**\n   * Information about the specifics of the collision contact separation\n   */\n  info: SeparationInfo;\n\n  constructor(\n    colliderA: Collider,\n    colliderB: Collider,\n    mtv: Vector,\n    normal: Vector,\n    tangent: Vector,\n    points: Vector[],\n    localPoints: Vector[],\n    info: SeparationInfo\n  ) {\n    this.colliderA = colliderA;\n    this.colliderB = colliderB;\n    this.mtv = mtv;\n    this.normal = normal;\n    this.tangent = tangent;\n    this.points = points;\n    this.localPoints = localPoints;\n    this.info = info;\n    this.id = Pair.calculatePairHash(colliderA.id, colliderB.id);\n  }\n\n  /**\n   * Match contact awake state, except if body's are Fixed\n   */\n  public matchAwake(): void {\n    const bodyA = this.colliderA.owner.get(BodyComponent);\n    const bodyB = this.colliderB.owner.get(BodyComponent);\n    if (bodyA && bodyB) {\n      if (bodyA.sleeping !== bodyB.sleeping) {\n        if (bodyA.sleeping && bodyA.collisionType !== CollisionType.Fixed && bodyB.sleepMotion >= Physics.wakeThreshold) {\n          bodyA.setSleeping(false);\n        }\n        if (bodyB.sleeping && bodyB.collisionType !== CollisionType.Fixed && bodyA.sleepMotion >= Physics.wakeThreshold) {\n          bodyB.setSleeping(false);\n        }\n      }\n    }\n  }\n\n  public isCanceled() {\n    return this._canceled;\n  }\n\n  public cancel(): void {\n    this._canceled = true;\n  }\n}\n","import { Line } from '../../Math/line';\nimport { Vector } from '../../Math/vector';\nimport { Collider } from './Collider';\nimport { CircleCollider } from './CircleCollider';\nimport { PolygonCollider } from './PolygonCollider';\n\n/**\n * Specific information about a contact and it's separation\n */\nexport interface SeparationInfo {\n  /**\n   * Collider A\n   */\n  collider: Collider;\n\n  /**\n   * Signed value (negative means overlap, positive no overlap)\n   */\n  separation: number;\n\n  /**\n   * Axis of separation from the collider's perpective\n   */\n  axis: Vector;\n\n  /**\n   * Side of separation (reference) from the collider's perpsective\n   */\n\n  side?: Line;\n\n  /**\n   * Local side of separation (reference) from the collider's perspective\n   */\n  localSide?: Line;\n\n  /**\n   * Index of the separation side (reference) from the collider's perspective\n   */\n  sideId?: number;\n\n  /**\n   * Point on collider B (incident point)\n   */\n  point: Vector;\n\n  /**\n   * Local point on collider B (incident point)\n   */\n  localPoint?: Vector;\n}\n\nexport class SeparatingAxis {\n  static findPolygonPolygonSeparation(polyA: PolygonCollider, polyB: PolygonCollider): SeparationInfo {\n    let bestSeparation = -Number.MAX_VALUE;\n    let bestSide: Line | null = null;\n    let bestAxis: Vector | null = null;\n    let bestSideIndex: number = -1;\n    let bestOtherPoint: Vector | null = null;\n    const sides = polyA.getSides();\n    const localSides = polyA.getLocalSides();\n    for (let i = 0; i < sides.length; i++) {\n      const side = sides[i];\n      const axis = side.normal();\n      const vertB = polyB.getFurthestPoint(axis.negate());\n      // Separation on side i's axis\n      // We are looking for the largest separation between poly A's sides\n      const vertSeparation = side.distanceToPoint(vertB, true);\n      if (vertSeparation > bestSeparation) {\n        bestSeparation = vertSeparation;\n        bestSide = side;\n        bestAxis = axis;\n        bestSideIndex = i;\n        bestOtherPoint = vertB;\n      }\n    }\n\n    return {\n      collider: polyA,\n      separation: bestAxis ? bestSeparation : 99,\n      axis: bestAxis as Vector,\n      side: bestSide,\n      localSide: localSides[bestSideIndex],\n      sideId: bestSideIndex,\n      point: bestOtherPoint as Vector,\n      localPoint: bestAxis ? polyB.getFurthestLocalPoint(bestAxis!.negate()) : null\n    };\n  }\n\n  static findCirclePolygonSeparation(circle: CircleCollider, polygon: PolygonCollider): Vector | null {\n    const axes = polygon.axes;\n    const pc = polygon.center;\n    // Special SAT with circles\n    const polyDir = pc.sub(circle.worldPos);\n    const closestPointOnPoly = polygon.getFurthestPoint(polyDir.negate());\n    axes.push(closestPointOnPoly.sub(circle.worldPos).normalize());\n\n    let minOverlap = Number.MAX_VALUE;\n    let minAxis = null;\n    let minIndex = -1;\n    for (let i = 0; i < axes.length; i++) {\n      const proj1 = polygon.project(axes[i]);\n      const proj2 = circle.project(axes[i]);\n      const overlap = proj1.getOverlap(proj2);\n      if (overlap <= 0) {\n        return null;\n      } else {\n        if (overlap < minOverlap) {\n          minOverlap = overlap;\n          minAxis = axes[i];\n          minIndex = i;\n        }\n      }\n    }\n    if (minIndex < 0) {\n      return null;\n    }\n    return minAxis.normalize().scale(minOverlap);\n  }\n}\n","import { CircleCollider } from './CircleCollider';\nimport { CollisionContact } from '../Detection/CollisionContact';\nimport { PolygonCollider } from './PolygonCollider';\nimport { EdgeCollider } from './EdgeCollider';\nimport { SeparatingAxis, SeparationInfo } from './SeparatingAxis';\nimport { Line } from '../../Math/line';\nimport { Vector } from '../../Math/vector';\nimport { TransformComponent } from '../../EntityComponentSystem';\nimport { Pair } from '../Detection/Pair';\n\nexport const CollisionJumpTable = {\n  CollideCircleCircle(circleA: CircleCollider, circleB: CircleCollider): CollisionContact[] {\n    const circleAPos = circleA.worldPos;\n    const circleBPos = circleB.worldPos;\n    const combinedRadius = circleA.radius + circleB.radius;\n    const distance = circleAPos.distance(circleBPos);\n\n    if (distance > combinedRadius) {\n      return [];\n    }\n\n    // negative means overlap\n    const separation = combinedRadius - distance;\n\n    // Normal points from A -> B\n    const normal = circleBPos.sub(circleAPos).normalize();\n    const tangent = normal.perpendicular();\n    const mvt = normal.scale(separation);\n\n    const point = circleA.getFurthestPoint(normal);\n    const local = circleA.getFurthestLocalPoint(normal);\n\n    const info: SeparationInfo = {\n      collider: circleA,\n      separation,\n      axis: normal,\n      point: point\n    };\n\n    return [new CollisionContact(circleA, circleB, mvt, normal, tangent, [point], [local], info)];\n  },\n\n  CollideCirclePolygon(circle: CircleCollider, polygon: PolygonCollider): CollisionContact[] {\n    let minAxis = SeparatingAxis.findCirclePolygonSeparation(circle, polygon);\n    if (!minAxis) {\n      return [];\n    }\n\n    // make sure that the minAxis is pointing away from circle\n    const samedir = minAxis.dot(polygon.center.sub(circle.center));\n    minAxis = samedir < 0 ? minAxis.negate() : minAxis;\n\n    const point = circle.getFurthestPoint(minAxis);\n    const xf = circle.owner?.get(TransformComponent) ?? new TransformComponent();\n    const local = xf.applyInverse(point);\n    const normal = minAxis.normalize();\n\n    const info: SeparationInfo = {\n      collider: circle,\n      separation: -minAxis.size,\n      axis: normal,\n      point: point,\n      localPoint: local,\n      side: polygon.findSide(normal.negate()),\n      localSide: polygon.findLocalSide(normal.negate())\n    };\n\n    return [new CollisionContact(circle, polygon, minAxis, normal, normal.perpendicular(), [point], [local], info)];\n  },\n\n  CollideCircleEdge(circle: CircleCollider, edge: EdgeCollider): CollisionContact[] {\n    // TODO not sure this actually abides by local/world collisions\n    // Are edge.begin and edge.end local space or world space? I think they should be local\n\n    // center of the circle in world pos\n    const cc = circle.center;\n    // vector in the direction of the edge\n    const edgeWorld = edge.asLine();\n    const e = edgeWorld.end.sub(edgeWorld.begin);\n\n    // amount of overlap with the circle's center along the edge direction\n    const u = e.dot(edgeWorld.end.sub(cc));\n    const v = e.dot(cc.sub(edgeWorld.begin));\n    const side = edge.asLine();\n    const localSide = edge.asLocalLine();\n\n    // Potential region A collision (circle is on the left side of the edge, before the beginning)\n    if (v <= 0) {\n      const da = edgeWorld.begin.sub(cc);\n      const dda = da.dot(da); // quick and dirty way of calc'n distance in r^2 terms saves some sqrts\n      // save some sqrts\n      if (dda > circle.radius * circle.radius) {\n        return []; // no collision\n      }\n\n      const normal = da.normalize();\n      const separation = circle.radius - Math.sqrt(dda);\n\n      const info: SeparationInfo = {\n        collider: circle,\n        separation: separation,\n        axis: normal,\n        point: side.begin,\n        side: side,\n        localSide: localSide\n      };\n\n      return [\n        new CollisionContact(circle, edge, normal.scale(separation), normal, normal.perpendicular(), [side.begin], [localSide.begin], info)\n      ];\n    }\n\n    // Potential region B collision (circle is on the right side of the edge, after the end)\n    if (u <= 0) {\n      const db = edgeWorld.end.sub(cc);\n      const ddb = db.dot(db);\n      if (ddb > circle.radius * circle.radius) {\n        return [];\n      }\n\n      const normal = db.normalize();\n      const separation = circle.radius - Math.sqrt(ddb);\n\n      const info: SeparationInfo = {\n        collider: circle,\n        separation: separation,\n        axis: normal,\n        point: side.end,\n        side: side,\n        localSide: localSide\n      };\n\n      return [\n        new CollisionContact(circle, edge, normal.scale(separation), normal, normal.perpendicular(), [side.end], [localSide.end], info)\n      ];\n    }\n\n    // Otherwise potential region AB collision (circle is in the middle of the edge between the beginning and end)\n    const den = e.dot(e);\n    const pointOnEdge = edgeWorld.begin\n      .scale(u)\n      .add(edgeWorld.end.scale(v))\n      .scale(1 / den);\n    const d = cc.sub(pointOnEdge);\n\n    const dd = d.dot(d);\n    if (dd > circle.radius * circle.radius) {\n      return []; // no collision\n    }\n\n    let normal = e.perpendicular();\n    // flip correct direction\n    if (normal.dot(cc.sub(edgeWorld.begin)) < 0) {\n      normal.x = -normal.x;\n      normal.y = -normal.y;\n    }\n\n    normal = normal.normalize();\n    const separation = circle.radius - Math.sqrt(dd);\n\n    const mvt = normal.scale(separation);\n    const info: SeparationInfo = {\n      collider: circle,\n      separation: separation,\n      axis: normal,\n      point: pointOnEdge,\n      side: side,\n      localSide: localSide\n    };\n\n    return [\n      new CollisionContact(\n        circle,\n        edge,\n        mvt,\n        normal.negate(),\n        normal.negate().perpendicular(),\n        [pointOnEdge],\n        [pointOnEdge.sub(edge.worldPos)],\n        info\n      )\n    ];\n  },\n\n  CollideEdgeEdge(): CollisionContact[] {\n    // Edge-edge collision doesn't make sense\n    return [];\n  },\n\n  CollidePolygonEdge(polygon: PolygonCollider, edge: EdgeCollider): CollisionContact[] {\n    const pc = polygon.center;\n    const ec = edge.center;\n    const dir = ec.sub(pc).normalize();\n\n    // build a temporary polygon from the edge to use SAT\n    const linePoly = new PolygonCollider({\n      points: [edge.begin, edge.end, edge.end.add(dir.scale(100)), edge.begin.add(dir.scale(100))],\n      offset: edge.offset\n    });\n    linePoly.owner = edge.owner;\n    const tx = edge.owner?.get(TransformComponent);\n    if (tx) {\n      linePoly.update(edge.owner.get(TransformComponent));\n    }\n    // Gross hack but poly-poly works well\n    const contact = this.CollidePolygonPolygon(polygon, linePoly);\n    if (contact.length) {\n      // Fudge the contact back to edge\n      contact[0].colliderB = edge;\n      (contact[0].id as any) = Pair.calculatePairHash(polygon.id, edge.id);\n      // contact[0].info.collider\n    }\n    return contact;\n  },\n\n  CollidePolygonPolygon(polyA: PolygonCollider, polyB: PolygonCollider): CollisionContact[] {\n    // Multi contact from SAT\n    // https://gamedev.stackexchange.com/questions/111390/multiple-contacts-for-sat-collision-detection\n    // do a SAT test to find a min axis if it exists\n    const separationA = SeparatingAxis.findPolygonPolygonSeparation(polyA, polyB);\n    // If there is no overlap from boxA's perspective we can end early\n    if (separationA.separation > 0) {\n      return [];\n    }\n\n    const separationB = SeparatingAxis.findPolygonPolygonSeparation(polyB, polyA);\n    // If there is no overlap from boxB's perspective exit now\n    if (separationB.separation > 0) {\n      return [];\n    }\n\n    // Separations are both negative, we want to pick the least negative (minimal movement)\n    const separation = separationA.separation > separationB.separation ? separationA : separationB;\n\n    // The incident side is the most opposite from the axes of collision on the other collider\n    const other = separation.collider === polyA ? polyB : polyA;\n    const incident = other.findSide(separation.axis.negate()) as Line;\n\n    // Clip incident side by the perpendicular lines at each end of the reference side\n    // https://en.wikipedia.org/wiki/Sutherland%E2%80%93Hodgman_algorithm\n    const reference = separation.side;\n    const refDir = reference.dir().normalize();\n\n    // Find our contact points by clipping the incident by the collision side\n    const clipRight = incident.clip(refDir.negate(), -refDir.dot(reference.begin));\n    let clipLeft: Line | null = null;\n    if (clipRight) {\n      clipLeft = clipRight.clip(refDir, refDir.dot(reference.end));\n    }\n\n    // If there is no left there is no collision\n    if (clipLeft) {\n      // We only want clip points below the reference edge, discard the others\n      const points = clipLeft.getPoints().filter((p) => {\n        return reference.below(p);\n      });\n\n      let normal = separation.axis;\n      let tangent = normal.perpendicular();\n      // Point Contact A -> B\n      if (polyB.worldPos.sub(polyA.worldPos).dot(normal) < 0) {\n        normal = normal.negate();\n        tangent = normal.perpendicular();\n      }\n      // Points are clipped from incident which is the other collider\n      // Store those as locals\n      let localPoints: Vector[] = [];\n      if (separation.collider === polyA) {\n        const xf = polyB.owner?.get(TransformComponent) ?? new TransformComponent();\n        localPoints = points.map((p) => xf.applyInverse(p));\n      } else {\n        const xf = polyA.owner?.get(TransformComponent) ?? new TransformComponent();\n        localPoints = points.map((p) => xf.applyInverse(p));\n      }\n      return [new CollisionContact(polyA, polyB, normal.scale(-separation.separation), normal, tangent, points, localPoints, separation)];\n    }\n    return [];\n  },\n\n  FindContactSeparation(contact: CollisionContact, localPoint: Vector) {\n    const shapeA = contact.colliderA;\n    const txA = contact.colliderA.owner?.get(TransformComponent) ?? new TransformComponent();\n    const shapeB = contact.colliderB;\n    const txB = contact.colliderB.owner?.get(TransformComponent) ?? new TransformComponent();\n\n    // both are circles\n    if (shapeA instanceof CircleCollider && shapeB instanceof CircleCollider) {\n      const combinedRadius = shapeA.radius + shapeB.radius;\n      const distance = txA.pos.distance(txB.pos);\n      const separation = combinedRadius - distance;\n      return -separation;\n    }\n\n    // both are polygons\n    if (shapeA instanceof PolygonCollider && shapeB instanceof PolygonCollider) {\n      if (contact.info.localSide) {\n        let side: Line;\n        let worldPoint: Vector;\n        if (contact.info.collider === shapeA) {\n          side = new Line(txA.apply(contact.info.localSide.begin), txA.apply(contact.info.localSide.end));\n          worldPoint = txB.apply(localPoint);\n        } else {\n          side = new Line(txB.apply(contact.info.localSide.begin), txB.apply(contact.info.localSide.end));\n          worldPoint = txA.apply(localPoint);\n        }\n\n        return side.distanceToPoint(worldPoint, true);\n      }\n    }\n\n    // polygon v circle\n    if (\n      (shapeA instanceof PolygonCollider && shapeB instanceof CircleCollider) ||\n      (shapeB instanceof PolygonCollider && shapeA instanceof CircleCollider)\n    ) {\n      const worldPoint = txA.apply(localPoint);\n      if (contact.info.side) {\n        return contact.info.side.distanceToPoint(worldPoint, true);\n      }\n    }\n\n    // polygon v edge\n    if (\n      (shapeA instanceof EdgeCollider && shapeB instanceof PolygonCollider) ||\n      (shapeB instanceof EdgeCollider && shapeA instanceof PolygonCollider)\n    ) {\n      let worldPoint: Vector;\n      if (contact.info.collider === shapeA) {\n        worldPoint = txB.apply(localPoint);\n      } else {\n        worldPoint = txA.apply(localPoint);\n      }\n      if (contact.info.side) {\n        return contact.info.side.distanceToPoint(worldPoint, true);\n      }\n    }\n\n    // circle v edge\n    if (\n      (shapeA instanceof CircleCollider && shapeB instanceof EdgeCollider) ||\n      (shapeB instanceof CircleCollider && shapeA instanceof EdgeCollider)\n    ) {\n      // Local point is always on the edge which is always shapeB\n      const worldPoint = txB.apply(localPoint);\n\n      let circlePoint: Vector;\n      if (shapeA instanceof CircleCollider) {\n        circlePoint = shapeA.getFurthestPoint(contact.normal);\n      }\n\n      const dist = worldPoint.distance(circlePoint);\n\n      if (contact.info.side) {\n        return dist > 0 ? -dist : 0;\n      }\n    }\n\n    return 0;\n  }\n};\n","import { BoundingBox } from '../BoundingBox';\nimport { CollisionContact } from '../Detection/CollisionContact';\nimport { CollisionJumpTable } from './CollisionJumpTable';\nimport { CircleCollider } from './CircleCollider';\nimport { PolygonCollider } from './PolygonCollider';\n\nimport { Projection } from '../../Math/projection';\nimport { Line } from '../../Math/line';\nimport { Vector } from '../../Math/vector';\nimport { Ray } from '../../Math/ray';\nimport { Color } from '../../Color';\nimport { Collider } from './Collider';\nimport { ClosestLineJumpTable } from './ClosestLineJumpTable';\nimport { Transform, TransformComponent } from '../../EntityComponentSystem/Components/TransformComponent';\nimport { ExcaliburGraphicsContext } from '../../Graphics/Context/ExcaliburGraphicsContext';\n\nexport interface EdgeColliderOptions {\n  /**\n   * The beginning of the edge defined in local coordinates to the collider\n   */\n  begin: Vector;\n  /**\n   * The ending of the edge defined in local coordinates to the collider\n   */\n  end: Vector;\n  /**\n   * Optionall specify an offset\n   */\n  offset?: Vector;\n}\n\n/**\n * Edge is a single line collider to create collisions with a single line.\n */\nexport class EdgeCollider extends Collider {\n  offset: Vector;\n  begin: Vector;\n  end: Vector;\n\n  private _transform: Transform;\n\n  constructor(options: EdgeColliderOptions) {\n    super();\n    this.begin = options.begin || Vector.Zero;\n    this.end = options.end || Vector.Zero;\n    this.offset = options.offset ?? Vector.Zero;\n  }\n\n  /**\n   * Returns a clone of this Edge, not associated with any collider\n   */\n  public clone(): EdgeCollider {\n    return new EdgeCollider({\n      begin: this.begin.clone(),\n      end: this.end.clone()\n    });\n  }\n\n  public get worldPos(): Vector {\n    const tx = this._transform as TransformComponent;\n    return tx?.globalPos.add(this.offset) ?? this.offset;\n  }\n\n  /**\n   * Get the center of the collision area in world coordinates\n   */\n  public get center(): Vector {\n    const pos = this.begin.average(this.end).add(this._getBodyPos());\n    return pos;\n  }\n\n  private _getBodyPos(): Vector {\n    const tx = this._transform as TransformComponent;\n    const bodyPos = tx?.globalPos ?? Vector.Zero;\n    return bodyPos;\n  }\n\n  private _getTransformedBegin(): Vector {\n    const tx = this._transform as TransformComponent;\n    const angle = tx ? tx.globalRotation : 0;\n    return this.begin.rotate(angle).add(this._getBodyPos());\n  }\n\n  private _getTransformedEnd(): Vector {\n    const tx = this._transform as TransformComponent;\n    const angle = tx ? tx.globalRotation : 0;\n    return this.end.rotate(angle).add(this._getBodyPos());\n  }\n\n  /**\n   * Returns the slope of the line in the form of a vector\n   */\n  public getSlope(): Vector {\n    const begin = this._getTransformedBegin();\n    const end = this._getTransformedEnd();\n    const distance = begin.distance(end);\n    return end.sub(begin).scale(1 / distance);\n  }\n\n  /**\n   * Returns the length of the line segment in pixels\n   */\n  public getLength(): number {\n    const begin = this._getTransformedBegin();\n    const end = this._getTransformedEnd();\n    const distance = begin.distance(end);\n    return distance;\n  }\n\n  /**\n   * Tests if a point is contained in this collision area\n   */\n  public contains(): boolean {\n    return false;\n  }\n\n  /**\n   * @inheritdoc\n   */\n  public rayCast(ray: Ray, max: number = Infinity): Vector {\n    const numerator = this._getTransformedBegin().sub(ray.pos);\n\n    // Test is line and ray are parallel and non intersecting\n    if (ray.dir.cross(this.getSlope()) === 0 && numerator.cross(ray.dir) !== 0) {\n      return null;\n    }\n\n    // Lines are parallel\n    const divisor = ray.dir.cross(this.getSlope());\n    if (divisor === 0) {\n      return null;\n    }\n\n    const t = numerator.cross(this.getSlope()) / divisor;\n\n    if (t >= 0 && t <= max) {\n      const u = numerator.cross(ray.dir) / divisor / this.getLength();\n      if (u >= 0 && u <= 1) {\n        return ray.getPoint(t);\n      }\n    }\n\n    return null;\n  }\n\n  /**\n   * Returns the closes line between this and another collider, from this -> collider\n   * @param shape\n   */\n  public getClosestLineBetween(shape: Collider): Line {\n    if (shape instanceof CircleCollider) {\n      return ClosestLineJumpTable.CircleEdgeClosestLine(shape, this);\n    } else if (shape instanceof PolygonCollider) {\n      return ClosestLineJumpTable.PolygonEdgeClosestLine(shape, this).flip();\n    } else if (shape instanceof EdgeCollider) {\n      return ClosestLineJumpTable.EdgeEdgeClosestLine(this, shape);\n    } else {\n      throw new Error(`Polygon could not collide with unknown CollisionShape ${typeof shape}`);\n    }\n  }\n\n  /**\n   * @inheritdoc\n   */\n  public collide(shape: Collider): CollisionContact[] {\n    if (shape instanceof CircleCollider) {\n      return CollisionJumpTable.CollideCircleEdge(shape, this);\n    } else if (shape instanceof PolygonCollider) {\n      return CollisionJumpTable.CollidePolygonEdge(shape, this);\n    } else if (shape instanceof EdgeCollider) {\n      return CollisionJumpTable.CollideEdgeEdge();\n    } else {\n      throw new Error(`Edge could not collide with unknown CollisionShape ${typeof shape}`);\n    }\n  }\n\n  /**\n   * Find the point on the collider furthest in the direction specified\n   */\n  public getFurthestPoint(direction: Vector): Vector {\n    const transformedBegin = this._getTransformedBegin();\n    const transformedEnd = this._getTransformedEnd();\n    if (direction.dot(transformedBegin) > 0) {\n      return transformedBegin;\n    } else {\n      return transformedEnd;\n    }\n  }\n\n  private _boundsFromBeginEnd(begin: Vector, end: Vector, padding = 10) {\n    // A perfectly vertical or horizontal edge would have a bounds 0 width or height\n    // this causes problems for the collision system so we give them some padding\n    return new BoundingBox(\n      Math.min(begin.x, end.x) - padding,\n      Math.min(begin.y, end.y) - padding,\n      Math.max(begin.x, end.x) + padding,\n      Math.max(begin.y, end.y) + padding\n    );\n  }\n\n  /**\n   * Get the axis aligned bounding box for the edge collider in world space\n   */\n  public get bounds(): BoundingBox {\n    const transformedBegin = this._getTransformedBegin();\n    const transformedEnd = this._getTransformedEnd();\n    return this._boundsFromBeginEnd(transformedBegin, transformedEnd);\n  }\n\n  /**\n   * Get the axis aligned bounding box for the edge collider in local space\n   */\n  public get localBounds(): BoundingBox {\n    return this._boundsFromBeginEnd(this.begin, this.end);\n  }\n\n  /**\n   * Returns this edge represented as a line in world coordinates\n   */\n  public asLine(): Line {\n    return new Line(this._getTransformedBegin(), this._getTransformedEnd());\n  }\n\n  /**\n   * Return this edge as a line in local line coordinates (relative to the position)\n   */\n  public asLocalLine(): Line {\n    return new Line(this.begin, this.end);\n  }\n\n  /**\n   * Get the axis associated with the edge\n   */\n  public get axes(): Vector[] {\n    const e = this._getTransformedEnd().sub(this._getTransformedBegin());\n    const edgeNormal = e.normal();\n\n    const axes = [];\n    axes.push(edgeNormal);\n    axes.push(edgeNormal.negate());\n    axes.push(edgeNormal.normal());\n    axes.push(edgeNormal.normal().negate());\n    return axes;\n  }\n\n  /**\n   * Get the moment of inertia for an edge\n   * https://en.wikipedia.org/wiki/List_of_moments_of_inertia\n   */\n  public getInertia(mass: number): number {\n    const length = this.end.sub(this.begin).distance() / 2;\n    return mass * length * length;\n  }\n\n  /**\n   * @inheritdoc\n   */\n  public update(transform: Transform): void {\n    this._transform = transform;\n  }\n\n  /**\n   * Project the edge along a specified axis\n   */\n  public project(axis: Vector): Projection {\n    const scalars = [];\n\n    const points = [this._getTransformedBegin(), this._getTransformedEnd()];\n    const len = points.length;\n    for (let i = 0; i < len; i++) {\n      scalars.push(points[i].dot(axis));\n    }\n\n    return new Projection(Math.min.apply(Math, scalars), Math.max.apply(Math, scalars));\n  }\n\n  public draw(ctx: CanvasRenderingContext2D, color: Color = Color.Green, pos: Vector = Vector.Zero) {\n    const begin = this.begin.add(pos);\n    const end = this.end.add(pos);\n    ctx.strokeStyle = color.toString();\n    ctx.beginPath();\n    ctx.moveTo(begin.x, begin.y);\n    ctx.lineTo(end.x, end.y);\n    ctx.closePath();\n    ctx.stroke();\n  }\n\n  public debug(ex: ExcaliburGraphicsContext, color: Color) {\n    const begin = this._getTransformedBegin();\n    const end = this._getTransformedEnd();\n    ex.drawLine(begin, end, color, 2);\n    ex.drawCircle(begin, 2, color);\n    ex.drawCircle(end, 2, color);\n  }\n\n  /* istanbul ignore next */\n  public debugDraw(ctx: CanvasRenderingContext2D, color: Color = Color.Red) {\n    const begin = this._getTransformedBegin();\n    const end = this._getTransformedEnd();\n    ctx.strokeStyle = color.toString();\n    ctx.beginPath();\n    ctx.moveTo(begin.x, begin.y);\n    ctx.lineTo(end.x, end.y);\n    ctx.closePath();\n    ctx.stroke();\n  }\n}\n","import { Color } from '../../Color';\nimport { BoundingBox } from '../BoundingBox';\nimport { EdgeCollider } from './EdgeCollider';\nimport { CollisionJumpTable } from './CollisionJumpTable';\nimport { CircleCollider } from './CircleCollider';\nimport { CollisionContact } from '../Detection/CollisionContact';\nimport { Projection } from '../../Math/projection';\nimport { Line } from '../../Math/line';\nimport { Vector } from '../../Math/vector';\nimport { Ray } from '../../Math/ray';\nimport { ClosestLineJumpTable } from './ClosestLineJumpTable';\nimport { Transform, TransformComponent } from '../../EntityComponentSystem';\nimport { Collider } from './Collider';\nimport { ExcaliburGraphicsContext } from '../..';\n\nexport interface PolygonColliderOptions {\n  /**\n   * Pixel offset relative to a collider's body transform position.\n   */\n  offset?: Vector;\n  /**\n   * Points in the polygon in order around the perimeter in local coordinates. These are relative from the body transform position.\n   */\n  points: Vector[];\n  /**\n   * Whether points are specified in clockwise or counter clockwise order, default counter-clockwise\n   */\n  clockwiseWinding?: boolean;\n}\n\n/**\n * Polygon collider for detecting collisions\n */\nexport class PolygonCollider extends Collider {\n  /**\n   * Pixel offset relative to a collider's body transform position.\n   */\n  public offset: Vector;\n\n  /**\n   * Points in the polygon in order around the perimeter in local coordinates. These are relative from the body transform position.\n   */\n  public points: Vector[];\n\n  private _transform: Transform;\n\n  private _transformedPoints: Vector[] = [];\n  private _axes: Vector[] = [];\n  private _sides: Line[] = [];\n  private _localSides: Line[] = [];\n\n  constructor(options: PolygonColliderOptions) {\n    super();\n    this.offset = options.offset ?? Vector.Zero;\n    const winding = !!options.clockwiseWinding;\n    this.points = (winding ? options.points.reverse() : options.points) || [];\n\n    // calculate initial transformation\n    this._calculateTransformation();\n  }\n\n  /**\n   * Returns a clone of this ConvexPolygon, not associated with any collider\n   */\n  public clone(): PolygonCollider {\n    return new PolygonCollider({\n      offset: this.offset.clone(),\n      points: this.points.map((p) => p.clone())\n    });\n  }\n\n  /**\n   * Returns the world position of the collider, which is the current body transform plus any defined offset\n   */\n  public get worldPos(): Vector {\n    if (this._transform) {\n      return this._transform.pos.add(this.offset);\n    }\n    return this.offset;\n  }\n\n  /**\n   * Get the center of the collider in world coordinates\n   */\n  public get center(): Vector {\n    return this.bounds.center;\n  }\n\n  /**\n   * Calculates the underlying transformation from the body relative space to world space\n   */\n  private _calculateTransformation() {\n    const transform = this._transform as TransformComponent;\n\n    const pos = transform ? transform.globalPos.add(this.offset) : this.offset;\n    const angle = transform ? transform.globalRotation : 0;\n    const scale = transform ? transform.globalScale : Vector.One;\n\n    const len = this.points.length;\n    this._transformedPoints.length = 0; // clear out old transform\n    for (let i = 0; i < len; i++) {\n      this._transformedPoints[i] = this.points[i].scale(scale).rotate(angle).add(pos);\n    }\n  }\n\n  /**\n   * Gets the points that make up the polygon in world space, from actor relative space (if specified)\n   */\n  public getTransformedPoints(): Vector[] {\n    this._calculateTransformation();\n    return this._transformedPoints;\n  }\n\n  /**\n   * Gets the sides of the polygon in world space\n   */\n  public getSides(): Line[] {\n    if (this._sides.length) {\n      return this._sides;\n    }\n    const lines = [];\n    const points = this.getTransformedPoints();\n    const len = points.length;\n    for (let i = 0; i < len; i++) {\n      // This winding is important\n      lines.push(new Line(points[i], points[(i + 1) % len]));\n    }\n    this._sides = lines;\n    return this._sides;\n  }\n\n  /**\n   * Returns the local coordinate space sides\n   */\n  public getLocalSides(): Line[] {\n    if (this._localSides.length) {\n      return this._localSides;\n    }\n    const lines = [];\n    const points = this.points;\n    const len = points.length;\n    for (let i = 0; i < len; i++) {\n      // This winding is important\n      lines.push(new Line(points[i], points[(i + 1) % len]));\n    }\n    this._localSides = lines;\n    return this._localSides;\n  }\n\n  /**\n   * Given a direction vector find the world space side that is most in that direction\n   * @param direction\n   */\n  public findSide(direction: Vector): Line {\n    const sides = this.getSides();\n    let bestSide = sides[0];\n    let maxDistance = -Number.MAX_VALUE;\n    for (let side = 0; side < sides.length; side++) {\n      const currentSide = sides[side];\n      const sideNormal = currentSide.normal();\n      const mostDirection = sideNormal.dot(direction);\n      if (mostDirection > maxDistance) {\n        bestSide = currentSide;\n        maxDistance = mostDirection;\n      }\n    }\n    return bestSide;\n  }\n\n  /**\n   * Given a direction vector find the local space side that is most in that direction\n   * @param direction\n   */\n  public findLocalSide(direction: Vector): Line {\n    const sides = this.getLocalSides();\n    let bestSide = sides[0];\n    let maxDistance = -Number.MAX_VALUE;\n    for (let side = 0; side < sides.length; side++) {\n      const currentSide = sides[side];\n      const sideNormal = currentSide.normal();\n      const mostDirection = sideNormal.dot(direction);\n      if (mostDirection > maxDistance) {\n        bestSide = currentSide;\n        maxDistance = mostDirection;\n      }\n    }\n    return bestSide;\n  }\n\n  /**\n   * Get the axis associated with the convex polygon\n   */\n  public get axes(): Vector[] {\n    if (this._axes.length) {\n      return this._axes;\n    }\n    const axes = this.getSides().map((s) => s.normal());\n    this._axes = axes;\n    return this._axes;\n  }\n\n  public update(transform: Transform): void {\n    this._transform = transform;\n    this._sides.length = 0;\n    this._localSides.length = 0;\n    this._axes.length = 0;\n    this._transformedPoints.length = 0;\n    this.getTransformedPoints();\n    this.getSides();\n    this.getLocalSides();\n  }\n\n  /**\n   * Tests if a point is contained in this collider in world space\n   */\n  public contains(point: Vector): boolean {\n    // Always cast to the right, as long as we cast in a consistent fixed direction we\n    // will be fine\n    const testRay = new Ray(point, new Vector(1, 0));\n    const intersectCount = this.getSides().reduce(function (accum, side) {\n      if (testRay.intersect(side) >= 0) {\n        return accum + 1;\n      }\n      return accum;\n    }, 0);\n\n    if (intersectCount % 2 === 0) {\n      return false;\n    }\n    return true;\n  }\n\n  public getClosestLineBetween(collider: Collider): Line {\n    if (collider instanceof CircleCollider) {\n      return ClosestLineJumpTable.PolygonCircleClosestLine(this, collider);\n    } else if (collider instanceof PolygonCollider) {\n      return ClosestLineJumpTable.PolygonPolygonClosestLine(this, collider);\n    } else if (collider instanceof EdgeCollider) {\n      return ClosestLineJumpTable.PolygonEdgeClosestLine(this, collider);\n    } else {\n      throw new Error(`Polygon could not collide with unknown CollisionShape ${typeof collider}`);\n    }\n  }\n\n  /**\n   * Returns a collision contact if the 2 colliders collide, otherwise collide will\n   * return null.\n   * @param collider\n   */\n  public collide(collider: Collider): CollisionContact[] {\n    if (collider instanceof CircleCollider) {\n      return CollisionJumpTable.CollideCirclePolygon(collider, this);\n    } else if (collider instanceof PolygonCollider) {\n      return CollisionJumpTable.CollidePolygonPolygon(this, collider);\n    } else if (collider instanceof EdgeCollider) {\n      return CollisionJumpTable.CollidePolygonEdge(this, collider);\n    } else {\n      throw new Error(`Polygon could not collide with unknown CollisionShape ${typeof collider}`);\n    }\n  }\n\n  /**\n   * Find the point on the collider furthest in the direction specified\n   */\n  public getFurthestPoint(direction: Vector): Vector {\n    const pts = this.getTransformedPoints();\n    let furthestPoint = null;\n    let maxDistance = -Number.MAX_VALUE;\n    for (let i = 0; i < pts.length; i++) {\n      const distance = direction.dot(pts[i]);\n      if (distance > maxDistance) {\n        maxDistance = distance;\n        furthestPoint = pts[i];\n      }\n    }\n    return furthestPoint;\n  }\n\n  /**\n   * Find the local point on the collider furthest in the direction specified\n   * @param direction\n   */\n  public getFurthestLocalPoint(direction: Vector): Vector {\n    const pts = this.points;\n    let furthestPoint = pts[0];\n    let maxDistance = -Number.MAX_VALUE;\n    for (let i = 0; i < pts.length; i++) {\n      const distance = direction.dot(pts[i]);\n      if (distance > maxDistance) {\n        maxDistance = distance;\n        furthestPoint = pts[i];\n      }\n    }\n    return furthestPoint;\n  }\n\n  /**\n   * Finds the closes face to the point using perpendicular distance\n   * @param point point to test against polygon\n   */\n  public getClosestFace(point: Vector): { distance: Vector; face: Line } {\n    const sides = this.getSides();\n    let min = Number.POSITIVE_INFINITY;\n    let faceIndex = -1;\n    let distance = -1;\n    for (let i = 0; i < sides.length; i++) {\n      const dist = sides[i].distanceToPoint(point);\n      if (dist < min) {\n        min = dist;\n        faceIndex = i;\n        distance = dist;\n      }\n    }\n\n    if (faceIndex !== -1) {\n      return {\n        distance: sides[faceIndex].normal().scale(distance),\n        face: sides[faceIndex]\n      };\n    }\n\n    return null;\n  }\n\n  /**\n   * Get the axis aligned bounding box for the polygon collider in world coordinates\n   */\n  public get bounds(): BoundingBox {\n    const tx = this._transform as TransformComponent;\n    const scale = tx?.globalScale ?? Vector.One;\n    const rotation = tx?.globalRotation ?? 0;\n    const pos = (tx?.globalPos ?? Vector.Zero).add(this.offset);\n    return this.localBounds.scale(scale).rotate(rotation).translate(pos);\n  }\n\n  /**\n   * Get the axis aligned bounding box for the polygon collider in local coordinates\n   */\n  public get localBounds(): BoundingBox {\n    return BoundingBox.fromPoints(this.points);\n  }\n\n  /**\n   * Get the moment of inertia for an arbitrary polygon\n   * https://en.wikipedia.org/wiki/List_of_moments_of_inertia\n   */\n  public getInertia(mass: number): number {\n    let numerator = 0;\n    let denominator = 0;\n    for (let i = 0; i < this.points.length; i++) {\n      const iplusone = (i + 1) % this.points.length;\n      const crossTerm = this.points[iplusone].cross(this.points[i]);\n      numerator +=\n        crossTerm *\n        (this.points[i].dot(this.points[i]) + this.points[i].dot(this.points[iplusone]) + this.points[iplusone].dot(this.points[iplusone]));\n      denominator += crossTerm;\n    }\n    return (mass / 6) * (numerator / denominator);\n  }\n\n  /**\n   * Casts a ray into the polygon and returns a vector representing the point of contact (in world space) or null if no collision.\n   */\n  public rayCast(ray: Ray, max: number = Infinity) {\n    // find the minimum contact time greater than 0\n    // contact times less than 0 are behind the ray and we don't want those\n    const sides = this.getSides();\n    const len = sides.length;\n    let minContactTime = Number.MAX_VALUE;\n    let contactIndex = -1;\n    for (let i = 0; i < len; i++) {\n      const contactTime = ray.intersect(sides[i]);\n      if (contactTime >= 0 && contactTime < minContactTime && contactTime <= max) {\n        minContactTime = contactTime;\n        contactIndex = i;\n      }\n    }\n\n    // contact was found\n    if (contactIndex >= 0) {\n      return ray.getPoint(minContactTime);\n    }\n\n    // no contact found\n    return null;\n  }\n\n  /**\n   * Project the edges of the polygon along a specified axis\n   */\n  public project(axis: Vector): Projection {\n    const points = this.getTransformedPoints();\n    const len = points.length;\n    let min = Number.MAX_VALUE;\n    let max = -Number.MAX_VALUE;\n    for (let i = 0; i < len; i++) {\n      const scalar = points[i].dot(axis);\n      min = Math.min(min, scalar);\n      max = Math.max(max, scalar);\n    }\n\n    return new Projection(min, max);\n  }\n\n  public draw(ctx: CanvasRenderingContext2D, color: Color = Color.Green, pos: Vector = Vector.Zero) {\n    const effectiveOffset = pos.add(this.offset);\n    ctx.beginPath();\n    ctx.fillStyle = color.toString();\n\n    const firstPoint = this.points[0].add(effectiveOffset);\n    ctx.moveTo(firstPoint.x, firstPoint.y);\n\n    // Points are relative\n    this.points\n      .map((p) => p.add(effectiveOffset))\n      .forEach(function (point) {\n        ctx.lineTo(point.x, point.y);\n      });\n    ctx.lineTo(firstPoint.x, firstPoint.y);\n    ctx.closePath();\n    ctx.fill();\n  }\n  public debug(ex: ExcaliburGraphicsContext, color: Color) {\n    const firstPoint = this.getTransformedPoints()[0];\n    const points = [firstPoint, ...this.getTransformedPoints(), firstPoint];\n    for (let i = 0; i < points.length - 1; i++) {\n      ex.drawLine(points[i], points[i + 1], color, 2);\n      ex.drawCircle(points[i], 2, color);\n      ex.drawCircle(points[i + 1], 2, color);\n    }\n  }\n\n  /* istanbul ignore next */\n  public debugDraw(ctx: CanvasRenderingContext2D, color: Color = Color.Red) {\n    ctx.beginPath();\n    ctx.strokeStyle = color.toString();\n    // Iterate through the supplied points and construct a 'polygon'\n    const firstPoint = this.getTransformedPoints()[0];\n    ctx.moveTo(firstPoint.x, firstPoint.y);\n    this.getTransformedPoints().forEach(function (point) {\n      ctx.lineTo(point.x, point.y);\n    });\n    ctx.lineTo(firstPoint.x, firstPoint.y);\n    ctx.closePath();\n    ctx.stroke();\n  }\n}\n","import { PolygonCollider } from './PolygonCollider';\nimport { CircleCollider } from './CircleCollider';\nimport { EdgeCollider } from './EdgeCollider';\nimport { BoundingBox } from '../BoundingBox';\nimport { Vector } from '../../Math/vector';\n\n/**\n * Excalibur helper for defining colliders quickly\n */\nexport class Shape {\n  /**\n   * Creates a box collider, under the hood defines a [[ConvexPolygon]] collider\n   * @param width Width of the box\n   * @param height Height of the box\n   * @param anchor Anchor of the box (default (.5, .5)) which positions the box relative to the center of the collider's position\n   * @param offset Optional offset relative to the collider in local coordinates\n   */\n  static Box(width: number, height: number, anchor: Vector = Vector.Half, offset: Vector = Vector.Zero): PolygonCollider {\n    return new PolygonCollider({\n      points: new BoundingBox(-width * anchor.x, -height * anchor.y, width - width * anchor.x, height - height * anchor.y).getPoints(),\n      offset: offset\n    });\n  }\n\n  /**\n   * Creates a new [[ConvexPolygon|arbitrary polygon]] collider\n   * @param points Points specified in counter clockwise\n   * @param clockwiseWinding Optionally changed the winding of points, by default false meaning counter-clockwise winding.\n   * @param offset Optional offset relative to the collider in local coordinates\n   */\n  static Polygon(points: Vector[], clockwiseWinding: boolean = false, offset: Vector = Vector.Zero): PolygonCollider {\n    return new PolygonCollider({\n      points: points,\n      offset: offset,\n      clockwiseWinding: clockwiseWinding\n    });\n  }\n\n  /**\n   * Creates a new [[Circle|circle]] collider\n   * @param radius Radius of the circle collider\n   * @param offset Optional offset relative to the collider in local coordinates\n   */\n  static Circle(radius: number, offset: Vector = Vector.Zero): CircleCollider {\n    return new CircleCollider({\n      radius: radius,\n      offset: offset\n    });\n  }\n\n  /**\n   * Creates a new [[Edge|edge]] collider\n   * @param begin Beginning of the edge in local coordinates to the collider\n   * @param end Ending of the edge in local coordinates to the collider\n   */\n  static Edge(begin: Vector, end: Vector): EdgeCollider {\n    return new EdgeCollider({\n      begin: begin,\n      end: end\n    });\n  }\n}\n","import { Vector } from '../Math/vector';\nimport { TransformComponent } from '../EntityComponentSystem';\nimport { Component } from '../EntityComponentSystem/Component';\nimport { Entity } from '../EntityComponentSystem/Entity';\nimport { EventDispatcher } from '../EventDispatcher';\nimport { CollisionEndEvent, CollisionStartEvent, PostCollisionEvent, PreCollisionEvent } from '../Events';\nimport { Observable } from '../Util/Observable';\nimport { BoundingBox } from './BoundingBox';\nimport { CollisionContact } from './Detection/CollisionContact';\nimport { CircleCollider } from './Colliders/CircleCollider';\nimport { Collider } from './Colliders/Collider';\nimport { CompositeCollider } from './Colliders/CompositeCollider';\nimport { PolygonCollider } from './Colliders/PolygonCollider';\nimport { EdgeCollider } from './Colliders/EdgeCollider';\nimport { Shape } from './Colliders/Shape';\n\nexport class ColliderComponent extends Component<'ex.collider'> {\n  public readonly type = 'ex.collider';\n\n  public events = new EventDispatcher(this);\n  /**\n   * Observable that notifies when a collider is added to the body\n   */\n  public $colliderAdded = new Observable<Collider>();\n\n  /**\n   * Observable that notifies when a collider is removed from the body\n   */\n  public $colliderRemoved = new Observable<Collider>();\n\n  constructor(collider?: Collider) {\n    super();\n    this.set(collider);\n  }\n\n  private _collider: Collider;\n  public get() {\n    return this._collider;\n  }\n\n  public set<T extends Collider>(collider: T): T {\n    if (this._collider) {\n      this.events.unwire(collider.events);\n      this.$colliderRemoved.notifyAll(this._collider);\n    }\n    if (collider) {\n      this._collider = collider;\n      this._collider.owner = this.owner;\n      this.events.wire(collider.events);\n      this.$colliderAdded.notifyAll(collider);\n      this.update();\n    }\n    return collider;\n  }\n\n  public get bounds() {\n    return this._collider?.bounds ?? new BoundingBox();\n  }\n\n  public get localBounds() {\n    return this._collider?.localBounds ?? new BoundingBox();\n  }\n\n  public update() {\n    const tx = this.owner?.get(TransformComponent);\n    if (this._collider) {\n      this._collider.owner = this.owner;\n      if (tx) {\n        this._collider.update(tx);\n      }\n    }\n  }\n\n  collide(other: ColliderComponent): CollisionContact[] {\n    let colliderA = this._collider;\n    let colliderB = other._collider;\n\n    // If we have a composite lefthand side :(\n    // Might bite us, but to avoid updating all the handlers make composite always left side\n    let flipped = false;\n    if (colliderB instanceof CompositeCollider) {\n      colliderA = colliderB;\n      colliderB = this._collider;\n      flipped = true;\n    }\n\n    if (this._collider) {\n      const contacts = colliderA.collide(colliderB);\n      if (contacts) {\n        if (flipped) {\n          contacts.forEach((contact) => {\n            contact.mtv = contact.mtv.negate();\n            contact.normal = contact.normal.negate();\n            contact.tangent = contact.normal.perpendicular();\n            contact.colliderA = this._collider;\n            contact.colliderB = other._collider;\n          });\n        }\n        return contacts;\n      }\n      return [];\n    }\n    return [];\n  }\n\n  onAdd(entity: Entity) {\n    if (this._collider) {\n      this.update();\n    }\n    // Wire up the collider events to the owning entity\n    this.events.on('precollision', (evt: any) => {\n      const precollision = evt as PreCollisionEvent<Collider>;\n      entity.events.emit(\n        'precollision',\n        new PreCollisionEvent(precollision.target.owner, precollision.other.owner, precollision.side, precollision.intersection)\n      );\n    });\n    this.events.on('postcollision', (evt: any) => {\n      const postcollision = evt as PostCollisionEvent<Collider>;\n      entity.events.emit(\n        'postcollision',\n        new PostCollisionEvent(postcollision.target.owner, postcollision.other.owner, postcollision.side, postcollision.intersection)\n      );\n    });\n    this.events.on('collisionstart', (evt: any) => {\n      const start = evt as CollisionStartEvent<Collider>;\n      entity.events.emit('collisionstart', new CollisionStartEvent(start.target.owner, start.other.owner, start.contact));\n    });\n    this.events.on('collisionend', (evt: any) => {\n      const end = evt as CollisionEndEvent<Collider>;\n      entity.events.emit('collisionend', new CollisionEndEvent(end.target.owner, end.other.owner));\n    });\n  }\n\n  onRemove() {\n    this.events.clear();\n    this.$colliderRemoved.notifyAll(this._collider);\n  }\n\n  /**\n   * Sets up a box geometry based on the current bounds of the associated actor of this physics body.\n   *\n   * If no width/height are specified the body will attempt to use the associated actor's width/height.\n   *\n   * By default, the box is center is at (0, 0) which means it is centered around the actors anchor.\n   */\n  useBoxCollider(width: number, height: number, anchor: Vector = Vector.Half, center: Vector = Vector.Zero): PolygonCollider {\n    const collider = Shape.Box(width, height, anchor, center);\n    return (this.set(collider));\n  }\n\n  /**\n   * Sets up a [[ConvexPolygon|convex polygon]] collision geometry based on a list of of points relative\n   *  to the anchor of the associated actor\n   * of this physics body.\n   *\n   * Only [convex polygon](https://en.wikipedia.org/wiki/Convex_polygon) definitions are supported.\n   *\n   * By default, the box is center is at (0, 0) which means it is centered around the actors anchor.\n   */\n  usePolygonCollider(points: Vector[], center: Vector = Vector.Zero): PolygonCollider {\n    const poly = Shape.Polygon(points, false, center);\n    return (this.set(poly));\n  }\n\n  /**\n   * Sets up a [[Circle|circle collision geometry]] as the only collider with a specified radius in pixels.\n   *\n   * By default, the box is center is at (0, 0) which means it is centered around the actors anchor.\n   */\n  useCircleCollider(radius: number, center: Vector = Vector.Zero): CircleCollider {\n    const collider = Shape.Circle(radius, center);\n    return (this.set(collider));\n  }\n\n  /**\n   * Sets up an [[Edge|edge collision geometry]] with a start point and an end point relative to the anchor of the associated actor\n   * of this physics body.\n   *\n   * By default, the box is center is at (0, 0) which means it is centered around the actors anchor.\n   */\n  useEdgeCollider(begin: Vector, end: Vector): EdgeCollider {\n    const collider = Shape.Edge(begin, end);\n    return (this.set(collider));\n  }\n\n  useCompositeCollider(colliders: Collider[]): CompositeCollider {\n    return (this.set(new CompositeCollider(colliders)));\n  }\n}\n","import { Vector } from '../Math/vector';\nimport { CollisionType } from './CollisionType';\nimport { Physics } from './Physics';\nimport { Clonable } from '../Interfaces/Clonable';\nimport { TransformComponent } from '../EntityComponentSystem/Components/TransformComponent';\nimport { MotionComponent } from '../EntityComponentSystem/Components/MotionComponent';\nimport { Component } from '../EntityComponentSystem/Component';\nimport { CollisionGroup } from './Group/CollisionGroup';\nimport { EventDispatcher } from '../EventDispatcher';\nimport { createId, Id } from '../Id';\nimport { clamp } from '../Util/Util';\nimport { ColliderComponent } from './ColliderComponent';\n\nexport interface BodyComponentOptions {\n  type?: CollisionType;\n  group?: CollisionGroup;\n  useGravity?: boolean;\n}\n\nexport enum DegreeOfFreedom {\n  Rotation = 'rotation',\n  X = 'x',\n  Y = 'y'\n}\n\n/**\n * Body describes all the physical properties pos, vel, acc, rotation, angular velocity for the purpose of\n * of physics simulation.\n */\nexport class BodyComponent extends Component<'ex.body'> implements Clonable<BodyComponent> {\n  public readonly type = 'ex.body';\n  public dependencies = [TransformComponent, MotionComponent];\n  public static _ID = 0;\n  public readonly id: Id<'body'> = createId('body', BodyComponent._ID++);\n  public events = new EventDispatcher(this);\n\n  constructor(options?: BodyComponentOptions) {\n    super();\n    if (options) {\n      this.collisionType = options.type ?? this.collisionType;\n      this.group = options.group ?? this.group;\n      this.useGravity = options.useGravity ?? this.useGravity;\n    }\n  }\n\n  /**\n   * Collision type for the rigidbody physics simulation, by default [[CollisionType.PreventCollision]]\n   */\n  public collisionType: CollisionType = CollisionType.PreventCollision;\n\n  /**\n   * The collision group for the body's colliders, by default body colliders collide with everything\n   */\n  public group: CollisionGroup = CollisionGroup.All;\n\n  /**\n   * The amount of mass the body has\n   */\n  public mass: number = Physics.defaultMass;\n\n  /**\n   * The inverse mass (1/mass) of the body. If [[CollisionType.Fixed]] this is 0, meaning \"infinite\" mass\n   */\n  public get inverseMass(): number {\n    return this.collisionType === CollisionType.Fixed ? 0 : 1 / this.mass;\n  }\n\n  /**\n   * Amount of \"motion\" the body has before sleeping. If below [[Physics.sleepEpsilon]] it goes to \"sleep\"\n   */\n  public sleepMotion: number = Physics.sleepEpsilon * 5;\n\n  /**\n   * Can this body sleep, by default bodies do not sleep\n   */\n  public canSleep: boolean = Physics.bodiesCanSleepByDefault;\n\n  private _sleeping = false;\n  /**\n   * Whether this body is sleeping or not\n   */\n  public get sleeping(): boolean {\n    return this._sleeping;\n  }\n\n  /**\n   * Set the sleep state of the body\n   * @param sleeping\n   */\n  public setSleeping(sleeping: boolean) {\n    this._sleeping = sleeping;\n    if (!sleeping) {\n      // Give it a kick to keep it from falling asleep immediately\n      this.sleepMotion = Physics.sleepEpsilon * 5;\n    } else {\n      this.vel = Vector.Zero;\n      this.acc = Vector.Zero;\n      this.angularVelocity = 0;\n      this.sleepMotion = 0;\n    }\n  }\n\n  /**\n   * Update body's [[BodyComponent.sleepMotion]] for the purpose of sleeping\n   */\n  public updateMotion() {\n    if (this._sleeping) {\n      this.setSleeping(true);\n    }\n    const currentMotion = this.vel.size * this.vel.size + Math.abs(this.angularVelocity * this.angularVelocity);\n    const bias = Physics.sleepBias;\n    this.sleepMotion = bias * this.sleepMotion + (1 - bias) * currentMotion;\n    this.sleepMotion = clamp(this.sleepMotion, 0, 10 * Physics.sleepEpsilon);\n    if (this.canSleep && this.sleepMotion < Physics.sleepEpsilon) {\n      this.setSleeping(true);\n    }\n  }\n\n  /**\n   * Get the moment of inertia from the [[ColliderComponent]]\n   */\n  public get inertia() {\n    // Inertia is a property of the geometry, so this is a little goofy but seems to be okay?\n    const collider = this.owner.get(ColliderComponent);\n    if (collider?.get()) {\n      return collider.get().getInertia(this.mass);\n    }\n    return 0;\n  }\n\n  /**\n   * Get the inverse moment of inertial from the [[ColliderComponent]]. If [[CollisionType.Fixed]] this is 0, meaning \"infinite\" mass\n   */\n  public get inverseInertia() {\n    return this.collisionType === CollisionType.Fixed ? 0 : 1 / this.inertia;\n  }\n\n  /**\n   * The also known as coefficient of restitution of this actor, represents the amount of energy preserved after collision or the\n   * bounciness. If 1, it is 100% bouncy, 0 it completely absorbs.\n   */\n  public bounciness: number = 0.2;\n\n  /**\n   * The coefficient of friction on this actor\n   */\n  public friction: number = 0.99;\n\n  /**\n   * Should use global gravity [[Physics.gravity]] in it's physics simulation, default is true\n   */\n  public useGravity: boolean = true;\n\n  /**\n   * Degrees of freedom to limit\n   */\n  public limitDegreeOfFreedom: DegreeOfFreedom[] = [];\n\n  /**\n   * Returns if the owner is active\n   */\n  public get active() {\n    return !!this.owner?.active;\n  }\n\n  public get center() {\n    return this.pos;\n  }\n\n  public get transform(): TransformComponent {\n    return this.owner?.get(TransformComponent);\n  }\n\n  public get motion(): MotionComponent {\n    return this.owner?.get(MotionComponent);\n  }\n\n  /**\n   * The (x, y) position of the actor this will be in the middle of the actor if the\n   * [[Actor.anchor]] is set to (0.5, 0.5) which is default.\n   * If you want the (x, y) position to be the top left of the actor specify an anchor of (0, 0).\n   */\n  public get pos(): Vector {\n    return this.transform.globalPos;\n  }\n\n  public set pos(val: Vector) {\n    this.transform.globalPos = val;\n  }\n\n  /**\n   * The position of the actor last frame (x, y) in pixels\n   */\n  public oldPos: Vector = new Vector(0, 0);\n\n  /**\n   * The current velocity vector (vx, vy) of the actor in pixels/second\n   */\n  public get vel(): Vector {\n    return this.motion.vel;\n  }\n\n  public set vel(val: Vector) {\n    this.motion.vel = val;\n  }\n\n  /**\n   * The velocity of the actor last frame (vx, vy) in pixels/second\n   */\n  public oldVel: Vector = new Vector(0, 0);\n\n  /**\n   * The current acceleration vector (ax, ay) of the actor in pixels/second/second. An acceleration pointing down such as (0, 100) may\n   * be useful to simulate a gravitational effect.\n   */\n  public get acc(): Vector {\n    return this.motion.acc;\n  }\n\n  public set acc(val: Vector) {\n    this.motion.acc = val;\n  }\n\n  /**\n   * Gets/sets the acceleration of the actor from the last frame. This does not include the global acc [[Physics.acc]].\n   */\n  public oldAcc: Vector = Vector.Zero;\n\n  /**\n   * The current torque applied to the actor\n   */\n  public get torque(): number {\n    return this.motion.torque;\n  }\n\n  public set torque(val: number) {\n    this.motion.torque = val;\n  }\n\n  /**\n   * Gets/sets the rotation of the body from the last frame.\n   */\n  public oldRotation: number = 0; // radians\n\n  /**\n   * The rotation of the body in radians\n   */\n  public get rotation() {\n    return this.transform.globalRotation;\n  }\n\n  public set rotation(val: number) {\n    this.transform.globalRotation = val;\n  }\n\n  /**\n   * The scale vector of the actor\n   * @obsolete ex.Body.scale will be removed in v0.25.0, Use ex.Transform.scale\n   */\n  public get scale(): Vector {\n    return this.transform.globalScale;\n  }\n\n  public set scale(val: Vector) {\n    this.transform.globalScale = val;\n  }\n\n  /**\n   * The scale of the actor last frame\n   * @obsolete ex.Body.scale will be removed in v0.25.0\n   */\n  public oldScale: Vector = Vector.One;\n\n  /**\n   * The x scalar velocity of the actor in scale/second\n   * @obsolete ex.Body.scale will be removed in v0.25.0\n   */\n  public get sx(): number {\n    return this.motion.scaleFactor.x;\n  }\n\n  public set sx(xFactor: number) {\n    this.motion.scaleFactor.x = xFactor;\n  }\n\n  /**\n   * The y scalar velocity of the actor in scale/second\n   * @obsolete ex.Body.scale will be removed in v0.25.0\n   */\n  public get sy(): number {\n    return this.motion.scaleFactor.y;\n  }\n\n  public set sy(yFactor: number) {\n    this.motion.scaleFactor.y = yFactor;\n  }\n\n  /**\n   * The rotational velocity of the actor in radians/second\n   * @deprecated\n   */\n  public get rx(): number {\n    return this.motion.angularVelocity;\n  }\n\n  /**\n   * The rotational velocity of the actor in radians/second\n   * @deprecated\n   */\n  public set rx(value: number) {\n    this.motion.angularVelocity = value;\n  }\n\n  /**\n   * Get the angular velocity in radians/second\n   */\n  public get angularVelocity(): number {\n    return this.motion.angularVelocity;\n  }\n\n  /**\n   * Set the angular velocity in radians/second\n   */\n  public set angularVelocity(value: number) {\n    this.motion.angularVelocity = value;\n  }\n\n  /**\n   * Apply a specific impulse to the body\n   * @param point\n   * @param impulse\n   */\n  public applyImpulse(point: Vector, impulse: Vector) {\n    if (this.collisionType !== CollisionType.Active) {\n      return; // only active objects participate in the simulation\n    }\n\n    const finalImpulse = impulse.scale(this.inverseMass);\n    if (this.limitDegreeOfFreedom.includes(DegreeOfFreedom.X)) {\n      finalImpulse.x = 0;\n    }\n    if (this.limitDegreeOfFreedom.includes(DegreeOfFreedom.Y)) {\n      finalImpulse.y = 0;\n    }\n\n    this.vel.addEqual(finalImpulse);\n\n    if (!this.limitDegreeOfFreedom.includes(DegreeOfFreedom.Rotation)) {\n      const distanceFromCenter = point.sub(this.pos);\n      this.angularVelocity += this.inverseInertia * distanceFromCenter.cross(impulse);\n    }\n  }\n\n  /**\n   * Apply only linear impulse to the body\n   * @param impulse\n   */\n  public applyLinearImpulse(impulse: Vector) {\n    if (this.collisionType !== CollisionType.Active) {\n      return; // only active objects participate in the simulation\n    }\n\n    const finalImpulse = impulse.scale(this.inverseMass);\n\n    if (this.limitDegreeOfFreedom.includes(DegreeOfFreedom.X)) {\n      finalImpulse.x = 0;\n    }\n    if (this.limitDegreeOfFreedom.includes(DegreeOfFreedom.Y)) {\n      finalImpulse.y = 0;\n    }\n\n    this.vel = this.vel.add(finalImpulse);\n  }\n\n  /**\n   * Apply only angular impuse to the body\n   * @param point\n   * @param impulse\n   */\n  public applyAngularImpulse(point: Vector, impulse: Vector) {\n    if (this.collisionType !== CollisionType.Active) {\n      return; // only active objects participate in the simulation\n    }\n\n    if (!this.limitDegreeOfFreedom.includes(DegreeOfFreedom.Rotation)) {\n      const distanceFromCenter = point.sub(this.pos);\n      this.angularVelocity += this.inverseInertia * distanceFromCenter.cross(impulse);\n    }\n  }\n\n  /**\n   * Sets the old versions of pos, vel, acc, and scale.\n   */\n  public captureOldTransform() {\n    // Capture old values before integration step updates them\n    this.oldVel.setTo(this.vel.x, this.vel.y);\n    this.oldPos.setTo(this.pos.x, this.pos.y);\n    this.oldAcc.setTo(this.acc.x, this.acc.y);\n    this.oldScale.setTo(this.scale.x, this.scale.y);\n    this.oldRotation = this.rotation;\n  }\n\n  debugDraw(_ctx: CanvasRenderingContext2D) {\n    // pass\n  }\n}\n","import { Vector, vec } from '../Math/vector';\nimport { Actor } from '../Actor';\nimport { Engine } from '../Engine';\nimport { Color } from '../Color';\n\n/**\n * @deprecated Will be removed in 0.26.0\n */\nexport class CullingBox {\n  private _topLeft: Vector = new Vector(0, 0);\n  private _topRight: Vector = new Vector(0, 0);\n  private _bottomLeft: Vector = new Vector(0, 0);\n  private _bottomRight: Vector = new Vector(0, 0);\n\n  private _xCoords: Array<number>;\n  private _yCoords: Array<number>;\n  private _xMin: number;\n  private _yMin: number;\n  private _xMax: number;\n  private _yMax: number;\n\n  private _xMinWorld: number;\n  private _yMinWorld: number;\n  private _xMaxWorld: number;\n  private _yMaxWorld: number;\n\n  public isSpriteOffScreen(actor: Actor, engine: Engine): boolean {\n    const drawingWidth = actor.currentDrawing.drawWidth;\n    const drawingHeight = actor.currentDrawing.drawHeight;\n    const rotation = actor.rotation;\n    const anchor = actor.center;\n    const worldPos = actor.getGlobalPos();\n\n    this._topLeft = vec(worldPos.x - drawingWidth / 2, worldPos.y - drawingHeight / 2);\n    this._topLeft = this._topLeft.rotate(rotation, anchor);\n\n    this._topRight = vec(worldPos.x + drawingWidth / 2, worldPos.y - drawingHeight / 2);\n    this._topRight = this._topRight.rotate(rotation, anchor);\n\n    this._bottomLeft = vec(worldPos.x - drawingWidth / 2, worldPos.y + drawingHeight / 2);\n    this._bottomLeft = this._bottomLeft.rotate(rotation, anchor);\n\n    this._bottomRight = vec(worldPos.x + drawingWidth / 2, worldPos.y + drawingHeight / 2);\n    this._bottomRight = this._bottomRight.rotate(rotation, anchor);\n\n    const topLeftScreen = engine.worldToScreenCoordinates(this._topLeft);\n    const topRightScreen = engine.worldToScreenCoordinates(this._topRight);\n    const bottomLeftScreen = engine.worldToScreenCoordinates(this._bottomLeft);\n    const bottomRightScreen = engine.worldToScreenCoordinates(this._bottomRight);\n    this._xCoords = [];\n    this._yCoords = [];\n\n    this._xCoords.push(topLeftScreen.x, topRightScreen.x, bottomLeftScreen.x, bottomRightScreen.x);\n    this._yCoords.push(topLeftScreen.y, topRightScreen.y, bottomLeftScreen.y, bottomRightScreen.y);\n\n    this._xMin = Math.min.apply(null, this._xCoords);\n    this._yMin = Math.min.apply(null, this._yCoords);\n    this._xMax = Math.max.apply(null, this._xCoords);\n    this._yMax = Math.max.apply(null, this._yCoords);\n\n    const minWorld = engine.screenToWorldCoordinates(new Vector(this._xMin, this._yMin));\n    const maxWorld = engine.screenToWorldCoordinates(new Vector(this._xMax, this._yMax));\n    this._xMinWorld = minWorld.x;\n    this._yMinWorld = minWorld.y;\n    this._xMaxWorld = maxWorld.x;\n    this._yMaxWorld = maxWorld.y;\n\n    const boundingPoints = [\n      new Vector(this._xMin, this._yMin), // top left\n      new Vector(this._xMax, this._yMin), // top right\n      new Vector(this._xMin, this._yMax), // bottom left\n      new Vector(this._xMax, this._yMax) // bottom right\n    ];\n\n    // sprite can be wider than canvas screen (and still visible within canvas)\n    // top or bottom of sprite must be within canvas\n    if (\n      boundingPoints[0].x < 0 &&\n      boundingPoints[1].x > engine.canvas.clientWidth &&\n      (boundingPoints[0].y > 0 || boundingPoints[2].y < engine.canvas.clientHeight)\n    ) {\n      return false;\n    }\n\n    // sprite can be taller than canvas screen (and still visible within canvas)\n    // left or right of sprite must be within canvas\n    if (\n      boundingPoints[0].y < 0 &&\n      boundingPoints[2].y > engine.canvas.clientHeight &&\n      (boundingPoints[1].x > 0 || boundingPoints[0].x < engine.canvas.clientWidth)\n    ) {\n      return false;\n    }\n\n    // otherwise if any corner is visible, we're not offscreen\n    for (let i = 0; i < boundingPoints.length; i++) {\n      if (\n        boundingPoints[i].x > 0 &&\n        boundingPoints[i].y > 0 &&\n        boundingPoints[i].x < engine.canvas.clientWidth &&\n        boundingPoints[i].y < engine.canvas.clientHeight\n      ) {\n        return false;\n      }\n    }\n\n    return true;\n  }\n\n  public debugDraw(ctx: CanvasRenderingContext2D) {\n    // bounding rectangle\n    ctx.beginPath();\n    ctx.strokeStyle = Color.White.toString();\n    ctx.rect(this._xMinWorld, this._yMinWorld, this._xMaxWorld - this._xMinWorld, this._yMaxWorld - this._yMinWorld);\n    ctx.stroke();\n\n    ctx.fillStyle = Color.Red.toString();\n    ctx.beginPath();\n    ctx.arc(this._topLeft.x, this._topLeft.y, 5, 0, Math.PI * 2);\n    ctx.closePath();\n    ctx.fill();\n\n    ctx.fillStyle = Color.Green.toString();\n    ctx.beginPath();\n    ctx.arc(this._topRight.x, this._topRight.y, 5, 0, Math.PI * 2);\n    ctx.closePath();\n    ctx.fill();\n\n    ctx.fillStyle = Color.Blue.toString();\n    ctx.beginPath();\n    ctx.arc(this._bottomLeft.x, this._bottomLeft.y, 5, 0, Math.PI * 2);\n    ctx.closePath();\n    ctx.fill();\n\n    ctx.fillStyle = Color.Magenta.toString();\n    ctx.beginPath();\n    ctx.arc(this._bottomRight.x, this._bottomRight.y, 5, 0, Math.PI * 2);\n    ctx.closePath();\n    ctx.fill();\n  }\n}\n","import { CullingBox } from './../Util/CullingBox';\nimport { Trait } from '../Interfaces/Trait';\nimport { Actor } from '../Actor';\nimport { Engine } from '../Engine';\nimport { ExitViewPortEvent, EnterViewPortEvent } from '../Events';\nimport { TagComponent } from '../EntityComponentSystem';\n\n/**\n * @deprecated will be removed in 0.26.0\n */\nexport class OffscreenCulling implements Trait {\n  public cullingBox: CullingBox = new CullingBox();\n\n  public update(actor: Actor, engine: Engine) {\n    const events = actor.eventDispatcher;\n\n    let isSpriteOffScreen = true;\n    if (actor.currentDrawing != null) {\n      isSpriteOffScreen = this.cullingBox.isSpriteOffScreen(actor, engine);\n    }\n\n    let actorBoundsOffscreen = false;\n    if (engine && engine.currentScene && engine.currentScene.camera && engine.currentScene.camera.viewport && !actor.parent) {\n      actorBoundsOffscreen = !engine.currentScene.camera.viewport.intersect(actor.collider.bounds);\n    }\n\n    if (!actor.isOffScreen) {\n      if (actorBoundsOffscreen && isSpriteOffScreen) {\n        events.emit('exitviewport', new ExitViewPortEvent(actor));\n        actor.addComponent(new TagComponent('offscreen'));\n      }\n    } else {\n      if (!actorBoundsOffscreen || !isSpriteOffScreen) {\n        events.emit('enterviewport', new EnterViewPortEvent(actor));\n        actor.removeComponent('offscreen');\n      }\n    }\n  }\n}\n","import { Trait } from '../Interfaces/Trait';\nimport { Actor } from '../Actor';\nimport { Engine } from '../Engine';\n\n/**\n * Revises pointer events path accordingly to the actor\n * @deprecated Will be removed in 0.26.0\n */\nexport class CapturePointer implements Trait {\n  public update(actor: Actor, engine: Engine) {\n    if (!actor.enableCapturePointer) {\n      return;\n    }\n    if (actor.isKilled()) {\n      return;\n    }\n\n    engine.input.pointers.checkAndUpdateActorUnderPointer(actor);\n  }\n}\n","import { Component, ComponentCtor, TagComponent } from './Component';\n\nimport { Observable, Message } from '../Util/Observable';\nimport { Class } from '../Class';\nimport { OnInitialize, OnPreUpdate, OnPostUpdate } from '../Interfaces/LifecycleEvents';\nimport { Engine } from '../Engine';\nimport { InitializeEvent, PreUpdateEvent, PostUpdateEvent } from '../Events';\nimport { EventDispatcher } from '../EventDispatcher';\nimport { Util } from '..';\n\n/**\n * Interface holding an entity component pair\n */\nexport interface EntityComponent {\n  component: Component;\n  entity: Entity;\n}\n\n/**\n * AddedComponent message\n */\nexport class AddedComponent implements Message<EntityComponent> {\n  readonly type: 'Component Added' = 'Component Added';\n  constructor(public data: EntityComponent) {}\n}\n\n/**\n * Type guard to know if message is f an Added Component\n */\nexport function isAddedComponent(x: Message<EntityComponent>): x is AddedComponent {\n  return !!x && x.type === 'Component Added';\n}\n\n/**\n * RemovedComponent message\n */\nexport class RemovedComponent implements Message<EntityComponent> {\n  readonly type: 'Component Removed' = 'Component Removed';\n  constructor(public data: EntityComponent) {}\n}\n\n/**\n * Type guard to know if message is for a Removed Component\n */\nexport function isRemovedComponent(x: Message<EntityComponent>): x is RemovedComponent {\n  return !!x && x.type === 'Component Removed';\n}\n\n/**\n * An Entity is the base type of anything that can have behavior in Excalibur, they are part of the built in entity component system\n *\n * Entities can be strongly typed with the components they contain\n *\n * ```typescript\n * const entity = new Entity<ComponentA | ComponentB>();\n * entity.components.a; // Type ComponentA\n * entity.components.b; // Type ComponentB\n * ```\n */\nexport class Entity extends Class implements OnInitialize, OnPreUpdate, OnPostUpdate {\n  private static _ID = 0;\n\n  constructor(components?: Component[], name?: string) {\n    super();\n    this._setName(name);\n    if (components) {\n      for (const component of components) {\n        this.addComponent(component);\n      }\n    }\n  }\n\n  /**\n   * The unique identifier for the entity\n   */\n  public id: number = Entity._ID++;\n\n  private _name: string = 'anonymous';\n  protected _setName(name: string) {\n    if (name) {\n      this._name = name;\n    }\n  }\n  public get name(): string {\n    return this._name;\n  }\n\n  public get events(): EventDispatcher {\n    return this.eventDispatcher;\n  }\n\n  /**\n   * Whether this entity is active, if set to false it will be reclaimed\n   */\n  public active: boolean = true;\n\n  /**\n   * Kill the entity, means it will no longer be updated. Kills are deferred to the end of the update.\n   */\n  public kill() {\n    this.active = false;\n  }\n\n  public isKilled() {\n    return !this.active;\n  }\n\n  /**\n   * Specifically get the tags on the entity from [[TagComponent]]\n   */\n  public get tags(): readonly string[] {\n    return this._tagsMemo;\n  }\n\n  /**\n   * Check if a tag exists on the entity\n   * @param tag name to check for\n   */\n  public hasTag(tag: string): boolean {\n    return this.tags.includes(tag);\n  }\n\n  /**\n   * Adds a tag to an entity\n   * @param tag\n   * @returns Entity\n   */\n  public addTag(tag: string) {\n    return this.addComponent(new TagComponent(tag));\n  }\n\n  /**\n   * Removes a tag on the entity\n   *\n   * Removals are deferred until the end of update\n   * @param tag\n   * @param force Remove component immediately, no deferred\n   */\n  public removeTag(tag: string, force = false) {\n    return this.removeComponent(tag, force);\n  }\n\n  /**\n   * The types of the components on the Entity\n   */\n  public get types(): string[] {\n    return this._typesMemo;\n  }\n\n  /**\n   * Bucket to hold on to deferred removals\n   */\n  private _componentsToRemove: (Component | string)[] = [];\n  private _componentTypeToInstance = new Map<ComponentCtor, Component>();\n  private _componentStringToInstance = new Map<string, Component>();\n\n  private _tagsMemo: string[] = [];\n  private _typesMemo: string[] = [];\n  private _rebuildMemos() {\n    this._tagsMemo = Array.from(this._componentStringToInstance.values())\n      .filter((c) => c instanceof TagComponent)\n      .map((c) => c.type);\n    this._typesMemo = Array.from(this._componentStringToInstance.keys());\n  }\n\n  public getComponents(): Component[] {\n    return Array.from(this._componentStringToInstance.values());\n  }\n\n  /**\n   * Observable that keeps track of component add or remove changes on the entity\n   */\n  public componentAdded$ = new Observable<AddedComponent>();\n  private _notifyAddComponent(component: Component) {\n    this._rebuildMemos();\n    const added = new AddedComponent({\n      component,\n      entity: this\n    });\n    this.componentAdded$.notifyAll(added);\n  }\n\n  public componentRemoved$ = new Observable<RemovedComponent>();\n  private _notifyRemoveComponent(component: Component) {\n    const removed = new RemovedComponent({\n      component,\n      entity: this\n    });\n    this.componentRemoved$.notifyAll(removed);\n    this._rebuildMemos();\n  }\n\n  private _parent: Entity = null;\n  public get parent(): Entity {\n    return this._parent;\n  }\n\n  public childrenAdded$ = new Observable<Entity>();\n  public childrenRemoved$ = new Observable<Entity>();\n\n  private _children: Entity[] = [];\n  /**\n   * Get the direct children of this entity\n   */\n  public get children(): readonly Entity[] {\n    return this._children;\n  }\n\n  /**\n   * Unparents this entity, if there is a parent. Otherwise it does nothing.\n   */\n  public unparent() {\n    if (this._parent) {\n      this._parent.removeChild(this);\n      this._parent = null;\n    }\n  }\n\n  /**\n   * Adds an entity to be a child of this entity\n   * @param entity\n   */\n  public addChild(entity: Entity): Entity {\n    if (entity.parent === null) {\n      if (this.getAncestors().includes(entity)) {\n        throw new Error('Cycle detected, cannot add entity');\n      }\n      this._children.push(entity);\n      entity._parent = this;\n      this.childrenAdded$.notifyAll(entity);\n    } else {\n      throw new Error('Entity already has a parent, cannot add without unparenting');\n    }\n    return this;\n  }\n\n  /**\n   * Remove an entity from children if it exists\n   * @param entity\n   */\n  public removeChild(entity: Entity): Entity {\n    if (entity.parent === this) {\n      Util.removeItemFromArray(entity, this._children);\n      entity._parent = null;\n      this.childrenRemoved$.notifyAll(entity);\n    }\n    return this;\n  }\n\n  /**\n   * Removes all children from this entity\n   */\n  public removeAllChildren(): Entity {\n    this.children.forEach((c) => {\n      this.removeChild(c);\n    });\n    return this;\n  }\n\n  /**\n   * Returns a list of parent entities starting with the topmost parent. Includes the current entity.\n   */\n  public getAncestors(): Entity[] {\n    const result: Entity[] = [this];\n    let current = this.parent;\n    while (current) {\n      result.push(current);\n      current = current.parent;\n    }\n    return result.reverse();\n  }\n\n  /**\n   * Returns a list of all the entities that descend from this entity. Includes the current entity.\n   */\n  public getDescendants(): Entity[] {\n    let result: Entity[] = [this];\n    let queue: Entity[] = [this];\n    while (queue.length > 0) {\n      const curr = queue.pop();\n      queue = queue.concat(curr.children);\n      result = result.concat(curr.children);\n    }\n    return result;\n  }\n\n  /**\n   * Creates a deep copy of the entity and a copy of all its components\n   */\n  public clone(): Entity {\n    const newEntity = new Entity();\n    for (const c of this.types) {\n      newEntity.addComponent(this.get(c).clone());\n    }\n    for (const child of this.children) {\n      newEntity.addChild(child.clone());\n    }\n    return newEntity;\n  }\n\n  /**\n   * Adds a copy of all the components from another template entity as a \"prefab\"\n   * @param templateEntity Entity to use as a template\n   * @param force Force component replacement if it aleady exists on the target entity\n   */\n  public addTemplate(templateEntity: Entity, force: boolean = false): Entity {\n    for (const c of templateEntity.getComponents()) {\n      this.addComponent(c.clone(), force);\n    }\n    for (const child of templateEntity.children) {\n      this.addChild(child.clone().addTemplate(child));\n    }\n    return this;\n  }\n\n  /**\n   * Adds a component to the entity\n   * @param component Component or Entity to add copy of components from\n   * @param force Optionally overwrite any existing components of the same type\n   */\n  public addComponent<T extends Component>(component: T, force: boolean = false): Entity {\n    // if component already exists, skip if not forced\n    if (this.has(component.type)) {\n      if (force) {\n        // Remove existing component type if exists when forced\n        this.removeComponent(component);\n      } else {\n        // early exit component exiss\n        return this;\n      }\n    }\n\n    // TODO circular dependencies will be a problem\n    if (component.dependencies && component.dependencies.length) {\n      for (const ctor of component.dependencies) {\n        this.addComponent(new ctor());\n      }\n    }\n\n    component.owner = this;\n    const constuctorType = component.constructor as ComponentCtor<T>;\n    this._componentTypeToInstance.set(constuctorType, component);\n    this._componentStringToInstance.set(component.type, component);\n    if (component.onAdd) {\n      component.onAdd(this);\n    }\n    this._notifyAddComponent(component);\n\n    return this;\n  }\n\n  /**\n   * Removes a component from the entity, by default removals are deferred to the end of entity update to avoid consistency issues\n   *\n   * Components can be force removed with the `force` flag, the removal is not deferred and happens immediately\n   * @param componentOrType\n   * @param force\n   */\n  public removeComponent<ComponentOrType extends string | Component>(componentOrType: ComponentOrType, force = false): Entity {\n    if (force) {\n      if (typeof componentOrType === 'string') {\n        this._removeComponentByType(componentOrType);\n      } else if (componentOrType instanceof Component) {\n        this._removeComponentByType(componentOrType.type);\n      }\n    } else {\n      this._componentsToRemove.push(componentOrType);\n    }\n\n    return this as any;\n  }\n\n  private _removeComponentByType(type: string) {\n    if (this.has(type)) {\n      const component = this.get(type);\n      component.owner = null;\n      if (component.onRemove) {\n        component.onRemove(this);\n      }\n      const ctor = component.constructor as ComponentCtor;\n      this._componentTypeToInstance.delete(ctor);\n      this._componentStringToInstance.delete(component.type);\n      this._notifyRemoveComponent(component);\n    }\n  }\n\n  /**\n   * @hidden\n   * @internal\n   */\n  public processComponentRemoval() {\n    for (const componentOrType of this._componentsToRemove) {\n      const type = typeof componentOrType === 'string' ? componentOrType : componentOrType.type;\n      this._removeComponentByType(type);\n    }\n    this._componentsToRemove.length = 0;\n  }\n\n  /**\n   * Check if a component type exists\n   * @param type\n   */\n  public has<T extends Component>(type: ComponentCtor<T>): boolean;\n  public has(type: string): boolean;\n  public has<T extends Component>(type: ComponentCtor<T> | string): boolean {\n    if (typeof type === 'string') {\n      return this._componentStringToInstance.has(type);\n    } else {\n      return this._componentTypeToInstance.has(type);\n    }\n  }\n\n  /**\n   * Get a component by type with typecheck\n   *\n   * (Does not work on tag components, use .hasTag(\"mytag\") instead)\n   * @param type\n   */\n  public get<T extends Component>(type: ComponentCtor<T>): T | null;\n  public get<T extends Component>(type: string): T | null;\n  public get<T extends Component>(type: ComponentCtor<T> | string): T | null {\n    if (typeof type === 'string') {\n      return this._componentStringToInstance.get(type) as T;\n    } else {\n      return this._componentTypeToInstance.get(type) as T;\n    }\n  }\n\n  private _isInitialized = false;\n\n  /**\n   * Gets whether the actor is Initialized\n   */\n  public get isInitialized(): boolean {\n    return this._isInitialized;\n  }\n\n  /**\n   * Initializes this entity, meant to be called by the Scene before first update not by users of Excalibur.\n   *\n   * It is not recommended that internal excalibur methods be overriden, do so at your own risk.\n   *\n   * @internal\n   */\n  public _initialize(engine: Engine) {\n    if (!this.isInitialized) {\n      this.onInitialize(engine);\n      super.emit('initialize', new InitializeEvent(engine, this));\n      this._isInitialized = true;\n    }\n  }\n\n  /**\n   * It is not recommended that internal excalibur methods be overriden, do so at your own risk.\n   *\n   * Internal _preupdate handler for [[onPreUpdate]] lifecycle event\n   * @internal\n   */\n  public _preupdate(engine: Engine, delta: number): void {\n    this.emit('preupdate', new PreUpdateEvent(engine, delta, this));\n    this.onPreUpdate(engine, delta);\n  }\n\n  /**\n   * It is not recommended that internal excalibur methods be overriden, do so at your own risk.\n   *\n   * Internal _preupdate handler for [[onPostUpdate]] lifecycle event\n   * @internal\n   */\n  public _postupdate(engine: Engine, delta: number): void {\n    this.emit('postupdate', new PostUpdateEvent(engine, delta, this));\n    this.onPostUpdate(engine, delta);\n  }\n\n  /**\n   * `onInitialize` is called before the first update of the entity. This method is meant to be\n   * overridden.\n   *\n   * Synonymous with the event handler `.on('initialize', (evt) => {...})`\n   */\n  public onInitialize(_engine: Engine): void {\n    // Override me\n  }\n\n  /**\n   * Safe to override onPreUpdate lifecycle event handler. Synonymous with `.on('preupdate', (evt) =>{...})`\n   *\n   * `onPreUpdate` is called directly before an entity is updated.\n   */\n  public onPreUpdate(_engine: Engine, _delta: number): void {\n    // Override me\n  }\n\n  /**\n   * Safe to override onPostUpdate lifecycle event handler. Synonymous with `.on('postupdate', (evt) =>{...})`\n   *\n   * `onPostUpdate` is called directly after an entity is updated.\n   */\n  public onPostUpdate(_engine: Engine, _delta: number): void {\n    // Override me\n  }\n\n  /**\n   *\n   * Entity update lifecycle, called internally\n   *\n   * @internal\n   * @param engine\n   * @param delta\n   */\n  public update(engine: Engine, delta: number): void {\n    this._initialize(engine);\n    this._preupdate(engine, delta);\n    for (const child of this.children) {\n      child.update(engine, delta);\n    }\n    this._postupdate(engine, delta);\n  }\n}\n","import { Component } from '../EntityComponentSystem';\n\n/**\n * Shim to draw to the canvas when in LegacyDrawing mode\n * @deprecated\n */\nexport class CanvasDrawComponent extends Component<'ex.canvas'> {\n  public readonly type = 'ex.canvas';\n\n  constructor(public draw?: (ctx: CanvasRenderingContext2D, delta: number) => void) {\n    super();\n    // eslint-disable-next-line @typescript-eslint/no-empty-function\n    this.draw = this.draw ?? (() => {});\n  }\n}\n","import { Vector, vec } from '../Math/vector';\nimport { Graphic } from './Graphic';\nimport { HasTick } from './Animation';\nimport { ExcaliburGraphicsContext } from './Context/ExcaliburGraphicsContext';\nimport { Logger } from '../Util/Log';\nimport { BoundingBox } from '../Collision/Index';\nimport { Component } from '../EntityComponentSystem/Component';\n\n/**\n * Type guard for checking if a Graphic HasTick (used for graphics that change over time like animations)\n * @param graphic\n */\nexport function hasGraphicsTick(graphic: Graphic): graphic is Graphic & HasTick {\n  return !!(graphic as unknown as HasTick).tick;\n}\nexport interface GraphicsShowOptions {\n  offset?: Vector;\n  anchor?: Vector;\n}\n\nexport interface GraphicsComponentOptions {\n  onPostDraw?: (ex: ExcaliburGraphicsContext, elapsed: number) => void;\n  onPreDraw?: (ex: ExcaliburGraphicsContext, elapsed: number) => void;\n\n  /**\n   * Name of current graphic to use\n   */\n  current?: string;\n\n  /**\n   * Optionally copy instances of graphics by calling .clone(), you may set this to false to avoid sharing graphics when added to the\n   * component for performance reasons. By default graphics are not copied and are shared when added to the component.\n   */\n  copyGraphics?: boolean;\n\n  /**\n   * Optional visible flag, if the graphics component is not visible it will not be displayed\n   */\n  visible?: boolean;\n\n  /**\n   * Optional opacity\n   */\n  opacity?: number;\n\n  /**\n   * List of graphics\n   */\n  graphics?: { [graphicName: string]: Graphic };\n\n  /**\n   * Optional offset in absolute pixels to shift all graphics in this component from each graphic's anchor (default is top left corner)\n   */\n  offset?: Vector;\n\n  /**\n   * Optional anchor\n   */\n  anchor?: Vector;\n}\n\nexport interface GraphicsLayerOptions {\n  /**\n   * Name of the layer required, for example 'background'\n   */\n  name: string;\n  /**\n   * Order of the layer, a layer with order -1 will be below a layer with order of 1\n   */\n  order: number;\n  /**\n   * Offset to shift the entire layer\n   */\n  offset?: Vector;\n}\nexport class GraphicsLayer {\n  public graphics: { graphic: Graphic; options: GraphicsShowOptions }[] = [];\n  constructor(private _options: GraphicsLayerOptions, private _graphics: GraphicsComponent) {}\n  public get name(): string {\n    return this._options.name;\n  }\n\n  /**\n   * Remove any instance(s) of a graphic currently being shown in this layer\n   */\n  public hide(nameOrGraphic: string | Graphic): void;\n  /**\n   * Remove all currently shown graphics in this layer\n   */\n  public hide(): void;\n  public hide(nameOrGraphic?: string | Graphic): void {\n    if (!nameOrGraphic) {\n      this.graphics.length = 0;\n    } else {\n      let gfx: Graphic = null;\n      if (nameOrGraphic instanceof Graphic) {\n        gfx = nameOrGraphic;\n      } else {\n        gfx = this._graphics.getGraphic(nameOrGraphic);\n      }\n      this.graphics = this.graphics.filter((g) => g.graphic !== gfx);\n    }\n  }\n\n  /**\n   * Show a graphic by name or instance at an offset, graphics are shown in the order in which `show()` is called.\n   *\n   * If `show()` is called multiple times for the same graphic it will be shown multiple times.\n   * @param nameOrGraphic\n   * @param options\n   */\n  public show<T extends Graphic = Graphic>(nameOrGraphic: string | T, options?: GraphicsShowOptions): T {\n    options = { ...options };\n    let gfx: Graphic;\n    if (nameOrGraphic instanceof Graphic) {\n      gfx = this._graphics.copyGraphics ? nameOrGraphic.clone() : nameOrGraphic;\n    } else {\n      gfx = this._graphics.getGraphic(nameOrGraphic);\n      if (!gfx) {\n        Logger.getInstance().error(\n          `No such graphic added to component named ${nameOrGraphic}. These named graphics are available: `,\n          this._graphics.getNames()\n        );\n      }\n    }\n    if (gfx) {\n      this.graphics.push({ graphic: gfx, options });\n      return gfx as T;\n    } else {\n      return null;\n    }\n  }\n\n  /**\n   * Use a specific graphic, swap out any current graphics being shown\n   * @param nameOrGraphic\n   * @param options\n   */\n  public use<T extends Graphic = Graphic>(nameOrGraphic: string | T, options?: GraphicsShowOptions): T {\n    options = { ...options };\n    this.hide();\n    return this.show<T>(nameOrGraphic, options);\n  }\n\n  /**\n   * Current order of the layer, higher numbers are on top, lower numbers are on the bottom.\n   *\n   * For example a layer with `order = -1` would be under a layer of `order = 1`\n   */\n  public get order(): number {\n    return this._options.order;\n  }\n\n  /**\n   * Set the order of the layer, higher numbers are on top, lower numbers are on the bottom.\n   *\n   * For example a layer with `order = -1` would be under a layer of `order = 1`\n   */\n  public set order(order: number) {\n    this._options.order = order;\n  }\n\n  /**\n   * Get or set the pixel offset from the layer anchor for all graphics in the layer\n   */\n  public get offset(): Vector {\n    return this._options.offset ?? Vector.Zero;\n  }\n\n  public set offset(value: Vector) {\n    this._options.offset = value;\n  }\n}\n\nexport class GraphicsLayers {\n  private _layers: GraphicsLayer[] = [];\n  private _layerMap: { [layerName: string]: GraphicsLayer } = {};\n  public default: GraphicsLayer;\n  constructor(private _component: GraphicsComponent) {\n    this.default = new GraphicsLayer({ name: 'default', order: 0 }, _component);\n    this._maybeAddLayer(this.default);\n  }\n  public create(options: GraphicsLayerOptions): GraphicsLayer {\n    const layer = new GraphicsLayer(options, this._component);\n    return this._maybeAddLayer(layer);\n  }\n\n  /**\n   * Retrieve a single layer by name\n   * @param name\n   */\n  public get(name: string): GraphicsLayer;\n  /**\n   * Retrieve all layers\n   */\n  public get(): readonly GraphicsLayer[];\n  public get(name?: string): GraphicsLayer | readonly GraphicsLayer[] {\n    if (name) {\n      return this._getLayer(name);\n    }\n    return this._layers;\n  }\n\n  public has(name: string): boolean {\n    return name in this._layerMap;\n  }\n\n  private _maybeAddLayer(layer: GraphicsLayer) {\n    if (this._layerMap[layer.name]) {\n      // todo log warning\n      return this._layerMap[layer.name];\n    }\n    this._layerMap[layer.name] = layer;\n    this._layers.push(layer);\n    this._layers.sort((a, b) => a.order - b.order);\n    return layer;\n  }\n\n  private _getLayer(name: string): GraphicsLayer | undefined {\n    return this._layerMap[name];\n  }\n}\n\n/**\n * Component to manage drawings, using with the position component\n */\nexport class GraphicsComponent extends Component<'ex.graphics'> {\n  readonly type = 'ex.graphics';\n\n  private _graphics: { [graphicName: string]: Graphic } = {};\n\n  public layers: GraphicsLayers;\n\n  public getGraphic(name: string): Graphic | undefined {\n    return this._graphics[name];\n  }\n\n  /**\n   * Get registered graphics names\n   */\n  public getNames(): string[] {\n    return Object.keys(this._graphics);\n  }\n\n  /**\n   * Draws after the entity transform has bene applied, but before graphics component graphics have been drawn\n   */\n  public onPreDraw: (ctx: ExcaliburGraphicsContext, elapsedMilliseconds: number) => void;\n\n  /**\n   * Draws after the entity transform has been applied, and after graphics component graphics has been drawn\n   */\n  public onPostDraw: (ctx: ExcaliburGraphicsContext, elapsedMilliseconds: number) => void;\n\n  /**\n   * Sets or gets wether any drawing should be visible in this component\n   */\n  public visible: boolean = true;\n\n  /**\n   * Sets or gets wither all drawings should have an opacity applied\n   */\n  public opacity: number = 1;\n\n  /**\n   * Offset to apply to graphics by default\n   */\n  public offset: Vector = Vector.Zero;\n\n  /**\n   * Anchor to apply to graphics by default\n   */\n  public anchor: Vector = Vector.Half;\n\n  /**\n   * If set to true graphics added to the component will be copied. This can affect performance\n   */\n  public copyGraphics: boolean = false;\n\n  constructor(options?: GraphicsComponentOptions) {\n    super();\n    // Defaults\n    options = {\n      visible: this.visible,\n      ...options\n    };\n\n    const { current, anchor, opacity, visible, graphics, offset, copyGraphics, onPreDraw, onPostDraw } = options;\n\n    this._graphics = graphics || {};\n    this.offset = offset ?? this.offset;\n    this.opacity = opacity ?? this.opacity;\n    this.anchor = anchor ?? this.anchor;\n    this.copyGraphics = copyGraphics ?? this.copyGraphics;\n    this.onPreDraw = onPreDraw ?? this.onPreDraw;\n    this.onPostDraw = onPostDraw ?? this.onPostDraw;\n    this.visible = !!visible;\n\n    this.layers = new GraphicsLayers(this);\n    if (current && this._graphics[current]) {\n      this.show(this._graphics[current]);\n    }\n  }\n\n  /**\n   * Returns the currently displayed graphics and their offsets, empty array if hidden\n   */\n  public get current(): { graphic: Graphic; options: GraphicsShowOptions }[] {\n    return this.layers.default.graphics;\n  }\n\n  /**\n   * Returns all graphics associated with this component\n   */\n  public get graphics(): { [graphicName: string]: Graphic } {\n    return this._graphics;\n  }\n\n  /**\n   * Adds a named graphic to this component, if the name is \"default\" or not specified, it will be shown by default without needing to call\n   * `show(\"default\")`\n   * @param graphic\n   */\n  public add(graphic: Graphic): Graphic;\n  public add(name: string, graphic: Graphic): Graphic;\n  public add(nameOrGraphic: string | Graphic, graphic?: Graphic): Graphic {\n    let name = 'default';\n    let graphicToSet: Graphic = null;\n    if (typeof nameOrGraphic === 'string') {\n      name = nameOrGraphic;\n      graphicToSet = graphic;\n    } else {\n      graphicToSet = nameOrGraphic;\n    }\n\n    this._graphics[name] = this.copyGraphics ? graphicToSet.clone() : graphicToSet;\n    if (name === 'default') {\n      this.show('default');\n    }\n    return graphicToSet;\n  }\n\n  /**\n   * Show a graphic by name on the **default** layer, returns the new [[Graphic]]\n   */\n  public show<T extends Graphic = Graphic>(nameOrGraphic: string | T, options?: GraphicsShowOptions): T {\n    return this.layers.default.show<T>(nameOrGraphic, options);\n  }\n\n  /**\n   * Use a graphic only, swap out any graphics on the **default** layer, returns the new [[Graphic]]\n   * @param nameOrGraphic\n   * @param options\n   */\n  public use<T extends Graphic = Graphic>(nameOrGraphic: string | T, options?: GraphicsShowOptions): T {\n    return this.layers.default.use<T>(nameOrGraphic, options);\n  }\n\n  /**\n   * Remove any instance(s) of a graphic currently being shown in the **default** layer\n   */\n  public hide(nameOrGraphic: string | Graphic): void;\n  /**\n   * Remove all currently shown graphics in the **default** layer\n   */\n  public hide(): void;\n  public hide(nameOrGraphic?: string | Graphic): void {\n    this.layers.default.hide(nameOrGraphic);\n  }\n\n  private _bounds: BoundingBox = null;\n  public set localBounds(bounds: BoundingBox) {\n    this._bounds = bounds;\n  }\n\n  public get localBounds(): BoundingBox {\n    if (this._bounds) {\n      return this._bounds;\n    }\n    let bb = new BoundingBox();\n    for (const layer of this.layers.get()) {\n      for (const { graphic, options } of layer.graphics) {\n        let anchor = this.anchor;\n        let offset = this.offset;\n        if (options?.anchor) {\n          anchor = options.anchor;\n        }\n        if (options?.offset) {\n          offset = options.offset;\n        }\n        const bounds = graphic.localBounds;\n        const offsetX = -bounds.width * graphic.scale.x * anchor.x + offset.x;\n        const offsetY = -bounds.height * graphic.scale.y * anchor.y + offset.y;\n        bb = graphic?.localBounds.translate(vec(offsetX + layer.offset.x, offsetY + layer.offset.y)).combine(bb);\n      }\n    }\n    return bb;\n  }\n\n  /**\n   * Update underlying graphics if necesary, called internally\n   * @param elapsed\n   * @internal\n   */\n  public update(elapsed: number, idempotencyToken: number = 0) {\n    for (const layer of this.layers.get()) {\n      for (const { graphic } of layer.graphics) {\n        if (hasGraphicsTick(graphic)) {\n          graphic?.tick(elapsed, idempotencyToken);\n        }\n      }\n    }\n  }\n}\n","import { Raster, RasterOptions } from './Raster';\n\nexport interface RectangleOptions {\n  width: number;\n  height: number;\n}\n\n/**\n * A Rectangle [[Graphic]] for drawing rectangles to the [[ExcaliburGraphicsContext]]\n */\nexport class Rectangle extends Raster {\n  constructor(options: RasterOptions & RectangleOptions) {\n    super(options);\n    this.width = options.width;\n    this.height = options.height;\n    this.rasterize();\n  }\n\n  public clone(): Rectangle {\n    return new Rectangle({\n      width: this.width,\n      height: this.height,\n      ...this.cloneGraphicOptions(),\n      ...this.cloneRasterOptions()\n    });\n  }\n\n  execute(ctx: CanvasRenderingContext2D): void {\n    if (this.color) {\n      ctx.fillRect(0, 0, this.width, this.height);\n    }\n    if (this.strokeColor) {\n      ctx.strokeRect(0, 0, this.width, this.height);\n    }\n  }\n}\n","import { Raster, RasterOptions } from './Raster';\n\nexport interface CircleOptions {\n  radius: number;\n}\n\n/**\n * A circle [[Graphic]] for drawing circles to the [[ExcaliburGraphicsContext]]\n */\nexport class Circle extends Raster {\n  private _radius: number = 0;\n  public get radius() {\n    return this._radius;\n  }\n  public set radius(value: number) {\n    this._radius = value;\n    this.width = this._radius * 2;\n    this.height = this._radius * 2;\n    this.flagDirty();\n  }\n  constructor(options: RasterOptions & CircleOptions) {\n    super(options);\n    this.padding = options.padding ?? 2; // default 2 padding for circles looks nice\n    this.radius = options.radius;\n    this.rasterize();\n  }\n\n  public clone(): Circle {\n    return new Circle({\n      radius: this.radius,\n      ...this.cloneGraphicOptions(),\n      ...this.cloneRasterOptions()\n    });\n  }\n\n  execute(ctx: CanvasRenderingContext2D): void {\n    if (this.radius > 0) {\n      ctx.beginPath();\n      ctx.arc(this.radius, this.radius, this.radius, 0, Math.PI * 2);\n\n      if (this.color) {\n        ctx.fill();\n      }\n\n      if (this.strokeColor) {\n        ctx.stroke();\n      }\n    }\n  }\n}\n","import { Color } from '../Color';\nimport { Vector } from '../Math/vector';\nimport { ExcaliburGraphicsContext } from './Context/ExcaliburGraphicsContext';\n\n/**\n * Enum representing the different font size units\n * https://developer.mozilla.org/en-US/docs/Web/CSS/font-size\n */\nexport enum FontUnit {\n  /**\n   * Em is a scalable unit, 1 em is equal to the current font size of the current element, parent elements can effect em values\n   */\n  Em = 'em',\n  /**\n   * Rem is similar to the Em, it is a scalable unit. 1 rem is equal to the font size of the root element\n   */\n  Rem = 'rem',\n  /**\n   * Pixel is a unit of length in screen pixels\n   */\n  Px = 'px',\n  /**\n   * Point is a physical unit length (1/72 of an inch)\n   */\n  Pt = 'pt',\n  /**\n   * Percent is a scalable unit similar to Em, the only difference is the Em units scale faster when Text-Size stuff\n   */\n  Percent = '%'\n}\n\n/**\n * Enum representing the different horizontal text alignments\n */\nexport enum TextAlign {\n  /**\n   * The text is left-aligned.\n   */\n  Left = 'left',\n  /**\n   * The text is right-aligned.\n   */\n  Right = 'right',\n  /**\n   * The text is centered.\n   */\n  Center = 'center',\n  /**\n   * The text is aligned at the normal start of the line (left-aligned for left-to-right locales,\n   * right-aligned for right-to-left locales).\n   */\n  Start = 'start',\n  /**\n   * The text is aligned at the normal end of the line (right-aligned for left-to-right locales,\n   * left-aligned for right-to-left locales).\n   */\n  End = 'end'\n}\n\n/**\n * Enum representing the different baseline text alignments\n */\nexport enum BaseAlign {\n  /**\n   * The text baseline is the top of the em square.\n   */\n  Top = 'top',\n  /**\n   * The text baseline is the hanging baseline.  Currently unsupported; this will act like\n   * alphabetic.\n   */\n  Hanging = 'hanging',\n  /**\n   * The text baseline is the middle of the em square.\n   */\n  Middle = 'middle',\n  /**\n   * The text baseline is the normal alphabetic baseline.\n   */\n  Alphabetic = 'alphabetic',\n  /**\n   * The text baseline is the ideographic baseline; this is the bottom of\n   * the body of the characters, if the main body of characters protrudes\n   * beneath the alphabetic baseline.  Currently unsupported; this will\n   * act like alphabetic.\n   */\n  Ideographic = 'ideographic',\n  /**\n   * The text baseline is the bottom of the bounding box.  This differs\n   * from the ideographic baseline in that the ideographic baseline\n   * doesn't consider descenders.\n   */\n  Bottom = 'bottom'\n}\n\n/**\n * Enum representing the different possible font styles\n */\nexport enum FontStyle {\n  Normal = 'normal',\n  Italic = 'italic',\n  Oblique = 'oblique'\n}\n\nexport enum Direction {\n  LeftToRight = 'ltr',\n  RightToLeft = 'rtl'\n}\n\nexport interface FontOptions {\n  size?: number;\n  unit?: FontUnit;\n  lineHeight?: number;\n  family?: string;\n  style?: FontStyle;\n  bold?: boolean;\n  textAlign?: TextAlign;\n  baseAlign?: BaseAlign;\n  direction?: Direction;\n  quality?: number;\n  shadow?: {\n    blur?: number;\n    offset?: Vector;\n    color?: Color;\n  };\n}\n\nexport interface FontRenderer {\n  render(ex: ExcaliburGraphicsContext, text: string, x: number, y: number): void;\n}\n","import { Texture } from './Drawing/Texture';\nimport {\n  InitializeEvent,\n  KillEvent,\n  PreUpdateEvent,\n  PostUpdateEvent,\n  PreDrawEvent,\n  PostDrawEvent,\n  PreDebugDrawEvent,\n  PostDebugDrawEvent,\n  PostCollisionEvent,\n  PreCollisionEvent,\n  CollisionStartEvent,\n  CollisionEndEvent,\n  PostKillEvent,\n  PreKillEvent,\n  GameEvent,\n  ExitTriggerEvent,\n  EnterTriggerEvent,\n  EnterViewPortEvent,\n  ExitViewPortEvent\n} from './Events';\nimport { PointerEvent, WheelEvent, PointerDragEvent, PointerEventName } from './Input/PointerEvents';\nimport { Engine } from './Engine';\nimport { Color } from './Color';\nimport { Sprite } from './Drawing/Sprite';\nimport { Animation } from './Drawing/Animation';\nimport { Trait } from './Interfaces/Trait';\nimport { Drawable } from './Interfaces/Drawable';\nimport { CanInitialize, CanUpdate, CanDraw, CanBeKilled } from './Interfaces/LifecycleEvents';\nimport { Scene } from './Scene';\nimport { Logger } from './Util/Log';\nimport { ActionContext } from './Actions/ActionContext';\nimport { Vector, vec } from './Math/vector';\nimport { BodyComponent } from './Collision/BodyComponent';\nimport { Eventable } from './Interfaces/Evented';\nimport { Actionable } from './Actions/Actionable';\nimport * as Traits from './Traits/Index';\nimport * as Events from './Events';\nimport { PointerEvents } from './Interfaces/PointerEventHandlers';\nimport { CollisionType } from './Collision/CollisionType';\n\nimport { Entity } from './EntityComponentSystem/Entity';\nimport { CanvasDrawComponent } from './Drawing/CanvasDrawComponent';\nimport { TransformComponent } from './EntityComponentSystem/Components/TransformComponent';\nimport { MotionComponent } from './EntityComponentSystem/Components/MotionComponent';\nimport { GraphicsComponent } from './Graphics/GraphicsComponent';\nimport { Rectangle } from './Graphics/Rectangle';\nimport { Flags, Legacy } from './Flags';\nimport { obsolete } from './Util/Decorators';\nimport { ColliderComponent } from './Collision/ColliderComponent';\nimport { Shape } from './Collision/Colliders/Shape';\nimport { watch } from './Util/Watch';\nimport { Collider, CollisionGroup } from './Collision/Index';\nimport { Circle } from './Graphics/Circle';\nimport { CapturePointerConfig } from './Input/CapturePointerConfig';\n\n/**\n * Type guard for checking if something is an Actor\n * @param x\n */\nexport function isActor(x: any): x is Actor {\n  return x instanceof Actor;\n}\n\n/**\n * Actor contructor options\n */\nexport interface ActorArgs {\n  /**\n   * Optionally set the name of the actor, default is 'anonymous'\n   */\n  name?: string;\n  /**\n   * Optionally set the x position of the actor, default is 0\n   */\n  x?: number;\n  /**\n   * Optionally set the y position of the actor, default is 0\n   */\n  y?: number;\n  /**\n   * Optionaly set the (x, y) position of the actor as a vector, default is (0, 0)\n   */\n  pos?: Vector;\n  /**\n   * Optionally set the width of a box collider for the actor\n   */\n  width?: number;\n  /**\n   * Optionally set the height of a box collider for the actor\n   */\n  height?: number;\n  /**\n   * Optionally set the radius of the circle collider for the actor\n   */\n  radius?: number;\n  /**\n   * Optionally set the velocity of the actor in pixels/sec\n   */\n  vel?: Vector;\n  /**\n   * Optionally set the acceleration of the actor in pixels/sec^2\n   */\n  acc?: Vector;\n  /**\n   * Optionally se the rotation in radians (180 degrees = Math.PI radians)\n   */\n  rotation?: number;\n  /**\n   * Optionally set the angular velocity of the actor in radians/sec (180 degrees = Math.PI radians)\n   */\n  angularVelocity?: number;\n  /**\n   * Optionally set the scale of the actor's transform\n   */\n  scale?: Vector;\n  /**\n   * Optionally set the z index of the actor, default is 0\n   */\n  z?: number;\n  /**\n   * Optionally set the color of an actor, only used if no graphics are present\n   * If a width/height or a radius was set a default graphic will be added\n   */\n  color?: Color;\n  /**\n   * Optionally set the visibility of the actor\n   */\n  visible?: boolean;\n  /**\n   * Optionally set the anchor for graphics in the actor\n   */\n  anchor?: Vector;\n  /**\n   * Optionally set the collision type\n   */\n  collisionType?: CollisionType;\n  /**\n   * Optionally supply a collider for an actor, if supplied ignores any supplied width/height\n   */\n  collider?: Collider;\n  /**\n   * Optionally suppy a [[CollisionGroup]]\n   */\n  collisionGroup?: CollisionGroup;\n}\n\n/**\n * The most important primitive in Excalibur is an `Actor`. Anything that\n * can move on the screen, collide with another `Actor`, respond to events,\n * or interact with the current scene, must be an actor. An `Actor` **must**\n * be part of a [[Scene]] for it to be drawn to the screen.\n */\nexport class Actor extends Entity implements Actionable, Eventable, PointerEvents, CanInitialize, CanUpdate, CanDraw, CanBeKilled {\n  // #region Properties\n\n  /**\n   * Set defaults for all Actors\n   */\n  public static defaults = {\n    anchor: Vector.Half\n  };\n\n  /**\n   * The physics body the is associated with this actor. The body is the container for all physical properties, like position, velocity,\n   * acceleration, mass, inertia, etc.\n   */\n  public get body(): BodyComponent {\n    return this.get(BodyComponent);\n  }\n\n  /**\n   * Access the Actor's built in [[TransformComponent]]\n   */\n  public get transform(): TransformComponent {\n    return this.get(TransformComponent);\n  }\n\n  /**\n   * Access the Actor's built in [[MotionComponent]]\n   */\n  public get motion(): MotionComponent {\n    return this.get(MotionComponent);\n  }\n\n  /**\n   * Access to the Actor's built in [[GraphicsComponent]]\n   */\n  public get graphics(): GraphicsComponent {\n    return this.get(GraphicsComponent);\n  }\n\n  /**\n   * Access to the Actor's build in [[ColliderComponent]]\n   */\n  public get collider(): ColliderComponent {\n    return this.get(ColliderComponent);\n  }\n\n  /**\n   * Gets the position vector of the actor in pixels\n   */\n  public get pos(): Vector {\n    return this.transform.pos;\n  }\n\n  /**\n   * Sets the position vector of the actor in pixels\n   */\n  public set pos(thePos: Vector) {\n    this.transform.pos = thePos.clone();\n  }\n\n  /**\n   * Gets the position vector of the actor from the last frame\n   */\n  public get oldPos(): Vector {\n    return this.body.oldPos;\n  }\n\n  /**\n   * Sets the position vector of the actor in the last frame\n   */\n  public set oldPos(thePos: Vector) {\n    this.body.oldPos.setTo(thePos.x, thePos.y);\n  }\n\n  /**\n   * Gets the velocity vector of the actor in pixels/sec\n   */\n  public get vel(): Vector {\n    return this.motion.vel;\n  }\n\n  /**\n   * Sets the velocity vector of the actor in pixels/sec\n   */\n  public set vel(theVel: Vector) {\n    this.motion.vel = theVel.clone();\n  }\n\n  /**\n   * Gets the velocity vector of the actor from the last frame\n   */\n  public get oldVel(): Vector {\n    return this.body.oldVel;\n  }\n\n  /**\n   * Sets the velocity vector of the actor from the last frame\n   */\n  public set oldVel(theVel: Vector) {\n    this.body.oldVel.setTo(theVel.x, theVel.y);\n  }\n\n  /**\n   * Gets the acceleration vector of the actor in pixels/second/second. An acceleration pointing down such as (0, 100) may be\n   * useful to simulate a gravitational effect.\n   */\n  public get acc(): Vector {\n    return this.motion.acc;\n  }\n\n  /**\n   * Sets the acceleration vector of teh actor in pixels/second/second\n   */\n  public set acc(theAcc: Vector) {\n    this.motion.acc = theAcc.clone();\n  }\n\n  /**\n   * Sets the acceleration of the actor from the last frame. This does not include the global acc [[Physics.acc]].\n   */\n  public set oldAcc(theAcc: Vector) {\n    this.body.oldAcc.setTo(theAcc.x, theAcc.y);\n  }\n\n  /**\n   * Gets the acceleration of the actor from the last frame. This does not include the global acc [[Physics.acc]].\n   */\n  public get oldAcc(): Vector {\n    return this.body.oldAcc;\n  }\n\n  /**\n   * Gets the rotation of the actor in radians. 1 radian = 180/PI Degrees.\n   */\n  public get rotation(): number {\n    return this.transform.rotation;\n  }\n\n  /**\n   * Sets the rotation of the actor in radians. 1 radian = 180/PI Degrees.\n   */\n  public set rotation(theAngle: number) {\n    this.transform.rotation = theAngle;\n  }\n\n  /**\n   * Gets the rotational velocity of the actor in radians/second\n   */\n  public get angularVelocity(): number {\n    return this.motion.angularVelocity;\n  }\n\n  /**\n   * Sets the rotational velocity of the actor in radians/sec\n   */\n  public set angularVelocity(angularVelocity: number) {\n    this.motion.angularVelocity = angularVelocity;\n  }\n\n  public get scale(): Vector {\n    return this.get(TransformComponent).scale;\n  }\n\n  public set scale(scale: Vector) {\n    this.get(TransformComponent).scale = scale;\n  }\n\n  /**\n   * The anchor to apply all actor related transformations like rotation,\n   * translation, and scaling. By default the anchor is in the center of\n   * the actor. By default it is set to the center of the actor (.5, .5)\n   *\n   * An anchor of (.5, .5) will ensure that drawings are centered.\n   *\n   * Use `anchor.setTo` to set the anchor to a different point using\n   * values between 0 and 1. For example, anchoring to the top-left would be\n   * `Actor.anchor.setTo(0, 0)` and top-right would be `Actor.anchor.setTo(0, 1)`.\n   */\n  private _anchor: Vector = watch(Vector.Half, (v) => this._handleAnchorChange(v));\n  public get anchor(): Vector {\n    return this._anchor;\n  }\n\n  public set anchor(vec: Vector) {\n    this._anchor = watch(vec, (v) => this._handleAnchorChange(v));\n    this._handleAnchorChange(vec);\n  }\n\n  private _handleAnchorChange(v: Vector) {\n    if (this.graphics) {\n      this.graphics.anchor = v;\n    }\n  }\n\n  /**\n   * Indicates whether the actor is physically in the viewport\n   */\n  public get isOffScreen(): boolean {\n    return this.hasTag('offscreen');\n  }\n  /**\n   * The visibility of an actor\n   * @deprecated Use [[GraphicsComponent.visible|Actor.graphics.visible]]\n   */\n  @obsolete({ message: 'Actor.visible will be removed in v0.26.0', alternateMethod: 'Use Actor.graphics.visible' })\n  public get visible(): boolean {\n    return this.graphics.visible;\n  }\n\n  public set visible(isVisible: boolean) {\n    this.graphics.visible = isVisible;\n  }\n\n  /**\n   * The opacity of an actor.\n   *\n   * @obsolete Actor.opacity will be removed in v0.26.0, use [[GraphicsComponent.opacity|Actor.graphics.opacity]].\n   */\n  @obsolete({\n    message: 'Actor.opacity will be removed in v0.26.0',\n    alternateMethod: 'Use Actor.graphics.opacity'\n  })\n  public get opacity(): number {\n    return this._opacity;\n  }\n\n  public set opacity(opacity: number) {\n    this._opacity = opacity;\n  }\n\n  private _opacity: number = 1;\n\n  /**\n   * [[ActionContext|Action context]] of the actor. Useful for scripting actor behavior.\n   */\n  public actions: ActionContext;\n\n  /**\n   * Convenience reference to the global logger\n   */\n  public logger: Logger = Logger.getInstance();\n\n  /**\n   * The scene that the actor is in\n   */\n  public scene: Scene = null;\n\n  public frames: { [key: string]: Drawable } = {};\n\n  /**\n   * Access to the current drawing for the actor, this can be\n   * an [[Animation]], [[Sprite]], or [[Polygon]].\n   * Set drawings with [[setDrawing]].\n   * @deprecated\n   */\n  public currentDrawing: Drawable = null;\n\n  /**\n   * Draggable helper\n   */\n  private _draggable: boolean = false;\n  private _dragging: boolean = false;\n\n  private _pointerDragStartHandler = () => {\n    this._dragging = true;\n  };\n\n  private _pointerDragEndHandler = () => {\n    this._dragging = false;\n  };\n\n  private _pointerDragMoveHandler = (pe: PointerEvent) => {\n    if (this._dragging) {\n      this.pos = pe.pointer.lastWorldPos;\n    }\n  };\n\n  private _pointerDragLeaveHandler = (pe: PointerEvent) => {\n    if (this._dragging) {\n      this.pos = pe.pointer.lastWorldPos;\n    }\n  };\n\n  public get draggable(): boolean {\n    return this._draggable;\n  }\n\n  public set draggable(isDraggable: boolean) {\n    if (isDraggable) {\n      if (isDraggable && !this._draggable) {\n        this.on('pointerdragstart', this._pointerDragStartHandler);\n        this.on('pointerdragend', this._pointerDragEndHandler);\n        this.on('pointerdragmove', this._pointerDragMoveHandler);\n        this.on('pointerdragleave', this._pointerDragLeaveHandler);\n      } else if (!isDraggable && this._draggable) {\n        this.off('pointerdragstart', this._pointerDragStartHandler);\n        this.off('pointerdragend', this._pointerDragEndHandler);\n        this.off('pointerdragmove', this._pointerDragMoveHandler);\n        this.off('pointerdragleave', this._pointerDragLeaveHandler);\n      }\n\n      this._draggable = isDraggable;\n    }\n  }\n\n  /**\n   * Modify the current actor update pipeline.\n   */\n  public traits: Trait[] = [];\n\n  /**\n   * Sets the color of the actor. A rectangle of this color will be\n   * drawn if no [[Drawable]] is specified as the actors drawing.\n   *\n   * The default is `null` which prevents a rectangle from being drawn.\n   */\n  public get color(): Color {\n    return this._color;\n  }\n  public set color(v: Color) {\n    this._color = v.clone();\n  }\n  private _color: Color;\n\n  /**\n   * Whether or not to enable the [[Traits.CapturePointer]] trait that propagates\n   * pointer events to this actor\n   */\n  public enableCapturePointer: boolean = false;\n\n  /**\n   * Configuration for [[Traits.CapturePointer]] trait\n   */\n  public capturePointer: CapturePointerConfig = {\n    captureMoveEvents: false,\n    captureDragEvents: false\n  };\n\n  // #endregion\n\n  /**\n   *\n   * @param config\n   */\n  constructor(config?: ActorArgs) {\n    super();\n\n    const {\n      name,\n      x,\n      y,\n      pos,\n      scale,\n      width,\n      height,\n      radius,\n      collider,\n      vel,\n      acc,\n      rotation,\n      angularVelocity,\n      z,\n      color,\n      visible,\n      anchor,\n      collisionType,\n      collisionGroup\n    } = {\n      ...config\n    };\n\n    this._setName(name);\n    this.anchor = anchor ?? Actor.defaults.anchor.clone();\n\n    this.addComponent(new TransformComponent());\n    this.pos = pos ?? vec(x ?? 0, y ?? 0);\n    this.rotation = rotation ?? 0;\n    this.scale = scale ?? vec(1, 1);\n    this.z = z ?? 0;\n\n    this.addComponent(new GraphicsComponent());\n    this.addComponent(new CanvasDrawComponent((ctx, delta) => this.draw(ctx, delta)));\n    this.addComponent(new MotionComponent());\n    this.vel = vel ?? Vector.Zero;\n    this.acc = acc ?? Vector.Zero;\n    this.angularVelocity = angularVelocity ?? 0;\n\n    this.addComponent(new BodyComponent());\n    this.body.collisionType = collisionType ?? CollisionType.Passive;\n    if (collisionGroup) {\n      this.body.group = collisionGroup;\n    }\n\n    if (collider) {\n      this.addComponent(new ColliderComponent(collider));\n    } else if (radius) {\n      this.addComponent(new ColliderComponent(Shape.Circle(radius, this.anchor)));\n    } else {\n      this.addComponent(new ColliderComponent(Shape.Box(width ?? 0, height ?? 0, this.anchor)));\n    }\n\n    this.visible = visible ?? true;\n\n    if (color) {\n      this.color = color;\n      if (width && height) {\n        this.graphics.add(\n          new Rectangle({\n            color: color,\n            width,\n            height\n          })\n        );\n      } else if (radius) {\n        this.graphics.add(\n          new Circle({\n            color: color,\n            radius\n          })\n        );\n      }\n    }\n\n    // Build default pipeline\n    if (Flags.isEnabled(Legacy.LegacyDrawing)) {\n      // TODO remove offscreen trait after legacy drawing removed\n      this.traits.push(new Traits.OffscreenCulling());\n    }\n    this.traits.push(new Traits.CapturePointer());\n\n    // Build the action queue\n    this.actions = new ActionContext(this);\n  }\n\n  /**\n   * `onInitialize` is called before the first update of the actor. This method is meant to be\n   * overridden. This is where initialization of child actors should take place.\n   *\n   * Synonymous with the event handler `.on('initialize', (evt) => {...})`\n   */\n  public onInitialize(_engine: Engine): void {\n    // Override me\n  }\n\n  /**\n   * Initializes this actor and all it's child actors, meant to be called by the Scene before first update not by users of Excalibur.\n   *\n   * It is not recommended that internal excalibur methods be overridden, do so at your own risk.\n   *\n   * @internal\n   */\n  public _initialize(engine: Engine) {\n    super._initialize(engine);\n    for (const child of this.children) {\n      child._initialize(engine);\n    }\n  }\n\n  // #region Events\n\n  private _capturePointerEvents: PointerEventName[] = [\n    'pointerup',\n    'pointerdown',\n    'pointermove',\n    'pointerenter',\n    'pointerleave',\n    'pointerdragstart',\n    'pointerdragend',\n    'pointerdragmove',\n    'pointerdragenter',\n    'pointerdragleave'\n  ];\n\n  private _captureMoveEvents: PointerEventName[] = [\n    'pointermove',\n    'pointerenter',\n    'pointerleave',\n    'pointerdragmove',\n    'pointerdragenter',\n    'pointerdragleave'\n  ];\n\n  private _captureDragEvents: PointerEventName[] = [\n    'pointerdragstart',\n    'pointerdragend',\n    'pointerdragmove',\n    'pointerdragenter',\n    'pointerdragleave'\n  ];\n\n  private _checkForPointerOptIn(eventName: string) {\n    if (eventName) {\n      const normalized = <PointerEventName>eventName.toLowerCase();\n\n      if (this._capturePointerEvents.indexOf(normalized) !== -1) {\n        this.enableCapturePointer = true;\n\n        if (this._captureMoveEvents.indexOf(normalized) !== -1) {\n          this.capturePointer.captureMoveEvents = true;\n        }\n\n        if (this._captureDragEvents.indexOf(normalized) !== -1) {\n          this.capturePointer.captureDragEvents = true;\n        }\n      }\n    }\n  }\n\n  public on(eventName: Events.exittrigger, handler: (event: ExitTriggerEvent) => void): void;\n  public on(eventName: Events.entertrigger, handler: (event: EnterTriggerEvent) => void): void;\n  /**\n   * The **collisionstart** event is fired when a [[BodyComponent|physics body]], usually attached to an actor,\n   *  first starts colliding with another [[BodyComponent|body]], and will not fire again while in contact until\n   *  the the pair separates and collides again.\n   * Use cases for the **collisionstart** event may be detecting when an actor has touched a surface\n   * (like landing) or if a item has been touched and needs to be picked up.\n   */\n  public on(eventName: Events.collisionstart, handler: (event: CollisionStartEvent) => void): void;\n  /**\n   * The **collisionend** event is fired when two [[BodyComponent|physics bodies]] are no longer in contact.\n   * This event will not fire again until another collision and separation.\n   *\n   * Use cases for the **collisionend** event might be to detect when an actor has left a surface\n   * (like jumping) or has left an area.\n   */\n  public on(eventName: Events.collisionend, handler: (event: CollisionEndEvent) => void): void;\n  /**\n   * The **precollision** event is fired **every frame** where a collision pair is found and two\n   * bodies are intersecting.\n   *\n   * This event is useful for building in custom collision resolution logic in Passive-Passive or\n   * Active-Passive scenarios. For example in a breakout game you may want to tweak the angle of\n   * ricochet of the ball depending on which side of the paddle you hit.\n   */\n  public on(eventName: Events.precollision, handler: (event: PreCollisionEvent) => void): void;\n  /**\n   * The **postcollision** event is fired for **every frame** where collision resolution was performed.\n   * Collision resolution is when two bodies influence each other and cause a response like bouncing\n   * off one another. It is only possible to have *postcollision* event in Active-Active and Active-Fixed\n   * type collision pairs.\n   *\n   * Post collision would be useful if you need to know that collision resolution is happening or need to\n   * tweak the default resolution.\n   */\n  public on(eventName: Events.postcollision, handler: (event: PostCollisionEvent) => void): void;\n  public on(eventName: Events.kill, handler: (event: KillEvent) => void): void;\n  public on(eventName: Events.prekill, handler: (event: PreKillEvent) => void): void;\n  public on(eventName: Events.postkill, handler: (event: PostKillEvent) => void): void;\n  public on(eventName: Events.initialize, handler: (event: InitializeEvent<Actor>) => void): void;\n  public on(eventName: Events.preupdate, handler: (event: PreUpdateEvent<Actor>) => void): void;\n  public on(eventName: Events.postupdate, handler: (event: PostUpdateEvent<Actor>) => void): void;\n  public on(eventName: Events.predraw, handler: (event: PreDrawEvent) => void): void;\n  public on(eventName: Events.postdraw, handler: (event: PostDrawEvent) => void): void;\n  public on(eventName: Events.predebugdraw, handler: (event: PreDebugDrawEvent) => void): void;\n  public on(eventName: Events.postdebugdraw, handler: (event: PostDebugDrawEvent) => void): void;\n  public on(eventName: Events.pointerup, handler: (event: PointerEvent) => void): void;\n  public on(eventName: Events.pointerdown, handler: (event: PointerEvent) => void): void;\n  public on(eventName: Events.pointerenter, handler: (event: PointerEvent) => void): void;\n  public on(eventName: Events.pointerleave, handler: (event: PointerEvent) => void): void;\n  public on(eventName: Events.pointermove, handler: (event: PointerEvent) => void): void;\n  public on(eventName: Events.pointercancel, handler: (event: PointerEvent) => void): void;\n  public on(eventName: Events.pointerwheel, handler: (event: WheelEvent) => void): void;\n  public on(eventName: Events.pointerdragstart, handler: (event: PointerDragEvent) => void): void;\n  public on(eventName: Events.pointerdragend, handler: (event: PointerDragEvent) => void): void;\n  public on(eventName: Events.pointerdragenter, handler: (event: PointerDragEvent) => void): void;\n  public on(eventName: Events.pointerdragleave, handler: (event: PointerDragEvent) => void): void;\n  public on(eventName: Events.pointerdragmove, handler: (event: PointerDragEvent) => void): void;\n  public on(eventName: Events.enterviewport, handler: (event: EnterViewPortEvent) => void): void;\n  public on(eventName: Events.exitviewport, handler: (event: ExitViewPortEvent) => void): void;\n  public on(eventName: string, handler: (event: GameEvent<Actor>) => void): void;\n  public on(eventName: string, handler: (event: any) => void): void {\n    this._checkForPointerOptIn(eventName);\n    super.on(eventName, handler);\n  }\n\n  public once(eventName: Events.exittrigger, handler: (event: ExitTriggerEvent) => void): void;\n  public once(eventName: Events.entertrigger, handler: (event: EnterTriggerEvent) => void): void;\n  /**\n   * The **collisionstart** event is fired when a [[BodyComponent|physics body]], usually attached to an actor,\n   *  first starts colliding with another [[BodyComponent|body]], and will not fire again while in contact until\n   *  the the pair separates and collides again.\n   * Use cases for the **collisionstart** event may be detecting when an actor has touch a surface\n   * (like landing) or if a item has been touched and needs to be picked up.\n   */\n  public once(eventName: Events.collisionstart, handler: (event: CollisionStartEvent) => void): void;\n  /**\n   * The **collisionend** event is fired when two [[BodyComponent|physics bodies]] are no longer in contact.\n   * This event will not fire again until another collision and separation.\n   *\n   * Use cases for the **collisionend** event might be to detect when an actor has left a surface\n   * (like jumping) or has left an area.\n   */\n  public once(eventName: Events.collisionend, handler: (event: CollisionEndEvent) => void): void;\n  /**\n   * The **precollision** event is fired **every frame** where a collision pair is found and two\n   * bodies are intersecting.\n   *\n   * This event is useful for building in custom collision resolution logic in Passive-Passive or\n   * Active-Passive scenarios. For example in a breakout game you may want to tweak the angle of\n   * ricochet of the ball depending on which side of the paddle you hit.\n   */\n  public once(eventName: Events.precollision, handler: (event: PreCollisionEvent) => void): void;\n  /**\n   * The **postcollision** event is fired for **every frame** where collision resolution was performed.\n   * Collision resolution is when two bodies influence each other and cause a response like bouncing\n   * off one another. It is only possible to have *postcollision* event in Active-Active and Active-Fixed\n   * type collision pairs.\n   *\n   * Post collision would be useful if you need to know that collision resolution is happening or need to\n   * tweak the default resolution.\n   */\n  public once(eventName: Events.postcollision, handler: (event: PostCollisionEvent) => void): void;\n  public once(eventName: Events.kill, handler: (event: KillEvent) => void): void;\n  public once(eventName: Events.postkill, handler: (event: PostKillEvent) => void): void;\n  public once(eventName: Events.prekill, handler: (event: PreKillEvent) => void): void;\n  public once(eventName: Events.initialize, handler: (event: InitializeEvent<Actor>) => void): void;\n  public once(eventName: Events.preupdate, handler: (event: PreUpdateEvent<Actor>) => void): void;\n  public once(eventName: Events.postupdate, handler: (event: PostUpdateEvent<Actor>) => void): void;\n  public once(eventName: Events.predraw, handler: (event: PreDrawEvent) => void): void;\n  public once(eventName: Events.postdraw, handler: (event: PostDrawEvent) => void): void;\n  public once(eventName: Events.predebugdraw, handler: (event: PreDebugDrawEvent) => void): void;\n  public once(eventName: Events.postdebugdraw, handler: (event: PostDebugDrawEvent) => void): void;\n  public once(eventName: Events.pointerup, handler: (event: PointerEvent) => void): void;\n  public once(eventName: Events.pointerdown, handler: (event: PointerEvent) => void): void;\n  public once(eventName: Events.pointerenter, handler: (event: PointerEvent) => void): void;\n  public once(eventName: Events.pointerleave, handler: (event: PointerEvent) => void): void;\n  public once(eventName: Events.pointermove, handler: (event: PointerEvent) => void): void;\n  public once(eventName: Events.pointercancel, handler: (event: PointerEvent) => void): void;\n  public once(eventName: Events.pointerwheel, handler: (event: WheelEvent) => void): void;\n  public once(eventName: Events.pointerdragstart, handler: (event: PointerDragEvent) => void): void;\n  public once(eventName: Events.pointerdragend, handler: (event: PointerDragEvent) => void): void;\n  public once(eventName: Events.pointerdragenter, handler: (event: PointerDragEvent) => void): void;\n  public once(eventName: Events.pointerdragleave, handler: (event: PointerDragEvent) => void): void;\n  public once(eventName: Events.pointerdragmove, handler: (event: PointerDragEvent) => void): void;\n  public once(eventName: Events.enterviewport, handler: (event: EnterViewPortEvent) => void): void;\n  public once(eventName: Events.exitviewport, handler: (event: ExitViewPortEvent) => void): void;\n  public once(eventName: string, handler: (event: GameEvent<Actor>) => void): void;\n  public once(eventName: string, handler: (event: any) => void): void {\n    this._checkForPointerOptIn(eventName);\n    super.once(eventName, handler);\n  }\n\n  public off(eventName: Events.exittrigger, handler?: (event: ExitTriggerEvent) => void): void;\n  public off(eventName: Events.entertrigger, handler?: (event: EnterTriggerEvent) => void): void;\n  /**\n   * The **collisionstart** event is fired when a [[BodyComponent|physics body]], usually attached to an actor,\n   *  first starts colliding with another [[BodyComponent|body]], and will not fire again while in contact until\n   *  the the pair separates and collides again.\n   * Use cases for the **collisionstart** event may be detecting when an actor has touch a surface\n   * (like landing) or if a item has been touched and needs to be picked up.\n   */\n  public off(eventName: Events.collisionstart, handler?: (event: CollisionStartEvent) => void): void;\n  /**\n   * The **collisionend** event is fired when two [[BodyComponent|physics bodies]] are no longer in contact.\n   * This event will not fire again until another collision and separation.\n   *\n   * Use cases for the **collisionend** event might be to detect when an actor has left a surface\n   * (like jumping) or has left an area.\n   */\n  public off(eventName: Events.collisionend, handler?: (event: CollisionEndEvent) => void): void;\n  /**\n   * The **precollision** event is fired **every frame** where a collision pair is found and two\n   * bodies are intersecting.\n   *\n   * This event is useful for building in custom collision resolution logic in Passive-Passive or\n   * Active-Passive scenarios. For example in a breakout game you may want to tweak the angle of\n   * ricochet of the ball depending on which side of the paddle you hit.\n   */\n  public off(eventName: Events.precollision, handler?: (event: PreCollisionEvent) => void): void;\n  /**\n   * The **postcollision** event is fired for **every frame** where collision resolution was performed.\n   * Collision resolution is when two bodies influence each other and cause a response like bouncing\n   * off one another. It is only possible to have *postcollision* event in Active-Active and Active-Fixed\n   * type collision pairs.\n   *\n   * Post collision would be useful if you need to know that collision resolution is happening or need to\n   * tweak the default resolution.\n   */\n  public off(eventName: Events.postcollision, handler: (event: PostCollisionEvent) => void): void;\n  public off(eventName: Events.pointerup, handler?: (event: PointerEvent) => void): void;\n  public off(eventName: Events.pointerdown, handler?: (event: PointerEvent) => void): void;\n  public off(eventName: Events.pointerenter, handler?: (event: PointerEvent) => void): void;\n  public off(eventName: Events.pointerleave, handler?: (event: PointerEvent) => void): void;\n  public off(eventName: Events.pointermove, handler?: (event: PointerEvent) => void): void;\n  public off(eventName: Events.pointercancel, handler?: (event: PointerEvent) => void): void;\n  public off(eventName: Events.pointerwheel, handler?: (event: WheelEvent) => void): void;\n  public off(eventName: Events.pointerdragstart, handler?: (event: PointerDragEvent) => void): void;\n  public off(eventName: Events.pointerdragend, handler?: (event: PointerDragEvent) => void): void;\n  public off(eventName: Events.pointerdragenter, handler?: (event: PointerDragEvent) => void): void;\n  public off(eventName: Events.pointerdragleave, handler?: (event: PointerDragEvent) => void): void;\n  public off(eventName: Events.pointerdragmove, handler?: (event: PointerDragEvent) => void): void;\n  public off(eventName: Events.prekill, handler?: (event: PreKillEvent) => void): void;\n  public off(eventName: Events.postkill, handler?: (event: PostKillEvent) => void): void;\n  public off(eventName: Events.initialize, handler?: (event: Events.InitializeEvent<Actor>) => void): void;\n  public off(eventName: Events.postupdate, handler?: (event: Events.PostUpdateEvent<Actor>) => void): void;\n  public off(eventName: Events.preupdate, handler?: (event: Events.PreUpdateEvent<Actor>) => void): void;\n  public off(eventName: Events.postdraw, handler?: (event: Events.PostDrawEvent) => void): void;\n  public off(eventName: Events.predraw, handler?: (event: Events.PreDrawEvent) => void): void;\n  public off(eventName: Events.enterviewport, handler?: (event: EnterViewPortEvent) => void): void;\n  public off(eventName: Events.exitviewport, handler?: (event: ExitViewPortEvent) => void): void;\n  public off(eventName: string, handler?: (event: GameEvent<Actor>) => void): void;\n  public off(eventName: string, handler?: (event: any) => void): void {\n    super.off(eventName, handler);\n  }\n\n  // #endregion\n\n  /**\n   * It is not recommended that internal excalibur methods be overridden, do so at your own risk.\n   *\n   * Internal _prekill handler for [[onPreKill]] lifecycle event\n   * @internal\n   */\n  public _prekill(_scene: Scene) {\n    super.emit('prekill', new PreKillEvent(this));\n    this.onPreKill(_scene);\n  }\n\n  /**\n   * Safe to override onPreKill lifecycle event handler. Synonymous with `.on('prekill', (evt) =>{...})`\n   *\n   * `onPreKill` is called directly before an actor is killed and removed from its current [[Scene]].\n   */\n  public onPreKill(_scene: Scene) {\n    // Override me\n  }\n\n  /**\n   * It is not recommended that internal excalibur methods be overridden, do so at your own risk.\n   *\n   * Internal _prekill handler for [[onPostKill]] lifecycle event\n   * @internal\n   */\n  public _postkill(_scene: Scene) {\n    super.emit('postkill', new PostKillEvent(this));\n    this.onPostKill(_scene);\n  }\n\n  /**\n   * Safe to override onPostKill lifecycle event handler. Synonymous with `.on('postkill', (evt) => {...})`\n   *\n   * `onPostKill` is called directly after an actor is killed and remove from its current [[Scene]].\n   */\n  public onPostKill(_scene: Scene) {\n    // Override me\n  }\n\n  /**\n   * If the current actor is a member of the scene, this will remove\n   * it from the scene graph. It will no longer be drawn or updated.\n   */\n  public kill() {\n    if (this.scene) {\n      this._prekill(this.scene);\n      this.emit('kill', new KillEvent(this));\n      super.kill();\n      this._postkill(this.scene);\n    } else {\n      this.logger.warn('Cannot kill actor, it was never added to the Scene');\n    }\n  }\n\n  /**\n   * If the current actor is killed, it will now not be killed.\n   */\n  public unkill() {\n    this.active = true;\n  }\n\n  /**\n   * Indicates wether the actor has been killed.\n   */\n  public isKilled(): boolean {\n    return !this.active;\n  }\n\n  /**\n   * Sets the current drawing of the actor to the drawing corresponding to\n   * the key.\n   * @param key The key of the drawing\n   * @deprecated Use [[GraphicsComponent.show|Actor.graphics.show]] or [[GraphicsComponent.use|Actor.graphics.use]]\n   */\n  public setDrawing(key: string): void;\n  /**\n   * Sets the current drawing of the actor to the drawing corresponding to\n   * an `enum` key (e.g. `Animations.Left`)\n   * @param key The `enum` key of the drawing\n   * @deprecated Use [[GraphicsComponent.show|Actor.graphics.show]] or [[GraphicsComponent.use|Actor.graphics.use]]\n   */\n  public setDrawing(key: number): void;\n  @obsolete({\n    message: 'Actor.setDrawing will be removed in v0.26.0',\n    alternateMethod: 'Use Actor.graphics.show() or Actor.graphics.use()'\n  })\n  public setDrawing(key: any): void {\n    key = key.toString();\n    if (this.currentDrawing !== this.frames[<string>key]) {\n      if (this.frames[key] != null) {\n        this.frames[key].reset();\n        this.currentDrawing = this.frames[key];\n      } else {\n        Logger.getInstance().error(`the specified drawing key ${key} does not exist`);\n      }\n    }\n    if (this.currentDrawing && this.currentDrawing instanceof Animation) {\n      this.currentDrawing.tick(0);\n    }\n  }\n\n  /**\n   * Adds a whole texture as the \"default\" drawing. Set a drawing using [[setDrawing]].\n   * @deprecated Use [[GraphicsComponent.add|Actor.graphics.add]]\n   */\n  public addDrawing(texture: Texture): void;\n  /**\n   * Adds a whole sprite as the \"default\" drawing. Set a drawing using [[setDrawing]].\n   * @deprecated Use [[GraphicsComponent.add|Actor.graphics.add]]\n   */\n  public addDrawing(sprite: Sprite): void;\n  /**\n   * Adds a drawing to the list of available drawings for an actor. Set a drawing using [[setDrawing]].\n   * @param key     The key to associate with a drawing for this actor\n   * @param drawing This can be an [[Animation]], [[Sprite]], or [[Polygon]].\n   * @deprecated Use [[GraphicsComponent.add|Actor.graphics.add]]\n   */\n  public addDrawing(key: any, drawing: Drawable): void;\n  @obsolete({\n    message: 'Actor.addDrawing will be removed in v0.26.0',\n    alternateMethod: 'Use Actor.graphics.add()'\n  })\n  public addDrawing(): void {\n    if (arguments.length === 2) {\n      this.frames[<string>arguments[0]] = arguments[1];\n      if (!this.currentDrawing) {\n        this.currentDrawing = arguments[1];\n      }\n    } else {\n      if (arguments[0] instanceof Sprite) {\n        this.addDrawing('default', arguments[0]);\n      }\n      if (arguments[0] instanceof Texture) {\n        this.addDrawing('default', arguments[0].asSprite());\n      }\n    }\n  }\n\n  /**\n   * Gets the z-index of an actor. The z-index determines the relative order an actor is drawn in.\n   * Actors with a higher z-index are drawn on top of actors with a lower z-index\n   */\n  public get z(): number {\n    return this.get(TransformComponent).z;\n  }\n\n  /**\n   * @deprecated Use [[Actor.z]]\n   */\n  @obsolete({\n    message: 'Actor.getZIndex will be removed in v0.26.0',\n    alternateMethod: 'Use Actor.transform.z or Actor.z'\n  })\n  public getZIndex(): number {\n    return this.get(TransformComponent).z;\n  }\n\n  /**\n   * Sets the z-index of an actor and updates it in the drawing list for the scene.\n   * The z-index determines the relative order an actor is drawn in.\n   * Actors with a higher z-index are drawn on top of actors with a lower z-index\n   * @param newZ new z-index to assign\n   */\n  public set z(newZ: number) {\n    this.get(TransformComponent).z = newZ;\n  }\n\n  /**\n   * @param newIndex new z-index to assign\n   * @deprecated Use [[Actor.z]]\n   */\n  @obsolete({\n    message: 'Actor.setZIndex will be removed in v0.26.0',\n    alternateMethod: 'Use Actor.transform.z or Actor.z'\n  })\n  public setZIndex(newIndex: number) {\n    this.get(TransformComponent).z = newIndex;\n  }\n\n  /**\n   * Get the center point of an actor\n   */\n  public get center(): Vector {\n    return new Vector(this.pos.x + this.width / 2 - this.anchor.x * this.width, this.pos.y + this.height / 2 - this.anchor.y * this.height);\n  }\n\n  public get width() {\n    return this.collider.localBounds.width * this.getGlobalScale().x;\n  }\n\n  public get height() {\n    return this.collider.localBounds.height * this.getGlobalScale().y;\n  }\n\n  /**\n   * Gets this actor's rotation taking into account any parent relationships\n   *\n   * @returns Rotation angle in radians\n   */\n  public getGlobalRotation(): number {\n    return this.get(TransformComponent).globalRotation;\n  }\n\n  /**\n   * Gets an actor's world position taking into account parent relationships, scaling, rotation, and translation\n   *\n   * @returns Position in world coordinates\n   */\n  public getGlobalPos(): Vector {\n    return this.get(TransformComponent).globalPos;\n  }\n\n  /**\n   * Gets the global scale of the Actor\n   */\n  public getGlobalScale(): Vector {\n    return this.get(TransformComponent).globalScale;\n  }\n\n  // #region Collision\n\n  /**\n   * Tests whether the x/y specified are contained in the actor\n   * @param x  X coordinate to test (in world coordinates)\n   * @param y  Y coordinate to test (in world coordinates)\n   * @param recurse checks whether the x/y are contained in any child actors (if they exist).\n   */\n  public contains(x: number, y: number, recurse: boolean = false): boolean {\n    const point = vec(x, y);\n    const collider = this.get(ColliderComponent);\n    collider.update();\n    const containment = collider.get().contains(point);\n\n    if (recurse) {\n      return (\n        containment ||\n        this.children.some((child: Actor) => {\n          return child.contains(x, y, true);\n        })\n      );\n    }\n\n    return containment;\n  }\n\n  /**\n   * Returns true if the two actor.collider's surfaces are less than or equal to the distance specified from each other\n   * @param actor     Actor to test\n   * @param distance  Distance in pixels to test\n   */\n  public within(actor: Actor, distance: number): boolean {\n    const collider = this.get(ColliderComponent);\n    const otherCollider = actor.get(ColliderComponent);\n    return collider.get().getClosestLineBetween(otherCollider.get()).getLength() <= distance;\n  }\n\n  // #endregion\n\n  // #region Update\n\n  /**\n   * Called by the Engine, updates the state of the actor\n   * @internal\n   * @param engine The reference to the current game engine\n   * @param delta  The time elapsed since the last update in milliseconds\n   */\n  public update(engine: Engine, delta: number) {\n    this._initialize(engine);\n    this._preupdate(engine, delta);\n\n    // Tick animations\n    const drawing = this.currentDrawing;\n    if (drawing && drawing instanceof Animation) {\n      drawing.tick(delta, engine.stats.currFrame.id);\n    }\n\n    // Update action context\n    this.actions.update(delta);\n\n    // Update actor pipeline (movement, collision detection, event propagation, offscreen culling)\n    for (const trait of this.traits) {\n      trait.update(this, engine, delta);\n    }\n\n    // Update child actors\n    // for (let i = 0; i < this.children.length; i++) {\n    //   this.children[i].update(engine, delta);\n    // }\n\n    this._postupdate(engine, delta);\n  }\n\n  /**\n   * Safe to override onPreUpdate lifecycle event handler. Synonymous with `.on('preupdate', (evt) =>{...})`\n   *\n   * `onPreUpdate` is called directly before an actor is updated.\n   */\n  public onPreUpdate(_engine: Engine, _delta: number): void {\n    // Override me\n  }\n\n  /**\n   * Safe to override onPostUpdate lifecycle event handler. Synonymous with `.on('postupdate', (evt) =>{...})`\n   *\n   * `onPostUpdate` is called directly after an actor is updated.\n   */\n  public onPostUpdate(_engine: Engine, _delta: number): void {\n    // Override me\n  }\n\n  /**\n   * It is not recommended that internal excalibur methods be overridden, do so at your own risk.\n   *\n   * Internal _preupdate handler for [[onPreUpdate]] lifecycle event\n   * @internal\n   */\n  public _preupdate(engine: Engine, delta: number): void {\n    this.emit('preupdate', new PreUpdateEvent(engine, delta, this));\n    this.onPreUpdate(engine, delta);\n  }\n\n  /**\n   * It is not recommended that internal excalibur methods be overridden, do so at your own risk.\n   *\n   * Internal _preupdate handler for [[onPostUpdate]] lifecycle event\n   * @internal\n   */\n  public _postupdate(engine: Engine, delta: number): void {\n    this.emit('postupdate', new PreUpdateEvent(engine, delta, this));\n    this.onPostUpdate(engine, delta);\n  }\n\n  // endregion\n\n  // #region Drawing\n  /**\n   * Called by the Engine, draws the actor to the screen\n   * @param ctx   The rendering context\n   * @param delta The time since the last draw in milliseconds\n   */\n  public draw(ctx: CanvasRenderingContext2D, delta: number) {\n    // translate canvas by anchor offset\n    ctx.save();\n\n    if (this.currentDrawing) {\n      ctx.translate(-(this.width * this.anchor.x), -(this.height * this.anchor.y));\n\n      this._predraw(ctx, delta);\n      const drawing = this.currentDrawing;\n      // See https://github.com/excaliburjs/Excalibur/pull/619 for discussion on this formula\n      const offsetX = (this.width - drawing.width * drawing.scale.x) * this.anchor.x;\n      const offsetY = (this.height - drawing.height * drawing.scale.y) * this.anchor.y;\n\n      this.currentDrawing.draw({ ctx, x: offsetX, y: offsetY, opacity: this.opacity });\n    } else {\n      this._predraw(ctx, delta);\n      if (this.color && this.collider) {\n        // update collider geometry based on transform\n        const collider = this.get(ColliderComponent);\n        collider.update();\n        if (!collider.bounds.hasZeroDimensions()) {\n          // Colliders are already shifted by anchor, unshift\n          ctx.globalAlpha = this.opacity;\n          collider.get().draw(ctx, this.color, vec(0, 0));\n        }\n      }\n    }\n    ctx.restore();\n    this._postdraw(ctx, delta);\n  }\n\n  /**\n   * Safe to override onPreDraw lifecycle event handler. Synonymous with `.on('predraw', (evt) =>{...})`\n   *\n   * `onPreDraw` is called directly before an actor is drawn, but after local transforms are made.\n   */\n  public onPreDraw(_ctx: CanvasRenderingContext2D, _delta: number): void {\n    // Override me\n  }\n\n  /**\n   * Safe to override onPostDraw lifecycle event handler. Synonymous with `.on('postdraw', (evt) =>{...})`\n   *\n   * `onPostDraw` is called directly after an actor is drawn, and before local transforms are removed.\n   */\n  public onPostDraw(_ctx: CanvasRenderingContext2D, _delta: number): void {\n    // Override me\n  }\n\n  /**\n   * It is not recommended that internal excalibur methods be overridden, do so at your own risk.\n   *\n   * Internal _predraw handler for [[onPreDraw]] lifecycle event\n   * @internal\n   */\n  public _predraw(ctx: CanvasRenderingContext2D, delta: number): void {\n    this.emit('predraw', new PreDrawEvent(ctx, delta, this));\n    this.onPreDraw(ctx, delta);\n  }\n\n  /**\n   * It is not recommended that internal excalibur methods be overridden, do so at your own risk.\n   *\n   * Internal _postdraw handler for [[onPostDraw]] lifecycle event\n   * @internal\n   */\n  public _postdraw(ctx: CanvasRenderingContext2D, delta: number): void {\n    this.emit('postdraw', new PreDrawEvent(ctx, delta, this));\n    this.onPostDraw(ctx, delta);\n  }\n\n  /**\n   * Called by the Engine, draws the actors debugging to the screen\n   * @param ctx The rendering context\n   */\n  /* istanbul ignore next */\n  public debugDraw(_ctx: CanvasRenderingContext2D) {\n    // pass\n  }\n  // #endregion\n}\n","import { Vector, vec } from './Math/vector';\nimport { Engine } from './Engine';\nimport { Actor, ActorArgs } from './Actor';\nimport * as Traits from './Traits/Index';\nimport { CoordPlane, TransformComponent } from './EntityComponentSystem/Components/TransformComponent';\nimport { CollisionType } from './Collision/CollisionType';\n\n/**\n * Helper [[Actor]] primitive for drawing UI's, optimized for UI drawing. Does\n * not participate in collisions. Drawn on top of all other actors.\n */\nexport class ScreenElement extends Actor {\n  protected _engine: Engine;\n\n  constructor();\n  constructor(config?: ActorArgs);\n\n  constructor(config?: ActorArgs) {\n    super({ ...config });\n    this.get(TransformComponent).coordPlane = CoordPlane.Screen;\n    this.traits = [];\n    this.traits.push(new Traits.CapturePointer());\n    this.anchor = vec(0, 0);\n    this.body.collisionType = CollisionType.PreventCollision;\n    this.collider.useBoxCollider(this.width, this.height, this.anchor);\n    this.enableCapturePointer = true;\n  }\n\n  public _initialize(engine: Engine) {\n    this._engine = engine;\n    super._initialize(engine);\n  }\n\n  public contains(x: number, y: number, useWorld: boolean = true) {\n    if (useWorld) {\n      return super.contains(x, y);\n    }\n\n    const coords = this._engine.worldToScreenCoordinates(new Vector(x, y));\n    return super.contains(coords.x, coords.y);\n  }\n}\n","import { Scene } from './Scene';\nimport { obsolete } from './Util/Decorators';\nimport { Logger } from './Util/Log';\n\nexport interface TimerOptions {\n  repeats?: boolean;\n  numberOfRepeats?: number;\n  fcn?: () => void;\n  interval: number;\n}\n\n/**\n * The Excalibur timer hooks into the internal timer and fires callbacks,\n * after a certain interval, optionally repeating.\n */\nexport class Timer {\n  private _logger = Logger.getInstance();\n  private static _MAX_ID: number = 0;\n  public id: number = 0;\n\n  private _elapsedTime: number = 0;\n  private _totalTimeAlive: number = 0;\n\n  private _running = false;\n\n  private _numberOfTicks: number = 0;\n  private _callbacks: Array<() => void>;\n\n  public interval: number = 10;\n  public repeats: boolean = false;\n  public maxNumberOfRepeats: number = -1;\n\n  private _complete = false;\n  public get complete() {\n    return this._complete;\n  }\n  public scene: Scene = null;\n\n  /**\n   * @param options    Options - repeats, numberOfRepeats, fcn, interval\n   * @param repeats    Indicates whether this call back should be fired only once, or repeat after every interval as completed.\n   * @param numberOfRepeats Specifies a maximum number of times that this timer will execute.\n   * @param fcn        The callback to be fired after the interval is complete.\n   */\n  constructor(options: TimerOptions);\n  constructor(fcn: TimerOptions | (() => void), interval?: number, repeats?: boolean, numberOfRepeats?: number) {\n    if (typeof fcn !== 'function') {\n      const options = fcn;\n      fcn = options.fcn;\n      interval = options.interval;\n      repeats = options.repeats;\n      numberOfRepeats = options.numberOfRepeats;\n    }\n\n    if (!!numberOfRepeats && numberOfRepeats >= 0) {\n      this.maxNumberOfRepeats = numberOfRepeats;\n      if (!repeats) {\n        throw new Error('repeats must be set to true if numberOfRepeats is set');\n      }\n    }\n\n    this.id = Timer._MAX_ID++;\n    this.interval = interval || this.interval;\n    this.repeats = repeats || this.repeats;\n\n    this._callbacks = [];\n\n    if (fcn) {\n      this.on(fcn);\n    }\n  }\n\n  /**\n   * Adds a new callback to be fired after the interval is complete\n   * @param fcn The callback to be added to the callback list, to be fired after the interval is complete.\n   */\n  public on(fcn: () => void) {\n    this._callbacks.push(fcn);\n  }\n\n  /**\n   * Removes a callback from the callback list to be fired after the interval is complete.\n   * @param fcn The callback to be removed from the callback list, to be fired after the interval is complete.\n   */\n  public off(fcn: () => void) {\n    const index = this._callbacks.indexOf(fcn);\n    this._callbacks.splice(index, 1);\n  }\n\n  /**\n   * Updates the timer after a certain number of milliseconds have elapsed. This is used internally by the engine.\n   * @param delta  Number of elapsed milliseconds since the last update.\n   */\n  public update(delta: number) {\n    if (this._running) {\n      this._totalTimeAlive += delta;\n      this._elapsedTime += delta;\n\n      if (this.maxNumberOfRepeats > -1 && this._numberOfTicks >= this.maxNumberOfRepeats) {\n        this._complete = true;\n        this._running = false;\n        this._elapsedTime = 0;\n      }\n\n      if (!this.complete && this._elapsedTime >= this.interval) {\n        this._callbacks.forEach((c) => {\n          c.call(this);\n        });\n\n        this._numberOfTicks++;\n        if (this.repeats) {\n          this._elapsedTime = 0;\n        } else {\n          this._complete = true;\n          this._running = false;\n          this._elapsedTime = 0;\n        }\n      }\n    }\n  }\n\n  /**\n   * Resets the timer so that it can be reused, and optionally reconfigure the timers interval.\n   *\n   * Warning** you may need to call `timer.start()` again if the timer had completed\n   * @param newInterval If specified, sets a new non-negative interval in milliseconds to refire the callback\n   * @param newNumberOfRepeats If specified, sets a new non-negative upper limit to the number of time this timer executes\n   */\n  public reset(newInterval?: number, newNumberOfRepeats?: number) {\n    if (!!newInterval && newInterval >= 0) {\n      this.interval = newInterval;\n    }\n\n    if (!!this.maxNumberOfRepeats && this.maxNumberOfRepeats >= 0) {\n      this.maxNumberOfRepeats = newNumberOfRepeats;\n      if (!this.repeats) {\n        throw new Error('repeats must be set to true if numberOfRepeats is set');\n      }\n    }\n\n    this._complete = false;\n    this._elapsedTime = 0;\n    this._numberOfTicks = 0;\n  }\n\n  public get timesRepeated(): number {\n    return this._numberOfTicks;\n  }\n\n  public getTimeRunning(): number {\n    return this._totalTimeAlive;\n  }\n\n  /**\n   * @returns milliseconds until the next action callback, if complete will return 0\n   */\n  public get timeToNextAction() {\n    if (this.complete) {\n      return 0;\n    }\n    return this.interval - this._elapsedTime;\n  }\n\n  /**\n   * @returns milliseconds elapsed toward the next action\n   */\n  public get timeElapsedTowardNextAction() {\n    return this._elapsedTime;\n  }\n\n  public get isRunning() {\n    return this._running;\n  }\n\n  /**\n   * Pauses the timer, time will no longer increment towards the next call\n   */\n  public pause(): Timer {\n    this._running = false;\n    return this;\n  }\n\n  /**\n   * Unpauses the timer. Time will now increment towards the next call\n   * @deprecated Will be removed in v0.26.0\n   */\n  @obsolete({ message: 'Will be removed in v0.26.0', alternateMethod: 'Use Timer.resume()' })\n  public unpause() {\n    this._running = true;\n  }\n\n  /**\n   * Resumes the timer, time will now increment towards the next call.\n   */\n  public resume(): Timer {\n    this._running = true;\n    return this;\n  }\n\n  /**\n   * Starts the timer, if the timer was complete it will restart the timer and reset the elapsed time counter\n   */\n  public start(): Timer {\n    if (!this.scene) {\n      this._logger.warn('Cannot start a timer not part of a scene, timer wont start until added');\n    }\n\n    this._running = true;\n    if (this.complete) {\n      this._complete = false;\n      this._elapsedTime = 0;\n      this._numberOfTicks = 0;\n    }\n\n    return this;\n  }\n\n  /**\n   * Stops the timer and resets the elapsed time counter towards the next action invocation\n   */\n  public stop(): Timer {\n    this._running = false;\n    this._elapsedTime = 0;\n    this._numberOfTicks = 0;\n    return this;\n  }\n\n  /**\n   * Cancels the timer, preventing any further executions.\n   */\n  public cancel() {\n    this.pause();\n    if (this.scene) {\n      this.scene.cancelTimer(this);\n    }\n  }\n}\n","import { Resource } from '../Resources/Resource';\nimport { Texture } from '../Drawing/Texture';\nimport { Sprite } from './Sprite';\nimport { Loadable } from '../Interfaces/Index';\nimport { Logger } from '../Util/Log';\n\nexport class ImageSource implements Loadable<HTMLImageElement> {\n  private _logger = Logger.getInstance();\n  private _resource: Resource<Blob>;\n\n  /**\n   * The original size of the source image in pixels\n   */\n  public get width() {\n    return this.image.naturalWidth;\n  }\n\n  /**\n   * The original height of the source image in pixels\n   */\n  public get height() {\n    return this.image.naturalHeight;\n  }\n\n  /**\n   * Returns true if the Texture is completely loaded and is ready\n   * to be drawn.\n   */\n  public isLoaded(): boolean {\n    return !!this.data.src;\n  }\n\n  /**\n   * Access to the underlying html image elmeent\n   */\n  public data: HTMLImageElement = new Image();\n  public get image(): HTMLImageElement {\n    return this.data;\n  }\n\n  /**\n   * Promise the resolves when the image is loaded and ready for use, does not initiate loading\n   */\n  public ready: Promise<HTMLImageElement>;\n  private _loadedResolve: (value?: HTMLImageElement | PromiseLike<HTMLImageElement>) => void;\n\n  /**\n   * The path to the image, can also be a data url like 'data:image/'\n   * @param path\n   */\n  constructor(public readonly path: string, bustCache: boolean = false) {\n    this._resource = new Resource(path, 'blob', bustCache);\n    if (path.endsWith('.svg') || path.endsWith('.gif')) {\n      this._logger.warn(`Image type is not fully supported, you may have mixed results ${path}. Fully supported: jpg, bmp, and png`);\n    }\n    this.ready = new Promise<HTMLImageElement>((resolve) => {\n      this._loadedResolve = resolve;\n    });\n  }\n\n  /**\n   * Begins loading the image and returns a promise that resolves when the image is loaded\n   */\n  async load(): Promise<HTMLImageElement> {\n    if (this.isLoaded()) {\n      return this.data;\n    }\n    try {\n      // Load base64 or blob if needed\n      let url: string;\n      if (!this.path.includes('data:image/')) {\n        const blob = await this._resource.load();\n        url = URL.createObjectURL(blob);\n      } else {\n        url = this.path;\n      }\n\n      // Decode the image\n      const image = new Image();\n      image.src = url;\n      await image.decode();\n\n      // Set results\n      this.data = image;\n    } catch {\n      await Promise.reject('Error loading texture');\n    }\n    // todo emit complete\n    this._loadedResolve(this.data);\n    return this.data;\n  }\n\n  /**\n   * Build a sprite from this ImageSource\n   */\n  public toSprite(): Sprite {\n    return Sprite.from(this);\n  }\n\n  /**\n   * Create a ImageSource from legacy texture\n   * @param tex\n   */\n  public static fromLegacyTexture(tex: Texture): ImageSource {\n    const image = new ImageSource(tex.path);\n    if (tex.isLoaded()) {\n      image.data = tex.data;\n    } else {\n      tex.loaded.then(() => {\n        image.data = tex.data;\n      });\n    }\n    return image;\n  }\n\n  /**\n   * Unload images from memory\n   */\n  unload(): void {\n    this.data = new Image();\n  }\n}\n","import { Graphic, GraphicOptions } from './Graphic';\nimport { ImageSource } from './ImageSource';\nimport { ExcaliburGraphicsContext } from './Context/ExcaliburGraphicsContext';\n\nimport { Sprite as LegacySprite } from '../Drawing/Sprite';\nimport { Texture } from '../Drawing/Texture';\n\nexport type SourceView = { x: number; y: number; width: number; height: number };\nexport type DestinationSize = { width: number; height: number };\n\nexport interface SpriteOptions {\n  /**\n   * Image to create a sprite from\n   */\n  image: ImageSource;\n  /**\n   * By default the source is the entire dimension of the [[ImageSource]]\n   */\n  sourceView?: { x: number; y: number; width: number; height: number };\n  /**\n   * By default the size of the final sprite is the size of the [[ImageSource]]\n   */\n  destSize?: { width: number; height: number };\n}\n\nexport class Sprite extends Graphic {\n  public image: ImageSource;\n  public sourceView: SourceView;\n  public destSize: DestinationSize;\n\n  public static from(image: ImageSource): Sprite {\n    return new Sprite({\n      image: image\n    });\n  }\n\n  constructor(options: GraphicOptions & SpriteOptions) {\n    super(options);\n    this.image = options.image;\n    const { width, height } = options;\n    this.sourceView = options.sourceView ?? { x: 0, y: 0, width: width ?? 0, height: height ?? 0 };\n    this.destSize = options.destSize ?? { width: width ?? 0, height: height ?? 0 };\n    this._updateSpriteDimensions();\n    this.image.ready.then(() => {\n      this._updateSpriteDimensions();\n    });\n  }\n\n  private _updateSpriteDimensions() {\n    const { width: nativeWidth, height: nativeHeight } = this.image;\n    // This code uses || to avoid 0's\n    // If the source is not specified, use the native dimension\n    this.sourceView.width = this.sourceView?.width || nativeWidth;\n    this.sourceView.height = this.sourceView?.height || nativeHeight;\n\n    // If the destination is not specified, use the source if specified, then native\n    this.destSize.width = this.destSize?.width || this.sourceView?.width || nativeWidth;\n    this.destSize.height = this.destSize?.height || this.sourceView?.height || nativeHeight;\n\n    this.width = Math.ceil(this.destSize.width);\n    this.height = Math.ceil(this.destSize.height);\n  }\n\n  protected _preDraw(ex: ExcaliburGraphicsContext, x: number, y: number): void {\n    if (this.image.isLoaded()) {\n      this._updateSpriteDimensions();\n    }\n    super._preDraw(ex, x, y);\n  }\n\n  public _drawImage(ex: ExcaliburGraphicsContext, x: number, y: number): void {\n    if (this.image.isLoaded()) {\n      this._updateSpriteDimensions();\n      ex.drawImage(\n        this.image.image,\n        this.sourceView.x,\n        this.sourceView.y,\n        this.sourceView.width,\n        this.sourceView.height,\n        x,\n        y,\n        this.destSize.width,\n        this.destSize.height\n      );\n    }\n  }\n\n  /**\n   * Create a ImageSource from legacy texture\n   * @param sprite\n   */\n  public static fromLegacySprite(sprite: LegacySprite): Sprite {\n    const tex = sprite.texture;\n    const image = ImageSource.fromLegacyTexture(tex);\n    return new Sprite({\n      image,\n      sourceView: {\n        x: sprite.x,\n        y: sprite.y,\n        width: sprite.width,\n        height: sprite.height\n      }\n    });\n  }\n\n  /**\n   * Converts a sprite to a Legacy sprite\n   * @deprecated\n   * @param sprite\n   * @returns LegacyDrawing.Sprite\n   */\n  public static toLegacySprite(sprite: Sprite): LegacySprite {\n    const image = sprite.image;\n    const tex = new Texture(image.path);\n    tex.data = image.image;\n\n    return new LegacySprite(tex, sprite.sourceView.x, sprite.sourceView.y, sprite.sourceView.width, sprite.sourceView.height);\n  }\n\n  public clone(): Sprite {\n    return new Sprite({\n      image: this.image,\n      sourceView: { ...this.sourceView },\n      destSize: { ...this.destSize },\n      ...this.cloneGraphicOptions()\n    });\n  }\n}\n","import { Sprite, SpriteArgs } from './Sprite';\nimport { Animation } from './Animation';\nimport { Color } from '../Color';\nimport * as Effects from './SpriteEffects';\n\nimport { Texture } from './Texture';\nimport { Engine } from '../Engine';\nimport { Logger } from '../Util/Log';\nimport { BaseAlign, TextAlign } from '../Graphics/FontCommon';\nimport { obsolete } from '../Util/Decorators';\nimport { vec } from '../Math/vector';\n\nexport interface SpriteSheetArgs {\n  image: Texture;\n  sprites?: Sprite[];\n  spWidth: number;\n  spHeight: number;\n  rows: number;\n  columns: number;\n  spacing?: number | SpriteSheetSpacingDimensions;\n}\n\nexport interface SpriteSheetSpacingDimensions {\n  top?: number;\n  left?: number;\n  margin?: number;\n}\n\n/**\n * Sprite sheets are a useful mechanism for slicing up image resources into\n * separate sprites or for generating in game animations. [[Sprite|Sprites]] are organized\n * in row major order in the [[SpriteSheet]].\n * @deprecated Will be removed in v0.26.0\n */\nexport class SpriteSheet {\n  private _sprites: Sprite[] = [];\n  private _image: Texture | null = null;\n  private _columns: number = 0;\n  private _rows: number = 0;\n  private _spWidth: number = 0;\n  private _spHeight: number = 0;\n  private _spacing: number | SpriteSheetSpacingDimensions = 0;\n\n  /**\n   * @param config    The configuration of the SpriteSheet\n   */\n  constructor(config: SpriteSheetArgs);\n\n  /**\n   * @param sprites   The backing sprite array to use, if already available\n   */\n  constructor(sprites: Sprite[]);\n\n  /**\n   * @param image     The backing image texture to build the SpriteSheet\n   * @param columns   The number of columns in the image texture\n   * @param rows      The number of rows in the image texture\n   * @param spWidth   The width of each individual sprite in pixels\n   * @param spHeight  The height of each individual sprite in pixels\n   * @param spacing   The spacing between every sprite in a spritesheet\n   */\n  constructor(\n    image: Texture,\n    columns: number,\n    rows: number,\n    spWidth: number,\n    spHeight: number,\n    spacing?: number | SpriteSheetSpacingDimensions\n  );\n\n  /**\n   * @param imageOrConfigOrSprites The backing image texture to build the SpriteSheet, option bag, or sprite list\n   * @param columns   The number of columns in the image texture\n   * @param rows      The number of rows in the image texture\n   * @param spWidth   The width of each individual sprite in pixels\n   * @param spHeight  The height of each individual sprite in pixels\n   * @param spacing   The spacing between every sprite in a spritesheet\n   */\n  constructor(\n    imageOrConfigOrSprites: Texture | SpriteSheetArgs | Sprite[],\n    columns?: number,\n    rows?: number,\n    spWidth?: number,\n    spHeight?: number,\n    spacing?: number | SpriteSheetSpacingDimensions\n  ) {\n    let loadFromImage: boolean = false;\n    if (imageOrConfigOrSprites instanceof Array) {\n      this._sprites = imageOrConfigOrSprites;\n    } else {\n      if (imageOrConfigOrSprites && !(imageOrConfigOrSprites instanceof Texture)) {\n        this._columns = imageOrConfigOrSprites.columns;\n        this._rows = imageOrConfigOrSprites.rows;\n        this._spWidth = imageOrConfigOrSprites.spWidth;\n        this._spHeight = imageOrConfigOrSprites.spHeight;\n        this._image = imageOrConfigOrSprites.image;\n        this._spacing = imageOrConfigOrSprites.spacing || 0;\n      } else {\n        this._image = <Texture>imageOrConfigOrSprites;\n        this._columns = columns;\n        this._rows = rows;\n        this._spWidth = spWidth;\n        this._spHeight = spHeight;\n        this._spacing = spacing || 0;\n      }\n      this._sprites = new Array(this._columns * this._rows);\n      loadFromImage = true;\n    }\n\n    // Inspect actual image dimensions with preloading\n    if (this.image instanceof Texture) {\n      let isWidthError: boolean = false;\n      let isHeightError: boolean = false;\n      if (this.image.isLoaded()) {\n        isWidthError = this.spWidth * this.columns > this.image.image.naturalWidth;\n        isHeightError = this.spHeight * this.rows > this.image.image.naturalHeight;\n        if (isWidthError) {\n          throw new RangeError(\n            `SpriteSheet specified is wider, ` +\n              `${this.columns} cols x ${this.spWidth} pixels > ${this.image.image.naturalWidth} ` +\n              `pixels than image width`\n          );\n        }\n        if (isHeightError) {\n          throw new RangeError(\n            `SpriteSheet specified is taller, ` +\n              `${this.rows} rows x ${this.spHeight} pixels > ${this.image.image.naturalHeight} ` +\n              `pixels than image height`\n          );\n        }\n      }\n    }\n\n    if (loadFromImage) {\n      const spacing = this.getSpacingDimensions();\n\n      for (let row = 0; row < this.rows; row++) {\n        for (let col = 0; col < this.columns; col++) {\n          this._sprites[col + row * this.columns] = new Sprite(\n            this.image,\n            col * this.spWidth + spacing.margin * col + spacing.left,\n            row * this.spHeight + spacing.margin * row + spacing.top,\n            this.spWidth,\n            this.spHeight\n          );\n        }\n      }\n    }\n  }\n\n  /**\n   * Gets the raw spacing dimensions for the sprites in the sheet, which can be a fixed number or custom dimensions.\n   */\n  public get spacing() {\n    return this._spacing;\n  }\n\n  /**\n   * Get a copy of the backing sprite array\n   */\n  public get sprites() {\n    return [...this._sprites];\n  }\n\n  /**\n   * The backing texture used for the sprite sheet\n   */\n  public get image() {\n    return this._image;\n  }\n\n  /**\n   * The number of columns in the sheet\n   */\n  public get columns() {\n    return this._columns;\n  }\n\n  /**\n   * The number of rows in the sheet\n   */\n  public get rows() {\n    return this._rows;\n  }\n\n  /**\n   * The width of the individual sprites\n   */\n  public get spWidth() {\n    return this._spWidth;\n  }\n\n  /**\n   * The height of the individual sprites\n   */\n  public get spHeight() {\n    return this._spHeight;\n  }\n\n  /**\n   * Gets the calculated spacing dimensions based on whether spacing\n   * is a fixed number or has different values for each dimension\n   */\n  public getSpacingDimensions(): SpriteSheetSpacingDimensions {\n    if (typeof this.spacing === 'number') {\n      return {\n        left: this.spacing,\n        top: this.spacing,\n        margin: this.spacing\n      };\n    } else {\n      return {\n        left: this.spacing.left ?? 0,\n        top: this.spacing.top ?? 0,\n        margin: this.spacing.margin ?? 0\n      };\n    }\n  }\n\n  /**\n   * Create an animation from the this SpriteSheet by listing out the\n   * sprite indices. Sprites are organized in row major order in the SpriteSheet.\n   * @param engine   Reference to the current game [[Engine]]\n   * @param indices  An array of sprite indices to use in the animation\n   * @param speed    The number in milliseconds to display each frame in the animation\n   */\n  public getAnimationByIndices(engine: Engine, indices: number[], speed: number) {\n    let images: Sprite[] = indices.map((index) => {\n      return this.sprites[index];\n    });\n\n    images = images.map(function (i) {\n      return i.clone();\n    });\n    return new Animation(engine, images, speed);\n  }\n\n  /**\n   * Create an animation from the this SpriteSheet by specifying the range of\n   * images with the beginning (inclusive) and ending (exclusive) index\n   * For example `getAnimationBetween(engine, 0, 5, 200)` returns an animation with 5 frames.\n   * @param engine      Reference to the current game Engine\n   * @param beginIndex  The index to start taking frames (inclusive)\n   * @param endIndex    The index to stop taking frames (exclusive)\n   * @param speed       The number in milliseconds to display each frame in the animation\n   */\n  public getAnimationBetween(engine: Engine, beginIndex: number, endIndex: number, speed: number) {\n    let images = this.sprites.slice(beginIndex, endIndex);\n    images = images.map(function (i) {\n      return i.clone();\n    });\n    return new Animation(engine, images, speed);\n  }\n\n  /**\n   * Treat the entire SpriteSheet as one animation, organizing the frames in\n   * row major order.\n   * @param engine  Reference to the current game [[Engine]]\n   * @param speed   The number in milliseconds to display each frame the animation\n   */\n  public getAnimationForAll(engine: Engine, speed: number) {\n    const sprites = this.sprites.map(function (i) {\n      return i.clone();\n    });\n    return new Animation(engine, sprites, speed);\n  }\n\n  /**\n   * Retrieve a specific sprite from the SpriteSheet by its index. Sprites are organized\n   * in row major order in the SpriteSheet.\n   * @param index  The index of the sprite\n   */\n  public getSprite(index: number): Sprite {\n    if (index >= 0 && index < this.sprites.length) {\n      return this.sprites[index];\n    } else {\n      throw new Error('Invalid index: ' + index);\n    }\n  }\n\n  /**\n   * Get an animation with bespoke sprite coordinates. This is useful if the SpriteSheet is\n   * packed and not a uniform width or height. The resulting [[Animation]] will have the height and width of the\n   * largest dimension (width, height) from among the sprite coordinates\n   * @param engine\n   * @param spriteCoordinates\n   * @param speed\n   */\n  public getAnimationByCoords(engine: Engine, spriteCoordinates: SpriteArgs[], speed: number): Animation {\n    let maxWidth: number = 0;\n    let maxHeight: number = 0;\n    const sprites: Sprite[] = new Array(spriteCoordinates.length);\n    for (let i = 0; i < spriteCoordinates.length; i++) {\n      const coord = spriteCoordinates[i];\n      // no need to pass image again if using a spritesheet\n      coord.image = coord.image || this.image;\n      maxWidth = Math.max(maxWidth, coord.drawWidth);\n      maxHeight = Math.max(maxHeight, coord.drawHeight);\n      sprites[i] = new Sprite(coord);\n    }\n\n    const anim = new Animation(engine, sprites, speed);\n\n    anim.drawWidth = maxWidth;\n    anim.drawHeight = maxHeight;\n    return anim;\n  }\n}\n\n/**\n * Specify various font attributes for sprite fonts\n */\nexport interface SpriteFontOptions {\n  color?: Color;\n  opacity?: number;\n  fontSize?: number;\n  letterSpacing?: number;\n  textAlign?: TextAlign;\n  baseAlign?: BaseAlign;\n  maxWidth?: number;\n}\n\nexport interface SpriteFontArgs extends SpriteSheetArgs {\n  alphabet: string;\n  caseInsensitive: boolean;\n}\n\n/**\n * Sprite fonts are a used in conjunction with a [[Label]] to specify\n * a particular bitmap as a font. Note that some font features are not\n * supported by Sprite fonts.\n * @deprecated Will be removed into v0.26.0\n */\n@obsolete({\n  message: 'SpriteSheet will be removed in v0.26.0',\n  alternateMethod: 'Use Graphics.SpriteSheet'\n})\nexport class SpriteFont extends SpriteSheet {\n  private _currentColor: Color = Color.Black;\n  private _currentOpacity: Number = 1.0;\n  private _spriteRecord: Record<string, Sprite> = {};\n\n  // text shadow\n  private _textShadowOn: boolean = false;\n  private _textShadowDirty: boolean = true;\n  private _textShadowColor: Color = Color.Black;\n  private _textShadowSprites: { [key: string]: Sprite } = {};\n  private _shadowOffsetX: number = 5;\n  private _shadowOffsetY: number = 5;\n  public readonly alphabet: string;\n  public readonly caseInsensitive: boolean;\n\n  constructor(config: SpriteFontArgs);\n\n  constructor(\n    image: Texture,\n    alphabet: string,\n    caseInsensitive: boolean,\n    columns: number,\n    rows: number,\n    spWidth: number,\n    spHeight: number,\n    spacing?: number | SpriteSheetSpacingDimensions\n  );\n\n  /**\n   * @param imageOrConfig   The backing image texture to build the SpriteFont or the sprite font option bag\n   * @param alphabet        A string representing all the characters in the image, in row major order.\n   * @param caseInsensitive  Indicate whether this font takes case into account\n   * @param columns         The number of columns of characters in the image\n   * @param rows            The number of rows of characters in the image\n   * @param spWidth         The width of each character in pixels\n   * @param spHeight        The height of each character in pixels\n   */\n  constructor(\n    imageOrConfig: Texture | SpriteFontArgs,\n    alphabet?: string,\n    caseInsensitive?: boolean,\n    columns?: number,\n    rows?: number,\n    spWidth?: number,\n    spHeight?: number,\n    spacing?: number | SpriteSheetSpacingDimensions\n  ) {\n    super(\n      imageOrConfig instanceof Texture\n        ? {\n          image: imageOrConfig,\n          spWidth: spWidth,\n          spHeight: spHeight,\n          rows: rows,\n          columns: columns,\n          spacing: spacing || 0\n        }\n        : imageOrConfig\n    );\n\n    if (imageOrConfig && !(imageOrConfig instanceof Texture)) {\n      alphabet = imageOrConfig.alphabet;\n      caseInsensitive = imageOrConfig.caseInsensitive;\n    }\n\n    this.alphabet = alphabet;\n    this.caseInsensitive = caseInsensitive;\n    this._spriteRecord = this.getTextSprites();\n  }\n\n  /**\n   * Returns a dictionary that maps each character in the alphabet to the appropriate [[Sprite]].\n   */\n  public getTextSprites(): { [key: string]: Sprite } {\n    const lookup: { [key: string]: Sprite } = {};\n    for (let i = 0; i < this.alphabet.length; i++) {\n      let char = this.alphabet[i];\n      if (this.caseInsensitive) {\n        char = char.toLowerCase();\n      }\n      lookup[char] = this.sprites[i].clone();\n    }\n    return lookup;\n  }\n\n  /**\n   * Sets the text shadow for sprite fonts\n   * @param offsetX      The x offset in pixels to place the shadow\n   * @param offsetY      The y offset in pixels to place the shadow\n   * @param shadowColor  The color of the text shadow\n   */\n  public setTextShadow(offsetX: number, offsetY: number, shadowColor: Color) {\n    this._textShadowOn = true;\n    this._shadowOffsetX = offsetX;\n    this._shadowOffsetY = offsetY;\n    this._textShadowColor = shadowColor.clone();\n    this._textShadowDirty = true;\n    for (const character in this._spriteRecord) {\n      this._textShadowSprites[character] = this._spriteRecord[character].clone();\n    }\n  }\n\n  /**\n   * Toggles text shadows on or off\n   */\n  public useTextShadow(on: boolean) {\n    this._textShadowOn = on;\n    if (on) {\n      this.setTextShadow(5, 5, this._textShadowColor);\n    }\n  }\n\n  /**\n   * Draws the current sprite font\n   */\n  public draw(ctx: CanvasRenderingContext2D, text: string, x: number, y: number, options: SpriteFontOptions) {\n    options = this._parseOptions(options);\n\n    if (this._currentColor.toString() !== options.color.toString() || this._currentOpacity !== options.opacity) {\n      this._currentOpacity = options.opacity;\n      this._currentColor = options.color;\n      for (const char in this._spriteRecord) {\n        this._spriteRecord[char].clearEffects();\n        this._spriteRecord[char].fill(options.color);\n        this._spriteRecord[char].opacity(options.opacity);\n      }\n    }\n\n    if (this._textShadowOn && this._textShadowDirty && this._textShadowColor) {\n      for (const characterShadow in this._textShadowSprites) {\n        this._textShadowSprites[characterShadow].clearEffects();\n        this._textShadowSprites[characterShadow].addEffect(new Effects.Fill(this._textShadowColor.clone()));\n      }\n      this._textShadowDirty = false;\n    }\n\n    // find the current length of text in pixels\n    const sprite = this.sprites[0];\n\n    // find the current height fo the text in pixels\n    const height = sprite.height;\n\n    // calculate appropriate scale for font size\n    const scale = options.fontSize / height;\n\n    const length = text.length * sprite.width * scale + text.length * options.letterSpacing;\n\n    let currX = x;\n    if (options.textAlign === TextAlign.Left || options.textAlign === TextAlign.Start) {\n      currX = x;\n    } else if (options.textAlign === TextAlign.Right || options.textAlign === TextAlign.End) {\n      currX = x - length;\n    } else if (options.textAlign === TextAlign.Center) {\n      currX = x - length / 2;\n    }\n\n    let currY = y - height * scale;\n    if (options.baseAlign === BaseAlign.Top || options.baseAlign === BaseAlign.Hanging) {\n      currY = y;\n    } else if (\n      options.baseAlign === BaseAlign.Ideographic ||\n      options.baseAlign === BaseAlign.Bottom ||\n      options.baseAlign === BaseAlign.Alphabetic\n    ) {\n      currY = y - height * scale;\n    } else if (options.baseAlign === BaseAlign.Middle) {\n      currY = y - (height * scale) / 2;\n    }\n\n    for (let i = 0; i < text.length; i++) {\n      let character = text[i];\n      if (this.caseInsensitive) {\n        character = character.toLowerCase();\n      }\n      try {\n        // if text shadow\n        if (this._textShadowOn) {\n          this._textShadowSprites[character].drawAroundAnchor = false;\n          this._textShadowSprites[character].scale = vec(scale, scale);\n          this._textShadowSprites[character].draw(ctx, currX + this._shadowOffsetX, currY + this._shadowOffsetY);\n        }\n\n        const charSprite = this._spriteRecord[character];\n        charSprite.drawAroundAnchor = false;\n        charSprite.scale = vec(scale, scale);\n        charSprite.draw(ctx, currX, currY);\n        currX += charSprite.drawWidth + options.letterSpacing;\n      } catch (e) {\n        Logger.getInstance().error(`SpriteFont Error drawing char ${character}`);\n      }\n    }\n  }\n\n  private _parseOptions(options: SpriteFontOptions): SpriteFontOptions {\n    return {\n      fontSize: options.fontSize || 10,\n      letterSpacing: options.letterSpacing || 0,\n      color: options.color || Color.Black,\n      textAlign: typeof options.textAlign === undefined ? TextAlign.Left : options.textAlign,\n      baseAlign: typeof options.baseAlign === undefined ? BaseAlign.Bottom : options.baseAlign,\n      maxWidth: options.maxWidth || -1,\n      opacity: options.opacity || 0\n    };\n  }\n}\n","import { ImageSource } from './ImageSource';\nimport { Sprite } from './Sprite';\nimport { SpriteSheet as LegacySpriteSheet } from '../Drawing/SpriteSheet';\nimport { Logger } from '..';\n\n\n/**\n * Specify sprite sheet spacing options, useful if your sprites are not tightly packed\n * and have space between them.\n */\nexport interface SpriteSheetSpacingDimensions {\n  /**\n   * The starting point to offset and start slicing the sprite sheet from the top left of the image.\n   * Default is (0, 0)\n   */\n  originOffset?: { x?: number, y?: number };\n\n  /**\n   * The margin between sprites.\n   * Default is (0, 0)\n   */\n  margin?: {x?: number, y?: number};\n}\n\n/**\n * Sprite sheet options for slicing up images\n */\nexport interface SpriteSheetGridOptions {\n  /**\n   * Source image to use for each sprite\n   */\n  image: ImageSource;\n  /**\n   * Grid definition for the sprite sheet\n   */\n  grid: {\n    /**\n     * Number of rows in the sprite sheet\n     */\n    rows: number;\n    /**\n     * Number of columns in the sprite sheet\n     */\n    columns: number;\n    /**\n     * Width of each individual sprite\n     */\n    spriteWidth: number;\n    /**\n     * Height of each individual sprite\n     */\n    spriteHeight: number;\n  };\n  /**\n   * Optionally specifiy any spacing information between sprites\n   */\n  spacing?: SpriteSheetSpacingDimensions;\n}\n\nexport interface SpriteSheetOptions {\n  /**\n   * Source sprites for the sprite sheet\n   */\n  sprites: Sprite[];\n  /**\n   * Optionally specify the number of rows in a sprite sheet (default 1 row)\n   */\n  rows?: number;\n  /**\n   * Optionally specify the number of columns in a sprite sheet (default sprites.length)\n   */\n  columns?: number;\n}\n\n/**\n * Represents a collection of sprites from a source image with some organization in a grid\n */\nexport class SpriteSheet {\n  private _logger = Logger.getInstance();\n  public readonly sprites: Sprite[] = [];\n  public readonly rows: number;\n  public readonly columns: number;\n\n  /**\n   * Build a new sprite sheet from a list of sprites\n   *\n   * Use [[SpriteSheet.fromImageSource]] to create a SpriteSheet from an [[ImageSource]] organized in a grid\n   * @param options\n   */\n  constructor(options: SpriteSheetOptions) {\n    const { sprites, rows, columns } = options;\n    this.sprites = sprites;\n    this.rows = rows ?? 1;\n    this.columns = columns ?? this.sprites.length;\n  }\n\n  /**\n   * Find a sprite by their x/y position in the SpriteSheet, for example `getSprite(0, 0)` is the [[Sprite]] in the top-left\n   * @param x\n   * @param y\n   */\n  public getSprite(x: number, y: number): Sprite | null {\n    if (x >= this.columns || x < 0) {\n      this._logger.warn(`No sprite exists in the SpriteSheet at (${x}, ${y}), x: ${x} should be between 0 and ${this.columns - 1}`);\n      return null;\n    }\n    if (y >= this.rows || y < 0) {\n      this._logger.warn(`No sprite exists in the SpriteSheet at (${x}, ${y}), y: ${y} should be between 0 and ${this.rows - 1}`);\n      return null;\n    }\n    const spriteIndex = x + y * this.columns;\n    return this.sprites[spriteIndex];\n  }\n\n  /**\n   * To a graphics sprite sheet from a legacy sprite sheet\n   */\n  public static fromLegacySpriteSheet(legacySpriteSheet: LegacySpriteSheet): SpriteSheet {\n    const sprites = legacySpriteSheet.sprites.map(oldSprite => Sprite.fromLegacySprite(oldSprite));\n    return new SpriteSheet({\n      sprites\n    });\n  }\n\n  /**\n   * @deprecated\n   * @param spriteSheet\n   * @returns\n   */\n  public static toLegacySpriteSheet(spriteSheet: SpriteSheet): LegacySpriteSheet {\n    const sprites = spriteSheet.sprites.map(sprite => Sprite.toLegacySprite(sprite));\n    return new LegacySpriteSheet(sprites);\n  }\n\n  /**\n   * Create a SpriteSheet from an [[ImageSource]] organized in a grid\n   *\n   * Example:\n   * ```\n   * const spriteSheet = SpriteSheet.fromImageSource({\n   *   image: imageSource,\n   *   grid: {\n   *     rows: 5,\n   *     columns: 2,\n   *     spriteWidth: 32, // pixels\n   *     spriteHeight: 32 // pixels\n   *   },\n   *   // Optionally specify spacing\n   *   spacing: {\n   *     // pixels from the top left to start the sprite parsing\n   *     originOffset: {\n   *       x: 5,\n   *       y: 5\n   *     },\n   *     // pixels between each sprite while parsing\n   *     margin: {\n   *       x: 1,\n   *       y: 1\n   *     }\n   *   }\n   * })\n   * ```\n   *\n   * @param options\n   */\n  public static fromImageSource(options: SpriteSheetGridOptions): SpriteSheet {\n    const sprites: Sprite[] = [];\n    options.spacing = options.spacing ?? {};\n    const {\n      image,\n      grid: { rows, columns: cols, spriteWidth, spriteHeight },\n      spacing: { originOffset, margin }\n    } = options;\n    const offsetDefaults = { x: 0, y: 0, ...originOffset};\n    const marginDefaults = { x: 0, y: 0, ...margin};\n    for (let x = 0; x < cols; x++) {\n      for (let y = 0; y < rows; y++) {\n        sprites[x + y * cols] = new Sprite({\n          image: image,\n          sourceView: {\n            x: x * spriteWidth + marginDefaults.x * x + offsetDefaults.x,\n            y: y * spriteHeight + marginDefaults.y * y + offsetDefaults.y,\n            width: spriteWidth,\n            height: spriteHeight\n          },\n          destSize: { height: spriteHeight, width: spriteWidth }\n        });\n      }\n    }\n    return new SpriteSheet({\n      sprites: sprites,\n      rows: rows,\n      columns: cols\n    });\n  }\n}\n","import { Engine } from './Engine';\nimport { EasingFunction, EasingFunctions } from './Util/EasingFunctions';\nimport { Vector, vec } from './Math/vector';\nimport { Actor } from './Actor';\nimport { removeItemFromArray } from './Util/Util';\nimport { CanUpdate, CanInitialize } from './Interfaces/LifecycleEvents';\nimport { PreUpdateEvent, PostUpdateEvent, GameEvent, InitializeEvent } from './Events';\nimport { Class } from './Class';\nimport { BoundingBox } from './Collision/BoundingBox';\nimport { Logger } from './Util/Log';\nimport { ExcaliburGraphicsContext } from './Graphics/Context/ExcaliburGraphicsContext';\nimport { watchAny } from './Util/Watch';\n\n/**\n * Interface that describes a custom camera strategy for tracking targets\n */\nexport interface CameraStrategy<T> {\n  /**\n   * Target of the camera strategy that will be passed to the action\n   */\n  target: T;\n\n  /**\n   * Camera strategies perform an action to calculate a new focus returned out of the strategy\n   * @param target The target object to apply this camera strategy (if any)\n   * @param camera The current camera implementation in excalibur running the game\n   * @param engine The current engine running the game\n   * @param delta The elapsed time in milliseconds since the last frame\n   */\n  action: (target: T, camera: Camera, engine: Engine, delta: number) => Vector;\n}\n\n/**\n * Container to house convenience strategy methods\n * @internal\n */\nexport class StrategyContainer {\n  constructor(public camera: Camera) {}\n\n  /**\n   * Creates and adds the [[LockCameraToActorStrategy]] on the current camera.\n   * @param actor The actor to lock the camera to\n   */\n  public lockToActor(actor: Actor) {\n    this.camera.addStrategy(new LockCameraToActorStrategy(actor));\n  }\n\n  /**\n   * Creates and adds the [[LockCameraToActorAxisStrategy]] on the current camera\n   * @param actor The actor to lock the camera to\n   * @param axis The axis to follow the actor on\n   */\n  public lockToActorAxis(actor: Actor, axis: Axis) {\n    this.camera.addStrategy(new LockCameraToActorAxisStrategy(actor, axis));\n  }\n\n  /**\n   * Creates and adds the [[ElasticToActorStrategy]] on the current camera\n   * If cameraElasticity < cameraFriction < 1.0, the behavior will be a dampened spring that will slowly end at the target without bouncing\n   * If cameraFriction < cameraElasticity < 1.0, the behavior will be an oscillating spring that will over\n   * correct and bounce around the target\n   *\n   * @param actor Target actor to elastically follow\n   * @param cameraElasticity [0 - 1.0] The higher the elasticity the more force that will drive the camera towards the target\n   * @param cameraFriction [0 - 1.0] The higher the friction the more that the camera will resist motion towards the target\n   */\n  public elasticToActor(actor: Actor, cameraElasticity: number, cameraFriction: number) {\n    this.camera.addStrategy(new ElasticToActorStrategy(actor, cameraElasticity, cameraFriction));\n  }\n\n  /**\n   * Creates and adds the [[RadiusAroundActorStrategy]] on the current camera\n   * @param actor Target actor to follow when it is \"radius\" pixels away\n   * @param radius Number of pixels away before the camera will follow\n   */\n  public radiusAroundActor(actor: Actor, radius: number) {\n    this.camera.addStrategy(new RadiusAroundActorStrategy(actor, radius));\n  }\n\n  /**\n   * Creates and adds the [[LimitCameraBoundsStrategy]] on the current camera\n   * @param box The bounding box to limit the camera to.\n   */\n  public limitCameraBounds(box: BoundingBox) {\n    this.camera.addStrategy(new LimitCameraBoundsStrategy(box));\n  }\n}\n\n/**\n * Camera axis enum\n */\nexport enum Axis {\n  X,\n  Y\n}\n\n/**\n * Lock a camera to the exact x/y position of an actor.\n */\nexport class LockCameraToActorStrategy implements CameraStrategy<Actor> {\n  constructor(public target: Actor) {}\n  public action = (target: Actor, _cam: Camera, _eng: Engine, _delta: number) => {\n    const center = target.center;\n    return center;\n  };\n}\n\n/**\n * Lock a camera to a specific axis around an actor.\n */\nexport class LockCameraToActorAxisStrategy implements CameraStrategy<Actor> {\n  constructor(public target: Actor, public axis: Axis) {}\n  public action = (target: Actor, cam: Camera, _eng: Engine, _delta: number) => {\n    const center = target.center;\n    const currentFocus = cam.getFocus();\n    if (this.axis === Axis.X) {\n      return new Vector(center.x, currentFocus.y);\n    } else {\n      return new Vector(currentFocus.x, center.y);\n    }\n  };\n}\n\n/**\n * Using [Hook's law](https://en.wikipedia.org/wiki/Hooke's_law), elastically move the camera towards the target actor.\n */\nexport class ElasticToActorStrategy implements CameraStrategy<Actor> {\n  /**\n   * If cameraElasticity < cameraFriction < 1.0, the behavior will be a dampened spring that will slowly end at the target without bouncing\n   * If cameraFriction < cameraElasticity < 1.0, the behavior will be an oscillating spring that will over\n   * correct and bounce around the target\n   *\n   * @param target Target actor to elastically follow\n   * @param cameraElasticity [0 - 1.0] The higher the elasticity the more force that will drive the camera towards the target\n   * @param cameraFriction [0 - 1.0] The higher the friction the more that the camera will resist motion towards the target\n   */\n  constructor(public target: Actor, public cameraElasticity: number, public cameraFriction: number) {}\n  public action = (target: Actor, cam: Camera, _eng: Engine, _delta: number) => {\n    const position = target.center;\n    let focus = cam.getFocus();\n    let cameraVel = cam.vel.clone();\n\n    // Calculate the stretch vector, using the spring equation\n    // F = kX\n    // https://en.wikipedia.org/wiki/Hooke's_law\n    // Apply to the current camera velocity\n    const stretch = position.sub(focus).scale(this.cameraElasticity); // stretch is X\n    cameraVel = cameraVel.add(stretch);\n\n    // Calculate the friction (-1 to apply a force in the opposition of motion)\n    // Apply to the current camera velocity\n    const friction = cameraVel.scale(-1).scale(this.cameraFriction);\n    cameraVel = cameraVel.add(friction);\n\n    // Update position by velocity deltas\n    focus = focus.add(cameraVel);\n\n    return focus;\n  };\n}\n\nexport class RadiusAroundActorStrategy implements CameraStrategy<Actor> {\n  /**\n   *\n   * @param target Target actor to follow when it is \"radius\" pixels away\n   * @param radius Number of pixels away before the camera will follow\n   */\n  constructor(public target: Actor, public radius: number) {}\n  public action = (target: Actor, cam: Camera, _eng: Engine, _delta: number) => {\n    const position = target.center;\n    const focus = cam.getFocus();\n\n    const direction = position.sub(focus);\n    const distance = direction.size;\n    if (distance >= this.radius) {\n      const offset = distance - this.radius;\n      return focus.add(direction.normalize().scale(offset));\n    }\n    return focus;\n  };\n}\n\n/**\n * Prevent a camera from going beyond the given camera dimensions.\n */\nexport class LimitCameraBoundsStrategy implements CameraStrategy<BoundingBox> {\n  /**\n   * Useful for limiting the camera to a [[TileMap]]'s dimensions, or a specific area inside the map.\n   *\n   * Note that this strategy does not perform any movement by itself.\n   * It only sets the camera position to within the given bounds when the camera has gone beyond them.\n   * Thus, it is a good idea to combine it with other camera strategies and set this strategy as the last one.\n   *\n   * Make sure that the camera bounds are at least as large as the viewport size.\n   *\n   * @param target The bounding box to limit the camera to\n   */\n\n  boundSizeChecked: boolean = false; // Check and warn only once\n\n  constructor(public target: BoundingBox) {}\n\n  public action = (target: BoundingBox, cam: Camera, _eng: Engine, _delta: number) => {\n    const focus = cam.getFocus();\n\n    if (!this.boundSizeChecked) {\n      if (target.bottom - target.top < _eng.drawHeight || target.right - target.left < _eng.drawWidth) {\n        Logger.getInstance().warn('Camera bounds should not be smaller than the engine viewport');\n      }\n      this.boundSizeChecked = true;\n    }\n\n    let focusX = focus.x;\n    let focusY = focus.y;\n    if (focus.x < target.left + _eng.halfDrawWidth) {\n      focusX = target.left + _eng.halfDrawWidth;\n    } else if (focus.x > target.right - _eng.halfDrawWidth) {\n      focusX = target.right - _eng.halfDrawWidth;\n    }\n\n    if (focus.y < target.top + _eng.halfDrawHeight) {\n      focusY = target.top + _eng.halfDrawHeight;\n    } else if (focus.y > target.bottom - _eng.halfDrawHeight) {\n      focusY = target.bottom - _eng.halfDrawHeight;\n    }\n\n    return vec(focusX, focusY);\n  };\n}\n\n/**\n * Cameras\n *\n * [[Camera]] is the base class for all Excalibur cameras. Cameras are used\n * to move around your game and set focus. They are used to determine\n * what is \"off screen\" and can be used to scale the game.\n *\n */\nexport class Camera extends Class implements CanUpdate, CanInitialize {\n  protected _follow: Actor;\n\n  private _cameraStrategies: CameraStrategy<any>[] = [];\n\n  public strategy: StrategyContainer = new StrategyContainer(this);\n\n  /**\n   * Get or set current zoom of the camera, defaults to 1\n   */\n  private _z = 1;\n  public get zoom(): number {\n    return this._z;\n  }\n\n  public set zoom(val: number) {\n    this._z = val;\n    if (this._engine) {\n      this._halfWidth = this._engine.halfDrawWidth;\n      this._halfHeight = this._engine.halfDrawHeight;\n    }\n  }\n  /**\n   * Get or set rate of change in zoom, defaults to 0\n   */\n  public dz: number = 0;\n  /**\n   * Get or set zoom acceleration\n   */\n  public az: number = 0;\n\n  /**\n   * Current rotation of the camera\n   */\n  public rotation: number = 0;\n\n  /**\n   * Current angular velocity\n   */\n  public rx: number = 0;\n\n  /**\n   * Get or set the camera's angular velocity\n   */\n  public get angularVelocity(): number {\n    return this.rx;\n  }\n\n  public set angularVelocity(value: number) {\n    this.rx = value;\n  }\n\n  /**\n   * Get or set the camera's position\n   */\n  private _posChanged = false;\n  private _pos: Vector = watchAny(Vector.Zero, () => (this._posChanged = true));\n  public get pos(): Vector {\n    return this._pos;\n  }\n  public set pos(vec: Vector) {\n    this._pos = watchAny(vec, () => (this._posChanged = true));\n    this._posChanged = true;\n  }\n\n  /**\n   * Get or set the camera's velocity\n   */\n  public vel: Vector = Vector.Zero;\n\n  /**\n   * GEt or set the camera's acceleration\n   */\n  public acc: Vector = Vector.Zero;\n\n  private _cameraMoving: boolean = false;\n  private _currentLerpTime: number = 0;\n  private _lerpDuration: number = 1000; // 1 second\n  private _lerpStart: Vector = null;\n  private _lerpEnd: Vector = null;\n  private _lerpResolve: (value: Vector) => void;\n  private _lerpPromise: Promise<Vector>;\n\n  //camera effects\n  protected _isShaking: boolean = false;\n  private _shakeMagnitudeX: number = 0;\n  private _shakeMagnitudeY: number = 0;\n  private _shakeDuration: number = 0;\n  private _elapsedShakeTime: number = 0;\n  private _xShake: number = 0;\n  private _yShake: number = 0;\n\n  protected _isZooming: boolean = false;\n  private _zoomStart: number = 1;\n  private _zoomEnd: number = 1;\n  private _currentZoomTime: number = 0;\n  private _zoomDuration: number = 0;\n\n  private _zoomResolve: (val: boolean) => void;\n  private _zoomPromise: Promise<boolean>;\n  private _zoomEasing: EasingFunction = EasingFunctions.EaseInOutCubic;\n  private _easing: EasingFunction = EasingFunctions.EaseInOutCubic;\n\n  private _halfWidth: number = 0;\n  private _halfHeight: number = 0;\n\n  /**\n   * Get the camera's x position\n   */\n  public get x() {\n    return this.pos.x;\n  }\n\n  /**\n   * Set the camera's x position (cannot be set when following an [[Actor]] or when moving)\n   */\n  public set x(value: number) {\n    if (!this._follow && !this._cameraMoving) {\n      this.pos = vec(value, this.pos.y);\n    }\n  }\n\n  /**\n   * Get the camera's y position\n   */\n  public get y() {\n    return this.pos.y;\n  }\n\n  /**\n   * Set the camera's y position (cannot be set when following an [[Actor]] or when moving)\n   */\n  public set y(value: number) {\n    if (!this._follow && !this._cameraMoving) {\n      this.pos = vec(this.pos.x, value);\n    }\n  }\n\n  /**\n   * Get or set the camera's x velocity\n   */\n  public get dx() {\n    return this.vel.x;\n  }\n\n  public set dx(value: number) {\n    this.vel = vec(value, this.vel.y);\n  }\n\n  /**\n   * Get or set the camera's y velocity\n   */\n  public get dy() {\n    return this.vel.y;\n  }\n\n  public set dy(value: number) {\n    this.vel = vec(this.vel.x, value);\n  }\n\n  /**\n   * Get or set the camera's x acceleration\n   */\n  public get ax() {\n    return this.acc.x;\n  }\n\n  public set ax(value: number) {\n    this.acc = vec(value, this.acc.y);\n  }\n\n  /**\n   * Get or set the camera's y acceleration\n   */\n  public get ay() {\n    return this.acc.y;\n  }\n\n  public set ay(value: number) {\n    this.acc = vec(this.acc.x, value);\n  }\n\n  /**\n   * Returns the focal point of the camera, a new point giving the x and y position of the camera\n   */\n  public getFocus() {\n    return this.pos;\n  }\n\n  /**\n   * This moves the camera focal point to the specified position using specified easing function. Cannot move when following an Actor.\n   *\n   * @param pos The target position to move to\n   * @param duration The duration in milliseconds the move should last\n   * @param [easingFn] An optional easing function ([[ex.EasingFunctions.EaseInOutCubic]] by default)\n   * @returns A [[Promise]] that resolves when movement is finished, including if it's interrupted.\n   *          The [[Promise]] value is the [[Vector]] of the target position. It will be rejected if a move cannot be made.\n   */\n  public move(pos: Vector, duration: number, easingFn: EasingFunction = EasingFunctions.EaseInOutCubic): Promise<Vector> {\n    if (typeof easingFn !== 'function') {\n      throw 'Please specify an EasingFunction';\n    }\n\n    // cannot move when following an actor\n    if (this._follow) {\n      return Promise.reject(pos);\n    }\n\n    // resolve existing promise, if any\n    if (this._lerpPromise && this._lerpResolve) {\n      this._lerpResolve(pos);\n    }\n\n    this._lerpPromise = new Promise<Vector>((resolve) => {\n      this._lerpResolve = resolve;\n    });\n    this._lerpStart = this.getFocus().clone();\n    this._lerpDuration = duration;\n    this._lerpEnd = pos;\n    this._currentLerpTime = 0;\n    this._cameraMoving = true;\n    this._easing = easingFn;\n\n    return this._lerpPromise;\n  }\n\n  /**\n   * Sets the camera to shake at the specified magnitudes for the specified duration\n   * @param magnitudeX  The x magnitude of the shake\n   * @param magnitudeY  The y magnitude of the shake\n   * @param duration    The duration of the shake in milliseconds\n   */\n  public shake(magnitudeX: number, magnitudeY: number, duration: number) {\n    this._isShaking = true;\n    this._shakeMagnitudeX = magnitudeX;\n    this._shakeMagnitudeY = magnitudeY;\n    this._shakeDuration = duration;\n  }\n\n  /**\n   * Zooms the camera in or out by the specified scale over the specified duration.\n   * If no duration is specified, it take effect immediately.\n   * @param scale    The scale of the zoom\n   * @param duration The duration of the zoom in milliseconds\n   */\n  public zoomOverTime(scale: number, duration: number = 0, easingFn: EasingFunction = EasingFunctions.EaseInOutCubic): Promise<boolean> {\n    this._zoomPromise = new Promise<boolean>((resolve) => {\n      this._zoomResolve = resolve;\n    });\n\n    if (duration) {\n      this._isZooming = true;\n      this._zoomEasing = easingFn;\n      this._currentZoomTime = 0;\n      this._zoomDuration = duration;\n      this._zoomStart = this.zoom;\n      this._zoomEnd = scale;\n    } else {\n      this._isZooming = false;\n      this.zoom = scale;\n      return Promise.resolve(true);\n    }\n\n    return this._zoomPromise;\n  }\n\n  private _viewport: BoundingBox = null;\n  /**\n   * Gets the bounding box of the viewport of this camera in world coordinates\n   */\n  public get viewport(): BoundingBox {\n    if (this._viewport) {\n      return this._viewport;\n    }\n\n    return new BoundingBox(0, 0, 0, 0);\n  }\n\n  /**\n   * Adds a new camera strategy to this camera\n   * @param cameraStrategy Instance of an [[CameraStrategy]]\n   */\n  public addStrategy<T>(cameraStrategy: CameraStrategy<T>) {\n    this._cameraStrategies.push(cameraStrategy);\n  }\n\n  /**\n   * Removes a camera strategy by reference\n   * @param cameraStrategy Instance of an [[CameraStrategy]]\n   */\n  public removeStrategy<T>(cameraStrategy: CameraStrategy<T>) {\n    removeItemFromArray(cameraStrategy, this._cameraStrategies);\n  }\n\n  /**\n   * Clears all camera strategies from the camera\n   */\n  public clearAllStrategies() {\n    this._cameraStrategies.length = 0;\n  }\n\n  /**\n   * It is not recommended that internal excalibur methods be overridden, do so at your own risk.\n   *\n   * Internal _preupdate handler for [[onPreUpdate]] lifecycle event\n   * @internal\n   */\n  public _preupdate(engine: Engine, delta: number): void {\n    this.emit('preupdate', new PreUpdateEvent(engine, delta, this));\n    this.onPreUpdate(engine, delta);\n  }\n\n  /**\n   * Safe to override onPreUpdate lifecycle event handler. Synonymous with `.on('preupdate', (evt) =>{...})`\n   *\n   * `onPreUpdate` is called directly before a scene is updated.\n   */\n  public onPreUpdate(_engine: Engine, _delta: number): void {\n    // Overridable\n  }\n\n  /**\n   *  It is not recommended that internal excalibur methods be overridden, do so at your own risk.\n   *\n   * Internal _preupdate handler for [[onPostUpdate]] lifecycle event\n   * @internal\n   */\n  public _postupdate(engine: Engine, delta: number): void {\n    this.emit('postupdate', new PostUpdateEvent(engine, delta, this));\n    this.onPostUpdate(engine, delta);\n  }\n\n  /**\n   * Safe to override onPostUpdate lifecycle event handler. Synonymous with `.on('preupdate', (evt) =>{...})`\n   *\n   * `onPostUpdate` is called directly after a scene is updated.\n   */\n  public onPostUpdate(_engine: Engine, _delta: number): void {\n    // Overridable\n  }\n\n  private _engine: Engine;\n  private _isInitialized = false;\n  public get isInitialized() {\n    return this._isInitialized;\n  }\n\n  public _initialize(_engine: Engine) {\n    if (!this.isInitialized) {\n      this._engine = _engine;\n      this._halfWidth = _engine.halfDrawWidth;\n      this._halfHeight = _engine.halfDrawHeight;\n      // pos unset apply default position is center screen\n      if (!this._posChanged) {\n        this.pos.x = _engine.halfDrawWidth;\n        this.pos.y = _engine.halfDrawHeight;\n      }\n\n      this.onInitialize(_engine);\n      super.emit('initialize', new InitializeEvent(_engine, this));\n      this._isInitialized = true;\n    }\n  }\n\n  /**\n   * Safe to override onPostUpdate lifecycle event handler. Synonymous with `.on('preupdate', (evt) =>{...})`\n   *\n   * `onPostUpdate` is called directly after a scene is updated.\n   */\n  public onInitialize(_engine: Engine) {\n    // Overridable\n  }\n\n  public on(eventName: 'initialize', handler: (event: InitializeEvent) => void): void;\n  public on(eventName: 'preupdate', handler: (event: PreUpdateEvent) => void): void;\n  public on(eventName: 'postupdate', handler: (event: PostUpdateEvent) => void): void;\n  public on(eventName: any, handler: any) {\n    super.on(eventName, handler);\n  }\n\n  public off(eventName: 'initialize', handler?: (event: InitializeEvent) => void): void;\n  public off(eventName: 'preupdate', handler?: (event: PreUpdateEvent) => void): void;\n  public off(eventName: 'postupdate', handler?: (event: PostUpdateEvent) => void): void;\n  public off(eventName: string, handler: (event: GameEvent<Camera>) => void): void;\n  public off(eventName: string, handler: (event: any) => void): void {\n    super.off(eventName, handler);\n  }\n\n  public once(eventName: 'initialize', handler: (event: InitializeEvent) => void): void;\n  public once(eventName: 'preupdate', handler: (event: PreUpdateEvent) => void): void;\n  public once(eventName: 'postupdate', handler: (event: PostUpdateEvent) => void): void;\n  public once(eventName: string, handler: (event: GameEvent<Camera>) => void): void;\n  public once(eventName: string, handler: (event: any) => void): void {\n    super.once(eventName, handler);\n  }\n\n  public update(_engine: Engine, delta: number) {\n    this._initialize(_engine);\n    this._preupdate(_engine, delta);\n\n    // Update placements based on linear algebra\n    this.pos = this.pos.add(this.vel.scale(delta / 1000));\n    this.zoom += (this.dz * delta) / 1000;\n\n    this.vel = this.vel.add(this.acc.scale(delta / 1000));\n    this.dz += (this.az * delta) / 1000;\n\n    this.rotation += (this.angularVelocity * delta) / 1000;\n\n    if (this._isZooming) {\n      if (this._currentZoomTime < this._zoomDuration) {\n        const zoomEasing = this._zoomEasing;\n        const newZoom = zoomEasing(this._currentZoomTime, this._zoomStart, this._zoomEnd, this._zoomDuration);\n\n        this.zoom = newZoom;\n        this._currentZoomTime += delta;\n      } else {\n        this._isZooming = false;\n        this.zoom = this._zoomEnd;\n        this._currentZoomTime = 0;\n        this._zoomResolve(true);\n      }\n    }\n\n    if (this._cameraMoving) {\n      if (this._currentLerpTime < this._lerpDuration) {\n        const moveEasing = EasingFunctions.CreateVectorEasingFunction(this._easing);\n\n        const lerpPoint = moveEasing(this._currentLerpTime, this._lerpStart, this._lerpEnd, this._lerpDuration);\n\n        this.pos = lerpPoint;\n\n        this._currentLerpTime += delta;\n      } else {\n        this.pos = this._lerpEnd;\n        const end = this._lerpEnd.clone();\n\n        this._lerpStart = null;\n        this._lerpEnd = null;\n        this._currentLerpTime = 0;\n        this._cameraMoving = false;\n        // Order matters here, resolve should be last so any chain promises have a clean slate\n        this._lerpResolve(end);\n      }\n    }\n\n    if (this._isDoneShaking()) {\n      this._isShaking = false;\n      this._elapsedShakeTime = 0;\n      this._shakeMagnitudeX = 0;\n      this._shakeMagnitudeY = 0;\n      this._shakeDuration = 0;\n      this._xShake = 0;\n      this._yShake = 0;\n    } else {\n      this._elapsedShakeTime += delta;\n      this._xShake = ((Math.random() * this._shakeMagnitudeX) | 0) + 1;\n      this._yShake = ((Math.random() * this._shakeMagnitudeY) | 0) + 1;\n    }\n\n    for (const s of this._cameraStrategies) {\n      this.pos = s.action.call(s, s.target, this, _engine, delta);\n    }\n\n    this._viewport = new BoundingBox(\n      this.x - this._halfWidth,\n      this.y - this._halfHeight,\n      this.x + this._halfWidth,\n      this.y + this._halfHeight\n    );\n\n    this._postupdate(_engine, delta);\n  }\n\n  /**\n   * Applies the relevant transformations to the game canvas to \"move\" or apply effects to the Camera\n   * @param ctx    Canvas context to apply transformations\n   */\n  public draw(ctx: CanvasRenderingContext2D): void;\n  public draw(ctx: ExcaliburGraphicsContext): void;\n  public draw(ctx: CanvasRenderingContext2D | ExcaliburGraphicsContext): void {\n    let canvasWidth = 0;\n    let canvasHeight = 0;\n    if (ctx instanceof CanvasRenderingContext2D) {\n      canvasWidth = ctx.canvas.width;\n      canvasHeight = ctx.canvas.height;\n    } else {\n      canvasWidth = ctx.width;\n      canvasHeight = ctx.height;\n    }\n    const focus = this.getFocus();\n    const pixelRatio = this._engine ? this._engine.pixelRatio : 1;\n    const zoom = this.zoom;\n\n    const newCanvasWidth = canvasWidth / zoom / pixelRatio;\n    const newCanvasHeight = canvasHeight / zoom / pixelRatio;\n\n    ctx.scale(zoom, zoom);\n    ctx.translate(-focus.x + newCanvasWidth / 2 + this._xShake, -focus.y + newCanvasHeight / 2 + this._yShake);\n  }\n\n  /* istanbul ignore next */\n  public debugDraw(_ctx: CanvasRenderingContext2D) {\n    // pass\n  }\n\n  private _isDoneShaking(): boolean {\n    return !this._isShaking || this._elapsedShakeTime >= this._shakeDuration;\n  }\n}\n","import { BoundingBox } from './Collision/BoundingBox';\nimport { Engine } from './Engine';\nimport { Vector, vec } from './Math/vector';\nimport { Logger } from './Util/Log';\nimport { SpriteSheet } from './Drawing/SpriteSheet';\nimport * as Events from './Events';\nimport { Configurable } from './Configurable';\nimport { Entity } from './EntityComponentSystem/Entity';\nimport { TransformComponent } from './EntityComponentSystem/Components/TransformComponent';\nimport { BodyComponent } from './Collision/BodyComponent';\nimport { CollisionType } from './Collision/CollisionType';\nimport { Shape } from './Collision/Colliders/Shape';\nimport { ExcaliburGraphicsContext, GraphicsComponent, hasGraphicsTick } from './Graphics';\nimport * as Graphics from './Graphics';\nimport { CanvasDrawComponent, Sprite } from './Drawing/Index';\nimport { Sprite as LegacySprite } from './Drawing/Index';\nimport { removeItemFromArray } from './Util/Util';\nimport { obsolete } from './Util/Decorators';\nimport { MotionComponent } from './EntityComponentSystem/Components/MotionComponent';\nimport { ColliderComponent } from './Collision/ColliderComponent';\nimport { CompositeCollider } from './Collision/Colliders/CompositeCollider';\n\n/**\n * @hidden\n */\nexport class TileMapImpl extends Entity {\n  private _token = 0;\n  private _onScreenXStart: number = 0;\n  private _onScreenXEnd: number = 9999;\n  private _onScreenYStart: number = 0;\n  private _onScreenYEnd: number = 9999;\n  private _spriteSheets: { [key: string]: Graphics.SpriteSheet } = {};\n\n  private _legacySpriteMap = new Map<Graphics.Sprite, Sprite>();\n  public logger: Logger = Logger.getInstance();\n  public readonly data: Cell[] = [];\n  private _rows: Cell[][] = [];\n  private _cols: Cell[][] = [];\n  public visible = true;\n  public isOffscreen = false;\n  public readonly cellWidth: number;\n  public readonly cellHeight: number;\n  public readonly rows: number;\n  public readonly cols: number;\n\n  private _dirty = true;\n  public flagDirty() {\n    this._dirty = true;\n  }\n  private _transform: TransformComponent;\n  private _motion: MotionComponent;\n  private _collider: ColliderComponent;\n  private _composite: CompositeCollider;\n\n  public get x(): number {\n    return this._transform.pos.x ?? 0;\n  }\n\n  public set x(val: number) {\n    if (this._transform?.pos) {\n      this.get(TransformComponent).pos = vec(val, this.y);\n    }\n  }\n\n  public get y(): number {\n    return this._transform?.pos.y ?? 0;\n  }\n\n  public set y(val: number) {\n    if (this._transform?.pos) {\n      this._transform.pos = vec(this.x, val);\n    }\n  }\n\n  public get z(): number {\n    return this._transform.z ?? 0;\n  }\n\n  public set z(val: number) {\n    if (this._transform?.z) {\n      this._transform.z = val;\n    }\n  }\n\n  public get rotation(): number {\n    return this._transform?.rotation ?? 0;\n  }\n\n  public set rotation(val: number) {\n    if (this._transform?.rotation) {\n      this._transform.rotation = val;\n    }\n  }\n\n  public get scale(): Vector {\n    return this._transform?.scale ?? Vector.One;\n  }\n  public set scale(val: Vector) {\n    if (this._transform?.scale) {\n      this._transform.scale = val;\n    }\n  }\n\n  public get pos(): Vector {\n    return this._transform.pos;\n  }\n\n  public set pos(val: Vector) {\n    this._transform.pos = val;\n  }\n\n  public get vel(): Vector {\n    return this._motion.vel;\n  }\n\n  public set vel(val: Vector) {\n    this._motion.vel = val;\n  }\n\n  public on(eventName: Events.preupdate, handler: (event: Events.PreUpdateEvent<TileMap>) => void): void;\n  public on(eventName: Events.postupdate, handler: (event: Events.PostUpdateEvent<TileMap>) => void): void;\n  public on(eventName: Events.predraw, handler: (event: Events.PreDrawEvent) => void): void;\n  public on(eventName: Events.postdraw, handler: (event: Events.PostDrawEvent) => void): void;\n  public on(eventName: string, handler: (event: Events.GameEvent<any>) => void): void;\n  public on(eventName: string, handler: (event: any) => void): void {\n    super.on(eventName, handler);\n  }\n\n  /**\n   * @param xOrConfig     The x coordinate to anchor the TileMap's upper left corner (should not be changed once set) or TileMap option bag\n   * @param y             The y coordinate to anchor the TileMap's upper left corner (should not be changed once set)\n   * @param cellWidth     The individual width of each cell (in pixels) (should not be changed once set)\n   * @param cellHeight    The individual height of each cell (in pixels) (should not be changed once set)\n   * @param rows          The number of rows in the TileMap (should not be changed once set)\n   * @param cols          The number of cols in the TileMap (should not be changed once set)\n   */\n  constructor(xOrConfig: number | TileMapArgs, y: number, cellWidth: number, cellHeight: number, rows: number, cols: number) {\n    super();\n    if (xOrConfig && typeof xOrConfig === 'object') {\n      const config = xOrConfig;\n      xOrConfig = config.x;\n      y = config.y;\n      cellWidth = config.cellWidth;\n      cellHeight = config.cellHeight;\n      rows = config.rows;\n      cols = config.cols;\n    }\n    this.addComponent(new TransformComponent());\n    this.addComponent(new MotionComponent());\n    this.addComponent(\n      new BodyComponent({\n        type: CollisionType.Fixed\n      })\n    );\n    this.addComponent(new CanvasDrawComponent((ctx, delta) => this.draw(ctx, delta)));\n    this.addComponent(\n      new GraphicsComponent({\n        onPostDraw: (ctx, delta) => this.draw(ctx, delta)\n      })\n    );\n    this.addComponent(new ColliderComponent());\n    this._transform = this.get(TransformComponent);\n    this._motion = this.get(MotionComponent);\n    this._collider = this.get(ColliderComponent);\n    this._composite = this._collider.useCompositeCollider([]);\n\n    this.x = <number>xOrConfig;\n    this.y = y;\n    this.cellWidth = cellWidth;\n    this.cellHeight = cellHeight;\n    this.rows = rows;\n    this.cols = cols;\n    this.data = new Array<Cell>(rows * cols);\n    this._rows = new Array(rows);\n    this._cols = new Array(cols);\n    let currentCol: Cell[] = [];\n    for (let i = 0; i < cols; i++) {\n      for (let j = 0; j < rows; j++) {\n        const cd = new Cell(i * cellWidth + <number>xOrConfig, j * cellHeight + y, cellWidth, cellHeight, i + j * cols);\n        cd.map = this;\n        this.data[i + j * cols] = cd;\n        currentCol.push(cd);\n        if (!this._rows[j]) {\n          this._rows[j] = [];\n        }\n        this._rows[j].push(cd);\n      }\n      this._cols[i] = currentCol;\n      currentCol = [];\n    }\n\n    this.get(GraphicsComponent).localBounds = new BoundingBox({\n      left: 0,\n      top: 0,\n      right: this.cols * this.cellWidth,\n      bottom: this.rows * this.cellHeight\n    });\n  }\n\n  public _initialize(engine: Engine) {\n    super._initialize(engine);\n  }\n\n  /**\n   *\n   * @param key\n   * @param spriteSheet\n   * @deprecated No longer used, will be removed in v0.26.0\n   */\n  public registerSpriteSheet(key: string, spriteSheet: SpriteSheet): void;\n  public registerSpriteSheet(key: string, spriteSheet: Graphics.SpriteSheet): void;\n  @obsolete({ message: 'No longer used, will be removed in v0.26.0' })\n  public registerSpriteSheet(key: string, spriteSheet: SpriteSheet | Graphics.SpriteSheet): void {\n    if (spriteSheet instanceof Graphics.SpriteSheet) {\n      this._spriteSheets[key] = spriteSheet;\n    } else {\n      this._spriteSheets[key] = Graphics.SpriteSheet.fromLegacySpriteSheet(spriteSheet);\n    }\n  }\n\n  /**\n   * Tiles colliders based on the solid tiles in the tilemap.\n   */\n  private _updateColliders(): void {\n    this._composite.clearColliders();\n    const colliders: BoundingBox[] = [];\n    let current: BoundingBox;\n    // Bad square tessalation algo\n    for (let i = 0; i < this.cols; i++) {\n      // Scan column for colliders\n      for (let j = 0; j < this.rows; j++) {\n        // Columns start with a new collider\n        if (j === 0) {\n          current = null;\n        }\n        const tile = this.data[i + j * this.cols];\n        // Current tile in column is solid build up current collider\n        if (tile.solid) {\n          if (!current) {\n            current = tile.bounds;\n          } else {\n            current = current.combine(tile.bounds);\n          }\n        } else {\n          // Not solid skip and cut off the current collider\n          if (current) {\n            colliders.push(current);\n          }\n          current = null;\n        }\n      }\n      // After a column is complete check to see if it can be merged into the last one\n      if (current) {\n        // if previous is the same combine it\n        const prev = colliders[colliders.length - 1];\n        if (prev && prev.top === current.top && prev.bottom === current.bottom) {\n          colliders[colliders.length - 1] = prev.combine(current);\n        } else {\n          // else new collider\n          colliders.push(current);\n        }\n      }\n    }\n    this._composite = this._collider.useCompositeCollider([]);\n    for (const c of colliders) {\n      const collider = Shape.Box(c.width, c.height, Vector.Zero, vec(c.left - this.pos.x, c.top - this.pos.y));\n      collider.owner = this;\n      this._composite.addCollider(collider);\n    }\n    this._collider.update();\n  }\n\n  /**\n   * Returns the [[Cell]] by index (row major order)\n   */\n  public getCellByIndex(index: number): Cell {\n    return this.data[index];\n  }\n  /**\n   * Returns the [[Cell]] by its x and y coordinates\n   */\n  public getCell(x: number, y: number): Cell {\n    if (x < 0 || y < 0 || x >= this.cols || y >= this.rows) {\n      return null;\n    }\n    return this.data[x + y * this.cols];\n  }\n  /**\n   * Returns the [[Cell]] by testing a point in global coordinates,\n   * returns `null` if no cell was found.\n   */\n  public getCellByPoint(x: number, y: number): Cell {\n    x = Math.floor((x - this.pos.x) / this.cellWidth);\n    y = Math.floor((y - this.pos.y) / this.cellHeight);\n    const cell = this.getCell(x, y);\n    if (x >= 0 && y >= 0 && x < this.cols && y < this.rows && cell) {\n      return cell;\n    }\n    return null;\n  }\n\n  public getRows(): readonly Cell[][] {\n    return this._rows;\n  }\n\n  public getColumns(): readonly Cell[][] {\n    return this._cols;\n  }\n\n  public onPreUpdate(_engine: Engine, _delta: number) {\n    // Override me\n  }\n\n  public onPostUpdate(_engine: Engine, _delta: number) {\n    // Override me\n  }\n\n  public update(engine: Engine, delta: number) {\n    this.onPreUpdate(engine, delta);\n    this.emit('preupdate', new Events.PreUpdateEvent(engine, delta, this));\n    if (this._dirty) {\n      this._dirty = false;\n      this._updateColliders();\n    }\n\n    this._token++;\n    const worldBounds = engine.getWorldBounds();\n    const worldCoordsUpperLeft = vec(worldBounds.left, worldBounds.top);\n    const worldCoordsLowerRight = vec(worldBounds.right, worldBounds.bottom);\n\n    this._onScreenXStart = Math.max(Math.floor((worldCoordsUpperLeft.x - this.x) / this.cellWidth) - 2, 0);\n    this._onScreenYStart = Math.max(Math.floor((worldCoordsUpperLeft.y - this.y) / this.cellHeight) - 2, 0);\n    this._onScreenXEnd = Math.max(Math.floor((worldCoordsLowerRight.x - this.x) / this.cellWidth) + 2, 0);\n    this._onScreenYEnd = Math.max(Math.floor((worldCoordsLowerRight.y - this.y) / this.cellHeight) + 2, 0);\n    this._transform.pos = vec(this.x, this.y);\n\n    this.onPostUpdate(engine, delta);\n    this.emit('postupdate', new Events.PostUpdateEvent(engine, delta, this));\n  }\n\n  /**\n   * Draws the tile map to the screen. Called by the [[Scene]].\n   * @param ctx CanvasRenderingContext2D or ExcaliburGraphicsContext\n   * @param delta  The number of milliseconds since the last draw\n   */\n  public draw(ctx: CanvasRenderingContext2D | ExcaliburGraphicsContext, delta: number): void {\n    this.emit('predraw', new Events.PreDrawEvent(ctx as any, delta, this)); // TODO fix event\n\n    let x = this._onScreenXStart;\n    const xEnd = Math.min(this._onScreenXEnd, this.cols);\n    let y = this._onScreenYStart;\n    const yEnd = Math.min(this._onScreenYEnd, this.rows);\n\n    let graphics: Graphics.Graphic[], graphicsIndex: number, graphicsLen: number;\n\n    for (x; x < xEnd; x++) {\n      for (y; y < yEnd; y++) {\n        // get non-negative tile sprites\n        graphics = this.getCell(x, y).graphics;\n\n        for (graphicsIndex = 0, graphicsLen = graphics.length; graphicsIndex < graphicsLen; graphicsIndex++) {\n          // draw sprite, warning if sprite doesn't exist\n          const graphic = graphics[graphicsIndex];\n          if (graphic) {\n            if (!(ctx instanceof CanvasRenderingContext2D)) {\n              if (hasGraphicsTick(graphic)) {\n                graphic?.tick(delta, this._token);\n              }\n              graphic.draw(ctx, x * this.cellWidth, y * this.cellHeight);\n            } else if (graphic instanceof Graphics.Sprite) {\n              // TODO legacy drawing mode\n              if (!this._legacySpriteMap.has(graphic)) {\n                this._legacySpriteMap.set(graphic, Graphics.Sprite.toLegacySprite(graphic));\n              }\n              this._legacySpriteMap.get(graphic).draw(ctx, x * this.cellWidth, y * this.cellHeight);\n            }\n          }\n        }\n      }\n      y = this._onScreenYStart;\n    }\n\n    this.emit('postdraw', new Events.PostDrawEvent(ctx as any, delta, this));\n  }\n}\n\nexport interface TileMapArgs extends Partial<TileMapImpl> {\n  x: number;\n  y: number;\n  cellWidth: number;\n  cellHeight: number;\n  rows: number;\n  cols: number;\n}\n\n/**\n * The [[TileMap]] class provides a lightweight way to do large complex scenes with collision\n * without the overhead of actors.\n */\nexport class TileMap extends Configurable(TileMapImpl) {\n  constructor(config: TileMapArgs);\n  constructor(x: number, y: number, cellWidth: number, cellHeight: number, rows: number, cols: number);\n  constructor(xOrConfig: number | TileMapArgs, y?: number, cellWidth?: number, cellHeight?: number, rows?: number, cols?: number) {\n    super(xOrConfig, y, cellWidth, cellHeight, rows, cols);\n  }\n}\n\n/**\n * @hidden\n */\nexport class CellImpl extends Entity {\n  private _bounds: BoundingBox;\n  /**\n   * World space x coordinate of the left of the cell\n   */\n  public readonly x: number;\n  /**\n   * World space y coordinate of the top of the cell\n   */\n  public readonly y: number;\n  /**\n   * Width of the cell in pixels\n   */\n  public readonly width: number;\n  /**\n   * Height of the cell in pixels\n   */\n  public readonly height: number;\n  /**\n   * Current index in the tilemap\n   */\n  public readonly index: number;\n\n  /**\n   * Reference to the TileMap this Cell is associated with\n   */\n  public map: TileMap;\n\n  private _solid = false;\n  /**\n   * Wether this cell should be treated as solid by the tilemap\n   */\n  public get solid(): boolean {\n    return this._solid;\n  }\n  /**\n   * Wether this cell should be treated as solid by the tilemap\n   */\n  public set solid(val: boolean) {\n    this.map?.flagDirty();\n    this._solid = val;\n  }\n  /**\n   * Current list of graphics for this cell\n   */\n  public readonly graphics: Graphics.Graphic[] = [];\n  /**\n   * Abitrary data storage per cell, useful for any game specific data\n   */\n  public data = new Map<string, any>();\n\n  /**\n   * @param xOrConfig Gets or sets x coordinate of the cell in world coordinates or cell option bag\n   * @param y       Gets or sets y coordinate of the cell in world coordinates\n   * @param width   Gets or sets the width of the cell\n   * @param height  Gets or sets the height of the cell\n   * @param index   The index of the cell in row major order\n   * @param solid   Gets or sets whether this cell is solid\n   * @param graphics The list of tile graphics to use to draw in this cell (in order)\n   */\n  constructor(\n    xOrConfig: number | CellArgs,\n    y: number,\n    width: number,\n    height: number,\n    index: number,\n    solid: boolean = false,\n    graphics: Graphics.Graphic[] = []\n  ) {\n    super();\n    if (xOrConfig && typeof xOrConfig === 'object') {\n      const config = xOrConfig;\n      xOrConfig = config.x;\n      y = config.y;\n      width = config.width;\n      height = config.height;\n      index = config.index;\n      solid = config.solid;\n      graphics = config.sprites;\n    }\n    this.x = <number>xOrConfig;\n    this.y = y;\n    this.width = width;\n    this.height = height;\n    this.index = index;\n    this.solid = solid;\n    this.graphics = graphics;\n    this._bounds = new BoundingBox(this.x, this.y, this.x + this.width, this.y + this.height);\n  }\n\n  public get bounds() {\n    return this._bounds;\n  }\n\n  public get center(): Vector {\n    return new Vector(this.x + this.width / 2, this.y + this.height / 2);\n  }\n\n  /**\n   * Add another [[Sprite]] to this cell\n   * @deprecated Use addSprite, will be removed in v0.26.0\n   */\n  @obsolete({ message: 'Will be removed in v0.26.0', alternateMethod: 'addSprite' })\n  public pushSprite(sprite: Graphics.Sprite | LegacySprite) {\n    this.addGraphic(sprite);\n  }\n\n  /**\n   * Add another [[Graphic]] to this TileMap cell\n   * @param graphic\n   */\n  public addGraphic(graphic: Graphics.Graphic | LegacySprite) {\n    if (graphic instanceof LegacySprite) {\n      this.graphics.push(Graphics.Sprite.fromLegacySprite(graphic));\n    } else {\n      this.graphics.push(graphic);\n    }\n  }\n\n  /**\n   * Remove an instance of a [[Graphic]] from this cell\n   */\n  public removeGraphic(graphic: Graphics.Graphic | LegacySprite) {\n    removeItemFromArray(graphic, this.graphics);\n  }\n\n  /**\n   * Clear all graphis from this cell\n   */\n  public clearGraphics() {\n    this.graphics.length = 0;\n  }\n}\n\nexport interface CellArgs extends Partial<CellImpl> {\n  x: number;\n  y: number;\n  width: number;\n  height: number;\n  index: number;\n  solid?: boolean;\n  sprites?: Graphics.Sprite[];\n}\n\n/**\n * TileMap Cell\n *\n * A light-weight object that occupies a space in a collision map. Generally\n * created by a [[TileMap]].\n *\n * Cells can draw multiple sprites. Note that the order of drawing is the order\n * of the sprites in the array so the last one will be drawn on top. You can\n * use transparency to create layers this way.\n */\nexport class Cell extends Configurable(CellImpl) {\n  constructor(config: CellArgs);\n  constructor(x: number, y: number, width: number, height: number, index: number, solid?: boolean, sprites?: Graphics.Sprite[]);\n  constructor(\n    xOrConfig: number | CellArgs,\n    y?: number,\n    width?: number,\n    height?: number,\n    index?: number,\n    solid?: boolean,\n    sprites?: Graphics.Sprite[]\n  ) {\n    super(xOrConfig, y, width, height, index, solid, sprites);\n  }\n}\n","import { Actor } from '../Actor';\nimport { ScreenElement } from '../ScreenElement';\nimport { Label } from '../Label';\nimport { Trigger } from '../Trigger';\n\n/**\n * Type guard to detect if something is an actor\n * @deprecated Will be removed in v0.26.0\n * @param actor\n */\nexport function isVanillaActor(actor: Actor) {\n  return !(actor instanceof ScreenElement) && !(actor instanceof Trigger) && !(actor instanceof Label);\n}\n\n/**\n * Type guard to detect a screen element\n * @todo move to ScreenElement\n */\nexport function isScreenElement(actor: Actor) {\n  return actor instanceof ScreenElement;\n}\n","import { Color } from './Color';\nimport { Engine } from './Engine';\nimport { EventDispatcher } from './EventDispatcher';\nimport { Vector } from './Math/vector';\nimport { ExitTriggerEvent, EnterTriggerEvent, CollisionEndEvent, CollisionStartEvent } from './Events';\nimport * as Util from './Util/Util';\nimport { CollisionType } from './Collision/CollisionType';\nimport { Entity } from './EntityComponentSystem';\nimport { Actor } from './Actor';\n\n/**\n * ITriggerOptions\n */\nexport interface TriggerOptions {\n  // position of the trigger\n  pos: Vector;\n  // width of the trigger\n  width: number;\n  // height of the trigger\n  height: number;\n  // whether the trigger is visible or not\n  visible: boolean;\n  // action to take when triggered\n  action: () => void;\n  // if specified the trigger will only fire on a specific actor and overrides any filter\n  target: Entity;\n  // Returns true if the triggers should fire on the collided actor\n  filter: (actor: Entity) => boolean;\n  // -1 if it should repeat forever\n  repeat: number;\n}\n\nconst triggerDefaults: Partial<TriggerOptions> = {\n  pos: Vector.Zero,\n  width: 10,\n  height: 10,\n  visible: false,\n  action: () => {\n    return;\n  },\n  filter: () => true,\n  repeat: -1\n};\n\n/**\n * Triggers are a method of firing arbitrary code on collision. These are useful\n * as 'buttons', 'switches', or to trigger effects in a game. By default triggers\n * are invisible, and can only be seen when [[Trigger.visible]] is set to `true`.\n */\nexport class Trigger extends Actor {\n  private _target: Entity;\n  /**\n   * Action to fire when triggered by collision\n   */\n  public action: () => void = () => {\n    return;\n  };\n  /**\n   * Filter to add additional granularity to action dispatch, if a filter is specified the action will only fire when\n   * filter return true for the collided actor.\n   */\n  public filter: (actor: Entity) => boolean = () => true;\n  /**\n   * Number of times to repeat before killing the trigger,\n   */\n  public repeat: number = -1;\n\n  /**\n   *\n   * @param opts Trigger options\n   */\n  constructor(opts: Partial<TriggerOptions>) {\n    super({ x: opts.pos.x, y: opts.pos.y, width: opts.width, height: opts.height });\n    opts = Util.extend({}, triggerDefaults, opts);\n\n    this.filter = opts.filter || this.filter;\n    this.repeat = opts.repeat || this.repeat;\n    this.action = opts.action || this.action;\n    if (opts.target) {\n      this.target = opts.target;\n    }\n\n    this.visible = opts.visible;\n    this.body.collisionType = CollisionType.Passive;\n    this.eventDispatcher = new EventDispatcher(this);\n\n    this.events.on('collisionstart', (evt: CollisionStartEvent<Actor>) => {\n      if (this.filter(evt.other)) {\n        this.emit('enter', new EnterTriggerEvent(this, evt.other));\n        this._dispatchAction();\n        // remove trigger if its done, -1 repeat forever\n        if (this.repeat === 0) {\n          this.kill();\n        }\n      }\n    });\n\n    this.events.on('collisionend', (evt: CollisionEndEvent<Actor>) => {\n      if (this.filter(evt.other)) {\n        this.emit('exit', new ExitTriggerEvent(this, evt.other));\n      }\n    });\n  }\n\n  public set target(target: Entity) {\n    this._target = target;\n    this.filter = (actor: Entity) => actor === target;\n  }\n\n  public get target() {\n    return this._target;\n  }\n\n  public _initialize(engine: Engine) {\n    super._initialize(engine);\n  }\n\n  private _dispatchAction() {\n    if (this.repeat !== 0) {\n      this.action.call(this);\n      this.repeat--;\n    }\n  }\n\n  /* istanbul ignore next */\n  public debugDraw(ctx: CanvasRenderingContext2D) {\n    super.debugDraw(ctx);\n    // Meant to draw debug information about actors\n    ctx.save();\n    ctx.translate(this.pos.x, this.pos.y);\n\n    const bb = this.collider.bounds;\n    const wp = this.getGlobalPos();\n    bb.left = bb.left - wp.x;\n    bb.right = bb.right - wp.x;\n    bb.top = bb.top - wp.y;\n    bb.bottom = bb.bottom - wp.y;\n\n    ctx.fillStyle = Color.Violet.toString();\n    ctx.strokeStyle = Color.Violet.toString();\n    ctx.fillText('Trigger', 10, 10);\n    bb.debugDraw(ctx);\n\n    ctx.restore();\n  }\n}\n","import { Entity } from './Entity';\nimport { Message, Observer } from '../Util/Observable';\nimport { Component } from './Component';\nimport { Scene } from '../Scene';\n\n/**\n * Enum that determines whether to run the system in the update or draw phase\n */\nexport enum SystemType {\n  Update = 'update',\n  Draw = 'draw'\n}\n\nexport type SystemTypes<ComponentTypes> = ComponentTypes extends Component<infer TypeName> ? TypeName : never;\n\n/**\n * An Excalibur [[System]] that updates entities of certain types.\n * Systems are scene specific\n *\n * Excalibur Systems currently require at least 1 Component type to operated\n *\n * Multiple types are declared as a type union\n * For example:\n *\n * ```typescript\n * class MySystem extends System<ComponentA | ComponentB> {\n *   public readonly types = ['a', 'b'] as const;\n *   public readonly systemType = SystemType.Update;\n *   public update(entities: Entity<ComponentA | ComponentB>) {\n *      ...\n *   }\n * }\n * ```\n */\nexport abstract class System<ComponentTypeUnion extends Component = Component, ContextType = Scene>\nimplements Observer<AddedEntity | RemovedEntity> {\n  /**\n   * The types of entities that this system operates on\n   * For example ['transform', 'motion']\n   */\n  abstract readonly types: readonly SystemTypes<ComponentTypeUnion>[];\n\n  /**\n   * Determine whether the system is called in the [[SystemType.Update]] or the [[SystemType.Draw]] phase. Update is first, then Draw.\n   */\n  abstract readonly systemType: SystemType;\n\n  /**\n   * System can execute in priority order, by default all systems are priority 0. Lower values indicated higher priority.\n   * For a system to execute before all other a lower priority value (-1 for example) must be set.\n   * For a system to exectue after all other a higher priority value (10 for example) must be set.\n   */\n  public priority: number = 0;\n\n  /**\n   * Optionally specify a sort order for entities passed to the your system\n   * @param a The left entity\n   * @param b The right entity\n   */\n  sort?(a: Entity, b: Entity): number;\n\n  /**\n   * Optionally specify an initialize handler\n   * @param scene\n   */\n  initialize?(engine: ContextType): void;\n\n  /**\n   * Update all entities that match this system's types\n   * @param entities Entities to update that match this system's types\n   * @param delta Time in milliseconds\n   */\n  abstract update(entities: Entity[], delta: number): void;\n\n  /**\n   * Optionally run a preupdate before the system processes matching entities\n   * @param engine\n   * @param elapsedMs Time in milliseconds since the last frame\n   */\n  preupdate?(engine: ContextType, elapsedMs: number): void;\n\n  /**\n   * Optionally run a postupdate after the system processes matching entities\n   * @param engine\n   * @param elapsedMs Time in milliseconds since the last frame\n   */\n  postupdate?(engine: ContextType, elapsedMs: number): void;\n\n  /**\n   * Systems observe when entities match their types or no longer match their types, override\n   * @param _entityAddedOrRemoved\n   */\n  public notify(_entityAddedOrRemoved: AddedEntity | RemovedEntity) {\n    // Override me\n  }\n}\n\n/**\n * An [[Entity]] with [[Component]] types that matches a [[System]] types exists in the current scene.\n */\nexport class AddedEntity implements Message<Entity> {\n  readonly type: 'Entity Added' = 'Entity Added';\n  constructor(public data: Entity) {}\n}\n\n/**\n * Type guard to check for AddedEntity messages\n * @param x\n */\nexport function isAddedSystemEntity(x: Message<Entity>): x is AddedEntity {\n  return !!x && x.type === 'Entity Added';\n}\n\n/**\n * An [[Entity]] with [[Component]] types that no longer matches a [[System]] types exists in the current scene.\n */\nexport class RemovedEntity implements Message<Entity> {\n  readonly type: 'Entity Removed' = 'Entity Removed';\n  constructor(public data: Entity) {}\n}\n\n/**\n * type guard to check for the RemovedEntity message\n */\nexport function isRemoveSystemEntity(x: Message<Entity>): x is RemovedEntity {\n  return !!x && x.type === 'Entity Removed';\n}\n","import { Entity, RemovedComponent, AddedComponent, isAddedComponent, isRemovedComponent } from './Entity';\nimport { Observer } from '../Util/Observable';\nimport { World } from './World';\nimport { Util } from '..';\n\n// Add/Remove entitys and components\n\nexport class EntityManager<ContextType = any> implements Observer<RemovedComponent | AddedComponent> {\n  public entities: Entity[] = [];\n  public _entityIndex: { [entityId: string]: Entity } = {};\n\n  constructor(private _world: World<ContextType>) {}\n\n  /**\n   * Runs the entity lifecycle\n   * @param _context\n   */\n  public updateEntities(_context: ContextType, elapsed: number) {\n    for (const entity of this.entities) {\n      // TODO is this right?\n      entity.update((_context as any).engine, elapsed);\n      if (!entity.active) {\n        this.removeEntity(entity);\n      }\n    }\n  }\n\n  /**\n   * EntityManager observes changes on entities\n   * @param message\n   */\n  public notify(message: RemovedComponent | AddedComponent): void {\n    if (isAddedComponent(message)) {\n      // we don't need the component, it's already on the entity\n      this._world.queryManager.addEntity(message.data.entity);\n    }\n\n    if (isRemovedComponent(message)) {\n      this._world.queryManager.removeComponent(message.data.entity, message.data.component);\n    }\n  }\n\n  /**\n   * Adds an entity to be tracked by the EntityManager\n   * @param entity\n   */\n  public addEntity(entity: Entity): void {\n    entity.active = true;\n    if (entity && !this._entityIndex[entity.id]) {\n      this._entityIndex[entity.id] = entity;\n      this.entities.push(entity);\n      this._world.queryManager.addEntity(entity);\n      entity.componentAdded$.register(this);\n      entity.componentRemoved$.register(this);\n\n      // if entity has children\n      entity.children.forEach((c) => this.addEntity(c));\n      entity.childrenAdded$.register({\n        notify: (e) => {\n          this.addEntity(e);\n        }\n      });\n      entity.childrenRemoved$.register({\n        notify: (e) => {\n          this.removeEntity(e, false);\n        }\n      });\n    }\n  }\n\n  public removeEntity(entity: Entity, deferred?: boolean): void;\n  public removeEntity(id: number, deferred?: boolean): void;\n  public removeEntity(idOrEntity: number | Entity, deferred = true): void {\n    let id = 0;\n    if (idOrEntity instanceof Entity) {\n      id = idOrEntity.id;\n    } else {\n      id = idOrEntity;\n    }\n    const entity = this._entityIndex[id];\n    if (entity && entity.active) {\n      entity.kill();\n    }\n\n    if (entity && deferred) {\n      this._entitiesToRemove.push(entity);\n      return;\n    }\n\n    delete this._entityIndex[id];\n    if (entity) {\n      Util.removeItemFromArray(entity, this.entities);\n      this._world.queryManager.removeEntity(entity);\n      entity.componentAdded$.unregister(this);\n      entity.componentRemoved$.unregister(this);\n\n      // if entity has children\n      entity.children.forEach((c) => this.removeEntity(c, deferred));\n      entity.childrenAdded$.clear();\n      entity.childrenRemoved$.clear();\n\n      // stats\n      if ((this._world.context as any)?.engine) {\n        (this._world.context as any).engine.stats.currFrame.actors.killed++;\n      }\n    }\n  }\n\n  private _entitiesToRemove: Entity[] = [];\n  public processEntityRemovals(): void {\n    for (const entity of this._entitiesToRemove) {\n      if (entity.active) {\n        continue;\n      }\n      this.removeEntity(entity, false);\n    }\n  }\n\n  public processComponentRemovals(): void {\n    for (const entity of this.entities) {\n      entity.processComponentRemoval();\n    }\n  }\n\n  public getById(id: number): Entity {\n    return this._entityIndex[id];\n  }\n\n  public getByName(name: string): Entity[]{\n    return this.entities.filter(e => e.name === name);\n  }\n\n  public clear(): void {\n    for (const entity of this.entities) {\n      this.removeEntity(entity);\n    }\n  }\n}\n","export const buildTypeKey = (types: readonly string[]) => {\n  const key = [...types].sort((a, b) => a.localeCompare(b)).join('+');\n  return key;\n};\n","import { Entity } from './Entity';\nimport { buildTypeKey } from './Util';\nimport { Observable } from '../Util/Observable';\nimport { Util, Component, ComponentCtor } from '..';\nimport { AddedEntity, RemovedEntity } from './System';\n\n/**\n * Represents query for entities that match a list of types that is cached and observable\n *\n * Queries can be strongly typed by supplying a type union in the optional type parameter\n * ```typescript\n * const queryAB = new ex.Query<ComponentTypeA | ComponentTypeB>(['A', 'B']);\n * ```\n */\nexport class Query<T extends Component = Component> extends Observable<AddedEntity | RemovedEntity> {\n  public types: readonly string[];\n  private _entities: Entity[] = [];\n  private _key: string;\n  public get key(): string {\n    if (this._key) {\n      return this._key;\n    }\n    return (this._key = buildTypeKey(this.types));\n  }\n\n  constructor(types: readonly string[]);\n  constructor(types: readonly ComponentCtor<T>[]);\n  constructor(types: readonly string[] | readonly ComponentCtor<T>[]) {\n    super();\n    if (types[0] instanceof Function) {\n      this.types = (types as ComponentCtor<T>[]).map(T =>  (new T).type);\n    } else {\n      this.types = types as string[];\n    }\n  }\n\n  /**\n   * Returns a list of entities that match the query\n   *\n   * @param sort Optional sorting function to sort entities returned from the query\n   */\n  public getEntities(sort?: (a: Entity, b: Entity) => number): Entity[] {\n    if (sort) {\n      this._entities.sort(sort);\n    }\n    return this._entities;\n  }\n\n  /**\n   * Add an entity to the query, will only be added if the entity matches the query types\n   * @param entity\n   */\n  public addEntity(entity: Entity): void {\n    if (!Util.contains(this._entities, entity) && this.matches(entity)) {\n      this._entities.push(entity);\n      this.notifyAll(new AddedEntity(entity));\n    }\n  }\n\n  /**\n   * If the entity is part of the query it will be removed regardless of types\n   * @param entity\n   */\n  public removeEntity(entity: Entity): void {\n    if (Util.removeItemFromArray(entity, this._entities)) {\n      this.notifyAll(new RemovedEntity(entity));\n    }\n  }\n\n  /**\n   * Removes all entities and observers from the query\n   */\n  public clear(): void {\n    this._entities.length = 0;\n    for (const observer of this.observers) {\n      this.unregister(observer);\n    }\n  }\n\n  /**\n   * Returns whether the entity's types match query\n   * @param entity\n   */\n  public matches(entity: Entity): boolean;\n\n  /**\n   * Returns whether the list of ComponentTypes have at least the same types as the query\n   * @param types\n   */\n  public matches(types: string[]): boolean;\n  public matches(typesOrEntity: string[] | Entity): boolean {\n    let types: string[] = [];\n    if (typesOrEntity instanceof Entity) {\n      types = typesOrEntity.types;\n    } else {\n      types = typesOrEntity;\n    }\n\n    let matches = true;\n    for (const type of this.types) {\n      matches = matches && types.indexOf(type) > -1;\n      if (!matches) {\n        return false;\n      }\n    }\n    return matches;\n  }\n\n  public contain(type: string) {\n    return this.types.indexOf(type) > -1;\n  }\n}\n","import { Entity } from './Entity';\nimport { buildTypeKey } from './Util';\nimport { Query } from './Query';\nimport { Component } from './Component';\nimport { World } from './World';\n\n/**\n * The query manager is responsible for updating all queries when entities/components change\n */\nexport class QueryManager {\n  private _queries: { [entityComponentKey: string]: Query<any> } = {};\n\n  constructor(private _world: World<any>) {}\n\n  /**\n   * Adds a query to the manager and populates with any entities that match\n   * @param query\n   */\n  private _addQuery(query: Query<any>) {\n    this._queries[buildTypeKey(query.types)] = query;\n    for (const entity of this._world.entityManager.entities) {\n      query.addEntity(entity);\n    }\n  }\n\n  /**\n   * Removes the query if there are no observers left\n   * @param query\n   */\n  public maybeRemoveQuery(query: Query): void {\n    if (query.observers.length === 0) {\n      query.clear();\n      delete this._queries[buildTypeKey(query.types)];\n    }\n  }\n\n  /**\n   * Adds the entity to any matching query in the query manage\n   * @param entity\n   */\n  public addEntity(entity: Entity) {\n    for (const queryType in this._queries) {\n      if (this._queries[queryType]) {\n        this._queries[queryType].addEntity(entity);\n      }\n    }\n  }\n\n  /**\n   * Removes an entity from queries if the removed component disqualifies it\n   * @param entity\n   * @param component\n   */\n  public removeComponent(entity: Entity, component: Component) {\n    for (const queryType in this._queries) {\n      // If the component being removed from an entity is a part of a query,\n      // it is now disqualified from that query, remove it\n      if (this._queries[queryType].contain(component.type)) {\n        this._queries[queryType].removeEntity(entity);\n      }\n    }\n  }\n\n  /**\n   * Removes an entity from all queries it is currently a part of\n   * @param entity\n   */\n  public removeEntity(entity: Entity) {\n    for (const queryType in this._queries) {\n      this._queries[queryType].removeEntity(entity);\n    }\n  }\n\n  /**\n   * Creates a populated query and returns, if the query already exists that will be returned instead of a new instance\n   * @param types\n   */\n  public createQuery<T extends Component = Component>(types: readonly string[]): Query<T> {\n    const maybeExistingQuery = this.getQuery<T>(types);\n    if (maybeExistingQuery) {\n      return maybeExistingQuery;\n    }\n    const query = new Query<T>(types);\n    this._addQuery(query);\n    return query;\n  }\n\n  /**\n   * Retrieves an existing query by types if it exists otherwise returns null\n   * @param types\n   */\n  public getQuery<T extends Component = Component>(types: readonly string[]): Query<T> {\n    const key = buildTypeKey(types);\n    if (this._queries[key]) {\n      return this._queries[key] as Query<T>;\n    }\n    return null;\n  }\n}\n","import { System, SystemType } from './System';\nimport { Scene, Util } from '..';\nimport { World } from './World';\n\nexport interface SystemCtor<T extends System> {\n  new (): T;\n}\n\n/**\n * The SystemManager is responsible for keeping track of all systems in a scene.\n * Systems are scene specific\n */\nexport class SystemManager<ContextType> {\n  /**\n   * List of systems, to add a new system call [[SystemManager.addSystem]]\n   */\n  public systems: System<any, ContextType>[] = [];\n  public _keyToSystem: { [key: string]: System<any, ContextType> };\n  public initialized = false;\n  constructor(private _world: World<ContextType>) {}\n\n  /**\n   * Get a system registered in the manager by type\n   * @param systemType\n   * @returns\n   */\n  public get<T extends System>(systemType: SystemCtor<T>): T | null {\n    return this.systems.find((s) => s instanceof systemType) as unknown as T;\n  }\n\n  /**\n   * Adds a system to the manager, it will now be updated every frame\n   * @param system\n   */\n  public addSystem(system: System<any, ContextType>): void {\n    // validate system has types\n    if (!system.types || system.types.length === 0) {\n      throw new Error(`Attempted to add a System without any types`);\n    }\n\n    const query = this._world.queryManager.createQuery(system.types);\n    this.systems.push(system);\n    this.systems.sort((a, b) => a.priority - b.priority);\n    query.register(system);\n    if (this.initialized && system.initialize) {\n      system.initialize(this._world.context);\n    }\n  }\n\n  /**\n   * Removes a system from the manager, it will no longer be updated\n   * @param system\n   */\n  public removeSystem(system: System<any, ContextType>) {\n    Util.removeItemFromArray(system, this.systems);\n    const query = this._world.queryManager.getQuery(system.types);\n    if (query) {\n      query.unregister(system);\n      this._world.queryManager.maybeRemoveQuery(query);\n    }\n  }\n\n  /**\n   * Updates all systems\n   * @param type whether this is an update or draw system\n   * @param context context reference\n   * @param delta time in milliseconds\n   */\n  public updateSystems(type: SystemType, context: ContextType, delta: number) {\n    if (!this.initialized) {\n      this.initialized = true;\n      for (const s of this.systems) {\n        if (s.initialize) {\n          s.initialize(this._world.context);\n        }\n      }\n    }\n\n    const systems = this.systems.filter((s) => s.systemType === type);\n    for (const s of systems) {\n      if (s.preupdate) {\n        s.preupdate(context, delta);\n      }\n    }\n\n    for (const s of systems) {\n      // Get entities that match the system types, pre-sort\n      const entities = this._world.queryManager.getQuery(s.types).getEntities(s.sort);\n      // Initialize entities if needed\n      if (context instanceof Scene) {\n        for (const entity of entities) {\n          entity._initialize(context?.engine);\n        }\n      }\n      s.update(entities, delta);\n    }\n\n    for (const s of systems) {\n      if (s.postupdate) {\n        s.postupdate(context, delta);\n      }\n    }\n  }\n\n  public clear(): void {\n    for (const system of this.systems) {\n      this.removeSystem(system);\n    }\n  }\n}\n","import { Entity } from './Entity';\nimport { EntityManager } from './EntityManager';\nimport { QueryManager } from './QueryManager';\nimport { System, SystemType } from './System';\nimport { SystemManager } from './SystemManager';\n\n/**\n * The World is a self-contained entity component system for a particular context.\n */\nexport class World<ContextType> {\n  public queryManager: QueryManager = new QueryManager(this);\n  public entityManager: EntityManager<ContextType> = new EntityManager<ContextType>(this);\n  public systemManager: SystemManager<ContextType> = new SystemManager<ContextType>(this);\n\n  /**\n   * The context type is passed to the system updates\n   * @param context\n   */\n  constructor(public context: ContextType) {}\n\n  /**\n   * Update systems by type and time elapsed in milliseconds\n   */\n  update(type: SystemType, delta: number) {\n    if (type === SystemType.Update) {\n      // TODO should this also hand pre and post lifecycle\n      this.entityManager.updateEntities(this.context, delta);\n    }\n    this.systemManager.updateSystems(type, this.context, delta);\n    this.entityManager.processComponentRemovals();\n    this.entityManager.processEntityRemovals();\n  }\n\n  /**\n   * Add an entity to the ECS world\n   * @param entity\n   */\n  add(entity: Entity): void;\n  /**\n   * Add a system to the ECS world\n   * @param system\n   */\n  add(system: System<any, ContextType>): void;\n  add(entityOrSystem: Entity | System<any, ContextType>): void {\n    if (entityOrSystem instanceof Entity) {\n      this.entityManager.addEntity(entityOrSystem);\n    }\n\n    if (entityOrSystem instanceof System) {\n      this.systemManager.addSystem(entityOrSystem);\n    }\n  }\n\n  /**\n   * Remove an entity from the ECS world\n   * @param entity\n   */\n  remove(entity: Entity, deferred?: boolean): void;\n  /**\n   * Remove a system from the ECS world\n   * @param system\n   */\n  remove(system: System<any, ContextType>): void;\n  remove(entityOrSystem: Entity | System<any, ContextType>, deferred = true): void {\n    if (entityOrSystem instanceof Entity) {\n      this.entityManager.removeEntity(entityOrSystem, deferred);\n    }\n\n    if (entityOrSystem instanceof System) {\n      this.systemManager.removeSystem(entityOrSystem);\n    }\n  }\n\n  clearEntities(): void {\n    this.entityManager.clear();\n  }\n\n  clearSystems(): void {\n    this.systemManager.clear();\n  }\n}\n","import { Vector } from '../Math/vector';\nimport { TransformComponent } from '../EntityComponentSystem';\nimport { MotionComponent } from '../EntityComponentSystem/Components/MotionComponent';\n\nexport class EulerIntegrator {\n  static integrate(transform: TransformComponent, motion: MotionComponent, totalAcc: Vector, elapsedMs: number): void {\n    const seconds = elapsedMs / 1000;\n    motion.vel.addEqual(totalAcc.scale(seconds));\n    transform.pos.addEqual(motion.vel.scale(seconds)).addEqual(totalAcc.scale(0.5 * seconds * seconds));\n\n    motion.angularVelocity += motion.torque * (1.0 / motion.inertia) * seconds;\n    transform.rotation += motion.angularVelocity * seconds;\n\n    transform.scale.addEqual(motion.scaleFactor.scale(seconds));\n  }\n}\n","import { Entity } from '../EntityComponentSystem';\nimport { MotionComponent } from '../EntityComponentSystem/Components/MotionComponent';\nimport { TransformComponent } from '../EntityComponentSystem/Components/TransformComponent';\nimport { System, SystemType } from '../EntityComponentSystem/System';\nimport { Physics } from './Physics';\nimport { BodyComponent } from './BodyComponent';\nimport { CollisionType } from './CollisionType';\nimport { EulerIntegrator } from './Integrator';\n\nexport class MotionSystem extends System<TransformComponent | MotionComponent> {\n  public readonly types = ['ex.transform', 'ex.motion'] as const;\n  public systemType = SystemType.Update;\n  public priority = -1;\n\n  update(_entities: Entity[], elapsedMs: number): void {\n    let transform: TransformComponent;\n    let motion: MotionComponent;\n    for (const entity of _entities) {\n      transform = entity.get(TransformComponent);\n      motion = entity.get(MotionComponent);\n\n      const optionalBody = entity.get(BodyComponent);\n      if (optionalBody?.sleeping) {\n        continue;\n      }\n\n      const totalAcc = motion.acc.clone();\n      if (optionalBody?.collisionType === CollisionType.Active && optionalBody?.useGravity) {\n        totalAcc.addEqual(Physics.gravity);\n      }\n      optionalBody?.captureOldTransform();\n\n      // Update transform and motion based on Euler linear algebra\n      EulerIntegrator.integrate(transform, motion, totalAcc, elapsedMs);\n    }\n  }\n\n  debugDraw(_ctx: CanvasRenderingContext2D) {\n    // pass\n  }\n}\n","import { CollisionContact } from '../Detection/CollisionContact';\n\n/**\n * A collision solver figures out how to position colliders such that they are no longer overlapping\n *\n * Solvers are executed in the order\n *\n * 1. preSolve\n * 2. solveVelocity\n * 3. solvePosition\n * 4. postSolve\n * @inheritdoc\n */\nexport abstract class CollisionSolver {\n  /**\n   * Pre-solve is fired on contacts before any resolution is started. It is used for any setup work before collision resolution\n   * can proceed. Optionally contacts can be \"opted out\" of any collision processing by calling `contact.cancel()`\n   * @param contacts\n   * @inheritdoc\n   */\n  abstract preSolve(contacts: CollisionContact[]): void;\n\n  /**\n   * Post-solve is fired after all resolution is complete\n   * @param contacts\n   * @inheritdoc\n   */\n  abstract postSolve(contacts: CollisionContact[]): void;\n\n  /**\n   * Solve velocity adjusts the velocity of colliders so that they are not overlapping or will not be overlapping from velocity\n   * @param contacts\n   * @inheritdoc\n   */\n  abstract solveVelocity(contacts: CollisionContact[]): void;\n\n  /**\n   * Solve position adjust the position of collders so that they are not overlapping\n   * @param contacts\n   * @inheritdoc\n   */\n  abstract solvePosition(contacts: CollisionContact[]): void;\n\n  /**\n   * Solves overlapping contact in\n   *\n   * Solvers are executed in the order\n   * 1. preSolve\n   * 2. solveVelocity\n   * 3. solvePosition\n   * 4. postSolve\n   * @param contacts\n   */\n  public solve(contacts: CollisionContact[]): CollisionContact[] {\n    // Events and init\n    this.preSolve(contacts);\n\n    // Remove any canceled contacts\n    contacts = contacts.filter(c => !c.isCanceled());\n\n    // Solve velocity first\n    this.solveVelocity(contacts);\n\n    // Solve position last because non-overlap is the most important\n    this.solvePosition(contacts);\n\n    // Events and any contact house-keeping the solver needs\n    this.postSolve(contacts);\n\n    return contacts;\n  }\n}","import { PostCollisionEvent, PreCollisionEvent } from '../../Events';\nimport { CollisionContact } from '../Detection/CollisionContact';\nimport { CollisionType } from '../CollisionType';\nimport { Side } from '../Side';\nimport { CollisionSolver } from './Solver';\nimport { BodyComponent } from '../BodyComponent';\n\n/**\n * ArcadeSolver is the default in Excalibur. It solves collisions so that there is no overlap between contacts,\n * and negates velocity along the collision normal.\n *\n * This is usually the type of collisions used for 2D games that don't need a more realistic collision simulation.\n *\n */\nexport class ArcadeSolver extends CollisionSolver {\n  public preSolve(contacts: CollisionContact[]) {\n    for (const contact of contacts) {\n      const side = Side.fromDirection(contact.mtv);\n      const mtv = contact.mtv.negate();\n      // Publish collision events on both participants\n      contact.colliderA.events.emit('precollision', new PreCollisionEvent(contact.colliderA, contact.colliderB, side, mtv));\n      contact.colliderB.events.emit(\n        'precollision',\n        new PreCollisionEvent(contact.colliderB, contact.colliderA, Side.getOpposite(side), mtv.negate())\n      );\n    }\n  }\n\n  public postSolve(contacts: CollisionContact[]) {\n    for (const contact of contacts) {\n      const colliderA = contact.colliderA;\n      const colliderB = contact.colliderB;\n      const bodyA = colliderA.owner?.get(BodyComponent);\n      const bodyB = colliderB.owner?.get(BodyComponent);\n      if (bodyA && bodyB) {\n        if (bodyA.collisionType === CollisionType.Passive || bodyB.collisionType === CollisionType.Passive) {\n          continue;\n        }\n      }\n      const side = Side.fromDirection(contact.mtv);\n      const mtv = contact.mtv.negate();\n      // Publish collision events on both participants\n      contact.colliderA.events.emit('postcollision', new PostCollisionEvent(contact.colliderA, contact.colliderB, side, mtv));\n      contact.colliderB.events.emit(\n        'postcollision',\n        new PostCollisionEvent(contact.colliderB, contact.colliderA, Side.getOpposite(side), mtv.negate())\n      );\n    }\n  }\n\n  public solvePosition(contacts: CollisionContact[]) {\n    for (const contact of contacts) {\n      let mtv = contact.mtv;\n      const colliderA = contact.colliderA;\n      const colliderB = contact.colliderB;\n      const bodyA = colliderA.owner?.get(BodyComponent);\n      const bodyB = colliderB.owner?.get(BodyComponent);\n      if (bodyA && bodyB) {\n        if (bodyA.collisionType === CollisionType.Passive || bodyB.collisionType === CollisionType.Passive) {\n          continue;\n        }\n\n        if (bodyA.collisionType === CollisionType.Active && bodyB.collisionType === CollisionType.Active) {\n          // split overlaps if both are Active\n          mtv = mtv.scale(0.5);\n        }\n\n        // Resolve overlaps\n        if (bodyA.collisionType === CollisionType.Active) {\n          bodyA.pos.x -= mtv.x;\n          bodyA.pos.y -= mtv.y;\n        }\n\n        if (bodyB.collisionType === CollisionType.Active) {\n          bodyB.pos.x += mtv.x;\n          bodyB.pos.y += mtv.y;\n        }\n      }\n    }\n  }\n\n  public solveVelocity(contacts: CollisionContact[]) {\n    for (const contact of contacts) {\n      const colliderA = contact.colliderA;\n      const colliderB = contact.colliderB;\n      const bodyA = colliderA.owner?.get(BodyComponent);\n      const bodyB = colliderB.owner?.get(BodyComponent);\n\n      if (bodyA && bodyB) {\n\n        if (bodyA.collisionType === CollisionType.Passive || bodyB.collisionType === CollisionType.Passive) {\n          continue;\n        }\n\n        const normal = contact.normal;\n        const opposite = normal.negate();\n\n        // Cancel out velocity opposite direction of collision normal\n        if (bodyA.collisionType === CollisionType.Active) {\n          const velAdj = normal.scale(normal.dot(bodyA.vel.negate()));\n          bodyA.vel = bodyA.vel.add(velAdj);\n        }\n\n        if (bodyB.collisionType === CollisionType.Active) {\n          const velAdj = opposite.scale(opposite.dot(bodyB.vel.negate()));\n          bodyB.vel = bodyB.vel.add(velAdj);\n        }\n      }\n    }\n  }\n}\n","import { Vector } from '../../Math/vector';\nimport { BodyComponent } from '../BodyComponent';\nimport { CollisionContact } from '../Detection/CollisionContact';\n\n/**\n * Holds information about contact points, meant to be reused over multiple frames of contact\n */\nexport class ContactConstraintPoint {\n  constructor(public point: Vector, public local: Vector, public contact: CollisionContact) {\n    this.update();\n  }\n\n  /**\n   * Updates the contact information\n   */\n  update() {\n    const bodyA = this.contact.colliderA.owner?.get(BodyComponent);\n    const bodyB = this.contact.colliderB.owner?.get(BodyComponent);\n\n    if (bodyA && bodyB) {\n      const normal = this.contact.normal;\n      const tangent = this.contact.tangent;\n\n      this.aToContact = this.point.sub(bodyA.pos);\n      this.bToContact = this.point.sub(bodyB.pos);\n\n      const aToContactNormal = this.aToContact.cross(normal);\n      const bToContactNormal = this.bToContact.cross(normal);\n\n      this.normalMass =\n        bodyA.inverseMass +\n        bodyB.inverseMass +\n        bodyA.inverseInertia * aToContactNormal * aToContactNormal +\n        bodyB.inverseInertia * bToContactNormal * bToContactNormal;\n\n      const aToContactTangent = this.aToContact.cross(tangent);\n      const bToContactTangent = this.bToContact.cross(tangent);\n\n      this.tangentMass =\n        bodyA.inverseMass +\n        bodyB.inverseMass +\n        bodyA.inverseInertia * aToContactTangent * aToContactTangent +\n        bodyB.inverseInertia * bToContactTangent * bToContactTangent;\n    }\n\n    return this;\n  }\n\n  /**\n   * Returns the relative velocity betwen bodyA and bodyB\n   */\n  public getRelativeVelocity() {\n    const bodyA = this.contact.colliderA.owner?.get(BodyComponent);\n    const bodyB = this.contact.colliderB.owner?.get(BodyComponent);\n    if (bodyA && bodyB) {\n      // Relative velocity in linear terms\n      // Angular to linear velocity formula -> omega = velocity/radius so omega x radius = velocity\n      const velA = bodyA.vel.add(Vector.cross(bodyA.angularVelocity, this.aToContact));\n      const velB = bodyB.vel.add(Vector.cross(bodyB.angularVelocity, this.bToContact));\n      return velB.sub(velA);\n    }\n    return Vector.Zero;\n  }\n\n  /**\n   * Impulse accumulated over time in normal direction\n   */\n  public normalImpulse: number = 0;\n\n  /**\n   * Impulse accumulated over time in the tangent direction\n   */\n  public tangentImpulse: number = 0;\n\n  /**\n   * Effective mass seen in the normal direction\n   */\n  public normalMass: number = 0;\n\n  /**\n   * Effective mass seen in the tangent direction\n   */\n  public tangentMass: number = 0;\n\n  /**\n   * Direction from center of mass of bodyA to contact point\n   */\n  public aToContact: Vector = new Vector(0, 0);\n\n  /**\n   * Direction from center of mass of bodyB to contact point\n   */\n  public bToContact: Vector = new Vector(0, 0);\n}\n","import { CollisionPostSolveEvent, CollisionPreSolveEvent, PostCollisionEvent, PreCollisionEvent } from '../../Events';\nimport { clamp } from '../../Util/Util';\nimport { CollisionContact } from '../Detection/CollisionContact';\nimport { CollisionType } from '../CollisionType';\nimport { ContactConstraintPoint } from './ContactConstraintPoint';\nimport { Side } from '../Side';\nimport { Physics } from '../Physics';\nimport { CollisionSolver } from './Solver';\nimport { BodyComponent } from '../BodyComponent';\nimport { CollisionJumpTable } from '../Colliders/CollisionJumpTable';\n\nexport class RealisticSolver extends CollisionSolver {\n  lastFrameContacts: Map<string, CollisionContact> = new Map();\n\n  // map contact id to contact points\n  idToContactConstraint: Map<string, ContactConstraintPoint[]> = new Map();\n\n  getContactConstraints(id: string) {\n    return this.idToContactConstraint.get(id) ?? [];\n  }\n\n  preSolve(contacts: CollisionContact[]) {\n    for (const contact of contacts) {\n      // Publish collision events on both participants\n      const side = Side.fromDirection(contact.mtv);\n      contact.colliderA.events.emit('precollision', new PreCollisionEvent(contact.colliderA, contact.colliderB, side, contact.mtv));\n      contact.colliderA.events.emit(\n        'beforecollisionresolve',\n        new CollisionPreSolveEvent(contact.colliderA, contact.colliderB, side, contact.mtv, contact) as any\n      );\n      contact.colliderB.events.emit(\n        'precollision',\n        new PreCollisionEvent(contact.colliderB, contact.colliderA, Side.getOpposite(side), contact.mtv.negate())\n      );\n      contact.colliderB.events.emit(\n        'beforecollisionresolve',\n        new CollisionPreSolveEvent(contact.colliderB, contact.colliderA, Side.getOpposite(side), contact.mtv.negate(), contact) as any\n      );\n\n      // Match awake state for sleeping\n      contact.matchAwake();\n    }\n\n    // Keep track of contacts that done\n    const finishedContactIds = Array.from(this.idToContactConstraint.keys());\n    for (const contact of contacts) {\n      // Remove all current contacts that are not done\n      const index = finishedContactIds.indexOf(contact.id);\n      if (index > -1) {\n        finishedContactIds.splice(index, 1);\n      }\n      const contactPoints = this.idToContactConstraint.get(contact.id) ?? [];\n\n      let pointIndex = 0;\n      const bodyA = contact.colliderA.owner.get(BodyComponent);\n      const bodyB = contact.colliderB.owner.get(BodyComponent);\n      if (bodyA && bodyB) {\n        for (const point of contact.points) {\n          const normal = contact.normal;\n          const tangent = contact.tangent;\n\n          const aToContact = point.sub(bodyA.pos);\n          const bToContact = point.sub(bodyB.pos);\n\n          const aToContactNormal = aToContact.cross(normal);\n          const bToContactNormal = bToContact.cross(normal);\n\n          const normalMass =\n            bodyA.inverseMass +\n            bodyB.inverseMass +\n            bodyA.inverseInertia * aToContactNormal * aToContactNormal +\n            bodyB.inverseInertia * bToContactNormal * bToContactNormal;\n\n          const aToContactTangent = aToContact.cross(tangent);\n          const bToContactTangent = bToContact.cross(tangent);\n\n          const tangentMass =\n            bodyA.inverseMass +\n            bodyB.inverseMass +\n            bodyA.inverseInertia * aToContactTangent * aToContactTangent +\n            bodyB.inverseInertia * bToContactTangent * bToContactTangent;\n\n          // Preserve normal/tangent impulse by re-using the contact point if it's close\n          if (contactPoints[pointIndex] && contactPoints[pointIndex]?.point?.squareDistance(point) < 4) {\n            contactPoints[pointIndex].point = point;\n            contactPoints[pointIndex].local = contact.localPoints[pointIndex];\n          } else {\n            // new contact if it's not close or doesn't exist\n            contactPoints[pointIndex] = new ContactConstraintPoint(point, contact.localPoints[pointIndex], contact);\n          }\n\n          // Update contact point calculations\n          contactPoints[pointIndex].aToContact = aToContact;\n          contactPoints[pointIndex].bToContact = bToContact;\n          contactPoints[pointIndex].normalMass = normalMass;\n          contactPoints[pointIndex].tangentMass = tangentMass;\n\n          pointIndex++;\n        }\n      }\n      this.idToContactConstraint.set(contact.id, contactPoints);\n    }\n\n    // Clean up any contacts that did not occur last frame\n    for (const id of finishedContactIds) {\n      this.idToContactConstraint.delete(id);\n    }\n\n    // Warm contacts with accumulated impulse\n    // Useful for tall stacks\n    if (Physics.warmStart) {\n      this.warmStart(contacts);\n    } else {\n      for (const contact of contacts) {\n        const contactPoints = this.getContactConstraints(contact.id);\n        for (const point of contactPoints) {\n          point.normalImpulse = 0;\n          point.tangentImpulse = 0;\n        }\n      }\n    }\n  }\n\n  postSolve(contacts: CollisionContact[]) {\n    for (const contact of contacts) {\n      const bodyA = contact.colliderA.owner.get(BodyComponent);\n      const bodyB = contact.colliderB.owner.get(BodyComponent);\n\n      if (bodyA && bodyB) {\n        // Skip post solve for active+passive collisions\n        if (bodyA.collisionType === CollisionType.Passive || bodyB.collisionType === CollisionType.Passive) {\n          continue;\n        }\n\n        // Update motion values for sleeping\n        bodyA.updateMotion();\n        bodyB.updateMotion();\n      }\n\n      // Publish collision events on both participants\n      const side = Side.fromDirection(contact.mtv);\n      contact.colliderA.events.emit('postcollision', new PostCollisionEvent(contact.colliderA, contact.colliderB, side, contact.mtv));\n      contact.colliderA.events.emit(\n        'aftercollisionresolve',\n        new CollisionPostSolveEvent(contact.colliderA, contact.colliderB, side, contact.mtv, contact) as any\n      );\n      contact.colliderB.events.emit(\n        'postcollision',\n        new PostCollisionEvent(contact.colliderB, contact.colliderA, Side.getOpposite(side), contact.mtv.negate())\n      );\n      contact.colliderB.events.emit(\n        'aftercollisionresolve',\n        new CollisionPostSolveEvent(contact.colliderB, contact.colliderA, Side.getOpposite(side), contact.mtv.negate(), contact) as any\n      );\n    }\n\n    // Store contacts\n    this.lastFrameContacts.clear();\n    for (const c of contacts) {\n      this.lastFrameContacts.set(c.id, c);\n    }\n  }\n\n  /**\n   * Warm up body's based on previous frame contact points\n   * @param contacts\n   */\n  warmStart(contacts: CollisionContact[]) {\n    for (const contact of contacts) {\n      const bodyA = contact.colliderA.owner?.get(BodyComponent);\n      const bodyB = contact.colliderB.owner?.get(BodyComponent);\n      if (bodyA && bodyB) {\n        const contactPoints = this.idToContactConstraint.get(contact.id) ?? [];\n        for (const point of contactPoints) {\n          if (Physics.warmStart) {\n            const normalImpulse = contact.normal.scale(point.normalImpulse);\n            const tangentImpulse = contact.tangent.scale(point.tangentImpulse);\n            const impulse = normalImpulse.add(tangentImpulse);\n\n            bodyA.applyImpulse(point.point, impulse.negate());\n            bodyB.applyImpulse(point.point, impulse);\n          } else {\n            point.normalImpulse = 0;\n            point.tangentImpulse = 0;\n          }\n        }\n      }\n    }\n  }\n\n  /**\n   * Iteratively solve the position overlap constraint\n   * @param contacts\n   */\n  solvePosition(contacts: CollisionContact[]) {\n    for (let i = 0; i < Physics.positionIterations; i++) {\n      for (const contact of contacts) {\n        const bodyA = contact.colliderA.owner?.get(BodyComponent);\n        const bodyB = contact.colliderB.owner?.get(BodyComponent);\n\n        if (bodyA && bodyB) {\n          // Skip solving active+passive\n          if (bodyA.collisionType === CollisionType.Passive || bodyB.collisionType === CollisionType.Passive) {\n            continue;\n          }\n\n          const constraints = this.idToContactConstraint.get(contact.id) ?? [];\n          for (const point of constraints) {\n            const normal = contact.normal;\n            const separation = CollisionJumpTable.FindContactSeparation(contact, point.local);\n\n            const steeringConstant = Physics.steeringFactor; //0.2;\n            const maxCorrection = -5;\n            const slop = Physics.slop; //1;\n\n            // Clamp to avoid over-correction\n            // Remember that we are shooting for 0 overlap in the end\n            const steeringForce = clamp(steeringConstant * (separation + slop), maxCorrection, 0);\n            const impulse = normal.scale(-steeringForce / point.normalMass);\n\n            // This is a pseudo impulse, meaning we aren't doing a real impulse calculation\n            // We adjust position and rotation instead of doing the velocity\n            if (bodyA.collisionType === CollisionType.Active) {\n              bodyA.pos = bodyA.pos.add(impulse.negate().scale(bodyA.inverseMass));\n              bodyA.rotation -= point.aToContact.cross(impulse) * bodyA.inverseInertia;\n            }\n\n            if (bodyB.collisionType === CollisionType.Active) {\n              bodyB.pos = bodyB.pos.add(impulse.scale(bodyB.inverseMass));\n              bodyB.rotation += point.bToContact.cross(impulse) * bodyB.inverseInertia;\n            }\n          }\n        }\n      }\n    }\n  }\n\n  solveVelocity(contacts: CollisionContact[]) {\n    for (let i = 0; i < Physics.velocityIterations; i++) {\n      for (const contact of contacts) {\n        const bodyA = contact.colliderA.owner?.get(BodyComponent);\n        const bodyB = contact.colliderB.owner?.get(BodyComponent);\n\n        if (bodyA && bodyB) {\n          // Skip solving active+passive\n          if (bodyA.collisionType === CollisionType.Passive || bodyB.collisionType === CollisionType.Passive) {\n            continue;\n          }\n\n          const restitution = bodyA.bounciness * bodyB.bounciness;\n          const friction = Math.min(bodyA.friction, bodyB.friction);\n\n          const constraints = this.idToContactConstraint.get(contact.id) ?? [];\n\n          for (const point of constraints) {\n            const relativeVelocity = point.getRelativeVelocity();\n\n            // Negate velocity in tangent direction to simulate friction\n            const tangentVelocity = -relativeVelocity.dot(contact.tangent);\n            let impulseDelta = tangentVelocity / point.tangentMass;\n\n            // Clamping based in Erin Catto's GDC 2006 talk\n            // Correct clamping https://github.com/erincatto/box2d-lite/blob/master/docs/GDC2006_Catto_Erin_PhysicsTutorial.pdf\n            // Accumulated fiction impulse is always between -uMaxFriction < dT < uMaxFriction\n            // But deltas can vary\n            const maxFriction = friction * point.normalImpulse;\n            const newImpulse = clamp(point.tangentImpulse + impulseDelta, -maxFriction, maxFriction);\n            impulseDelta = newImpulse - point.tangentImpulse;\n            point.tangentImpulse = newImpulse;\n\n            const impulse = contact.tangent.scale(impulseDelta);\n            bodyA.applyImpulse(point.point, impulse.negate());\n            bodyB.applyImpulse(point.point, impulse);\n          }\n\n          for (const point of constraints) {\n            // Need to recalc relative velocity because the previous step could have changed vel\n            const relativeVelocity = point.getRelativeVelocity();\n\n            // Compute impulse in normal direction\n            const normalVelocity = relativeVelocity.dot(contact.normal);\n            // See https://en.wikipedia.org/wiki/Collision_response\n            let impulseDelta = (-(1 + restitution) * normalVelocity) / point.normalMass;\n\n            // Clamping based in Erin Catto's GDC 2014 talk\n            // Accumulated impulse stored in the contact is always positive (dV > 0)\n            // But deltas can be negative\n            const newImpulse = Math.max(point.normalImpulse + impulseDelta, 0);\n            impulseDelta = newImpulse - point.normalImpulse;\n            point.normalImpulse = newImpulse;\n\n            const impulse = contact.normal.scale(impulseDelta);\n            bodyA.applyImpulse(point.point, impulse.negate());\n            bodyB.applyImpulse(point.point, impulse);\n          }\n        }\n      }\n    }\n  }\n}\n","import { Entity } from '../EntityComponentSystem';\nimport { MotionComponent } from '../EntityComponentSystem/Components/MotionComponent';\nimport { TransformComponent } from '../EntityComponentSystem/Components/TransformComponent';\nimport { AddedEntity, isAddedSystemEntity, RemovedEntity, System, SystemType } from '../EntityComponentSystem/System';\nimport { CollisionEndEvent, CollisionStartEvent, ContactEndEvent, ContactStartEvent } from '../Events';\nimport { CollisionResolutionStrategy, Physics } from './Physics';\nimport { ArcadeSolver } from './Solver/ArcadeSolver';\nimport { Collider } from './Colliders/Collider';\nimport { CollisionContact } from './Detection/CollisionContact';\nimport { DynamicTreeCollisionProcessor } from './Detection/DynamicTreeCollisionProcessor';\nimport { RealisticSolver } from './Solver/RealisticSolver';\nimport { CollisionSolver } from './Solver/Solver';\nimport { ColliderComponent } from './ColliderComponent';\nimport { CompositeCollider } from './Colliders/CompositeCollider';\nimport { Engine, ExcaliburGraphicsContext, Scene } from '..';\n\nexport class CollisionSystem extends System<TransformComponent | MotionComponent | ColliderComponent> {\n  public readonly types = ['ex.transform', 'ex.motion', 'ex.collider'] as const;\n  public systemType = SystemType.Update;\n  public priority = -1;\n\n  private _engine: Engine;\n  private _realisticSolver = new RealisticSolver();\n  private _arcadeSolver = new ArcadeSolver();\n  private _processor = new DynamicTreeCollisionProcessor();\n  private _lastFrameContacts = new Map<string, CollisionContact>();\n  private _currentFrameContacts = new Map<string, CollisionContact>();\n\n  private _trackCollider = (c: Collider) => this._processor.track(c);\n  private _untrackCollider = (c: Collider) => this._processor.untrack(c);\n\n  notify(message: AddedEntity | RemovedEntity) {\n    if (isAddedSystemEntity(message)) {\n      const colliderComponent = message.data.get(ColliderComponent);\n      colliderComponent.$colliderAdded.subscribe(this._trackCollider);\n      colliderComponent.$colliderRemoved.subscribe(this._untrackCollider);\n      const collider = colliderComponent.get();\n      if (collider) {\n        this._processor.track(collider);\n      }\n    } else {\n      const colliderComponent = message.data.get(ColliderComponent);\n      const collider = colliderComponent.get();\n      if (colliderComponent) {\n        this._processor.untrack(collider);\n      }\n    }\n  }\n\n  initialize(scene: Scene) {\n    this._engine = scene.engine;\n  }\n\n  update(_entities: Entity[], elapsedMs: number): void {\n    if (!Physics.enabled) {\n      return;\n    }\n\n    // Collect up all the colliders\n    let colliders: Collider[] = [];\n    for (const entity of _entities) {\n      const colliderComp = entity.get(ColliderComponent);\n      const collider = colliderComp?.get();\n      if (colliderComp && colliderComp.owner?.active) {\n        colliderComp.update();\n        if (collider instanceof CompositeCollider) {\n          colliders = colliders.concat(collider.getColliders());\n        } else {\n          colliders.push(collider);\n        }\n      }\n    }\n\n    // Update the spatial partitioning data structures\n    // TODO if collider invalid it will break the processor\n    // TODO rename \"update\" to something more specific\n    this._processor.update(colliders);\n\n    // Run broadphase on all colliders and locates potential collisions\n    const pairs = this._processor.broadphase(colliders, elapsedMs);\n\n    this._currentFrameContacts.clear();\n\n    // Given possible pairs find actual contacts\n    let contacts = this._processor.narrowphase(pairs, this._engine.debug.stats.currFrame);\n\n    const solver: CollisionSolver = this.getSolver();\n\n    // Solve, this resolves the position/velocity so entities arent overlapping\n    contacts = solver.solve(contacts);\n\n    // Record contacts\n    contacts.forEach((c) => this._currentFrameContacts.set(c.id, c));\n\n    // Emit contact start/end events\n    this.runContactStartEnd();\n\n    // reset the last frame cache\n    this._lastFrameContacts.clear();\n\n    // Keep track of collisions contacts that have started or ended\n    this._lastFrameContacts = new Map(this._currentFrameContacts);\n  }\n\n  getSolver(): CollisionSolver {\n    return Physics.collisionResolutionStrategy === CollisionResolutionStrategy.Realistic ? this._realisticSolver : this._arcadeSolver;\n  }\n\n  debug(ex: ExcaliburGraphicsContext) {\n    this._processor.debug(ex);\n  }\n\n  public runContactStartEnd() {\n    for (const [id, c] of this._currentFrameContacts) {\n      // find all new contacts\n      if (!this._lastFrameContacts.has(id)) {\n        const colliderA = c.colliderA;\n        const colliderB = c.colliderB;\n        colliderA.events.emit('collisionstart', new CollisionStartEvent(colliderA, colliderB, c));\n        colliderA.events.emit('contactstart', new ContactStartEvent(colliderA, colliderB, c) as any);\n        colliderB.events.emit('collisionstart', new CollisionStartEvent(colliderB, colliderA, c));\n        colliderB.events.emit('contactstart', new ContactStartEvent(colliderB, colliderA, c) as any);\n      }\n    }\n\n    // find all contacts taht have ceased\n    for (const [id, c] of this._lastFrameContacts) {\n      if (!this._currentFrameContacts.has(id)) {\n        const colliderA = c.colliderA;\n        const colliderB = c.colliderB;\n        colliderA.events.emit('collisionend', new CollisionEndEvent(colliderA, colliderB));\n        colliderA.events.emit('contactend', new ContactEndEvent(colliderA, colliderB) as any);\n        colliderB.events.emit('collisionend', new CollisionEndEvent(colliderB, colliderA));\n        colliderB.events.emit('contactend', new ContactEndEvent(colliderB, colliderA) as any);\n      }\n    }\n  }\n}\n","export class GraphicsDiagnostics {\n  public static DrawCallCount: number = 0;\n  public static DrawnImagesCount: number = 0;\n  public static clear(): void {\n    GraphicsDiagnostics.DrawCallCount = 0;\n    GraphicsDiagnostics.DrawnImagesCount = 0;\n  }\n}\n","import { Graphic, GraphicOptions } from './Graphic';\nimport { clamp } from '../Util/Util';\nimport { ExcaliburGraphicsContext } from './Context/ExcaliburGraphicsContext';\nimport { EventDispatcher } from '../EventDispatcher';\nimport { SpriteSheet } from './SpriteSheet';\nimport { Logger } from '../Util/Log';\nimport { Engine, LegacyDrawing } from '..';\nimport { Sprite } from '.';\n\nexport interface HasTick {\n  /**\n   *\n   * @param elapsedMilliseconds The amount of real world time in milliseconds that has elapsed that must be updated in the animation\n   * @param idempotencyToken Optional idempotencyToken prevents a ticking animation from updating twice per frame\n   */\n  tick(elapsedMilliseconds: number, idempotencyToken?: number): void;\n}\n\nexport enum AnimationStrategy {\n  /**\n   * Animation ends without displaying anything\n   */\n  End = 'end',\n  /**\n   * Animation loops to the first frame after the last frame\n   */\n  Loop = 'loop',\n  /**\n   * Animation plays to the last frame, then backwards to the first frame, then repeats\n   */\n  PingPong = 'pingpong',\n\n  /**\n   * Animation ends stopping on the last frame\n   */\n  Freeze = 'freeze'\n}\n\n/**\n * Frame of animation\n */\nexport interface Frame {\n  /**\n   * Optionally specify a graphic to show, no graphic shows an empty frame\n   */\n  graphic?: Graphic;\n  /**\n   * Optionally specify the number of ms the frame should be visible, overrids the animation duration (default 100 ms)\n   */\n  duration?: number;\n}\n\n/**\n * Animation options for building an animation via constructor.\n */\nexport interface AnimationOptions {\n  /**\n   * List of frames in the order you wish to play them\n   */\n  frames: Frame[];\n  /**\n   * Optionally specify a default frame duration in ms (Default is 1000)\n   */\n  frameDuration?: number;\n  /**\n   * Optionally specify the [[AnimationStrategy]] for the Animation\n   */\n  strategy?: AnimationStrategy;\n}\n\n// TODO wire up to new Emitter\nexport type AnimationEvents = {\n  frame: Frame;\n  loop: Animation;\n  ended: Animation;\n};\n\n/**\n * Create an Animation given a list of [[Frame|frames]] in [[AnimationOptions]]\n *\n * To create an Animation from a [[SpriteSheet]], use [[Animation.fromSpriteSheet]]\n */\nexport class Animation extends Graphic implements HasTick {\n  private static _LOGGER = Logger.getInstance();\n  public events = new EventDispatcher<any>(this); // TODO replace with new Emitter\n  public frames: Frame[] = [];\n  public strategy: AnimationStrategy = AnimationStrategy.Loop;\n  public frameDuration: number = 100;\n  public timeScale: number = 1;\n\n  private _idempotencyToken = -1;\n\n  private _firstTick = true;\n  private _currentFrame = 0;\n  private _timeLeftInFrame = 0;\n  private _direction = 1;\n  private _done = false;\n  private _playing = true;\n\n  constructor(options: GraphicOptions & AnimationOptions) {\n    super(options);\n    this.frames = options.frames;\n    this.strategy = options.strategy ?? this.strategy;\n    this.frameDuration = options.frameDuration ?? this.frameDuration;\n\n    this.goToFrame(0);\n  }\n\n  public clone(): Animation {\n    return new Animation({\n      frames: this.frames.map((f) => ({ ...f })),\n      frameDuration: this.frameDuration,\n      strategy: this.strategy,\n      ...this.cloneGraphicOptions()\n    });\n  }\n\n  /**\n   * Create an Animation from a [[SpriteSheet]], a list of indices into the sprite sheet, a duration per frame\n   * and optional [[AnimationStrategy]]\n   *\n   * Example:\n   * ```typescript\n   * const spriteSheet = SpriteSheet.fromImageSource({\n   *   image: imageSource,\n   *   grid: {\n   *     rows: 5,\n   *     columns: 2,\n   *     spriteWidth: 32, // pixels\n   *     spriteHeight: 32, // pixels\n   *   }\n   * });\n   *\n   * const anim = Animation.fromSpriteSheet(spriteSheet, range(0, 5), 200, AnimationStrategy.Loop);\n   * ```\n   *\n   * @param spriteSheet\n   * @param frameIndices\n   * @param durationPerFrameMs\n   * @param strategy\n   */\n  public static fromSpriteSheet(\n    spriteSheet: SpriteSheet,\n    frameIndices: number[],\n    durationPerFrameMs: number,\n    strategy: AnimationStrategy = AnimationStrategy.Loop\n  ): Animation {\n    const maxIndex = spriteSheet.sprites.length - 1;\n    const invalidIndices = frameIndices.filter((index) => index < 0 || index > maxIndex);\n    if (invalidIndices.length) {\n      Animation._LOGGER.warn(\n        `Indices into SpriteSheet were provided that don\\'t exist: ${invalidIndices.join(',')} no frame will be shown`\n      );\n    }\n    return new Animation({\n      frames: spriteSheet.sprites\n        .filter((_, index) => frameIndices.indexOf(index) > -1)\n        .map((f) => ({\n          graphic: f,\n          duration: durationPerFrameMs\n        })),\n      strategy: strategy\n    });\n  }\n\n  /**\n   * Converts an animation to a legacy animation\n   * @deprecated\n   * @param engine\n   * @param animation\n   * @returns LegacyDrawing.Animation\n   */\n  public static toLegacyAnimation(engine: Engine, animation: Animation): LegacyDrawing.Animation {\n    const legacySprites = animation.frames.map(f => Sprite.toLegacySprite(f.graphic as Sprite));\n    return new LegacyDrawing.Animation({\n      sprites: legacySprites,\n      loop: animation.strategy === AnimationStrategy.Loop,\n      freezeFrame: animation.strategy === AnimationStrategy.Freeze ? legacySprites.length - 1 : undefined,\n      speed: animation.frameDuration,\n      engine: engine\n    });\n  }\n\n  public get currentFrame(): Frame | null {\n    if (this._currentFrame >= 0 && this._currentFrame < this.frames.length) {\n      return this.frames[this._currentFrame];\n    }\n    return null;\n  }\n\n  public get isPlaying(): boolean {\n    return this._playing;\n  }\n\n  public play(): void {\n    this._playing = true;\n  }\n\n  public pause(): void {\n    this._playing = false;\n    this._firstTick = true;\n  }\n\n  public reset(): void {\n    this._done = false;\n    this._firstTick = true;\n    this._currentFrame = 0;\n  }\n\n  public get canFinish(): boolean {\n    switch (this.strategy) {\n      case AnimationStrategy.End:\n      case AnimationStrategy.Freeze: {\n        return true;\n      }\n      default: {\n        return false;\n      }\n    }\n  }\n\n  public get done(): boolean {\n    return this._done;\n  }\n\n  public goToFrame(frameNumber: number) {\n    this._currentFrame = frameNumber;\n    this._timeLeftInFrame = this.frameDuration;\n    const maybeFrame = this.frames[this._currentFrame];\n    if (maybeFrame && !this._done) {\n      this._timeLeftInFrame = maybeFrame?.duration || this.frameDuration;\n      this.width = maybeFrame.graphic?.width;\n      this.height = maybeFrame.graphic?.height;\n      this.events.emit('frame', maybeFrame as any);\n    }\n  }\n\n  private _nextFrame(): number {\n    const currentFrame = this._currentFrame;\n    if (this._done) {\n      return currentFrame;\n    }\n    let next = -1;\n\n    switch (this.strategy) {\n      case AnimationStrategy.Loop: {\n        next = (currentFrame + 1) % this.frames.length;\n        if (next === 0) {\n          this.events.emit('loop', this as any);\n        }\n        break;\n      }\n      case AnimationStrategy.End: {\n        next = currentFrame + 1;\n        if (next >= this.frames.length) {\n          this._done = true;\n          this._currentFrame = this.frames.length;\n          this.events.emit('end', this as any);\n        }\n        break;\n      }\n      case AnimationStrategy.Freeze: {\n        next = clamp(currentFrame + 1, 0, this.frames.length - 1);\n        if (next >= this.frames.length - 1) {\n          this._done = true;\n          this.events.emit('end', this as any);\n        }\n        break;\n      }\n      case AnimationStrategy.PingPong: {\n        if (currentFrame + this._direction >= this.frames.length) {\n          this._direction = -1;\n          this.events.emit('loop', this as any);\n        }\n\n        if (currentFrame + this._direction < 0) {\n          this._direction = 1;\n          this.events.emit('loop', this as any);\n        }\n\n        next = currentFrame + (this._direction % this.frames.length);\n        break;\n      }\n    }\n    return next;\n  }\n\n  public tick(elapsedMilliseconds: number, idempotencyToken: number = 0) {\n    if (this._idempotencyToken === idempotencyToken) {\n      return;\n    }\n    this._idempotencyToken = idempotencyToken;\n    if (!this._playing) {\n      return;\n    }\n\n    // if it's the first frame emit frame event\n    if (this._firstTick) {\n      this._firstTick = false;\n      this.events.emit('frame', this.currentFrame as any);\n    }\n\n    this._timeLeftInFrame -= elapsedMilliseconds * this.timeScale;\n    if (this._timeLeftInFrame <= 0) {\n      this.goToFrame(this._nextFrame());\n    }\n    this._updateDimensions();\n  }\n\n  private _updateDimensions() {\n    if (this.currentFrame) {\n      this.width = this.currentFrame.graphic?.width;\n      this.height = this.currentFrame.graphic?.height;\n    }\n  }\n\n  protected _drawImage(ctx: ExcaliburGraphicsContext, x: number, y: number) {\n    if (this.currentFrame) {\n      this.currentFrame.graphic.draw(ctx, x, y);\n    }\n  }\n}\n","import { Engine } from './Engine';\nimport { Actor } from './Actor';\nimport { Color } from './Color';\nimport { Vector, vec } from './Math/vector';\nimport * as Util from './Util/Util';\nimport * as DrawUtil from './Util/DrawUtil';\nimport * as Traits from './Traits/Index';\nimport { Configurable } from './Configurable';\nimport { Random } from './Math/Random';\nimport { CollisionType } from './Collision/CollisionType';\nimport { TransformComponent } from './EntityComponentSystem/Components/TransformComponent';\nimport { GraphicsComponent } from './Graphics/GraphicsComponent';\nimport { Entity } from './EntityComponentSystem/Entity';\nimport { CanvasDrawComponent } from './Drawing/Index';\nimport { Sprite } from './Graphics/Sprite';\nimport { LegacyDrawing } from '.';\n\n/**\n * An enum that represents the types of emitter nozzles\n */\nexport enum EmitterType {\n  /**\n   * Constant for the circular emitter type\n   */\n  Circle,\n  /**\n   * Constant for the rectangular emitter type\n   */\n  Rectangle\n}\n\n/**\n * @hidden\n */\nexport class ParticleImpl extends Entity {\n  public position: Vector = new Vector(0, 0);\n  public velocity: Vector = new Vector(0, 0);\n  public acceleration: Vector = new Vector(0, 0);\n  public particleRotationalVelocity: number = 0;\n  public currentRotation: number = 0;\n\n  public focus: Vector = null;\n  public focusAccel: number = 0;\n  public opacity: number = 1;\n  public beginColor: Color = Color.White;\n  public endColor: Color = Color.White;\n\n  // Life is counted in ms\n  public life: number = 300;\n  public fadeFlag: boolean = false;\n\n  // Color transitions\n  private _rRate: number = 1;\n  private _gRate: number = 1;\n  private _bRate: number = 1;\n  private _aRate: number = 0;\n  private _currentColor: Color = Color.White;\n\n  public emitter: ParticleEmitter = null;\n  public particleSize: number = 5;\n  public particleSprite: LegacyDrawing.Sprite = null;\n\n  public startSize: number;\n  public endSize: number;\n  public sizeRate: number = 0;\n  public elapsedMultiplier: number = 0;\n\n  public visible = true;\n  public isOffscreen = false;\n\n  public transform: TransformComponent;\n  public graphics: GraphicsComponent;\n\n  constructor(\n    emitterOrConfig: ParticleEmitter | ParticleArgs,\n    life?: number,\n    opacity?: number,\n    beginColor?: Color,\n    endColor?: Color,\n    position?: Vector,\n    velocity?: Vector,\n    acceleration?: Vector,\n    startSize?: number,\n    endSize?: number\n  ) {\n    super();\n    let emitter = emitterOrConfig;\n    if (emitter && !(emitterOrConfig instanceof ParticleEmitter)) {\n      const config = emitterOrConfig;\n      emitter = config.emitter;\n      life = config.life;\n      opacity = config.opacity;\n      endColor = config.endColor;\n      beginColor = config.beginColor;\n      position = config.position;\n      velocity = config.velocity;\n      acceleration = config.acceleration;\n      startSize = config.startSize;\n      endSize = config.endSize;\n    }\n    this.emitter = <ParticleEmitter>emitter;\n    this.life = life || this.life;\n    this.opacity = opacity || this.opacity;\n    this.endColor = endColor || this.endColor.clone();\n    this.beginColor = beginColor || this.beginColor.clone();\n    this._currentColor = this.beginColor.clone();\n    this.position = (position || this.position).add(this.emitter.pos);\n    this.velocity = velocity || this.velocity;\n    this.acceleration = acceleration || this.acceleration;\n    this._rRate = (this.endColor.r - this.beginColor.r) / this.life;\n    this._gRate = (this.endColor.g - this.beginColor.g) / this.life;\n    this._bRate = (this.endColor.b - this.beginColor.b) / this.life;\n    this._aRate = this.opacity / this.life;\n\n    this.startSize = startSize || 0;\n    this.endSize = endSize || 0;\n\n    if (this.endSize > 0 && this.startSize > 0) {\n      this.sizeRate = (this.endSize - this.startSize) / this.life;\n      this.particleSize = this.startSize;\n    }\n\n    this.addComponent((this.transform = new TransformComponent()));\n    this.addComponent(new CanvasDrawComponent((ctx) => this.draw(ctx)));\n    this.addComponent((this.graphics = new GraphicsComponent()));\n\n    this.transform.pos = this.position;\n    this.transform.rotation = this.currentRotation;\n    this.transform.scale = vec(1, 1); // TODO wut\n    if (this.particleSprite) {\n      this.graphics.opacity = this.opacity;\n      this.graphics.use(Sprite.fromLegacySprite(this.particleSprite));\n    } else {\n      this.graphics.onPostDraw = (ctx) => {\n        ctx.save();\n        this.graphics.opacity = this.opacity;\n        const tmpColor = this._currentColor.clone();\n        tmpColor.a = 1;\n        ctx.debug.drawPoint(vec(0, 0), { color: tmpColor, size: this.particleSize });\n        ctx.restore();\n      };\n    }\n  }\n\n  public kill() {\n    this.emitter.removeParticle(this);\n  }\n\n  public update(_engine: Engine, delta: number) {\n    this.life = this.life - delta;\n    this.elapsedMultiplier = this.elapsedMultiplier + delta;\n\n    if (this.life < 0) {\n      this.kill();\n    }\n\n    if (this.fadeFlag) {\n      this.opacity = Util.clamp(this._aRate * this.life, 0.0001, 1);\n    }\n\n    if (this.startSize > 0 && this.endSize > 0) {\n      this.particleSize = Util.clamp(\n        this.sizeRate * delta + this.particleSize,\n        Math.min(this.startSize, this.endSize),\n        Math.max(this.startSize, this.endSize)\n      );\n    }\n\n    this._currentColor.r = Util.clamp(this._currentColor.r + this._rRate * delta, 0, 255);\n    this._currentColor.g = Util.clamp(this._currentColor.g + this._gRate * delta, 0, 255);\n    this._currentColor.b = Util.clamp(this._currentColor.b + this._bRate * delta, 0, 255);\n    this._currentColor.a = Util.clamp(this.opacity, 0.0001, 1);\n\n    if (this.focus) {\n      const accel = this.focus\n        .sub(this.position)\n        .normalize()\n        .scale(this.focusAccel)\n        .scale(delta / 1000);\n      this.velocity = this.velocity.add(accel);\n    } else {\n      this.velocity = this.velocity.add(this.acceleration.scale(delta / 1000));\n    }\n    this.position = this.position.add(this.velocity.scale(delta / 1000));\n\n    if (this.particleRotationalVelocity) {\n      this.currentRotation = (this.currentRotation + (this.particleRotationalVelocity * delta) / 1000) % (2 * Math.PI);\n    }\n\n    this.transform.pos = this.position;\n    this.transform.rotation = this.currentRotation;\n    this.transform.scale = vec(1, 1); // todo wut\n    this.graphics.opacity = this.opacity;\n  }\n\n  public draw(ctx: CanvasRenderingContext2D) {\n    if (this.particleSprite) {\n      this.particleSprite.opacity(this.opacity);\n      this.particleSprite.draw(ctx, 0, 0);\n      return;\n    }\n\n    ctx.save();\n    this._currentColor.a = Util.clamp(this.opacity, 0.0001, 1);\n    ctx.fillStyle = this._currentColor.toString();\n    ctx.beginPath();\n    ctx.arc(0, 0, this.particleSize, 0, Math.PI * 2);\n    ctx.fill();\n    ctx.closePath();\n    ctx.restore();\n  }\n}\n\nexport interface ParticleArgs extends Partial<ParticleImpl> {\n  emitter: ParticleEmitter;\n  position?: Vector;\n  velocity?: Vector;\n  acceleration?: Vector;\n  particleRotationalVelocity?: number;\n  currentRotation?: number;\n  particleSize?: number;\n  particleSprite?: LegacyDrawing.Sprite;\n}\n\n/**\n * Particle is used in a [[ParticleEmitter]]\n */\nexport class Particle extends Configurable(ParticleImpl) {\n  constructor(config: ParticleArgs);\n  constructor(\n    emitter: ParticleEmitter,\n    life?: number,\n    opacity?: number,\n    beginColor?: Color,\n    endColor?: Color,\n    position?: Vector,\n    velocity?: Vector,\n    acceleration?: Vector,\n    startSize?: number,\n    endSize?: number\n  );\n  constructor(\n    emitterOrConfig: ParticleEmitter | ParticleArgs,\n    life?: number,\n    opacity?: number,\n    beginColor?: Color,\n    endColor?: Color,\n    position?: Vector,\n    velocity?: Vector,\n    acceleration?: Vector,\n    startSize?: number,\n    endSize?: number\n  ) {\n    super(emitterOrConfig, life, opacity, beginColor, endColor, position, velocity, acceleration, startSize, endSize);\n  }\n}\n\nexport interface ParticleEmitterArgs {\n  x?: number;\n  y?: number;\n  pos?: Vector;\n  width?: number;\n  height?: number;\n  isEmitting?: boolean;\n  minVel?: number;\n  maxVel?: number;\n  acceleration?: Vector;\n  minAngle?: number;\n  maxAngle?: number;\n  emitRate?: number;\n  particleLife?: number;\n  opacity?: number;\n  fadeFlag?: boolean;\n  focus?: Vector;\n  focusAccel?: number;\n  startSize?: number;\n  endSize?: number;\n  minSize?: number;\n  maxSize?: number;\n  beginColor?: Color;\n  endColor?: Color;\n  particleSprite?: LegacyDrawing.Sprite;\n  emitterType?: EmitterType;\n  radius?: number;\n  particleRotationalVelocity?: number;\n  randomRotation?: boolean;\n  random?: Random;\n}\n\n/**\n * Using a particle emitter is a great way to create interesting effects\n * in your game, like smoke, fire, water, explosions, etc. `ParticleEmitter`\n * extend [[Actor]] allowing you to use all of the features that come with.\n */\nexport class ParticleEmitter extends Actor {\n  private _particlesToEmit: number = 0;\n\n  public numParticles: number = 0;\n\n  /**\n   * Random number generator\n   */\n  public random: Random;\n\n  /**\n   * Gets or sets the isEmitting flag\n   */\n  public isEmitting: boolean = true;\n  /**\n   * Gets or sets the backing particle collection\n   */\n  public particles: Particle[] = [];\n\n  /**\n   * Gets or sets the backing deadParticle collection\n   */\n  public deadParticles: Particle[] = [];\n\n  /**\n   * Gets or sets the minimum particle velocity\n   */\n  public minVel: number = 0;\n  /**\n   * Gets or sets the maximum particle velocity\n   */\n  public maxVel: number = 0;\n\n  /**\n   * Gets or sets the acceleration vector for all particles\n   */\n  public acceleration: Vector = new Vector(0, 0);\n\n  /**\n   * Gets or sets the minimum angle in radians\n   */\n  public minAngle: number = 0;\n  /**\n   * Gets or sets the maximum angle in radians\n   */\n  public maxAngle: number = 0;\n\n  /**\n   * Gets or sets the emission rate for particles (particles/sec)\n   */\n  public emitRate: number = 1; //particles/sec\n  /**\n   * Gets or sets the life of each particle in milliseconds\n   */\n  public particleLife: number = 2000;\n  /**\n   * Gets the opacity of each particle from 0 to 1.0\n   */\n  public get opacity(): number {\n    return super.opacity;\n  }\n  /**\n   * Gets the opacity of each particle from 0 to 1.0\n   */\n  public set opacity(opacity: number) {\n    super.opacity = opacity;\n  }\n  /**\n   * Gets or sets the fade flag which causes particles to gradually fade out over the course of their life.\n   */\n  public fadeFlag: boolean = false;\n\n  /**\n   * Gets or sets the optional focus where all particles should accelerate towards\n   */\n  public focus: Vector = null;\n  /**\n   * Gets or sets the acceleration for focusing particles if a focus has been specified\n   */\n  public focusAccel: number = null;\n  /**\n   * Gets or sets the optional starting size for the particles\n   */\n  public startSize: number = null;\n  /**\n   * Gets or sets the optional ending size for the particles\n   */\n  public endSize: number = null;\n\n  /**\n   * Gets or sets the minimum size of all particles\n   */\n  public minSize: number = 5;\n  /**\n   * Gets or sets the maximum size of all particles\n   */\n  public maxSize: number = 5;\n\n  /**\n   * Gets or sets the beginning color of all particles\n   */\n  public beginColor: Color = Color.White;\n  /**\n   * Gets or sets the ending color of all particles\n   */\n  public endColor: Color = Color.White;\n\n  private _og: LegacyDrawing.Sprite = null;\n  private _sprite: Sprite = null;\n  /**\n   * Gets or sets the sprite that a particle should use\n   */\n  public get particleSprite(): LegacyDrawing.Sprite {\n    return this._og;\n  }\n\n  public set particleSprite(val: LegacyDrawing.Sprite) {\n    this._og = val;\n    if (val) {\n      this._sprite = Sprite.fromLegacySprite(val);\n    }\n  }\n\n  /**\n   * Gets or sets the emitter type for the particle emitter\n   */\n  public emitterType: EmitterType = EmitterType.Rectangle;\n\n  /**\n   * Gets or sets the emitter radius, only takes effect when the [[emitterType]] is [[EmitterType.Circle]]\n   */\n  public radius: number = 0;\n\n  /**\n   * Gets or sets the particle rotational speed velocity\n   */\n  public particleRotationalVelocity: number = 0;\n\n  /**\n   * Indicates whether particles should start with a random rotation\n   */\n  public randomRotation: boolean = false;\n\n  /**\n   * @param config particle emitter options bag\n   */\n  constructor(config: ParticleEmitterArgs) {\n    super({ width: config.width ?? 0, height: config.height ?? 0 });\n\n    const {\n      x,\n      y,\n      pos,\n      isEmitting,\n      minVel,\n      maxVel,\n      acceleration,\n      minAngle,\n      maxAngle,\n      emitRate,\n      particleLife,\n      opacity,\n      fadeFlag,\n      focus,\n      focusAccel,\n      startSize,\n      endSize,\n      minSize,\n      maxSize,\n      beginColor,\n      endColor,\n      particleSprite,\n      emitterType,\n      radius,\n      particleRotationalVelocity,\n      randomRotation,\n      random\n    } = { ...config };\n\n    this.pos = pos ?? vec(x ?? 0, y ?? 0);\n    this.isEmitting = isEmitting ?? this.isEmitting;\n    this.minVel = minVel ?? this.minVel;\n    this.maxVel = maxVel ?? this.maxVel;\n    this.acceleration = acceleration ?? this.acceleration;\n    this.minAngle = minAngle ?? this.minAngle;\n    this.maxAngle = maxAngle ?? this.maxAngle;\n    this.emitRate = emitRate ?? this.emitRate;\n    this.particleLife = particleLife ?? this.particleLife;\n    this.opacity = opacity ?? this.opacity;\n    this.fadeFlag = fadeFlag ?? this.fadeFlag;\n    this.focus = focus ?? this.focus;\n    this.focusAccel = focusAccel ?? this.focusAccel;\n    this.startSize = startSize ?? this.startSize;\n    this.endSize = endSize ?? this.endSize;\n    this.minSize = minSize ?? this.minSize;\n    this.maxSize = maxSize ?? this.maxSize;\n    this.beginColor = beginColor ?? this.beginColor;\n    this.endColor = endColor ?? this.endColor;\n    this.particleSprite = particleSprite ?? this.particleSprite;\n    this.emitterType = emitterType ?? this.emitterType;\n    this.radius = radius ?? this.radius;\n    this.particleRotationalVelocity = particleRotationalVelocity ?? this.particleRotationalVelocity;\n    this.randomRotation = randomRotation ?? this.randomRotation;\n\n    this.body.collisionType = CollisionType.PreventCollision;\n\n    this.random = random ?? new Random();\n\n    // Remove offscreen culling from particle emitters\n    for (let i = 0; i < this.traits.length; i++) {\n      if (this.traits[i] instanceof Traits.OffscreenCulling) {\n        this.traits.splice(i, 1);\n      }\n    }\n  }\n\n  public removeParticle(particle: Particle) {\n    this.deadParticles.push(particle);\n  }\n\n  /**\n   * Causes the emitter to emit particles\n   * @param particleCount  Number of particles to emit right now\n   */\n  public emitParticles(particleCount: number) {\n    for (let i = 0; i < particleCount; i++) {\n      const p = this._createParticle();\n      this.particles.push(p);\n      if (this?.scene?.world) {\n        this.scene.world.add(p);\n      }\n    }\n  }\n\n  public clearParticles() {\n    this.particles.length = 0;\n  }\n\n  // Creates a new particle given the constraints of the emitter\n  private _createParticle(): Particle {\n    // todo implement emitter constraints;\n    let ranX = 0;\n    let ranY = 0;\n\n    const angle = Util.randomInRange(this.minAngle, this.maxAngle, this.random);\n    const vel = Util.randomInRange(this.minVel, this.maxVel, this.random);\n    const size = this.startSize || Util.randomInRange(this.minSize, this.maxSize, this.random);\n    const dx = vel * Math.cos(angle);\n    const dy = vel * Math.sin(angle);\n\n    if (this.emitterType === EmitterType.Rectangle) {\n      ranX = Util.randomInRange(0, this.width, this.random);\n      ranY = Util.randomInRange(0, this.height, this.random);\n    } else if (this.emitterType === EmitterType.Circle) {\n      const radius = Util.randomInRange(0, this.radius, this.random);\n      ranX = radius * Math.cos(angle);\n      ranY = radius * Math.sin(angle);\n    }\n\n    const p = new Particle(\n      this,\n      this.particleLife,\n      this.opacity,\n      this.beginColor,\n      this.endColor,\n      new Vector(ranX, ranY),\n      new Vector(dx, dy),\n      this.acceleration,\n      this.startSize,\n      this.endSize\n    );\n    p.fadeFlag = this.fadeFlag;\n    p.particleSize = size;\n    if (this.particleSprite) {\n      p.particleSprite = this.particleSprite;\n      p.graphics.opacity = this.opacity;\n      p.graphics.use(this._sprite);\n    }\n    p.particleRotationalVelocity = this.particleRotationalVelocity;\n    if (this.randomRotation) {\n      p.currentRotation = Util.randomInRange(0, Math.PI * 2, this.random);\n    }\n    if (this.focus) {\n      p.focus = this.focus.add(new Vector(this.pos.x, this.pos.y));\n      p.focusAccel = this.focusAccel;\n    }\n    return p;\n  }\n\n  public update(engine: Engine, delta: number) {\n    super.update(engine, delta);\n\n    if (this.isEmitting) {\n      this._particlesToEmit += this.emitRate * (delta / 1000);\n      if (this._particlesToEmit > 1.0) {\n        this.emitParticles(Math.floor(this._particlesToEmit));\n        this._particlesToEmit = this._particlesToEmit - Math.floor(this._particlesToEmit);\n      }\n    }\n\n    // deferred removal\n    for (let i = 0; i < this.deadParticles.length; i++) {\n      Util.removeItemFromArray(this.deadParticles[i], this.particles);\n      if (this?.scene?.world) {\n        this.scene.world.remove(this.deadParticles[i], false);\n      }\n    }\n    this.deadParticles.length = 0;\n  }\n\n  public draw(ctx: CanvasRenderingContext2D) {\n    // todo is there a more efficient to draw\n    // possibly use a webgl offscreen canvas and shaders to do particles?\n    this.particles.forEach((p) => p.draw(ctx));\n  }\n\n  public debugDraw(ctx: CanvasRenderingContext2D) {\n    super.debugDraw(ctx);\n    ctx.fillStyle = Color.Black.toString();\n    ctx.fillText('Particles: ' + this.particles.length, this.pos.x, this.pos.y + 20);\n\n    if (this.focus) {\n      ctx.fillRect(this.focus.x + this.pos.x, this.focus.y + this.pos.y, 3, 3);\n      DrawUtil.line(ctx, Color.Yellow, this.focus.x + this.pos.x, this.focus.y + this.pos.y, this.center.x, this.center.y);\n      ctx.fillText('Focus', this.focus.x + this.pos.x, this.focus.y + this.pos.y);\n    }\n  }\n}\n","import { Vector } from '../Math/vector';\nimport { Graphic, GraphicOptions } from './Graphic';\nimport { Animation, HasTick } from './Animation';\nimport { ExcaliburGraphicsContext } from './Context/ExcaliburGraphicsContext';\nimport { BoundingBox } from '../Collision/Index';\n\nexport interface GraphicsGroupingOptions {\n  members: GraphicsGrouping[];\n}\n\nexport interface GraphicsGrouping {\n  pos: Vector;\n  graphic: Graphic;\n}\n\nexport class GraphicsGroup extends Graphic implements HasTick {\n  public members: GraphicsGrouping[] = [];\n\n  constructor(options: GraphicsGroupingOptions & GraphicOptions) {\n    super(options);\n    this.members = options.members;\n    this._updateDimensions();\n  }\n\n  public clone(): GraphicsGroup {\n    return new GraphicsGroup({\n      members: [...this.members],\n      ...this.cloneGraphicOptions()\n    });\n  }\n\n  private _updateDimensions(): BoundingBox {\n    let bb = new BoundingBox();\n    for (const { graphic, pos } of this.members) {\n      bb = graphic.localBounds.translate(pos).combine(bb);\n    }\n\n    this.width = bb.width;\n    this.height = bb.height;\n\n    return bb;\n  }\n\n  public get localBounds(): BoundingBox {\n    let bb = new BoundingBox();\n    for (const { graphic, pos } of this.members) {\n      bb = graphic.localBounds.translate(pos).combine(bb);\n    }\n    return bb;\n  }\n\n  private _isAnimationOrGroup(graphic: Graphic): graphic is Animation | GraphicsGroup {\n    return graphic instanceof Animation || graphic instanceof GraphicsGroup;\n  }\n\n  public tick(elapsedMilliseconds: number, idempotencyToken?: number) {\n    for (const member of this.members) {\n      const maybeAnimation = member.graphic;\n      if (this._isAnimationOrGroup(maybeAnimation)) {\n        maybeAnimation.tick(elapsedMilliseconds, idempotencyToken);\n      }\n    }\n  }\n\n  public reset() {\n    for (const member of this.members) {\n      const maybeAnimation = member.graphic;\n      if (this._isAnimationOrGroup(maybeAnimation)) {\n        maybeAnimation.reset();\n      }\n    }\n  }\n\n  protected _preDraw(ex: ExcaliburGraphicsContext, x: number, y: number) {\n    this._updateDimensions();\n    super._preDraw(ex, x, y);\n  }\n\n  protected _drawImage(ex: ExcaliburGraphicsContext, x: number, y: number) {\n    for (const member of this.members) {\n      ex.save();\n      ex.translate(x, y);\n      member.graphic.draw(ex, member.pos.x, member.pos.y);\n      if (this.showDebug) {\n        /* istanbul ignore next */\n        ex.debug.drawRect(0, 0, this.width, this.height);\n      }\n      ex.restore();\n    }\n  }\n}\n","import { ExcaliburGraphicsContext } from './Context/ExcaliburGraphicsContext';\nimport { Scene } from '../Scene';\nimport { GraphicsComponent } from './GraphicsComponent';\nimport { vec } from '../Math/vector';\nimport { CoordPlane, TransformComponent } from '../EntityComponentSystem/Components/TransformComponent';\nimport { Entity } from '../EntityComponentSystem/Entity';\nimport { Camera } from '../Camera';\nimport { System, SystemType, TagComponent } from '../EntityComponentSystem';\nimport { Engine } from '../Engine';\nimport { GraphicsDiagnostics } from './GraphicsDiagnostics';\nimport { EnterViewPortEvent, ExitViewPortEvent } from '../Events';\nimport { GraphicsGroup } from '.';\n\nexport class GraphicsSystem extends System<TransformComponent | GraphicsComponent> {\n  public readonly types = ['ex.transform', 'ex.graphics'] as const;\n  public readonly systemType = SystemType.Draw;\n  public priority = 0;\n  private _token = 0;\n  private _graphicsContext: ExcaliburGraphicsContext;\n  private _camera: Camera;\n  private _engine: Engine;\n\n  public initialize(scene: Scene): void {\n    this._graphicsContext = scene.engine.graphicsContext;\n    this._camera = scene.camera;\n    this._engine = scene.engine;\n  }\n\n  public sort(a: Entity, b: Entity) {\n    return a.get(TransformComponent).z - b.get(TransformComponent).z;\n  }\n\n  public update(entities: Entity[], delta: number): void {\n    this._clearScreen();\n    this._token++;\n    let transform: TransformComponent;\n    let graphics: GraphicsComponent;\n\n    for (const entity of entities) {\n      transform = entity.get(TransformComponent);\n      graphics = entity.get(GraphicsComponent);\n\n      // Figure out if entities are offscreen\n      const entityOffscreen = this._isOffscreen(transform, graphics);\n      if (entityOffscreen && !entity.hasTag('offscreen')) {\n        entity.eventDispatcher.emit('exitviewport', new ExitViewPortEvent(entity));\n        entity.addComponent(new TagComponent('offscreen'));\n      }\n\n      if (!entityOffscreen && entity.hasTag('offscreen')) {\n        entity.eventDispatcher.emit('enterviewport', new EnterViewPortEvent(entity));\n        entity.removeComponent('offscreen');\n      }\n      // Skip entities that have graphics offscreen\n      if (entityOffscreen) {\n        continue;\n      }\n\n      // This optionally sets our camera based on the entity coord plan (world vs. screen)\n      this._pushCameraTransform(transform);\n\n      this._graphicsContext.save();\n\n      // Tick any graphics state (but only once) for animations and graphics groups\n      graphics.update(delta, this._token);\n\n      // Position the entity\n      this._applyTransform(entity);\n\n      // Optionally run the onPreDraw graphics lifecycle draw\n      if (graphics.onPreDraw) {\n        graphics.onPreDraw(this._graphicsContext, delta);\n      }\n\n      this._graphicsContext.opacity = graphics.opacity * ((entity as any).opacity ?? 1);\n\n      // Draw the graphics component\n      this._drawGraphicsComponent(graphics);\n\n      // Optionally run the onPostDraw graphics lifecycle draw\n      if (graphics.onPostDraw) {\n        graphics.onPostDraw(this._graphicsContext, delta);\n      }\n\n      this._graphicsContext.restore();\n\n      // Reset the transform back to the original\n      this._popCameraTransform(transform);\n    }\n\n    this._graphicsContext.flush();\n    this._engine.stats.currFrame.graphics.drawnImages = GraphicsDiagnostics.DrawnImagesCount;\n    this._engine.stats.currFrame.graphics.drawCalls = GraphicsDiagnostics.DrawCallCount;\n  }\n\n  private _clearScreen(): void {\n    this._graphicsContext.clear();\n  }\n\n  private _isOffscreen(transform: TransformComponent, graphics: GraphicsComponent) {\n    if (transform.coordPlane === CoordPlane.World) {\n      const graphicsOffscreen = !this._camera.viewport.intersect(graphics.localBounds.transform(transform.getGlobalMatrix()));\n      return graphicsOffscreen;\n    } else {\n      // TODO sceen coordinates\n      return false;\n    }\n  }\n\n  private _drawGraphicsComponent(graphicsComponent: GraphicsComponent) {\n    if (graphicsComponent.visible) {\n      // this should be moved to the graphics system\n      for (const layer of graphicsComponent.layers.get()) {\n        for (const { graphic, options } of layer.graphics) {\n          let anchor = graphicsComponent.anchor;\n          let offset = graphicsComponent.offset;\n          if (options?.anchor) {\n            anchor = options.anchor;\n          }\n          if (options?.offset) {\n            offset = options.offset;\n          }\n          // See https://github.com/excaliburjs/Excalibur/pull/619 for discussion on this formula\n          const offsetX = -graphic.width * anchor.x + offset.x;\n          const offsetY = -graphic.height * anchor.y + offset.y;\n\n          graphic?.draw(this._graphicsContext, offsetX + layer.offset.x, offsetY + layer.offset.y);\n\n          if (this._engine?.isDebug && this._engine.debug.graphics.showBounds) {\n            const offset = vec(offsetX + layer.offset.x, offsetY + layer.offset.y);\n            if (graphic instanceof GraphicsGroup) {\n              for (const g of graphic.members) {\n                g.graphic?.localBounds.translate(offset.add(g.pos)).draw(this._graphicsContext, this._engine.debug.graphics.boundsColor);\n              }\n            } else {\n              /* istanbul ignore next */\n              graphic?.localBounds.translate(offset).draw(this._graphicsContext, this._engine.debug.graphics.boundsColor);\n            }\n          }\n        }\n      }\n    }\n  }\n\n  /**\n   * This applies the current entity transform to the graphics context\n   * @param entity\n   */\n  private _applyTransform(entity: Entity): void {\n    const ancestors = entity.getAncestors();\n    for (const ancestor of ancestors) {\n      const transform = ancestor?.get(TransformComponent);\n      if (transform) {\n        this._graphicsContext.translate(transform.pos.x, transform.pos.y);\n        this._graphicsContext.scale(transform.scale.x, transform.scale.y);\n        this._graphicsContext.rotate(transform.rotation);\n      }\n    }\n  }\n\n  /**\n   * Applies the current camera transform if in world coordinates\n   * @param transform\n   */\n  private _pushCameraTransform(transform: TransformComponent) {\n    // Establish camera offset per entity\n    if (transform.coordPlane === CoordPlane.World) {\n      this._graphicsContext.save();\n      if (this._camera) {\n        this._camera.draw(this._graphicsContext);\n      }\n    }\n  }\n\n  /**\n   * Resets the current camera transform if in world coordinates\n   * @param transform\n   */\n  private _popCameraTransform(transform: TransformComponent) {\n    if (transform.coordPlane === CoordPlane.World) {\n      // Apply camera world offset\n      this._graphicsContext.restore();\n    }\n  }\n}\n","import { Engine } from '../Engine';\nimport { Actor } from '../Actor';\nimport { Entity, System, SystemType } from '../EntityComponentSystem';\nimport { CanvasDrawComponent } from './CanvasDrawComponent';\nimport { Scene } from '../Scene';\nimport { Camera } from '../Camera';\nimport { CoordPlane, TransformComponent } from '../EntityComponentSystem/Components/TransformComponent';\nimport { GraphicsDiagnostics } from '../Graphics/GraphicsDiagnostics';\n\n/**\n * Draws anything with a transform and a \"draw\" method\n */\nexport class CanvasDrawingSystem extends System<TransformComponent | CanvasDrawComponent> {\n  public readonly types = ['ex.transform', 'ex.canvas'] as const;\n  public systemType = SystemType.Draw;\n  public priority = -1;\n\n  private _ctx: CanvasRenderingContext2D;\n  private _camera: Camera;\n  private _engine: Engine;\n\n  public initialize(scene: Scene): void {\n    this._ctx = scene.engine.ctx;\n    this._engine = scene.engine;\n    this._camera = scene.camera;\n  }\n\n  public sort(a: Entity, b: Entity) {\n    return a.get(TransformComponent).z - b.get(TransformComponent).z;\n  }\n\n  public update(entities: Entity[], delta: number) {\n    this._clearScreen();\n\n    let transform: TransformComponent;\n    let canvasdraw: CanvasDrawComponent;\n    const length = entities.length;\n    for (let i = 0; i < length; i++) {\n      if ((entities[i] as Actor).visible && !(entities[i] as Actor).isOffScreen) {\n        transform = entities[i].get(TransformComponent);\n        canvasdraw = entities[i].get(CanvasDrawComponent);\n\n        this._ctx.save();\n        this._pushCameraTransform(transform);\n\n        this._ctx.save();\n        this._applyTransform(entities[i]);\n        canvasdraw.draw(this._ctx, delta);\n        this._ctx.restore();\n\n        this._popCameraTransform(transform);\n        this._ctx.restore();\n      }\n\n      if (this._engine.isDebug) {\n        this._ctx.save();\n        this._pushCameraTransform(transform);\n        this._ctx.strokeStyle = 'yellow';\n        (entities[i] as unknown as Actor).debugDraw(this._ctx);\n        this._popCameraTransform(transform);\n        this._ctx.restore();\n      }\n    }\n    if (this._engine.isDebug) {\n      this._ctx.save();\n      this._camera.draw(this._ctx);\n      this._camera.debugDraw(this._ctx);\n      this._ctx.restore();\n    }\n\n    this._engine.stats.currFrame.graphics.drawnImages = GraphicsDiagnostics.DrawnImagesCount;\n    this._engine.stats.currFrame.graphics.drawCalls = GraphicsDiagnostics.DrawCallCount;\n  }\n\n  private _applyTransform(entity: Entity) {\n    const ancestors = entity.getAncestors();\n    for (const ancestor of ancestors) {\n      const transform = ancestor?.get(TransformComponent);\n      if (transform) {\n        this._ctx.translate(transform.pos.x, transform.pos.y);\n        this._ctx.rotate(transform.rotation);\n        this._ctx.scale(transform.scale.x, transform.scale.y);\n      }\n    }\n  }\n\n  private _clearScreen(): void {\n    this._ctx.clearRect(0, 0, this._ctx.canvas.width, this._ctx.canvas.height);\n    this._ctx.fillStyle = this._engine.backgroundColor.toString();\n    this._ctx.fillRect(0, 0, this._ctx.canvas.width, this._ctx.canvas.height);\n  }\n\n  private _pushCameraTransform(transform: TransformComponent) {\n    if (transform.coordPlane === CoordPlane.World) {\n      // Apply camera transform to place entity in world space\n      this._ctx.save();\n      if (this._camera) {\n        this._camera.draw(this._ctx);\n      }\n    }\n  }\n\n  private _popCameraTransform(transform: TransformComponent) {\n    if (transform.coordPlane === CoordPlane.World) {\n      // Restore back to screen space from world space if we were drawing an entity there\n      this._ctx.restore();\n    }\n  }\n}\n","import { Engine } from '../Engine';\nimport { Scene } from '../Scene';\nimport { Camera } from '../Camera';\nimport { MotionComponent } from '../EntityComponentSystem/Components/MotionComponent';\nimport { ColliderComponent } from '../Collision/ColliderComponent';\nimport { CoordPlane, Entity, TransformComponent } from '../EntityComponentSystem';\nimport { System, SystemType } from '../EntityComponentSystem/System';\nimport { ExcaliburGraphicsContext } from '../Graphics/Context/ExcaliburGraphicsContext';\nimport { vec, Vector } from '../Math/vector';\nimport { BodyComponent, CollisionSystem, CompositeCollider, GraphicsComponent, Particle, Util } from '..';\n\nexport class DebugSystem extends System<TransformComponent> {\n  public readonly types = ['ex.transform'] as const;\n  public readonly systemType = SystemType.Draw;\n  public priority = 999; // lowest priority\n  private _graphicsContext: ExcaliburGraphicsContext;\n  private _collisionSystem: CollisionSystem;\n  private _camera: Camera;\n  private _engine: Engine;\n\n  public initialize(scene: Scene): void {\n    this._graphicsContext = scene.engine.graphicsContext;\n    this._camera = scene.camera;\n    this._engine = scene.engine;\n    this._collisionSystem = scene.world.systemManager.get(CollisionSystem);\n  }\n\n  update(entities: Entity[], _delta: number): void {\n    if (!this._engine.isDebug) {\n      return;\n    }\n\n    const filterSettings = this._engine.debug.filter;\n\n    let id: number;\n    let name: string;\n    const entitySettings = this._engine.debug.entity;\n\n    let tx: TransformComponent;\n    const txSettings = this._engine.debug.transform;\n\n    let motion: MotionComponent;\n    const motionSettings = this._engine.debug.motion;\n\n    let colliderComp: ColliderComponent;\n    const colliderSettings = this._engine.debug.collider;\n\n    const physicsSettings = this._engine.debug.physics;\n\n    let graphics: GraphicsComponent;\n    const graphicsSettings = this._engine.debug.graphics;\n\n    let body: BodyComponent;\n    const bodySettings = this._engine.debug.body;\n\n    const cameraSettings = this._engine.debug.camera;\n    for (const entity of entities) {\n      if (entity.hasTag('offscreen')) {\n        // skip offscreen entities\n        continue;\n      }\n      if (entity instanceof Particle) {\n        // Particles crush the renderer :(\n        continue;\n      }\n      if (filterSettings.useFilter) {\n        const allIds = filterSettings.ids.length === 0;\n        const idMatch = allIds || filterSettings.ids.includes(entity.id);\n        if (!idMatch) {\n          continue;\n        }\n        const allNames = filterSettings.nameQuery === '';\n        const nameMatch = allNames || entity.name.includes(filterSettings.nameQuery);\n        if (!nameMatch) {\n          continue;\n        }\n      }\n\n      let cursor = Vector.Zero;\n      const lineHeight = vec(0, 16);\n      id = entity.id;\n      name = entity.name;\n      tx = entity.get(TransformComponent);\n\n      // This optionally sets our camera based on the entity coord plan (world vs. screen)\n      this._pushCameraTransform(tx);\n\n      this._graphicsContext.save();\n\n      this._applyTransform(entity);\n      if (tx) {\n        if (txSettings.showAll || txSettings.showPosition) {\n          this._graphicsContext.debug.drawPoint(Vector.Zero, { size: 2, color: txSettings.positionColor });\n          this._graphicsContext.debug.drawText(`pos${tx.pos.toString(2)}`, cursor);\n          cursor = cursor.add(lineHeight);\n        }\n\n        if (entitySettings.showAll || entitySettings.showId) {\n          this._graphicsContext.debug.drawText(`id(${id}) ${tx.parent ? 'child of id(' + tx.parent?.owner?.id + ')' : ''}`, cursor);\n          cursor = cursor.add(lineHeight);\n        }\n\n        if (entitySettings.showAll || entitySettings.showName) {\n          this._graphicsContext.debug.drawText(`name(${name})`, cursor);\n          cursor = cursor.add(lineHeight);\n        }\n\n        if (txSettings.showAll || txSettings.showRotation) {\n          this._graphicsContext.drawLine(\n            Vector.Zero,\n            Vector.fromAngle(tx.rotation).scale(50).add(Vector.Zero),\n            txSettings.rotationColor,\n            2\n          );\n          this._graphicsContext.debug.drawText(`rot deg(${Util.toDegrees(tx.rotation).toFixed(2)})`, cursor);\n          cursor = cursor.add(lineHeight);\n        }\n\n        if (txSettings.showAll || txSettings.showScale) {\n          this._graphicsContext.drawLine(Vector.Zero, tx.scale.add(Vector.Zero), txSettings.scaleColor, 2);\n        }\n      }\n\n      graphics = entity.get(GraphicsComponent);\n      if (graphics) {\n        if (graphicsSettings.showAll || graphicsSettings.showBounds) {\n          const bounds = graphics.localBounds;\n          bounds.draw(this._graphicsContext, graphicsSettings.boundsColor);\n        }\n      }\n\n      body = entity.get(BodyComponent);\n      if (body) {\n        if (bodySettings.showAll || bodySettings.showCollisionGroup) {\n          this._graphicsContext.debug.drawText(`collision group(${body.group.name})`, cursor);\n          cursor = cursor.add(lineHeight);\n        }\n\n        if (bodySettings.showAll || bodySettings.showCollisionType) {\n          this._graphicsContext.debug.drawText(`collision type(${body.collisionType})`, cursor);\n          cursor = cursor.add(lineHeight);\n        }\n\n        if (bodySettings.showAll || bodySettings.showMass) {\n          this._graphicsContext.debug.drawText(`mass(${body.mass})`, cursor);\n          cursor = cursor.add(lineHeight);\n        }\n\n        if (bodySettings.showAll || bodySettings.showMotion) {\n          this._graphicsContext.debug.drawText(`motion(${body.sleepMotion})`, cursor);\n          cursor = cursor.add(lineHeight);\n        }\n\n        if (bodySettings.showAll || bodySettings.showSleeping) {\n          this._graphicsContext.debug.drawText(`sleeping(${body.canSleep ? body.sleeping: 'cant sleep'})`, cursor);\n          cursor = cursor.add(lineHeight);\n        }\n      }\n\n      this._graphicsContext.restore();\n\n      motion = entity.get(MotionComponent);\n      if (motion) {\n        if (motionSettings.showAll || motionSettings.showVelocity) {\n          this._graphicsContext.debug.drawText(`vel${motion.vel.toString(2)}`, cursor);\n          this._graphicsContext.drawLine(tx.globalPos, tx.globalPos.add(motion.vel), motionSettings.velocityColor, 2);\n          cursor = cursor.add(lineHeight);\n        }\n\n        if (motionSettings.showAll || motionSettings.showAcceleration) {\n          this._graphicsContext.drawLine(tx.globalPos, tx.globalPos.add(motion.acc), motionSettings.accelerationColor, 2);\n        }\n      }\n\n      // Colliders live in world space already so after the restore()\n      colliderComp = entity.get(ColliderComponent);\n      if (colliderComp) {\n        const collider = colliderComp.get();\n        if (colliderSettings.showAll || colliderSettings.showGeometry) {\n          collider.debug(this._graphicsContext, colliderSettings.geometryColor);\n        }\n        if (colliderSettings.showAll || colliderSettings.showBounds) {\n          if (collider instanceof CompositeCollider) {\n            const colliders = collider.getColliders();\n            for (const collider of colliders) {\n              const bounds = collider.bounds;\n              const pos = vec(bounds.left, bounds.top);\n              this._graphicsContext.debug.drawRect(pos.x, pos.y, bounds.width, bounds.height, { color: colliderSettings.boundsColor });\n              if (colliderSettings.showAll || colliderSettings.showOwner) {\n                this._graphicsContext.debug.drawText(`owner id(${collider.owner.id})`, pos);\n              }\n            }\n            colliderComp.bounds.draw(this._graphicsContext, colliderSettings.boundsColor);\n          } else {\n            const bounds = colliderComp.bounds;\n            const pos = vec(bounds.left, bounds.top);\n            this._graphicsContext.debug.drawRect(pos.x, pos.y, bounds.width, bounds.height, { color: colliderSettings.boundsColor });\n            if (colliderSettings.showAll || colliderSettings.showOwner) {\n              this._graphicsContext.debug.drawText(`owner id(${colliderComp.owner.id})`, pos);\n            }\n          }\n        }\n      }\n\n      this._popCameraTransform(tx);\n    }\n\n    this._graphicsContext.save();\n    this._camera.draw(this._graphicsContext);\n    if (physicsSettings.showAll || physicsSettings.showBroadphaseSpacePartitionDebug) {\n      this._collisionSystem.debug(this._graphicsContext);\n    }\n    if (physicsSettings.showAll || physicsSettings.showCollisionContacts || physicsSettings.showCollisionNormals) {\n      for (const [_, contact] of this._engine.debug.stats.currFrame.physics.contacts) {\n        if (physicsSettings.showAll || physicsSettings.showCollisionContacts) {\n          for (const point of contact.points) {\n            this._graphicsContext.debug.drawPoint(point, { size: 5, color: physicsSettings.collisionContactColor });\n          }\n        }\n\n        if (physicsSettings.showAll || physicsSettings.showCollisionNormals) {\n          for (const point of contact.points) {\n            this._graphicsContext.debug.drawLine(point, contact.normal.scale(30).add(point), {\n              color: physicsSettings.collisionNormalColor\n            });\n          }\n        }\n      }\n    }\n    this._graphicsContext.restore();\n\n    if (cameraSettings) {\n      this._graphicsContext.save();\n      this._camera.draw(this._graphicsContext);\n      if (cameraSettings.showAll || cameraSettings.showFocus) {\n        this._graphicsContext.drawCircle(this._camera.pos, 4, cameraSettings.focusColor);\n      }\n      if (cameraSettings.showAll || cameraSettings.showZoom) {\n        this._graphicsContext.debug.drawText(`zoom(${this._camera.zoom})`, this._camera.pos);\n      }\n      this._graphicsContext.restore();\n    }\n\n    this._graphicsContext.flush();\n  }\n\n  /**\n   * This applies the current entity transform to the graphics context\n   * @param entity\n   */\n  private _applyTransform(entity: Entity): void {\n    const ancestors = entity.getAncestors();\n    for (const ancestor of ancestors) {\n      const transform = ancestor?.get(TransformComponent);\n      if (transform) {\n        this._graphicsContext.translate(transform.pos.x, transform.pos.y);\n        this._graphicsContext.scale(transform.scale.x, transform.scale.y);\n        this._graphicsContext.rotate(transform.rotation);\n      }\n    }\n  }\n\n  /**\n   * Applies the current camera transform if in world coordinates\n   * @param transform\n   */\n  private _pushCameraTransform(transform: TransformComponent) {\n    // Establish camera offset per entity\n    if (transform.coordPlane === CoordPlane.World) {\n      this._graphicsContext.save();\n      if (this._camera) {\n        this._camera.draw(this._graphicsContext);\n      }\n    }\n  }\n\n  /**\n   * Resets the current camera transform if in world coordinates\n   * @param transform\n   */\n  private _popCameraTransform(transform: TransformComponent) {\n    if (transform.coordPlane === CoordPlane.World) {\n      // Apply camera world offset\n      this._graphicsContext.restore();\n    }\n  }\n}\n","import { Logger } from '../Util/Log';\nimport { Class } from '../Class';\nimport * as Events from '../Events';\n\n/**\n * Enum representing physical input key codes\n */\nexport enum Keys {\n  // NUMPAD\n  Num0 = 'Numpad0',\n  Num1 = 'Numpad1',\n  Num2 = 'Numpad2',\n  Num3 = 'Numpad3',\n  Num4 = 'Numpad4',\n  Num5 = 'Numpad5',\n  Num6 = 'Numpad6',\n  Num7 = 'Numpad7',\n  Num8 = 'Numpad8',\n  Num9 = 'Numpad9',\n  NumAdd = 'NumpadAdd',\n  NumSubtract = 'NumpadSubtract',\n  NumMultiply = 'NumpadMultiply',\n  NumDivide = 'NumpadDivide',\n  // NumComma = 'NumpadComma', // not x-browser\n  NumDecimal = 'NumpadDecimal',\n  Numpad0 = 'Numpad0',\n  Numpad1 = 'Numpad1',\n  Numpad2 = 'Numpad2',\n  Numpad3 = 'Numpad3',\n  Numpad4 = 'Numpad4',\n  Numpad5 = 'Numpad5',\n  Numpad6 = 'Numpad6',\n  Numpad7 = 'Numpad7',\n  Numpad8 = 'Numpad8',\n  Numpad9 = 'Numpad9',\n  NumpadAdd = 'NumpadAdd',\n  NumpadSubtract = 'NumpadSubtract',\n  NumpadMultiply = 'NumpadMultiply',\n  NumpadDivide = 'NumpadDivide',\n  // NumpadComma = 'NumpadComma', // not x-browser\n  NumpadDecimal = 'NumpadDecimal',\n\n  // MODIFIERS\n  NumLock = 'NumLock',\n  ShiftLeft = 'ShiftLeft',\n  ShiftRight = 'ShiftRight',\n  AltLeft = 'AltLeft',\n  AltRight = 'AltRight',\n\n  // NUMBERS\n  Key0 = 'Digit0',\n  Key1 = 'Digit1',\n  Key2 = 'Digit2',\n  Key3 = 'Digit3',\n  Key4 = 'Digit4',\n  Key5 = 'Digit5',\n  Key6 = 'Digit6',\n  Key7 = 'Digit7',\n  Key8 = 'Digit8',\n  Key9 = 'Digit9',\n  Digit0 = 'Digit0',\n  Digit1 = 'Digit1',\n  Digit2 = 'Digit2',\n  Digit3 = 'Digit3',\n  Digit4 = 'Digit4',\n  Digit5 = 'Digit5',\n  Digit6 = 'Digit6',\n  Digit7 = 'Digit7',\n  Digit8 = 'Digit8',\n  Digit9 = 'Digit9',\n\n  // LETTERS\n  A = 'KeyA',\n  B = 'KeyB',\n  C = 'KeyC',\n  D = 'KeyD',\n  E = 'KeyE',\n  F = 'KeyF',\n  G = 'KeyG',\n  H = 'KeyH',\n  I = 'KeyI',\n  J = 'KeyJ',\n  K = 'KeyK',\n  L = 'KeyL',\n  M = 'KeyM',\n  N = 'KeyN',\n  O = 'KeyO',\n  P = 'KeyP',\n  Q = 'KeyQ',\n  R = 'KeyR',\n  S = 'KeyS',\n  T = 'KeyT',\n  U = 'KeyU',\n  V = 'KeyV',\n  W = 'KeyW',\n  X = 'KeyX',\n  Y = 'KeyY',\n  Z = 'KeyZ',\n  KeyA = 'KeyA',\n  KeyB = 'KeyB',\n  KeyC = 'KeyC',\n  KeyD = 'KeyD',\n  KeyE = 'KeyE',\n  KeyF = 'KeyF',\n  KeyG = 'KeyG',\n  KeyH = 'KeyH',\n  KeyI = 'KeyI',\n  KeyJ = 'KeyJ',\n  KeyK = 'KeyK',\n  KeyL = 'KeyL',\n  KeyM = 'KeyM',\n  KeyN = 'KeyN',\n  KeyO = 'KeyO',\n  KeyP = 'KeyP',\n  KeyQ = 'KeyQ',\n  KeyR = 'KeyR',\n  KeyS = 'KeyS',\n  KeyT = 'KeyT',\n  KeyU = 'KeyU',\n  KeyV = 'KeyV',\n  KeyW = 'KeyW',\n  KeyX = 'KeyX',\n  KeyY = 'KeyY',\n  KeyZ = 'KeyZ',\n\n  // SYMBOLS\n  Semicolon = 'Semicolon',\n  Quote = 'Quote',\n  Comma = 'Comma',\n  Minus = 'Minus',\n  Period = 'Period',\n  Slash = 'Slash',\n  Equal = 'Equal',\n  BracketLeft = 'BracketLeft',\n  Backslash = 'Backslash',\n  BracketRight = 'BracketRight',\n  Backquote = 'Backquote',\n\n  // DIRECTIONS\n  Up = 'ArrowUp',\n  Down = 'ArrowDown',\n  Left = 'ArrowLeft',\n  Right = 'ArrowRight',\n  ArrowUp = 'ArrowUp',\n  ArrowDown = 'ArrowDown',\n  ArrowLeft = 'ArrowLeft',\n  ArrowRight = 'ArrowRight',\n\n  // OTHER\n  Space = 'Space',\n  Esc = 'Escape',\n  Escape = 'Escape'\n}\n\n/**\n * Event thrown on a game object for a key event\n */\nexport class KeyEvent extends Events.GameEvent<any> {\n  /**\n   * @param key  The key responsible for throwing the event\n   * @param value The key's typed value the browser detected\n   * @param originalEvent The original keyboard event that Excalibur handled\n   */\n  constructor(public key: Keys, public value?: string, public originalEvent?: KeyboardEvent) {\n    super();\n  }\n}\n\n/**\n * Provides keyboard support for Excalibur.\n */\nexport class Keyboard extends Class {\n  private _keys: Keys[] = [];\n  private _keysUp: Keys[] = [];\n  private _keysDown: Keys[] = [];\n\n  constructor() {\n    super();\n  }\n\n  public on(eventName: Events.press, handler: (event: KeyEvent) => void): void;\n  public on(eventName: Events.release, handler: (event: KeyEvent) => void): void;\n  public on(eventName: Events.hold, handler: (event: KeyEvent) => void): void;\n  public on(eventName: string, handler: (event: Events.GameEvent<any>) => void): void;\n  public on(eventName: string, handler: (event: any) => void): void {\n    super.on(eventName, handler);\n  }\n\n  /**\n   * Initialize Keyboard event listeners\n   */\n  init(global?: GlobalEventHandlers): void {\n    if (!global) {\n      try {\n        // Try and listen to events on top window frame if within an iframe.\n        //\n        // See https://github.com/excaliburjs/Excalibur/issues/1294\n        //\n        // Attempt to add an event listener, which triggers a DOMException on\n        // cross-origin iframes\n        const noop = () => {\n          return;\n        };\n        window.top.addEventListener('blur', noop);\n        window.top.removeEventListener('blur', noop);\n\n        // this will be the same as window if not embedded within an iframe\n        global = window.top;\n      } catch {\n        // fallback to current frame\n        global = window;\n\n        Logger.getInstance().warn(\n          'Failed to bind to keyboard events to top frame. ' +\n            'If you are trying to embed Excalibur in a cross-origin iframe, keyboard events will not fire.'\n        );\n      }\n    }\n\n    global.addEventListener('blur', () => {\n      this._keys.length = 0; // empties array efficiently\n    });\n\n    // key up is on window because canvas cannot have focus\n    global.addEventListener('keyup', (ev: KeyboardEvent) => {\n      const code = ev.code as Keys;\n      const key = this._keys.indexOf(code);\n      this._keys.splice(key, 1);\n      this._keysUp.push(code);\n      const keyEvent = new KeyEvent(code, ev.key, ev);\n\n      // alias the old api, we may want to deprecate this in the future\n      this.eventDispatcher.emit('up', keyEvent);\n      this.eventDispatcher.emit('release', keyEvent);\n    });\n\n    // key down is on window because canvas cannot have focus\n    global.addEventListener('keydown', (ev: KeyboardEvent) => {\n      const code = ev.code as Keys;\n      if (this._keys.indexOf(code) === -1) {\n        this._keys.push(code);\n        this._keysDown.push(code);\n        const keyEvent = new KeyEvent(code, ev.key, ev);\n        this.eventDispatcher.emit('down', keyEvent);\n        this.eventDispatcher.emit('press', keyEvent);\n      }\n    });\n  }\n\n  public update() {\n    // Reset keysDown and keysUp after update is complete\n    this._keysDown.length = 0;\n    this._keysUp.length = 0;\n\n    // Emit synthetic \"hold\" event\n    for (let i = 0; i < this._keys.length; i++) {\n      this.eventDispatcher.emit('hold', new KeyEvent(this._keys[i]));\n    }\n  }\n\n  /**\n   * Gets list of keys being pressed down\n   */\n  public getKeys(): Keys[] {\n    return this._keys;\n  }\n\n  /**\n   * Tests if a certain key was just pressed this frame. This is cleared at the end of the update frame.\n   * @param key Test whether a key was just pressed\n   */\n  public wasPressed(key: Keys): boolean {\n    return this._keysDown.indexOf(key) > -1;\n  }\n\n  /**\n   * Tests if a certain key is held down. This is persisted between frames.\n   * @param key  Test whether a key is held down\n   */\n  public isHeld(key: Keys): boolean {\n    return this._keys.indexOf(key) > -1;\n  }\n\n  /**\n   * Tests if a certain key was just released this frame. This is cleared at the end of the update frame.\n   * @param key  Test whether a key was just released\n   */\n  public wasReleased(key: Keys): boolean {\n    return this._keysUp.indexOf(key) > -1;\n  }\n}\n","import { Actor } from '../Actor';\nimport { Vector } from '../Math/vector';\nimport { Class } from '../Class';\nimport * as Actors from '../Util/Actors';\nimport { removeItemFromArray } from '../Util/Util';\nimport { PointerMoveEvent, PointerDownEvent, PointerUpEvent, WheelEvent } from './PointerEvents';\n\nexport interface ActorsUnderPointer {\n  [ActorId: number]: Actor;\n  length: number;\n}\n\n/**\n * The type of pointer for a [[PointerEvent]].\n */\nexport enum PointerType {\n  Touch = 'Touch',\n  Mouse = 'Mouse',\n  Pen = 'Pen',\n  Unknown = 'Unknown'\n}\n\n/**\n * Determines the scope of handling mouse/touch events. See [[Pointers]] for more information.\n */\nexport enum PointerScope {\n  /**\n   * Handle events on the `canvas` element only. Events originating outside the\n   * `canvas` will not be handled.\n   */\n  Canvas = 'Canvas',\n\n  /**\n   * Handles events on the entire document. All events will be handled by Excalibur.\n   */\n  Document = 'Document'\n}\n\n/**\n * Captures and dispatches PointerEvents\n */\nexport class Pointer extends Class {\n  private static _MAX_ID = 0;\n  public readonly id = Pointer._MAX_ID++;\n  private _isDown: boolean = false;\n  private _wasDown: boolean = false;\n\n  private _actorsUnderPointer: ActorsUnderPointer = { length: 0 };\n\n  private _actors: Actor[] = [];\n  private _actorsLastFrame: Actor[] = [];\n  private _actorsNoLongerUnderPointer: Actor[] = [];\n\n  private _actorSortingFcn = (a: Actor, b: Actor) => {\n    if (a.z === b.z) {\n      return b.id - a.id;\n    }\n    return b.z - a.z;\n  };\n\n  /**\n   * Whether the Pointer is currently dragging.\n   */\n  public get isDragging(): boolean {\n    return this._isDown;\n  }\n\n  /**\n   * Whether the Pointer just started dragging.\n   */\n  public get isDragStart(): boolean {\n    return !this._wasDown && this._isDown;\n  }\n\n  /**\n   * Whether the Pointer just ended dragging.\n   */\n  public get isDragEnd(): boolean {\n    return this._wasDown && !this._isDown;\n  }\n\n  /**\n   * Returns true if pointer has any actors under\n   */\n  public get hasActorsUnderPointer(): boolean {\n    return !!this._actorsUnderPointer.length;\n  }\n\n  /**\n   * The last position on the document this pointer was at. Can be `null` if pointer was never active.\n   */\n  public lastPagePos: Vector = null;\n\n  /**\n   * The last position on the screen this pointer was at. Can be `null` if pointer was never active.\n   */\n  public lastScreenPos: Vector = null;\n\n  /**\n   * The last position in the game world coordinates this pointer was at. Can be `null` if pointer was never active.\n   */\n  public lastWorldPos: Vector = null;\n\n  /**\n   * Returns the currently dragging target or null if it isn't exist\n   */\n  public dragTarget: Actor = null;\n\n  constructor() {\n    super();\n\n    this.on('move', this._onPointerMove);\n    this.on('down', this._onPointerDown);\n    this.on('up', this._onPointerUp);\n  }\n\n  on(event: 'move', handler: (event: PointerMoveEvent) => void): void;\n  on(event: 'down', handler: (event: PointerDownEvent) => void): void;\n  on(event: 'up', handler: (event: PointerUpEvent) => void): void;\n  on(event: 'wheel', handler: (event: WheelEvent) => void): void;\n  on(event: string, handler: (event: any) => void): void {\n    super.on(event, handler);\n  }\n\n  once(event: 'move', handler: (event: PointerMoveEvent) => void): void;\n  once(event: 'down', handler: (event: PointerDownEvent) => void): void;\n  once(event: 'up', handler: (event: PointerUpEvent) => void): void;\n  once(event: 'wheel', handler: (event: WheelEvent) => void): void;\n  once(event: string, handler: (event: any) => void): void {\n    super.once(event, handler);\n  }\n\n  off(event: 'move', handler?: (event: PointerMoveEvent) => void): void;\n  off(event: 'down', handler?: (event: PointerDownEvent) => void): void;\n  off(event: 'up', handler?: (event: PointerUpEvent) => void): void;\n  off(event: 'wheel', handler?: (event: WheelEvent) => void): void;\n  off(event: string, handler?: (event: any) => void): void {\n    super.off(event, handler);\n  }\n\n  /**\n   * Update the state of current pointer, meant to be called a the end of frame\n   */\n  public update(): void {\n    if (this._wasDown && !this._isDown) {\n      this._wasDown = false;\n    } else if (!this._wasDown && this._isDown) {\n      this._wasDown = true;\n    }\n    this._actorsLastFrame = [...this._actors];\n    this._actorsNoLongerUnderPointer = [];\n  }\n\n  /**\n   * Adds an Actor to actorsUnderPointer object.\n   * @param actor An Actor to be added;\n   */\n  public addActorUnderPointer(actor: Actor): void {\n    if (!this.isActorAliveUnderPointer(actor)) {\n      this._actorsUnderPointer[actor.id] = actor;\n      this._actorsUnderPointer.length += 1;\n      this._actors.push(actor);\n    }\n\n    // Actors are processed in z-order highest z to lowest\n    // ties are broken by id highest id (newest) to lowest id (oldest)\n    this._actors.sort(this._actorSortingFcn);\n  }\n\n  /**\n   * Removes an Actor from actorsUnderPointer object.\n   * @param actor An Actor to be removed;\n   */\n  public removeActorUnderPointer(actor: Actor): void {\n    if (this.isActorAliveUnderPointer(actor)) {\n      delete this._actorsUnderPointer[actor.id];\n      this._actorsUnderPointer.length -= 1;\n      removeItemFromArray(actor, this._actors);\n      this._actorsNoLongerUnderPointer.push(actor);\n    }\n  }\n\n  /**\n   * Returns all actors under this pointer this frame\n   */\n  public getActorsUnderPointer(): Actor[] {\n    return this._actors;\n  }\n\n  /**\n   * Returns all actors that are no longer under the pointer this frame\n   */\n  public getActorsUnderPointerLastFrame(): Actor[] {\n    return this._actorsLastFrame;\n  }\n\n  /**\n   * Returns all actors relevant for events to pointer this frame\n   */\n  public getActorsForEvents(): Actor[] {\n    return this._actors\n      .concat(this._actorsLastFrame)\n      .filter((actor, i, self) => {\n        return self.indexOf(actor) === i; // de-dup\n      })\n      .sort(this._actorSortingFcn); // sort by z\n  }\n\n  /**\n   * Checks if Pointer location has a specific Actor bounds contained underneath.\n   * @param actor An Actor for check;\n   */\n  public checkActorUnderPointer(actor: Actor): boolean {\n    if (this.lastWorldPos) {\n      return actor.contains(this.lastWorldPos.x, this.lastWorldPos.y, !Actors.isScreenElement(actor));\n    }\n    return false;\n  }\n\n  /**\n   * Checks if an actor was under the pointer last frame\n   * @param actor\n   */\n  public wasActorUnderPointer(actor: Actor): boolean {\n    return this._actorsLastFrame.indexOf(actor) > -1;\n  }\n\n  /**\n   * Checks if Pointer has a specific Actor in ActorsUnderPointer list.\n   * @param actor An Actor for check;\n   */\n  public isActorAliveUnderPointer(actor: Actor): boolean {\n    return !!(!actor.isKilled() && actor.scene && this._actorsUnderPointer.hasOwnProperty(actor.id.toString()));\n  }\n\n  private _onPointerMove(ev: PointerMoveEvent): void {\n    this.lastPagePos = new Vector(ev.pagePos.x, ev.pagePos.y);\n    this.lastScreenPos = new Vector(ev.screenPos.x, ev.screenPos.y);\n    this.lastWorldPos = new Vector(ev.worldPos.x, ev.worldPos.y);\n  }\n\n  private _onPointerDown(ev: PointerDownEvent): void {\n    this.lastPagePos = new Vector(ev.pagePos.x, ev.pagePos.y);\n    this.lastScreenPos = new Vector(ev.screenPos.x, ev.screenPos.y);\n    this.lastWorldPos = new Vector(ev.worldPos.x, ev.worldPos.y);\n    this._isDown = true;\n  }\n\n  private _onPointerUp(_ev: PointerUpEvent): void {\n    this._isDown = false;\n    this.dragTarget = null;\n  }\n}\n","import { Actor } from '../Actor';\nimport { GlobalCoordinates } from '../Math/global-coordinates';\nimport { Vector } from '../Math/vector';\nimport { Pointer, PointerType } from './Pointer';\nimport { GameEvent } from '../Events';\n\n/**\n * Native browser button enumeration\n */\nexport enum NativePointerButton {\n  NoButton = -1,\n  Left = 0,\n  Middle = 1,\n  Right = 2,\n  Unknown = 3\n}\n\n/**\n * The mouse button being pressed.\n */\nexport enum PointerButton {\n  Left = 'Left',\n  Middle = 'Middle',\n  Right = 'Right',\n  Unknown = 'Unknown',\n  NoButton = 'NoButton'\n}\n\nexport enum WheelDeltaMode {\n  Pixel = 'Pixel',\n  Line = 'Line',\n  Page = 'Page'\n}\n\n/**\n * Type that indicates Excalibur's valid synthetic pointer events\n */\nexport type PointerEventName =\n  | 'pointerdragstart'\n  | 'pointerdragend'\n  | 'pointerdragmove'\n  | 'pointerdragenter'\n  | 'pointerdragleave'\n  | 'pointermove'\n  | 'pointerenter'\n  | 'pointerleave'\n  | 'pointerup'\n  | 'pointerdown';\n\n/**\n * Pointer events\n *\n * Represents a mouse, touch, or stylus event. See [[Pointers]] for more information on\n * handling pointer input.\n *\n * For mouse-based events, you can inspect [[PointerEvent.button]] to see what button was pressed.\n */\nexport class PointerEvent extends GameEvent<Actor> {\n  protected _name: string;\n\n  public get name() {\n    return this._name;\n  }\n\n  /** The world coordinates of the event. */\n  public get worldPos(): Vector {\n    return this.coordinates.worldPos.clone();\n  }\n\n  /** The page coordinates of the event. */\n  public get pagePos(): Vector {\n    return this.coordinates.pagePos.clone();\n  }\n\n  /** The screen coordinates of the event. */\n  public get screenPos(): Vector {\n    return this.coordinates.screenPos.clone();\n  }\n\n  /**\n   * @param coordinates         The [[GlobalCoordinates]] of the event\n   * @param pointer             The [[Pointer]] of the event\n   * @param index               The index of the pointer (zero-based)\n   * @param pointerType         The type of pointer\n   * @param button              The button pressed (if [[PointerType.Mouse]])\n   * @param ev                  The raw DOM event being handled\n   */\n  constructor(\n    protected coordinates: GlobalCoordinates,\n    public pointer: Pointer,\n    public index: number,\n    public pointerType: PointerType,\n    public button: PointerButton,\n    public ev: any\n  ) {\n    super();\n  }\n\n  public get pos(): Vector {\n    return this.coordinates.worldPos.clone();\n  }\n\n  public _canceled = false;\n\n  /**\n   * Cancels pointer event propogation, event will not be transmitted to any other actors\n   */\n  public cancel() {\n    this._canceled = true;\n  }\n\n  /**\n   *\n   * @returns If the event is canceled it will no longer be transmitted to any other actors\n   */\n  public isCanceled() {\n    return this._canceled;\n  }\n\n  public propagate(actor: Actor): void {\n    this.doAction(actor);\n\n    if (this.bubbles && !this.isCanceled() && actor.parent) {\n      this.propagate(actor.parent as Actor); // TODO not true\n    }\n  }\n\n  /**\n   * Action, that calls when event happens\n   */\n  public doAction(actor: Actor): void {\n    if (actor) {\n      this._onActionStart(actor);\n      actor.emit(this._name, this);\n      this._onActionEnd(actor);\n    }\n  }\n\n  protected _onActionStart(_actor?: Actor) {\n    // to be rewritten\n  }\n\n  protected _onActionEnd(_actor?: Actor) {\n    // to be rewritten\n  }\n}\n\nexport class PointerEventFactory<T extends PointerEvent> {\n  constructor(\n    protected _pointerEventType: new (\n      coordinates: GlobalCoordinates,\n      pointer: Pointer,\n      index: number,\n      pointerType: PointerType,\n      button: PointerButton,\n      ev: any\n    ) => T\n  ) {}\n\n  /**\n   * Create specific PointerEvent\n   */\n  public create(\n    coordinates: GlobalCoordinates,\n    pointer: Pointer,\n    index: number,\n    pointerType: PointerType,\n    button: PointerButton,\n    ev: any\n  ): T {\n    return new this._pointerEventType(coordinates, pointer, index, pointerType, button, ev);\n  }\n}\n\nexport class PointerDragEvent extends PointerEvent {}\n\nexport class PointerUpEvent extends PointerEvent {\n  protected _name = 'pointerup';\n\n  protected _onActionEnd(actor: Actor) {\n    const pointer = this.pointer;\n\n    if (pointer.isDragEnd && actor.capturePointer.captureDragEvents) {\n      actor.eventDispatcher.emit('pointerdragend', this);\n    }\n  }\n}\n\nexport class PointerDownEvent extends PointerEvent {\n  protected _name = 'pointerdown';\n\n  protected _onActionEnd(actor: Actor) {\n    if (this.pointer.isDragStart && actor.capturePointer.captureDragEvents) {\n      actor.eventDispatcher.emit('pointerdragstart', this);\n    }\n  }\n}\n\nexport class PointerMoveEvent extends PointerEvent {\n  protected _name = 'pointermove';\n\n  public propagate(actor: Actor): void {\n    // If the actor was under the pointer last frame, but not this one it left\n    // if (this.pointer.wasActorUnderPointer(actor) && !this.pointer.isActorUnderPointer(actor)) {\n    //   this._onActorLeave(actor);\n    //   return;\n    // }\n\n    if (this.pointer.isActorAliveUnderPointer(actor)) {\n      this.doAction(actor);\n\n      if (this.bubbles && !this.isCanceled() && actor.parent) {\n        this.propagate(actor.parent as Actor); // TODO not true\n      }\n    }\n  }\n\n  protected _onActionStart(actor: Actor) {\n    if (!actor.capturePointer.captureMoveEvents) {\n      return;\n    }\n\n    // In the case this is new\n    // if (this.pointer.checkActorUnderPointer(actor) && !this.pointer.wasActorUnderPointer(actor)) {\n    //   this._onActorEnter(actor);\n    // }\n\n    if (this.pointer.isDragging && actor.capturePointer.captureDragEvents) {\n      actor.eventDispatcher.emit('pointerdragmove', this);\n    }\n  }\n\n  // private _onActorEnter(actor: Actor) {\n  //   const pe = createPointerEventByName('enter', this.coordinates, this.pointer, this.index, this.pointerType, this.button, this.ev);\n  //   pe.propagate(actor);\n  //   this.pointer.addActorUnderPointer(actor);\n\n  //   if (this.pointer.isDragging) {\n  //     this.pointer.dragTarget = actor;\n  //   }\n  // }\n\n  // private _onActorLeave(actor: Actor) {\n  //   const pe = createPointerEventByName('leave', this.coordinates, this.pointer, this.index, this.pointerType, this.button, this.ev);\n  //   pe.propagate(actor);\n  //   this.pointer.removeActorUnderPointer(actor);\n  // }\n}\n\nexport class PointerEnterEvent extends PointerEvent {\n  protected _name = 'pointerenter';\n\n  protected _onActionStart(actor: Actor) {\n    if (!actor.capturePointer.captureMoveEvents) {\n      return;\n    }\n  }\n\n  protected _onActionEnd(actor: Actor) {\n    const pointer = this.pointer;\n\n    if (pointer.isDragging && actor.capturePointer.captureDragEvents) {\n      actor.eventDispatcher.emit('pointerdragenter', this);\n    }\n  }\n}\n\nexport class PointerLeaveEvent extends PointerEvent {\n  protected _name = 'pointerleave';\n\n  protected _onActionStart(actor: Actor) {\n    if (!actor.capturePointer.captureMoveEvents) {\n      return;\n    }\n  }\n\n  protected _onActionEnd(actor: Actor) {\n    const pointer = this.pointer;\n\n    if (pointer.isDragging && actor.capturePointer.captureDragEvents) {\n      actor.eventDispatcher.emit('pointerdragleave', this);\n    }\n  }\n}\n\nexport class PointerCancelEvent extends PointerEvent {\n  protected _name = 'pointercancel';\n}\n/**\n * Wheel Events\n *\n * Represents a mouse wheel event. See [[Pointers]] for more information on\n * handling point input.\n */\nexport class WheelEvent extends GameEvent<Actor> {\n  /**\n   * @param x            The `x` coordinate of the event (in world coordinates)\n   * @param y            The `y` coordinate of the event (in world coordinates)\n   * @param pageX        The `x` coordinate of the event (in document coordinates)\n   * @param pageY        The `y` coordinate of the event (in document coordinates)\n   * @param screenX      The `x` coordinate of the event (in screen coordinates)\n   * @param screenY      The `y` coordinate of the event (in screen coordinates)\n   * @param index        The index of the pointer (zero-based)\n   * @param deltaX       The type of pointer\n   * @param deltaY       The type of pointer\n   * @param deltaZ       The type of pointer\n   * @param deltaMode    The type of movement [[WheelDeltaMode]]\n   * @param ev           The raw DOM event being handled\n   */\n  constructor(\n    public x: number,\n    public y: number,\n    public pageX: number,\n    public pageY: number,\n    public screenX: number,\n    public screenY: number,\n    public index: number,\n    public deltaX: number,\n    public deltaY: number,\n    public deltaZ: number,\n    public deltaMode: WheelDeltaMode,\n    public ev: any\n  ) {\n    super();\n  }\n\n  private _isCanceled = false;\n\n  /**\n   * Cancels pointer event propogation, event will not be transmitted to any other actors\n   */\n  public cancel() {\n    this._isCanceled = true;\n  }\n\n  /**\n   *\n   * @returns If the event is canceled it will no longer be transmitted to any other actors\n   */\n  public isCanceled() {\n    return this._isCanceled;\n  }\n}\n\n/**\n *\n */\nexport function createPointerEventByName(\n  eventName: string,\n  coordinates: GlobalCoordinates,\n  pointer: Pointer,\n  index: number,\n  pointerType: PointerType,\n  button: PointerButton,\n  ev: any\n) {\n  let factory: PointerEventFactory<PointerEvent>;\n\n  switch (eventName) {\n    case 'up':\n      factory = new PointerEventFactory(<any>PointerUpEvent);\n      break;\n    case 'down':\n      factory = new PointerEventFactory(<any>PointerDownEvent);\n      break;\n    case 'move':\n      factory = new PointerEventFactory(<any>PointerMoveEvent);\n      break;\n    case 'cancel':\n      factory = new PointerEventFactory(<any>PointerCancelEvent);\n      break;\n    case 'enter':\n      factory = new PointerEventFactory(<any>PointerEnterEvent);\n      break;\n    case 'leave':\n      factory = new PointerEventFactory(<any>PointerLeaveEvent);\n      break;\n  }\n\n  return factory.create(coordinates, pointer, index, pointerType, button, ev);\n}\n","import { Logger } from './../Util/Log';\nimport { PostProcessor } from './PostProcessor';\nimport { Engine } from '../Engine';\n\nexport enum ColorBlindness {\n  Protanope,\n  Deuteranope,\n  Tritanope\n}\n\n/**\n * This post processor can correct colors and simulate color blindness.\n * It is possible to use this on every game, but the game's performance\n * will suffer measurably. It's better to use it as a helpful tool while developing your game.\n * Remember, the best practice is to design with color blindness in mind.\n */\nexport class ColorBlindCorrector implements PostProcessor {\n  /*eslint-disable */\n  private _vertexShader =\n    '' +\n    'attribute vec2 a_position;' +\n    'attribute vec2 a_texCoord;' +\n    'uniform vec2 u_resolution;' +\n    'varying vec2 v_texCoord;' +\n    'void main() {' +\n    // convert the rectangle from pixels to 0.0 to 1.0\n    'vec2 zeroToOne = a_position / u_resolution;' +\n    // convert from 0->1 to 0->2\n    'vec2 zeroToTwo = zeroToOne * 2.0;' +\n    // convert from 0->2 to -1->+1 (clipspace)\n    'vec2 clipSpace = zeroToTwo - 1.0;' +\n    'gl_Position = vec4(clipSpace * vec2(1, -1), 0, 1);' +\n    // pass the texCoord to the fragment shader\n    // The GPU will interpolate this value between points.\n    'v_texCoord = a_texCoord;' +\n    '}';\n\n  private _fragmentShader =\n    'precision mediump float;' +\n    // our texture\n    'uniform sampler2D u_image;' +\n    // the texCoords passed in from the vertex shader.\n    'varying vec2 v_texCoord;' +\n    // Color blind conversions\n    /*'mat3 m[9] =' +\n   '{' +\n      'mat3(1.0, 0.0, 0.0,  0.0, 1.0, 0.0,  0.0, 0.0, 1.0  ),' + // normal\n      'mat3(0.567, 0.433, 0.0,  0.558, 0.442, 0.0,  0.0, 0.242, 0.758),' + // protanopia\n      'mat3(0.817, 0.183, 0.0,  0.333, 0.667, 0.0,  0.0, 0.125,0.875),' + // protanomaly\n      'mat3(0.625, 0.375, 0.0,  0.7, 0.3, 0.0,  0.0, 0.3,0.7  ),' + // deuteranopia\n      'mat3(0.8, 0.2, 0.0,  0.258, 0.742, 0.0,  0.0, 0.142,0.858),' + // deuteranomaly\n      'mat3(0.95, 0.05, 0.0,  0.0, 0.433, 0.567,  0.0, 0.475,0.525),' + // tritanopia\n      'mat3(0.967, 0.033, 0.0,  0.0, 0.733, 0.267,  0.0, 0.183,0.817),' + // tritanomaly\n      'mat3(0.299, 0.587, 0.114,  0.299, 0.587, 0.114,  0.299, 0.587,0.114),' + // achromatopsia\n      'mat3(0.618, 0.320, 0.062,  0.163, 0.775, 0.062,  0.163, 0.320,0.516)' +  // achromatomaly\n   '};' +*/\n\n    'void main() {' +\n    'vec4 o =  texture2D(u_image, v_texCoord);' +\n    // RGB to LMS matrix conversion\n    'float L = (17.8824 * o.r) + (43.5161 * o.g) + (4.11935 * o.b);' +\n    'float M = (3.45565 * o.r) + (27.1554 * o.g) + (3.86714 * o.b);' +\n    'float S = (0.0299566 * o.r) + (0.184309 * o.g) + (1.46709 * o.b);' +\n    // Simulate color blindness\n\n    '//MODE CODE//' +\n    /* Deuteranope for testing\n      'float l = 1.0 * L + 0.0 * M + 0.0 * S;' +\n            'float m = 0.494207 * L + 0.0 * M + 1.24827 * S;' +\n            'float s = 0.0 * L + 0.0 * M + 1.0 * S;' +*/\n\n    // LMS to RGB matrix conversion\n    'vec4 error;' +\n    'error.r = (0.0809444479 * l) + (-0.130504409 * m) + (0.116721066 * s);' +\n    'error.g = (-0.0102485335 * l) + (0.0540193266 * m) + (-0.113614708 * s);' +\n    'error.b = (-0.000365296938 * l) + (-0.00412161469 * m) + (0.693511405 * s);' +\n    'error.a = 1.0;' +\n    'vec4 diff = o - error;' +\n    'vec4 correction;' +\n    'correction.r = 0.0;' +\n    'correction.g =  (diff.r * 0.7) + (diff.g * 1.0);' +\n    'correction.b =  (diff.r * 0.7) + (diff.b * 1.0);' +\n    'correction = o + correction;' +\n    'correction.a = o.a;' +\n    '//SIMULATE//' +\n    '}';\n\n  /*eslint-enable */\n  private _internalCanvas: HTMLCanvasElement;\n  private _gl: WebGLRenderingContext;\n  private _program: WebGLProgram;\n\n  constructor(public engine: Engine, public simulate: boolean = false, public colorMode: ColorBlindness = ColorBlindness.Protanope) {\n    this._internalCanvas = document.createElement('canvas');\n    this._internalCanvas.width = engine.drawWidth;\n    this._internalCanvas.height = engine.drawHeight;\n\n    // eslint-disable-next-line\n    this._gl = <WebGLRenderingContext>this._internalCanvas.getContext('webgl', { preserveDrawingBuffer: true });\n\n    this._program = this._gl.createProgram();\n    const fragmentShader = this._getShader('Fragment', this._getFragmentShaderByMode(colorMode));\n    const vertextShader = this._getShader('Vertex', this._vertexShader);\n\n    this._gl.attachShader(this._program, vertextShader);\n    this._gl.attachShader(this._program, fragmentShader);\n    this._gl.linkProgram(this._program);\n\n    if (!this._gl.getProgramParameter(this._program, this._gl.LINK_STATUS)) {\n      Logger.getInstance().error('Unable to link shader program!');\n    }\n\n    this._gl.useProgram(this._program);\n  }\n\n  private _getFragmentShaderByMode(colorMode: ColorBlindness) {\n    let code = '';\n    if (colorMode === ColorBlindness.Protanope) {\n      code =\n        'float l = 0.0 * L + 2.02344 * M + -2.52581 * S;' +\n        'float m = 0.0 * L + 1.0 * M + 0.0 * S;' +\n        'float s = 0.0 * L + 0.0 * M + 1.0 * S;';\n    } else if (colorMode === ColorBlindness.Deuteranope) {\n      code =\n        'float l = 1.0 * L + 0.0 * M + 0.0 * S;' +\n        'float m = 0.494207 * L + 0.0 * M + 1.24827 * S;' +\n        'float s = 0.0 * L + 0.0 * M + 1.0 * S;';\n    } else if (colorMode === ColorBlindness.Tritanope) {\n      code =\n        'float l = 1.0 * L + 0.0 * M + 0.0 * S;' +\n        'float m = 0.0 * L + 1.0 * M + 0.0 * S;' +\n        'float s = -0.395913 * L + 0.801109 * M + 0.0 * S;';\n    }\n\n    if (this.simulate) {\n      this._fragmentShader = this._fragmentShader.replace('//SIMULATE//', 'gl_FragColor = error.rgba;');\n    } else {\n      this._fragmentShader = this._fragmentShader.replace('//SIMULATE//', 'gl_FragColor = correction.rgba;');\n    }\n\n    return this._fragmentShader.replace('//MODE CODE//', code);\n  }\n\n  private _setRectangle(x: number, y: number, width: number, height: number) {\n    const x1 = x;\n    const x2 = x + width;\n    const y1 = y;\n    const y2 = y + height;\n    this._gl.bufferData(this._gl.ARRAY_BUFFER, new Float32Array([x1, y1, x2, y1, x1, y2, x1, y2, x2, y1, x2, y2]), this._gl.STATIC_DRAW);\n  }\n\n  private _getShader(type: string, program: string): WebGLShader {\n    let shader: WebGLShader;\n    if (type === 'Fragment') {\n      shader = this._gl.createShader(this._gl.FRAGMENT_SHADER);\n    } else if (type === 'Vertex') {\n      shader = this._gl.createShader(this._gl.VERTEX_SHADER);\n    } else {\n      Logger.getInstance().error('Error unknown shader type', type);\n    }\n\n    this._gl.shaderSource(shader, program);\n    this._gl.compileShader(shader);\n\n    if (!this._gl.getShaderParameter(shader, this._gl.COMPILE_STATUS)) {\n      Logger.getInstance().error('Unable to compile shader!', this._gl.getShaderInfoLog(shader));\n      return null;\n    }\n\n    return shader;\n  }\n\n  public process(image: ImageData, out: CanvasRenderingContext2D) {\n    // look up where the vertex data needs to go.\n    const positionLocation = this._gl.getAttribLocation(this._program, 'a_position');\n    const texCoordLocation = this._gl.getAttribLocation(this._program, 'a_texCoord');\n\n    const texCoordBuffer = this._gl.createBuffer();\n    this._gl.bindBuffer(this._gl.ARRAY_BUFFER, texCoordBuffer);\n    this._gl.bufferData(\n      this._gl.ARRAY_BUFFER,\n      new Float32Array([0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 0.0, 1.0, 1.0, 0.0, 1.0, 1.0]),\n      this._gl.STATIC_DRAW\n    );\n    this._gl.enableVertexAttribArray(texCoordLocation);\n    this._gl.vertexAttribPointer(texCoordLocation, 2, this._gl.FLOAT, false, 0, 0);\n\n    // Create a texture.\n    const texture = this._gl.createTexture();\n    this._gl.bindTexture(this._gl.TEXTURE_2D, texture);\n\n    // Set the parameters so we can render any size image.\n    this._gl.texParameteri(this._gl.TEXTURE_2D, this._gl.TEXTURE_WRAP_S, this._gl.CLAMP_TO_EDGE);\n    this._gl.texParameteri(this._gl.TEXTURE_2D, this._gl.TEXTURE_WRAP_T, this._gl.CLAMP_TO_EDGE);\n    this._gl.texParameteri(this._gl.TEXTURE_2D, this._gl.TEXTURE_MIN_FILTER, this._gl.NEAREST);\n    this._gl.texParameteri(this._gl.TEXTURE_2D, this._gl.TEXTURE_MAG_FILTER, this._gl.NEAREST);\n    // Flip the texture when unpacking into the gl context, gl reads textures in the opposite order as everything else :/\n    this._gl.pixelStorei(this._gl.UNPACK_FLIP_Y_WEBGL, 1);\n    // Upload the image into the texture.\n    this._gl.texImage2D(this._gl.TEXTURE_2D, 0, this._gl.RGBA, this._gl.RGBA, this._gl.UNSIGNED_BYTE, image);\n\n    // lookup uniforms\n    const resolutionLocation = this._gl.getUniformLocation(this._program, 'u_resolution');\n\n    // set the resolution\n    this._gl.uniform2f(resolutionLocation, this._internalCanvas.width, this._internalCanvas.height);\n\n    // Create a buffer for the position of the rectangle corners.\n    const positionBuffer = this._gl.createBuffer();\n    this._gl.bindBuffer(this._gl.ARRAY_BUFFER, positionBuffer);\n    this._gl.enableVertexAttribArray(positionLocation);\n    this._gl.vertexAttribPointer(positionLocation, 2, this._gl.FLOAT, false, 0, 0);\n\n    // Set a rectangle the same size as the image.\n    this._setRectangle(0, 0, image.width, image.height);\n\n    // Draw the rectangle.\n    this._gl.drawArrays(this._gl.TRIANGLES, 0, 6);\n\n    // Grab transformed image from internal canvas\n    const pixelData = new Uint8Array(image.width * image.height * 4);\n    this._gl.readPixels(0, 0, image.width, image.height, this._gl.RGBA, this._gl.UNSIGNED_BYTE, pixelData);\n\n    (<any>image.data).set(pixelData);\n\n    out.putImageData(image, 0, 0);\n  }\n}\n","import { Class } from './../Class';\nimport { GameEvent, GamepadConnectEvent, GamepadDisconnectEvent, GamepadButtonEvent, GamepadAxisEvent } from '../Events';\nimport * as Events from '../Events';\n\n/**\n * Excalibur leverages the HTML5 Gamepad API [where it is supported](http://caniuse.com/#feat=gamepad)\n * to provide controller support for your games.\n */\nexport class Gamepads extends Class {\n  /**\n   * Whether or not to poll for Gamepad input (default: `false`)\n   */\n  public enabled = false;\n\n  /**\n   * Whether or not Gamepad API is supported\n   */\n  public supported = !!(<any>navigator).getGamepads;\n\n  /**\n   * The minimum value an axis has to move before considering it a change\n   */\n  public static MinAxisMoveThreshold = 0.05;\n\n  private _gamePadTimeStamps = [0, 0, 0, 0];\n  private _oldPads: Gamepad[] = [];\n  private _pads: Gamepad[] = [];\n  private _initSuccess: boolean = false;\n  private _navigator: NavigatorGamepads = <any>navigator;\n  private _minimumConfiguration: GamepadConfiguration = null;\n\n  constructor() {\n    super();\n  }\n\n  public init() {\n    if (!this.supported) {\n      return;\n    }\n    if (this._initSuccess) {\n      return;\n    }\n\n    // In Chrome, this will return 4 undefined items until a button is pressed\n    // In FF, this will not return any items until a button is pressed\n    this._oldPads = this._clonePads(this._navigator.getGamepads());\n    if (this._oldPads.length && this._oldPads[0]) {\n      this._initSuccess = true;\n    }\n  }\n\n  /**\n   * Sets the minimum gamepad configuration, for example {axis: 4, buttons: 4} means\n   * this game requires at minimum 4 axis inputs and 4 buttons, this is not restrictive\n   * all other controllers with more axis or buttons are valid as well. If no minimum\n   * configuration is set all pads are valid.\n   */\n  public setMinimumGamepadConfiguration(config: GamepadConfiguration): void {\n    this._enableAndUpdate(); // if config is used, implicitly enable\n    this._minimumConfiguration = config;\n  }\n\n  /**\n   * When implicitly enabled, set the enabled flag and run an update so information is updated\n   */\n  private _enableAndUpdate() {\n    if (!this.enabled) {\n      this.enabled = true;\n      this.update();\n    }\n  }\n\n  /**\n   * Checks a navigator gamepad against the minimum configuration if present.\n   */\n  private _isGamepadValid(pad: NavigatorGamepad): boolean {\n    if (!this._minimumConfiguration) {\n      return true;\n    }\n    if (!pad) {\n      return false;\n    }\n    const axesLength = pad.axes.filter((value) => {\n      return typeof value !== undefined;\n    }).length;\n\n    const buttonLength = pad.buttons.filter((value) => {\n      return typeof value !== undefined;\n    }).length;\n    return axesLength >= this._minimumConfiguration.axis && buttonLength >= this._minimumConfiguration.buttons && pad.connected;\n  }\n\n  public on(eventName: Events.connect, handler: (event: GamepadConnectEvent) => void): void;\n  public on(eventName: Events.disconnect, handler: (event: GamepadDisconnectEvent) => void): void;\n  public on(eventName: Events.button, handler: (event: GamepadButtonEvent) => void): void;\n  public on(eventName: Events.axis, handler: (event: GamepadAxisEvent) => void): void;\n  public on(eventName: string, handler: (event: GameEvent<any>) => void): void;\n  public on(eventName: string, handler: (event: any) => void): void {\n    this._enableAndUpdate(); // implicitly enable\n    super.on(eventName, handler);\n  }\n\n  public off(eventName: string, handler?: (event: GameEvent<any>) => void) {\n    this._enableAndUpdate(); // implicitly enable\n    super.off(eventName, handler);\n  }\n\n  /**\n   * Updates Gamepad state and publishes Gamepad events\n   */\n  public update() {\n    if (!this.enabled || !this.supported) {\n      return;\n    }\n    this.init();\n\n    const gamepads = this._navigator.getGamepads();\n\n    for (let i = 0; i < gamepads.length; i++) {\n      if (!gamepads[i]) {\n        const gamepad = this.at(i);\n        // If was connected, but now isn't emit the disconnect event\n        if (gamepad.connected) {\n          this.eventDispatcher.emit('disconnect', new GamepadDisconnectEvent(i, gamepad));\n        }\n        // Reset connection status\n        gamepad.connected = false;\n        continue;\n      } else {\n        if (!this.at(i).connected && this._isGamepadValid(gamepads[i])) {\n          this.eventDispatcher.emit('connect', new GamepadConnectEvent(i, this.at(i)));\n        }\n        // Set connection status\n        this.at(i).connected = true;\n      }\n\n      // Only supported in Chrome\n      if (gamepads[i].timestamp && gamepads[i].timestamp === this._gamePadTimeStamps[i]) {\n        continue;\n      }\n\n      this._gamePadTimeStamps[i] = gamepads[i].timestamp;\n\n      // Add reference to navigator gamepad\n      this.at(i).navigatorGamepad = gamepads[i];\n\n      // Buttons\n      let b: string, bi: number, a: string, ai: number, value: number;\n\n      for (b in Buttons) {\n        bi = <any>Buttons[b];\n        if (typeof bi === 'number') {\n          if (gamepads[i].buttons[bi]) {\n            value = gamepads[i].buttons[bi].value;\n            if (value !== this._oldPads[i].getButton(bi)) {\n              if (gamepads[i].buttons[bi].pressed) {\n                this.at(i).updateButton(bi, value);\n                this.at(i).eventDispatcher.emit('button', new GamepadButtonEvent(bi, value, this.at(i)));\n              } else {\n                this.at(i).updateButton(bi, 0);\n              }\n            }\n          }\n        }\n      }\n\n      // Axes\n      for (a in Axes) {\n        ai = <any>Axes[a];\n        if (typeof ai === 'number') {\n          value = gamepads[i].axes[ai];\n          if (value !== this._oldPads[i].getAxes(ai)) {\n            this.at(i).updateAxes(ai, value);\n            this.at(i).eventDispatcher.emit('axis', new GamepadAxisEvent(ai, value, this.at(i)));\n          }\n        }\n      }\n\n      this._oldPads[i] = this._clonePad(gamepads[i]);\n    }\n  }\n\n  /**\n   * Safely retrieves a Gamepad at a specific index and creates one if it doesn't yet exist\n   */\n  public at(index: number): Gamepad {\n    this._enableAndUpdate(); // implicitly enable gamepads when at() is called\n    if (index >= this._pads.length) {\n      // Ensure there is a pad to retrieve\n      for (let i = this._pads.length - 1, max = index; i < max; i++) {\n        this._pads.push(new Gamepad());\n        this._oldPads.push(new Gamepad());\n      }\n    }\n\n    return this._pads[index];\n  }\n\n  /**\n   * Returns a list of all valid gamepads that meet the minimum configuration requirement.\n   */\n  public getValidGamepads(): Gamepad[] {\n    this._enableAndUpdate();\n    const result: Gamepad[] = [];\n    for (let i = 0; i < this._pads.length; i++) {\n      if (this._isGamepadValid(this.at(i).navigatorGamepad) && this.at(i).connected) {\n        result.push(this.at(i));\n      }\n    }\n    return result;\n  }\n\n  /**\n   * Gets the number of connected gamepads\n   */\n  public count() {\n    return this._pads.filter((p) => p.connected).length;\n  }\n\n  private _clonePads(pads: NavigatorGamepad[]): Gamepad[] {\n    const arr = [];\n    for (let i = 0, len = pads.length; i < len; i++) {\n      arr.push(this._clonePad(pads[i]));\n    }\n    return arr;\n  }\n\n  /**\n   * Fastest way to clone a known object is to do it yourself\n   */\n  private _clonePad(pad: NavigatorGamepad): Gamepad {\n    let i, len;\n    const clonedPad = new Gamepad();\n\n    if (!pad) {\n      return clonedPad;\n    }\n\n    for (i = 0, len = pad.buttons.length; i < len; i++) {\n      if (pad.buttons[i]) {\n        clonedPad.updateButton(i, pad.buttons[i].value);\n      }\n    }\n    for (i = 0, len = pad.axes.length; i < len; i++) {\n      clonedPad.updateAxes(i, pad.axes[i]);\n    }\n\n    return clonedPad;\n  }\n}\n\n/**\n * Gamepad holds state information for a connected controller. See [[Gamepads]]\n * for more information on handling controller input.\n */\nexport class Gamepad extends Class {\n  public connected = false;\n  public navigatorGamepad: NavigatorGamepad;\n  private _buttons: number[] = new Array(16);\n  private _axes: number[] = new Array(4);\n\n  constructor() {\n    super();\n\n    for (let i = 0; i < this._buttons.length; i++) {\n      this._buttons[i] = 0;\n    }\n    for (let i = 0; i < this._axes.length; i++) {\n      this._axes[i] = 0;\n    }\n  }\n\n  /**\n   * Whether or not the given button is pressed\n   * @param button     The button to query\n   * @param threshold  The threshold over which the button is considered to be pressed\n   */\n  public isButtonPressed(button: Buttons, threshold: number = 1) {\n    return this._buttons[button] >= threshold;\n  }\n\n  /**\n   * Gets the given button value between 0 and 1\n   */\n  public getButton(button: Buttons) {\n    return this._buttons[button];\n  }\n\n  /**\n   * Gets the given axis value between -1 and 1. Values below\n   * [[MinAxisMoveThreshold]] are considered 0.\n   */\n  public getAxes(axes: Axes) {\n    const value = this._axes[axes];\n\n    if (Math.abs(value) < Gamepads.MinAxisMoveThreshold) {\n      return 0;\n    } else {\n      return value;\n    }\n  }\n\n  public updateButton(buttonIndex: number, value: number) {\n    this._buttons[buttonIndex] = value;\n  }\n\n  public updateAxes(axesIndex: number, value: number) {\n    this._axes[axesIndex] = value;\n  }\n}\n\n/**\n * Gamepad Buttons enumeration\n */\nexport enum Buttons {\n  /**\n   * Face 1 button (e.g. A)\n   */\n  Face1 = 0,\n  /**\n   * Face 2 button (e.g. B)\n   */\n  Face2 = 1,\n  /**\n   * Face 3 button (e.g. X)\n   */\n  Face3 = 2,\n  /**\n   * Face 4 button (e.g. Y)\n   */\n  Face4 = 3,\n  /**\n   * Left bumper button\n   */\n  LeftBumper = 4,\n  /**\n   * Right bumper button\n   */\n  RightBumper = 5,\n  /**\n   * Left trigger button\n   */\n  LeftTrigger = 6,\n  /**\n   * Right trigger button\n   */\n  RightTrigger = 7,\n  /**\n   * Select button\n   */\n  Select = 8,\n  /**\n   * Start button\n   */\n  Start = 9,\n  /**\n   * Left analog stick press (e.g. L3)\n   */\n  LeftStick = 10,\n  /**\n   * Right analog stick press (e.g. R3)\n   */\n  RightStick = 11,\n  /**\n   * D-pad up\n   */\n  DpadUp = 12,\n  /**\n   * D-pad down\n   */\n  DpadDown = 13,\n  /**\n   * D-pad left\n   */\n  DpadLeft = 14,\n  /**\n   * D-pad right\n   */\n  DpadRight = 15\n}\n\n/**\n * Gamepad Axes enumeration\n */\nexport enum Axes {\n  /**\n   * Left analogue stick X direction\n   */\n  LeftStickX = 0,\n  /**\n   * Left analogue stick Y direction\n   */\n  LeftStickY = 1,\n  /**\n   * Right analogue stick X direction\n   */\n  RightStickX = 2,\n  /**\n   * Right analogue stick Y direction\n   */\n  RightStickY = 3\n}\n\n/**\n * @internal\n */\nexport interface NavigatorGamepads {\n  getGamepads(): NavigatorGamepad[];\n}\n\n/**\n * @internal\n */\nexport interface NavigatorGamepad {\n  axes: number[];\n  buttons: NavigatorGamepadButton[];\n  connected: boolean;\n  id: string;\n  index: number;\n  mapping: string;\n  timestamp: number;\n}\n\n/**\n * @internal\n */\nexport interface NavigatorGamepadButton {\n  pressed: boolean;\n  value: number;\n}\n\n/**\n * @internal\n */\nexport interface NavigatorGamepadEvent {\n  gamepad: NavigatorGamepad;\n}\n\n/**\n * @internal\n */\nexport interface GamepadConfiguration {\n  axis: number;\n  buttons: number;\n}\n","import { Matrix } from '../../Math/matrix';\nimport { BoundingBox } from '../../Collision/Index';\nimport { Color } from '../../Color';\nimport { Pool, Poolable } from '../../Util/Pool';\nimport { HTMLImageSource } from './ExcaliburGraphicsContext';\nimport { vec, Vector } from '../../Math/vector';\n\nexport enum DrawCommandType {\n  Image = 'image',\n  Line = 'line',\n  Rectangle = 'rectangle',\n  Circle = 'circle'\n}\n\nexport class DrawImageCommand implements Poolable {\n  _pool: Pool<this> = undefined;\n\n  public snapToPixel: boolean = true;\n  public image: HTMLImageSource;\n  public color: Color;\n  public type = DrawCommandType.Image;\n  public opacity: number = 1;\n  public width: number = 0;\n  public height: number = 0;\n  public dest: [number, number] = [0, 0]; // x, y\n  public view: [number, number, number, number] = [0, 0, 0, 0]; // sx, sy, sw, sh\n  private _geom: [number, number][] = [\n    [0, 0],\n    [0, 0],\n    [0, 0],\n    [0, 0],\n    [0, 0],\n    [0, 0]\n  ];\n  constructor();\n  constructor(image: HTMLImageSource, x: number, y: number);\n  constructor(image: HTMLImageSource, x: number, y: number, width?: number, height?: number);\n  constructor(\n    image: HTMLImageSource,\n    sx: number,\n    sy: number,\n    swidth?: number,\n    sheight?: number,\n    dx?: number,\n    dy?: number,\n    dwidth?: number,\n    dheight?: number\n  );\n  constructor(\n    image?: HTMLImageSource,\n    sx?: number,\n    sy?: number,\n    swidth?: number,\n    sheight?: number,\n    dx?: number,\n    dy?: number,\n    dwidth?: number,\n    dheight?: number\n  ) {\n    this.init(image, sx, sy, swidth, sheight, dx, dy, dwidth, dheight);\n  }\n\n  public init(\n    image?: HTMLImageSource,\n    sx?: number,\n    sy?: number,\n    swidth?: number,\n    sheight?: number,\n    dx?: number,\n    dy?: number,\n    dwidth?: number,\n    dheight?: number\n  ) {\n    this.type = DrawCommandType.Image;\n    this.image = image;\n    this.width = image?.width || swidth || 0;\n    this.height = image?.height || sheight || 0;\n    this.view = [0, 0, swidth ?? image?.width, sheight ?? image?.height];\n    this.dest = [sx, sy];\n    // If destination is specified, update view and dest\n    if (dx !== undefined && dy !== undefined && dwidth !== undefined && dheight !== undefined) {\n      this.view = [sx, sy, swidth ?? image?.width, sheight ?? image?.height];\n      this.dest = [dx, dy];\n      this.width = dwidth;\n      this.height = dheight;\n    }\n\n    let index = 0;\n    this._geom[index++] = [this.dest[0], this.dest[1]];\n    this._geom[index++] = [this.dest[0], this.dest[1] + this.height];\n    this._geom[index++] = [this.dest[0] + this.width, this.dest[1]];\n    this._geom[index++] = [this.dest[0] + this.width, this.dest[1]];\n    this._geom[index++] = [this.dest[0], this.dest[1] + this.height];\n    this._geom[index++] = [this.dest[0] + this.width, this.dest[1] + this.height];\n    if (this.snapToPixel) {\n      for (const point of this._geom) {\n        point[0] = ~~point[0];\n        point[1] = ~~point[1];\n      }\n    }\n    return this;\n  }\n\n  public initRect(color: Color, start: Vector, width: number, height: number) {\n    this.type = DrawCommandType.Rectangle;\n    this.color = color;\n    this.width = width;\n    this.height = height;\n    let index = 0;\n    this._geom[index++] = [start.x, start.y];\n    this._geom[index++] = [start.x, start.y + this.height];\n    this._geom[index++] = [start.x + this.width, start.y];\n    this._geom[index++] = [start.x + this.width, start.y];\n    this._geom[index++] = [start.x, start.y + this.height];\n    this._geom[index++] = [start.x + this.width, start.y + this.height];\n\n    if (this.snapToPixel) {\n      for (const point of this._geom) {\n        point[0] = ~~point[0];\n        point[1] = ~~point[1];\n      }\n    }\n    return this;\n  }\n\n  public initLine(color: Color, start: Vector, end: Vector, thickness: number) {\n    this.type = DrawCommandType.Line;\n    this.color = color;\n    const dir = end.sub(start).normalize();\n    const normal = dir.perpendicular();\n    const halfThick = thickness / 2;\n    const startTop = normal.scale(halfThick).add(start);\n    const startBottom = normal.scale(-halfThick).add(start);\n    const endTop = normal.scale(halfThick).add(end);\n    const endBottom = normal.scale(-halfThick).add(end);\n\n    /**\n     *    +---------------------^----------------------+\n     *    |                     | (normal)             |\n     *   (startx, starty)------------------>(endx, endy)\n     *    |                                            |\n     *    + -------------------------------------------+\n     */\n\n    let index = 0;\n    this._geom[index++] = [startTop.x, startTop.y];\n    this._geom[index++] = [endTop.x, endTop.y];\n    this._geom[index++] = [startBottom.x, startBottom.y];\n    this._geom[index++] = [startBottom.x, startBottom.y];\n    this._geom[index++] = [endTop.x, endTop.y];\n    this._geom[index++] = [endBottom.x, endBottom.y];\n\n    if (this.snapToPixel) {\n      for (const point of this._geom) {\n        point[0] = ~~point[0];\n        point[1] = ~~point[1];\n      }\n    }\n    return this;\n  }\n\n  public initCircle(pos: Vector, radius: number, color: Color) {\n    this.type = DrawCommandType.Circle;\n    this.color = color;\n    const topLeft = pos.add(vec(-radius, -radius));\n    const topRight = pos.add(vec(radius, -radius));\n    const bottomRight = pos.add(vec(radius, radius));\n    const bottomLeft = pos.add(vec(-radius, radius));\n    let index = 0;\n    this._geom[index++] = [topLeft.x, topLeft.y];\n    this._geom[index++] = [topRight.x, topRight.y];\n    this._geom[index++] = [bottomLeft.x, bottomLeft.y];\n    this._geom[index++] = [bottomLeft.x, bottomLeft.y];\n    this._geom[index++] = [topRight.x, topRight.y];\n    this._geom[index++] = [bottomRight.x, bottomRight.y];\n\n    if (this.snapToPixel) {\n      for (const point of this._geom) {\n        point[0] = ~~point[0];\n        point[1] = ~~point[1];\n      }\n    }\n    return this;\n  }\n\n  public dispose() {\n    this.image = null;\n    this.width = 0;\n    this.height = 0;\n    this.view = [0, 0, 0, 0];\n    this.dest = [0, 0];\n\n    let index = 0;\n    this._geom[index++] = [this.dest[0], this.dest[1]];\n    this._geom[index++] = [this.dest[0], this.dest[1] + this.height];\n    this._geom[index++] = [this.dest[0] + this.width, this.dest[1]];\n    this._geom[index++] = [this.dest[0] + this.width, this.dest[1]];\n    this._geom[index++] = [this.dest[0], this.dest[1] + this.height];\n    this._geom[index++] = [this.dest[0] + this.width, this.dest[1] + this.height];\n    return this;\n  }\n\n  // todo weird\n  applyTransform(transform: Matrix, opacity: number): void {\n    if (transform) {\n      for (let i = 0; i < this._geom.length; i++) {\n        this._geom[i] = transform.multv(this._geom[i]);\n        if (this.snapToPixel) {\n          this._geom[i] = [~~this._geom[i][0], ~~this._geom[i][1]];\n        }\n      }\n    }\n    this.opacity = opacity;\n  }\n\n  public get geometry() {\n    return this._geom;\n  }\n}\n\nexport class DrawRectCommand {\n  public dest: [number, number] = [0, 0];\n  public width: number = 0;\n  public height: number = 0;\n  constructor(x: number, y: number, width: number, height: number) {\n    this.dest = [x, y];\n    this.width = width;\n    this.height = height;\n  }\n}\n\nexport class DrawDebugRectCommand {\n  constructor(public bounds: BoundingBox, public color: Color) {}\n}\n","import { ScreenElement } from './ScreenElement';\nimport {\n  InitializeEvent,\n  ActivateEvent,\n  DeactivateEvent,\n  PreUpdateEvent,\n  PostUpdateEvent,\n  PreDrawEvent,\n  PostDrawEvent,\n  PreDebugDrawEvent,\n  PostDebugDrawEvent,\n  GameEvent\n} from './Events';\nimport { Logger } from './Util/Log';\nimport { Timer } from './Timer';\nimport { Engine } from './Engine';\nimport { TileMap } from './TileMap';\nimport { Camera } from './Camera';\nimport { Actor } from './Actor';\nimport { Class } from './Class';\nimport { CanInitialize, CanActivate, CanDeactivate, CanUpdate, CanDraw } from './Interfaces/LifecycleEvents';\nimport * as Util from './Util/Util';\nimport * as Events from './Events';\nimport * as ActorUtils from './Util/Actors';\nimport { Trigger } from './Trigger';\nimport { SystemType } from './EntityComponentSystem/System';\nimport { obsolete } from './Util/Decorators';\nimport { World } from './EntityComponentSystem/World';\nimport { MotionSystem } from './Collision/MotionSystem';\nimport { CollisionSystem } from './Collision/CollisionSystem';\nimport { Entity } from './EntityComponentSystem/Entity';\nimport { GraphicsSystem } from './Graphics/GraphicsSystem';\nimport { CanvasDrawingSystem } from './Drawing/CanvasDrawingSystem';\nimport { Flags, Legacy } from './Flags';\nimport { DebugSystem } from './Debug/DebugSystem';\n/**\n * [[Actor|Actors]] are composed together into groupings called Scenes in\n * Excalibur. The metaphor models the same idea behind real world\n * actors in a scene. Only actors in scenes will be updated and drawn.\n *\n * Typical usages of a scene include: levels, menus, loading screens, etc.\n */\nexport class Scene extends Class implements CanInitialize, CanActivate, CanDeactivate, CanUpdate, CanDraw {\n  private _logger: Logger = Logger.getInstance();\n  /**\n   * Gets or sets the current camera for the scene\n   */\n  public camera: Camera = new Camera();\n\n  /**\n   * The ECS world for the scene\n   */\n  public world = new World(this);\n\n  /**\n   * The actors in the current scene\n   */\n  public get actors(): Actor[] {\n    return this.world.entityManager.entities.filter((e) => {\n      return e instanceof Actor;\n    }) as Actor[];\n  }\n\n  public get entities(): Entity[] {\n    return this.world.entityManager.entities;\n  }\n\n  /**\n   * The triggers in the current scene\n   */\n  public get triggers(): Trigger[] {\n    return this.world.entityManager.entities.filter((e) => {\n      return e instanceof Trigger;\n    }) as Trigger[];\n  }\n\n  /**\n   * The [[TileMap]]s in the scene, if any\n   */\n  public get tileMaps(): TileMap[] {\n    return this.world.entityManager.entities.filter((e) => {\n      return e instanceof TileMap;\n    }) as TileMap[];\n  }\n\n  /**\n   * Access to the Excalibur engine\n   */\n  public engine: Engine;\n\n  /**\n   * The [[ScreenElement]]s in a scene, if any; these are drawn last\n   * @deprecated Use [[Scene.actors]]\n   */\n  @obsolete({\n    message: 'Will be removed in excalibur v0.26.0',\n    alternateMethod: 'ScreenElements now are normal actors with a Transform Coordinate Plane of Screen'\n  })\n  public get screenElements(): ScreenElement[] {\n    return this.actors.filter((a) => a instanceof ScreenElement) as ScreenElement[];\n  }\n\n  private _isInitialized: boolean = false;\n  private _timers: Timer[] = [];\n  private _cancelQueue: Timer[] = [];\n\n  constructor() {\n    super();\n    // TODO how to people do there own systems\n    // Initialize systems\n    this.world.add(new MotionSystem());\n    this.world.add(new CollisionSystem());\n    if (Flags.isEnabled(Legacy.LegacyDrawing)) {\n      this.world.add(new CanvasDrawingSystem());\n    } else {\n      this.world.add(new GraphicsSystem());\n    }\n    this.world.add(new DebugSystem());\n  }\n\n  public on(eventName: Events.initialize, handler: (event: InitializeEvent<Scene>) => void): void;\n  public on(eventName: Events.activate, handler: (event: ActivateEvent) => void): void;\n  public on(eventName: Events.deactivate, handler: (event: DeactivateEvent) => void): void;\n  public on(eventName: Events.preupdate, handler: (event: PreUpdateEvent<Scene>) => void): void;\n  public on(eventName: Events.postupdate, handler: (event: PostUpdateEvent<Scene>) => void): void;\n  public on(eventName: Events.predraw, handler: (event: PreDrawEvent) => void): void;\n  public on(eventName: Events.postdraw, handler: (event: PostDrawEvent) => void): void;\n  public on(eventName: Events.predebugdraw, handler: (event: PreDebugDrawEvent) => void): void;\n  public on(eventName: Events.postdebugdraw, handler: (event: PostDebugDrawEvent) => void): void;\n  public on(eventName: string, handler: (event: GameEvent<any>) => void): void;\n  public on(eventName: string, handler: (event: any) => void): void {\n    super.on(eventName, handler);\n  }\n\n  public once(eventName: Events.initialize, handler: (event: InitializeEvent<Scene>) => void): void;\n  public once(eventName: Events.activate, handler: (event: ActivateEvent) => void): void;\n  public once(eventName: Events.deactivate, handler: (event: DeactivateEvent) => void): void;\n  public once(eventName: Events.preupdate, handler: (event: PreUpdateEvent<Scene>) => void): void;\n  public once(eventName: Events.postupdate, handler: (event: PostUpdateEvent<Scene>) => void): void;\n  public once(eventName: Events.predraw, handler: (event: PreDrawEvent) => void): void;\n  public once(eventName: Events.postdraw, handler: (event: PostDrawEvent) => void): void;\n  public once(eventName: Events.predebugdraw, handler: (event: PreDebugDrawEvent) => void): void;\n  public once(eventName: Events.postdebugdraw, handler: (event: PostDebugDrawEvent) => void): void;\n  public once(eventName: string, handler: (event: GameEvent<any>) => void): void;\n  public once(eventName: string, handler: (event: any) => void): void {\n    super.once(eventName, handler);\n  }\n\n  public off(eventName: Events.initialize, handler?: (event: InitializeEvent<Scene>) => void): void;\n  public off(eventName: Events.activate, handler?: (event: ActivateEvent) => void): void;\n  public off(eventName: Events.deactivate, handler?: (event: DeactivateEvent) => void): void;\n  public off(eventName: Events.preupdate, handler?: (event: PreUpdateEvent<Scene>) => void): void;\n  public off(eventName: Events.postupdate, handler?: (event: PostUpdateEvent<Scene>) => void): void;\n  public off(eventName: Events.predraw, handler?: (event: PreDrawEvent) => void): void;\n  public off(eventName: Events.postdraw, handler?: (event: PostDrawEvent) => void): void;\n  public off(eventName: Events.predebugdraw, handler?: (event: PreDebugDrawEvent) => void): void;\n  public off(eventName: Events.postdebugdraw, handler?: (event: PostDebugDrawEvent) => void): void;\n  public off(eventName: string, handler?: (event: GameEvent<any>) => void): void;\n  public off(eventName: string, handler?: (event: any) => void): void {\n    super.off(eventName, handler);\n  }\n\n  /**\n   * This is called before the first update of the [[Scene]]. Initializes scene members like the camera. This method is meant to be\n   * overridden. This is where initialization of child actors should take place.\n   */\n  public onInitialize(_engine: Engine): void {\n    // will be overridden\n  }\n\n  /**\n   * This is called when the scene is made active and started. It is meant to be overridden,\n   * this is where you should setup any DOM UI or event handlers needed for the scene.\n   */\n  public onActivate(_oldScene: Scene, _newScene: Scene): void {\n    // will be overridden\n  }\n\n  /**\n   * This is called when the scene is made transitioned away from and stopped. It is meant to be overridden,\n   * this is where you should cleanup any DOM UI or event handlers needed for the scene.\n   */\n  public onDeactivate(_oldScene: Scene, _newScene: Scene): void {\n    // will be overridden\n  }\n\n  /**\n   * Safe to override onPreUpdate lifecycle event handler. Synonymous with `.on('preupdate', (evt) =>{...})`\n   *\n   * `onPreUpdate` is called directly before a scene is updated.\n   */\n  public onPreUpdate(_engine: Engine, _delta: number): void {\n    // will be overridden\n  }\n\n  /**\n   * Safe to override onPostUpdate lifecycle event handler. Synonymous with `.on('preupdate', (evt) =>{...})`\n   *\n   * `onPostUpdate` is called directly after a scene is updated.\n   */\n  public onPostUpdate(_engine: Engine, _delta: number): void {\n    // will be overridden\n  }\n\n  /**\n   * Safe to override onPreDraw lifecycle event handler. Synonymous with `.on('preupdate', (evt) =>{...})`\n   *\n   * `onPreDraw` is called directly before a scene is drawn.\n   */\n  public onPreDraw(_ctx: CanvasRenderingContext2D, _delta: number): void {\n    // will be overridden\n  }\n\n  /**\n   * Safe to override onPostDraw lifecycle event handler. Synonymous with `.on('preupdate', (evt) =>{...})`\n   *\n   * `onPostDraw` is called directly after a scene is drawn.\n   */\n  public onPostDraw(_ctx: CanvasRenderingContext2D, _delta: number): void {\n    // will be overridden\n  }\n\n  /**\n   * Initializes actors in the scene\n   */\n  private _initializeChildren(): void {\n    for (const child of this.entities) {\n      child._initialize(this.engine);\n    }\n  }\n\n  /**\n   * Gets whether or not the [[Scene]] has been initialized\n   */\n  public get isInitialized(): boolean {\n    return this._isInitialized;\n  }\n\n  /**\n   * It is not recommended that internal excalibur methods be overridden, do so at your own risk.\n   *\n   * Initializes the scene before the first update, meant to be called by engine not by users of\n   * Excalibur\n   * @internal\n   */\n  public _initialize(engine: Engine) {\n    if (!this.isInitialized) {\n      this.engine = engine;\n\n      // This order is important! we want to be sure any custom init that add actors\n      // fire before the actor init\n      this.onInitialize.call(this, engine);\n      this._initializeChildren();\n\n      this._logger.debug('Scene.onInitialize', this, engine);\n      this.eventDispatcher.emit('initialize', new InitializeEvent(engine, this));\n      this._isInitialized = true;\n    }\n  }\n\n  /**\n   * It is not recommended that internal excalibur methods be overridden, do so at your own risk.\n   *\n   * Activates the scene with the base behavior, then calls the overridable `onActivate` implementation.\n   * @internal\n   */\n  public _activate(oldScene: Scene, newScene: Scene): void {\n    this._logger.debug('Scene.onActivate', this);\n    this.onActivate(oldScene, newScene);\n  }\n\n  /**\n   * It is not recommended that internal excalibur methods be overridden, do so at your own risk.\n   *\n   * Deactivates the scene with the base behavior, then calls the overridable `onDeactivate` implementation.\n   * @internal\n   */\n  public _deactivate(oldScene: Scene, newScene: Scene): void {\n    this._logger.debug('Scene.onDeactivate', this);\n    this.onDeactivate(oldScene, newScene);\n  }\n\n  /**\n   * It is not recommended that internal excalibur methods be overridden, do so at your own risk.\n   *\n   * Internal _preupdate handler for [[onPreUpdate]] lifecycle event\n   * @internal\n   */\n  public _preupdate(_engine: Engine, delta: number): void {\n    this.emit('preupdate', new PreUpdateEvent(_engine, delta, this));\n    this.onPreUpdate(_engine, delta);\n  }\n\n  /**\n   *  It is not recommended that internal excalibur methods be overridden, do so at your own risk.\n   *\n   * Internal _preupdate handler for [[onPostUpdate]] lifecycle event\n   * @internal\n   */\n  public _postupdate(_engine: Engine, delta: number): void {\n    this.emit('postupdate', new PostUpdateEvent(_engine, delta, this));\n    this.onPostUpdate(_engine, delta);\n  }\n\n  /**\n   * It is not recommended that internal excalibur methods be overridden, do so at your own risk.\n   *\n   * Internal _predraw handler for [[onPreDraw]] lifecycle event\n   *\n   * @internal\n   */\n  public _predraw(_ctx: CanvasRenderingContext2D, _delta: number): void {\n    this.emit('predraw', new PreDrawEvent(_ctx, _delta, this));\n    this.onPreDraw(_ctx, _delta);\n  }\n\n  /**\n   * It is not recommended that internal excalibur methods be overridden, do so at your own risk.\n   *\n   * Internal _postdraw handler for [[onPostDraw]] lifecycle event\n   *\n   * @internal\n   */\n  public _postdraw(_ctx: CanvasRenderingContext2D, _delta: number): void {\n    this.emit('postdraw', new PostDrawEvent(_ctx, _delta, this));\n    this.onPostDraw(_ctx, _delta);\n  }\n\n  /**\n   * Updates all the actors and timers in the scene. Called by the [[Engine]].\n   * @param engine  Reference to the current Engine\n   * @param delta   The number of milliseconds since the last update\n   */\n  public update(engine: Engine, delta: number) {\n    this._preupdate(engine, delta);\n    if (this.camera) {\n      this.camera.update(engine, delta);\n    }\n    // TODO differed entity removal for timers\n    let i: number, len: number;\n    // Remove timers in the cancel queue before updating them\n    for (i = 0, len = this._cancelQueue.length; i < len; i++) {\n      this.removeTimer(this._cancelQueue[i]);\n    }\n    this._cancelQueue.length = 0;\n\n    // Cycle through timers updating timers\n    for (const timer of this._timers) {\n      timer.update(delta);\n    }\n\n    this.world.update(SystemType.Update, delta);\n\n    this._collectActorStats(engine);\n\n    engine.input.pointers.dispatchPointerEvents();\n\n    this._postupdate(engine, delta);\n  }\n\n  /**\n   * Draws all the actors in the Scene. Called by the [[Engine]].\n   * @param ctx    The current rendering context\n   * @param delta  The number of milliseconds since the last draw\n   */\n  public draw(ctx: CanvasRenderingContext2D, delta: number) {\n    this._predraw(ctx, delta);\n\n    this.world.update(SystemType.Draw, delta);\n\n    if (this.engine?.isDebug) {\n      this.debugDraw(ctx);\n    }\n    this._postdraw(ctx, delta);\n  }\n\n  /**\n   * Draws all the actors' debug information in the Scene. Called by the [[Engine]].\n   * @param ctx  The current rendering context\n   * @deprecated\n   */\n  /* istanbul ignore next */\n  public debugDraw(ctx: CanvasRenderingContext2D) {\n    this.emit('predebugdraw', new PreDebugDrawEvent(ctx, this));\n    // pass\n    this.emit('postdebugdraw', new PostDebugDrawEvent(ctx, this));\n  }\n\n  /**\n   * Checks whether an actor is contained in this scene or not\n   */\n  public contains(actor: Actor): boolean {\n    return this.actors.indexOf(actor) > -1;\n  }\n\n  /**\n   * Adds a [[Timer]] to the current [[Scene]].\n   * @param timer  The timer to add to the current [[Scene]].\n   */\n  public add(timer: Timer): void;\n\n  /**\n   * Adds a [[TileMap]] to the [[Scene]], once this is done the [[TileMap]] will be drawn and updated.\n   */\n  public add(tileMap: TileMap): void;\n\n  /**\n   * Adds a [[Trigger]] to the [[Scene]], once this is done the [[Trigger]] will listen for interactions with other actors.\n   * @param trigger\n   */\n  public add(trigger: Trigger): void;\n\n  /**\n   * Adds an actor to the scene, once this is done the [[Actor]] will be drawn and updated.\n   * @param actor  The actor to add to the current scene\n   */\n  public add(actor: Actor): void;\n\n  public add(entity: Entity): void;\n\n  /**\n   * Adds a [[ScreenElement]] to the scene.\n   * @param screenElement  The ScreenElement to add to the current scene\n   */\n  public add(screenElement: ScreenElement): void;\n  public add(entity: any): void {\n    this.emit('entityadded', { target: entity } as any);\n    this.world.add(entity);\n    entity.scene = this;\n    if (entity instanceof Timer) {\n      if (!Util.contains(this._timers, entity)) {\n        this.addTimer(entity);\n      }\n      return;\n    }\n  }\n\n  /**\n   * Removes a [[Timer]] from the current scene, it will no longer be updated.\n   * @param timer  The timer to remove to the current scene.\n   */\n  public remove(timer: Timer): void;\n\n  /**\n   * Removes a [[TileMap]] from the scene, it will no longer be drawn or updated.\n   * @param tileMap {TileMap}\n   */\n  public remove(tileMap: TileMap): void;\n\n  /**\n   * Removes an actor from the scene, it will no longer be drawn or updated.\n   * @param actor  The actor to remove from the current scene.\n   */\n  public remove(actor: Actor): void;\n\n  public remove(entity: Entity): void;\n\n  /**\n   * Removes a [[ScreenElement]] to the scene, it will no longer be drawn or updated\n   * @param screenElement  The ScreenElement to remove from the current scene\n   */\n  public remove(screenElement: ScreenElement): void;\n  public remove(entity: any): void {\n    if (entity instanceof Entity) {\n      this.emit('entityremoved', { target: entity } as any);\n      this.world.remove(entity);\n    }\n    if (entity instanceof Timer) {\n      this.removeTimer(entity);\n    }\n  }\n\n  /**\n   * Adds (any) actor to act as a piece of UI, meaning it is always positioned\n   * in screen coordinates. UI actors do not participate in collisions.\n   * @todo Should this be `ScreenElement` only?\n   * @deprecated Use [[Scene.add]]\n   */\n  @obsolete({ message: 'Will be removed in excalibur v0.26.0', alternateMethod: 'Use Scene.add' })\n  public addScreenElement(actor: Actor) {\n    this.add(actor);\n  }\n\n  /**\n   * Removes an actor as a piece of UI\n   * @deprecated Use [[Scene.remove]]\n   */\n  @obsolete({ message: 'Will be removed in excalibur v0.26.0', alternateMethod: 'Use Scene.remove' })\n  public removeScreenElement(actor: Actor) {\n    this.remove(actor);\n  }\n\n  /**\n   * Adds a [[TileMap]] to the scene, once this is done the TileMap will be drawn and updated.\n   * @deprecated Use [[Scene.add]]\n   */\n  @obsolete({ message: 'Will be removed in excalibur v0.26.0', alternateMethod: 'Use Scene.add' })\n  public addTileMap(tileMap: TileMap) {\n    this.world.add(tileMap);\n  }\n\n  /**\n   * Removes a [[TileMap]] from the scene, it will no longer be drawn or updated.\n   * @deprecated Use [[Scene.remove]]\n   */\n  @obsolete({ message: 'Will be removed in excalibur v0.26.0', alternateMethod: 'Use Scene.remove' })\n  public removeTileMap(tileMap: TileMap) {\n    this.world.remove(tileMap);\n  }\n\n  /**\n   * Adds a [[Timer]] to the scene\n   * @param timer  The timer to add\n   */\n  public addTimer(timer: Timer): Timer {\n    this._timers.push(timer);\n    timer.scene = this;\n    return timer;\n  }\n\n  /**\n   * Removes a [[Timer]] from the scene.\n   * @warning Can be dangerous, use [[cancelTimer]] instead\n   * @param timer  The timer to remove\n   */\n  public removeTimer(timer: Timer): Timer {\n    const i = this._timers.indexOf(timer);\n    if (i !== -1) {\n      this._timers.splice(i, 1);\n    }\n    return timer;\n  }\n\n  /**\n   * Cancels a [[Timer]], removing it from the scene nicely\n   * @param timer  The timer to cancel\n   */\n  public cancelTimer(timer: Timer): Timer {\n    this._cancelQueue.push(timer);\n    return timer;\n  }\n\n  /**\n   * Tests whether a [[Timer]] is active in the scene\n   */\n  public isTimerActive(timer: Timer): boolean {\n    return this._timers.indexOf(timer) > -1 && !timer.complete;\n  }\n\n  public isCurrentScene(): boolean {\n    if (this.engine) {\n      return this.engine.currentScene === this;\n    }\n    return false;\n  }\n\n  private _collectActorStats(engine: Engine) {\n    for (const _ui of this.screenElements) {\n      engine.stats.currFrame.actors.ui++;\n    }\n\n    for (const actor of this.actors) {\n      engine.stats.currFrame.actors.alive++;\n      for (const child of actor.children) {\n        if (ActorUtils.isScreenElement(child as Actor)) {\n          // TODO not true\n          engine.stats.currFrame.actors.ui++;\n        } else {\n          engine.stats.currFrame.actors.alive++;\n        }\n      }\n    }\n  }\n}\n","import { Engine } from '../Engine';\nimport { ColorBlindCorrector, ColorBlindness } from '../PostProcessing/Index';\n\nexport interface DebugFlags {\n  colorBlindMode: ColorBlindFlags;\n}\n\nexport class ColorBlindFlags {\n  private _engine: Engine;\n\n  constructor(engine: Engine) {\n    this._engine = engine;\n  }\n\n  public correct(colorBlindness: ColorBlindness) {\n    this._engine.postProcessors.push(new ColorBlindCorrector(this._engine, false, colorBlindness));\n  }\n\n  public simulate(colorBlindness: ColorBlindness) {\n    this._engine.postProcessors.push(new ColorBlindCorrector(this._engine, true, colorBlindness));\n  }\n}\n","import { DebugFlags, ColorBlindFlags } from './DebugFlags';\nimport { Engine } from '../Engine';\nimport { Color } from '../Color';\nimport { CollisionContact } from '../Collision/Detection/CollisionContact';\n\n/**\n * Debug stats containing current and previous frame statistics\n */\nexport interface DebugStats {\n  currFrame: FrameStats;\n  prevFrame: FrameStats;\n}\n\n/**\n * Represents a frame's individual statistics\n */\nexport interface FrameStatistics {\n  /**\n   * The number of the frame\n   */\n  id: number;\n\n  /**\n   * Gets the frame's delta (time since last frame scaled by [[Engine.timescale]]) (in ms)\n   */\n  delta: number;\n\n  /**\n   * Gets the frame's frames-per-second (FPS)\n   */\n  fps: number;\n\n  /**\n   * Duration statistics (in ms)\n   */\n  duration: FrameDurationStats;\n\n  /**\n   * Actor statistics\n   */\n  actors: FrameActorStats;\n\n  /**\n   * Physics statistics\n   */\n  physics: PhysicsStatistics;\n\n  /**\n   * Graphics statistics\n   */\n  graphics: GraphicsStatistics;\n}\n\n/**\n * Represents actor stats for a frame\n */\nexport interface FrameActorStats {\n  /**\n   * Gets the frame's number of actors (alive)\n   */\n  alive: number;\n\n  /**\n   * Gets the frame's number of actors (killed)\n   */\n  killed: number;\n\n  /**\n   * Gets the frame's number of remaining actors (alive - killed)\n   */\n  remaining: number;\n\n  /**\n   * Gets the frame's number of UI actors\n   */\n  ui: number;\n\n  /**\n   * Gets the frame's number of total actors (remaining + UI)\n   */\n  total: number;\n}\n\n/**\n * Represents duration stats for a frame\n */\nexport interface FrameDurationStats {\n  /**\n   * Gets the frame's total time to run the update function (in ms)\n   */\n  update: number;\n\n  /**\n   * Gets the frame's total time to run the draw function (in ms)\n   */\n  draw: number;\n\n  /**\n   * Gets the frame's total render duration (update + draw duration) (in ms)\n   */\n  total: number;\n}\n\n/**\n * Represents physics stats for the current frame\n */\nexport interface PhysicsStatistics {\n  /**\n   * Gets the number of broadphase collision pairs which\n   */\n  pairs: number;\n\n  /**\n   * Gets the number of actual collisions\n   */\n  collisions: number;\n\n  /**\n   * Copy of the current frame contacts (only updated if debug is toggled on)\n   */\n  contacts: Map<string, CollisionContact>;\n\n  /**\n   * Gets the number of fast moving bodies using raycast continuous collisions in the scene\n   */\n  fastBodies: number;\n\n  /**\n   * Gets the number of bodies that had a fast body collision resolution\n   */\n  fastBodyCollisions: number;\n\n  /**\n   * Gets the time it took to calculate the broadphase pairs\n   */\n  broadphase: number;\n\n  /**\n   * Gets the time it took to calculate the narrowphase\n   */\n  narrowphase: number;\n}\n\nexport interface GraphicsStatistics {\n  drawCalls: number;\n  drawnImages: number;\n}\n\n/**\n * Debug statistics and flags for Excalibur. If polling these values, it would be\n * best to do so on the `postupdate` event for [[Engine]], after all values have been\n * updated during a frame.\n */\nexport class Debug implements DebugFlags {\n  private _engine: Engine;\n\n  constructor(engine: Engine) {\n    this._engine = engine;\n\n    this.colorBlindMode = new ColorBlindFlags(this._engine);\n  }\n\n  /**\n   * Performance statistics\n   */\n  public stats: DebugStats = {\n    /**\n     * Current frame statistics. Engine reuses this instance, use [[FrameStats.clone]] to copy frame stats.\n     * Best accessed on [[postframe]] event. See [[FrameStats]]\n     */\n    currFrame: new FrameStats(),\n\n    /**\n     * Previous frame statistics. Engine reuses this instance, use [[FrameStats.clone]] to copy frame stats.\n     * Best accessed on [[preframe]] event. Best inspected on engine event `preframe`. See [[FrameStats]]\n     */\n    prevFrame: new FrameStats()\n  };\n\n  /**\n   * Correct or simulate color blindness using [[ColorBlindness]] post processor.\n   * @warning Will reduce FPS.\n   */\n  public colorBlindMode: ColorBlindFlags;\n\n  /**\n   * Filter debug context to named entities or entity ids\n   */\n  public filter: { useFilter: boolean; nameQuery: string; ids: number[] } = {\n    /**\n     * Toggle filter on or off (default off) must be on for DebugDraw to use filters\n     */\n    useFilter: false,\n    /**\n     * Query for entities by name, if the entity name contains `nameQuery` it will be included\n     */\n    nameQuery: '',\n    /**\n     * Query for Entity ids, if the id matches it will be included\n     */\n    ids: []\n  };\n\n  /**\n   * Entity debug settings\n   */\n  public entity = {\n    showAll: false,\n    showId: true,\n    showName: false\n  };\n\n  /**\n   * Transform component debug settings\n   */\n  public transform = {\n    showAll: false,\n\n    showPosition: false,\n    positionColor: Color.Yellow,\n\n    showScale: false,\n    scaleColor: Color.Green,\n\n    showRotation: false,\n    rotationColor: Color.Blue\n  };\n\n  /**\n   * Graphics component debug settings\n   */\n  public graphics = {\n    showAll: false,\n\n    showBounds: true,\n    boundsColor: Color.Yellow\n  };\n\n  /**\n   * Collider component debug settings\n   */\n  public collider = {\n    showAll: false,\n\n    showBounds: true,\n    boundsColor: Color.Blue,\n\n    showOwner: false,\n\n    showGeometry: true,\n    geometryColor: Color.Green\n  };\n\n  /**\n   * Physics simulation debug settings\n   */\n  public physics = {\n    showAll: false,\n\n    showBroadphaseSpacePartitionDebug: false,\n\n    showCollisionNormals: false,\n    collisionNormalColor: Color.Cyan,\n\n    showCollisionContacts: true,\n    collisionContactColor: Color.Red\n  };\n\n  /**\n   * Motion component debug settings\n   */\n  public motion = {\n    showAll: false,\n\n    showVelocity: false,\n    velocityColor: Color.Yellow,\n\n    showAcceleration: false,\n    accelerationColor: Color.Red\n  };\n\n  /**\n   * Body component debug settings\n   */\n  public body = {\n    showAll: false,\n\n    showCollisionGroup: false,\n    showCollisionType: false,\n    showSleeping: false,\n    showMotion: false,\n    showMass: false\n  };\n\n  /**\n   * Camera debug settings\n   */\n  public camera = {\n    showAll: false,\n\n    showFocus: false,\n    focusColor: Color.Red,\n\n    showZoom: false\n  };\n}\n\n/**\n * Implementation of a frame's stats. Meant to have values copied via [[FrameStats.reset]], avoid\n * creating instances of this every frame.\n */\nexport class FrameStats implements FrameStatistics {\n  private _id: number = 0;\n  private _delta: number = 0;\n  private _fps: number = 0;\n  private _actorStats: FrameActorStats = {\n    alive: 0,\n    killed: 0,\n    ui: 0,\n    get remaining() {\n      return this.alive - this.killed;\n    },\n    get total() {\n      return this.remaining + this.ui;\n    }\n  };\n  private _durationStats: FrameDurationStats = {\n    update: 0,\n    draw: 0,\n    get total() {\n      return this.update + this.draw;\n    }\n  };\n\n  private _physicsStats: PhysicsStats = new PhysicsStats();\n\n  private _graphicsStats: GraphicsStatistics = {\n    drawCalls: 0,\n    drawnImages: 0\n  };\n\n  /**\n   * Zero out values or clone other IFrameStat stats. Allows instance reuse.\n   *\n   * @param [otherStats] Optional stats to clone\n   */\n  public reset(otherStats?: FrameStatistics) {\n    if (otherStats) {\n      this.id = otherStats.id;\n      this.delta = otherStats.delta;\n      this.fps = otherStats.fps;\n      this.actors.alive = otherStats.actors.alive;\n      this.actors.killed = otherStats.actors.killed;\n      this.actors.ui = otherStats.actors.ui;\n      this.duration.update = otherStats.duration.update;\n      this.duration.draw = otherStats.duration.draw;\n      this._physicsStats.reset(otherStats.physics);\n      this.graphics.drawCalls = otherStats.graphics.drawCalls;\n      this.graphics.drawnImages = otherStats.graphics.drawnImages;\n    } else {\n      this.id = this.delta = this.fps = 0;\n      this.actors.alive = this.actors.killed = this.actors.ui = 0;\n      this.duration.update = this.duration.draw = 0;\n      this._physicsStats.reset();\n      this.graphics.drawnImages = this.graphics.drawCalls = 0;\n    }\n  }\n\n  /**\n   * Provides a clone of this instance.\n   */\n  public clone(): FrameStats {\n    const fs = new FrameStats();\n\n    fs.reset(this);\n\n    return fs;\n  }\n\n  /**\n   * Gets the frame's id\n   */\n  public get id() {\n    return this._id;\n  }\n\n  /**\n   * Sets the frame's id\n   */\n  public set id(value: number) {\n    this._id = value;\n  }\n\n  /**\n   * Gets the frame's delta (time since last frame)\n   */\n  public get delta() {\n    return this._delta;\n  }\n\n  /**\n   * Sets the frame's delta (time since last frame). Internal use only.\n   * @internal\n   */\n  public set delta(value: number) {\n    this._delta = value;\n  }\n\n  /**\n   * Gets the frame's frames-per-second (FPS)\n   */\n  public get fps() {\n    return this._fps;\n  }\n\n  /**\n   * Sets the frame's frames-per-second (FPS). Internal use only.\n   * @internal\n   */\n  public set fps(value: number) {\n    this._fps = value;\n  }\n\n  /**\n   * Gets the frame's actor statistics\n   */\n  public get actors() {\n    return this._actorStats;\n  }\n\n  /**\n   * Gets the frame's duration statistics\n   */\n  public get duration() {\n    return this._durationStats;\n  }\n\n  /**\n   * Gets the frame's physics statistics\n   */\n  public get physics() {\n    return this._physicsStats;\n  }\n\n  /**\n   * Gets the frame's graphics statistics\n   */\n  public get graphics() {\n    return this._graphicsStats;\n  }\n}\n\nexport class PhysicsStats implements PhysicsStatistics {\n  private _pairs: number = 0;\n  private _collisions: number = 0;\n  private _contacts: Map<string, CollisionContact> = new Map();\n  private _fastBodies: number = 0;\n  private _fastBodyCollisions: number = 0;\n  private _broadphase: number = 0;\n  private _narrowphase: number = 0;\n\n  /**\n   * Zero out values or clone other IPhysicsStats stats. Allows instance reuse.\n   *\n   * @param [otherStats] Optional stats to clone\n   */\n  public reset(otherStats?: PhysicsStatistics) {\n    if (otherStats) {\n      this.pairs = otherStats.pairs;\n      this.collisions = otherStats.collisions;\n      this.contacts = otherStats.contacts;\n      this.fastBodies = otherStats.fastBodies;\n      this.fastBodyCollisions = otherStats.fastBodyCollisions;\n      this.broadphase = otherStats.broadphase;\n      this.narrowphase = otherStats.narrowphase;\n    } else {\n      this.pairs = this.collisions = this.fastBodies = 0;\n      this.fastBodyCollisions = this.broadphase = this.narrowphase = 0;\n      this.contacts.clear();\n    }\n  }\n\n  /**\n   * Provides a clone of this instance.\n   */\n  public clone(): PhysicsStatistics {\n    const ps = new PhysicsStats();\n\n    ps.reset(this);\n\n    return ps;\n  }\n\n  public get pairs(): number {\n    return this._pairs;\n  }\n\n  public set pairs(value: number) {\n    this._pairs = value;\n  }\n\n  public get collisions(): number {\n    return this._collisions;\n  }\n\n  public set collisions(value: number) {\n    this._collisions = value;\n  }\n\n  public get contacts(): Map<string, CollisionContact> {\n    return this._contacts;\n  }\n\n  public set contacts(contacts: Map<string, CollisionContact>) {\n    this._contacts = contacts;\n  }\n\n  public get fastBodies(): number {\n    return this._fastBodies;\n  }\n\n  public set fastBodies(value: number) {\n    this._fastBodies = value;\n  }\n\n  public get fastBodyCollisions(): number {\n    return this._fastBodyCollisions;\n  }\n\n  public set fastBodyCollisions(value: number) {\n    this._fastBodyCollisions = value;\n  }\n\n  public get broadphase(): number {\n    return this._broadphase;\n  }\n\n  public set broadphase(value: number) {\n    this._broadphase = value;\n  }\n\n  public get narrowphase(): number {\n    return this._narrowphase;\n  }\n\n  public set narrowphase(value: number) {\n    this._narrowphase = value;\n  }\n}\n","import { Engine } from '../Engine';\nimport { Vector } from './vector';\n\nexport class GlobalCoordinates {\n  public static fromPagePosition(x: number, y: number, engine: Engine): GlobalCoordinates;\n  public static fromPagePosition(pos: Vector, engine: Engine): GlobalCoordinates;\n  public static fromPagePosition(xOrPos: number | Vector, yOrEngine: number | Engine, engineOrUndefined?: Engine): GlobalCoordinates {\n    let pageX: number;\n    let pageY: number;\n    let pagePos: Vector;\n    let engine: Engine;\n\n    if (arguments.length === 3) {\n      pageX = <number>xOrPos;\n      pageY = <number>yOrEngine;\n      pagePos = new Vector(pageX, pageY);\n      engine = engineOrUndefined;\n    } else {\n      pagePos = <Vector>xOrPos;\n      pageX = pagePos.x;\n      pageY = pagePos.y;\n      engine = <Engine>yOrEngine;\n    }\n\n    const screenPos = engine.screen.pageToScreenCoordinates(pagePos);\n    const worldPos = engine.screen.screenToWorldCoordinates(screenPos);\n\n    return new GlobalCoordinates(worldPos, pagePos, screenPos);\n  }\n\n  constructor(public worldPos: Vector, public pagePos: Vector, public screenPos: Vector) {}\n}\n","import { Class } from '../Class';\nimport { Engine, ScrollPreventionMode } from '../Engine';\nimport { Pointer, PointerType } from './Pointer';\nimport {\n  PointerEvent,\n  WheelEvent,\n  NativePointerButton,\n  PointerButton,\n  WheelDeltaMode,\n  createPointerEventByName,\n  PointerLeaveEvent,\n  PointerEnterEvent\n} from './PointerEvents';\nimport { GameEvent } from '../Events';\n\nimport * as Events from '../Events';\nimport * as Util from '../Util/Util';\nimport { vec } from '../Math/vector';\nimport { GlobalCoordinates } from '../Math/global-coordinates';\nimport { Vector } from '../Math/vector';\nimport { CapturePointer } from '../Traits/CapturePointer';\nimport { Actor } from '../Actor';\n\nexport type DOMPointerEvent = globalThis.PointerEvent;\nexport type DOMWheelEvent = globalThis.WheelEvent;\n\ninterface TouchEvent extends Event {\n  altKey: boolean;\n  changedTouches: Touch[];\n  ctrlKey: boolean;\n  metaKey: boolean;\n  shiftKey: boolean;\n  targetTouches: Touch[];\n  touches: Touch[];\n  type: string;\n  target: Element;\n}\n\ninterface Touch {\n  identifier: number;\n  screenX: number;\n  screenY: number;\n  clientX: number;\n  clientY: number;\n  pageX: number;\n  pageY: number;\n  radiusX: number;\n  radiusY: number;\n  rotationAngle: number;\n  force: number;\n  target: Element;\n}\n\n/**\n * A constant used to normalize wheel events across different browsers\n *\n * This normalization factor is pulled from https://developer.mozilla.org/en-US/docs/Web/Events/wheel#Listening_to_this_event_across_browser\n */\nconst ScrollWheelNormalizationFactor = -1 / 40;\n\n/**\n * Handles pointer events (mouse, touch, stylus, etc.) and normalizes to\n * [W3C Pointer Events](http://www.w3.org/TR/pointerevents/).\n */\nexport class Pointers extends Class {\n  private _engine: Engine;\n\n  private _pointerDown: PointerEvent[] = [];\n  private _pointerUp: PointerEvent[] = [];\n  private _pointerMove: PointerEvent[] = [];\n  private _pointerCancel: PointerEvent[] = [];\n  private _wheel: WheelEvent[] = [];\n  private _pointers: Pointer[] = [];\n  private _activePointers: number[] = [];\n\n  constructor(engine: Engine) {\n    super();\n\n    this._engine = engine;\n    this._pointers.push(new Pointer());\n    this._activePointers = [-1];\n    this.primary = this._pointers[0];\n  }\n\n  public on(eventName: Events.up, handler: (event: PointerEvent) => void): void;\n  public on(eventName: Events.down, handler: (event: PointerEvent) => void): void;\n  public on(eventName: Events.move, handler: (event: PointerEvent) => void): void;\n  public on(eventName: Events.enter, handler: (event: PointerEvent) => void): void;\n  public on(eventName: Events.leave, handler: (event: PointerEvent) => void): void;\n  public on(eventName: Events.cancel, handler: (event: PointerEvent) => void): void;\n  public on(eventName: Events.wheel, handler: (event: WheelEvent) => void): void;\n  public on(eventName: string, handler: (event: GameEvent<any>) => void): void;\n  public on(eventName: string, handler: (event: any) => void): void {\n    super.on(eventName, handler);\n  }\n\n  /**\n   * Primary pointer (mouse, 1 finger, stylus, etc.)\n   */\n  public primary: Pointer;\n\n  /**\n   * Initializes pointer event listeners\n   */\n  public init(target?: GlobalEventHandlers): void {\n    target = target || this._engine.canvas;\n\n    // Touch Events\n    target.addEventListener('touchstart', this._handleTouchEvent('down', this._pointerDown));\n    target.addEventListener('touchend', this._handleTouchEvent('up', this._pointerUp));\n    target.addEventListener('touchmove', this._handleTouchEvent('move', this._pointerMove));\n    target.addEventListener('touchcancel', this._handleTouchEvent('cancel', this._pointerCancel));\n\n    // W3C Pointer Events\n    // Current: IE11, IE10\n    if ((<any>window).PointerEvent) {\n      // IE11\n      this._engine.canvas.style.touchAction = 'none';\n      target.addEventListener('pointerdown', this._handlePointerEvent('down', this._pointerDown));\n      target.addEventListener('pointerup', this._handlePointerEvent('up', this._pointerUp));\n      target.addEventListener('pointermove', this._handlePointerEvent('move', this._pointerMove));\n      target.addEventListener('pointercancel', this._handlePointerEvent('cancel', this._pointerCancel));\n    } else if ((<any>window).MSPointerEvent) {\n      // IE10\n      (this._engine.canvas.style as any).msTouchAction = 'none';\n      target.addEventListener('MSPointerDown', this._handlePointerEvent('down', this._pointerDown));\n      target.addEventListener('MSPointerUp', this._handlePointerEvent('up', this._pointerUp));\n      target.addEventListener('MSPointerMove', this._handlePointerEvent('move', this._pointerMove));\n      target.addEventListener('MSPointerCancel', this._handlePointerEvent('cancel', this._pointerCancel));\n    } else {\n      // Mouse Events\n      target.addEventListener('mousedown', this._handleMouseEvent('down', this._pointerDown));\n      target.addEventListener('mouseup', this._handleMouseEvent('up', this._pointerUp));\n      target.addEventListener('mousemove', this._handleMouseEvent('move', this._pointerMove));\n    }\n\n    // MDN MouseWheelEvent\n    const wheelOptions = {\n      passive: !(\n        this._engine.pageScrollPreventionMode === ScrollPreventionMode.All ||\n        this._engine.pageScrollPreventionMode === ScrollPreventionMode.Canvas\n      )\n    };\n    if ('onwheel' in document.createElement('div')) {\n      // Modern Browsers\n      target.addEventListener('wheel', this._handleWheelEvent('wheel', this._wheel), wheelOptions);\n    } else if (document.onmousewheel !== undefined) {\n      // Webkit and IE\n      target.addEventListener('mousewheel', this._handleWheelEvent('wheel', this._wheel), wheelOptions);\n    } else {\n      // Remaining browser and older Firefox\n      target.addEventListener('MozMousePixelScroll', this._handleWheelEvent('wheel', this._wheel), wheelOptions);\n    }\n  }\n\n  /**\n   * Synthesize a pointer event that looks like a real browser event to excalibur\n   * @param eventName\n   * @param pos\n   */\n  public triggerEvent(\n    eventName: 'up' | 'down' | 'move' | 'cancel' | 'wheel',\n    pos: Vector | GlobalCoordinates,\n    button: NativePointerButton = NativePointerButton.Left,\n    pointerType: 'mouse' | 'touch' | 'pen' = 'mouse',\n    pointerId: number = 0\n  ): void {\n    let x = 0;\n    let y = 0;\n    let coords: GlobalCoordinates;\n    if (pos instanceof GlobalCoordinates) {\n      x = pos.pagePos.x;\n      y = pos.pagePos.y;\n      coords = pos;\n    } else {\n      x = pos.x;\n      y = pos.y;\n      coords = new GlobalCoordinates(pos.clone(), pos.clone(), pos.clone());\n    }\n\n    const eventish = {\n      pageX: x,\n      pageY: y,\n      pointerId: pointerId,\n      pointerType: pointerType,\n      button: button,\n      preventDefault: () => {\n        /* do nothing */\n      }\n    };\n\n    switch (eventName) {\n      case 'move':\n        this._handlePointerEvent(eventName, this._pointerMove, coords)(eventish as DOMPointerEvent);\n        break;\n      case 'down':\n        this._handlePointerEvent(eventName, this._pointerDown, coords)(eventish as DOMPointerEvent);\n        break;\n      case 'up':\n        this._handlePointerEvent(eventName, this._pointerUp, coords)(eventish as DOMPointerEvent);\n        break;\n      case 'cancel':\n        this._handlePointerEvent(eventName, this._pointerCancel, coords)(eventish as DOMPointerEvent);\n        break;\n    }\n    for (const actor of this._engine.currentScene.actors) {\n      const capturePointer = actor.traits.filter((t) => t instanceof CapturePointer)[0];\n      if (capturePointer) {\n        capturePointer.update(actor, this._engine, 1);\n      }\n    }\n    this.dispatchPointerEvents();\n    this.update();\n  }\n\n  /**\n   * Update all pointer events and pointers, meant to be called at the end of frame\n   */\n  public update(): void {\n    this._pointerUp.length = 0;\n    this._pointerDown.length = 0;\n    this._pointerMove.length = 0;\n    this._pointerCancel.length = 0;\n    this._wheel.length = 0;\n\n    for (let i = 0; i < this._pointers.length; i++) {\n      this._pointers[i].update();\n    }\n  }\n\n  /**\n   * Safely gets a Pointer at a specific index and initializes one if it doesn't yet exist\n   * @param index  The pointer index to retrieve\n   */\n  public at(index: number): Pointer {\n    if (index >= this._pointers.length) {\n      // Ensure there is a pointer to retrieve\n      for (let i = this._pointers.length - 1, max = index; i < max; i++) {\n        this._pointers.push(new Pointer());\n        this._activePointers.push(-1);\n      }\n    }\n\n    return this._pointers[index];\n  }\n\n  /**\n   * Get number of pointers being watched\n   */\n  public count(): number {\n    return this._pointers.length;\n  }\n\n  public checkAndUpdateActorUnderPointer(actor: Actor) {\n    for (const pointer of this._pointers) {\n      if (pointer.checkActorUnderPointer(actor)) {\n        pointer.addActorUnderPointer(actor);\n      } else {\n        pointer.removeActorUnderPointer(actor);\n      }\n    }\n  }\n\n  private _dispatchWithBubble(events: PointerEvent[]) {\n    for (const evt of events) {\n      for (const actor of evt.pointer.getActorsForEvents()) {\n        if (!evt.isCanceled()) {\n          evt.propagate(actor);\n        }\n        if (!evt.bubbles || evt.isCanceled()) {\n          // if the event stops bubbling part way stop processing\n          break;\n        }\n      }\n    }\n  }\n\n  private _dispatchPointerLeaveEvents() {\n    const lastMoveEventPerPointerPerActor: { [pointerId: string]: PointerEvent } = {};\n    const pointerLeave: PointerLeaveEvent[] = [];\n\n    for (const evt of this._pointerMove) {\n      for (const actor of evt.pointer.getActorsForEvents()) {\n        // If the actor was under the pointer last frame, but not this this frame, pointer left\n        if (\n          !lastMoveEventPerPointerPerActor[evt.pointer.id + '+' + actor.id] &&\n          evt.pointer.wasActorUnderPointer(actor) &&\n          !evt.pointer.isActorAliveUnderPointer(actor) &&\n          !evt.isCanceled()\n        ) {\n          lastMoveEventPerPointerPerActor[evt.pointer.id + '+' + actor.id] = evt;\n          const pe = createPointerEventByName(\n            'leave',\n            new GlobalCoordinates(evt.worldPos, evt.pagePos, evt.screenPos),\n            evt.pointer,\n            evt.index,\n            evt.pointerType,\n            evt.button,\n            evt.ev\n          );\n\n          pe.propagate(actor);\n          pointerLeave.push(<PointerLeaveEvent>pe);\n        }\n      }\n    }\n    return pointerLeave;\n  }\n\n  private _dispatchPointerEnterEvents() {\n    const lastMoveEventPerPointer: { [pointerId: number]: PointerEvent } = {};\n    const pointerEnter: PointerEnterEvent[] = [];\n\n    for (const evt of this._pointerMove) {\n      for (const actor of evt.pointer.getActorsForEvents()) {\n        // If the actor was not under the pointer last frame, but it is this frame, pointer entered\n        if (\n          !lastMoveEventPerPointer[evt.pointer.id] &&\n          !evt.pointer.wasActorUnderPointer(actor) &&\n          evt.pointer.isActorAliveUnderPointer(actor) &&\n          !evt.isCanceled()\n        ) {\n          lastMoveEventPerPointer[evt.pointer.id] = evt;\n          const pe = createPointerEventByName(\n            'enter',\n            new GlobalCoordinates(evt.worldPos, evt.pagePos, evt.screenPos),\n            evt.pointer,\n            evt.index,\n            evt.pointerType,\n            evt.button,\n            evt.ev\n          );\n          pe.propagate(actor);\n          pointerEnter.push(<PointerEnterEvent>pe);\n          // if pointer is dragging set the drag target\n          if (evt.pointer.isDragging) {\n            evt.pointer.dragTarget = actor;\n          }\n        }\n      }\n    }\n    return pointerEnter;\n  }\n\n  public dispatchPointerEvents() {\n    this._dispatchWithBubble(this._pointerDown);\n    this._dispatchWithBubble(this._pointerUp);\n    this._dispatchWithBubble(this._pointerMove);\n    this._dispatchPointerLeaveEvents();\n    this._dispatchPointerEnterEvents();\n    this._dispatchWithBubble(this._pointerCancel);\n\n    // TODO some duplication here\n    for (const evt of this._wheel) {\n      for (const actor of this._pointers[evt.index].getActorsUnderPointer()) {\n        this._propagateWheelPointerEvent(actor, evt);\n        if (!evt.bubbles || evt.isCanceled()) {\n          // if the event stops bubbling part way stop processing\n          break;\n        }\n      }\n    }\n  }\n\n  private _propagateWheelPointerEvent(actor: Actor, wheelEvent: WheelEvent) {\n    actor.emit('pointerwheel', wheelEvent);\n\n    // Recurse and propagate\n    if (wheelEvent.bubbles && !wheelEvent.isCanceled() && actor.parent) {\n      this._propagateWheelPointerEvent(actor.parent as Actor, wheelEvent); // TODO not true\n    }\n  }\n\n  private _handleMouseEvent(eventName: string, eventArr: PointerEvent[]) {\n    return (e: MouseEvent) => {\n      e.preventDefault();\n\n      const pointer = this.at(0);\n      const coordinates = GlobalCoordinates.fromPagePosition(e.pageX, e.pageY, this._engine);\n      const pe = createPointerEventByName(\n        eventName,\n        coordinates,\n        pointer,\n        0,\n        PointerType.Mouse,\n        this._nativeButtonToPointerButton(e.button),\n        e\n      );\n\n      eventArr.push(pe);\n      pointer.eventDispatcher.emit(eventName, pe);\n    };\n  }\n\n  private _handleTouchEvent(eventName: string, eventArr: PointerEvent[]) {\n    return (e: TouchEvent) => {\n      e.preventDefault();\n      for (let i = 0, len = e.changedTouches.length; i < len; i++) {\n        const index = this._pointers.length > 1 ? this._getPointerIndex(e.changedTouches[i].identifier) : 0;\n        if (index === -1) {\n          continue;\n        }\n\n        const pointer = this.at(index);\n        const coordinates = GlobalCoordinates.fromPagePosition(e.changedTouches[i].pageX, e.changedTouches[i].pageY, this._engine);\n        const pe = createPointerEventByName(eventName, coordinates, pointer, index, PointerType.Touch, PointerButton.Unknown, e);\n\n        eventArr.push(pe);\n        pointer.eventDispatcher.emit(eventName, pe);\n        this.emit(eventName, pe);\n        // only with multi-pointer\n        if (this._pointers.length > 1) {\n          if (eventName === 'up') {\n            // remove pointer ID from pool when pointer is lifted\n            this._activePointers[index] = -1;\n          } else if (eventName === 'down') {\n            // set pointer ID to given index\n            this._activePointers[index] = e.changedTouches[i].identifier;\n          }\n        }\n      }\n    };\n  }\n\n  private _handlePointerEvent(eventName: string, eventArr: PointerEvent[], coords?: GlobalCoordinates) {\n    return (e: DOMPointerEvent) => {\n      e.preventDefault();\n\n      // get the index for this pointer ID if multi-pointer is asked for\n      const index = this._pointers.length > 1 ? this._getPointerIndex(e.pointerId) : 0;\n      if (index === -1) {\n        return;\n      }\n\n      const pointer = this.at(index);\n      const coordinates = coords || GlobalCoordinates.fromPagePosition(e.pageX, e.pageY, this._engine);\n      const pe = createPointerEventByName(\n        eventName,\n        coordinates,\n        pointer,\n        index,\n        this._stringToPointerType(e.pointerType),\n        this._nativeButtonToPointerButton(e.button),\n        e\n      );\n\n      eventArr.push(pe);\n      pointer.eventDispatcher.emit(eventName, pe);\n      this.emit(eventName, pe);\n\n      // only with multi-pointer\n      if (this._pointers.length > 1) {\n        if (eventName === 'up') {\n          // remove pointer ID from pool when pointer is lifted\n          this._activePointers[index] = -1;\n        } else if (eventName === 'down') {\n          // set pointer ID to given index\n          this._activePointers[index] = e.pointerId;\n        }\n      }\n    };\n  }\n\n  private _handleWheelEvent(eventName: string, eventArr: WheelEvent[]) {\n    return (e: DOMWheelEvent) => {\n      // Should we prevent page scroll because of this event\n      if (\n        this._engine.pageScrollPreventionMode === ScrollPreventionMode.All ||\n        (this._engine.pageScrollPreventionMode === ScrollPreventionMode.Canvas && e.target === this._engine.canvas)\n      ) {\n        e.preventDefault();\n      }\n      const screen = this._engine.screen.pageToScreenCoordinates(vec(e.pageX, e.pageY));\n      const world = this._engine.screen.screenToWorldCoordinates(screen);\n\n      // deltaX, deltaY, and deltaZ are the standard modern properties\n      // wheelDeltaX, wheelDeltaY, are legacy properties in webkit browsers and older IE\n      // e.detail is only used in opera\n\n      const deltaX = e.deltaX || e.wheelDeltaX * ScrollWheelNormalizationFactor || 0;\n      const deltaY =\n        e.deltaY || e.wheelDeltaY * ScrollWheelNormalizationFactor || e.wheelDelta * ScrollWheelNormalizationFactor || e.detail || 0;\n      const deltaZ = e.deltaZ || 0;\n      let deltaMode = WheelDeltaMode.Pixel;\n\n      if (e.deltaMode) {\n        if (e.deltaMode === 1) {\n          deltaMode = WheelDeltaMode.Line;\n        } else if (e.deltaMode === 2) {\n          deltaMode = WheelDeltaMode.Page;\n        }\n      }\n\n      const we = new WheelEvent(world.x, world.y, e.pageX, e.pageY, screen.x, screen.y, 0, deltaX, deltaY, deltaZ, deltaMode, e);\n\n      eventArr.push(we);\n      this.at(0).eventDispatcher.emit(eventName, we);\n      this.emit(eventName, we);\n    };\n  }\n\n  /**\n   * Gets the index of the pointer specified for the given pointer ID or finds the next empty pointer slot available.\n   * This is required because IE10/11 uses incrementing pointer IDs so we need to store a mapping of ID => idx\n   */\n  private _getPointerIndex(pointerId: number) {\n    let idx;\n    if ((idx = this._activePointers.indexOf(pointerId)) > -1) {\n      return idx;\n    }\n\n    for (let i = 0; i < this._activePointers.length; i++) {\n      if (this._activePointers[i] === -1) {\n        return i;\n      }\n    }\n\n    // ignore pointer because game isn't watching\n    return -1;\n  }\n\n  private _nativeButtonToPointerButton(s: NativePointerButton): PointerButton {\n    switch (s) {\n      case NativePointerButton.NoButton:\n        return PointerButton.NoButton;\n      case NativePointerButton.Left:\n        return PointerButton.Left;\n      case NativePointerButton.Middle:\n        return PointerButton.Middle;\n      case NativePointerButton.Right:\n        return PointerButton.Right;\n      case NativePointerButton.Unknown:\n        return PointerButton.Unknown;\n      default:\n        return Util.fail(s);\n    }\n  }\n\n  private _stringToPointerType(s: string) {\n    switch (s) {\n      case 'touch':\n        return PointerType.Touch;\n      case 'mouse':\n        return PointerType.Mouse;\n      case 'pen':\n        return PointerType.Pen;\n      default:\n        return PointerType.Unknown;\n    }\n  }\n}\n","export interface NativeEventable {\n  addEventListener(name: string, handler: (...any: any[]) => any): any;\n  removeEventListener(name: string, handler: (...any: any[]) => any): any;\n}\n\nexport class BrowserComponent<T extends NativeEventable> {\n  private _paused = false;\n  private _nativeHandlers: { [key: string]: (handler: any) => void } = {};\n\n  on(eventName: string, handler: (evt: any) => void): void {\n    if (this._nativeHandlers[eventName]) {\n      this.off(eventName, this._nativeHandlers[eventName]);\n    }\n    this._nativeHandlers[eventName] = this._decorate(handler);\n    this.nativeComponent.addEventListener(eventName, this._nativeHandlers[eventName]);\n  }\n  off(eventName: string, handler?: (event: any) => void): void {\n    if (!handler) {\n      handler = this._nativeHandlers[eventName];\n    }\n    this.nativeComponent.removeEventListener(eventName, handler);\n    this._nativeHandlers[eventName] = null;\n  }\n\n  private _decorate(handler: (evt: any) => void): (evt: any) => void {\n    return (evt: any) => {\n      if (!this._paused) {\n        handler(evt);\n      }\n    };\n  }\n\n  public pause() {\n    this._paused = true;\n  }\n\n  public resume() {\n    this._paused = false;\n  }\n\n  public clear() {\n    for (const event in this._nativeHandlers) {\n      this.off(event);\n    }\n  }\n\n  constructor(public nativeComponent: T) {}\n}\n\nexport class BrowserEvents {\n  private _windowComponent: BrowserComponent<Window>;\n  private _documentComponent: BrowserComponent<Document>;\n  constructor(private _windowGlobal: Window, private _documentGlobal: Document) {\n    this._windowComponent = new BrowserComponent(this._windowGlobal);\n    this._documentComponent = new BrowserComponent(this._documentGlobal);\n  }\n\n  public get window(): BrowserComponent<Window> {\n    return this._windowComponent;\n  }\n\n  public get document(): BrowserComponent<Document> {\n    return this._documentComponent;\n  }\n\n  public pause() {\n    this.window.pause();\n    this.document.pause();\n  }\n\n  public resume() {\n    this.window.resume();\n    this.document.resume();\n  }\n\n  public clear() {\n    this.window.clear();\n    this.document.clear();\n  }\n}\n","import { ExcaliburGraphicsContextState } from './ExcaliburGraphicsContext';\n\nexport class StateStack {\n  private _states: ExcaliburGraphicsContextState[] = [];\n  private _currentState: ExcaliburGraphicsContextState = this._getDefaultState();\n\n  private _getDefaultState() {\n    return {\n      opacity: 1\n    };\n  }\n\n  private _cloneState() {\n    return {\n      opacity: this._currentState.opacity\n    };\n  }\n\n  public save(): void {\n    this._states.push(this._currentState);\n    this._currentState = this._cloneState();\n  }\n\n  public restore(): void {\n    this._currentState = this._states.pop();\n  }\n\n  public get current(): ExcaliburGraphicsContextState {\n    return this._currentState;\n  }\n}\n","import { Vector } from '../Math/vector';\nimport { SpriteFont as LegacySpriteFont } from '../Drawing/Index';\nimport { Logger } from '../Util/Log';\nimport { ExcaliburGraphicsContext } from './Context/ExcaliburGraphicsContext';\nimport { FontRenderer } from './FontCommon';\nimport { Graphic, GraphicOptions } from './Graphic';\nimport { Sprite } from './Sprite';\nimport { SpriteSheet } from './SpriteSheet';\n\nexport interface SpriteFontOptions {\n  /**\n   * Alphabet string in spritsheet order (default is row column order)\n   * example: 'abcdefghijklmnopqrstuvwxyz'\n   */\n  alphabet: string;\n  /**\n   * [[SpriteSheet]] to source character sprites from\n   */\n  spriteSheet: SpriteSheet;\n  /**\n   * Optionally ignore case in the supplied text;\n   */\n  caseInsensitive?: boolean;\n  /**\n   * Optionally adjust the spacing between character sprites\n   */\n  spacing?: number;\n  /**\n   * Optionally specify a \"shadow\"\n   */\n  shadow?: { offset: Vector };\n}\n\nexport class SpriteFont extends Graphic implements FontRenderer {\n  private _text = '';\n  private _dirty = true;\n  public alphabet: string = '';\n  public spriteSheet: SpriteSheet;\n\n  public shadow: { offset: Vector } = null;\n  public caseInsensitive = false;\n  public spacing: number = 0;\n\n  private _logger = Logger.getInstance();\n\n  static fromLegacySpriteFont(spriteFont: LegacySpriteFont): SpriteFont {\n    const sprites = spriteFont.sprites.map(Sprite.fromLegacySprite);\n    return new SpriteFont({\n      alphabet: spriteFont.alphabet,\n      spacing: 0,\n      caseInsensitive: spriteFont.caseInsensitive,\n      spriteSheet: new SpriteSheet({\n        sprites\n      })\n    });\n  }\n\n  constructor(options: SpriteFontOptions & GraphicOptions) {\n    super(options);\n    const { alphabet, spriteSheet, caseInsensitive, spacing, shadow } = options;\n    this.alphabet = alphabet;\n    this.spriteSheet = spriteSheet;\n    this.caseInsensitive = caseInsensitive ?? this.caseInsensitive;\n    this.spacing = spacing ?? this.spacing;\n    this.shadow = shadow ?? this.shadow;\n\n    this.spriteSheet.sprites[0].image.ready.then(() => {\n      this._updateDimensions();\n    });\n  }\n\n  private _sprites: Sprite[] = [];\n  private _getCharacterSprites(text: string): Sprite[] {\n    if (!this._dirty) {\n      return this._sprites;\n    }\n\n    const results: Sprite[] = [];\n    // handle case insenstive\n    const textToRender = this.caseInsensitive ? text.toLocaleLowerCase() : text;\n    const alphabet = this.caseInsensitive ? this.alphabet.toLocaleLowerCase() : this.alphabet;\n\n    // for each letter in text\n    for (let letterIndex = 0; letterIndex < textToRender.length; letterIndex++) {\n      // find the sprite index in alphabet , if there is an error pick the first\n      const letter = textToRender[letterIndex];\n      let spriteIndex = alphabet.indexOf(letter);\n      if (spriteIndex === -1) {\n        spriteIndex = 0;\n        this._logger.warn(`SpriteFont - Cannot find letter '${letter}' in configured alphabet '${alphabet}'`);\n      }\n\n      const letterSprite = this.spriteSheet.sprites[spriteIndex];\n      if (letterSprite) {\n        results.push(letterSprite);\n      } else {\n        this._logger.warn(`SpriteFont - Cannot find sprite for '${letter}' at index '${spriteIndex}' in configured SpriteSheet`);\n      }\n    }\n    this._dirty = false;\n    return (this._sprites = results);\n  }\n\n  private _updateDimensions() {\n    const sprites = this._getCharacterSprites(this._text);\n    let width = 0;\n    let height = 0;\n    for (const sprite of sprites) {\n      width += sprite.width + this.spacing;\n      height = Math.max(height, sprite.height);\n    }\n    this.width = width;\n    this.height = height;\n  }\n\n  public updateText(text: string) {\n    if (this._text !== text) {\n      this._dirty = true;\n      this._text = text;\n      this._updateDimensions();\n    }\n  }\n\n  protected _preDraw(ex: ExcaliburGraphicsContext, x: number, y: number): void {\n    this._updateDimensions();\n    super._preDraw(ex, x, y);\n  }\n\n  protected _drawImage(ex: ExcaliburGraphicsContext, x: number, y: number): void {\n    let cursor = 0;\n    for (const sprite of this._getCharacterSprites(this._text)) {\n      // draw it in the right spot and increase the cursor by sprite width\n      sprite.draw(ex, x + cursor, y);\n      cursor += sprite.width + this.spacing;\n    }\n  }\n\n  render(ex: ExcaliburGraphicsContext, text: string, x: number, y: number) {\n    if (this._text !== text) {\n      this._dirty = true;\n      this._text = text;\n    }\n\n    if (this.shadow) {\n      ex.save();\n      ex.translate(this.shadow.offset.x, this.shadow.offset.y);\n      this.draw(ex, x, y);\n      ex.restore();\n    }\n\n    this.draw(ex, x, y);\n  }\n\n  clone(): SpriteFont {\n    return new SpriteFont({\n      alphabet: this.alphabet,\n      spriteSheet: this.spriteSheet,\n      spacing: this.spacing\n    });\n  }\n}\n","import { ExcaliburGraphicsContext, ImageSource, SpriteFont, SpriteSheet } from '..';\nimport { Vector } from '../..';\nimport debugFont from './debug-font.png';\n\n/**\n * Internal debugtext helper\n */\nexport class DebugText {\n  constructor() {\n    this.load();\n  }\n\n  /**\n   * base64 font\n   */\n  public readonly fontSheet = debugFont;\n  public size: number = 16;\n  private _imageSource: ImageSource;\n  private _spriteSheet: SpriteSheet;\n  private _spriteFont: SpriteFont;\n  public load() {\n    this._imageSource = new ImageSource(this.fontSheet);\n    return this._imageSource.load().then(() => {\n      this._spriteSheet = SpriteSheet.fromImageSource({\n        image: this._imageSource,\n        grid: {\n          rows: 3,\n          columns: 16,\n          spriteWidth: 16,\n          spriteHeight: 16\n        }\n      });\n      this._spriteFont = new SpriteFont({\n        alphabet: '0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ,!\\'&.\"?-()+ ',\n        caseInsensitive: true,\n        spriteSheet: this._spriteSheet,\n        spacing: -6\n      });\n    });\n  }\n\n  /**\n   * Writes debug text using the built in sprint font\n   * @param ctx\n   * @param text\n   * @param pos\n   */\n  public write(ctx: ExcaliburGraphicsContext, text: string, pos: Vector) {\n    if (this._imageSource.isLoaded()) {\n      this._spriteFont.render(ctx, text, pos.x, pos.y);\n    }\n  }\n}\n","export default \"data:image/png;base64,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\"","import {\n  ExcaliburGraphicsContext,\n  LineGraphicsOptions,\n  PointGraphicsOptions,\n  ExcaliburGraphicsContextOptions,\n  DebugDraw,\n  HTMLImageSource\n} from './ExcaliburGraphicsContext';\nimport { Vector } from '../../Math/vector';\nimport { Color } from '../../Color';\nimport { StateStack } from './state-stack';\nimport { GraphicsDiagnostics } from '../GraphicsDiagnostics';\nimport { DebugText } from './debug-text';\n\nclass ExcaliburGraphicsContext2DCanvasDebug implements DebugDraw {\n  private _debugText = new DebugText();\n  constructor(private _ex: ExcaliburGraphicsContext2DCanvas) {}\n  /**\n   * Draw a debug rectangle to the context\n   * @param x\n   * @param y\n   * @param width\n   * @param height\n   */\n  drawRect(x: number, y: number, width: number, height: number): void {\n    this._ex.__ctx.save();\n    this._ex.__ctx.strokeStyle = 'red';\n    this._ex.__ctx.strokeRect(\n      this._ex.snapToPixel ? ~~x : x,\n      this._ex.snapToPixel ? ~~y : y,\n      this._ex.snapToPixel ? ~~width : width,\n      this._ex.snapToPixel ? ~~height : height\n    );\n    this._ex.__ctx.restore();\n  }\n\n  drawLine(start: Vector, end: Vector, lineOptions: LineGraphicsOptions = { color: Color.Black }): void {\n    this._ex.__ctx.save();\n    this._ex.__ctx.beginPath();\n    this._ex.__ctx.strokeStyle = lineOptions.color.toString();\n    this._ex.__ctx.moveTo(this._ex.snapToPixel ? ~~start.x : start.x, this._ex.snapToPixel ? ~~start.y : start.y);\n    this._ex.__ctx.lineTo(this._ex.snapToPixel ? ~~end.x : end.x, this._ex.snapToPixel ? ~~end.y : end.y);\n    this._ex.__ctx.lineWidth = 2;\n    this._ex.__ctx.stroke();\n    this._ex.__ctx.closePath();\n    this._ex.__ctx.restore();\n  }\n\n  drawPoint(point: Vector, pointOptions: PointGraphicsOptions = { color: Color.Black, size: 5 }): void {\n    this._ex.__ctx.save();\n    this._ex.__ctx.beginPath();\n    this._ex.__ctx.fillStyle = pointOptions.color.toString();\n    this._ex.__ctx.arc(\n      this._ex.snapToPixel ? ~~point.x : point.x,\n      this._ex.snapToPixel ? ~~point.y : point.y,\n      pointOptions.size,\n      0,\n      Math.PI * 2\n    );\n    this._ex.__ctx.fill();\n    this._ex.__ctx.closePath();\n    this._ex.__ctx.restore();\n  }\n\n  drawText(text: string, pos: Vector) {\n    this._debugText.write(this._ex, text, pos);\n  }\n}\n\nexport class ExcaliburGraphicsContext2DCanvas implements ExcaliburGraphicsContext {\n  /**\n   * Meant for internal use only. Access the internal context at your own risk and no guarantees this will exist in the future.\n   * @internal\n   */\n  public __ctx: CanvasRenderingContext2D;\n  public get width() {\n    return this.__ctx.canvas.width;\n  }\n\n  public get height() {\n    return this.__ctx.canvas.height;\n  }\n\n  public backgroundColor: Color = Color.ExcaliburBlue;\n\n  private _state = new StateStack();\n\n  public get opacity(): number {\n    return this._state.current.opacity;\n  }\n\n  public set opacity(value: number) {\n    this._state.current.opacity = value;\n  }\n\n  public snapToPixel: boolean = true;\n\n  public get smoothing(): boolean {\n    return this.__ctx.imageSmoothingEnabled;\n  }\n\n  public set smoothing(value: boolean) {\n    this.__ctx.imageSmoothingEnabled = value;\n  }\n\n  constructor(options: ExcaliburGraphicsContextOptions) {\n    const { canvasElement, enableTransparency, snapToPixel, smoothing, backgroundColor } = options;\n    this.__ctx = canvasElement.getContext('2d', {\n      alpha: enableTransparency ?? true\n    });\n    this.backgroundColor = backgroundColor ?? this.backgroundColor;\n    this.snapToPixel = snapToPixel ?? this.snapToPixel;\n    this.smoothing = smoothing ?? this.smoothing;\n  }\n\n  public resetTransform(): void {\n    this.__ctx.resetTransform();\n  }\n\n  public updateViewport(): void {\n    // pass\n  }\n\n  /**\n   * Draw an image to the Excalibur Graphics context at an x and y coordinate using the images width and height\n   */\n  drawImage(image: HTMLImageSource, x: number, y: number): void;\n  /**\n   *\n   * Draw an image to the Excalibur Graphics context at an x and y coordinate with a specific width and height\n   */\n  drawImage(image: HTMLImageSource, x: number, y: number, width: number, height: number): void;\n  /**\n   *\n   * Draw an image to the Excalibur Graphics context specifying the source image coordinates (sx, sy, swidth, sheight)\n   * and to a specific destination on the context (dx, dy, dwidth, dheight)\n   */\n  drawImage(\n    image: HTMLImageSource,\n    sx: number,\n    sy: number,\n    swidth?: number,\n    sheight?: number,\n    dx?: number,\n    dy?: number,\n    dwidth?: number,\n    dheight?: number\n  ): void;\n\n  drawImage(\n    image: HTMLImageSource,\n    sx: number,\n    sy: number,\n    swidth?: number,\n    sheight?: number,\n    dx?: number,\n    dy?: number,\n    dwidth?: number,\n    dheight?: number\n  ): void {\n    if (swidth === 0 || sheight === 0) {\n      return; // zero dimension dest exit early\n    } else if (dwidth === 0 || dheight === 0) {\n      return; // zero dimension dest exit early\n    } else if (image.width === 0 || image.height === 0) {\n      return; // zero dimension source exit early\n    }\n\n    this.__ctx.globalAlpha = this.opacity;\n    const args = [image, sx, sy, swidth, sheight, dx, dy, dwidth, dheight]\n      .filter((a) => a !== undefined)\n      .map((a) => (typeof a === 'number' && this.snapToPixel ? ~~a : a));\n    this.__ctx.drawImage.apply(this.__ctx, args);\n    GraphicsDiagnostics.DrawCallCount++;\n    GraphicsDiagnostics.DrawnImagesCount = 1;\n  }\n\n  public drawLine(start: Vector, end: Vector, color: Color, thickness = 1) {\n    this.__ctx.save();\n    this.__ctx.beginPath();\n    this.__ctx.strokeStyle = color.toString();\n    this.__ctx.moveTo(this.snapToPixel ? ~~start.x : start.x, this.snapToPixel ? ~~start.y : start.y);\n    this.__ctx.lineTo(this.snapToPixel ? ~~end.x : end.x, this.snapToPixel ? ~~end.y : end.y);\n    this.__ctx.lineWidth = thickness;\n    this.__ctx.stroke();\n    this.__ctx.closePath();\n    this.__ctx.restore();\n  }\n\n  public drawRectangle(pos: Vector, width: number, height: number, color: Color) {\n    this.__ctx.save();\n    this.__ctx.fillStyle = color.toString();\n    this.__ctx.fillRect(\n      this.snapToPixel ? ~~pos.x : pos.x,\n      this.snapToPixel ? ~~pos.y : pos.y,\n      this.snapToPixel ? ~~width : width,\n      this.snapToPixel ? ~~height : height\n    );\n    this.__ctx.restore();\n  }\n\n  public drawCircle(pos: Vector, radius: number, color: Color) {\n    this.__ctx.save();\n    this.__ctx.beginPath();\n    this.__ctx.fillStyle = color.toString();\n    this.__ctx.arc(this.snapToPixel ? ~~pos.x : pos.x, this.snapToPixel ? ~~pos.y : pos.y, radius, 0, Math.PI * 2);\n    this.__ctx.fill();\n    this.__ctx.closePath();\n    this.__ctx.restore();\n  }\n\n  debug = new ExcaliburGraphicsContext2DCanvasDebug(this);\n\n  /**\n   * Save the current state of the canvas to the stack (transforms and opacity)\n   */\n  save(): void {\n    this.__ctx.save();\n  }\n\n  /**\n   * Restore the state of the canvas from the stack\n   */\n  restore(): void {\n    this.__ctx.restore();\n  }\n\n  /**\n   * Translate the origin of the context by an x and y\n   * @param x\n   * @param y\n   */\n  translate(x: number, y: number): void {\n    this.__ctx.translate(this.snapToPixel ? ~~x : x, this.snapToPixel ? ~~y : y);\n  }\n\n  /**\n   * Rotate the context about the current origin\n   */\n  rotate(angle: number): void {\n    this.__ctx.rotate(angle);\n  }\n\n  /**\n   * Scale the context by an x and y factor\n   * @param x\n   * @param y\n   */\n  scale(x: number, y: number): void {\n    this.__ctx.scale(x, y);\n  }\n\n  clear(): void {\n    // Clear frame\n    this.__ctx.clearRect(0, 0, this.width, this.height);\n    this.__ctx.fillStyle = this.backgroundColor.toString();\n    this.__ctx.fillRect(0, 0, this.width, this.height);\n    GraphicsDiagnostics.clear();\n  }\n\n  /**\n   * Flushes the batched draw calls to the screen\n   */\n  flush(): void {\n    // pass\n  }\n}\n","import { Matrix } from '../../Math/matrix';\n\nexport class TransformStack {\n  private _transforms: Matrix[] = [];\n  private _currentTransform: Matrix = Matrix.identity();\n\n  public save(): void {\n    this._transforms.push(this._currentTransform);\n    this._currentTransform = this._currentTransform.clone();\n  }\n\n  public restore(): void {\n    this._currentTransform = this._transforms.pop();\n  }\n\n  public translate(x: number, y: number): Matrix {\n    return this._currentTransform.translate(x, y);\n  }\n\n  public rotate(angle: number): Matrix {\n    return this._currentTransform.rotate(angle);\n  }\n\n  public scale(x: number, y: number): Matrix {\n    return this._currentTransform.scale(x, y);\n  }\n\n  public set current(matrix: Matrix) {\n    this._currentTransform = matrix;\n  }\n\n  public get current(): Matrix {\n    return this._currentTransform;\n  }\n}\n","export interface VertexAttributeDefinition {\n  name: string;\n  size: number;\n  glType: number;\n  normalized: boolean;\n  location: number;\n}\n\nexport interface UniformDefinition {\n  name: string;\n  location: WebGLUniformLocation;\n  type: string;\n  data: any;\n}\n\n/**\n * Create a shader program for the Excalibur WebGL Graphics Context\n */\nexport class Shader {\n  public program: WebGLProgram | null = null;\n\n  public uniforms: { [variableName: string]: UniformDefinition } = {};\n  public attributes: { [variableName: string]: VertexAttributeDefinition } = {};\n  public layout: VertexAttributeDefinition[] = [];\n\n  /**\n   * Create a shader program in excalibur\n   * @param _gl WebGL graphics context\n   * @param _vertexSource Vertex shader source as a string\n   * @param _fragmentSource Fragment shader source as a string\n   */\n  constructor(private _gl: WebGLRenderingContext, private _vertexSource: string, private _fragmentSource: string) {\n    this.compile(_gl);\n  }\n\n  private _createProgram(gl: WebGLRenderingContext, vertexShader: WebGLShader, fragmentShader: WebGLShader): WebGLProgram {\n    const program = gl.createProgram();\n    if (program === null) {\n      throw Error('Could not create graphics shader program');\n    }\n\n    // attach the shaders.\n    gl.attachShader(program, vertexShader);\n    gl.attachShader(program, fragmentShader);\n\n    // link the program.\n    gl.linkProgram(program);\n\n    const success = gl.getProgramParameter(program, gl.LINK_STATUS);\n    if (!success) {\n      throw Error(`Could not link the program: [${gl.getProgramInfoLog(program)}]`);\n    }\n\n    return program;\n  }\n\n  private _compileShader(gl: WebGLRenderingContext, source: string, type: number): WebGLShader {\n    const shader = gl.createShader(type);\n    if (shader === null) {\n      throw Error(`Could not build shader: [${source}]`);\n    }\n\n    gl.shaderSource(shader, source);\n    gl.compileShader(shader);\n\n    const success = gl.getShaderParameter(shader, gl.COMPILE_STATUS);\n    if (!success) {\n      throw Error(`Could not compile shader [${gl.getShaderInfoLog(shader)}]`);\n    }\n    return shader;\n  }\n\n  /**\n   * Compile the current shader against a webgl context\n   * @param gl WebGL context\n   */\n  compile(gl: WebGLRenderingContext): WebGLProgram {\n    const vertexShader = this._compileShader(gl, this._vertexSource, gl.VERTEX_SHADER);\n    const fragmentShader = this._compileShader(gl, this._fragmentSource, gl.FRAGMENT_SHADER);\n    const program = this._createProgram(gl, vertexShader, fragmentShader);\n    return (this.program = program);\n  }\n\n  /**\n   * Add a uniform [[Matrix]] to the shader\n   * @param name Name of the uniform in the shader source\n   * @param data (4x4) matrix in column major order\n   */\n  public addUniformMatrix(name: string, data: Float32Array) {\n    if (!data) {\n      throw Error(`Shader Uniform Matrix '${name}' was set to null or undefined`);\n    }\n    const gl = this._gl;\n    this.uniforms[name] = {\n      name,\n      type: 'matrix',\n      location: gl.getUniformLocation(this.program, name),\n      data: data\n    };\n  }\n\n  /**\n   * Add a uniform array of numbers to the shader\n   * @param name Name of the uniform in the shader source\n   * @param data List of numbers\n   */\n  public addUniformIntegerArray(name: string, data: number[]) {\n    if (!data) {\n      throw Error(`Shader Uniform Integery Array '${name}' was set to null or undefined`);\n    }\n    const gl = this._gl;\n    this.uniforms[name] = {\n      name,\n      type: 'numbers',\n      location: gl.getUniformLocation(this.program, name),\n      data: data\n    };\n  }\n\n  /**\n   * Add attributes in the order they appear in the VBO\n   * @param name Name of the attribute in the shader source\n   * @param size The size of the attribute in gl.Type units, for example `vec2 a_pos` would be 2 gl.FLOAT\n   * @param glType The gl.Type of the attribute\n   */\n  public addAttribute(name: string, size: number, glType: number, normalized = false) {\n    const gl = this._gl;\n    // TODO needs to be compiled first\n    const location = gl.getAttribLocation(this.program, name);\n    this.attributes[name] = {\n      name,\n      size,\n      glType,\n      normalized,\n      location\n    };\n    this.layout.push(this.attributes[name]);\n  }\n\n  /**\n   * Number of javascript floats a vertex will take up\n   */\n  public get vertexAttributeSize(): number {\n    let vertexSize = 0;\n    for (const vert of this.layout) {\n      vertexSize += vert.size;\n    }\n    return vertexSize;\n  }\n\n  /**\n   * Total number of bytes that the vertex will take up\n   */\n  public get totalVertexSizeBytes(): number {\n    let vertexSize = 0;\n    for (const vert of this.layout) {\n      let typeSize = 1;\n      switch (vert.glType) {\n        case this._gl.FLOAT: {\n          typeSize = 4;\n          break;\n        }\n        default: {\n          typeSize = 1;\n        }\n      }\n      vertexSize += typeSize * vert.size;\n    }\n\n    return vertexSize;\n  }\n\n  /**\n   * Get a previously defined attribute size in bytes\n   * @param name\n   */\n  public getAttributeSize(name: string) {\n    let typeSize = 1;\n    switch (this.attributes[name].glType) {\n      case this._gl.FLOAT: {\n        typeSize = 4;\n        break;\n      }\n      default: {\n        typeSize = 1;\n      }\n    }\n    return typeSize * this.attributes[name].size;\n  }\n\n  /**\n   * Sets this shader program as the current in the underlying webgl context\n   *\n   * **Must** specify all attributes and uniforms before calling this\n   */\n  public use() {\n    const gl = this._gl;\n    gl.useProgram(this.program);\n    let offset = 0;\n    for (const vert of this.layout) {\n      gl.vertexAttribPointer(vert.location, vert.size, vert.glType, vert.normalized, this.totalVertexSizeBytes, offset);\n      gl.enableVertexAttribArray(vert.location);\n      offset += this.getAttributeSize(vert.name);\n    }\n\n    for (const key in this.uniforms) {\n      const uniform = this.uniforms[key];\n      switch (uniform.type) {\n        case 'matrix': {\n          gl.uniformMatrix4fv(uniform.location, false, uniform.data);\n          break;\n        }\n        case 'numbers': {\n          gl.uniform1iv(uniform.location, uniform.data);\n          break;\n        }\n      }\n    }\n  }\n}\n","import { Pool, Poolable } from '../../Util/Pool';\n\nexport class BatchCommand<T> implements Poolable {\n  _pool: Pool<this> = undefined;\n  public commands: T[] = [];\n  constructor(public max: number) {}\n\n  isFull() {\n    if (this.commands.length >= this.max) {\n      return true;\n    }\n    return false;\n  }\n\n  canAdd() {\n    return !this.isFull();\n  }\n\n  add(cmd: T) {\n    this.commands.push(cmd);\n  }\n\n  dispose() {\n    this.commands.length = 0;\n    return this;\n  }\n}\n","import { Logger } from '..';\n\nexport interface Poolable {\n  /**\n   * Any type that is a member of a an object pool will have a reference to teh pool\n   * @internal\n   */\n  _pool?: Pool<this>;\n  dispose(): this;\n}\n\nexport class Pool<Type extends Poolable> {\n  public totalAllocations = 0;\n  public index = 0;\n  public objects: Type[] = [];\n  private _logger = Logger.getInstance();\n\n  constructor(\n    public builder: (...args: any[]) => Type,\n    public recycler: (instance: Type, ...args: any[]) => Type,\n    public maxObjects: number = 100\n  ) {}\n\n  /**\n   * Use many instances out of the in the context and return all to the pool.\n   *\n   * By returning values out of the contex they will be un-hooked from the pool and are free to be passed to consumers\n   * @param context\n   */\n  using(context: (pool: Pool<Type>) => Type[] | void) {\n    const result = context(this);\n    if (result) {\n      return this.done(...result);\n    }\n    return this.done();\n  }\n\n  /**\n   * Use a single instance out of th pool and immediately return it to the pool\n   * @param context\n   */\n  borrow(context: (object: Type) => void) {\n    const object = this.get();\n    context(object);\n    this.index--;\n  }\n\n  /**\n   * Retrieve a value from the pool, will allocate a new instance if necessary or recycle from the pool\n   * @param args\n   */\n  get(...args: any[]): Type {\n    if (this.index === this.maxObjects) {\n      // TODO implement hard or soft cap\n      this._logger.warn('Max pooled objects reached, possible memory leak? Doubling');\n      this.maxObjects = this.maxObjects * 2;\n      // throw new Error('Max pooled objects reached, possible memory leak?');\n    }\n\n    if (this.objects[this.index]) {\n      // Pool has an available object already constructed\n      return this.recycler(this.objects[this.index++], ...args);\n    } else {\n      // New allocation\n      this.totalAllocations++;\n      const object = (this.objects[this.index++] = this.builder(...args));\n      object._pool = this;\n      return object;\n    }\n  }\n\n  /**\n   * Signals we are done with the pool objects for now, Reclaims all objects in the pool.\n   *\n   * If a list of pooled objects is passed to done they are un-hooked from the pool and are free\n   * to be passed to consumers\n   * @param objects A list of object to separate from the pool\n   */\n  done(...objects: Type[]): Type[];\n  done(): void;\n  done(...objects: Type[]): Type[] | void {\n    // All objects in pool now considered \"free\"\n    this.index = 0;\n    for (const object of objects) {\n      const poolIndex = this.objects.indexOf(object);\n      // Build a new object to take the pool place\n      this.objects[poolIndex] = (this as any).builder(); // TODO problematic 0-arg only support\n      this.objects[poolIndex]._pool = this;\n      this.totalAllocations++;\n      // Unhook object from the pool\n      object._pool = undefined;\n    }\n    return objects;\n  }\n}\n","import { BatchCommand } from './batch';\nimport { Shader } from './shader';\n// import { Pool, Poolable } from './pool';\nimport { GraphicsDiagnostics } from '../GraphicsDiagnostics';\nimport { Pool, Poolable } from '../../Util/Pool';\n\nexport interface Renderer {\n  render(): void;\n}\n\nexport interface Ctor<T> {\n  new (): T;\n}\n\nexport interface BatchRendererOptions<T extends Poolable> {\n  gl: WebGLRenderingContext;\n  /**\n   * Draw command constructor\n   */\n  command: Ctor<T>;\n  /**\n   * Number of vertices that are generated per draw command\n   */\n  verticesPerCommand?: number;\n  /**\n   * Maximum commands to batch before drawing\n   */\n  maxCommandsPerBatch?: number;\n  /**\n   * Override the built in command batching mechanism\n   */\n  batchFactory?: () => BatchCommand<T>;\n}\n\nexport abstract class BatchRenderer<T extends Poolable> implements Renderer {\n  priority = 0;\n  private _gl: WebGLRenderingContext;\n  private _vertices: Float32Array;\n  private _verticesPerCommand: number;\n  private _buffer: WebGLBuffer | null = null;\n  private _maxCommandsPerBatch: number = 2000;\n\n  public shader: Shader;\n\n  public commands: Pool<T>;\n  private _batchPool: Pool<BatchCommand<T>>;\n  private _batches: BatchCommand<T>[] = [];\n  constructor(options: BatchRendererOptions<T>) {\n    this._gl = options.gl;\n    const command = options.command;\n    this._verticesPerCommand = options?.verticesPerCommand ?? 1;\n    this._maxCommandsPerBatch = options?.maxCommandsPerBatch ?? this._maxCommandsPerBatch;\n    const batchFactory = options?.batchFactory ?? (() => new BatchCommand<T>(this._maxCommandsPerBatch));\n\n    this.commands = new Pool<T>(\n      () => new command(),\n      (c) => c.dispose(),\n      this._maxCommandsPerBatch\n    );\n    this._batchPool = new Pool<BatchCommand<T>>(batchFactory, (b) => b.dispose(), 100);\n  }\n\n  /**\n   * Initialize render, builds shader and initialized webgl buffers\n   */\n  public init() {\n    const gl = this._gl;\n    this.shader = this.buildShader(gl);\n    // Initialize VBO\n    // https://groups.google.com/forum/#!topic/webgl-dev-list/vMNXSNRAg8M\n    this._vertices = new Float32Array(this.shader.vertexAttributeSize * this._verticesPerCommand * this._maxCommandsPerBatch);\n    this._buffer = gl.createBuffer();\n    gl.bindBuffer(gl.ARRAY_BUFFER, this._buffer);\n    gl.bufferData(gl.ARRAY_BUFFER, this._vertices, gl.DYNAMIC_DRAW);\n  }\n\n  public get vertexSize(): number {\n    return this.shader.vertexAttributeSize;\n  }\n\n  public addCommand(cmd: T) {\n    if (this._batches.length === 0) {\n      this._batches.push(this._batchPool.get());\n    }\n\n    const lastBatch = this._batches[this._batches.length - 1];\n    if (lastBatch.canAdd()) {\n      lastBatch.add(cmd);\n    } else {\n      const newBatch = this._batchPool.get();\n      newBatch.add(cmd);\n      this._batches.push(newBatch);\n    }\n  }\n\n  /**\n   * Construct or return the Shader to be used in this batch renderer\n   * @param gl\n   */\n  abstract buildShader(gl: WebGLRenderingContext): Shader;\n\n  /**\n   * Implement populating the vertex buffer, return the number of vertices added to the buffer\n   * @param vertices\n   * @param batch\n   */\n  abstract buildBatchVertices(vertexBuffer: Float32Array, batch: BatchCommand<T>): number;\n\n  /**\n   * Implement gl draw call to render batch. The vertextBuffer from buildBatchVertices is already bound and the data has been updated.\n   */\n  abstract renderBatch(gl: WebGLRenderingContext, batch: BatchCommand<T>, vertexCount: number): void;\n\n  /**\n   * Build batch geometry, submit to the gpu, and issue draw command to underlying webgl\n   */\n  public render(): void {\n    const gl = this._gl;\n    gl.bindBuffer(gl.ARRAY_BUFFER, this._buffer);\n    this.shader.use();\n    let drawCallCount = 0;\n    let drawnImagesCount = 0;\n    for (const batch of this._batches) {\n      // Build all geometry and ship to GPU\n      // interleave VBOs https://goharsha.com/lwjgl-tutorial-series/interleaving-buffer-objects/\n      const vertexCount = this.buildBatchVertices(this._vertices, batch);\n      gl.bufferSubData(gl.ARRAY_BUFFER, 0, this._vertices);\n\n      this.renderBatch(gl, batch, vertexCount);\n      drawnImagesCount += batch.commands.length;\n      drawCallCount++;\n    }\n    this.commands.done();\n    this._batchPool.done();\n    this._batches.length = 0;\n    GraphicsDiagnostics.DrawCallCount += drawCallCount;\n    GraphicsDiagnostics.DrawnImagesCount += drawnImagesCount;\n  }\n}\n","import { Vector } from '../../Math/vector';\nimport { Color } from '../../Color';\nimport { Shader } from './shader';\nimport lineVertexSource from './shaders/line-vertex.glsl';\nimport lineFragmentSource from './shaders/line-fragment.glsl';\nimport { BatchRenderer } from './renderer';\nimport { BatchCommand } from './batch';\nimport { WebGLGraphicsContextInfo } from './ExcaliburGraphicsContextWebGL';\nimport { Pool, Poolable } from '../../Util/Pool';\n\nexport class DrawLine implements Poolable {\n  _pool?: Pool<this>;\n  public color: Color = Color.Black;\n  public start: Vector = Vector.Zero;\n  public end: Vector = Vector.Zero;\n  public dispose() {\n    this.color.r = 0;\n    this.color.g = 0;\n    this.color.b = 0;\n    this.color.a = 1;\n    this.start.setTo(0, 0);\n    this.end.setTo(0, 0);\n    return this;\n  }\n}\n\nexport class LineRenderer extends BatchRenderer<DrawLine> {\n  constructor(gl: WebGLRenderingContext, private _contextInfo: WebGLGraphicsContextInfo) {\n    super({ gl, command: DrawLine, verticesPerCommand: 2 });\n    this.init();\n  }\n\n  buildShader(gl: WebGLRenderingContext) {\n    const shader = new Shader(gl, lineVertexSource, lineFragmentSource);\n\n    shader.addAttribute('a_position', 2, gl.FLOAT);\n    shader.addAttribute('a_color', 4, gl.FLOAT);\n    shader.addUniformMatrix('u_matrix', this._contextInfo.matrix.data);\n    return shader;\n  }\n\n  addLine(start: Vector, end: Vector, color: Color) {\n    const cmd = this.commands.get();\n    cmd.start = this._contextInfo.transform.current.multv(start);\n    cmd.end = this._contextInfo.transform.current.multv(end);\n    cmd.color.r = color.r;\n    cmd.color.g = color.g;\n    cmd.color.b = color.b;\n    cmd.color.a = cmd.color.a * this._contextInfo.state.current.opacity;\n    this.addCommand(cmd);\n  }\n\n  buildBatchVertices(vertexBuffer: Float32Array, batch: BatchCommand<DrawLine>): number {\n    let index = 0;\n    for (const command of batch.commands) {\n      // Start\n      vertexBuffer[index++] = command.start.x;\n      vertexBuffer[index++] = command.start.y;\n      vertexBuffer[index++] = command.color.r / 255;\n      vertexBuffer[index++] = command.color.g / 255;\n      vertexBuffer[index++] = command.color.b / 255;\n      vertexBuffer[index++] = command.color.a;\n\n      // End\n      vertexBuffer[index++] = command.end.x;\n      vertexBuffer[index++] = command.end.y;\n      vertexBuffer[index++] = command.color.r / 255;\n      vertexBuffer[index++] = command.color.g / 255;\n      vertexBuffer[index++] = command.color.b / 255;\n      vertexBuffer[index++] = command.color.a;\n    }\n    return index / this.vertexSize;\n  }\n\n  renderBatch(gl: WebGLRenderingContext, _batch: BatchCommand<DrawLine>, vertexCount: number) {\n    gl.drawArrays(gl.LINES, 0, vertexCount);\n  }\n}\n","export default \"attribute vec4 a_position;\\nattribute vec4 a_color;\\n\\nvarying lowp vec4 v_color;\\n\\nuniform mat4 u_matrix;\\n\\n\\nvoid main() {\\n   // Set the vertex position using the ortho transform matrix\\n   gl_Position = u_matrix * a_position;\\n\\n   // Passthrough the color\\n   v_color = a_color;\\n}\";","export default \"precision mediump float;\\n\\n// Color\\nvarying lowp vec4 v_color;\\n\\n\\nvoid main() {\\n  gl_FragColor = v_color;\\n}\";","import { Shader } from './shader';\nimport imageVertexSource from './shaders/image-vertex.glsl';\nimport imageFragmentSource from './shaders/image-fragment.glsl';\nimport { BatchCommand } from './batch';\nimport { DrawCommandType, DrawImageCommand } from './draw-image-command';\nimport { Graphic } from '../Graphic';\nimport { ensurePowerOfTwo } from './webgl-util';\nimport { BatchRenderer } from './renderer';\nimport { WebGLGraphicsContextInfo } from './ExcaliburGraphicsContextWebGL';\nimport { TextureLoader } from './texture-loader';\nimport { HTMLImageSource } from './ExcaliburGraphicsContext';\nimport { Color } from '../../Color';\nimport { Vector } from '../..';\n\nexport class BatchImage extends BatchCommand<DrawImageCommand> {\n  public textures: WebGLTexture[] = [];\n  public commands: DrawImageCommand[] = [];\n  private _graphicMap: { [id: string]: Graphic } = {};\n\n  constructor(public maxDraws: number, public maxTextures: number) {\n    super(maxDraws);\n  }\n\n  isFull() {\n    if (this.commands.length >= this.maxDraws) {\n      return true;\n    }\n    if (this.textures.length >= this.maxTextures) {\n      return true;\n    }\n    return false;\n  }\n\n  canAdd() {\n    if (this.commands.length >= this.maxDraws) {\n      return false;\n    }\n\n    if (this.textures.length < this.maxTextures) {\n      return true;\n    }\n\n    return false;\n  }\n\n  private _isCommandFull() {\n    return this.commands.length >= this.maxDraws;\n  }\n\n  private _isTextureFull() {\n    return this.textures.length >= this.maxTextures;\n  }\n\n  private _wouldAddTexture(command: DrawImageCommand) {\n    return !this._graphicMap[command.image.id];\n  }\n\n  maybeAdd(command: DrawImageCommand): boolean {\n    if ((this._isCommandFull() || this._isTextureFull()) && this._wouldAddTexture(command)) {\n      return false;\n    }\n\n    this.add(command);\n    return true;\n  }\n\n  add(command: DrawImageCommand) {\n    if (command.type === DrawCommandType.Image) {\n      const texture = TextureLoader.load(command.image);\n      if (this.textures.indexOf(texture) === -1) {\n        this.textures.push(texture);\n      }\n    }\n\n    this.commands.push(command);\n  }\n\n  bindTextures(gl: WebGLRenderingContext) {\n    // Bind textures in the correct order\n    for (let i = 0; i < this.maxTextures; i++) {\n      gl.activeTexture(gl.TEXTURE0 + i);\n      gl.bindTexture(gl.TEXTURE_2D, this.textures[i] || this.textures[0]);\n    }\n  }\n\n  getBatchTextureId(command: DrawImageCommand) {\n    if (command.image) {\n      return this.textures.indexOf(TextureLoader.get(command.image));\n    }\n    return -1;\n  }\n\n  dispose() {\n    this.clear();\n    return this;\n  }\n\n  clear() {\n    this.commands.length = 0;\n    this.textures.length = 0;\n    this._graphicMap = {};\n  }\n}\n\nexport class ImageRenderer extends BatchRenderer<DrawImageCommand> {\n  constructor(gl: WebGLRenderingContext, private _contextInfo: WebGLGraphicsContextInfo) {\n    super({\n      gl,\n      command: DrawImageCommand,\n      // 6 verts per quad\n      verticesPerCommand: 6,\n      maxCommandsPerBatch: 2000,\n      batchFactory: () => new BatchImage(2000, gl.getParameter(gl.MAX_TEXTURE_IMAGE_UNITS))\n    });\n    TextureLoader.registerContext(gl);\n    this.init();\n  }\n\n  buildShader(gl: WebGLRenderingContext): Shader {\n    // Initialilze default batch rendering shader\n    const maxGPUTextures = gl.getParameter(gl.MAX_TEXTURE_IMAGE_UNITS);\n    const shader = new Shader(gl, imageVertexSource, this._transformFragmentSource(imageFragmentSource, maxGPUTextures));\n    shader.addAttribute('a_position', 3, gl.FLOAT);\n    shader.addAttribute('a_texcoord', 2, gl.FLOAT);\n    shader.addAttribute('a_textureIndex', 1, gl.FLOAT);\n    shader.addAttribute('a_opacity', 1, gl.FLOAT);\n    shader.addAttribute('a_color', 4, gl.FLOAT);\n    shader.addUniformMatrix('u_matrix', this._contextInfo.matrix.data);\n    // Initialize texture slots to [0, 1, 2, 3, 4, .... maxGPUTextures]\n    shader.addUniformIntegerArray(\n      'u_textures',\n      [...Array(maxGPUTextures)].map((_, i) => i)\n    );\n    return shader;\n  }\n\n  private _transformFragmentSource(source: string, maxTextures: number): string {\n    let newSource = source.replace('%%count%%', maxTextures.toString());\n    let texturePickerBuilder = '';\n    for (let i = 0; i < maxTextures; i++) {\n      if (i === 0) {\n        texturePickerBuilder += `if (v_textureIndex <= ${i}.5) {\\n`;\n      } else {\n        texturePickerBuilder += `   else if (v_textureIndex <= ${i}.5) {\\n`;\n      }\n      texturePickerBuilder += `      color = texture2D(u_textures[${i}], v_texcoord);\\n`;\n      texturePickerBuilder += `   }\\n`;\n    }\n    newSource = newSource.replace('%%texture_picker%%', texturePickerBuilder);\n    return newSource;\n  }\n\n  public addCircle(pos: Vector, radius: number, color: Color) {\n    const command = this.commands.get().initCircle(pos, radius, color);\n    command.applyTransform(this._contextInfo.transform.current, this._contextInfo.state.current.opacity);\n    this.addCommand(command);\n  }\n\n  public addRectangle(color: Color, pos: Vector, width: number, height: number) {\n    const command = this.commands.get().initRect(color, pos, width, height);\n    command.applyTransform(this._contextInfo.transform.current, this._contextInfo.state.current.opacity);\n    this.addCommand(command);\n  }\n\n  public addLine(color: Color, start: Vector, end: Vector, thickness = 1) {\n    const command = this.commands.get().initLine(color, start, end, thickness);\n    command.applyTransform(this._contextInfo.transform.current, this._contextInfo.state.current.opacity);\n    this.addCommand(command);\n  }\n\n  public addImage(\n    graphic: HTMLImageSource,\n    sx: number,\n    sy: number,\n    swidth?: number,\n    sheight?: number,\n    dx?: number,\n    dy?: number,\n    dwidth?: number,\n    dheight?: number\n  ) {\n    const command = this.commands.get().init(graphic, sx, sy, swidth, sheight, dx, dy, dwidth, dheight);\n    command.applyTransform(this._contextInfo.transform.current, this._contextInfo.state.current.opacity);\n    this.addCommand(command);\n  }\n\n  public renderBatch(gl: WebGLRenderingContext, batch: BatchImage, vertexCount: number) {\n    // Bind textures in the correct order\n    batch.bindTextures(gl);\n    // draw the quads\n    gl.drawArrays(gl.TRIANGLES, 0, vertexCount);\n  }\n\n  buildBatchVertices(vertexBuffer: Float32Array, batch: BatchImage): number {\n    let vertIndex = 0;\n    let sx: number = 0;\n    let sy: number = 0;\n    let sw: number = 0;\n    let sh: number = 0;\n    let potWidth: number = 1;\n    let potHeight: number = 1;\n    let textureId = 0;\n    let commandColor = Color.Transparent;\n    for (const command of batch.commands) {\n      sx = command.view[0];\n      sy = command.view[1];\n      sw = command.view[2];\n      sh = command.view[3];\n\n      potWidth = ensurePowerOfTwo(command.image?.width || command.width);\n      potHeight = ensurePowerOfTwo(command.image?.height || command.height);\n\n      textureId = batch.getBatchTextureId(command);\n      if (command.type === DrawCommandType.Line || command.type === DrawCommandType.Rectangle) {\n        textureId = -1; // sentinel for no image rect\n        commandColor = command.color;\n      }\n      if (command.type === DrawCommandType.Circle) {\n        textureId = -2; // sentinel for circle\n        commandColor = command.color;\n      }\n\n      // potential optimization when divding by 2 (bitshift)\n      // Modifying the images to poweroftwo images warp the UV coordinates\n      let uvx0 = sx / potWidth;\n      let uvy0 = sy / potHeight;\n      let uvx1 = (sx + sw) / potWidth;\n      let uvy1 = (sy + sh) / potHeight;\n      if (textureId === -2) {\n        uvx0 = 0;\n        uvy0 = 0;\n        uvx1 = 1;\n        uvy1 = 1;\n      }\n\n      // Quad update\n      // (0, 0, z) z-index doesn't work in batch rendering between batches\n      vertexBuffer[vertIndex++] = command.geometry[0][0]; // x + 0 * width;\n      vertexBuffer[vertIndex++] = command.geometry[0][1]; //y + 0 * height;\n      vertexBuffer[vertIndex++] = 0;\n\n      // UV coords\n      vertexBuffer[vertIndex++] = uvx0; // 0;\n      vertexBuffer[vertIndex++] = uvy0; // 0;\n      // texture id\n      vertexBuffer[vertIndex++] = textureId;\n      // opacity\n      vertexBuffer[vertIndex++] = command.opacity;\n      // color\n      vertexBuffer[vertIndex++] = commandColor.r / 255;\n      vertexBuffer[vertIndex++] = commandColor.g / 255;\n      vertexBuffer[vertIndex++] = commandColor.b / 255;\n      vertexBuffer[vertIndex++] = commandColor.a;\n\n      // (0, 1)\n      vertexBuffer[vertIndex++] = command.geometry[1][0]; // x + 0 * width;\n      vertexBuffer[vertIndex++] = command.geometry[1][1]; // y + 1 * height;\n      vertexBuffer[vertIndex++] = 0;\n\n      // UV coords\n      vertexBuffer[vertIndex++] = uvx0; // 0;\n      vertexBuffer[vertIndex++] = uvy1; // 1;\n      // texture id\n      vertexBuffer[vertIndex++] = textureId;\n      // opacity\n      vertexBuffer[vertIndex++] = command.opacity;\n      // color\n      vertexBuffer[vertIndex++] = commandColor.r / 255;\n      vertexBuffer[vertIndex++] = commandColor.g / 255;\n      vertexBuffer[vertIndex++] = commandColor.b / 255;\n      vertexBuffer[vertIndex++] = commandColor.a;\n\n      // (1, 0)\n      vertexBuffer[vertIndex++] = command.geometry[2][0]; // x + 1 * width;\n      vertexBuffer[vertIndex++] = command.geometry[2][1]; // y + 0 * height;\n      vertexBuffer[vertIndex++] = 0;\n\n      // UV coords\n      vertexBuffer[vertIndex++] = uvx1; //1;\n      vertexBuffer[vertIndex++] = uvy0; //0;\n      // texture id\n      vertexBuffer[vertIndex++] = textureId;\n      // opacity\n      vertexBuffer[vertIndex++] = command.opacity;\n      // color\n      vertexBuffer[vertIndex++] = commandColor.r / 255;\n      vertexBuffer[vertIndex++] = commandColor.g / 255;\n      vertexBuffer[vertIndex++] = commandColor.b / 255;\n      vertexBuffer[vertIndex++] = commandColor.a;\n\n      // (1, 0)\n      vertexBuffer[vertIndex++] = command.geometry[3][0]; // x + 1 * width;\n      vertexBuffer[vertIndex++] = command.geometry[3][1]; // y + 0 * height;\n      vertexBuffer[vertIndex++] = 0;\n\n      // UV coords\n      vertexBuffer[vertIndex++] = uvx1; //1;\n      vertexBuffer[vertIndex++] = uvy0; //0;\n      // texture id\n      vertexBuffer[vertIndex++] = textureId;\n      // opacity\n      vertexBuffer[vertIndex++] = command.opacity;\n      // color\n      vertexBuffer[vertIndex++] = commandColor.r / 255;\n      vertexBuffer[vertIndex++] = commandColor.g / 255;\n      vertexBuffer[vertIndex++] = commandColor.b / 255;\n      vertexBuffer[vertIndex++] = commandColor.a;\n\n      // (0, 1)\n      vertexBuffer[vertIndex++] = command.geometry[4][0]; // x + 0 * width;\n      vertexBuffer[vertIndex++] = command.geometry[4][1]; // y + 1 * height\n      vertexBuffer[vertIndex++] = 0;\n\n      // UV coords\n      vertexBuffer[vertIndex++] = uvx0; // 0;\n      vertexBuffer[vertIndex++] = uvy1; // 1;\n      // texture id\n      vertexBuffer[vertIndex++] = textureId;\n      // opacity\n      vertexBuffer[vertIndex++] = command.opacity;\n      // color\n      vertexBuffer[vertIndex++] = commandColor.r / 255;\n      vertexBuffer[vertIndex++] = commandColor.g / 255;\n      vertexBuffer[vertIndex++] = commandColor.b / 255;\n      vertexBuffer[vertIndex++] = commandColor.a;\n\n      // (1, 1)\n      vertexBuffer[vertIndex++] = command.geometry[5][0]; // x + 1 * width;\n      vertexBuffer[vertIndex++] = command.geometry[5][1]; // y + 1 * height;\n      vertexBuffer[vertIndex++] = 0;\n\n      // UV coords\n      vertexBuffer[vertIndex++] = uvx1; // 1;\n      vertexBuffer[vertIndex++] = uvy1; // 1;\n      // texture id\n      vertexBuffer[vertIndex++] = textureId;\n      // opacity\n      vertexBuffer[vertIndex++] = command.opacity;\n      // color\n      vertexBuffer[vertIndex++] = commandColor.r / 255;\n      vertexBuffer[vertIndex++] = commandColor.g / 255;\n      vertexBuffer[vertIndex++] = commandColor.b / 255;\n      vertexBuffer[vertIndex++] = commandColor.a;\n    }\n\n    return vertIndex / this.vertexSize;\n  }\n}\n","export default \"attribute vec4 a_position;\\n\\n// Opacity \\nattribute float a_opacity;\\nvarying float v_opacity;\\n\\nattribute vec4 a_color;\\nvarying vec4 v_color;\\n\\n// UV coordinate\\nattribute vec2 a_texcoord;\\nvarying vec2 v_texcoord;\\n\\n// Texture number\\nattribute lowp float a_textureIndex;\\nvarying lowp float v_textureIndex;\\n\\nuniform mat4 u_matrix;\\n\\n\\nvoid main() {\\n   // Set the vertex position using the ortho transform matrix\\n   gl_Position = u_matrix * a_position;\\n\\n   // Pass through the Opacity to the fragment shader\\n   v_opacity = a_opacity;\\n   // Pass through the UV coord to the fragment shader\\n   v_texcoord = a_texcoord;\\n   // Pass through the texture number to the fragment shader\\n   v_textureIndex = a_textureIndex;\\n   // Pass through the color to the fragment shader\\n   v_color = a_color;\\n}\";","export default \"#ifdef GL_OES_standard_derivatives\\n#extension GL_OES_standard_derivatives : enable\\n#endif\\nprecision mediump float;\\n\\n// UV coord\\nvarying vec2 v_texcoord;\\n\\n// Texture index\\nvarying lowp float v_textureIndex;\\n\\n// Color coord to blend with image\\nvarying lowp vec4 v_color;\\n\\n// Opacity\\nvarying float v_opacity;\\n\\nuniform sampler2D u_textures[%%count%%];\\n\\nfloat circle(in vec2 st, in float radius) {\\n  vec2 dist = st - vec2(0.5);\\n  float r = dot(dist, dist) * 4.0;\\n  float delta = fwidth(r);\\n  return 1.0 - smoothstep(radius - delta, radius + delta, r);\\n}\\n\\nvoid main() {\\n  float r = 0.0, delta = 0.0, alpha = 1.0;\\n   // In order to support the most efficient sprite batching, we have multiple\\n   // textures loaded into the gpu (usually 8) this picker logic skips over textures\\n   // that do not apply to a particular sprite.\\n\\n   vec4 color;\\n   // -1 If there is no texture to sample we are drawing a solid geometry (rectangles)\\n   if (v_textureIndex == -1.0) {\\n     color = v_color;\\n     color.w = color.w * v_opacity;\\n   // -2 If there is no texture we are drawing a circle\\n   } else if (v_textureIndex == -2.0) {\\n     color = v_color;\\n     color.a = color.a * circle(v_texcoord, .95);\\n   } else {\\n     // GLSL is templated out to pick the right texture and set the vec4 color\\n      %%texture_picker%%\\n   }\\n   color.w = color.w * v_opacity;\\n   gl_FragColor = color;\\n}\";","import { Shader } from './shader';\nimport pointVertexSource from './shaders/point-vertex.glsl';\nimport pointFragmentSource from './shaders/point-fragment.glsl';\nimport { Vector } from '../../Math/vector';\nimport { Color } from '../../Color';\nimport { BatchRenderer } from './renderer';\nimport { BatchCommand } from './batch';\nimport { WebGLGraphicsContextInfo } from './ExcaliburGraphicsContextWebGL';\nimport { Pool, Poolable } from '../../Util/Pool';\n// import { Random } from '../../Math/Index';\n\nexport class DrawPoint implements Poolable {\n  _pool?: Pool<this>;\n  public point: Vector = Vector.Zero;\n  public color: Color = Color.Black;\n  public size: number = 1;\n  public dispose() {\n    this.point.setTo(0, 0);\n    this.color.r = 0;\n    this.color.g = 0;\n    this.color.b = 0;\n    this.color.a = 1;\n    this.size = 1;\n    return this;\n  }\n}\n\nexport class PointRenderer extends BatchRenderer<DrawPoint> {\n  constructor(gl: WebGLRenderingContext, private _contextInfo: WebGLGraphicsContextInfo) {\n    super({ gl, command: DrawPoint, verticesPerCommand: 1 });\n    this.init();\n  }\n\n  buildShader(gl: WebGLRenderingContext): Shader {\n    gl.getExtension('OES_standard_derivatives');\n    const shader = new Shader(gl, pointVertexSource, pointFragmentSource);\n    shader.addAttribute('a_position', 2, gl.FLOAT);\n    shader.addAttribute('a_color', 4, gl.FLOAT);\n    shader.addAttribute('a_size', 1, gl.FLOAT);\n    shader.addUniformMatrix('u_matrix', this._contextInfo.matrix.data);\n    return shader;\n  }\n\n  addPoint(point: Vector, color: Color, size: number) {\n    const cmd = this.commands.get();\n    cmd.point = this._contextInfo.transform.current.multv(point);\n    cmd.color.r = color.r;\n    cmd.color.g = color.g;\n    cmd.color.b = color.b;\n    cmd.color.a = color.a * this._contextInfo.state.current.opacity;\n    cmd.size = size * Math.max(this._contextInfo.transform.current.getScaleX(), this._contextInfo.transform.current.getScaleY());\n    this.addCommand(cmd);\n  }\n\n  buildBatchVertices(vertexBuffer: Float32Array, batch: BatchCommand<DrawPoint>): number {\n    let index = 0;\n    for (const command of batch.commands) {\n      vertexBuffer[index++] = command.point.x;\n      vertexBuffer[index++] = command.point.y;\n      // normalize to [0, 1] for webgl\n      vertexBuffer[index++] = command.color.r / 255;\n      vertexBuffer[index++] = command.color.g / 255;\n      vertexBuffer[index++] = command.color.b / 255;\n      vertexBuffer[index++] = command.color.a;\n\n      vertexBuffer[index++] = command.size;\n    }\n    return index / this.vertexSize;\n  }\n\n  renderBatch(gl: WebGLRenderingContext, _batch: BatchCommand<DrawPoint>, vertexCount: number): void {\n    gl.drawArrays(gl.POINTS, 0, vertexCount);\n  }\n}\n","export default \"attribute vec4 a_position;\\nattribute vec4 a_color;\\nattribute float a_size;\\nvarying lowp vec4 v_color;\\nuniform mat4 u_matrix;\\n\\nvoid main() {\\n  gl_Position = u_matrix * a_position;\\n  gl_PointSize = a_size * 2.0;\\n  v_color = a_color;\\n}\";","export default \"#ifdef GL_OES_standard_derivatives\\n#extension GL_OES_standard_derivatives : enable\\n#endif\\n\\nprecision mediump float;\\nvarying lowp vec4 v_color;\\n\\nvoid main() {\\n  float r = 0.0, delta = 0.0, alpha = 1.0;\\n  vec2 cxy = 2.0 * gl_PointCoord - 1.0;\\n  r = dot(cxy, cxy);\\n  \\n#ifdef GL_OES_standard_derivatives\\n  delta = fwidth(r);\\n  alpha = 1.0 - smoothstep(1.0 - delta, 1.0 + delta, r);\\n#else\\n  if (r > 1.0) {\\n    discard;\\n  }\\n#endif\\n  gl_FragColor = vec4(v_color.rgb, v_color.a * alpha);\\n}\";","import {\n  ExcaliburGraphicsContext,\n  LineGraphicsOptions,\n  RectGraphicsOptions,\n  PointGraphicsOptions,\n  ExcaliburGraphicsContextOptions,\n  DebugDraw,\n  HTMLImageSource\n} from './ExcaliburGraphicsContext';\n\nimport { Matrix } from '../../Math/matrix';\nimport { TransformStack } from './transform-stack';\nimport { Vector, vec } from '../../Math/vector';\nimport { Color } from '../../Color';\nimport { StateStack } from './state-stack';\nimport { Logger } from '../../Util/Log';\nimport { LineRenderer } from './line-renderer';\nimport { ImageRenderer } from './image-renderer';\nimport { PointRenderer } from './point-renderer';\nimport { Canvas } from '../Canvas';\nimport { GraphicsDiagnostics } from '../GraphicsDiagnostics';\nimport { DebugText } from './debug-text';\n\nclass ExcaliburGraphicsContextWebGLDebug implements DebugDraw {\n  private _debugText = new DebugText();\n  constructor(private _webglCtx: ExcaliburGraphicsContextWebGL) {}\n\n  /**\n   * Draw a debugging rectangle to the context\n   * @param x\n   * @param y\n   * @param width\n   * @param height\n   */\n  drawRect(x: number, y: number, width: number, height: number, rectOptions: RectGraphicsOptions = { color: Color.Black }): void {\n    this.drawLine(vec(x, y), vec(x + width, y), { ...rectOptions });\n    this.drawLine(vec(x + width, y), vec(x + width, y + height), { ...rectOptions });\n    this.drawLine(vec(x + width, y + height), vec(x, y + height), { ...rectOptions });\n    this.drawLine(vec(x, y + height), vec(x, y), { ...rectOptions });\n  }\n\n  /**\n   * Draw a debugging line to the context\n   * @param start\n   * @param end\n   * @param lineOptions\n   */\n  drawLine(start: Vector, end: Vector, lineOptions: LineGraphicsOptions = { color: Color.Black }): void {\n    this._webglCtx.__lineRenderer.addLine(start, end, lineOptions.color);\n  }\n\n  /**\n   * Draw a debugging point to the context\n   * @param point\n   * @param pointOptions\n   */\n  drawPoint(point: Vector, pointOptions: PointGraphicsOptions = { color: Color.Black, size: 5 }): void {\n    this._webglCtx.__pointRenderer.addPoint(point, pointOptions.color, pointOptions.size);\n  }\n\n  drawText(text: string, pos: Vector) {\n    this._debugText.write(this._webglCtx, text, pos);\n  }\n}\n\nexport interface WebGLGraphicsContextInfo {\n  transform: TransformStack;\n  state: StateStack;\n  matrix: Matrix;\n}\n\nexport class ExcaliburGraphicsContextWebGL implements ExcaliburGraphicsContext {\n  /**\n   * Meant for internal use only. Access the internal context at your own risk and no guarantees this will exist in the future.\n   * @internal\n   */\n  public __gl: WebGLRenderingContext;\n\n  /**\n   * Holds the 2d context shim\n   */\n  private _canvas: Canvas; // Configure z for shim?\n  /**\n   * Meant for internal use only. Access the internal context at your own risk and no guarantees this will exist in the future.\n   * @internal\n   */\n  public __ctx: CanvasRenderingContext2D;\n\n  private _transform = new TransformStack();\n  private _state = new StateStack();\n  private _ortho!: Matrix;\n\n  /**\n   * Meant for internal use only. Access the internal context at your own risk and no guarantees this will exist in the future.\n   * @internal\n   */\n  public __pointRenderer: PointRenderer;\n\n  /**\n   * Meant for internal use only. Access the internal context at your own risk and no guarantees this will exist in the future.\n   * @internal\n   */\n  public __lineRenderer: LineRenderer;\n\n  /**\n   * Meant for internal use only. Access the internal context at your own risk and no guarantees this will exist in the future.\n   * @internal\n   */\n  public __imageRenderer: ImageRenderer;\n\n  public snapToPixel: boolean = true;\n\n  public smoothing: boolean = false;\n\n  public backgroundColor: Color = Color.ExcaliburBlue;\n\n  public get opacity(): number {\n    return this._state.current.opacity;\n  }\n\n  public set opacity(value: number) {\n    this._state.current.opacity = value;\n  }\n\n  public get width() {\n    return this.__gl.canvas.width;\n  }\n\n  public get height() {\n    return this.__gl.canvas.height;\n  }\n\n  constructor(options: ExcaliburGraphicsContextOptions) {\n    const { canvasElement, enableTransparency, smoothing, snapToPixel, backgroundColor } = options;\n    this.__gl = canvasElement.getContext('webgl', {\n      antialias: smoothing ?? this.smoothing,\n      premultipliedAlpha: false,\n      alpha: enableTransparency ?? true,\n      depth: true,\n      powerPreference: 'high-performance'\n    });\n    this.snapToPixel = snapToPixel ?? this.snapToPixel;\n    this.smoothing = smoothing ?? this.smoothing;\n    this.backgroundColor = backgroundColor ?? this.backgroundColor;\n    this._init();\n  }\n\n  private _init() {\n    const gl = this.__gl;\n    // Setup viewport and view matrix\n    this._ortho = Matrix.ortho(0, gl.canvas.width, gl.canvas.height, 0, 400, -400);\n    gl.viewport(0, 0, gl.canvas.width, gl.canvas.height);\n\n    // Clear background\n    gl.clearColor(this.backgroundColor.r / 255, this.backgroundColor.g / 255, this.backgroundColor.b / 255, this.backgroundColor.a);\n    gl.clear(gl.COLOR_BUFFER_BIT);\n\n    // Enable alpha blending\n    gl.enable(gl.BLEND);\n    gl.blendFunc(gl.SRC_ALPHA, gl.ONE_MINUS_SRC_ALPHA);\n\n    this.__pointRenderer = new PointRenderer(gl, { matrix: this._ortho, transform: this._transform, state: this._state });\n    this.__lineRenderer = new LineRenderer(gl, { matrix: this._ortho, transform: this._transform, state: this._state });\n    this.__imageRenderer = new ImageRenderer(gl, { matrix: this._ortho, transform: this._transform, state: this._state });\n\n    // 2D ctx shim\n    this._canvas = new Canvas({\n      width: gl.canvas.width,\n      height: gl.canvas.height\n    });\n    this.__ctx = this._canvas.ctx;\n  }\n\n  public resetTransform(): void {\n    this._transform.current = Matrix.identity();\n  }\n\n  public updateViewport(): void {\n    const gl = this.__gl;\n    this._ortho = this._ortho = Matrix.ortho(0, gl.canvas.width, gl.canvas.height, 0, 400, -400);\n    this.__pointRenderer.shader.addUniformMatrix('u_matrix', this._ortho.data);\n    this.__lineRenderer.shader.addUniformMatrix('u_matrix', this._ortho.data);\n    this.__imageRenderer.shader.addUniformMatrix('u_matrix', this._ortho.data);\n\n    // 2D ctx shim\n    this._canvas.width = gl.canvas.width;\n    this._canvas.height = gl.canvas.height;\n  }\n\n  drawImage(image: HTMLImageSource, x: number, y: number): void;\n  drawImage(image: HTMLImageSource, x: number, y: number, width: number, height: number): void;\n  drawImage(\n    image: HTMLImageSource,\n    sx: number,\n    sy: number,\n    swidth?: number,\n    sheight?: number,\n    dx?: number,\n    dy?: number,\n    dwidth?: number,\n    dheight?: number\n  ): void;\n  drawImage(\n    image: HTMLImageSource,\n    sx: number,\n    sy: number,\n    swidth?: number,\n    sheight?: number,\n    dx?: number,\n    dy?: number,\n    dwidth?: number,\n    dheight?: number\n  ): void {\n    if (swidth === 0 || sheight === 0) {\n      return; // zero dimension dest exit early\n    } else if (dwidth === 0 || dheight === 0) {\n      return; // zero dimension dest exit early\n    } else if (image.width === 0 || image.height === 0) {\n      return; // zero dimension source exit early\n    }\n\n    if (!image) {\n      Logger.getInstance().warn('Cannot draw a null or undefined image');\n      // tslint:disable-next-line: no-console\n      if (console.trace) {\n        // tslint:disable-next-line: no-console\n        console.trace();\n      }\n      return;\n    }\n    this.__imageRenderer.addImage(image, sx, sy, swidth, sheight, dx, dy, dwidth, dheight);\n  }\n\n  public drawLine(start: Vector, end: Vector, color: Color, thickness = 1) {\n    this.__imageRenderer.addLine(color, start, end, thickness);\n  }\n\n  public drawRectangle(pos: Vector, width: number, height: number, color: Color) {\n    this.__imageRenderer.addRectangle(color, pos, width, height);\n  }\n\n  public drawCircle(pos: Vector, radius: number, color: Color) {\n    this.__imageRenderer.addCircle(pos, radius, color);\n  }\n\n  debug = new ExcaliburGraphicsContextWebGLDebug(this);\n\n  public save(): void {\n    this._transform.save();\n    this._state.save();\n  }\n\n  public restore(): void {\n    this._transform.restore();\n    this._state.restore();\n  }\n\n  public translate(x: number, y: number): void {\n    this._transform.translate(this.snapToPixel ? ~~x : x, this.snapToPixel ? ~~y : y);\n  }\n\n  public rotate(angle: number): void {\n    this._transform.rotate(angle);\n  }\n\n  public scale(x: number, y: number): void {\n    this._transform.scale(x, y);\n  }\n\n  public transform(matrix: Matrix) {\n    this._transform.current = matrix;\n  }\n\n  clear() {\n    const gl = this.__gl;\n    gl.clearColor(this.backgroundColor.r / 255, this.backgroundColor.g / 255, this.backgroundColor.b / 255, this.backgroundColor.a);\n    // Clear the context with the newly set color. This is\n    // the function call that actually does the drawing.\n    gl.clear(gl.COLOR_BUFFER_BIT);\n    GraphicsDiagnostics.clear();\n  }\n\n  /**\n   * Flushes all batched rendering to the screen\n   */\n  flush() {\n    const gl = this.__gl;\n    gl.viewport(0, 0, gl.canvas.width, gl.canvas.height);\n\n    this.__imageRenderer.render();\n    this.__lineRenderer.render();\n    this.__pointRenderer.render();\n  }\n}\n","import { EX_VERSION } from './';\nimport { Flags, Legacy } from './Flags';\nimport { polyfill } from './Polyfill';\npolyfill();\nimport { CanUpdate, CanDraw, CanInitialize } from './Interfaces/LifecycleEvents';\nimport { Loadable } from './Interfaces/Loadable';\nimport { Vector } from './Math/vector';\nimport { Screen, DisplayMode, AbsolutePosition, ScreenDimension, Resolution } from './Screen';\nimport { ScreenElement } from './ScreenElement';\nimport { Actor } from './Actor';\nimport { Timer } from './Timer';\nimport { TileMap } from './TileMap';\nimport { Animation } from './Drawing/Animation';\nimport { Loader } from './Loader';\nimport { Detector } from './Util/Detector';\nimport {\n  VisibleEvent,\n  HiddenEvent,\n  GameStartEvent,\n  GameStopEvent,\n  PreUpdateEvent,\n  PostUpdateEvent,\n  PreFrameEvent,\n  PostFrameEvent,\n  GameEvent,\n  DeactivateEvent,\n  ActivateEvent,\n  PreDrawEvent,\n  PostDrawEvent,\n  InitializeEvent\n} from './Events';\nimport { Logger, LogLevel } from './Util/Log';\nimport { Color } from './Color';\nimport { Scene } from './Scene';\nimport { Entity } from './EntityComponentSystem/Entity';\nimport { PostProcessor } from './PostProcessing/PostProcessor';\nimport { Debug, DebugStats } from './Debug/Debug';\nimport { Class } from './Class';\nimport * as Input from './Input/Index';\nimport * as Events from './Events';\nimport { BrowserEvents } from './Util/Browser';\nimport { obsolete } from './Util/Decorators';\nimport { ExcaliburGraphicsContext, ExcaliburGraphicsContext2DCanvas, ExcaliburGraphicsContextWebGL } from './Graphics';\n\n/**\n * Enum representing the different mousewheel event bubble prevention\n */\nexport enum ScrollPreventionMode {\n  /**\n   * Do not prevent any page scrolling\n   */\n  None,\n  /**\n   * Prevent page scroll if mouse is over the game canvas\n   */\n  Canvas,\n  /**\n   * Prevent all page scrolling via mouse wheel\n   */\n  All\n}\n\n/**\n * Defines the available options to configure the Excalibur engine at constructor time.\n */\nexport interface EngineOptions {\n  /**\n   * Optionally configure the width of the viewport in css pixels\n   */\n  width?: number;\n\n  /**\n   * Optionally configure the height of the viewport in css pixels\n   */\n  height?: number;\n\n  /**\n   * Optionally configure the width & height of the viewport in css pixels.\n   * Use `viewport` instead of [[EngineOptions.width]] and [[EngineOptions.height]], or vice versa.\n   */\n  viewport?: ScreenDimension;\n\n  /**\n   * Optionally specify the size the logical pixel resolution, if not specified it will be width x height.\n   * See [[Resolution]] for common presets.\n   */\n  resolution?: ScreenDimension;\n\n  /**\n   * Optionally specify antialiasing (smoothing), by default true (smooth pixels)\n   */\n  antialiasing?: boolean;\n\n  /**\n   * Optionally configure the native canvas transparent backdrop\n   */\n  enableCanvasTransparency?: boolean;\n\n  /**\n   * Optionally specify the target canvas DOM element to render the game in\n   */\n  canvasElementId?: string;\n\n  /**\n   * Optionally specify the target canvas DOM element directly\n   */\n  canvasElement?: HTMLCanvasElement;\n\n  /**\n   * Optionally snap drawings to nearest pixel\n   */\n  snapToPixel?: boolean;\n\n  /**\n   * The [[DisplayMode]] of the game, by default [[DisplayMode.FitScreen]] with aspect ratio 4:3 (800x600).\n   * Depending on this value, [[width]] and [[height]] may be ignored.\n   */\n  displayMode?: DisplayMode;\n\n  /**\n   * Configures the pointer scope. Pointers scoped to the 'Canvas' can only fire events within the canvas viewport; whereas, 'Document'\n   * (default) scoped will fire anywhere on the page.\n   */\n  pointerScope?: Input.PointerScope;\n\n  /**\n   * Suppress boot up console message, which contains the \"powered by Excalibur message\"\n   */\n  suppressConsoleBootMessage?: boolean;\n\n  /**\n   * Suppress minimum browser feature detection, it is not recommended users of excalibur switch this off. This feature ensures that\n   * the currently running browser meets the minimum requirements for running excalibur. This can be useful if running on non-standard\n   * browsers or if there is a bug in excalibur preventing execution.\n   */\n  suppressMinimumBrowserFeatureDetection?: boolean;\n\n  /**\n   * Suppress HiDPI auto detection and scaling, it is not recommended users of excalibur switch off this feature. This feature detects\n   * and scales the drawing canvas appropriately to accommodate HiDPI screens.\n   */\n  suppressHiDPIScaling?: boolean;\n\n  /**\n   * Suppress play button, it is not recommended users of excalibur switch this feature. Some browsers require a user gesture (like a click)\n   * for certain browser features to work like web audio.\n   */\n  suppressPlayButton?: boolean;\n\n  /**\n   * Specify how the game window is to be positioned when the [[DisplayMode.Position]] is chosen. This option MUST be specified\n   * if the DisplayMode is set as [[DisplayMode.Position]]. The position can be either a string or an [[AbsolutePosition]].\n   * String must be in the format of css style background-position. The vertical position must precede the horizontal position in strings.\n   *\n   * Valid String examples: \"top left\", \"top\", \"bottom\", \"middle\", \"middle center\", \"bottom right\"\n   * Valid [[AbsolutePosition]] examples: `{top: 5, right: 10%}`, `{bottom: 49em, left: 10px}`, `{left: 10, bottom: 40}`\n   */\n  position?: string | AbsolutePosition;\n\n  /**\n   * Scroll prevention method.\n   */\n  scrollPreventionMode?: ScrollPreventionMode;\n\n  /**\n   * Optionally set the background color\n   */\n  backgroundColor?: Color;\n}\n\n/**\n * The Excalibur Engine\n *\n * The [[Engine]] is the main driver for a game. It is responsible for\n * starting/stopping the game, maintaining state, transmitting events,\n * loading resources, and managing the scene.\n */\nexport class Engine extends Class implements CanInitialize, CanUpdate, CanDraw {\n  /**\n   *\n   */\n  public browser: BrowserEvents;\n\n  /**\n   * Screen abstraction\n   */\n  public screen: Screen;\n\n  /**\n   * Direct access to the engine's canvas element\n   */\n  public canvas: HTMLCanvasElement;\n\n  /**\n   * Direct access to the engine's 2D rendering context\n   */\n  public ctx: CanvasRenderingContext2D;\n\n  public graphicsContext: ExcaliburGraphicsContext;\n\n  /**\n   * Direct access to the canvas element ID, if an ID exists\n   */\n  public canvasElementId: string;\n\n  /**\n   * The width of the game canvas in pixels (physical width component of the\n   * resolution of the canvas element)\n   */\n  public get canvasWidth(): number {\n    return this.screen.canvasWidth;\n  }\n\n  /**\n   * Returns half width of the game canvas in pixels (half physical width component)\n   */\n  public get halfCanvasWidth(): number {\n    return this.screen.halfCanvasWidth;\n  }\n\n  /**\n   * The height of the game canvas in pixels, (physical height component of\n   * the resolution of the canvas element)\n   */\n  public get canvasHeight(): number {\n    return this.screen.canvasHeight;\n  }\n\n  /**\n   * Returns half height of the game canvas in pixels (half physical height component)\n   */\n  public get halfCanvasHeight(): number {\n    return this.screen.halfCanvasHeight;\n  }\n\n  /**\n   * Returns the width of the engine's visible drawing surface in pixels including zoom and device pixel ratio.\n   */\n  public get drawWidth(): number {\n    return this.screen.drawWidth;\n  }\n\n  /**\n   * Returns half the width of the engine's visible drawing surface in pixels including zoom and device pixel ratio.\n   */\n  public get halfDrawWidth(): number {\n    return this.screen.halfDrawWidth;\n  }\n\n  /**\n   * Returns the height of the engine's visible drawing surface in pixels including zoom and device pixel ratio.\n   */\n  public get drawHeight(): number {\n    return this.screen.drawHeight;\n  }\n\n  /**\n   * Returns half the height of the engine's visible drawing surface in pixels including zoom and device pixel ratio.\n   */\n  public get halfDrawHeight(): number {\n    return this.screen.halfDrawHeight;\n  }\n\n  /**\n   * Returns whether excalibur detects the current screen to be HiDPI\n   */\n  public get isHiDpi(): boolean {\n    return this.screen.isHiDpi;\n  }\n\n  /**\n   * Access engine input like pointer, keyboard, or gamepad\n   */\n  public input: Input.EngineInput;\n\n  private _hasStarted: boolean = false;\n\n  /**\n   * Access Excalibur debugging functionality.\n   */\n  public debug: Debug;\n\n  /**\n   * Access [[stats]] that holds frame statistics.\n   */\n  public get stats(): DebugStats {\n    return this.debug.stats;\n  }\n\n  /**\n   * Gets or sets the list of post processors to apply at the end of drawing a frame (such as [[ColorBlindCorrector]])\n   */\n  public postProcessors: PostProcessor[] = [];\n\n  /**\n   * The current [[Scene]] being drawn and updated on screen\n   */\n  public currentScene: Scene;\n\n  /**\n   * The default [[Scene]] of the game, use [[Engine.goToScene]] to transition to different scenes.\n   */\n  public readonly rootScene: Scene;\n\n  /**\n   * Contains all the scenes currently registered with Excalibur\n   */\n  public readonly scenes: { [key: string]: Scene } = {};\n\n  /**\n   * @hidden\n   * @deprecated\n   */\n  private _animations: AnimationNode[] = [];\n\n  /**\n   * Indicates whether the engine is set to fullscreen or not\n   */\n  public get isFullscreen(): boolean {\n    return this.screen.isFullScreen;\n  }\n\n  /**\n   * Indicates the current [[DisplayMode]] of the engine.\n   */\n  public get displayMode(): DisplayMode {\n    return this.screen.displayMode;\n  }\n\n  private _suppressPlayButton: boolean = false;\n  /**\n   * Returns the calculated pixel ration for use in rendering\n   */\n  public get pixelRatio(): number {\n    return this.screen.pixelRatio;\n  }\n\n  /**\n   * Indicates the current position of the engine. Valid only when DisplayMode is DisplayMode.Position\n   */\n  public position: string | AbsolutePosition;\n  /**\n   * Indicates whether audio should be paused when the game is no longer visible.\n   */\n  public pauseAudioWhenHidden: boolean = true;\n\n  /**\n   * Indicates whether the engine should draw with debug information\n   */\n  private _isDebug: boolean = false;\n  public get isDebug(): boolean {\n    return this._isDebug;\n  }\n  public debugColor: Color = new Color(255, 255, 255);\n  /**\n   * Sets the background color for the engine.\n   */\n  public backgroundColor: Color;\n\n  /**\n   * Sets the Transparency for the engine.\n   */\n  public enableCanvasTransparency: boolean = true;\n\n  /**\n   * The action to take when a fatal exception is thrown\n   */\n  public onFatalException = (e: any) => {\n    Logger.getInstance().fatal(e);\n  };\n\n  /**\n   * The mouse wheel scroll prevention mode\n   */\n  public pageScrollPreventionMode: ScrollPreventionMode;\n\n  private _logger: Logger;\n\n  // this is a reference to the current requestAnimationFrame return value\n  private _requestId: number;\n\n  // this determines whether excalibur is compatible with your browser\n  private _compatible: boolean;\n\n  private _timescale: number = 1.0;\n\n  // loading\n  private _loader: Loader;\n  private _isLoading: boolean = false;\n\n  private _isInitialized: boolean = false;\n\n  private _deferredGoTo: string = null;\n\n  public on(eventName: Events.initialize, handler: (event: Events.InitializeEvent<Engine>) => void): void;\n  public on(eventName: Events.visible, handler: (event: VisibleEvent) => void): void;\n  public on(eventName: Events.hidden, handler: (event: HiddenEvent) => void): void;\n  public on(eventName: Events.start, handler: (event: GameStartEvent) => void): void;\n  public on(eventName: Events.stop, handler: (event: GameStopEvent) => void): void;\n  public on(eventName: Events.preupdate, handler: (event: PreUpdateEvent<Engine>) => void): void;\n  public on(eventName: Events.postupdate, handler: (event: PostUpdateEvent<Engine>) => void): void;\n  public on(eventName: Events.preframe, handler: (event: PreFrameEvent) => void): void;\n  public on(eventName: Events.postframe, handler: (event: PostFrameEvent) => void): void;\n  public on(eventName: Events.predraw, handler: (event: PreDrawEvent) => void): void;\n  public on(eventName: Events.postdraw, handler: (event: PostDrawEvent) => void): void;\n  public on(eventName: string, handler: (event: GameEvent<any>) => void): void;\n  public on(eventName: string, handler: (event: any) => void): void {\n    super.on(eventName, handler);\n  }\n\n  public once(eventName: Events.initialize, handler: (event: Events.InitializeEvent<Engine>) => void): void;\n  public once(eventName: Events.visible, handler: (event: VisibleEvent) => void): void;\n  public once(eventName: Events.hidden, handler: (event: HiddenEvent) => void): void;\n  public once(eventName: Events.start, handler: (event: GameStartEvent) => void): void;\n  public once(eventName: Events.stop, handler: (event: GameStopEvent) => void): void;\n  public once(eventName: Events.preupdate, handler: (event: PreUpdateEvent<Engine>) => void): void;\n  public once(eventName: Events.postupdate, handler: (event: PostUpdateEvent<Engine>) => void): void;\n  public once(eventName: Events.preframe, handler: (event: PreFrameEvent) => void): void;\n  public once(eventName: Events.postframe, handler: (event: PostFrameEvent) => void): void;\n  public once(eventName: Events.predraw, handler: (event: PreDrawEvent) => void): void;\n  public once(eventName: Events.postdraw, handler: (event: PostDrawEvent) => void): void;\n  public once(eventName: string, handler: (event: GameEvent<any>) => void): void;\n  public once(eventName: string, handler: (event: any) => void): void {\n    super.once(eventName, handler);\n  }\n\n  public off(eventName: Events.initialize, handler?: (event: Events.InitializeEvent<Engine>) => void): void;\n  public off(eventName: Events.visible, handler?: (event: VisibleEvent) => void): void;\n  public off(eventName: Events.hidden, handler?: (event: HiddenEvent) => void): void;\n  public off(eventName: Events.start, handler?: (event: GameStartEvent) => void): void;\n  public off(eventName: Events.stop, handler?: (event: GameStopEvent) => void): void;\n  public off(eventName: Events.preupdate, handler?: (event: PreUpdateEvent<Engine>) => void): void;\n  public off(eventName: Events.postupdate, handler?: (event: PostUpdateEvent<Engine>) => void): void;\n  public off(eventName: Events.preframe, handler?: (event: PreFrameEvent) => void): void;\n  public off(eventName: Events.postframe, handler?: (event: PostFrameEvent) => void): void;\n  public off(eventName: Events.predraw, handler?: (event: PreDrawEvent) => void): void;\n  public off(eventName: Events.postdraw, handler?: (event: PostDrawEvent) => void): void;\n  public off(eventName: string, handler?: (event: GameEvent<any>) => void): void;\n  public off(eventName: string, handler?: (event: any) => void): void {\n    super.off(eventName, handler);\n  }\n\n  /**\n   * Default [[EngineOptions]]\n   */\n  private static _DEFAULT_ENGINE_OPTIONS: EngineOptions = {\n    width: 0,\n    height: 0,\n    enableCanvasTransparency: true,\n    canvasElementId: '',\n    canvasElement: undefined,\n    snapToPixel: false,\n    pointerScope: Input.PointerScope.Canvas,\n    suppressConsoleBootMessage: null,\n    suppressMinimumBrowserFeatureDetection: null,\n    suppressHiDPIScaling: null,\n    suppressPlayButton: null,\n    scrollPreventionMode: ScrollPreventionMode.Canvas,\n    backgroundColor: Color.fromHex('#2185d0') // Excalibur blue\n  };\n\n  /**\n   * Creates a new game using the given [[EngineOptions]]. By default, if no options are provided,\n   * the game will be rendered full screen (taking up all available browser window space).\n   * You can customize the game rendering through [[EngineOptions]].\n   *\n   * Example:\n   *\n   * ```js\n   * var game = new ex.Engine({\n   *   width: 0, // the width of the canvas\n   *   height: 0, // the height of the canvas\n   *   enableCanvasTransparency: true, // the transparencySection of the canvas\n   *   canvasElementId: '', // the DOM canvas element ID, if you are providing your own\n   *   displayMode: ex.DisplayMode.FullScreen, // the display mode\n   *   pointerScope: ex.Input.PointerScope.Document, // the scope of capturing pointer (mouse/touch) events\n   *   backgroundColor: ex.Color.fromHex('#2185d0') // background color of the engine\n   * });\n   *\n   * // call game.start, which is a Promise\n   * game.start().then(function () {\n   *   // ready, set, go!\n   * });\n   * ```\n   */\n  constructor(options?: EngineOptions) {\n    super();\n\n    options = { ...Engine._DEFAULT_ENGINE_OPTIONS, ...options };\n\n    Flags.freeze();\n\n    // Initialize browser events facade\n    this.browser = new BrowserEvents(window, document);\n\n    // Check compatibility\n    const detector = new Detector();\n    if (!options.suppressMinimumBrowserFeatureDetection && !(this._compatible = detector.test())) {\n      const message = document.createElement('div');\n      message.innerText = 'Sorry, your browser does not support all the features needed for Excalibur';\n      document.body.appendChild(message);\n\n      detector.failedTests.forEach(function (test) {\n        const testMessage = document.createElement('div');\n        testMessage.innerText = 'Browser feature missing ' + test;\n        document.body.appendChild(testMessage);\n      });\n\n      if (options.canvasElementId) {\n        const canvas = document.getElementById(options.canvasElementId);\n        if (canvas) {\n          canvas.parentElement.removeChild(canvas);\n        }\n      }\n\n      return;\n    } else {\n      this._compatible = true;\n    }\n\n    // Use native console API for color fun\n    // eslint-disable-next-line no-console\n    if (console.log && !options.suppressConsoleBootMessage) {\n      // eslint-disable-next-line no-console\n      console.log(\n        `%cPowered by Excalibur.js (v${EX_VERSION})`,\n        'background: #176BAA; color: white; border-radius: 5px; padding: 15px; font-size: 1.5em; line-height: 80px;'\n      );\n      // eslint-disable-next-line no-console\n      console.log('\\n\\\n      /| ________________\\n\\\nO|===|* >________________>\\n\\\n      \\\\|');\n      // eslint-disable-next-line no-console\n      console.log('Visit', 'http://excaliburjs.com', 'for more information');\n    }\n\n    // Suppress play button\n    if (options.suppressPlayButton) {\n      this._suppressPlayButton = true;\n    }\n\n    this._logger = Logger.getInstance();\n\n    // If debug is enabled, let's log browser features to the console.\n    if (this._logger.defaultLevel === LogLevel.Debug) {\n      detector.logBrowserFeatures();\n    }\n\n    this._logger.debug('Building engine...');\n\n    this.canvasElementId = options.canvasElementId;\n\n    if (options.canvasElementId) {\n      this._logger.debug('Using Canvas element specified: ' + options.canvasElementId);\n      this.canvas = <HTMLCanvasElement>document.getElementById(options.canvasElementId);\n    } else if (options.canvasElement) {\n      this._logger.debug('Using Canvas element specified:', options.canvasElement);\n      this.canvas = options.canvasElement;\n    } else {\n      this._logger.debug('Using generated canvas element');\n      this.canvas = <HTMLCanvasElement>document.createElement('canvas');\n    }\n\n    let displayMode = options.displayMode ?? DisplayMode.Fixed;\n    if ((options.width && options.height) || options.viewport) {\n      if (options.displayMode === undefined) {\n        displayMode = DisplayMode.Fixed;\n      }\n      this._logger.debug('Engine viewport is size ' + options.width + ' x ' + options.height);\n    } else if (!options.displayMode) {\n      this._logger.debug('Engine viewport is fit');\n      displayMode = DisplayMode.FitScreen;\n    }\n\n    if (Flags.isEnabled(Legacy.Canvas)) {\n      const ex2dCtx = new ExcaliburGraphicsContext2DCanvas({\n        canvasElement: this.canvas,\n        enableTransparency: this.enableCanvasTransparency,\n        smoothing: options.antialiasing,\n        backgroundColor: options.backgroundColor,\n        snapToPixel: options.snapToPixel\n      });\n      this.graphicsContext = ex2dCtx;\n      this.ctx = ex2dCtx.__ctx;\n    } else {\n      const exWebglCtx = new ExcaliburGraphicsContextWebGL({\n        canvasElement: this.canvas,\n        enableTransparency: this.enableCanvasTransparency,\n        smoothing: options.antialiasing,\n        backgroundColor: options.backgroundColor,\n        snapToPixel: options.snapToPixel\n      });\n      this.graphicsContext = exWebglCtx;\n      this.ctx = exWebglCtx.__ctx;\n    }\n\n    this.screen = new Screen({\n      canvas: this.canvas,\n      context: this.graphicsContext,\n      antialiasing: options.antialiasing ?? true,\n      browser: this.browser,\n      viewport: options.viewport ?? (options.width && options.height ? { width: options.width, height: options.height } : Resolution.SVGA),\n      resolution: options.resolution,\n      displayMode,\n      position: options.position,\n      pixelRatio: options.suppressHiDPIScaling ? 1 : null\n    });\n\n    this.screen.applyResolutionAndViewport();\n\n    if (options.backgroundColor) {\n      this.backgroundColor = options.backgroundColor.clone();\n    }\n\n    this.enableCanvasTransparency = options.enableCanvasTransparency;\n\n    this._loader = new Loader();\n    this.debug = new Debug(this);\n\n    this._initialize(options);\n\n    this.rootScene = this.currentScene = new Scene();\n\n    this.addScene('root', this.rootScene);\n  }\n\n  /**\n   * Returns a BoundingBox of the top left corner of the screen\n   * and the bottom right corner of the screen.\n   */\n  public getWorldBounds() {\n    return this.screen.getWorldBounds();\n  }\n\n  /**\n   * Gets the current engine timescale factor (default is 1.0 which is 1:1 time)\n   */\n  public get timescale() {\n    return this._timescale;\n  }\n\n  /**\n   * Sets the current engine timescale factor. Useful for creating slow-motion effects or fast-forward effects\n   * when using time-based movement.\n   */\n  public set timescale(value: number) {\n    if (value <= 0) {\n      Logger.getInstance().error('Cannot set engine.timescale to a value of 0 or less than 0.');\n      return;\n    }\n\n    this._timescale = value;\n  }\n\n  /**\n   * Plays a sprite animation on the screen at the specified `x` and `y`\n   * (in game coordinates, not screen pixels). These animations play\n   * independent of actors, and will be cleaned up internally as soon\n   * as they are complete. Note animations that loop will never be\n   * cleaned up.\n   *\n   * @param animation  Animation to play\n   * @param x          x game coordinate to play the animation\n   * @param y          y game coordinate to play the animation\n   * @deprecated\n   */\n  @obsolete({ message: 'Will be removed in excalibur v0.26.0', alternateMethod: 'Use Actor.graphics' })\n  public playAnimation(animation: Animation, x: number, y: number) {\n    this._animations.push(new AnimationNode(animation, x, y));\n  }\n\n  /**\n   * Adds a [[TileMap]] to the [[currentScene]], once this is done the TileMap\n   * will be drawn and updated.\n   */\n  public addTileMap(tileMap: TileMap) {\n    this.currentScene.addTileMap(tileMap);\n  }\n\n  /**\n   * Removes a [[TileMap]] from the [[currentScene]], it will no longer be drawn or updated.\n   */\n  public removeTileMap(tileMap: TileMap) {\n    this.currentScene.removeTileMap(tileMap);\n  }\n\n  /**\n   * Adds a [[Timer]] to the [[currentScene]].\n   * @param timer  The timer to add to the [[currentScene]].\n   */\n  public addTimer(timer: Timer): Timer {\n    return this.currentScene.addTimer(timer);\n  }\n\n  /**\n   * Removes a [[Timer]] from the [[currentScene]].\n   * @param timer  The timer to remove to the [[currentScene]].\n   */\n  public removeTimer(timer: Timer): Timer {\n    return this.currentScene.removeTimer(timer);\n  }\n\n  /**\n   * Adds a [[Scene]] to the engine, think of scenes in Excalibur as you\n   * would levels or menus.\n   *\n   * @param key  The name of the scene, must be unique\n   * @param scene The scene to add to the engine\n   */\n  public addScene(key: string, scene: Scene) {\n    if (this.scenes[key]) {\n      this._logger.warn('Scene', key, 'already exists overwriting');\n    }\n    this.scenes[key] = scene;\n  }\n\n  /**\n   * Removes a [[Scene]] instance from the engine\n   * @param scene  The scene to remove\n   */\n  public removeScene(scene: Scene): void;\n  /**\n   * Removes a scene from the engine by key\n   * @param key  The scene key to remove\n   */\n  public removeScene(key: string): void;\n  /**\n   * @internal\n   */\n  public removeScene(entity: any): void {\n    if (entity instanceof Scene) {\n      // remove scene\n      for (const key in this.scenes) {\n        if (this.scenes.hasOwnProperty(key)) {\n          if (this.scenes[key] === entity) {\n            delete this.scenes[key];\n          }\n        }\n      }\n    }\n\n    if (typeof entity === 'string') {\n      // remove scene\n      delete this.scenes[entity];\n    }\n  }\n\n  /**\n   * Adds a [[Scene]] to the engine, think of scenes in Excalibur as you\n   * would levels or menus.\n   * @param sceneKey  The key of the scene, must be unique\n   * @param scene     The scene to add to the engine\n   */\n  public add(sceneKey: string, scene: Scene): void;\n  /**\n   * Adds a [[Timer]] to the [[currentScene]].\n   * @param timer  The timer to add to the [[currentScene]].\n   */\n  public add(timer: Timer): void;\n  /**\n   * Adds a [[TileMap]] to the [[currentScene]], once this is done the TileMap\n   * will be drawn and updated.\n   */\n  public add(tileMap: TileMap): void;\n  /**\n   * Adds an actor to the [[currentScene]] of the game. This is synonymous\n   * to calling `engine.currentScene.add(actor)`.\n   *\n   * Actors can only be drawn if they are a member of a scene, and only\n   * the [[currentScene]] may be drawn or updated.\n   *\n   * @param actor  The actor to add to the [[currentScene]]\n   */\n  public add(actor: Actor): void;\n\n  /**\n   * Adds a [[ScreenElement]] to the [[currentScene]] of the game,\n   * ScreenElements do not participate in collisions, instead the\n   * remain in the same place on the screen.\n   * @param screenElement  The ScreenElement to add to the [[currentScene]]\n   */\n  public add(screenElement: ScreenElement): void;\n  public add(entity: any): void {\n    if (arguments.length === 2) {\n      this.addScene(<string>arguments[0], <Scene>arguments[1]);\n      return;\n    }\n    if (this._deferredGoTo && this.scenes[this._deferredGoTo]) {\n      this.scenes[this._deferredGoTo].add(entity);\n    } else {\n      this.currentScene.add(entity);\n    }\n  }\n\n  /**\n   * Removes a scene instance from the engine\n   * @param scene  The scene to remove\n   */\n  public remove(scene: Scene): void;\n  /**\n   * Removes a scene from the engine by key\n   * @param sceneKey  The scene to remove\n   */\n  public remove(sceneKey: string): void;\n  /**\n   * Removes a [[Timer]] from the [[currentScene]].\n   * @param timer  The timer to remove to the [[currentScene]].\n   */\n  public remove(timer: Timer): void;\n  /**\n   * Removes a [[TileMap]] from the [[currentScene]], it will no longer be drawn or updated.\n   */\n  public remove(tileMap: TileMap): void;\n  /**\n   * Removes an actor from the [[currentScene]] of the game. This is synonymous\n   * to calling `engine.currentScene.removeChild(actor)`.\n   * Actors that are removed from a scene will no longer be drawn or updated.\n   *\n   * @param actor  The actor to remove from the [[currentScene]].\n   */\n  public remove(actor: Actor): void;\n  /**\n   * Removes a [[ScreenElement]] to the scene, it will no longer be drawn or updated\n   * @param screenElement  The ScreenElement to remove from the [[currentScene]]\n   */\n  public remove(screenElement: ScreenElement): void;\n  public remove(entity: any): void {\n    if (entity instanceof Entity) {\n      this.currentScene.remove(entity);\n    }\n\n    if (entity instanceof Scene) {\n      this.removeScene(entity);\n    }\n\n    if (typeof entity === 'string') {\n      this.removeScene(entity);\n    }\n  }\n\n  /**\n   * Changes the currently updating and drawing scene to a different,\n   * named scene. Calls the [[Scene]] lifecycle events.\n   * @param key  The key of the scene to transition to.\n   */\n  public goToScene(key: string) {\n    // if not yet initialized defer goToScene\n    if (!this.isInitialized) {\n      this._deferredGoTo = key;\n      return;\n    }\n\n    if (this.scenes[key]) {\n      const oldScene = this.currentScene;\n      const newScene = this.scenes[key];\n\n      this._logger.debug('Going to scene:', key);\n\n      // only deactivate when initialized\n      if (this.currentScene.isInitialized) {\n        this.currentScene._deactivate.apply(this.currentScene, [oldScene, newScene]);\n        this.currentScene.eventDispatcher.emit('deactivate', new DeactivateEvent(newScene, this.currentScene));\n      }\n\n      // set current scene to new one\n      this.currentScene = newScene;\n      this.screen.setCurrentCamera(newScene.camera);\n\n      // initialize the current scene if has not been already\n      this.currentScene._initialize(this);\n\n      this.currentScene._activate.apply(this.currentScene, [oldScene, newScene]);\n      this.currentScene.eventDispatcher.emit('activate', new ActivateEvent(oldScene, this.currentScene));\n    } else {\n      this._logger.error('Scene', key, 'does not exist!');\n    }\n  }\n\n  /**\n   * Transforms the current x, y from screen coordinates to world coordinates\n   * @param point  Screen coordinate to convert\n   */\n  public screenToWorldCoordinates(point: Vector): Vector {\n    return this.screen.screenToWorldCoordinates(point);\n  }\n\n  /**\n   * Transforms a world coordinate, to a screen coordinate\n   * @param point  World coordinate to convert\n   */\n  public worldToScreenCoordinates(point: Vector): Vector {\n    return this.screen.worldToScreenCoordinates(point);\n  }\n\n  /**\n   * Initializes the internal canvas, rendering context, display mode, and native event listeners\n   */\n  private _initialize(options?: EngineOptions) {\n    this.pageScrollPreventionMode = options.scrollPreventionMode;\n\n    // initialize inputs\n    this.input = {\n      keyboard: new Input.Keyboard(),\n      pointers: new Input.Pointers(this),\n      gamepads: new Input.Gamepads()\n    };\n    this.input.keyboard.init();\n    this.input.pointers.init(options && options.pointerScope === Input.PointerScope.Document ? document : this.canvas);\n    this.input.gamepads.init();\n\n    // Issue #385 make use of the visibility api\n    // https://developer.mozilla.org/en-US/docs/Web/Guide/User_experience/Using_the_Page_Visibility_API\n\n    let hidden: keyof HTMLDocument, visibilityChange: string;\n    if (typeof document.hidden !== 'undefined') {\n      // Opera 12.10 and Firefox 18 and later support\n      hidden = 'hidden';\n      visibilityChange = 'visibilitychange';\n    } else if ('msHidden' in document) {\n      hidden = <keyof HTMLDocument>'msHidden';\n      visibilityChange = 'msvisibilitychange';\n    } else if ('webkitHidden' in document) {\n      hidden = <keyof HTMLDocument>'webkitHidden';\n      visibilityChange = 'webkitvisibilitychange';\n    }\n\n    this.browser.document.on(visibilityChange, () => {\n      if (document[hidden]) {\n        this.eventDispatcher.emit('hidden', new HiddenEvent(this));\n        this._logger.debug('Window hidden');\n      } else {\n        this.eventDispatcher.emit('visible', new VisibleEvent(this));\n        this._logger.debug('Window visible');\n      }\n    });\n\n    if (!this.canvasElementId && !options.canvasElement) {\n      document.body.appendChild(this.canvas);\n    }\n  }\n\n  public onInitialize(_engine: Engine) {\n    // Override me\n  }\n\n  /**\n   * If supported by the browser, this will set the antialiasing flag on the\n   * canvas. Set this to `false` if you want a 'jagged' pixel art look to your\n   * image resources.\n   * @param isSmooth  Set smoothing to true or false\n   */\n  public setAntialiasing(isSmooth: boolean) {\n    this.screen.antialiasing = isSmooth;\n  }\n\n  /**\n   * Return the current smoothing status of the canvas\n   */\n  public getAntialiasing(): boolean {\n    return this.screen.antialiasing;\n  }\n\n  /**\n   * Gets whether the actor is Initialized\n   */\n  public get isInitialized(): boolean {\n    return this._isInitialized;\n  }\n\n  private _overrideInitialize(engine: Engine) {\n    if (!this.isInitialized) {\n      this.onInitialize(engine);\n      super.emit('initialize', new InitializeEvent(engine, this));\n      this._isInitialized = true;\n      if (this._deferredGoTo) {\n        this.goToScene(this._deferredGoTo);\n      } else {\n        this.goToScene('root');\n      }\n    }\n  }\n\n  /**\n   * Updates the entire state of the game\n   * @param delta  Number of milliseconds elapsed since the last update.\n   */\n  private _update(delta: number) {\n    if (this._isLoading) {\n      // suspend updates until loading is finished\n      this._loader.update(this, delta);\n      // Update input listeners\n      this.input.keyboard.update();\n      this.input.pointers.update();\n      this.input.gamepads.update();\n      return;\n    }\n    this._overrideInitialize(this);\n    // Publish preupdate events\n    this._preupdate(delta);\n\n    // process engine level events\n    this.currentScene.update(this, delta);\n\n    // update animations\n    // TODO remove\n    this._animations = this._animations.filter(function (a) {\n      return !a.animation.isDone();\n    });\n\n    // Update input listeners\n    this.input.keyboard.update();\n    this.input.pointers.update();\n    this.input.gamepads.update();\n\n    // Publish update event\n    this._postupdate(delta);\n  }\n\n  /**\n   * @internal\n   */\n  public _preupdate(delta: number) {\n    this.emit('preupdate', new PreUpdateEvent(this, delta, this));\n    this.onPreUpdate(this, delta);\n  }\n\n  public onPreUpdate(_engine: Engine, _delta: number) {\n    // Override me\n  }\n\n  /**\n   * @internal\n   */\n  public _postupdate(delta: number) {\n    this.emit('postupdate', new PostUpdateEvent(this, delta, this));\n    this.onPostUpdate(this, delta);\n  }\n\n  public onPostUpdate(_engine: Engine, _delta: number) {\n    // Override me\n  }\n\n  /**\n   * Draws the entire game\n   * @param delta  Number of milliseconds elapsed since the last draw.\n   */\n  private _draw(delta: number) {\n    const ctx = this.ctx;\n    this._predraw(ctx, delta);\n\n    if (this._isLoading) {\n      this._loader.canvas.draw(this.graphicsContext, 0, 0);\n      this.graphicsContext.flush();\n      // Drawing nothing else while loading\n      return;\n    }\n\n    // TODO move to graphics systems?\n    this.graphicsContext.backgroundColor = this.backgroundColor;\n\n    this.currentScene.draw(this.ctx, delta);\n\n    // todo needs to be a better way of doing this\n    let a = 0;\n    const len = this._animations.length;\n    for (a; a < len; a++) {\n      this._animations[a].animation.draw(ctx, this._animations[a].x, this._animations[a].y);\n    }\n\n    // Draw debug information\n    // TODO don't access ctx directly\n    if (this.isDebug) {\n      this.ctx.font = 'Consolas';\n      this.ctx.fillStyle = this.debugColor.toString();\n      const keys = this.input.keyboard.getKeys();\n      for (let j = 0; j < keys.length; j++) {\n        this.ctx.fillText(keys[j].toString() + ' : ' + (Input.Keys[keys[j]] ? Input.Keys[keys[j]] : 'Not Mapped'), 100, 10 * j + 10);\n      }\n\n      this.ctx.fillText('FPS:' + this.stats.currFrame.fps.toFixed(2).toString(), 10, 10);\n    }\n\n    // Post processing\n    for (let i = 0; i < this.postProcessors.length; i++) {\n      this.postProcessors[i].process(this.ctx.getImageData(0, 0, this.canvasWidth, this.canvasHeight), this.ctx);\n    }\n\n    this._postdraw(ctx, delta);\n  }\n\n  /**\n   * @internal\n   */\n  public _predraw(_ctx: CanvasRenderingContext2D, delta: number) {\n    this.emit('predraw', new PreDrawEvent(_ctx, delta, this));\n    this.onPreDraw(_ctx, delta);\n  }\n\n  public onPreDraw(_ctx: CanvasRenderingContext2D, _delta: number) {\n    // Override me\n  }\n\n  /**\n   * @internal\n   */\n  public _postdraw(_ctx: CanvasRenderingContext2D, delta: number) {\n    this.emit('postdraw', new PostDrawEvent(_ctx, delta, this));\n    this.onPostDraw(_ctx, delta);\n  }\n\n  public onPostDraw(_ctx: CanvasRenderingContext2D, _delta: number) {\n    // Override me\n  }\n\n  /**\n   * Enable or disable Excalibur debugging functionality.\n   * @param toggle a value that debug drawing will be changed to\n   */\n  public showDebug(toggle: boolean): void {\n    this._isDebug = toggle;\n  }\n\n  /**\n   * Toggle Excalibur debugging functionality.\n   */\n  public toggleDebug(): boolean {\n    this._isDebug = !this._isDebug;\n    return this._isDebug;\n  }\n\n  /**\n   * Starts the internal game loop for Excalibur after loading\n   * any provided assets.\n   * @param loader  Optional [[Loader]] to use to load resources. The default loader is [[Loader]], override to provide your own\n   * custom loader.\n   */\n  public start(loader?: Loader): Promise<any> {\n    if (!this._compatible) {\n      return Promise.reject('Excalibur is incompatible with your browser');\n    }\n    this.screen.pushResolutionAndViewport();\n    this.screen.resolution = this.screen.viewport;\n    this.screen.applyResolutionAndViewport();\n    this.graphicsContext.updateViewport();\n    let loadingComplete: Promise<any>;\n    if (loader) {\n      this._loader = loader;\n      this._loader.suppressPlayButton = this._suppressPlayButton || this._loader.suppressPlayButton;\n      this._loader.wireEngine(this);\n      loadingComplete = this.load(this._loader);\n    } else {\n      loadingComplete = Promise.resolve();\n    }\n\n    loadingComplete.then(() => {\n      this.screen.popResolutionAndViewport();\n      this.screen.applyResolutionAndViewport();\n      this.graphicsContext.updateViewport();\n      this.emit('start', new GameStartEvent(this));\n    });\n\n    if (!this._hasStarted) {\n      this._hasStarted = true;\n      this._logger.debug('Starting game...');\n      this.browser.resume();\n      Engine.createMainLoop(this, window.requestAnimationFrame, Date.now)();\n\n      this._logger.debug('Game started');\n    } else {\n      // Game already started;\n    }\n    return loadingComplete;\n  }\n\n  public static createMainLoop(game: Engine, raf: (func: Function) => number, nowFn: () => number) {\n    let lastTime = nowFn();\n\n    return function mainloop() {\n      if (!game._hasStarted) {\n        return;\n      }\n      try {\n        game._requestId = raf(mainloop);\n        game.emit('preframe', new PreFrameEvent(game, game.stats.prevFrame));\n\n        // Get the time to calculate time-elapsed\n        const now = nowFn();\n        let elapsed = Math.floor(now - lastTime) || 1;\n        // Resolves issue #138 if the game has been paused, or blurred for\n        // more than a 200 milliseconds, reset elapsed time to 1. This improves reliability\n        // and provides more expected behavior when the engine comes back\n        // into focus\n        if (elapsed > 200) {\n          elapsed = 1;\n        }\n        const delta = elapsed * game.timescale;\n\n        // reset frame stats (reuse existing instances)\n        const frameId = game.stats.prevFrame.id + 1;\n        game.stats.currFrame.reset();\n        game.stats.currFrame.id = frameId;\n        game.stats.currFrame.delta = delta;\n        game.stats.currFrame.fps = 1.0 / (delta / 1000);\n\n        const beforeUpdate = nowFn();\n        game._update(delta);\n        const afterUpdate = nowFn();\n        game._draw(delta);\n        const afterDraw = nowFn();\n\n        game.stats.currFrame.duration.update = afterUpdate - beforeUpdate;\n        game.stats.currFrame.duration.draw = afterDraw - afterUpdate;\n\n        lastTime = now;\n\n        game.emit('postframe', new PostFrameEvent(game, game.stats.currFrame));\n        game.stats.prevFrame.reset(game.stats.currFrame);\n      } catch (e) {\n        window.cancelAnimationFrame(game._requestId);\n        game.stop();\n        game.onFatalException(e);\n      }\n    };\n  }\n\n  /**\n   * Stops Excalibur's main loop, useful for pausing the game.\n   */\n  public stop() {\n    if (this._hasStarted) {\n      this.emit('stop', new GameStopEvent(this));\n      this.browser.pause();\n      this._hasStarted = false;\n      this._logger.debug('Game stopped');\n    }\n  }\n\n  /**\n   * Returns the Engine's Running status, Useful for checking whether engine is running or paused.\n   */\n  public isPaused(): boolean {\n    return !this._hasStarted;\n  }\n\n  /**\n   * Takes a screen shot of the current viewport and returns it as an\n   * HTML Image Element.\n   */\n  public screenshot(): HTMLImageElement {\n    const result = new Image();\n    const raw = this.canvas.toDataURL('image/png');\n    result.src = raw;\n    return result;\n  }\n\n  /**\n   * Another option available to you to load resources into the game.\n   * Immediately after calling this the game will pause and the loading screen\n   * will appear.\n   * @param loader  Some [[Loadable]] such as a [[Loader]] collection, [[Sound]], or [[Texture]].\n   */\n  public load(loader: Loadable<any>): Promise<void> {\n    const complete = new Promise<void>((resolve) => {\n      this._isLoading = true;\n\n      loader.load().then(() => {\n        if (this._suppressPlayButton) {\n          setTimeout(() => {\n            this._isLoading = false;\n            resolve();\n            // Delay is to give the logo a chance to show, otherwise don't delay\n          }, 500);\n        } else {\n          this._isLoading = false;\n          resolve();\n        }\n      });\n    });\n\n    return complete;\n  }\n}\n\n/**\n * @internal\n * @deprecated\n */\n@obsolete({ message: 'Will be removed in excalibur v0.26.0' })\nclass AnimationNode {\n  constructor(public animation: Animation, public x: number, public y: number) {}\n}\n","import { GameEvent } from '../Events';\nimport { Sound } from '../Resources/Sound/Sound';\nimport { Actor } from '../Actor';\nimport { WebAudioInstance } from '../Resources/Sound/WebAudioInstance';\n\nexport class MediaEvent extends GameEvent<Sound> {\n  /**\n   * Media event cannot bubble\n   */\n  public set bubbles(_value: boolean) {\n    // stubbed\n  }\n  /**\n   * Media event cannot bubble\n   */\n  public get bubbles(): boolean {\n    return false;\n  }\n  /**\n   * Media event cannot bubble, so they have no path\n   */\n  protected get _path(): Actor[] {\n    return null;\n  }\n  /**\n   * Media event cannot bubble, so they have no path\n   */\n  protected set _path(_val: Actor[]) {\n    // stubbed\n  }\n\n  constructor(public target: Sound, protected _name: string = 'MediaEvent') {\n    super();\n  }\n\n  /**\n   * Prevents event from bubbling\n   */\n  public stopPropagation(): void {\n    /**\n     * Stub\n     */\n  }\n  /**\n   * Action, that calls when event happens\n   */\n  public action(): void {\n    /**\n     * Stub\n     */\n  }\n  /**\n   * Propagate event further through event path\n   */\n  public propagate(): void {\n    /**\n     * Stub\n     */\n  }\n\n  public layPath(_actor: Actor): void {\n    /**\n     * Stub\n     */\n  }\n}\n\nexport class NativeSoundEvent extends MediaEvent {\n  constructor(target: Sound, public track?: WebAudioInstance) {\n    super(target, 'NativeSoundEvent');\n  }\n}\n\nexport class NativeSoundProcessedEvent extends MediaEvent {\n  public data: string | AudioBuffer;\n\n  constructor(target: Sound, private _processedData: string | AudioBuffer) {\n    super(target, 'NativeSoundProcessedEvent');\n\n    this.data = this._processedData;\n  }\n}\n","import { Vector } from '../Math/vector';\nimport { BoundingBox } from '../Collision/Index';\nimport { Color } from '../Color';\nimport { line } from '../Util/DrawUtil';\nimport { ExcaliburGraphicsContext } from './Context/ExcaliburGraphicsContext';\nimport { BaseAlign, Direction, FontOptions, FontStyle, FontUnit, TextAlign, FontRenderer } from './FontCommon';\nimport { Raster, RasterOptions } from './Raster';\n\nexport class Font extends Raster implements FontRenderer {\n  constructor(options: FontOptions & RasterOptions = {}) {\n    super(options);\n    this.family = options?.family ?? this.family;\n    this.style = options?.style ?? this.style;\n    this.bold = options?.bold ?? this.bold;\n    this.size = options?.size ?? this.size;\n    this.unit = options?.unit ?? this.unit;\n    this.textAlign = options?.textAlign ?? this.textAlign;\n    this.baseAlign = options?.baseAlign ?? this.baseAlign;\n    this.direction = options?.direction ?? this.direction;\n    this.quality = options?.quality ?? this.quality;\n    if (options?.shadow) {\n      this.shadow = {};\n      this.shadow.blur = options.shadow.blur ?? this.shadow.blur;\n      this.shadow.offset = options.shadow.offset ?? this.shadow.offset;\n      this.shadow.color = options.shadow.color ?? this.shadow.color;\n    }\n    this.flagDirty();\n  }\n\n  public clone() {\n    return new Font({\n      ...this.cloneGraphicOptions(),\n      ...this.cloneRasterOptions(),\n      size: this.size,\n      unit: this.unit,\n      family: this.family,\n      style: this.style,\n      bold: this.bold,\n      textAlign: this.textAlign,\n      baseAlign: this.baseAlign,\n      direction: this.direction,\n      shadow: this.shadow\n        ? {\n          blur: this.shadow.blur,\n          offset: this.shadow.offset,\n          color: this.shadow.color\n        }\n        : null\n    });\n  }\n\n  /**\n   * Font quality determines the size of the underlying rastered text, higher quality means less jagged edges.\n   * If quality is set to 1, then just enough raster bitmap is generated to render the text.\n   *\n   * You can think of quality as how zoomed in to the text you can get before seeing jagged edges.\n   *\n   * (Default 4)\n   */\n  public quality = 2;\n\n  public family: string = 'sans-serif';\n  public style: FontStyle = FontStyle.Normal;\n  public bold: boolean = false;\n  public unit: FontUnit = FontUnit.Px;\n  public textAlign: TextAlign = TextAlign.Left;\n  public baseAlign: BaseAlign = BaseAlign.Alphabetic;\n  public direction: Direction = Direction.LeftToRight;\n  public size: number = 10;\n  public shadow: { blur?: number; offset?: Vector; color?: Color } = null;\n\n  public get fontString() {\n    return `${this.style} ${this.bold ? 'bold' : ''} ${this.size}${this.unit} ${this.family}`;\n  }\n\n  private _text: string;\n  private _lines: string[];\n  private _textBounds: BoundingBox = new BoundingBox();\n  private _textWidth: number = 0;\n  private _textHeight: number = 0;\n\n  public get width() {\n    return this._textWidth;\n  }\n\n  public set width(value: number) {\n    this._textWidth = value;\n  }\n\n  public get height() {\n    const numLines = this._lines?.length ?? 1;\n    return this._textHeight * numLines;\n  }\n\n  public set height(value: number) {\n    const numLines = this._lines?.length ?? 1;\n    this._textHeight = value / numLines;\n  }\n\n  private get _rasterWidth() {\n    return this._bitmap.width;\n  }\n\n  private get _rasterHeight() {\n    return this._bitmap.height;\n  }\n\n  private get _halfRasterWidth() {\n    return Math.floor(this._bitmap.width / 2);\n  }\n\n  private get _halfRasterHeight() {\n    return Math.floor(this._bitmap.height / 2);\n  }\n\n  public get localBounds(): BoundingBox {\n    return this._textBounds;\n  }\n\n  protected _drawImage(ex: ExcaliburGraphicsContext, x: number, y: number) {\n    if (this.dirty) {\n      this.rasterize();\n    }\n\n    ex.drawImage(\n      this._bitmap,\n      0,\n      0,\n      this._rasterWidth,\n      this._rasterHeight,\n      x - this._rasterWidth / this.quality / 2,\n      y - this._rasterHeight / this.quality / 2,\n      this._rasterWidth / this.quality,\n      this._rasterHeight / this.quality\n    );\n  }\n\n  protected _rotate(ex: ExcaliburGraphicsContext) {\n    // TODO this needs to change depending on the bounding box...\n    const origin = this.origin ?? this._textBounds.center;\n    ex.translate(origin.x, origin.y);\n    ex.rotate(this.rotation);\n    ex.translate(-origin.x, -origin.y);\n  }\n\n  protected _flip(ex: ExcaliburGraphicsContext) {\n    if (this.flipHorizontal) {\n      ex.translate(this._textBounds.width / this.scale.x, 0);\n      ex.scale(-1, 1);\n    }\n\n    if (this.flipVertical) {\n      ex.translate(0, -this._textBounds.height / 2 / this.scale.y);\n      ex.scale(1, -1);\n    }\n  }\n\n  public updateText(text: string) {\n    if (this._text !== text) {\n      this._text = text;\n      this._lines = this._text.split('\\n');\n      this._updateDimensions();\n      this.flagDirty();\n    }\n  }\n\n  private _updateDimensions() {\n    if (this._text) {\n      this._applyFont(this._ctx);\n      const maxWidthLine = this._lines.reduce((a, b) => {\n        return a.length > b.length ? a : b;\n      });\n      const metrics = this._ctx.measureText(maxWidthLine);\n      this._textWidth = Math.abs(metrics.actualBoundingBoxLeft) + Math.abs(metrics.actualBoundingBoxRight);\n      this._textHeight = Math.abs(metrics.actualBoundingBoxAscent) + Math.abs(metrics.actualBoundingBoxDescent);\n\n      // TODO lineheight makes the text bounds wonky\n      const lineAdjustedHeight = this._textHeight * this._lines.length;\n      // this._textHeight = lineAdjustedHeight;\n      // Changing the width and height clears the context properties\n      // We double the bitmap width to account for alignment\n      // We scale by \"quality\" so we render text without jaggies\n      this._bitmap.width = (this._textWidth + this.padding * 2) * 2 * this.quality;\n      this._bitmap.height = (lineAdjustedHeight + this.padding * 2) * 2 * this.quality;\n\n      // These bounds exist in raster bitmap space where the top left corner is the corder of the bitmap\n      const x = 0;\n      const y = 0;\n      const bottomBounds = lineAdjustedHeight - Math.abs(metrics.actualBoundingBoxAscent);\n      this._textBounds = new BoundingBox({\n        left: x - Math.abs(metrics.actualBoundingBoxLeft) - this.padding,\n        top: y - Math.abs(metrics.actualBoundingBoxAscent) - this.padding,\n        bottom: y + bottomBounds + this.padding,\n        right: x + Math.abs(metrics.actualBoundingBoxRight) + this.padding\n      });\n    }\n  }\n\n  protected _preDraw(ex: ExcaliburGraphicsContext, x: number, y: number): void {\n    if (this.dirty) {\n      this._updateDimensions();\n    }\n    super._preDraw(ex, x, y);\n  }\n\n  protected _postDraw(ex: ExcaliburGraphicsContext): void {\n    if (this.showDebug) {\n      /* istanbul ignore next */\n      ex.debug.drawRect(-this._halfRasterWidth, -this._halfRasterHeight, this._rasterWidth, this._rasterHeight);\n    }\n    ex.restore();\n  }\n\n  private _applyFont(ctx: CanvasRenderingContext2D) {\n    ctx.translate(this.padding + this._halfRasterWidth, this.padding + this._halfRasterHeight);\n    ctx.scale(this.quality, this.quality);\n    ctx.textAlign = this.textAlign;\n    ctx.textBaseline = this.baseAlign;\n    ctx.font = this.fontString;\n    ctx.direction = this.direction;\n\n    if (this.shadow) {\n      ctx.shadowColor = this.shadow.color.toString();\n      ctx.shadowBlur = this.shadow.blur;\n      ctx.shadowOffsetX = this.shadow.offset.x;\n      ctx.shadowOffsetY = this.shadow.offset.y;\n    }\n  }\n\n  execute(ctx: CanvasRenderingContext2D): void {\n    if (this._text) {\n      // The reason we need to re-apply the font is setting raster properties (like width/height) can reset the context props\n      this._applyRasterProperites(ctx);\n      this._applyFont(ctx);\n\n      const lineHeight = this._textHeight; // TODO user specified line height\n      for (let i = 0; i < this._lines.length; i++) {\n        const line = this._lines[i];\n        if (this.color) {\n          ctx.fillText(line, 0, i * lineHeight);\n        }\n\n        if (this.strokeColor) {\n          ctx.strokeText(line, 0, i * lineHeight);\n        }\n      }\n\n      if (this.showDebug) {\n        // Horizontal line\n        /* istanbul ignore next */\n        line(ctx, Color.Red, -this._halfRasterWidth, 0, this._halfRasterWidth, 0, 2);\n        // Vertical line\n        /* istanbul ignore next */\n        line(ctx, Color.Red, 0, -this._halfRasterHeight, 0, this._halfRasterHeight, 2);\n      }\n    }\n  }\n\n  public render(ex: ExcaliburGraphicsContext, text: string, x: number, y: number) {\n    this.updateText(text);\n    this.draw(ex, x, y);\n  }\n}\n","import { ExcaliburGraphicsContext } from './Context/ExcaliburGraphicsContext';\nimport { BoundingBox } from '../Collision/BoundingBox';\nimport { SpriteFont } from './SpriteFont';\nimport { Graphic, GraphicOptions } from './Graphic';\nimport { Color } from '../Color';\nimport { Font } from './Font';\nimport { watch } from '../Util/Watch';\n\nexport interface TextOptions {\n  text: string;\n  color?: Color;\n  font?: Font | SpriteFont;\n}\n\nexport class Text extends Graphic {\n  constructor(options: TextOptions & GraphicOptions) {\n    super(options);\n    // This order is important font, color, then text\n    this.font = options.font ?? new Font();\n    this.color = options.color ?? this.color;\n    this.text = options.text;\n  }\n\n  public clone(): Text {\n    return new Text({\n      text: this.text.slice(),\n      color: this.color.clone(),\n      font: this.font.clone()\n    });\n  }\n\n  private _text: string = '';\n  public get text() {\n    return this._text;\n  }\n\n  public set text(value: string) {\n    this._text = value;\n    this.font.updateText(value);\n  }\n\n  // TODO SpriteFont doesn't support a color yet :(\n  public get color() {\n    if (this.font instanceof Font) {\n      return this.font.color;\n    }\n    return Color.Black;\n  }\n\n  public set color(color: Color) {\n    if (this.font instanceof Font) {\n      this.font.color = color;\n    }\n  }\n\n  private _font: Font | SpriteFont;\n  public get font(): Font | SpriteFont {\n    return this._font;\n  }\n  public set font(font: Font | SpriteFont) {\n    if (font instanceof Font) {\n      this._font = watch(font, (font) => font.flagDirty());\n    } else {\n      this._font = font;\n    }\n  }\n\n  public get width() {\n    return this.font.width;\n  }\n\n  public get height() {\n    return this.font.height;\n  }\n\n  public get localBounds(): BoundingBox {\n    return this.font.localBounds;\n  }\n\n  protected _rotate(_ex: ExcaliburGraphicsContext) {\n    // None this is delegated to font\n    // This override erases the default behavior\n  }\n\n  protected _flip(_ex: ExcaliburGraphicsContext) {\n    // None this is delegated to font\n    // This override erases the default behavior\n  }\n\n  protected _drawImage(ex: ExcaliburGraphicsContext, x: number, y: number) {\n    if (this.font instanceof Font) {\n      this.font.color = this.color;\n    }\n    this.font.flipHorizontal = this.flipHorizontal;\n    this.font.flipVertical = this.flipVertical;\n    this.font.scale = this.scale;\n    this.font.rotation = this.rotation;\n    this.font.origin = this.origin;\n    this.font.opacity = this.opacity;\n    this.font.render(ex, this._text, x, y);\n  }\n}\n","import { Engine } from './Engine';\nimport { Color } from './Color';\nimport { vec, Vector } from './Math/vector';\nimport { Text } from './Graphics/Text';\nimport { BaseAlign, FontStyle, FontUnit, TextAlign } from './Graphics/FontCommon';\nimport { obsolete } from './Util/Decorators';\nimport { SpriteFont as LegacySpriteFont } from './Drawing/SpriteSheet';\nimport { ExcaliburGraphicsContext, GraphicsComponent, SpriteFont } from './Graphics';\nimport { Font } from './Graphics/Font';\nimport { Actor } from './Actor';\nimport { ActorArgs } from '.';\n\n/**\n * Option for creating a label\n */\nexport interface LabelOptions {\n  /**\n   * Specify the label text\n   */\n  text?: string;\n  /**\n   * Specify the color of the text (does not apply to SpriteFonts)\n   */\n  color?: Color;\n  x?: number;\n  y?: number;\n  pos?: Vector;\n  /**\n   * Optionally specify a sprite font, will take precedence over any other [[Font]]\n   */\n  spriteFont?: SpriteFont | LegacySpriteFont;\n  /**\n   * Specify a custom font\n   */\n  font?: Font\n}\n\n/**\n * Labels are the way to draw small amounts of text to the screen. They are\n * actors and inherit all of the benefits and capabilities.\n */\nexport class Label extends Actor {\n  public font: Font = new Font();\n  private _text: Text = new Text({ text: '', font: this.font });\n\n  /**\n   * The text to draw.\n   */\n  public get text(): string {\n    return this._text.text;\n  }\n\n  public set text(text: string) {\n    this._text.text = text;\n  }\n\n  public get color(): Color {\n    return this._text.color;\n  }\n\n  public set color(color: Color) {\n    this._text.color = color;\n  }\n\n  public get opacity(): number {\n    return this._text.opacity;\n  }\n\n  public set opacity(opacity: number) {\n    this._text.opacity = opacity;\n  }\n\n  /**\n   * Sets or gets the bold property of the label's text, by default it's false\n   * @deprecated Use [[Font.bold|Label.font.bold]]\n   */\n  @obsolete({\n    message: 'Label.bold will be removed in v0.26.0',\n    alternateMethod: 'Use Label.font.bold'\n  })\n  public get bold(): boolean {\n    return this.font.bold;\n  }\n\n  public set bold(isBold: boolean) {\n    this.font.bold = isBold;\n  }\n\n  /**\n   * The CSS font family string (e.g. `sans-serif`, `Droid Sans Pro`). Web fonts\n   * are supported, same as in CSS.\n   * @deprecated Use [[Font.family|Label.font.family]]\n   */\n  @obsolete({\n    message: 'Label.fontFamily will be removed in v0.26.0',\n    alternateMethod: 'Use Label.font.family'\n  })\n  public get fontFamily(): string {\n    return this.font.family;\n  }\n\n  public set fontFamily(family: string) {\n    this.font.family = family;\n  }\n\n  /**\n   * The font size in the selected units, default is 10 (default units is pixel)\n   * @deprecated Use [[Font.size|Label.font.size]]\n   */\n  @obsolete({\n    message: 'Label.fontSize will be removed in v0.26.0',\n    alternateMethod: 'Use Label.font.size'\n  })\n  public get fontSize(): number {\n    return this.font.size;\n  }\n\n  public set fontSize(sizeInUnit: number) {\n    this.font.size = sizeInUnit;\n  }\n\n  /**\n   * The font style for this label, the default is [[FontStyle.Normal]]\n   * @deprecated Use [[Font.style|Label.font.style]]\n   */\n  @obsolete({\n    message: 'Label.fontStyle will be removed in v0.26.0',\n    alternateMethod: 'Use Lable.font.style'\n  })\n  public get fontStyle(): FontStyle {\n    return this.font.style;\n  }\n\n  public set fontStyle(style: FontStyle) {\n    this.font.style = style;\n  }\n\n  /**\n   * The css units for a font size such as px, pt, em (SpriteFont only support px), by default is 'px';\n   * @deprecated Use [[Font.unit|Label.font.unit]]\n   */\n  @obsolete({\n    message: 'Label.fontUnit will be removed in v0.26.0',\n    alternateMethod: 'Use Label.font.unit'\n  })\n  public get fontUnit(): FontUnit {\n    return this.font.unit;\n  }\n\n  public set fontUnit(unit: FontUnit) {\n    this.font.unit = unit;\n  }\n\n  /**\n   * Gets or sets the horizontal text alignment property for the label.\n   * @deprecated Use [[Font.textAlign|Label.font.textAlign]]\n   */\n  @obsolete({\n    message: 'Label.textAlign will be removed in v0.26.0',\n    alternateMethod: 'Use Label.font.textAlign'\n  })\n  public get textAlign(): TextAlign {\n    return this.font.textAlign;\n  }\n\n  public set textAlign(align: TextAlign) {\n    this.font.textAlign = align;\n  }\n\n  /**\n   * Gets or sets the baseline alignment property for the label.\n   * @deprecated Use [[Font.baseAlign|Label.font.baseAlign]]\n   */\n  @obsolete({\n    message: 'Label.baseAlign will be removed in v0.26.0',\n    alternateMethod: 'Use Label.font.baseAlign'\n  })\n  public get baseAlign(): BaseAlign {\n    return this.font.baseAlign;\n  }\n\n  public set baseAlign(align: BaseAlign) {\n    this.font.baseAlign = align;\n  }\n\n  /**\n   * Gets or sets the maximum width (in pixels) that the label should occupy\n   * @deprecated The maxWidth constraint is gone\n   */\n  public maxWidth: number;\n\n  private _legacySpriteFont: LegacySpriteFont;\n  private _spriteFont: SpriteFont;\n  /**\n   * The [[LegacyDrawing.SpriteFont]] to use, if any. Overrides [[fontFamily]] if present.\n   * @deprecated Use [[SpriteFont]]\n   */\n  @obsolete()\n  public get spriteFont(): LegacySpriteFont {\n    return this._legacySpriteFont;\n  }\n\n  public set spriteFont(sf: LegacySpriteFont | SpriteFont) {\n    if (sf) {\n      if (sf instanceof LegacySpriteFont) {\n        this._legacySpriteFont = sf;\n        this._spriteFont = SpriteFont.fromLegacySpriteFont(sf);\n        this._text.font = this._spriteFont;\n        return;\n      }\n      this._spriteFont = sf;\n      this._text.font = this._spriteFont;\n    }\n  }\n\n  /**\n   * Gets or sets the letter spacing on a Label. Only supported with Sprite Fonts.\n   * @deprecated Use [[SpriteFont.spacing]]\n   */\n  public letterSpacing: number = 0; //px\n\n  /**\n   * Whether or not the [[SpriteFont]] will be case-sensitive when matching characters.\n   * @deprecated Use Graphics.SpriteFont.caseInsensitve\n   */\n  public caseInsensitive: boolean = true;\n\n  private _graphicsContext: ExcaliburGraphicsContext;\n\n  /**\n   * Build a new label\n   * @param options\n   */\n  constructor(options?: LabelOptions & ActorArgs) {\n    super(options);\n    const {text, pos, x, y, spriteFont, font, color} = options;\n\n    this.pos = pos ?? (x && y ? vec(x, y) : this.pos);\n    this.text = text ?? this.text;\n    this.spriteFont = spriteFont ?? this.spriteFont;\n    this.font = font ?? this.font;\n    this.color = color ?? this.color;\n    const gfx = this.get(GraphicsComponent);\n    gfx.anchor = Vector.Zero;\n    gfx.use(this._text);\n  }\n\n  public _initialize(engine: Engine) {\n    super._initialize(engine);\n    this._graphicsContext = engine.graphicsContext;\n  }\n\n  /**\n   * Returns the width of the text in the label (in pixels);\n   */\n  public getTextWidth(): number {\n    return this._text.width;\n  }\n\n  /**\n   * Sets the text shadow for sprite fonts\n   * @param offsetX      The x offset in pixels to place the shadow\n   * @param offsetY      The y offset in pixels to place the shadow\n   * @param shadowColor  The color of the text shadow\n   * @deprecated Use [[Font.shadow|Label.font.shadow]]\n   */\n  @obsolete({\n    message: 'Label.setTextShadow will be removed in v0.26.0',\n    alternateMethod: 'Use Label.font.shadow'\n  })\n  public setTextShadow(offsetX: number, offsetY: number, shadowColor: Color) {\n    this.font.shadow = { offset: vec(offsetX, offsetY), blur: 2, color: shadowColor };\n  }\n\n  /**\n   * Toggles text shadows on or off, only applies when using sprite fonts\n   * @deprecated Use [[Font.shadow|Label.font.shadow]]\n   */\n  @obsolete({\n    message: 'Label.useTextShadow will be removed in v0.26.0',\n    alternateMethod: 'Use Label.font.shadow'\n  })\n  public useTextShadow(on: boolean) {\n    if (this.spriteFont) {\n      this.spriteFont.useTextShadow(on);\n    }\n  }\n\n  /**\n   * Clears the current text shadow\n   * @deprecated Use [[Font.shadow|Label.font.shadow]]\n   */\n  @obsolete({\n    message: 'Label.clearTextShadow will be removed in v0.26.0',\n    alternateMethod: 'Use Label.font.shadow'\n  })\n  public clearTextShadow() {\n    this.font.shadow = null;\n  }\n\n  public draw(_ctx: CanvasRenderingContext2D, _delta: number) {\n    const exctx = this._graphicsContext;\n    this._text.draw(exctx, 0, 0);\n  }\n}\n","import { CollisionGroup } from './CollisionGroup';\n\n/**\n * Static class for managing collision groups in excalibur, there is a maximum of 32 collision groups possible in excalibur\n */\nexport class CollisionGroupManager {\n  // using bitmasking the maximum number of groups is 32, because that is the highest 32bit integer that JS can present.\n  private static _STARTING_BIT = 0b1 | 0;\n  private static _MAX_GROUPS = 32;\n  private static _CURRENT_GROUP = 1;\n  private static _CURRENT_BIT = CollisionGroupManager._STARTING_BIT;\n  private static _GROUPS: Map<string, CollisionGroup> = new Map<string, CollisionGroup>();\n\n  /**\n   * Create a new named collision group up to a max of 32.\n   * @param name Name for the collision group\n   * @param mask Optionally provide your own 32-bit mask, if none is provide the manager will generate one\n   */\n  public static create(name: string, mask?: number) {\n    if (this._CURRENT_GROUP > this._MAX_GROUPS) {\n      throw new Error(`Cannot have more than ${this._MAX_GROUPS} collision groups`);\n    }\n    if (this._GROUPS.get(name)) {\n      throw new Error(`Collision group ${name} already exists`);\n    }\n    const group = new CollisionGroup(name, this._CURRENT_BIT, mask !== undefined ? mask : ~this._CURRENT_BIT);\n    this._CURRENT_BIT = (this._CURRENT_BIT << 1) | 0;\n    this._CURRENT_GROUP++;\n    this._GROUPS.set(name, group);\n    return group;\n  }\n\n  /**\n   * Get all collision groups currently tracked by excalibur\n   */\n  public static get groups(): CollisionGroup[] {\n    return Array.from(this._GROUPS.values());\n  }\n\n  /**\n   * Get a collision group by it's name\n   * @param name\n   */\n  public static groupByName(name: string) {\n    return this._GROUPS.get(name);\n  }\n\n  /**\n   * Resets the managers internal group management state\n   */\n  public static reset() {\n    this._GROUPS = new Map<string, CollisionGroup>();\n    this._CURRENT_BIT = this._STARTING_BIT;\n    this._CURRENT_GROUP = 1;\n  }\n}\n","import { Color } from '../Color';\nimport * as Effects from './SpriteEffects';\n\nimport { Drawable, DrawOptions } from '../Interfaces/Drawable';\nimport { Vector } from '../Math/vector';\nimport { obsolete } from '../Util/Decorators';\n\n/**\n * Creates a closed polygon drawing given a list of [[Vector]]s.\n *\n * @deprecated Use [[Polygon]]\n * @warning Use sparingly as Polygons are performance intensive\n */\n@obsolete({\n  message: 'Polygon will be removed in v0.26.0',\n  alternateMethod: 'Use Graphics.Polygon'\n})\nexport class Polygon implements Drawable {\n  public flipVertical: boolean;\n  public flipHorizontal: boolean;\n  public drawWidth: number;\n  public drawHeight: number;\n\n  public width: number;\n  public height: number;\n\n  /**\n   * The color to use for the lines of the polygon\n   */\n  public lineColor: Color;\n  /**\n   * The color to use for the interior of the polygon\n   */\n  public fillColor: Color;\n  /**\n   * The width of the lines of the polygon\n   */\n  public lineWidth: number = 5;\n  /**\n   * Indicates whether the polygon is filled or not.\n   */\n  public filled: boolean = false;\n\n  private _points: Vector[] = [];\n  public anchor = Vector.Zero;\n  public offset = Vector.Zero;\n  public rotation: number = 0;\n  public scale = Vector.One;\n  public opacity: number = 1;\n\n  /**\n   * @param points  The vectors to use to build the polygon in order\n   */\n  constructor(points: Vector[]) {\n    this._points = points;\n\n    const minX = this._points.reduce((prev: number, curr: Vector) => {\n      return Math.min(prev, curr.x);\n    }, 0);\n    const maxX = this._points.reduce((prev: number, curr: Vector) => {\n      return Math.max(prev, curr.x);\n    }, 0);\n\n    this.drawWidth = maxX - minX;\n\n    const minY = this._points.reduce((prev: number, curr: Vector) => {\n      return Math.min(prev, curr.y);\n    }, 0);\n    const maxY = this._points.reduce((prev: number, curr: Vector) => {\n      return Math.max(prev, curr.y);\n    }, 0);\n\n    this.drawHeight = maxY - minY;\n\n    this.height = this.drawHeight;\n    this.width = this.drawWidth;\n  }\n\n  /**\n   * @notimplemented Effects are not supported on `Polygon`\n   */\n  public addEffect() {\n    // not supported on polygons\n  }\n  /**\n   * @notimplemented Effects are not supported on `Polygon`\n   */\n  public removeEffect(index: number): void;\n  /**\n   * @notimplemented Effects are not supported on `Polygon`\n   */\n  public removeEffect(effect: Effects.SpriteEffect): void;\n  /**\n   * @notimplemented Effects are not supported on `Polygon`\n   */\n  public removeEffect() {\n    // not supported on polygons\n  }\n\n  /**\n   * @notimplemented Effects are not supported on `Polygon`\n   */\n  public clearEffects() {\n    // not supported on polygons\n  }\n\n  public reset() {\n    //pass\n  }\n\n  /**\n   * Draws the sprite appropriately to the 2D rendering context, at an x and y coordinate.\n   * @param ctx  The 2D rendering context\n   * @param x    The x coordinate of where to draw\n   * @param y    The y coordinate of where to draw\n   */\n  public draw(ctx: CanvasRenderingContext2D, x: number, y: number): void;\n  /**\n   * Draws the sprite with custom options to override internals without mutating them.\n   * @param options\n   */\n  public draw(options: DrawOptions): void;\n  public draw(ctxOrOptions: CanvasRenderingContext2D | DrawOptions, x?: number, y?: number): void {\n    if (ctxOrOptions instanceof CanvasRenderingContext2D) {\n      this._drawWithOptions({ ctx: ctxOrOptions, x, y });\n    } else {\n      this._drawWithOptions(ctxOrOptions);\n    }\n  }\n\n  private _drawWithOptions(options: DrawOptions) {\n    const { ctx, x, y, rotation, drawWidth, drawHeight, anchor, offset, opacity, flipHorizontal, flipVertical } = {\n      ...options,\n      rotation: options.rotation ?? this.rotation,\n      drawWidth: options.drawWidth ?? this.drawWidth,\n      drawHeight: options.drawHeight ?? this.drawHeight,\n      flipHorizontal: options.flipHorizontal ?? this.flipHorizontal,\n      flipVertical: options.flipVertical ?? this.flipVertical,\n      anchor: options.anchor ?? this.anchor,\n      offset: options.offset ?? this.offset,\n      opacity: (options.opacity ?? 1) * (this.opacity ?? 1)\n    };\n\n    const xpoint = drawWidth * anchor.x + offset.x + x;\n    const ypoint = drawHeight * anchor.y + offset.y + y;\n\n    ctx.save();\n    ctx.translate(xpoint, ypoint);\n    ctx.scale(this.scale.x, this.scale.y);\n    ctx.rotate(rotation);\n    ctx.beginPath();\n    ctx.lineWidth = this.lineWidth;\n\n    // Iterate through the supplied points and construct a 'polygon'\n    const firstPoint = this._points[0];\n    ctx.moveTo(firstPoint.x, firstPoint.y);\n\n    let i = 0;\n    const len = this._points.length;\n\n    for (i; i < len; i++) {\n      ctx.lineTo(this._points[i].x, this._points[i].y);\n    }\n\n    ctx.lineTo(firstPoint.x, firstPoint.y);\n    ctx.closePath();\n\n    if (this.filled) {\n      ctx.fillStyle = this.fillColor.toString();\n      ctx.fill();\n    }\n\n    ctx.strokeStyle = this.lineColor.toString();\n\n    if (flipHorizontal) {\n      ctx.translate(drawWidth, 0);\n      ctx.scale(-1, 1);\n    }\n\n    if (flipVertical) {\n      ctx.translate(0, drawHeight);\n      ctx.scale(1, -1);\n    }\n\n    const oldAlpha = ctx.globalAlpha;\n    ctx.globalAlpha = opacity;\n    ctx.stroke();\n    ctx.globalAlpha = oldAlpha;\n\n    ctx.restore();\n  }\n}\n","import { Audio } from './Audio';\n\nexport type ExResponseType = '' | 'arraybuffer' | 'blob' | 'document' | 'json' | 'text';\n\nexport interface ExResponseTypesLookup {\n  [name: string]: ExResponseType;\n}\n\nexport class ExResponse {\n  public static type: ExResponseTypesLookup = {\n    any: '',\n    blob: 'blob',\n    json: 'json',\n    text: 'text',\n    document: 'document',\n    arraybuffer: 'arraybuffer'\n  };\n}\n\n/**\n * Represents an audio implementation like [[WebAudioInstance]]\n */\nexport interface AudioImplementation {\n  /**\n   * XHR response type\n   */\n  responseType: ExResponseType;\n\n  /**\n   * Processes raw data and transforms into sound data\n   */\n  processData(data: Blob | ArrayBuffer): Promise<string | AudioBuffer>;\n\n  /**\n   * Factory method that returns an instance of a played audio track\n   */\n  createInstance(data: string | AudioBuffer): Audio;\n}\n","import { Engine } from './../Engine';\nimport * as Events from './../Events';\nimport { Scene } from '../Scene';\n\n// eslint-disable-next-line @typescript-eslint/naming-convention\nexport interface _initialize {\n  _initialize(engine: Engine): void;\n}\n\n/**\n * Type guard checking for internal initialize method\n * @internal\n * @param a\n */\nexport function has_initialize(a: any): a is _initialize {\n  return !!a._initialize;\n}\n\nexport interface OnInitialize {\n  onInitialize(engine: Engine): void;\n}\n\n/**\n *\n */\nexport function hasOnInitialize(a: any): a is OnInitialize {\n  return !!a.onInitialize;\n}\n\n// eslint-disable-next-line @typescript-eslint/naming-convention\nexport interface _preupdate {\n  _preupdate(engine: Engine, delta: number): void;\n}\n\n/**\n *\n */\nexport function has_preupdate(a: any): a is _preupdate {\n  return !!a._preupdate;\n}\n\nexport interface OnPreUpdate {\n  onPreUpdate(engine: Engine, delta: number): void;\n}\n\n/**\n *\n */\nexport function hasOnPreUpdate(a: any): a is OnPreUpdate {\n  return !!a.onPreUpdate;\n}\n\n// eslint-disable-next-line @typescript-eslint/naming-convention\nexport interface _postupdate {\n  _postupdate(engine: Engine, delta: number): void;\n}\n\n/**\n *\n */\nexport function has_postupdate(a: any): a is _postupdate {\n  return !!a.onPostUpdate;\n}\n\nexport interface OnPostUpdate {\n  onPostUpdate(engine: Engine, delta: number): void;\n}\n\n/**\n *\n */\nexport function hasOnPostUpdate(a: any): a is OnPostUpdate {\n  return !!a.onPostUpdate;\n}\n\nexport interface CanInitialize {\n  /**\n   * Overridable implementation\n   */\n  onInitialize(_engine: Engine): void;\n\n  /**\n   * Event signatures\n   */\n  on(eventName: Events.initialize, handler: (event: Events.InitializeEvent<any>) => void): void;\n  once(eventName: Events.initialize, handler: (event: Events.InitializeEvent<any>) => void): void;\n  off(eventName: Events.initialize, handler?: (event: Events.InitializeEvent<any>) => void): void;\n}\n\nexport interface CanActivate {\n  /**\n   * Overridable implementation\n   */\n  onActivate(oldScene: Scene, newScene: Scene): void;\n\n  /**\n   * Event signatures\n   */\n  on(eventName: Events.activate, handler: (event: Events.ActivateEvent) => void): void;\n  once(eventName: Events.activate, handler: (event: Events.ActivateEvent) => void): void;\n  off(eventName: Events.activate, handler?: (event: Events.ActivateEvent) => void): void;\n}\n\nexport interface CanDeactivate {\n  /**\n   * Overridable implementation\n   */\n  onDeactivate(oldScene: Scene, newScene: Scene): void;\n\n  /**\n   * Event signature\n   */\n  on(eventName: Events.deactivate, handler: (event: Events.DeactivateEvent) => void): void;\n  once(eventName: Events.deactivate, handler: (event: Events.DeactivateEvent) => void): void;\n  off(eventName: Events.deactivate, handler?: (event: Events.DeactivateEvent) => void): void;\n}\n\nexport interface CanUpdate {\n  /**\n   * Overridable implementation\n   */\n  onPreUpdate(_engine: Engine, _delta: number): void;\n\n  /**\n   * Event signature\n   */\n  on(eventName: Events.preupdate, handler: (event: Events.PreUpdateEvent<any>) => void): void;\n  once(eventName: Events.preupdate, handler: (event: Events.PreUpdateEvent<any>) => void): void;\n  off(eventName: Events.preupdate, handler?: (event: Events.PreUpdateEvent<any>) => void): void;\n\n  /**\n   * Overridable implementation\n   */\n  onPostUpdate(_engine: Engine, _delta: number): void;\n\n  /**\n   * Event signatures\n   */\n  on(eventName: Events.postupdate, handler: (event: Events.PostUpdateEvent<any>) => void): void;\n  once(eventName: Events.postupdate, handler: (event: Events.PostUpdateEvent<any>) => void): void;\n  off(eventName: Events.postupdate, handler?: (event: Events.PostUpdateEvent<any>) => void): void;\n}\n\nexport interface OnPreDraw {\n  /**\n   * Overridable implementation\n   */\n  onPreDraw(_ctx: CanvasRenderingContext2D, _delta: number): void;\n\n  /**\n   * Event signatures\n   */\n  on(eventName: Events.predraw, handler: (event: Events.PreDrawEvent) => void): void;\n  once(eventName: Events.predraw, handler: (event: Events.PreDrawEvent) => void): void;\n  off(eventName: Events.predraw, handler?: (event: Events.PreDrawEvent) => void): void;\n}\n\nexport interface OnPostDraw {\n  /**\n   * Overridable implementation\n   */\n  onPostDraw(_ctx: CanvasRenderingContext2D, _delta: number): void;\n\n  /**\n   * Event signatures\n   */\n  on(eventName: Events.postdraw, handler: (event: Events.PostDrawEvent) => void): void;\n  once(eventName: Events.postdraw, handler: (event: Events.PostDrawEvent) => void): void;\n  off(eventName: Events.postdraw, handler?: (event: Events.PostDrawEvent) => void): void;\n}\n\nexport interface CanDraw extends OnPreDraw, OnPostDraw {\n  on(eventName: Events.predraw, handler: (event: Events.PreDrawEvent) => void): void;\n  on(eventName: Events.postdraw, handler: (event: Events.PostDrawEvent) => void): void;\n\n  once(eventName: Events.predraw, handler: (event: Events.PreDrawEvent) => void): void;\n  once(eventName: Events.postdraw, handler: (event: Events.PostDrawEvent) => void): void;\n\n  off(eventName: Events.predraw, handler?: (event: Events.PreDrawEvent) => void): void;\n  off(eventName: Events.postdraw, handler?: (event: Events.PostDrawEvent) => void): void;\n}\n\n/**\n *\n */\nexport function hasPreDraw(a: any): a is OnPreDraw {\n  return !!a.onPreDraw;\n}\n\n/**\n *\n */\nexport function hasPostDraw(a: any): a is OnPostDraw {\n  return !!a.onPostDraw;\n}\n\nexport interface CanBeKilled {\n  /**\n   * Overridable implementation\n   */\n  onPreKill(_scene: Scene): void;\n\n  /**\n   * Event signatures\n   */\n  on(eventName: Events.prekill, handler: (event: Events.PreKillEvent) => void): void;\n  once(eventName: Events.prekill, handler: (event: Events.PreKillEvent) => void): void;\n  off(eventName: Events.prekill, handler: (event: Events.PreKillEvent) => void): void;\n\n  /**\n   * Overridable implementation\n   */\n  onPostKill(_scene: Scene): void;\n\n  /**\n   * Event signatures\n   */\n  on(eventName: Events.postkill, handler: (event: Events.PostKillEvent) => void): void;\n  once(eventName: Events.postkill, handler: (event: Events.PostKillEvent) => void): void;\n  off(eventName: Events.postkill, handler: (event: Events.PostKillEvent) => void): void;\n}\n","import { Audio } from '../../Interfaces/Audio';\nimport * as Util from '../../Util/Util';\nimport { AudioContextFactory } from './AudioContext';\n\n/**\n * Internal class representing a Web Audio AudioBufferSourceNode instance\n * @see https://developer.mozilla.org/en-US/docs/Web/API/Web_Audio_API\n */\nexport class WebAudioInstance implements Audio {\n  private _volume = 1;\n  private _duration: number | undefined = undefined;\n\n  private _playingPromise: Promise<boolean>;\n  private _playingResolve: (value: boolean) => void;\n\n  private _loop = false;\n  public set loop(value: boolean) {\n    this._loop = value;\n\n    if (this._instance) {\n      this._instance.loop = value;\n      this._wireUpOnEnded();\n    }\n  }\n  public get loop(): boolean {\n    return this._loop;\n  }\n\n  public set volume(value: number) {\n    value = Util.clamp(value, 0, 1.0);\n\n    this._volume = value;\n\n    if (this._isPlaying && this._volumeNode.gain.setTargetAtTime) {\n      // https://developer.mozilla.org/en-US/docs/Web/API/AudioParam/setTargetAtTime\n      // After each .1 seconds timestep, the target value will ~63.2% closer to the target value.\n      // This exponential ramp provides a more pleasant transition in gain\n      this._volumeNode.gain.setTargetAtTime(value, this._audioContext.currentTime, 0.1);\n    } else {\n      this._volumeNode.gain.value = value;\n    }\n  }\n  public get volume(): number {\n    return this._volume;\n  }\n\n  public set duration(value: number | undefined) {\n    this._duration = value;\n  }\n\n  /**\n   * Duration of the sound, in seconds.\n   */\n  public get duration() {\n    return this._duration;\n  }\n\n  private get _playbackRate(): number {\n    return this._instance ? 1 / (this._instance.playbackRate.value || 1.0) : null;\n  }\n\n  private _isPlaying = false;\n  private _isPaused = false;\n  private _instance: AudioBufferSourceNode;\n  private _audioContext: AudioContext = AudioContextFactory.create();\n  private _volumeNode = this._audioContext.createGain();\n  private _startTime: number;\n\n  /**\n   * Current playback offset (in seconds)\n   */\n  private _currentOffset = 0;\n\n  constructor(private _src: AudioBuffer) {\n    this._createNewBufferSource();\n  }\n\n  public isPlaying() {\n    return this._isPlaying;\n  }\n\n  // eslint-disable-next-line @typescript-eslint/no-empty-function\n  public play(playStarted: () => any = () => {}) {\n    if (this._isPaused) {\n      this._resumePlayBack();\n      playStarted();\n    }\n\n    if (!this._isPlaying) {\n      this._startPlayBack();\n      playStarted();\n    }\n\n    return this._playingPromise;\n  }\n\n  public pause() {\n    if (!this._isPlaying) {\n      return;\n    }\n\n    this._isPaused = true;\n    this._isPlaying = false;\n\n    this._instance.stop(0);\n    // Playback rate will be a scale factor of how fast/slow the audio is being played\n    // default is 1.0\n    // we need to invert it to get the time scale\n\n    this._setPauseOffset();\n  }\n\n  public stop() {\n    if (!this._isPlaying) {\n      return;\n    }\n\n    this._isPlaying = false;\n    this._isPaused = false;\n\n    this._currentOffset = 0;\n    this._instance.stop(0);\n\n    // handler will not be wired up if we were looping\n    if (!this._instance.onended) {\n      this._handleOnEnded();\n    }\n  }\n\n  private _startPlayBack() {\n    this._isPlaying = true;\n    this._isPaused = false;\n    this._playingPromise = new Promise<boolean>((resolve) => {\n      this._playingResolve = resolve;\n    });\n\n    if (!this._instance) {\n      this._createNewBufferSource();\n    }\n\n    this._rememberStartTime();\n\n    this._volumeNode.connect(this._audioContext.destination);\n    this._instance.start(0, 0);\n    this._currentOffset = 0;\n\n    this._wireUpOnEnded();\n  }\n\n  private _resumePlayBack() {\n    if (!this._isPaused) {\n      return;\n    }\n\n    this._isPaused = false;\n    this._isPlaying = true;\n\n    // a buffer source can only be started once\n    // so we need to dispose of the previous instance before\n    // \"resuming\" the next one\n    this._instance.onended = null; // dispose of any previous event handler\n    this._createNewBufferSource();\n\n    const duration = this._playbackRate * this._src.duration;\n    const restartTime = this._currentOffset % duration;\n\n    this._rememberStartTime(restartTime * -1000);\n    this._instance.start(0, restartTime);\n    this._wireUpOnEnded();\n  }\n\n  private _wireUpOnEnded() {\n    if (!this.loop) {\n      this._instance.onended = () => this._handleOnEnded();\n    }\n  }\n\n  private _handleOnEnded() {\n    // pausing calls stop(0) which triggers onended event\n    // so we don't \"resolve\" yet (when we resume we'll try again)\n    if (!this._isPaused) {\n      this._isPlaying = false;\n      this._playingResolve(true);\n    }\n  }\n\n  private _rememberStartTime(amend?: number) {\n    this._startTime = new Date().getTime() + (amend | 0);\n  }\n\n  private _setPauseOffset() {\n    this._currentOffset = ((new Date().getTime() - this._startTime) * this._playbackRate) / 1000; // in seconds\n  }\n\n  private _createNewBufferSource() {\n    this._instance = this._audioContext.createBufferSource();\n    this._instance.buffer = this._src;\n    this._instance.loop = this.loop;\n    this._instance.playbackRate.setValueAtTime(1.0, 0);\n\n    this._instance.connect(this._volumeNode);\n  }\n}\n","import { Logger } from './Log';\n\n/**\n * Whether or not the browser can play this file as HTML5 Audio\n */\nexport function canPlayFile(file: string): boolean {\n  try {\n    const a = new Audio();\n    const filetype = /.*\\.([A-Za-z0-9]+)$/;\n    const type = file.match(filetype)[1];\n    if (a.canPlayType('audio/' + type)) {\n      return true;\n    } else {\n      return false;\n    }\n  } catch (e) {\n    Logger.getInstance().warn('Cannot determine audio support, assuming no support for the Audio Tag', e);\n    return false;\n  }\n}\n","import { ExResponse } from '../../Interfaces/AudioImplementation';\nimport { Audio } from '../../Interfaces/Audio';\nimport { Engine } from '../../Engine';\nimport { Resource } from '../Resource';\nimport { WebAudioInstance } from './WebAudioInstance';\nimport { AudioContextFactory } from './AudioContext';\nimport { NativeSoundEvent, NativeSoundProcessedEvent } from '../../Events/MediaEvents';\nimport { canPlayFile } from '../../Util/Sound';\nimport { Loadable } from '../../Interfaces/Index';\nimport { Logger } from '../../Util/Log';\nimport { Class } from '../../Class';\n\n/**\n * The [[Sound]] object allows games built in Excalibur to load audio\n * components, from soundtracks to sound effects. [[Sound]] is an [[Loadable]]\n * which means it can be passed to a [[Loader]] to pre-load before a game or level.\n */\nexport class Sound extends Class implements Audio, Loadable<AudioBuffer> {\n  public logger: Logger = Logger.getInstance();\n  public data: AudioBuffer;\n  private _resource: Resource<ArrayBuffer>;\n  /**\n   * Indicates whether the clip should loop when complete\n   * @param value  Set the looping flag\n   */\n  public set loop(value: boolean) {\n    this._loop = value;\n\n    for (const track of this._tracks) {\n      track.loop = this._loop;\n    }\n\n    this.logger.debug('Set loop for all instances of sound', this.path, 'to', this._loop);\n  }\n  public get loop(): boolean {\n    return this._loop;\n  }\n\n  public set volume(value: number) {\n    this._volume = value;\n\n    for (const track of this._tracks) {\n      track.volume = this._volume;\n    }\n\n    this.emit('volumechange', new NativeSoundEvent(this));\n\n    this.logger.debug('Set loop for all instances of sound', this.path, 'to', this._volume);\n  }\n  public get volume(): number {\n    return this._volume;\n  }\n\n  public get duration(): number | undefined {\n    return this._duration;\n  }\n\n  /**\n   * Return array of Current AudioInstances playing or being paused\n   */\n  public get instances(): Audio[] {\n    return this._tracks;\n  }\n\n  public get path() {\n    return this._resource.path;\n  }\n\n  public set path(val: string) {\n    this._resource.path = val;\n  }\n\n  private _loop = false;\n  private _volume = 1;\n  private _duration: number | undefined = undefined;\n  private _isStopped = false;\n  private _isPaused = false;\n  private _tracks: Audio[] = [];\n  private _engine: Engine;\n  private _wasPlayingOnHidden: boolean = false;\n  private _audioContext = AudioContextFactory.create();\n\n  /**\n   * @param paths A list of audio sources (clip.wav, clip.mp3, clip.ogg) for this audio clip. This is done for browser compatibility.\n   */\n  constructor(...paths: string[]) {\n    super();\n    this._resource = new Resource('', ExResponse.type.arraybuffer);\n    /**\n     * Chrome : MP3, WAV, Ogg\n     * Firefox : WAV, Ogg,\n     * IE : MP3, WAV coming soon\n     * Safari MP3, WAV, Ogg\n     */\n    for (const path of paths) {\n      if (canPlayFile(path)) {\n        this.path = path;\n        break;\n      }\n    }\n\n    if (!this.path) {\n      this.logger.warn('This browser does not support any of the audio files specified:', paths.join(', '));\n      this.logger.warn('Attempting to use', paths[0]);\n      this.path = paths[0]; // select the first specified\n    }\n  }\n\n  public isLoaded() {\n    return !!this.data;\n  }\n\n  public async load(): Promise<AudioBuffer> {\n    if (this.data) {\n      return this.data;\n    }\n    const arraybuffer = await this._resource.load();\n    const audiobuffer = await this.decodeAudio(arraybuffer.slice(0));\n    this._duration = typeof audiobuffer === 'object' ? audiobuffer.duration : undefined;\n    this.emit('processed', new NativeSoundProcessedEvent(this, audiobuffer));\n    return this.data = audiobuffer;\n  }\n\n  public async decodeAudio(data: ArrayBuffer): Promise<AudioBuffer> {\n    try {\n      return await this._audioContext.decodeAudioData(data.slice(0));\n    } catch (e) {\n      this.logger.error(\n        'Unable to decode ' +\n          ' this browser may not fully support this format, or the file may be corrupt, ' +\n          'if this is an mp3 try removing id3 tags and album art from the file.'\n      );\n      return await Promise.reject();\n    }\n  }\n\n  public wireEngine(engine: Engine) {\n    if (engine) {\n      this._engine = engine;\n\n      this._engine.on('hidden', () => {\n        if (engine.pauseAudioWhenHidden && this.isPlaying()) {\n          this._wasPlayingOnHidden = true;\n          this.pause();\n        }\n      });\n\n      this._engine.on('visible', () => {\n        if (engine.pauseAudioWhenHidden && this._wasPlayingOnHidden) {\n          this.play();\n          this._wasPlayingOnHidden = false;\n        }\n      });\n\n      this._engine.on('start', () => {\n        this._isStopped = false;\n      });\n\n      this._engine.on('stop', () => {\n        this.stop();\n        this._isStopped = true;\n      });\n    }\n  }\n\n  /**\n   * Returns how many instances of the sound are currently playing\n   */\n  public instanceCount(): number {\n    return this._tracks.length;\n  }\n\n  /**\n   * Whether or not the sound is playing right now\n   */\n  public isPlaying(): boolean {\n    return this._tracks.some((t) => t.isPlaying());\n  }\n\n  /**\n   * Play the sound, returns a promise that resolves when the sound is done playing\n   * An optional volume argument can be passed in to play the sound. Max volume is 1.0\n   */\n  public play(volume?: number): Promise<boolean> {\n    if (!this.isLoaded()) {\n      this.logger.warn('Cannot start playing. Resource', this.path, 'is not loaded yet');\n\n      return Promise.resolve(true);\n    }\n\n    if (this._isStopped) {\n      this.logger.warn('Cannot start playing. Engine is in a stopped state.');\n      return Promise.resolve(false);\n    }\n\n    this.volume = volume || this.volume;\n\n    if (this._isPaused) {\n      return this._resumePlayback();\n    } else {\n      return this._startPlayback();\n    }\n  }\n\n  /**\n   * Stop the sound, and do not rewind\n   */\n  public pause() {\n    if (!this.isPlaying()) {\n      return;\n    }\n\n    for (const track of this._tracks) {\n      track.pause();\n    }\n\n    this._isPaused = true;\n\n    this.emit('pause', new NativeSoundEvent(this));\n\n    this.logger.debug('Paused all instances of sound', this.path);\n  }\n\n  /**\n   * Stop the sound if it is currently playing and rewind the track. If the sound is not playing, rewinds the track.\n   */\n  public stop() {\n    for (const track of this._tracks) {\n      track.stop();\n    }\n\n    this.emit('stop', new NativeSoundEvent(this));\n\n    this._isPaused = false;\n    this._tracks.length = 0;\n    this.logger.debug('Stopped all instances of sound', this.path);\n  }\n\n\n\n  /**\n   * Get Id of provided AudioInstance in current trackList\n   * @param track [[Audio]] which Id is to be given\n   */\n  public getTrackId(track: Audio): number {\n    return this._tracks.indexOf(track);\n  }\n\n  private async _resumePlayback(): Promise<boolean> {\n    if (this._isPaused) {\n      const resumed: Promise<boolean>[] = [];\n      // ensure we resume *current* tracks (if paused)\n      for (const track of this._tracks) {\n        resumed.push(track.play());\n      }\n\n      this._isPaused = false;\n\n      this.emit('resume', new NativeSoundEvent(this));\n\n      this.logger.debug('Resuming paused instances for sound', this.path, this._tracks);\n      // resolve when resumed tracks are done\n      await Promise.all(resumed);\n    }\n    return true;\n  }\n\n  /**\n   * Starts playback, returns a promise that resolves when playback is complete\n   */\n  private async _startPlayback(): Promise<boolean> {\n    const track = await this._getTrackInstance(this.data);\n\n    const complete = await track.play(() => {\n      this.emit('playbackstart', new NativeSoundEvent(this, track));\n      this.logger.debug('Playing new instance for sound', this.path);\n    });\n\n    // when done, remove track\n    this.emit('playbackend', new NativeSoundEvent(this, track));\n    this._tracks.splice(this.getTrackId(track), 1);\n\n    return complete;\n  }\n\n  private _getTrackInstance(data: AudioBuffer): WebAudioInstance {\n    const newTrack = new WebAudioInstance(data);\n\n    newTrack.loop = this.loop;\n    newTrack.volume = this.volume;\n    newTrack.duration = this.duration;\n\n    this._tracks.push(newTrack);\n\n    return newTrack;\n  }\n}\n","import { Resource } from './Resource';\nimport { Sprite } from '../Graphics/Sprite';\nimport { Color } from '../Color';\nimport { SpriteSheet } from '../Graphics/SpriteSheet';\nimport { Animation } from '../Graphics/Animation';\nimport { Engine } from '../Engine';\nimport { Loadable } from '../Interfaces/Index';\nimport { ImageSource } from '../Graphics/ImageSource';\nimport { LegacyDrawing } from '..';\nimport { range } from '../Util/Util';\n/**\n * The [[Texture]] object allows games built in Excalibur to load image resources.\n * [[Texture]] is an [[Loadable]] which means it can be passed to a [[Loader]]\n * to pre-load before starting a level or game.\n */\nexport class Gif implements Loadable<ImageSource[]> {\n  private _resource: Resource<ArrayBuffer>;\n\n  /**\n   * The width of the texture in pixels\n   */\n  public width: number;\n\n  /**\n   * The height of the texture in pixels\n   */\n  public height: number;\n\n\n  private _stream: Stream = null;\n  private _gif: ParseGif = null;\n  private _textures: ImageSource[] = [];\n  private _animation: Animation = null;\n  private _transparentColor: Color = null;\n\n  public data: ImageSource[];\n\n  /**\n   * @param path       Path to the image resource\n   * @param color      Optionally set the color to treat as transparent the gif, by default [[Color.Magenta]]\n   * @param bustCache  Optionally load texture with cache busting\n   */\n  constructor(public path: string, public color: Color = Color.Magenta, public bustCache = true) {\n    this._resource = new Resource(path, 'arraybuffer', bustCache);\n    this._transparentColor = color;\n  }\n\n  /**\n   * Begins loading the texture and returns a promise to be resolved on completion\n   */\n  public async load(): Promise<ImageSource[]> {\n    const arraybuffer = await this._resource.load();\n    this._stream = new Stream(arraybuffer);\n    this._gif = new ParseGif(this._stream, this._transparentColor);\n    const images = this._gif.images.map(i => new ImageSource(i.src, false));\n\n    // Load all textures\n    await Promise.all(images.map(t => t.load()));\n    return this.data = this._textures = images;\n  }\n\n  public isLoaded() {\n    return !!this.data;\n  }\n\n  /**\n   * Return a frame of the gif as a legacy sprite by index\n   * @deprecated\n   */\n  public toLegacySprite(id: number = 0): LegacyDrawing.Sprite {\n    return Sprite.toLegacySprite(this.toSprite(id));\n  }\n\n  /**\n   * Return the gif as a legacy spritesheet\n   * @deprecated\n   * @returns\n   */\n  public toLegacySpriteSheet(): LegacyDrawing.SpriteSheet {\n    return SpriteSheet.toLegacySpriteSheet(this.toSpriteSheet());\n  }\n\n  /**\n   * Return the gif as a legacy animation\n   * @deprecated\n   * @param speed\n   */\n  public toLegacyAnimation(engine: Engine, speed: number): LegacyDrawing.Animation {\n    return Animation.toLegacyAnimation(engine, this.toAnimation(speed));\n  }\n\n  /**\n   * Return a frame of the gif as a sprite by id\n   * @param id\n   */\n  public toSprite(id: number = 0): Sprite {\n    const sprite = this._textures[id].toSprite();\n    return sprite;\n  }\n\n  /**\n   * Return the gif as a spritesheet\n   */\n  public toSpriteSheet(): SpriteSheet {\n    const sprites: Sprite[] = this._textures.map((image) => {\n      return image.toSprite();\n    });\n    return new SpriteSheet({ sprites });\n  }\n\n  /**\n   * Transform the GIF into an animation with duration per frame\n   */\n  public toAnimation(durationPerFrameMs: number): Animation {\n    const spriteSheet: SpriteSheet = this.toSpriteSheet();\n    const length = spriteSheet.sprites.length;\n    this._animation = Animation.fromSpriteSheet(spriteSheet, range(0, length), durationPerFrameMs);\n    return this._animation;\n  }\n\n  public get readCheckBytes(): number[] {\n    return this._gif.checkBytes;\n  }\n}\n\nexport interface GifFrame {\n  sentinel: number;\n  type: string;\n  leftPos: number;\n  topPos: number;\n  width: number;\n  height: number;\n  lctFlag: boolean;\n  interlaced: boolean;\n  sorted: boolean;\n  reserved: boolean[];\n  lctSize: number;\n  lzwMinCodeSize: number;\n  pixels: number[];\n}\n\nconst bitsToNum = (ba: any) => {\n  return ba.reduce(function (s: number, n: number) {\n    return s * 2 + n;\n  }, 0);\n};\n\nconst byteToBitArr = (bite: any) => {\n  const a = [];\n  for (let i = 7; i >= 0; i--) {\n    a.push(!!(bite & (1 << i)));\n  }\n  return a;\n};\n\nexport class Stream {\n  data: any = null;\n  len: number = 0;\n  position: number = 0;\n\n  constructor(dataArray: ArrayBuffer) {\n    this.data = new Uint8Array(dataArray);\n    this.len = this.data.byteLength;\n    if (this.len === 0) {\n      throw new Error('No data loaded from file');\n    }\n  }\n\n  public readByte = () => {\n    if (this.position >= this.data.byteLength) {\n      throw new Error('Attempted to read past end of stream.');\n    }\n    return this.data[this.position++];\n  };\n\n  public readBytes = (n: number) => {\n    const bytes = [];\n    for (let i = 0; i < n; i++) {\n      bytes.push(this.readByte());\n    }\n    return bytes;\n  };\n\n  public read = (n: number) => {\n    let s = '';\n    for (let i = 0; i < n; i++) {\n      s += String.fromCharCode(this.readByte());\n    }\n    return s;\n  };\n\n  public readUnsigned = () => {\n    // Little-endian.\n    const a = this.readBytes(2);\n    return (a[1] << 8) + a[0];\n  };\n}\n\nconst lzwDecode = function (minCodeSize: number, data: any) {\n  // TODO: Now that the GIF parser is a bit different, maybe this should get an array of bytes instead of a String?\n  let pos = 0; // Maybe this streaming thing should be merged with the Stream?\n\n  const readCode = function (size: number) {\n    let code = 0;\n    for (let i = 0; i < size; i++) {\n      if (data.charCodeAt(pos >> 3) & (1 << (pos & 7))) {\n        code |= 1 << i;\n      }\n      pos++;\n    }\n    return code;\n  };\n\n  const output: any[] = [];\n\n  const clearCode = 1 << minCodeSize;\n  const eoiCode = clearCode + 1;\n\n  let codeSize = minCodeSize + 1;\n\n  let dict: any[] = [];\n\n  const clear = function () {\n    dict = [];\n    codeSize = minCodeSize + 1;\n    for (let i = 0; i < clearCode; i++) {\n      dict[i] = [i];\n    }\n    dict[clearCode] = [];\n    dict[eoiCode] = null;\n  };\n\n  let code;\n  let last;\n\n  while (true) {\n    last = code;\n    code = readCode(codeSize);\n    if (code === clearCode) {\n      clear();\n      continue;\n    }\n    if (code === eoiCode) {\n      break;\n    }\n\n    if (code < dict.length) {\n      if (last !== clearCode) {\n        dict.push(dict[last].concat(dict[code][0]));\n      }\n    } else {\n      if (code !== dict.length) {\n        throw new Error('Invalid LZW code.');\n      }\n      dict.push(dict[last].concat(dict[last][0]));\n    }\n    output.push.apply(output, dict[code]);\n\n    if (dict.length === 1 << codeSize && codeSize < 12) {\n      // If we're at the last code and codeSize is 12, the next code will be a clearCode, and it'll be 12 bits long.\n      codeSize++;\n    }\n  }\n\n  // I don't know if this is technically an error, but some GIFs do it.\n  //if (Math.ceil(pos / 8) !== data.length) throw new Error('Extraneous LZW bytes.');\n  return output;\n};\n\n// The actual parsing; returns an object with properties.\nexport class ParseGif {\n  private _st: Stream = null;\n  private _handler: any = {};\n  private _transparentColor: Color = null;\n  public frames: GifFrame[] = [];\n  public images: HTMLImageElement[] = [];\n  public globalColorTable: any[] = [];\n  public checkBytes: number[] = [];\n\n  constructor(stream: Stream, color: Color = Color.Magenta) {\n    this._st = stream;\n    this._handler = {};\n    this._transparentColor = color;\n    this.parseHeader();\n    this.parseBlock();\n  }\n\n  // LZW (GIF-specific)\n  parseColorTable = (entries: any) => {\n    // Each entry is 3 bytes, for RGB.\n    const ct = [];\n    for (let i = 0; i < entries; i++) {\n      const rgb: number[] = this._st.readBytes(3);\n      const rgba =\n        '#' +\n        rgb\n          .map((x: any) => {\n            const hex = x.toString(16);\n            return hex.length === 1 ? '0' + hex : hex;\n          })\n          .join('');\n      ct.push(rgba);\n    }\n    return ct;\n  };\n\n  readSubBlocks = () => {\n    let size, data;\n    data = '';\n    do {\n      size = this._st.readByte();\n      data += this._st.read(size);\n    } while (size !== 0);\n    return data;\n  };\n\n  parseHeader = () => {\n    const hdr: any = {\n      sig: null,\n      ver: null,\n      width: null,\n      height: null,\n      colorRes: null,\n      globalColorTableSize: null,\n      gctFlag: null,\n      sorted: null,\n      globalColorTable: [],\n      bgColor: null,\n      pixelAspectRatio: null // if not 0, aspectRatio = (pixelAspectRatio + 15) / 64\n    };\n\n    hdr.sig = this._st.read(3);\n    hdr.ver = this._st.read(3);\n    if (hdr.sig !== 'GIF') {\n      throw new Error('Not a GIF file.'); // XXX: This should probably be handled more nicely.\n    }\n\n    hdr.width = this._st.readUnsigned();\n    hdr.height = this._st.readUnsigned();\n\n    const bits = byteToBitArr(this._st.readByte());\n    hdr.gctFlag = bits.shift();\n    hdr.colorRes = bitsToNum(bits.splice(0, 3));\n    hdr.sorted = bits.shift();\n    hdr.globalColorTableSize = bitsToNum(bits.splice(0, 3));\n\n    hdr.bgColor = this._st.readByte();\n    hdr.pixelAspectRatio = this._st.readByte(); // if not 0, aspectRatio = (pixelAspectRatio + 15) / 64\n\n    if (hdr.gctFlag) {\n      hdr.globalColorTable = this.parseColorTable(1 << (hdr.globalColorTableSize + 1));\n      this.globalColorTable = hdr.globalColorTable;\n    }\n    if (this._handler.hdr && this._handler.hdr(hdr)) {\n      this.checkBytes.push(this._handler.hdr);\n    }\n  };\n\n  parseExt = (block: any) => {\n    const parseGCExt = (block: any) => {\n      this.checkBytes.push(this._st.readByte()); // Always 4\n\n      const bits = byteToBitArr(this._st.readByte());\n      block.reserved = bits.splice(0, 3); // Reserved; should be 000.\n      block.disposalMethod = bitsToNum(bits.splice(0, 3));\n      block.userInput = bits.shift();\n      block.transparencyGiven = bits.shift();\n\n      block.delayTime = this._st.readUnsigned();\n\n      block.transparencyIndex = this._st.readByte();\n\n      block.terminator = this._st.readByte();\n\n      if (this._handler.gce && this._handler.gce(block)) {\n        this.checkBytes.push(this._handler.gce);\n      }\n    };\n\n    const parseComExt = (block: any) => {\n      block.comment = this.readSubBlocks();\n      if (this._handler.com && this._handler.com(block)) {\n        this.checkBytes.push(this._handler.com);\n      }\n    };\n\n    const parsePTExt = (block: any) => {\n      this.checkBytes.push(this._st.readByte()); // Always 12\n      block.ptHeader = this._st.readBytes(12);\n      block.ptData = this.readSubBlocks();\n      if (this._handler.pte && this._handler.pte(block)) {\n        this.checkBytes.push(this._handler.pte);\n      }\n    };\n\n    const parseAppExt = (block: any) => {\n      const parseNetscapeExt = (block: any) => {\n        this.checkBytes.push(this._st.readByte()); // Always 3\n        block.unknown = this._st.readByte(); // Q: Always 1? What is this?\n        block.iterations = this._st.readUnsigned();\n        block.terminator = this._st.readByte();\n        if (this._handler.app && this._handler.app.NETSCAPE && this._handler.app.NETSCAPE(block)) {\n          this.checkBytes.push(this._handler.app);\n        }\n      };\n\n      const parseUnknownAppExt = (block: any) => {\n        block.appData = this.readSubBlocks();\n        // FIXME: This won't work if a handler wants to match on any identifier.\n        if (this._handler.app && this._handler.app[block.identifier] && this._handler.app[block.identifier](block)) {\n          this.checkBytes.push(this._handler.app[block.identifier]);\n        }\n      };\n\n      this.checkBytes.push(this._st.readByte()); // Always 11\n      block.identifier = this._st.read(8);\n      block.authCode = this._st.read(3);\n      switch (block.identifier) {\n        case 'NETSCAPE':\n          parseNetscapeExt(block);\n          break;\n        default:\n          parseUnknownAppExt(block);\n          break;\n      }\n    };\n\n    const parseUnknownExt = (block: any) => {\n      block.data = this.readSubBlocks();\n      if (this._handler.unknown && this._handler.unknown(block)) {\n        this.checkBytes.push(this._handler.unknown);\n      }\n    };\n\n    block.label = this._st.readByte();\n    switch (block.label) {\n      case 0xf9:\n        block.extType = 'gce';\n        parseGCExt(block);\n        break;\n      case 0xfe:\n        block.extType = 'com';\n        parseComExt(block);\n        break;\n      case 0x01:\n        block.extType = 'pte';\n        parsePTExt(block);\n        break;\n      case 0xff:\n        block.extType = 'app';\n        parseAppExt(block);\n        break;\n      default:\n        block.extType = 'unknown';\n        parseUnknownExt(block);\n        break;\n    }\n  };\n\n  parseImg = (img: any) => {\n    const deinterlace = (pixels: any, width: any) => {\n      // Of course this defeats the purpose of interlacing. And it's *probably*\n      // the least efficient way it's ever been implemented. But nevertheless...\n\n      const newPixels = new Array(pixels.length);\n      const rows = pixels.length / width;\n      const cpRow = (toRow: any, fromRow: any) => {\n        const fromPixels = pixels.slice(fromRow * width, (fromRow + 1) * width);\n        newPixels.splice.apply(newPixels, [toRow * width, width].concat(fromPixels));\n      };\n\n      const offsets = [0, 4, 2, 1];\n      const steps = [8, 8, 4, 2];\n\n      let fromRow = 0;\n      for (let pass = 0; pass < 4; pass++) {\n        for (let toRow = offsets[pass]; toRow < rows; toRow += steps[pass]) {\n          cpRow(toRow, fromRow);\n          fromRow++;\n        }\n      }\n\n      return newPixels;\n    };\n\n    img.leftPos = this._st.readUnsigned();\n    img.topPos = this._st.readUnsigned();\n    img.width = this._st.readUnsigned();\n    img.height = this._st.readUnsigned();\n\n    const bits = byteToBitArr(this._st.readByte());\n    img.lctFlag = bits.shift();\n    img.interlaced = bits.shift();\n    img.sorted = bits.shift();\n    img.reserved = bits.splice(0, 2);\n    img.lctSize = bitsToNum(bits.splice(0, 3));\n\n    if (img.lctFlag) {\n      img.lct = this.parseColorTable(1 << (img.lctSize + 1));\n    }\n\n    img.lzwMinCodeSize = this._st.readByte();\n\n    const lzwData = this.readSubBlocks();\n\n    img.pixels = lzwDecode(img.lzwMinCodeSize, lzwData);\n\n    if (img.interlaced) {\n      // Move\n      img.pixels = deinterlace(img.pixels, img.width);\n    }\n\n    this.frames.push(img);\n    this.arrayToImage(img);\n    if (this._handler.img && this._handler.img(img)) {\n      this.checkBytes.push(this._handler);\n    }\n  };\n\n  public parseBlock = () => {\n    const block = {\n      sentinel: this._st.readByte(),\n      type: ''\n    };\n    const blockChar = String.fromCharCode(block.sentinel);\n    switch (blockChar) {\n      case '!':\n        block.type = 'ext';\n        this.parseExt(block);\n        break;\n      case ',':\n        block.type = 'img';\n        this.parseImg(block);\n        break;\n      case ';':\n        block.type = 'eof';\n        if (this._handler.eof && this._handler.eof(block)) {\n          this.checkBytes.push(this._handler.eof);\n        }\n        break;\n      default:\n        throw new Error('Unknown block: 0x' + block.sentinel.toString(16));\n    }\n\n    if (block.type !== 'eof') {\n      this.parseBlock();\n    }\n  };\n\n  arrayToImage = (frame: GifFrame) => {\n    let count = 0;\n    const c = document.createElement('canvas');\n    c.id = count.toString();\n    c.width = frame.width;\n    c.height = frame.height;\n    count++;\n    const context = c.getContext('2d');\n    const pixSize = 1;\n    let y = 0;\n    let x = 0;\n    for (let i = 0; i < frame.pixels.length; i++) {\n      if (x % frame.width === 0) {\n        y++;\n        x = 0;\n      }\n      if (this.globalColorTable[frame.pixels[i]] === this._transparentColor.toHex()) {\n        context.fillStyle = `rgba(0, 0, 0, 0)`;\n      } else {\n        context.fillStyle = this.globalColorTable[frame.pixels[i]];\n      }\n\n      context.fillRect(x, y, pixSize, pixSize);\n      x++;\n    }\n    const img = new Image();\n    img.src = c.toDataURL();\n    this.images.push(img);\n  };\n}\n","import { Vector, vec } from '../Math/vector';\nimport { Raster, RasterOptions } from './Raster';\n\nexport interface PolygonOptions {\n  points: Vector[];\n}\n\n/**\n * A polygon [[Graphic]] for drawing arbitrary polygons to the [[ExcaliburGraphicsContext]]\n */\nexport class Polygon extends Raster {\n  private _points: Vector[];\n  public get points(): Vector[] {\n    return this._points;\n  }\n  public set points(points: Vector[]) {\n    this._points = points;\n    const min = this.minPoint;\n    this.width = this._points.reduce((max, p) => Math.max(p.x, max), 0) - min.x;\n    this.height = this._points.reduce((max, p) => Math.max(p.y, max), 0) - min.y;\n    this.flagDirty();\n  }\n\n  public get minPoint() {\n    const minX = this._points.reduce((min, p) => Math.min(p.x, min), Infinity);\n    const minY = this._points.reduce((min, p) => Math.min(p.y, min), Infinity);\n    return vec(minX, minY);\n  }\n\n  constructor(options: RasterOptions & PolygonOptions) {\n    super(options);\n    this.points = options.points;\n    this.rasterize();\n  }\n\n  public clone(): Polygon {\n    return new Polygon({\n      points: this.points.map((p) => p.clone()),\n      ...this.cloneGraphicOptions(),\n      ...this.cloneRasterOptions()\n    });\n  }\n\n  execute(ctx: CanvasRenderingContext2D): void {\n    if (this.points && this.points.length) {\n      ctx.beginPath();\n      // Iterate through the supplied points and construct a 'polygon'\n      const min = this.minPoint.negate();\n      const firstPoint = this.points[0].add(min);\n      ctx.moveTo(firstPoint.x, firstPoint.y);\n      this.points.forEach((point) => {\n        ctx.lineTo(point.x + min.x, point.y + min.y);\n      });\n      ctx.lineTo(firstPoint.x, firstPoint.y);\n      ctx.closePath();\n      if (this.color) {\n        ctx.fill();\n      }\n      if (this.strokeColor) {\n        ctx.stroke();\n      }\n    }\n  }\n}\n","import { obsolete } from './Decorators';\n\n/**\n * A sorted list implementation. NOTE: this implementation is not self-balancing\n * @deprecated WIll be removed in v0.26.0 Use built in JS array.sort\n */\n@obsolete({message: 'Will be removed in excalibur v0.26.0', alternateMethod: 'Use built in JS array.sort'})\nexport class SortedList<T> {\n  private _getComparable: (item: T) => number;\n  private _root: BinaryTreeNode<T>;\n\n  constructor(getComparable: (item: T) => number) {\n    this._getComparable = getComparable;\n  }\n\n  public find(element: T): boolean {\n    return this._find(this._root, element);\n  }\n\n  private _find(node: BinaryTreeNode<T>, element: any): boolean {\n    if (node == null) {\n      return false;\n    } else if (this._getComparable(element) === node.getKey()) {\n      if (node.getData().indexOf(element) > -1) {\n        return true;\n      } else {\n        return false;\n      }\n    } else if (this._getComparable(element) < node.getKey()) {\n      return this._find(node.getLeft(), element);\n    } else {\n      return this._find(node.getRight(), element);\n    }\n  }\n\n  // returns the array of elements at a specific key value\n  public get(key: number): any[] {\n    return this._get(this._root, key);\n  }\n\n  private _get(node: BinaryTreeNode<T>, key: number): any[] {\n    if (node == null) {\n      return [];\n    } else if (key === node.getKey()) {\n      return node.getData();\n    } else if (key < node.getKey()) {\n      return this._get(node.getLeft(), key);\n    } else {\n      return this._get(node.getRight(), key);\n    }\n  }\n\n  public add(element: T): boolean {\n    if (this._root == null) {\n      this._root = new BinaryTreeNode(this._getComparable(element), [element], null, null);\n      return true;\n    } else {\n      return this._insert(this._root, element);\n    }\n  }\n\n  private _insert(node: BinaryTreeNode<T>, element: T): boolean {\n    if (node != null) {\n      if (this._getComparable(element) === node.getKey()) {\n        if (node.getData().indexOf(element) > -1) {\n          return false; // the element we're trying to insert already exists\n        } else {\n          node.getData().push(element);\n          return true;\n        }\n      } else if (this._getComparable(element) < node.getKey()) {\n        if (node.getLeft() == null) {\n          node.setLeft(new BinaryTreeNode(this._getComparable(element), [element], null, null));\n          return true;\n        } else {\n          return this._insert(node.getLeft(), element);\n        }\n      } else {\n        if (node.getRight() == null) {\n          node.setRight(new BinaryTreeNode(this._getComparable(element), [element], null, null));\n          return true;\n        } else {\n          return this._insert(node.getRight(), element);\n        }\n      }\n    }\n    return false;\n  }\n\n  public removeByComparable(element: T): void {\n    this._root = this._remove(this._root, element);\n  }\n\n  private _remove(node: BinaryTreeNode<T>, element: T): BinaryTreeNode<T> {\n    if (node == null) {\n      return null;\n    } else if (this._getComparable(element) === node.getKey()) {\n      const elementIndex = node.getData().indexOf(element);\n      // if the node contains the element, remove the element\n      if (elementIndex > -1) {\n        node.getData().splice(elementIndex, 1);\n        // if we have removed the last element at this node, remove the node\n        if (node.getData().length === 0) {\n          // if the node is a leaf\n          if (node.getLeft() == null && node.getRight() == null) {\n            return null;\n          } else if (node.getLeft() == null) {\n            return node.getRight();\n          } else if (node.getRight() == null) {\n            return node.getLeft();\n          }\n          // if node has 2 children\n          const temp = this._findMinNode(node.getRight());\n          node.setKey(temp.getKey());\n          node.setData(temp.getData());\n          node.setRight(this._cleanup(node.getRight(), temp)); //\"cleanup nodes\" (move them up recursively)\n          return node;\n        } else {\n          // this prevents the node from being removed since it still contains elements\n          return node;\n        }\n      }\n    } else if (this._getComparable(element) < node.getKey()) {\n      node.setLeft(this._remove(node.getLeft(), element));\n      return node;\n    } else {\n      node.setRight(this._remove(node.getRight(), element));\n      return node;\n    }\n    return null;\n  }\n\n  // called once we have successfully removed the element we wanted, recursively corrects the part of the tree below the removed node\n  private _cleanup(node: BinaryTreeNode<T>, element: BinaryTreeNode<T>): BinaryTreeNode<T> {\n    const comparable = element.getKey();\n    if (node == null) {\n      return null;\n    } else if (comparable === node.getKey()) {\n      // if the node is a leaf\n      if (node.getLeft() == null && node.getRight() == null) {\n        return null;\n      } else if (node.getLeft() == null) {\n        return node.getRight();\n      } else if (node.getRight() == null) {\n        return node.getLeft();\n      }\n      // if node has 2 children\n      const temp = this._findMinNode(node.getRight());\n      node.setKey(temp.getKey());\n      node.setData(temp.getData());\n\n      node.setRight(this._cleanup(node.getRight(), temp));\n      return node;\n    } else if (element.getKey() < node.getKey()) {\n      node.setLeft(this._cleanup(node.getLeft(), element));\n      return node;\n    } else {\n      node.setRight(this._cleanup(node.getRight(), element));\n      return node;\n    }\n  }\n\n  private _findMinNode(node: BinaryTreeNode<T>): BinaryTreeNode<T> {\n    let current = node;\n    while (current.getLeft() != null) {\n      current = current.getLeft();\n    }\n    return current;\n  }\n\n  public list(): Array<T> {\n    const results = new Array<T>();\n    this._list(this._root, results);\n    return results;\n  }\n\n  private _list(treeNode: BinaryTreeNode<T>, results: Array<T>): void {\n    if (treeNode != null) {\n      this._list(treeNode.getLeft(), results);\n      treeNode.getData().forEach((element) => {\n        results.push(element);\n      });\n      this._list(treeNode.getRight(), results);\n    }\n  }\n}\n\n/**\n * A tree node part of [[SortedList]]\n * @deprecated Will be removed in v0.26.0\n */\n@obsolete({message: 'Will be removed in excalibur v0.26.0'})\nexport class BinaryTreeNode<T> {\n  private _key: number;\n  private _data: Array<T>;\n  private _left: BinaryTreeNode<T>;\n  private _right: BinaryTreeNode<T>;\n\n  constructor(key: number, data: Array<T>, left: BinaryTreeNode<T>, right: BinaryTreeNode<T>) {\n    this._key = key;\n    this._data = data;\n    this._left = left;\n    this._right = right;\n  }\n\n  public getKey(): number {\n    return this._key;\n  }\n\n  public setKey(key: number) {\n    this._key = key;\n  }\n\n  public getData(): T[] {\n    return this._data;\n  }\n\n  public setData(data: T[]) {\n    this._data = data;\n  }\n\n  public getLeft(): BinaryTreeNode<T> {\n    return this._left;\n  }\n\n  public setLeft(left: BinaryTreeNode<T>) {\n    this._left = left;\n  }\n\n  public getRight(): BinaryTreeNode<T> {\n    return this._right;\n  }\n\n  public setRight(right: BinaryTreeNode<T>) {\n    this._right = right;\n  }\n}\n\n/**\n * Mock element for testing\n *\n * @internal\n * @deprecated Will be removed in v0.26.0\n */\nexport class MockedElement {\n  private _key: number = 0;\n\n  constructor(key: number) {\n    this._key = key;\n  }\n\n  public getTheKey() {\n    return this._key;\n  }\n\n  public setKey(key: number) {\n    this._key = key;\n  }\n}\n","// Promises/A+ Spec http://promises-aplus.github.io/promises-spec/\n\nimport { obsolete } from './Util/Decorators';\n\n/**\n * Valid states for a promise to be in\n * @deprecated Will be removed in v0.26.0\n */\nexport enum PromiseState {\n  Resolved,\n  Rejected,\n  Pending\n}\n\n/**\n * @deprecated Will be removed in v0.26.0\n */\nexport interface PromiseLike<T> {\n  then(successCallback?: (value?: T) => any, rejectCallback?: (value?: T) => any): PromiseLike<T>;\n  error(rejectCallback?: (value?: any) => any): PromiseLike<T>;\n\n  //Cannot define static methods on interfaces\n  //wrap<T>(value?: T): IPromise<T>;\n\n  resolve(value?: T): PromiseLike<T>;\n  reject(value?: any): PromiseLike<T>;\n\n  state(): PromiseState;\n}\n\n/**\n * Promises are used to do asynchronous work and they are useful for\n * creating a chain of actions. In Excalibur they are used for loading,\n * sounds, animation, actions, and more.\n * @deprecated Will be removed in v0.26.0\n */\n@obsolete({\n  message: 'ex.Promises are being replaced by native browser promises in v0.26.0',\n  alternateMethod: 'Use browser native promises'\n})\nexport class Promise<T> implements PromiseLike<T> {\n  private _state: PromiseState = PromiseState.Pending;\n  private _value: T;\n  private _successCallbacks: { (value?: T): any }[] = [];\n  private _rejectCallback: (value?: any) => any = () => {\n    return;\n  };\n  private _errorCallback: (value?: any) => any;\n\n  /**\n   * Create and resolve a Promise with an optional value\n   * @param value  An optional value to wrap in a resolved promise\n   * @deprecated Use browser native promises\n   */\n  public static resolve<T>(value?: T): Promise<T> {\n    const promise = new Promise<T>().resolve(value);\n\n    return promise;\n  }\n\n  /**\n   * Create and reject a Promise with an optional value\n   * @param value  An optional value to wrap in a rejected promise\n   * @deprecated Use browser native promises\n   */\n  public static reject<T>(value?: T): Promise<T> {\n    const promise = new Promise<T>().reject(value);\n\n    return promise;\n  }\n\n  /**\n   * Returns a new promise that resolves when all the promises passed to it resolve, or rejects\n   * when at least 1 promise rejects.\n   * @deprecated Use browser native promises\n   */\n  public static join<T>(promises: Promise<T>[]): Promise<T>;\n\n  /**\n   * Returns a new promise that resolves when all the promises passed to it resolve, or rejects\n   * when at least 1 promise rejects.\n   * @deprecated Use browser native promises\n   */\n  public static join<T>(...promises: Promise<T>[]): Promise<T>;\n\n  public static join<T>() {\n    let promises: Promise<T>[] = [];\n\n    if (arguments.length > 0 && !Array.isArray(arguments[0])) {\n      for (let _i = 0; _i < arguments.length; _i++) {\n        promises[_i - 0] = arguments[_i];\n      }\n    } else if (arguments.length === 1 && Array.isArray(arguments[0])) {\n      promises = arguments[0];\n    }\n\n    const joinedPromise = new Promise<T>();\n    if (!promises || !promises.length) {\n      return joinedPromise.resolve();\n    }\n\n    const total = promises.length;\n    let successes = 0;\n    let rejects = 0;\n    const errors: any = [];\n\n    promises.forEach((p) => {\n      p.then(\n        () => {\n          successes += 1;\n          if (successes === total) {\n            joinedPromise.resolve();\n          } else if (successes + rejects + errors.length === total) {\n            joinedPromise.reject(errors);\n          }\n        },\n        () => {\n          rejects += 1;\n          if (successes + rejects + errors.length === total) {\n            joinedPromise.reject(errors);\n          }\n        }\n      ).error((e) => {\n        errors.push(e);\n        if (errors.length + successes + rejects === total) {\n          joinedPromise.reject(errors);\n        }\n      });\n    });\n\n    return joinedPromise;\n  }\n\n  /**\n   * Chain success and reject callbacks after the promise is resolved\n   * @param successCallback  Call on resolution of promise\n   * @param rejectCallback   Call on rejection of promise\n   * @deprecated Use browser native promises\n   */\n  public then(successCallback?: (value?: T) => any, rejectCallback?: (value?: any) => any) {\n    if (successCallback) {\n      this._successCallbacks.push(successCallback);\n\n      // If the promise is already resolved call immediately\n      if (this.state() === PromiseState.Resolved) {\n        try {\n          successCallback.call(this, this._value);\n        } catch (e) {\n          this._handleError(e);\n        }\n      }\n    }\n    if (rejectCallback) {\n      this._rejectCallback = rejectCallback;\n\n      // If the promise is already rejected call immediately\n      if (this.state() === PromiseState.Rejected) {\n        try {\n          rejectCallback.call(this, this._value);\n        } catch (e) {\n          this._handleError(e);\n        }\n      }\n    }\n\n    return this;\n  }\n\n  /**\n   * Add an error callback to the promise\n   * @param errorCallback  Call if there was an error in a callback\n   * @deprecated Use browser native promises\n   */\n  public error(errorCallback?: (value?: any) => any) {\n    if (errorCallback) {\n      this._errorCallback = errorCallback;\n    }\n    return this;\n  }\n\n  /**\n   * Resolve the promise and pass an option value to the success callbacks\n   * @param value  Value to pass to the success callbacks\n   * @deprecated Use browser native promises\n   */\n  public resolve(value?: T): Promise<T> {\n    if (this._state === PromiseState.Pending) {\n      this._value = value;\n      try {\n        this._state = PromiseState.Resolved;\n        this._successCallbacks.forEach((cb) => {\n          cb.call(this, this._value);\n        });\n      } catch (e) {\n        this._handleError(e);\n      }\n    } else {\n      throw new Error('Cannot resolve a promise that is not in a pending state!');\n    }\n    return this;\n  }\n\n  /**\n   * Reject the promise and pass an option value to the reject callbacks\n   * @param value  Value to pass to the reject callbacks\n   * @deprecated Use browser native promises\n   */\n  public reject(value?: any) {\n    if (this._state === PromiseState.Pending) {\n      this._value = value;\n      try {\n        this._state = PromiseState.Rejected;\n        this._rejectCallback.call(this, this._value);\n      } catch (e) {\n        this._handleError(e);\n      }\n    } else {\n      throw new Error('Cannot reject a promise that is not in a pending state!');\n    }\n    return this;\n  }\n\n  /**\n   * Inspect the current state of a promise\n   * @deprecated Use browser native promises\n   */\n  public state(): PromiseState {\n    return this._state;\n  }\n\n  private _handleError(e: any) {\n    if (this._errorCallback) {\n      this._errorCallback.call(this, e);\n    } else {\n      // rethrow error\n      throw e;\n    }\n  }\n}\n","/**\n * The current Excalibur version string\n * @description `process.env.__EX_VERSION` gets replaced by Webpack on build\n */\nexport const EX_VERSION = process.env.__EX_VERSION;\nimport { polyfill } from './Polyfill';\npolyfill();\n\n// This file is used as the bundle entry point and exports everything\n// that will be exposed as the `ex` global variable.\nexport * from './Flags';\nexport * from './Id';\nexport * from './Engine';\nexport * from './Screen';\nexport { Actor, ActorArgs } from './Actor';\nexport * from './Math/Index';\nexport * from './Camera';\nexport * from './Class';\nexport * from './Configurable';\nexport * from './Debug/index';\nexport * from './EventDispatcher';\nexport * from './Events/MediaEvents';\nexport * from './Events';\nexport * from './Label';\nexport { FontStyle, FontUnit, TextAlign, BaseAlign } from './Graphics/FontCommon';\nexport * from './Loader';\nexport { Particle, ParticleEmitter, ParticleArgs, ParticleEmitterArgs, EmitterType } from './Particles';\nexport * from './Collision/Physics';\nexport * from './Scene';\nexport { TileMap, Cell, TileMapArgs, CellArgs } from './TileMap';\nexport * from './Timer';\nexport * from './Trigger';\nexport * from './ScreenElement';\n\nexport * from './Actions/Index';\nexport * from './Collision/Index';\n\n// ex.LegacyDrawing namespace\nimport * as legacyDrawing from './Drawing/Index';\nexport { legacyDrawing as LegacyDrawing };\nexport * from './Interfaces/Index';\nexport * from './PostProcessing/Index';\nexport * from './Resources/Index';\n\nexport * from './EntityComponentSystem/index';\n\nexport * from './Color';\n\nexport * from './Graphics/index';\n\n// ex.Events namespace\nimport * as events from './Events';\nexport { events as Events };\n\n// ex.Input namespace\nimport * as input from './Input/Index';\nexport { input as Input };\n\n// ex.Traits namespace\nimport * as traits from './Traits/Index';\nexport { traits as Traits };\n\n// ex.Util namespaces\nimport * as util from './Util/Index';\nexport { util as Util };\n\nexport * from './Util/Browser';\nexport * from './Util/Decorators';\nexport * from './Util/Detector';\nexport * from './Util/CullingBox';\nexport * from './Util/EasingFunctions';\nexport * from './Util/Log';\nexport * from './Util/SortedList';\nexport * from './Util/Pool';\n\n// ex.Deprecated\nexport * from './Promises';\n// import * as deprecated from './Deprecated';\n// export { deprecated as Deprecated };\n// export * from './Deprecated';\n"],"names":["root","factory","self","i","entryUnbind","module","exports","path","Object","keys","isCallable","tryToString","argument","TypeError","isObject","String","toIndexedObject","toLength","toAbsoluteIndex","createMethod","IS_INCLUDES","$this","el","fromIndex","value","O","length","index","includes","indexOf","fails","METHOD_NAME","method","call","floor","Math","mergeSort","array","comparefn","middle","insertionSort","merge","slice","element","j","left","right","llength","rlength","lindex","rindex","result","push","toString","it","TO_STRING_TAG_SUPPORT","classofRaw","TO_STRING_TAG","CORRECT_ARGUMENTS","arguments","tag","key","error","callee","has","ownKeys","getOwnPropertyDescriptorModule","definePropertyModule","target","source","defineProperty","f","getOwnPropertyDescriptor","DESCRIPTORS","createPropertyDescriptor","object","bitmap","enumerable","configurable","writable","get","global","document","EXISTS","createElement","firefox","match","UA","test","getBuiltIn","version","userAgent","process","Deno","versions","v8","split","webkit","bind","Function","CONSTRUCTOR","METHOD","prototype","createNonEnumerableProperty","redefine","setGlobal","copyConstructorProperties","isForced","options","targetProperty","sourceProperty","descriptor","TARGET","GLOBAL","STATIC","stat","noTargetGet","forced","sham","exec","aCallable","fn","that","a","b","c","apply","FunctionPrototype","getDescriptor","PROPER","name","CONFIGURABLE","aFunction","namespace","V","P","func","check","globalThis","window","g","toObject","hasOwnProperty","hasOwn","classof","propertyIsEnumerable","store","functionToString","inspectSource","set","NATIVE_WEAK_MAP","objectHas","shared","sharedKey","hiddenKeys","WeakMap","state","wmget","wmhas","wmset","metadata","facade","STATE","enforce","getterFor","TYPE","type","replacement","feature","detection","data","normalize","POLYFILL","NATIVE","string","replace","toLowerCase","USE_SYMBOL_AS_UID","$Symbol","V8_VERSION","getOwnPropertySymbols","symbol","Symbol","IE8_DOM_DEFINE","anObject","toPropertyKey","$defineProperty","Attributes","propertyIsEnumerableModule","$getOwnPropertyDescriptor","internalObjectKeys","concat","getOwnPropertyNames","names","enumBugKeys","$propertyIsEnumerable","NASHORN_BUG","1","input","pref","val","valueOf","getOwnPropertyNamesModule","getOwnPropertySymbolsModule","InternalStateModule","CONFIGURABLE_FUNCTION_NAME","getInternalState","enforceInternalState","TEMPLATE","unsafe","simple","join","undefined","uid","IS_PURE","mode","copyright","toInteger","max","min","integer","IndexedObject","requireObjectCoercible","ceil","isNaN","isSymbol","getMethod","ordinaryToPrimitive","TO_PRIMITIVE","wellKnownSymbol","exoticToPrim","toPrimitive","id","postfix","random","NATIVE_SYMBOL","iterator","WellKnownSymbolsStore","createWellKnownSymbol","withoutSetter","$","internalSort","arrayMethodIsStrict","FF","IE_OR_EDGE","V8","WEBKIT","nativeSort","sort","FAILS_ON_UNDEFINED","FAILS_ON_NULL","STRICT_METHOD","STABLE_SORT","code","chr","fromCharCode","k","v","charAt","proto","this","itemsLength","items","arrayLength","x","y","i2","nativeKeys","___CSS_LOADER_EXPORT___","n3","sources","mappings","sourcesContent","sourceRoot","o","cssWithMappingToString","list","map","item","content","needLayer","modules","media","dedupe","supports","layer","alreadyImportedModules","_i","_i2","cssMapping","btoa","base64","unescape","encodeURIComponent","JSON","stringify","sourceMapping","sourceURLs","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","__webpack_modules__","n","getter","__esModule","default","t1","d","definition","e","obj","prop","r","toStringTag","Experiments","Legacy","LogLevel","Side","polyfill","audioContext","requestAnimationFrame","webkitRequestAnimationFrame","mozRequestAnimationFrame","callback","setInterval","cancelAnimationFrame","webkitCancelAnimationFrame","mozCancelAnimationFrame","AudioContext","webkitAudioContext","replaceMe","decodeAudioData","arrayBuffer","Promise","resolve","reject","mozAudioContext","msAudioContext","oAudioContext","devicePixelRatio","WebGL","t4","Canvas","LegacyDrawing","Flags","_FROZEN","_FLAGS","enable","flagName","Error","createId","p","t10","Debug","Info","Warn","Fatal","Logger","_appenders","defaultLevel","_INSTANCE","addAppender","ConsoleAppender","appender","clearAppenders","_log","level","args","len","log","debug","info","warn","fatal","_","console","consoleArgs","unshift","ScreenAppender","width","height","_messages","_canvas","innerWidth","innerHeight","style","position","_ctx","getContext","body","appendChild","message","clearRect","pos","opacity","fillStyle","toFixed","fillText","Random","seed","_lowerMask","_upperMask","_w","_n","_m","_a","_u","_s","_b","_t","_c","_l","_f","_mt","Array","Date","now","s","_index","_twist","mag01","nextInt","next","floating","bool","likelihood","pickOne","pickSet","numPicks","allowDuplicates","_pickSetWithDuplicates","_pickSetWithoutDuplicates","currentPick","tempArray","splice","shuffle","swap","randomIndex","range","d4","d6","d8","d10","d12","d20","None","t62","Top","Bottom","Left","Right","getOpposite","side","fromDirection","direction","directions","Vector","Up","Down","directionEnum","Number","MAX_VALUE","maxIndex","dot","TwoPI","PI","extend","extended","deep","assignExists","assign","base64Encode","inputStr","b64","outputStr","byte1","charCodeAt","byte2","byte3","enc1","enc2","enc3","enc4","nullish","nullishVal","defaultVal","clamp","randomInRange","randomIntInRange","round","canonicalizeAngle","angle","tmpAngle","toDegrees","radians","toRadians","degrees","getPosition","oLeft","oTop","calcOffsetLeft","parent","offsetLeft","offsetParent","calcOffsetTop","offsetTop","addItemToArray","removeItemFromArray","contains","getOppositeSide","getSideFromDirection","Collection","initialSize","DefaultSize","_internalArray","_endPointer","_resize","newSize","newArray","count","pop","clear","internalSize","elementAt","insert","remove","removed","removeElement","toArray","forEach","fail","I","from","to","_x","delay","milliseconds","setTimeout","maxMessages","obsoleteMessage","resetObsoleteCounter","logMessage","suppressObsoleteMessages","isEnabled","getInstance","trace","showStackTrace","obsolete","alternateMethod","showStackTrack","property","SyntaxError","DecoratedClass","super","_y","Zero","One","Half","cos","sin","vec","Infinity","vec1","vec2","sqrt","pow","setTo","equals","vector","tolerance","abs","distance","squareDistance","magnitude","size","newLength","scale","average","add","sizeOrScale","sub","addEqual","subEqual","scaleEqual","cross","num","perpendicular","normal","negate","toAngle","atan2","rotate","anchor","sinAngle","cosAngle","clone","fixed","DisplayMode","EventTypes","Color","parseInt","parseFloat","hex","h","l","HSLColor","toRGBA","lighten","factor","temp","fromRGBA","darken","saturate","desaturate","multiply","color","newR","newG","newB","newA","mulitiply","screen","color1","invert","color2","equal","format","toHSLA","toHex","_componentToHex","Black","fromHex","White","Gray","LightGray","DarkGray","Yellow","Orange","Red","Vermilion","Vermillion","Rose","Magenta","Violet","Blue","Azure","Cyan","Viridian","Green","Chartreuse","Transparent","ExcaliburBlue","Y","q","t","hue2rgb","BoundingBox","leftOrOptions","top","bottom","intersection","points","minX","minY","maxX","maxY","hasZeroDimensions","center","translate","point","getPoints","fromPoints","shifted","transform","matrix","multv","getPerimeter","results","rayCast","ray","farClipDistance","tmin","tmax","xinv","dir","yinv","tx1","tx2","ty1","ty2","rayCastTime","combine","other","dimensions","intersect","totalBoundingBox","overlapX","overlapY","intersectWithSide","bb","getSideFromIntersection","debugDraw","ctx","strokeStyle","strokeRect","draw","ex","drawRect","Fixed","t324","FitScreen","FillScreen","FitContainer","FillContainer","Position","Resolution","SVGA","Standard","Atari2600","GameBoy","GameBoyAdvance","NintendoDS","NES","SNES","Screen","_antialiasing","_resolutionStack","_viewportStack","_pixelRatioOverride","_isFullScreen","_isDisposed","_logger","_fullscreenChangeHandler","_pixelRatioChangeHandler","_devicePixelRatio","_calculateDevicePixelRatio","applyResolutionAndViewport","_resizeHandler","_setResolutionAndViewportByDisplayMode","viewport","resolution","e168","_displayMode","i6","displayMode","canvas","context","s21","antialiasing","_browser","browser","_position","pixelRatio","_applyDisplayMode","_mediaQueryList","nativeComponent","matchMedia","addEventListener","dispose","off","_resizeObserver","disconnect","removeEventListener","isHiDpi","parentElement","_resolution","_viewport","aspectRatio","scaledWidth","scaledHeight","setCurrentCamera","camera","_camera","pushResolutionAndViewport","popResolutionAndViewport","imageRendering","updateViewport","resetTransform","smoothing","isSmooth","isFullScreen","goFullScreen","requestFullscreen","exitFullScreen","exitFullscreen","pageToScreenCoordinates","newX","newY","screenHeight","screenWidth","screenToPageCoordinates","screenMarginY","screenMarginX","screenToWorldCoordinates","drawWidth","drawHeight","halfDrawWidth","halfDrawHeight","i7","e169","n6","s22","worldToScreenCoordinates","screenX","screenY","i8","e170","n7","s23","pageToWorldCoordinates","worldToPageCoordinates","getWorldBounds","canvasWidth","halfCanvasWidth","canvasHeight","halfCanvasHeight","zoom","_computeFit","margin","overflow","aspect","adjustedWidth","adjustedHeight","_computeFitContainer","clientWidth","clientHeight","_initializeDisplayModePosition","Window","on","ResizeObserver","observe","display","specifiedPosition","offsetY","marginTop","offsetX","marginLeft","AudioContextFactory","WebAudio","_UNLOCKED","create","unlockTimeoutTimer","resume","then","buffer","createBuffer","createBufferSource","ended","connect","destination","onended","start","playbackState","PLAYING_STATE","FINISHED_STATE","currentTime","clearTimeout","st","Kill","t374","PreKill","PostKill","PreDraw","PostDraw","PreDebugDraw","PostDebugDraw","PreUpdate","PostUpdate","PreFrame","PostFrame","PreCollision","CollisionStart","CollisionEnd","PostCollision","Initialize","Activate","Deactivate","ExitViewport","EnterViewport","ExitTrigger","EnterTrigger","Connect","Disconnect","Button","Axis","Subscribe","Unsubscribe","Visible","Hidden","Start","Stop","PointerUp","PointerDown","PointerMove","PointerEnter","PointerLeave","PointerCancel","PointerWheel","Move","Enter","Leave","Cancel","Wheel","Press","Release","Hold","PointerDragStart","PointerDragEnd","PointerDragEnter","PointerDragLeave","PointerDragMove","GameEvent","_bubbles","bubbles","stopPropagation","KillEvent","PreKillEvent","PostKillEvent","GameStartEvent","GameStopEvent","PreDrawEvent","delta","PostDrawEvent","PreDebugDrawEvent","PostDebugDrawEvent","PreUpdateEvent","engine","PostUpdateEvent","PreFrameEvent","prevStats","PostFrameEvent","stats","GamepadConnectEvent","gamepad","GamepadDisconnectEvent","GamepadButtonEvent","button","GamepadAxisEvent","axis","SubscribeEvent","topic","handler","UnsubscribeEvent","VisibleEvent","HiddenEvent","PreCollisionEvent","actor","PostCollisionEvent","ContactStartEvent","contact","ContactEndEvent","CollisionPreSolveEvent","CollisionPostSolveEvent","CollisionStartEvent","CollisionEndEvent","InitializeEvent","ActivateEvent","oldScene","DeactivateEvent","newScene","ExitViewPortEvent","EnterViewPortEvent","EnterTriggerEvent","ExitTriggerEvent","EventDispatcher","_handlers","_wiredEventDispatchers","_target","emit","eventName","event","t423","eventHandlers","once","ev","t447","wire","eventDispatcher","unwire","Class","eventObject","line","x1","y1","x2","y2","thickness","cap","beginPath","lineWidth","lineCap","moveTo","lineTo","closePath","stroke","arc","origin","roundRect","radius","fill","br","tl","tr","bl","defaultRadius","quadraticCurveTo","circle","Graphic","_ID","showDebug","flipHorizontal","flipVertical","rotation","_width","_height","e273","i21","s28","n10","r1","o1","cloneGraphicOptions","localBounds","fromDimension","_preDraw","_drawImage","_postDraw","save","_rotate","_flip","scaleDirX","scaleDirY","e290","restore","isPowerOfTwo","ensurePowerOfTwo","watch","change","__isProxy","Proxy","watchAny","Zt","TextureLoader","_GL","image","_TEXTURE_MAP","forceUpdate","gl","tex","bindTexture","TEXTURE_2D","toPowerOfTwoImage","texImage2D","RGBA","UNSIGNED_BYTE","createTexture","texParameteri","TEXTURE_WRAP_S","CLAMP_TO_EDGE","TEXTURE_WRAP_T","TEXTURE_MIN_FILTER","NEAREST","TEXTURE_MAG_FILTER","potCanvas","_POT_CANVAS","potCtx","_POT_CTX","imageSmoothingEnabled","drawImage","te","Map","Raster","_dirty","_smoothing","_color","flagDirty","_lineWidth","_lineDash","_padding","e299","strokeColor","i30","s29","lineDash","n11","padding","r2","_bitmap","bitmapWidth","o2","bitmapHeight","a1","maybeCtx","cloneRasterOptions","dirty","_getTotalWidth","_originalWidth","_getTotalHeight","_originalHeight","t520","t521","e300","_strokeColor","e301","rasterize","_applyRasterProperites","execute","load","setLineDash","e302","getLineDash","i31","s30","_options","e313","i38","cache","Loader","loadables","_resourceList","_playButtonShown","_resourceCount","_numLoaded","_progressCounts","_totalCounts","logo","logoWidth","logoHeight","loadingBarColor","backgroundColor","suppressPlayButton","_playButtonStyles","Kt","Z","playButtonText","startButtonFactory","buttonElement","getElementById","textContent","addResources","_image","_imageElement","Image","src","playButtonRootElement","_playButtonRootElement","playButtonElement","_playButtonElement","_playButton","existingRoot","_styleBlock","head","wireEngine","_engine","addResource","loadable","isLoaded","showPlayButton","evt","click","startButtonHandler","hidePlayButton","removeChild","update","_delta","all","finally","unlock","markResourceComplete","progress","buttonWidth","buttonHeight","playButtonPosition","fillRect","logoY","logoX","logoPosition","imageHeight","oldAntialias","getAntialiasing","setAntialiasing","loadingX","loadingY","loadingBarPosition","Xt","progressWidth","REPORTED_FEATURES","webgl","webaudio","gamepadapi","Detector","_features","failedTests","_criticalTests","canvasSupport","elem","arrayBufferSupport","xhr","XMLHttpRequest","open","responseType","dataUrlSupport","toDataURL","objectUrlSupport","URL","rgbaSupport","cssText","_warningTest","webAudioSupport","webglSupport","_loadBrowserFeatures","getBrowserFeatures","logBrowserFeatures","msg","supported","t566","e319","arraybuffer","dataurl","objecturl","rgba","navigator","getGamepads","failedCritical","warning","t567","ae","bustCache","i39","logger","events","_cacheBust","uri","i40","status","response","request","send","o3","le","updatePixel","imageData","s31","pixel","firstPixel","avg","he","Grayscale","ce","Invert","de","t576","Opacity","ue","t579","Colorize","pe","t582","fromRGB","Lighten","ge","t585","Darken","_e","t588","Saturate","fe","t591","Desaturate","me","t594","base","t597","props","t601","filter","t602","Fill","xe","n12","offset","drawAroundAnchor","effects","_spriteCanvas","_spriteCtx","_pixelData","_pixelsLoaded","_dirtyEffect","_opacity","imageOrConfig","Texture","e410","i121","r3","texture","_initPixelsFromTexture","loaded","naturalWidth","naturalHeight","_loadPixels","e411","_flushTexture","grayscale","addEffect","colorize","_applyEffects","removeEffect","indexToRemove","param","getImageData","t622","i122","putImageData","clearEffects","reset","ypoint","ctxOrOptions","CanvasRenderingContext2D","_drawWithOptions","l2","c2","d1","u1","p1","g1","_1","f1","m1","w1","v1","e431","i134","s32","n13","r4","a2","h3","anchorY","globalAlpha","t642","i135","be","SpriteImpl","ye","Ae","e433","t643","_sprite","_loadedResolve","_resource","t644","blob","createObjectURL","e434","url","decode","t645","asSprite","Pe","sprites","speed","loop","s34","currentFrame","_timeLeftInFrame","_idempotencyToken","freezeFrame","engineOrConfig","Engine","config","_setAnchor","_setRotation","_setScale","isDone","tick","idempotencyToken","_updateValues","current","skip","h4","l3","e460","i143","s35","n16","r5","o4","a3","animOptions","currSprite","play","playAnimation","Ee","AnimationImpl","images","MatrixLocations","t720","t727","Se","Me","end","duration","easing","time","n17","CreateReversibleEasingFunction","Linear","startValue","endValue","e472","EaseInQuad","EaseOutQuad","t698","EaseInOutQuad","s37","i145","EaseInCubic","EaseOutCubic","EaseInOutCubic","De","Be","_actions","_completedActions","_actor","clearActions","_currentAction","stop","getActions","hasNext","isComplete","shift","ke","repeatBuilder","repeat","_stopped","_repeatBuilder","_repeatContext","_actionQueue","getQueue","_repeat","_originalRepeat","Fe","e473","Le","_started","_speed","_offset","_start","_end","_distance","_dir","vel","Ie","destx","desty","s38","m","RotationType","Te","ShortestPath","LongestPath","Clockwise","CounterClockwise","Oe","angleRadians","rotationType","s39","_rotationType","_currentNonCannonAngle","e477","distance1","t722","distance2","_shortDistance","_longDistance","_shortestPathIsPositive","_direction","angularVelocity","ze","angleRadiansOffset","s40","e478","t725","Ue","owner","t726","constructor","i150","newComponent","s41","e488","TagComponent","e489","MotionComponent","acc","scaleFactor","torque","inertia","Re","X","Ve","Float32Array","_scaleSignX","_scaleSignY","near","far","o5","mat","t731","Matrix","identity","i162","sy","sx","e530","multm","a11","a21","a31","a41","a12","a22","a32","a42","a13","a23","a33","b21","b31","b41","b12","b22","b32","b42","b13","b23","b33","b11","a14","dest","a24","a34","a43","a44","b43","b14","b24","b34","b44","k1","getScale","sign","setPosition","sine","cosine","setRotation","currentScale","getRotation","getScaleY","getScaleX","t785","setScaleX","xscale","setScaleY","yscale","setScale","getBasisDeterminant","getAffineInverse","t796","inverseDet","ty","r15","isIdentity","VectorView","_getX","getX","_getY","getY","_setX","setX","_setY","setY","CollisionType","t803","t915","BroadphaseStrategy","Integrator","CoordPlane","je","World","TransformComponent","Ge","_rotation","_scale","coordPlane","z","_recalculate","getGlobalMatrix","getGlobalTransform","globalPos","globalScale","globalRotation","e590","t807","s57","i163","parentTransform","globalScaleX","globalScaleY","applyInverse","Ke","scaleX","scaleY","speedX","speedY","n29","_endX","_endY","_speedX","_speedY","_startX","_startY","_distanceX","_distanceY","motion","t828","Ze","scaleOffsetX","scaleOffsetY","s58","_startScale","_endScale","_directionX","_directionY","Ye","t830","_method","_hasBeenCalled","Qe","easingFcn","n30","t832","_currentLerpTime","_lerpDuration","_lerpStart","_lerpEnd","_initialized","i166","_initialize","$e","timeVisible","timeNotVisible","numBlinks","s60","_timeVisible","_timeNotVisible","_elapsedTime","_totalTime","_duration","visible","Je","endOpacity","i168","_multiplier","_endOpacity","ti","e596","_delay","ei","t851","actions","kill","ii","actorToFollow","followDistance","i169","_actorToFollow","_current","_maximumDistance","_distanceBetween","actorToFollowSpeed","si","actorToMeet","i170","_speedWasSpecified","_actorToMeet","ni","_queue","t857","easeTo","i171","s61","n31","EasingFunctions","e599","yOrSpeed","speedOrUndefined","xOrPos","moveBy","yOffsetOrSpeed","yOffset","xOffsetOrVector","xOffset","rotateTo","rotateBy","scaleTo","sizeYOrSpeed","speedXOrUndefined","speedYOrUndefined","sizeY","a4","sizeXOrVector","scaleBy","sizeOffsetYOrSpeed","s69","sizeOffsetY","sizeOffsetXOrVector","blink","fade","die","callMethod","times","repeatForever","follow","meet","asPromise","Xe","PreventCollision","Passive","Active","Arcade","Realistic","CollisionResolutionStrategy","ri","DynamicAABBTree","oi","Euler","ai","li","gravity","Physics","collisionResolutionStrategy","dynamicTreeVelocityMultiplyer","dynamicTreeVelocityMultiplier","enabled","broadphaseStrategy","defaultMass","integrator","boundsPadding","positionIterations","velocityIterations","slop","steeringFactor","warmStart","bodiesCanSleepByDefault","surfaceEpsilon","sleepEpsilon","wakeThreshold","sleepBias","checkForFastBodies","disableMinimumSpeedForFastBody","hi","ci","category","mask","_name","_category","_mask","i217","canCollide","collisionGroups","reduce","t926","combinedName","combinedCategory","i218","All","di","observers","subscriptions","register","subscribe","unregister","observer","e766","unsubscribe","notifyAll","notify","cb","ui","colliderB","colliderA","t939","Pair","calculatePairHash","BodyComponent","bodyA","bodyB","group","collisionType","active","e782","collide","hasCollider","collider","idB","pi","e802","t950","overlaps","getOverlap","gi","t959","bounds","isLeaf","t960","worldBounds","nodes","_insert","leaf","currentRoot","combinedArea","inheritanceCost","area","h5","leafAABB","oldArea","leftCombined","newArea","rightCombined","cost","leftCost","rightCost","s70","oldParent","newParent","currentNode","_balance","_remove","sibling","grandParent","i219","trackCollider","e803","node","updateCollider","untrackCollider","i220","t984","e804","multdy","balance","getHeight","query","rayCastQuery","getNodes","fi","begin","getSlope","i225","numerator","getLength","u","intersectPoint","e825","getPoint","mi","_dynamicCollisionTree","_collisions","Set","_collisionPairCache","_colliders","getColliders","track","yi","untrack","e826","_shouldGenerateCollisionPair","hash","broadphase","targets","i228","s71","e875","t1041","potentialColliders","t1042","e877","physics","pairs","seconds","minDimension","r16","fastBodies","oldPos","getFurthestPoint","furthestPoint","updateDistance","n32","e878","hitPoint","t1043","minCollider","isValid","s72","pair","centerPoint","fastBodyCollisions","narrowphase","i247","contacts","newContacts","t1044","collisions","e901","updated","wi","touching","CompositeCollider","_collisionProcessor","_dynamicAABBTree","addCollider","clearColliders","removeCollider","worldPos","e902","_transform","t1062","e903","t1063","e904","colliders","t1064","e905","t1065","J","axes","e906","furthestPoints","maxDistance","i248","getInertia","totalInertia","potentialCollider","getClosestLineBetween","maybeLine","lines","e907","minLength","minLine","minDistance","minPoint","e916","project","proj","projs","e917","t1087","newProjection","vi","e946","t1096","slope","intercept","e947","i253","getEdge","t1097","midpoint","flip","below","clip","sideVector","clipTime","distanceToPoint","signed","y0","x0","findVectorToPoint","findPoint","hasPoint","threshold","e992","currPoint","t1111","dyc","dx1","dy1","dxc","p0","q0","denom","tDenom","tClosestParallel","tClosest","sClosest","sDenom","bi","PolygonPolygonClosestLine","polygonB","otherWorldPos","otherDirection","polygonA","rayTowardsThis","thisDirection","thisPoint","getClosestFace","otherFace","thisFace","face","PolygonEdgeClosestLine","edge","polygon","asLine","edgeLine","PolygonCircleClosestLine","circley","circlex","CircleCircleClosestLine","circleB","circleA","otherPoint","CircleEdgeClosestLine","circleWorlPos","EdgeEdgeClosestLine","edgeB","edgeA","edgeLineA","edgeLineB","CircleCollider","e1107","t1141","Ci","e1108","t1142","e1109","discriminant","toi","toi2","positiveToi","o6","shape","Ti","Ei","CollideCircleCircle","CollideCirclePolygon","CollideCircleEdge","getFurthestLocalPoint","t1170","i254","tx","bodyPos","e1125","scalars","newPos","drawCircle","Ai","mtv","tangent","localPoints","_canceled","matchAwake","sleeping","sleepMotion","setSleeping","isCanceled","cancel","Si","polyB","bestOtherPoint","polyA","getSides","getLocalSides","t1200","sides","bestSeparation","vertSeparation","bestSide","bestAxis","bestSideIndex","vertB","separation","i261","localSide","sideId","localPoint","a5","proj1","overlap","minOverlap","minAxis","minIndex","Pi","circleAPos","combinedRadius","circleBPos","local","mvt","SeparatingAxis","findCirclePolygonSeparation","samedir","findSide","findLocalSide","edgeWorld","cc","asLocalLine","dda","da","n33","ddb","db","pointOnEdge","den","dd","CollideEdgeEdge","CollidePolygonEdge","i262","CollidePolygonPolygon","linePoly","findPolygonPolygonSeparation","separationA","separationB","incident","reference","clipRight","refDir","clipLeft","a6","d2","t1247","i263","xf","e1376","FindContactSeparation","r17","s73","i264","shapeB","qe","shapeA","PolygonCollider","worldPoint","s74","i265","txA","txB","EdgeCollider","n34","dist","e1416","t1268","_getBodyPos","t1269","_getTransformedBegin","_getTransformedEnd","e1417","e1429","transformedBegin","transformedEnd","_boundsFromBeginEnd","e1459","drawLine","i289","_transformedPoints","_axes","_sides","_localSides","e1507","winding","clockwiseWinding","reverse","_calculateTransformation","t1325","e1508","getTransformedPoints","t1324","mostDirection","currentSide","i290","accum","t1332","pts","POSITIVE_INFINITY","r18","faceIndex","t1354","e1509","denominator","i291","t1356","crossTerm","iplusone","s75","contactTime","minContactTime","contactIndex","scalar","i292","firstPoint","effectiveOffset","i297","i298","Ri","ColliderComponent","$colliderAdded","$colliderRemoved","t1392","_collider","e1649","t1400","e1650","t1401","t1402","e1651","s82","i318","flipped","onAdd","entity","precollision","postcollision","onRemove","useBoxCollider","Shape","Box","usePolygonCollider","Polygon","i324","useCircleCollider","Circle","useEdgeCollider","Edge","useCompositeCollider","DegreeOfFreedom","t1421","Mi","Rotation","dependencies","mass","canSleep","_sleeping","bounciness","friction","useGravity","limitDegreeOfFreedom","oldVel","oldAcc","oldRotation","oldScale","e1707","s90","inverseMass","updateMotion","bias","currentMotion","inverseInertia","t1425","t1426","t1427","xFactor","yFactor","rx","applyImpulse","impulse","finalImpulse","applyLinearImpulse","e1732","applyAngularImpulse","captureOldTransform","ki","_topLeft","_topRight","_bottomLeft","_bottomRight","isSpriteOffScreen","currentDrawing","getGlobalPos","drawingWidth","i325","drawingHeight","s91","_xCoords","_yCoords","topRightScreen","bottomLeftScreen","bottomRightScreen","_xMin","_yMin","_xMax","_yMax","_xMinWorld","_yMinWorld","_xMaxWorld","_yMaxWorld","boundingPoints","t1461","rect","Fi","cullingBox","currentScene","isOffScreen","removeComponent","addComponent","He","Li","enableCapturePointer","isKilled","pointers","checkAndUpdateActorUnderPointer","Ii","t1501","t1502","zi","t1503","Entity","Wt","e1924","_componentsToRemove","_componentTypeToInstance","_componentStringToInstance","_tagsMemo","_typesMemo","componentAdded$","componentRemoved$","_parent","childrenAdded$","childrenRemoved$","_children","_isInitialized","_setName","components","component","e1925","tags","hasTag","addTag","removeTag","force","types","_rebuildMemos","values","getComponents","_notifyAddComponent","e1942","_notifyRemoveComponent","children","unparent","addChild","getAncestors","removeAllChildren","getDescendants","queue","t1528","Hi","child","addTemplate","ctor","_removeComponentByType","componentOrType","Component","delete","processComponentRemoval","e1990","isInitialized","onInitialize","_preupdate","onPreUpdate","_postupdate","onPostUpdate","CanvasDrawComponent","t1579","e2086","graphic","t1580","Vi","_graphics","e2087","graphics","hide","nameOrGraphic","e2088","getGraphic","gfx","show","copyGraphics","getNames","use","order","t1596","Gi","t1599","_component","_layers","_layerMap","_maybeAddLayer","e2160","_getLayer","GraphicsComponent","_bounds","t1616","onPreDraw","onPostDraw","layers","i326","s92","graphicToSet","t1631","Rectangle","ee","Xi","t1637","_radius","e2233","qi","TextAlign","BaseAlign","FontStyle","Direction","t1800","o7","Actor","_anchor","_handleAnchorChange","scene","frames","_draggable","_dragging","_pointerDragStartHandler","_pointerDragEndHandler","_pointerDragMoveHandler","pointer","lastWorldPos","_pointerDragLeaveHandler","traits","capturePointer","captureMoveEvents","captureDragEvents","_capturePointerEvents","_captureMoveEvents","_captureDragEvents","e2234","n35","r19","h6","l4","collisionGroup","b1","defaults","Ni","thePos","theVel","theAcc","draggable","isDraggable","_checkForPointerOptIn","normalized","_prekill","onPreKill","_scene","_postkill","onPostKill","unkill","setDrawing","addDrawing","getZIndex","newZ","setZIndex","newIndex","getGlobalScale","getGlobalRotation","recurse","s93","containment","some","r20","within","drawing","currFrame","trait","_predraw","_postdraw","Ki","Yi","Zi","useWorld","coords","$i","interval","repeats","numberOfRepeats","_totalTimeAlive","_running","_numberOfTicks","maxNumberOfRepeats","_complete","t1761","fcn","i343","Timer","_MAX_ID","_callbacks","complete","e2636","newNumberOfRepeats","newInterval","timesRepeated","getTimeRunning","timeToNextAction","timeElapsedTowardNextAction","isRunning","pause","unpause","cancelTimer","Qi","rs","e2656","t1773","endsWith","ready","t1774","e2657","t1775","toSprite","unload","Sprite","s94","sourceView","n36","destSize","i344","_updateSpriteDimensions","os","t1783","e2658","i345","s95","n37","sprite","ImageSource","fromLegacyTexture","e2703","i366","FontUnit","Ji","Em","Rem","Px","Pt","Percent","Center","End","ts","Hanging","Middle","Alphabetic","Ideographic","es","Normal","Italic","Oblique","is","LeftToRight","RightToLeft","ss","hs","columns","rows","spWidth","spHeight","spacing","r21","_sprites","_columns","_rows","_spWidth","_spHeight","_spacing","o8","imageOrConfigOrSprites","t1801","e2704","isWidthError","RangeError","isHeightError","loadFromImage","getSpacingDimensions","row","i367","col","getAnimationByIndices","indices","t1803","getAnimationBetween","beginIndex","endIndex","t1805","getAnimationForAll","t1807","getSprite","getAnimationByCoords","spriteCoordinates","s107","maxHeight","n39","r22","t1814","coord","i393","o9","anim","ls","alphabet","caseInsensitive","a7","_currentColor","_currentOpacity","_spriteRecord","_textShadowOn","_textShadowDirty","_textShadowColor","_textShadowSprites","_shadowOffsetX","_shadowOffsetY","getTextSprites","t1816","e2816","char","setTextShadow","shadowColor","character","useTextShadow","text","_parseOptions","characterShadow","fontSize","letterSpacing","textAlign","h7","baseAlign","a8","i434","currX","charSprite","currY","maxWidth","as","SpriteFont","cs","t1834","e2893","i435","legacySpriteSheet","fromLegacySprite","oldSprite","spriteSheet","toLegacySprite","e2971","grid","r23","spriteWidth","o10","spriteHeight","originOffset","offsetDefaults","marginDefaults","l5","t1850","cols","e2972","t1926","TileMapImpl","cellWidth","cellHeight","_token","_onScreenXStart","_onScreenXEnd","_onScreenYStart","_onScreenYEnd","_spriteSheets","_legacySpriteMap","_cols","isOffscreen","xOrConfig","Bi","ji","_motion","_composite","n110","cd","currentCol","t1851","e2973","e2974","t1854","e2975","t1857","e2976","e2977","t1860","e2978","e2979","t1863","e2980","registerSpriteSheet","fromLegacySpriteSheet","_updateColliders","t1876","e3047","i436","s135","solid","prev","getCellByIndex","getCell","getCellByPoint","cell","getRows","getColumns","graphicsIndex","graphicsLen","xEnd","yEnd","a9","s136","us","TileMap","CellImpl","r25","o11","_solid","t1903","e3280","pushSprite","addGraphic","removeGraphic","clearGraphics","Cell","ms","t1915","lockToActor","addStrategy","lockToActorAxis","elasticToActor","cameraElasticity","cameraFriction","radiusAroundActor","limitCameraBounds","box","ds","ws","action","_cam","_eng","ys","e3348","t1927","cam","getFocus","currentFocus","vs","i449","t1928","e3349","cameraVel","focus","xs","e3350","t1929","bs","t1930","boundSizeChecked","focusY","focusX","Camera","_cameraStrategies","strategy","_z","dz","az","_posChanged","_pos","_cameraMoving","_isShaking","_shakeMagnitudeX","_shakeMagnitudeY","_shakeDuration","_elapsedShakeTime","_xShake","_yShake","_isZooming","_zoomStart","_zoomEnd","_currentZoomTime","_zoomDuration","_zoomEasing","_easing","_halfWidth","_halfHeight","_follow","dx","dy","ax","ay","move","easingFn","_lerpPromise","_lerpResolve","shake","magnitudeY","zoomOverTime","_zoomPromise","_zoomResolve","removeStrategy","cameraStrategy","clearAllStrategies","newZoom","zoomEasing","CreateVectorEasingFunction","_isDoneShaking","e3714","i485","newCanvasHeight","newCanvasWidth","o13","t1999","Ss","Ps","opts","_dispatchAction","SystemType","t2014","Es","Update","Draw","Ts","priority","_entityAddedOrRemoved","Rs","t2015","t2016","Ms","t2017","ks","_world","entities","_entityIndex","_entitiesToRemove","updateEntities","elapsed","removeEntity","isAddedComponent","queryManager","addEntity","t2039","deferred","s138","idOrEntity","actors","killed","processEntityRemovals","t2043","processComponentRemovals","getById","getByName","t2047","localeCompare","Query","_entities","T","_key","getEntities","matches","t2059","e3769","typesOrEntity","i486","contain","Is","t2065","_queries","_addQuery","entityManager","maybeRemoveQuery","queryType","createQuery","getQuery","maybeExistingQuery","e3791","buildTypeKey","Os","t2085","systems","initialized","find","addSystem","initialize","removeSystem","system","updateSystems","systemType","preupdate","un","postupdate","zs","t2102","systemManager","entityOrSystem","System","clearEntities","clearSystems","Us","totalAcc","elapsedMs","MotionSystem","s148","optionalBody","integrate","Ns","solve","preSolve","solveVelocity","solvePosition","postSolve","ArcadeSolver","i521","r27","e4022","i522","e4023","i523","e4024","e4026","opposite","velAdj","Vs","i524","t2139","e4025","normalImpulse","tangentImpulse","normalMass","tangentMass","aToContact","bToContact","i525","t2140","bToContactNormal","aToContactNormal","bToContactTangent","aToContactTangent","getRelativeVelocity","e4027","t2141","t2142","RealisticSolver","lastFrameContacts","idToContactConstraint","getContactConstraints","e4028","finishedContactIds","t2147","e4029","contactPoints","pointIndex","i526","e4031","s149","t2154","e4030","s150","n113","t2156","i527","e4032","CollisionJumpTable","steeringForce","s151","t2158","i528","maxFriction","impulseDelta","newImpulse","restitution","s152","o14","CollisionSystem","_realisticSolver","Gs","_arcadeSolver","Ws","_processor","_lastFrameContacts","_currentFrameContacts","_trackCollider","_untrackCollider","isAddedSystemEntity","colliderComponent","i529","colliderComp","getSolver","runContactStartEnd","t2168","t2169","Xs","DrawCallCount","GraphicsDiagnostics","DrawnImagesCount","EmitterType","Ks","t2237","AnimationStrategy","qs","Loop","PingPong","Freeze","Animation","frameDuration","timeScale","_firstTick","_currentFrame","_done","_playing","e4044","i530","goToFrame","Zs","frameIndices","durationPerFrameMs","invalidIndices","t2171","_LOGGER","animation","isPlaying","canFinish","done","maybeFrame","e4152","i543","_nextFrame","t2176","e4153","_updateDimensions","t2178","e4189","GraphicsGroup","t2181","members","Ys","t2182","e4214","_isAnimationOrGroup","member","maybeAnimation","GraphicsSystem","_graphicsContext","graphicsContext","i580","_clearScreen","_isOffscreen","entityOffscreen","_pushCameraTransform","_applyTransform","_drawGraphicsComponent","_popCameraTransform","flush","drawnImages","drawCalls","i581","graphicsComponent","e4382","isDebug","showBounds","boundsColor","ancestor","e4383","CanvasDrawingSystem","canvasdraw","e4431","ParticleImpl","life","beginColor","endColor","velocity","acceleration","startSize","endSize","particleRotationalVelocity","currentRotation","focusAccel","fadeFlag","_rRate","_gRate","_bRate","_aRate","emitter","particleSize","particleSprite","sizeRate","elapsedMultiplier","emitterOrConfig","ParticleEmitter","drawPoint","removeParticle","accel","Particle","e4565","i584","_particlesToEmit","numParticles","isEmitting","particles","deadParticles","minVel","maxVel","minAngle","maxAngle","emitRate","particleLife","minSize","maxSize","_og","emitterType","randomRotation","s164","n115","r29","o15","h9","l7","c3","u2","g2","f2","m2","v2","b2","C1","A1","S1","P1","E1","T1","R1","D1","w","t2250","emitParticles","e4566","i585","particleCount","_createParticle","world","clearParticles","t2261","ranY","e4567","s165","S","s166","ranX","t2263","DebugSystem","_collisionSystem","o16","h10","c4","u3","_2","m3","tn","filterSettings","useFilter","ids","nameQuery","showAll","showPosition","positionColor","drawText","cursor","lineHeight","showId","i586","showName","showRotation","fromAngle","rotationColor","showScale","scaleColor","showCollisionGroup","showCollisionType","showMass","showMotion","showSleeping","showVelocity","velocityColor","showAcceleration","accelerationColor","showGeometry","geometryColor","e4620","showOwner","showBroadphaseSpacePartitionDebug","showCollisionContacts","showCollisionNormals","physicsSettings","collisionContactColor","t2281","collisionNormalColor","cameraSettings","showFocus","focusColor","showZoom","e4619","Keys","PointerType","PointerScope","NativePointerButton","PointerButton","WheelDeltaMode","t2373","t2443","t2459","t2499","Axes","t2649","DrawCommandType","t2823","Scene","Cs","_timers","_cancelQueue","triggers","tileMaps","screenElements","onActivate","_newScene","onDeactivate","_initializeChildren","_activate","_deactivate","i587","removeTimer","timer","_collectActorStats","dispatchPointerEvents","addTimer","addScreenElement","removeScreenElement","addTileMap","removeTileMap","e5113","isTimerActive","isCurrentScene","_ui","alive","dn","ColorBlindness","nn","Protanope","Deuteranope","Tritanope","pn","simulate","colorMode","i588","_vertexShader","_fragmentShader","_internalCanvas","_gl","preserveDrawingBuffer","_program","createProgram","_getShader","_getFragmentShaderByMode","attachShader","linkProgram","getProgramParameter","LINK_STATUS","useProgram","e5114","_setRectangle","bufferData","ARRAY_BUFFER","STATIC_DRAW","program","i603","shader","createShader","FRAGMENT_SHADER","VERTEX_SHADER","shaderSource","compileShader","getShaderParameter","COMPILE_STATUS","getShaderInfoLog","out","getAttribLocation","bindBuffer","enableVertexAttribArray","vertexAttribPointer","s177","FLOAT","pixelStorei","UNPACK_FLIP_Y_WEBGL","getUniformLocation","uniform2f","drawArrays","TRIANGLES","Uint8Array","readPixels","gn","t2395","correct","postProcessors","colorBlindness","t2400","prevFrame","FrameStats","colorBlindMode","_id","_fps","_actorStats","remaining","total","_durationStats","_physicsStats","mn","_graphicsStats","otherStats","fps","t2414","_pairs","_contacts","_fastBodies","_fastBodyCollisions","_broadphase","_narrowphase","t2429","rn","Num0","Num1","Num2","Num3","Num4","Num5","Num6","Num7","Num8","Num9","NumAdd","NumSubtract","NumMultiply","NumDivide","NumDecimal","Numpad0","Numpad1","Numpad2","Numpad3","Numpad4","Numpad5","Numpad6","Numpad7","Numpad8","Numpad9","NumpadAdd","NumpadSubtract","NumpadMultiply","NumpadDivide","NumpadDecimal","NumLock","ShiftLeft","ShiftRight","AltLeft","AltRight","Key0","Key1","Key2","Key3","Key4","Key5","Key6","Key7","Key8","Key9","Digit0","Digit1","Digit2","Digit3","Digit4","Digit5","Digit6","Digit7","Digit8","Digit9","A","B","C","D","E","F","G","H","K","L","M","N","Q","R","U","W","KeyA","KeyB","KeyC","KeyD","KeyE","KeyF","KeyG","KeyH","KeyI","KeyJ","KeyK","KeyL","KeyM","KeyN","KeyO","KeyP","KeyQ","KeyR","KeyS","KeyT","KeyU","KeyV","KeyW","KeyX","KeyY","KeyZ","Semicolon","Quote","Comma","Minus","Period","Slash","Equal","BracketLeft","Backslash","BracketRight","Backquote","ArrowUp","ArrowDown","ArrowLeft","ArrowRight","Space","Esc","Escape","KeyEvent","nt","originalEvent","e5205","Keyboard","_keys","_keysUp","_keysDown","init","e5232","i604","e5233","keyEvent","t2453","getKeys","wasPressed","isHeld","wasReleased","Touch","Mouse","Pen","Unknown","Document","an","Pointer","_isDown","_wasDown","_actorsUnderPointer","_actors","_actorsLastFrame","_actorsNoLongerUnderPointer","_actorSortingFcn","lastPagePos","lastScreenPos","dragTarget","_onPointerMove","_onPointerDown","_onPointerUp","isDragging","isDragStart","isDragEnd","hasActorsUnderPointer","addActorUnderPointer","isActorAliveUnderPointer","removeActorUnderPointer","getActorsUnderPointer","getActorsUnderPointerLastFrame","getActorsForEvents","checkActorUnderPointer","wasActorUnderPointer","pagePos","screenPos","hn","NoButton","ln","Pixel","Line","Page","cn","PointerEvent","pointerType","coordinates","e5310","n117","r30","propagate","doAction","_onActionStart","_onActionEnd","bn","t2511","_pointerEventType","PointerDragEvent","PointerUpEvent","xn","PointerDownEvent","PointerMoveEvent","PointerEnterEvent","PointerLeaveEvent","PointerCancelEvent","WheelEvent","pageX","pageY","deltaX","deltaY","deltaZ","deltaMode","t2539","e5337","i619","s188","n124","r35","l8","d3","_isCanceled","o17","t2540","Bn","i620","e5338","yOrEngine","engineOrUndefined","r36","Pointers","_pointerDown","_pointerUp","_pointerMove","_pointerCancel","_wheel","_pointers","_activePointers","primary","_handleTouchEvent","touchAction","_handlePointerEvent","MSPointerEvent","msTouchAction","_handleMouseEvent","passive","pageScrollPreventionMode","_handleWheelEvent","wheelOptions","onmousewheel","e5404","triggerEvent","GlobalCoordinates","pointerId","preventDefault","eventish","h11","CapturePointer","t2573","_dispatchWithBubble","_dispatchPointerLeaveEvents","t2583","e5534","i649","createPointerEventByName","Mn","pointerLeave","n131","_dispatchPointerEnterEvents","pointerEnter","s199","_propagateWheelPointerEvent","wheelEvent","eventArr","at","fromPagePosition","_nativeButtonToPointerButton","changedTouches","_getPointerIndex","identifier","_stringToPointerType","wheelDeltaX","wheelDeltaY","wheelDelta","detail","l9","we","e5703","t2607","Gamepads","_gamePadTimeStamps","_oldPads","_pads","_initSuccess","_navigator","_minimumConfiguration","_clonePads","setMinimumGamepadConfiguration","_enableAndUpdate","_isGamepadValid","pad","buttons","connected","e5755","gamepads","timestamp","navigatorGamepad","Buttons","i663","getButton","pressed","updateButton","getAxes","updateAxes","_clonePad","Gamepad","getValidGamepads","t2627","pads","Ln","MinAxisMoveThreshold","_buttons","t2637","t2638","isButtonPressed","e5781","In","Face1","Face2","Face3","Face4","LeftBumper","RightBumper","LeftTrigger","RightTrigger","Select","LeftStick","RightStick","DpadUp","DpadDown","DpadLeft","DpadRight","LeftStickX","LeftStickY","RightStickX","RightStickY","On","zn","_paused","_nativeHandlers","_decorate","Un","_documentGlobal","e5911","_windowGlobal","t2663","_windowComponent","_documentComponent","Hn","_states","_currentState","_getDefaultState","_cloneState","Nn","t2664","_text","shadow","e5912","spriteFont","_getCharacterSprites","e5913","toLocaleLowerCase","t2672","letterIndex","textToRender","letter","spriteIndex","r37","letterSprite","i664","updateText","s200","render","Wn","fontSheet","_imageSource","_spriteSheet","fromImageSource","_spriteFont","write","Vn","t2687","_ex","_debugText","__ctx","snapToPixel","lineOptions","pointOptions","Gn","t2703","_state","canvasElement","e6199","enableTransparency","i769","s230","n132","alpha","swidth","sheight","dwidth","dheight","t2712","drawRectangle","jn","_transforms","_currentTransform","Xn","_vertexSource","_fragmentSource","i833","t2742","e6473","uniforms","attributes","layout","compile","_createProgram","vertexShader","fragmentShader","s266","getProgramInfoLog","_compileShader","i862","addUniformMatrix","location","addUniformIntegerArray","addAttribute","glType","vertexAttributeSize","t2779","vert","totalVertexSizeBytes","i876","vertexSize","typeSize","getAttributeSize","e6643","e6644","uniformMatrix4fv","uniform1iv","qn","t2782","_pool","commands","isFull","canAdd","Kn","recycler","maxObjects","builder","t2785","totalAllocations","objects","using","borrow","Zn","s276","_buffer","_maxCommandsPerBatch","_batches","command","_verticesPerCommand","verticesPerCommand","maxCommandsPerBatch","i877","r42","batchFactory","_batchPool","buildShader","_vertices","DYNAMIC_DRAW","addCommand","lastBatch","cmd","newBatch","e6645","drawnImagesCount","i878","batch","buildBatchVertices","bufferSubData","renderBatch","vertexCount","drawCallCount","Yn","LineRenderer","_contextInfo","e6646","addLine","s277","i910","vertexBuffer","_batch","LINES","$n","Jn","view","_geom","t2838","initRect","n162","t2840","initLine","startTop","startBottom","endTop","endBottom","c5","t2842","initCircle","topLeft","topRight","bottomLeft","bottomRight","t2847","applyTransform","e7137","geometry","BatchImage","maxTextures","t2850","maxDraws","textures","_graphicMap","_isCommandFull","_isTextureFull","_wouldAddTexture","maybeAdd","bindTextures","e7152","activeTexture","TEXTURE0","getBatchTextureId","ImageRenderer","getParameter","MAX_TEXTURE_IMAGE_UNITS","registerContext","i1015","_transformFragmentSource","maxGPUTextures","s338","t2880","newSource","addCircle","addRectangle","addImage","s374","n168","r54","o33","sw","sh","h12","potWidth","potHeight","textureId","commandColor","i1095","uvy0","uvx1","uvy1","g3","f3","vertIndex","ir","PointRenderer","getExtension","e7378","addPoint","s375","i1112","POINTS","nr","t2979","_webglCtx","rectOptions","__lineRenderer","__pointRenderer","rr","t2995","e7714","i1184","s405","n183","__gl","antialias","premultipliedAlpha","depth","powerPreference","_init","_ortho","ortho","clearColor","COLOR_BUFFER_BIT","BLEND","blendFunc","SRC_ALPHA","ONE_MINUS_SRC_ALPHA","__imageRenderer","ie","t3018","ScrollPreventionMode","or","_hasStarted","scenes","_animations","_suppressPlayButton","pauseAudioWhenHidden","_isDebug","debugColor","enableCanvasTransparency","onFatalException","_timescale","_isLoading","_deferredGoTo","_DEFAULT_ENGINE_OPTIONS","freeze","n193","oe","suppressMinimumBrowserFeatureDetection","_compatible","innerText","detector","t3019","testMessage","canvasElementId","e7899","suppressConsoleBootMessage","EX_VERSION","r59","e7897","e7898","et","i1249","s448","suppressHiDPIScaling","_loader","rootScene","addScene","isFullscreen","timescale","removeScene","e8048","goToScene","visibilityChange","scrollPreventionMode","keyboard","Fn","pointerScope","hidden","i1268","_overrideInitialize","_update","t3082","_draw","font","e8079","t3094","toggleDebug","e8198","createMainLoop","raf","nowFn","mainloop","game","_requestId","lastTime","o37","frameId","a26","beforeUpdate","afterUpdate","isPaused","screenshot","t3132","ar","lr","i1322","t3134","e8228","AnimationNode","MediaEvent","e8229","t3135","_value","_path","_val","layPath","NativeSoundEvent","cr","t3139","e8230","NativeSoundProcessedEvent","_processedData","t3140","Font","t3141","quality","family","bold","unit","_textBounds","_textWidth","_textHeight","e8232","i1323","s449","n194","r60","blur","pr","fontString","e8233","i1324","_lines","t3144","s450","e8234","numLines","_rasterWidth","_rasterHeight","_halfRasterWidth","_halfRasterHeight","e8267","i1345","_applyFont","metrics","measureText","actualBoundingBoxLeft","actualBoundingBoxRight","actualBoundingBoxAscent","actualBoundingBoxDescent","lineAdjustedHeight","n195","bottomBounds","textBaseline","shadowBlur","shadowOffsetX","shadowOffsetY","i1365","strokeText","Text","t3186","e8332","i1385","gr","_font","o38","fr","t3200","e8367","i1408","s466","r61","fontFamily","fontStyle","fontUnit","_legacySpriteFont","sf","fromLegacySpriteFont","getTextWidth","clearTextShadow","i1431","_r","mr","_CURRENT_GROUP","_MAX_GROUPS","_GROUPS","_CURRENT_BIT","groups","_STARTING_BIT","yr","t3242","filled","_points","curr","e8470","l10","c6","d5","u4","p2","w2","y3","v3","e8505","i1454","s468","n197","r62","o39","a28","h14","A2","fillColor","lineColor","wr","ExResponse","t3257","any","json","Rr","_src","_volume","_loop","_isPlaying","_isPaused","_audioContext","_volumeNode","createGain","_currentOffset","_createNewBufferSource","_instance","_wireUpOnEnded","volume","gain","setTargetAtTime","_playbackRate","playbackRate","_resumePlayBack","playStarted","_startPlayBack","_playingPromise","_setPauseOffset","_handleOnEnded","_playingResolve","_rememberStartTime","restartTime","_startTime","getTime","amend","setValueAtTime","file","t3274","e8506","Audio","i1455","canPlayType","s469","t3275","Sound","_isStopped","_tracks","_wasPlayingOnHidden","canPlayFile","instances","audiobuffer","decodeAudio","t3283","instanceCount","_resumePlayback","_startPlayback","getTrackId","t3292","_getTrackInstance","e8507","newTrack","Fr","t3294","_stream","_gif","_textures","_animation","_transparentColor","t3296","toLegacySpriteSheet","toSpriteSheet","toLegacyAnimation","toAnimation","fromSpriteSheet","readCheckBytes","checkBytes","ba","e8542","byteToBitArr","bite","i1456","t3303","Or","readByte","byteLength","readBytes","read","readUnsigned","t3304","zr","_st","_handler","globalColorTable","parseColorTable","entries","e8543","t3306","readSubBlocks","t3305","parseHeader","sig","ver","colorRes","globalColorTableSize","gctFlag","sorted","bgColor","pixelAspectRatio","hdr","bits","parseExt","block","reserved","disposalMethod","userInput","transparencyGiven","delayTime","transparencyIndex","terminator","gce","comment","com","ptHeader","ptData","pte","unknown","iterations","app","NETSCAPE","appData","authCode","label","extType","parseImg","img","leftPos","topPos","lctFlag","interlaced","lctSize","lct","lzwMinCodeSize","pixels","e8544","i1457","t3307","s470","n198","output","r63","minCodeSize","eoiCode","clearCode","dict","h19","l11","o40","last","readCode","codeSize","a29","cpRow","toRow","fromRow","n199","newPixels","fromPixels","steps","pass","offsets","deinterlace","arrayToImage","parseBlock","sentinel","eof","frame","Ur","t3308","Nr","_getComparable","t3316","_find","_root","getKey","getData","getLeft","getRight","_get","setLeft","setRight","removeByComparable","elementIndex","_findMinNode","setKey","setData","_cleanup","comparable","e9104","t3403","_list","treeNode","Hr","SortedList","Wr","_data","_left","_right","BinaryTreeNode","Vr","t3417","getTheKey","PromiseState","t3420","jr","Resolved","Rejected","Pending","qr","Gr","_successCallbacks","_rejectCallback","t3424","isArray","e9173","e9174","promises","rejects","successes","joinedPromise","errors","rejectCallback","successCallback","_handleError","t3428","errorCallback","_errorCallback","t3433","t3435","Xr","Kr","s6","define","amd"],"version":3,"file":"index.2aaeeae9.js.map"}